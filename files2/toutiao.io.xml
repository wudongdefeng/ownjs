<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>d9f1939be6e8e4fae7a41a835c2312aa</guid>
<title>ä»ä¸€æ¬¡ CPU æ‰“æ»¡åˆ° ReDos æ”»å‡»å’Œé˜²èŒƒ</title>
<link>https://toutiao.io/k/rpzjoor</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;preview&quot;&gt;&lt;p&gt;&lt;strong&gt;ä½œè€…ï¼šäº¬ä¸œç‰©æµ åˆ˜æµ·èŒ‚&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;è¿‘æœŸç¢°åˆ°ä¸€èµ·å€¼ç­æŠ¥è­¦äº‹ä»¶ï¼Œweb åº”ç”¨æœåŠ¡å™¨ CPU æ¶ˆè€—æ‰“åˆ° 99%ï¼Œæ’æŸ¥åå‘ç°æ˜¯å› ä¸º ReDoS å¯¼è‡´äº†æœåŠ¡å™¨å‘ç”Ÿäº†èµ„æºè¢«è€—å°½ã€è®¿é—®ç³»ç»Ÿç¼“æ…¢çš„é—®é¢˜ï¼Œé€šè¿‡æ’æŸ¥è¿‡ç¨‹ä»è€Œåˆ†äº«ä¸‹ ReDos æ”»å‡»çš„åŸç†ã€å¸¸è§åœºæ™¯ä»¥åŠé˜²èŒƒå’Œè§£å†³æ–¹æ¡ˆï¼Œå¦‚æœæœ‰é”™è¯¯æ¬¢è¿æŒ‡æ­£ã€‚&lt;/p&gt;

&lt;h1&gt;èƒŒæ™¯&lt;/h1&gt;

&lt;p&gt;å€¼ç­çš„æ—¶å€™çªç„¶æŠ¥è­¦ï¼Œweb åº”ç”¨æœåŠ¡å™¨ CPU æ¶ˆè€—æ‰“åˆ° 99%ï¼ŒåŒæ—¶ç°åœºåé¦ˆç³»ç»Ÿè®¿é—®ç¼“æ…¢&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ba62d2fbe2042a2923716ad9c6bba12%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;ç™»å½•æ³°å±±å¹³å°ï¼ŒæŸ¥çœ‹ ump ç›‘æ§å‘ç°ç³»ç»Ÿæ¶ˆè€— CPU æ¶ˆè€—çªç„¶è¢«æ‰“æ»¡&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/735e695d3a84457197cb8a3fdbe65136%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡ java è‡ªå¸¦çš„ dump å·¥å…·ï¼Œä¸‹è½½ jstock æ–‡ä»¶ï¼Œå‘ç°æœ‰å¤§é‡ç›¸åŒä»»åŠ¡çº¿ç¨‹åœ¨è¿è¡Œï¼Œå…·ä½“çš„å †æ ˆä¿¡æ¯å¦‚ä¸‹&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f4c84d91e0034e01984cbea6586d7a59%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;ä»”ç»†æŸ¥çœ‹è¿™äº›çº¿ç¨‹çš„æ‰§è¡Œä»£ç ï¼Œå‘ç°éƒ½è°ƒç”¨äº† UrlUtil.extractDomain è¿™ä¸ªæ–¹æ³•&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ea42ce94889d44309623e08e4cd84086%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;æ ¹æ®å †æ ˆä¿¡æ¯æŸ¥çœ‹ä¸šåŠ¡ä»£ç ï¼Œå‘ç°æ˜¯ joybuy ç™»å½•æ‹¦æˆªå™¨ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…è®¿é—® url è§£æä¸»åŸŸçš„æ–¹æ³•å‡ºç°äº†é˜»å¡ï¼Œè‡³æ­¤ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å› ä¸º ReDoS å¯¼è‡´äº†æœåŠ¡å™¨å‘ç”Ÿäº†èµ„æºè¢«è€—å°½ã€è®¿é—®ç³»ç»Ÿç¼“æ…¢çš„é—®é¢˜ï¼Œé‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ ReDoS å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4db5d6b33e1d4b32ab7e80ddaeabc274%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;h1&gt;ReDos ç®€ä»‹&lt;/h1&gt;

&lt;p&gt;ReDoS æ”»å‡»ï¼ˆæ­£åˆ™è¡¨è¾¾å¼æ‹’ç»æœåŠ¡æ”»å‡» (Regular Expression Denial of Service)ï¼‰ï¼Œæ”»å‡»è€…å¯æ„é€ ç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œå¯¼è‡´æ­£åˆ™è¡¨è¾¾å¼è¿è¡Œä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜å’Œ cpu å¯¼è‡´æœåŠ¡å™¨èµ„æºè¢«è€—å°½ã€‚æ— æ³•ç»§ç»­å“åº”ï¼Œé‚£ä¸ºä½•ä¸ç¡®å®šçš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¯¼è‡´ redos æ”»å‡»å‘¢ï¼Ÿè¿™å¾—ä»æ­£åˆ™è¡¨è¾¾å¼çš„å®ç°åŸç†è¯´èµ·&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;åŸç†&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;ç›®å‰å®ç°æ­£åˆ™è¡¨è¾¾å¼å¼•æ“çš„æ–¹å¼æœ‰ä¸¤ç§&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;  &lt;strong&gt;DFA è‡ªåŠ¨æœº&lt;/strong&gt;ï¼ˆDeterministic Finite Automatonï¼Œç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼‰&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
&lt;li&gt;  &lt;strong&gt;NFA è‡ªåŠ¨æœº&lt;/strong&gt;ï¼ˆNondeterministic Finite Automatonï¼Œéç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼‰&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
&lt;li&gt;  DFA è‡ªåŠ¨æœºçš„æ„é€ ä»£ä»·è¿œå¤§äº NFA è‡ªåŠ¨æœºï¼Œä½† DFA è‡ªåŠ¨æœºçš„æ‰§è¡Œæ•ˆç‡é«˜äº NFA è‡ªåŠ¨æœº&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
&lt;li&gt;  å‡è®¾ä¸€ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸º nï¼Œå¦‚æœé‡‡ç”¨ DFA è‡ªåŠ¨æœºä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼å¼•æ“ï¼Œåˆ™åŒ¹é…çš„æ—¶é—´å¤æ‚åº¦ä¸º O (n)&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
&lt;li&gt;  å¦‚æœé‡‡ç”¨ NFA è‡ªåŠ¨æœºä½œä¸ºæ­£åˆ™è¡¨è¾¾å¼å¼•æ“ï¼ŒNFA è‡ªåŠ¨æœºåœ¨åŒ¹é…è¿‡ç¨‹ä¸­å­˜åœ¨å¤§é‡çš„åˆ†æ”¯å’Œå›æº¯ï¼Œå‡è®¾ NFA çš„çŠ¶æ€æ•°ä¸º sï¼Œ&lt;/li&gt;
&lt;/ul&gt;







&lt;ul&gt;
&lt;li&gt;  NFA è‡ªåŠ¨æœºçš„ä¼˜åŠ¿æ˜¯æ”¯æŒæ›´å¤šé«˜çº§åŠŸèƒ½ï¼Œä½†éƒ½æ˜¯åŸºäº&lt;em&gt;å­è¡¨è¾¾å¼ç‹¬ç«‹è¿›è¡ŒåŒ¹é…&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
&lt;li&gt;  å› æ­¤åœ¨ç¼–ç¨‹è¯­è¨€é‡Œï¼Œä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼åº“éƒ½æ˜¯åŸºäº NFA è‡ªåŠ¨æœºå®ç°çš„&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NFA çš„ç‰¹æ€§ï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;ä¸€ä¸ªæœ‰é™çš„çŠ¶æ€é›†åˆ S&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸€ä¸ªè¾“å…¥ç¬¦å·é›†åˆ sigmaï¼Œç©ºå­—ç¬¦ epsilon ä¸å±äº Sigma&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;çŠ¶æ€è¿ç§»å‡½æ•° Fï¼Œå¯¹äºç‰¹å®šçš„è¾“å…¥å­—ç¬¦å’ŒçŠ¶æ€ï¼Œè¾“å‡ºå¯¹åº”çš„å˜æ›´çŠ¶æ€é›†åˆ&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;4.s0 ä¸ºåˆå§‹çŠ¶æ€&lt;/p&gt;

&lt;p&gt;5.S å­é›†ä¸ºç»“æŸçŠ¶æ€é›†&lt;/p&gt;

&lt;h1&gt;è¯´æ˜&lt;/h1&gt;

&lt;p&gt;å®šä¹‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ ^(a+)+$ æ¥å¯¹å­—ç¬¦ä¸² aaaaX åŒ¹é…ã€‚ä½¿ç”¨ NFA çš„æ­£åˆ™å¼•æ“ï¼Œå¿…é¡»ç»å† 2^4=16 æ¬¡å°è¯•å¤±è´¥åæ‰èƒ½å¦å®šè¿™ä¸ªåŒ¹é…ã€‚&lt;/p&gt;

&lt;p&gt;åŒç†å­—ç¬¦ä¸²ä¸ºÂ aaaaaaaaaaX å°±è¦ç»å† 2^10=1024 æ¬¡å°è¯•ã€‚å¦‚æœæˆ‘ä»¬ç»§ç»­å¢åŠ  a çš„ä¸ªæ•°ä¸º 20 ä¸ªã€30 ä¸ªæˆ–è€…æ›´å¤šï¼Œé‚£ä¹ˆè¿™é‡Œçš„åŒ¹é…ä¼šå˜æˆæŒ‡æ•°å¢é•¿&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e7c923b661db4a63822122b1878a882d%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;h1&gt;å¸¸è§ ReDoS åœºæ™¯&lt;/h1&gt;

&lt;p&gt;ä»¥ java ä¸ºä¾‹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§å¸¸è§çš„ ReDoS åœºæ™¯ï¼š&lt;/p&gt;

&lt;p&gt;1ã€ä½¿ç”¨ javax.validation.constraints.Pattern éªŒè¯å…¥å‚æ˜¯å¦åˆç†çš„åœºæ™¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/**
 * å®¢æˆ·å¤‡æ³¨
 * */
@ExcelProperty(index = 14)
@Length(min = 11 , max = 11, message = &quot;VATå·å¿…é¡»ä¸º11ä½&quot;)
@Pattern(regexp = &quot;^(GB)\d{9}&quot;, message = &quot;VATå·å¿…é¡»ä»¥GBå¼€å¤´ï¼Œ9ä½æ•°å­—ç»“å°¾&quot;)
private String vatNumber;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;2ã€ä½¿ç”¨ String.matches è¿›è¡Œä¸šåŠ¡æ•°æ®éªŒè¯çš„åœºæ™¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;//å‘ç¥¨æ—¥æœŸæ ¼å¼yyyy-MM-dd
String regExp = &quot;^[1-9]\d{3}-(0?[1-9]|1[0-2])-(0?[1-9]|[1-2][0-9]|3[0-1])$&quot;;
if (StringUtils.isNotBlank(outstockDto.getInvoiceDate()) &amp;amp;&amp;amp; !outstockDto.getInvoiceDate().matches(regExp)){
    totalMsg.add(new ErrorMsgDTO(ResultCodeEnum.OUTSTOCK_INVOICE_DATE_FORMAT_ERROR.getCode()));
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;3ã€ä½¿ç”¨ String.replaceAll åšå‚æ•°æ›¿æ¢çš„åœºæ™¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;private String getParamName(String str) {
    if (PATTERN_START_END.matcher(str).matches()) {
        String newStr = str.replaceAll(&quot;#\{&quot;, &quot;&quot;).replaceAll(&quot;\}&quot;, &quot;&quot;);
        if (StringUtils.isEmpty(newStr)) {
            return &quot;&quot;;
        } else if (newStr.contains(&quot;.&quot;)) {
            return StringUtils.substringAfterLast(newStr, &quot;.&quot;);
        }
        return newStr;
    }
    return null;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;4ã€é…ç½®æ–‡ä»¶åŒ¹é…å‚æ•°çš„åœºæ™¯&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# joybuyç™»å½•ä¸»åŸŸ
joybuy.login.domain = .*fop.joybuy.com$
# æ¬§ç¾Bè´¦å·ç™»å½•ä¸»åŸŸ
pulsar.login.domain = .*ifop.jd.com$
&lt;/code&gt;&lt;/pre&gt;

&lt;h1&gt;ReDoS æ£€æµ‹&lt;/h1&gt;

&lt;p&gt;1ã€RegexStaticAnalysis å·¥å…·&lt;/p&gt;

&lt;p&gt;æµ‹è¯•æ–¹å¼å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ maven package æ‰“åŒ…åæ‰§è¡Œæœ¬åœ°è¿è¡Œï¼Œè¾“å…¥éœ€è¦æµ‹è¯•çš„æ­£åˆ™è¡¨è¾¾å¼&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c3774ebf4444acb9c646fa282406481%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;2ã€åœ¨çº¿æµ‹è¯•åœ°å€ï¼š&lt;a href=&quot;https://regex101.com/&quot;&gt;https://regex101.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æµ‹è¯•æ–¹å¼ï¼š&lt;/p&gt;

&lt;p&gt;ç›´æ¥åœ¨è¾“å…¥æ¡†è¾“å…¥æ­£åˆ™è¡¨è¾¾å¼å’Œéœ€è¦æµ‹è¯•çš„å­—ç¬¦ä¸²ï¼Œæ—¢å¯ä»¥çœ‹åˆ°å¯¹é¥®åŒ¹é…çš„æ­¥æ•°å’Œç»“æœ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/baee7d8f1713400e9cb743b3962995a8%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;p&gt;åœ¨ dubugger æ¨¡å¼ä¸‹å¯ä»¥æŸ¥çœ‹åŒ¹é…çš„è¯¦ç»†è¿‡ç¨‹å’Œæ­¥æ•°&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c3ed62f140814550a1cf4cc40e4770d5%7Etplv-k3u1fbpfcp-zoom-1.image&quot; alt=&quot;&quot;/&gt;&lt;/p&gt;

&lt;h1&gt;é˜²èŒƒæ‰‹æ®µ&lt;/h1&gt;

&lt;p&gt;é˜²èŒƒæ‰‹æ®µåªæ˜¯ä¸ºäº†é™ä½é£é™©è€Œä¸èƒ½ç™¾åˆ†ç™¾æ¶ˆé™¤ ReDoS è¿™ç§å¨èƒã€‚å½“ç„¶ä¸ºäº†é¿å…è¿™ç§å¨èƒçš„æœ€å¥½æ‰‹æ®µæ˜¯å°½é‡å‡å°‘æ­£åˆ™åœ¨ä¸šåŠ¡ä¸­çš„ä½¿ç”¨åœºæ™¯æˆ–è€…å¤šåšæµ‹è¯•ï¼Œå¢åŠ æœåŠ¡å™¨çš„æ€§èƒ½ç›‘æ§ç­‰&lt;/p&gt;



















&lt;h1&gt;è§£å†³æ–¹æ³•&lt;/h1&gt;

&lt;p&gt;äº†è§£äº† ReDoS çš„åŸç†å’Œé˜²èŒƒï¼Œé’ˆå¯¹æœ¬æ¬¡ CPU çš„æŠ¥è­¦ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ï¼Œé‡‡ç”¨åˆ¤æ–­è¯·æ±‚è·¯å¾„å’Œåˆ†å‰²å­—ç¬¦ä¸²çš„æ–¹å¼è·å–è®¿é—®çš„åŸŸï¼Œé¿å…ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯¼è‡´çš„ ReDoS é—®é¢˜&lt;/p&gt;

&lt;p&gt;å®é™…ä¿®å¤ä»£ç &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;public static String extractDomain(String url) {
    if(StringUtils.isBlank(url)) {
        return &quot;&quot;;
    }
    int index = 0;
    if(url.startsWith(HTTP)) {
        index = HTTP.length();
    } else if(url.startsWith(HTTPS)) {
        index = HTTPS.length();
    } else {
        return &quot;&quot;;
    }
    String safeUrl = url.substring(index);
    index = safeUrl.indexOf(&#x27;/&#x27;);
    if(index &amp;gt; 0) {
        safeUrl = safeUrl.substring(0, index);
    }
    String[] array = safeUrl.split(&quot;\.&quot;);
    if(array.length &amp;lt; 2) {
        return &quot;&quot;;
    }
    String part1 = array[array.length - 2];
    String part2 = array[array.length - 1];


    if(StringUtils.isNotBlank(part1) &amp;amp;&amp;amp; StringUtils.isNotBlank(part2)) {
        if(!isIn(part2, DOMAINS)) {
            return &quot;&quot;;
        }
        return part1 + &#x27;.&#x27; + part2;
    }
    return &quot;&quot;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>a2073ad78ed7131542791ff95ba8a331</guid>
<title>Prometheus æœåŠ¡å‘ç°åŸç†</title>
<link>https://toutiao.io/k/chn0mxm</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h1 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æœåŠ¡å‘ç°&lt;/span&gt;&lt;span/&gt;&lt;/h1&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æ¦‚è¿°&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.41875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/O2TDJPu7cb1jtwUyicvG4OLMpB0y7ph2zt3ib7VVZl7AL2j1U56QrUC192algoGibtQzfrFCoY2kEdrYlnnn6oZtA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚ä¸Šå›¾ï¼ŒPrometheusæ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬æœåŠ¡å‘ç°ã€æ•°æ®é‡‡é›†å’Œæ•°æ®å­˜å‚¨ã€‚æœåŠ¡å‘ç°æ¨¡å—ä¸“é—¨è´Ÿè´£å‘ç°éœ€è¦ç›‘æ§çš„ç›®æ ‡é‡‡é›†ç‚¹(&lt;code&gt;target&lt;/code&gt;)ä¿¡æ¯ï¼Œæ•°æ®é‡‡é›†æ¨¡å—ä»æœåŠ¡å‘ç°æ¨¡å—è®¢é˜…è¯¥ä¿¡æ¯ï¼Œè·å–åˆ°&lt;code&gt;target&lt;/code&gt;ä¿¡æ¯åï¼Œå…¶ä¸­å°±åŒ…å«åè®®(&lt;code&gt;scheme&lt;/code&gt;)ã€ä¸»æœºåœ°å€:ç«¯å£(&lt;code&gt;instance&lt;/code&gt;)ã€è¯·æ±‚è·¯å¾„(&lt;code&gt;metrics_path&lt;/code&gt;)ã€è¯·æ±‚å‚æ•°(&lt;code&gt;params&lt;/code&gt;)ç­‰ï¼›ç„¶åæ•°æ®é‡‡é›†æ¨¡å—å°±å¯ä»¥åŸºäºè¿™äº›ä¿¡æ¯æ„å»ºå‡ºä¸€ä¸ªå®Œæ•´çš„&lt;code&gt;Http Request&lt;/code&gt;è¯·æ±‚ï¼Œå®šæ—¶é€šè¿‡&lt;code&gt;pull http&lt;/code&gt;åè®®ä¸æ–­çš„å»ç›®æ ‡é‡‡é›†ç‚¹(&lt;code&gt;target&lt;/code&gt;)æ‹‰å–ç›‘æ§æ ·æœ¬æ•°æ®(&lt;code&gt;sample&lt;/code&gt;)ï¼›æœ€åï¼Œå°†é‡‡é›†åˆ°ç›‘æ§æ ·æœ¬æ•°æ®äº¤ç”±&lt;code&gt;TSDB&lt;/code&gt;æ¨¡å—è¿›è¡Œæ•°æ®å­˜å‚¨ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;ä¸ºä»€ä¹ˆéœ€è¦æœåŠ¡å‘ç°æ¨¡å—ï¼Ÿ&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç±»ä¼¼äºå¾®æœåŠ¡é€šè¿‡å¼•å…¥æ³¨å†Œä¸­å¿ƒç»„ä»¶è§£å†³ä¼—å¤šå¾®æœåŠ¡é—´é”™ç»¼å¤æ‚çš„ä¾èµ–è°ƒç”¨ã€‚æ— è®ºæ˜¯æœåŠ¡ä¸»åŠ¨åœæ­¢ï¼Œæ„å¤–æŒ‚æ‰ï¼Œè¿˜æ˜¯å› ä¸ºæµé‡å¢åŠ å¯¹æœåŠ¡å®ç°è¿›è¡Œæ‰©å®¹ï¼Œè¿™äº›æœåŠ¡æ•°æ®æˆ–çŠ¶æ€ä¸Šçš„åŠ¨æ€å˜åŒ–ï¼Œé€šè¿‡æ³¨å†Œä¸­å¿ƒå±è”½æœåŠ¡çŠ¶æ€å˜æ›´é€ æˆçš„å½±å“ï¼Œç®€åŒ–äº†è°ƒç”¨æ–¹å¤„ç†é€»è¾‘ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŒç†ï¼Œ&lt;code&gt;Prometheus&lt;/code&gt;æœ€å¼€å§‹è®¾è®¡æ˜¯ä¸€ä¸ªé¢å‘äº‘åŸç”Ÿåº”ç”¨ç¨‹åºçš„ï¼Œäº‘åŸç”Ÿã€å®¹å™¨åœºæ™¯ä¸‹æŒ‰éœ€çš„èµ„æºä½¿ç”¨æ–¹å¼å¯¹äºç›‘æ§ç³»ç»Ÿè€Œè¨€å°±æ„å‘³ç€æ²¡æœ‰äº†ä¸€ä¸ªå›ºå®šçš„ç›‘æ§ç›®æ ‡ï¼Œæ‰€æœ‰çš„ç›‘æ§å¯¹è±¡(åŸºç¡€è®¾æ–½ã€åº”ç”¨ã€æœåŠ¡)éƒ½åœ¨åŠ¨æ€çš„å˜åŒ–ã€‚&lt;code&gt;Prometheus&lt;/code&gt;è§£å†³æ–¹æ¡ˆå°±æ˜¯å¼•å…¥ä¸€ä¸ªä¸­é—´çš„ä»£ç†äººï¼Œè¿™ä¸ªä»£ç†äººæŒæ¡ç€å½“å‰æ‰€æœ‰ç›‘æ§ç›®æ ‡çš„è®¿é—®ä¿¡æ¯ï¼Œ&lt;code&gt;Prometheus&lt;/code&gt;åªéœ€è¦å‘è¿™ä¸ªä»£ç†äººè¯¢é—®æœ‰å“ªäº›ç›‘æ§ç›®æ ‡å³å¯ï¼Œè¿™ç§æ¨¡å¼è¢«ç§°ä¸ºæœåŠ¡å‘ç°(&lt;code&gt;service discovery&lt;/code&gt;)ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç›®å‰ï¼Œ&lt;code&gt;Prometheus&lt;/code&gt;æ”¯æŒçš„æœåŠ¡å‘ç°åè®®æ˜¯éå¸¸ä¸°å¯Œçš„ï¼Œæœ€æ–°ç‰ˆæœ¬(&lt;code&gt;2.41&lt;/code&gt;)å·²æ”¯æŒæ¥è¿‘ä¸‰åç§æœåŠ¡å‘ç°åè®®ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&amp;lt;azure_sd_config&amp;gt;&lt;br/&gt;&amp;lt;consul_sd_config&amp;gt;&lt;br/&gt;&amp;lt;digitalocean_sd_config&amp;gt;&lt;br/&gt;&amp;lt;docker_sd_config&amp;gt;&lt;br/&gt;&amp;lt;dockerswarm_sd_config&amp;gt;&lt;br/&gt;&amp;lt;dns_sd_config&amp;gt;&lt;br/&gt;&amp;lt;ec2_sd_config&amp;gt;&lt;br/&gt;&amp;lt;openstack_sd_config&amp;gt;&lt;br/&gt;&amp;lt;ovhcloud_sd_config&amp;gt;&lt;br/&gt;&amp;lt;puppetdb_sd_config&amp;gt;&lt;br/&gt;&amp;lt;file_sd_config&amp;gt;&lt;br/&gt;&amp;lt;gce_sd_config&amp;gt;&lt;br/&gt;&amp;lt;hetzner_sd_config&amp;gt;&lt;br/&gt;&amp;lt;http_sd_config&amp;gt;&lt;br/&gt;&amp;lt;ionos_sd_config&amp;gt;&lt;br/&gt;&amp;lt;kubernetes_sd_config&amp;gt;&lt;br/&gt;&amp;lt;kuma_sd_config&amp;gt;&lt;br/&gt;&amp;lt;lightsail_sd_config&amp;gt;&lt;br/&gt;&amp;lt;linode_sd_config&amp;gt;&lt;br/&gt;&amp;lt;marathon_sd_config&amp;gt;&lt;br/&gt;&amp;lt;nerve_sd_config&amp;gt;&lt;br/&gt;&amp;lt;nomad_sd_config&amp;gt;&lt;br/&gt;&amp;lt;serverset_sd_config&amp;gt;&lt;br/&gt;&amp;lt;triton_sd_config&amp;gt;&lt;br/&gt;&amp;lt;eureka_sd_config&amp;gt;&lt;br/&gt;&amp;lt;scaleway_sd_config&amp;gt;&lt;br/&gt;&amp;lt;uyuni_sd_config&amp;gt;&lt;br/&gt;&amp;lt;vultr_sd_config&amp;gt;&lt;br/&gt;&amp;lt;static_config&amp;gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æœåŠ¡å‘ç°é…ç½®è§£æ&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;1ã€&lt;code&gt;Prometheus&lt;/code&gt;æœåŠ¡å¯åŠ¨åŠ è½½&lt;code&gt;prometheus.yml&lt;/code&gt;é…ç½®æ–‡ä»¶ä¼šè¢«è§£æ&lt;code&gt;Config&lt;/code&gt;ç»“æ„ä½“ï¼š&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.40078125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/O2TDJPu7cb1jtwUyicvG4OLMpB0y7ph2zeayNic0EVCq7M84xibicEmrmC5sMg125JuXwusl9H3KGsFkS7QibKib0oYA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;code&gt;Config&lt;/code&gt;ç»“æ„ä½“æ˜¯é…ç½®ç±»çš„æœ€é¡¶å±‚ç»“æ„ï¼Œå†…éƒ¨åŒ…å«6ä¸ªå­—æ®µåˆ†åˆ«å¯¹åº”&lt;code&gt;prometheus&lt;/code&gt;é…ç½®çš„6å¤§ç»„æˆéƒ¨åˆ†ã€‚&lt;/p&gt;&lt;span&gt;â&lt;/span&gt;&lt;p&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;2ã€å…¶ä¸­æ•°æ®é‡‡é›†é…ç½®éƒ¨åˆ†&lt;code&gt;ScrapeConfigs&lt;/code&gt;å¯¹åº”çš„æ˜¯ä¸€ä¸ª&lt;code&gt;*ScrapeConfigç±»å‹&lt;/code&gt;åˆ‡ç‰‡ï¼Œä¸€ä¸ª&lt;code&gt;ScrapeConfig&lt;/code&gt;å¯¹åº”çš„æ˜¯&lt;code&gt;scrape_configs&lt;/code&gt;é…ç½®ä¸‹çš„ä¸€ä¸ª&lt;code&gt;job&lt;/code&gt;æŠ“å–ä»»åŠ¡ï¼ŒæœåŠ¡å‘ç°åè®®é…ç½®å¯¹åº”å…¶ä¸­&lt;code&gt;ServiceDiscoveryConfigs&lt;/code&gt;å­—æ®µï¼š&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.4328125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/O2TDJPu7cb1jtwUyicvG4OLMpB0y7ph2z7IIZj4UGUZdQQbtUicOuKLcUGYOxdk89Niaqq5H5xUkljkjKMMrBdtKQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;3ã€&lt;code&gt;discovery.Configs&lt;/code&gt;å¯¹åº”çš„æ˜¯&lt;code&gt;Config&lt;/code&gt;åˆ‡ç‰‡ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;type&lt;/span&gt;Â ConfigsÂ []Config&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰€ä»¥ï¼Œä¸€ä¸ª&lt;code&gt;job&lt;/code&gt;æŠ“å–ä»»åŠ¡ä¸‹å¯ä»¥é…ç½®å¤šä¸ªæœåŠ¡å‘ç°åè®®ï¼Œå¦‚ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;job_name:&lt;/span&gt;Â &lt;span&gt;&#x27;prometheus&#x27;&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;metrics_path:&lt;/span&gt;Â &lt;span&gt;/metrics&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;static_configs:&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;targets:&lt;/span&gt;Â &lt;span&gt;[&#x27;124.222.45.207:9090&#x27;]&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;file_sd_configs:&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;files:&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;targets/t1.json&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;targets/t2.json&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;refresh_interval:&lt;/span&gt;Â &lt;span&gt;5m&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;4ã€&lt;code&gt;Config&lt;/code&gt;æ˜¯ä¸€ä¸ªæ¥å£ï¼š&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.2396109637488948&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/O2TDJPu7cb1jtwUyicvG4OLMpB0y7ph2zkSwQXAHQYwrktvmOLZ4Or7DzibpJs7mrKHjWadHqhU2QofhAzYqgRVw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1131&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;Config&lt;/code&gt;æ˜¯ä¸€ä¸ªæ¥å£çš„å®šä¹‰ï¼Œæ¯ç§æœåŠ¡å‘ç°åè®®éƒ½ä¼šå­˜åœ¨ä¸€ä¸ªå¯¹åº”&lt;code&gt;Config&lt;/code&gt;æ¥å£çš„å®ç°ï¼ˆè§ä¸‹å›¾ï¼‰ã€‚è¯¥æ¥å£ä¸»è¦å®šä¹‰ä¸¤ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;1&lt;/span&gt;ã€Name()Â &lt;span&gt;string&lt;/span&gt;ï¼šå®šä¹‰æœåŠ¡å‘ç°åè®®ç±»å‹ï¼Œå¦‚eurekaã€kubernetesç­‰ç­‰ï¼›&lt;br/&gt;&lt;span&gt;2&lt;/span&gt;ã€NewDiscoverer(DiscovererOptions)Â (Discoverer, error)ï¼šè¿”å›ä¸€ä¸ªDiscovererç±»å‹å˜é‡ï¼Œè¯¥ç±»å‹ä¹Ÿæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå…¶åªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•Runæ–¹æ³•ï¼Œå³Discovereræ˜¯å¯¹åº”çš„æœåŠ¡å‘ç°åè®®å…·ä½“è¿è¡Œé€»è¾‘å°è£…ï¼Œé€šè¿‡Runæ–¹æ³•æä¾›ç»Ÿä¸€çš„è¿è¡Œå…¥å£ã€‚&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.51796875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/O2TDJPu7cb1jtwUyicvG4OLMpB0y7ph2zT5SI7QHPmCyFJItHohmFAm5B1Libz1nb1ZAP8xT8COzMkmzoLOTUicibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æœåŠ¡å‘ç°æ ¸å¿ƒåŸç†&lt;/span&gt;&lt;span/&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.63671875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/O2TDJPu7cb1jtwUyicvG4OLMpB0y7ph2z7cF3eBSTOfzNicRdLI78lz0PKtE75mJia4OleTDLNsBmsHRa2QribK4rA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯´æ˜ï¼š&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;Prometheus&lt;/code&gt;æœåŠ¡å‘ç°æ ¸å¿ƒé€»è¾‘çš„å…¥å£ä¸»è¦å…³æ³¨&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“çš„&lt;code&gt;ApplyConfig&lt;/code&gt;æ–¹æ³•ï¼šåŸºäºæœåŠ¡å‘ç°çš„é…ç½®ä½¿å…¶ç”Ÿæ•ˆï¼›&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;&lt;code&gt;ApplyConfig&lt;/code&gt;æ–¹æ³•åŒ…æ‹¬å››ä¸ªä¸»è¦æ­¥éª¤ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;type&lt;/span&gt;Â providerÂ &lt;span&gt;struct&lt;/span&gt;Â {&lt;br/&gt;Â nameÂ Â Â &lt;span&gt;string&lt;/span&gt;&lt;br/&gt;Â dÂ Â Â Â Â Â Discoverer&lt;br/&gt;Â subsÂ Â Â []&lt;span&gt;string&lt;/span&gt;&lt;br/&gt;Â configÂ &lt;span&gt;interface&lt;/span&gt;{}&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;&lt;span&gt;â&lt;/span&gt;&lt;p&gt;ä¸€ä¸ªjobä¸‹ä¸€ä¸ªæœåŠ¡å‘ç°åè®®å¯¹åº”ä¸€ä¸ªDiscovererã€‚&lt;/p&gt;&lt;span&gt;â&lt;/span&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;code&gt;provider&lt;/code&gt;è¿˜æœ‰é¢å¤–ä¸‰ä¸ªå­—æ®µï¼š&lt;/p&gt;&lt;p&gt;1ã€&lt;code&gt;name&lt;/code&gt;ï¼š&lt;code&gt;provider&lt;/code&gt;åç§°ï¼Œæ ¼å¼ï¼š&lt;code&gt;fmt.Sprintf(&quot;%s/%d&quot;, typ, len(m.providers))&lt;/code&gt;ï¼›&lt;/p&gt;&lt;p&gt;2ã€&lt;code&gt;subs&lt;/code&gt;ï¼š&lt;code&gt;string&lt;/code&gt;åˆ‡ç‰‡ï¼Œå­˜æ”¾&lt;code&gt;job&lt;/code&gt;åç§°ï¼Œå› ä¸ºå¯èƒ½ä¸åŒ&lt;code&gt;job&lt;/code&gt;ä¸‹å­˜åœ¨ä¸€è‡´çš„æœåŠ¡å‘ç°é…ç½®ï¼Œå°±åªä¼šç”Ÿæˆä¸€ä¸ª&lt;code&gt;provider&lt;/code&gt;ï¼Œç„¶å&lt;code&gt;subs&lt;/code&gt;å­˜æ”¾&lt;code&gt;job&lt;/code&gt;åˆ—è¡¨ï¼›&lt;/p&gt;&lt;p&gt;3ã€&lt;code&gt;config&lt;/code&gt;ï¼šæœåŠ¡å‘ç°é…ç½®&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;å¯åŠ¨&lt;code&gt;Discoverer&lt;/code&gt;æ¥å£&lt;code&gt;Run&lt;/code&gt;æ–¹æ³•ï¼Œè®©æœåŠ¡å‘ç°é€»è¾‘è¿è¡Œï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;åç¨‹ä¸­è¿è¡Œ&lt;code&gt;updater&lt;/code&gt;æ–¹æ³•ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Discoverer&lt;/code&gt;æ¥å£&lt;code&gt;Run&lt;/code&gt;æ–¹æ³•ä¸»è¦åŸºäºå…·ä½“æœåŠ¡å‘ç°åè®®å‘ç°&lt;code&gt;target&lt;/code&gt;ï¼Œç„¶åé€šè¿‡é€šé“ä¼ é€’ç»™&lt;code&gt;updater&lt;/code&gt;å¤„ç†é€»è¾‘ï¼Œå°†å…¶è§£æå¤„ç†æ”¾å…¥åˆ°&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“ä¸­&lt;code&gt;targets&lt;/code&gt;å­—æ®µä¸­ï¼Œå¹¶å‘&lt;code&gt;triggerSend&lt;/code&gt;é€šé“å‘é€ä¿¡å·ï¼Œè¡¨ç¤ºå½“å‰&lt;code&gt;targets&lt;/code&gt;å‘ç”Ÿå˜æ›´ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“&lt;code&gt;sender&lt;/code&gt;æ–¹æ³•æ¯5ç§’ç›‘å¬&lt;code&gt;triggerSend&lt;/code&gt;é€šé“ä¿¡å·ï¼Œå¹¶å°†&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“ä¸­&lt;code&gt;targets&lt;/code&gt;å­—æ®µå¤„ç†åæ”¾å…¥åˆ°&lt;code&gt;syncCh&lt;/code&gt;é€šé“ä¸­ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ•°æ®é‡‡é›†æ¨¡å—(&lt;code&gt;scrape&lt;/code&gt;)ç›‘å¬&lt;code&gt;syncCh&lt;/code&gt;é€šé“ï¼Œå°±å¯ä»¥è·å–åˆ°æœåŠ¡å‘ç°ç”Ÿæˆçš„&lt;code&gt;targets&lt;/code&gt;ä¿¡æ¯ï¼Œç„¶å&lt;code&gt;reload&lt;/code&gt;å°†&lt;code&gt;target&lt;/code&gt;çº³å…¥ç›‘æ§å¼€å§‹æŠ“å–ç›‘æ§æŒ‡æ ‡ã€‚&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;å¯åŠ¨&lt;code&gt;provider&lt;/code&gt;ï¼šéå†&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“ä¸­&lt;code&gt;providers&lt;/code&gt;åˆ‡ç‰‡ï¼Œå¯åŠ¨æ¯ä¸ª&lt;code&gt;provider&lt;/code&gt;ï¼Œè¯¥æ­¥éª¤ä¸»è¦æ˜¯å¯åŠ¨ä¸¤ä¸ªåç¨‹ï¼š&lt;/p&gt;&lt;blockquote&gt;&lt;span&gt;â&lt;/span&gt;&lt;p&gt;&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“&lt;code&gt;sender&lt;/code&gt;æ–¹æ³•æ˜¯åœ¨&lt;code&gt;Prometheus&lt;/code&gt;å¯åŠ¨æ—¶&lt;code&gt;discoveryManagerScrape.Run()&lt;/code&gt;æ–¹æ³•ä¸­å¯åŠ¨ã€‚&lt;/p&gt;&lt;span&gt;â&lt;/span&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å–æ¶ˆæœåŠ¡å‘ç°ï¼šé…ç½®å˜æ›´ä¹Ÿä¼šè°ƒç”¨&lt;code&gt;ApplyConfig&lt;/code&gt;æ–¹æ³•ï¼Œè¿™æ—¶å°±è¦æŠŠåŸºäºä¹‹å‰é…ç½®è¿è¡Œçš„æœåŠ¡å‘ç°æœåŠ¡å–æ¶ˆï¼Œç„¶ååŸºäºå½“å‰é…ç½®é‡æ–°ç”Ÿæˆï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ¸…ç©ºï¼šä¸»è¦æ¸…ç©º&lt;code&gt;discoverCancel&lt;/code&gt;ã€&lt;code&gt;targets&lt;/code&gt;å’Œ&lt;code&gt;providers&lt;/code&gt;å‡ ä¸ªå®¹å™¨å…ƒç´ ï¼Œå› ä¸ºè¦åŸºäºå½“å‰é…ç½®é‡æ–°ç”Ÿæˆï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ³¨å†Œ&lt;code&gt;provider&lt;/code&gt;ï¼š&lt;code&gt;provider&lt;/code&gt;æ˜¯å¯¹&lt;code&gt;Discoverer&lt;/code&gt;çš„å°è£…ï¼Œä¸åŒæœåŠ¡å‘ç°åè®®éƒ½ä¼šå®ç°&lt;code&gt;Config&lt;/code&gt;æ¥å£ï¼Œå…¶ä¸­&lt;code&gt;NewDiscoverer&lt;/code&gt;æ–¹æ³•å°±æ˜¯åˆ›å»º&lt;code&gt;Discoverer&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€ŒPrometheusæœåŠ¡å‘ç°æ ¸å¿ƒå°±æ˜¯ä¸‰ä¸ªåç¨‹ä¹‹é—´åä½œï¼šã€&lt;/strong&gt;&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;ã€Œåç¨‹1ï¼šã€&lt;/strong&gt;è´Ÿè´£è¿è¡Œ&lt;code&gt;Discoverer&lt;/code&gt;æ¥å£&lt;code&gt;Run&lt;/code&gt;æ–¹æ³•ï¼ŒåŸºäºåè®®å‘ç°é‡‡é›†ç‚¹ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;ã€Œåç¨‹2ï¼šã€&lt;/strong&gt;è´Ÿè´£å°†åç¨‹1å‘ç°çš„é‡‡é›†ç‚¹ä¿¡æ¯æ›´æ–°åˆ°&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“ä¸­&lt;code&gt;targets&lt;/code&gt;å­—æ®µçš„&lt;code&gt;map&lt;/code&gt;ä¸­ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;ã€Œåç¨‹3ï¼šã€&lt;/strong&gt;è´Ÿè´£å°†&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“ä¸­&lt;code&gt;targets&lt;/code&gt;å­—æ®µçš„æ•°æ®é€šè¿‡é€šé“å‘é€ç»™&lt;code&gt;scrape&lt;/code&gt;æ¨¡å—ï¼›&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;scrapeæ¨¡å—è·å–åˆ°é‡‡é›†ç‚¹å¦‚ä½•è¿›è¡Œæ•°æ®é‡‡é›†åç»­scrapeæ¨¡å—åˆ†æã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;ç›‘æ§æŒ‡æ ‡&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;Prometheus&lt;/code&gt;æœåŠ¡å‘ç°é€šç”¨æŒ‡æ ‡ä¸»è¦æœ‰å¦‚ä¸‹5ä¸ªï¼Œéƒ½å®šä¹‰åœ¨&lt;code&gt;discovery/manager.go&lt;/code&gt;ä¸­ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;prometheus_sd_discovered_targets&lt;br/&gt;prometheus_sd_failed_configs&lt;br/&gt;prometheus_sd_received_updates_total&lt;br/&gt;prometheus_sd_updates_delayed_total&lt;br/&gt;prometheus_sd_updates_total&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œ1ã€é‡‡é›†ç‚¹æ•°é‡æŒ‡æ ‡ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœåŠ¡å‘ç°ä¸»è¦åŸºäºåè®®å‘ç°é‡‡é›†ç›®æ ‡ï¼Œ&lt;code&gt;prometheus_sd_discovered_targets&lt;/code&gt;æŒ‡æ ‡åé¦ˆå„ä¸ª&lt;code&gt;job&lt;/code&gt;å‘ç°çš„é‡‡é›†ç›®æ ‡æ•°ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;prometheus_sd_discovered_targetsï¼šgaugeç±»å‹ï¼Œå½“å‰å‘ç°çš„ç›®æ ‡æ•°&lt;br/&gt;config:jobåç§°&lt;br/&gt;nameï¼šå–å€¼scrapeå’Œnotifyï¼ŒåŒºåˆ†æŒ‡æ ‡æŠ“å–æœåŠ¡å‘ç°è¿˜æ˜¯å‘Šè­¦é€šçŸ¥æœåŠ¡å‘ç°&lt;br/&gt;ç¤ºä¾‹ï¼šprometheus_sd_discovered_targets{config=&lt;span&gt;&quot;auth_es1&quot;&lt;/span&gt;,Â name=&lt;span&gt;&quot;scrape&quot;&lt;/span&gt;}Â Â 12&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â&lt;/span&gt;&lt;p&gt;è¿™é‡ŒåŸºäºåè®®å‘ç°çš„ç›®æ ‡æ•°ï¼Œè¿˜æœªè¿›å…¥é‡‡é›†æ¨¡å—ï¼Œå¹¶ä¸èƒ½åŒºåˆ†æ˜¯åœ¨çº¿è¿˜æ˜¯ç¦»çº¿ã€‚&lt;/p&gt;&lt;span&gt;â&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œ2ã€æœåŠ¡å‘ç°åè®®å¼‚å¸¸é”™è¯¯æŒ‡æ ‡ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœåŠ¡å‘ç°ä¼šç»™æ¯ä¸ªå‘ç°é…ç½®é¡¹ç”Ÿæˆä¸€ä¸ª&lt;code&gt;provider&lt;/code&gt;ï¼Œå¹¶ä¸ºæ¯ä¸ª&lt;code&gt;provider&lt;/code&gt;ä½¿ç”¨åç¨‹è¿è¡Œï¼Œå¦‚æœåŸºäºé…ç½®é¡¹ç”Ÿæˆ&lt;code&gt;provider&lt;/code&gt;é”™è¯¯å°±å¯ä»¥é€šè¿‡&lt;code&gt;prometheus_sd_failed_configs&lt;/code&gt;æŒ‡æ ‡åé¦ˆï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;prometheus_sd_failed_configsï¼šgaugeç±»å‹ï¼Œå½“å‰æ— æ³•åŠ è½½çš„æœåŠ¡å‘ç°é…ç½®æ•°&lt;br/&gt;é…ç½®æ•°ï¼šä¸€ä¸ªjobå¯èƒ½å­˜åœ¨å¤šä¸ªæœåŠ¡å‘ç°åè®®é…ç½®ï¼Œå¯¹åº”é…ç½®é¡¹åˆ™æ˜¯å¤šä¸ª&lt;br/&gt;ç¤ºä¾‹ï¼š&lt;br/&gt;prometheus_sd_failed_configs{name=&lt;span&gt;&quot;scrape&quot;&lt;/span&gt;}Â Â 10&lt;br/&gt;prometheus_sd_failed_configs{name=&lt;span&gt;&quot;notify&quot;&lt;/span&gt;}Â 5&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸€ä¸ª&lt;code&gt;job&lt;/code&gt;å¯èƒ½å¯¹åº”å¤šä¸ªæœåŠ¡å‘ç°é…ç½®é¡¹ï¼Œå¦‚ä¸‹ï¼šè¿™ä¸ª&lt;code&gt;job&lt;/code&gt;ä¸‹é…ç½®äº†&lt;code&gt;static_configs&lt;/code&gt;å’Œ&lt;code&gt;file_sd_configs&lt;/code&gt;ä¸¤ä¸ªæœåŠ¡å‘ç°åè®®é…ç½®ï¼Œåˆ™å¯¹åº”ä¸¤ä¸ªæœåŠ¡å‘ç°é…ç½®é¡¹ï¼Œæ³¨å†Œä¸¤ä¸ª&lt;code&gt;provider&lt;/code&gt;ï¼Œæ¯ä¸ª&lt;code&gt;provider&lt;/code&gt;åœ¨ç‹¬ç«‹åç¨‹ä¸­è¿è¡Œï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;scrape_configs:&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;#Â TheÂ jobÂ nameÂ isÂ addedÂ asÂ aÂ labelÂ `job=`Â toÂ anyÂ timeseriesÂ scrapedÂ fromÂ thisÂ config.&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;job_name:&lt;/span&gt;Â &lt;span&gt;&#x27;test&#x27;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;static_configs:&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;targets:&lt;/span&gt;Â &lt;span&gt;[&#x27;localhost:9090&#x27;]&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;file_sd_configs:&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;refresh_interval:&lt;/span&gt;Â &lt;span&gt;5m&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;files:&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;-&lt;/span&gt;Â &lt;span&gt;targets/manual.*.json&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œ3ã€åç¨‹äº¤äº’æŒ‡æ ‡ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœåŠ¡å‘ç°ä¸»è¦æ¶‰åŠ3ç±»åç¨‹ï¼š&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Discovereråç¨‹&lt;/code&gt;(å¤šä¸ª)ï¼šå°è£…&lt;code&gt;provider&lt;/code&gt;ï¼ŒåŸºäºåè®®å‘ç°é‡‡é›†ç‚¹ï¼Œè¿™é‡Œå¯èƒ½ä¼šå­˜åœ¨å¤šä¸ªï¼Œä¸€ä¸ª&lt;code&gt;provider&lt;/code&gt;å¯¹åº”ä¸€ä¸ª&lt;code&gt;Discovereråç¨‹&lt;/code&gt;ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;updateråç¨‹&lt;/code&gt;(1ä¸ª)ï¼š&lt;code&gt;Discovereråç¨‹&lt;/code&gt;å‘ç°é‡‡é›†ç‚¹ï¼Œé€šè¿‡&lt;code&gt;channelé€šé“&lt;/code&gt;é€šçŸ¥åˆ°&lt;code&gt;updateråç¨‹&lt;/code&gt;ï¼Œ&lt;code&gt;updateråç¨‹&lt;/code&gt;å°†é‡‡é›†ç‚¹æ›´æ–°åˆ°&lt;code&gt;Managerç»“æ„ä½“&lt;/code&gt;ä¸­&lt;code&gt;targetså­—æ®µ&lt;/code&gt;ä¸­ï¼Œç„¶åå‘&lt;code&gt;Managerç»“æ„ä½“&lt;/code&gt;ä¸­&lt;code&gt;triggerSendé€šé“&lt;/code&gt;å†™å…¥æ•°æ®ï¼Œå‘Šè¯‰&lt;code&gt;sender&lt;/code&gt;åç¨‹&lt;code&gt;targets&lt;/code&gt;æœ‰æ›´æ–°ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;senderåç¨‹&lt;/code&gt;(1ä¸ª)ï¼š&lt;code&gt;senderåç¨‹&lt;/code&gt;æ¯5ç§’æ£€æµ‹&lt;code&gt;triggerSend&lt;/code&gt;é€šé“æ•°æ®ï¼Œæ£€æµ‹åˆ°æ›´æ–°åˆ™å°†&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“&lt;code&gt;targets&lt;/code&gt;æ•°æ®å¤„ç†å°è£…å†™å…¥åˆ°&lt;code&gt;Manager&lt;/code&gt;ç»“æ„ä½“&lt;code&gt;syncCh&lt;/code&gt;é€šé“ä¸­ï¼Œ&lt;code&gt;scrape&lt;/code&gt;æ¨¡å—ç›‘æµ‹è¯¥é€šé“ï¼Œå³å®Œæˆå°†&lt;code&gt;æœåŠ¡å‘ç°æ¨¡å—&lt;/code&gt;å’Œ&lt;code&gt;scrapeæ¨¡å—&lt;/code&gt;äº¤äº’ã€‚&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™å…¶ä¸­æ¶‰åŠä¸‰ä¸ªæŒ‡æ ‡ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;prometheus_sd_received_updates_total&lt;br/&gt;prometheus_sd_updates_delayed_total&lt;br/&gt;prometheus_sd_updates_total&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>114195ddd3f824377dc69b0bba53a96d</guid>
<title>Go åœ¨ä¿¡åˆ›è¿™ä¸€å—ä¼šè¾“ç»™ Javaï¼Œæƒ³ä¸é€šã€‚ã€‚ã€‚</title>
<link>https://toutiao.io/k/zxonbvt</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æŠ•ç¨¿çš„ç½‘å‹è‰è“ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Go è¯­è¨€å·²ç»å¼€æº 10+ å¹´ï¼Œä»é«˜çš„å…³æ³¨åº¦ï¼Œå†åˆ°äº‘åŸç”Ÿæ—¶ä»£å¼•çˆ†å­¦ä¹  Go çš„æµªæ½®ï¼Œå†åˆ°ç°åœ¨çš„æ•°å¹´åã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¶æœç´¢çƒ­åº¦å’Œ TIOBE æ’ååŸºæœ¬ç»´æŒå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7439165701042874&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KVl0giak5ib4jund4TOYhNBWo4zNT6Rt30zibzkR6cTDmFfc7TicMLZTgpX0MVUr9KNGBORrHClqfvfuDNBlzxicbmg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1726&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€æ–°çš„æ’åç¬¬æ˜¯ç¬¬ 11 åã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥å¾€æˆ‘åœ¨ç½‘ä¸Šå¸¸å¸¸çœ‹åˆ°å¤§å®¶è®¨è®ºçš„ Go vs Javaï¼Œå¤§å®¶åŸºæœ¬éƒ½æ˜¯ä»æŠ€æœ¯çš„è§’åº¦åˆ†æï¼Œå¯¹æ¯”ä¸¤è€…çš„å„ç±»æˆæœ¬ã€ç‰¹æ€§ï¼Œå­°å¼ºå­°å¼±ã€‚æŠ€æœ¯è§’åº¦ä¸Šå†³å®šå¦‚ä½•é€‰å‹ã€è¯­è¨€çš„ä¼˜åŠ£åŠ¿ç­‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ç¯‡æ–‡ç« ä¼šæŠ›å¼€å•çº¯æŠ€æœ¯å±‚é¢æ¥çœ‹ï¼Œç›´æ¥è®²é‡ç‚¹å†…å®¹ï¼ˆçŸ­æ–‡ï¼‰ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ä¼ä¸šçš„ä¸€äº›è¦æ±‚&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€è¿‘å‡ å¹´æ¥è§¦å„ç±»å›½å¤®ä¼çš„ä¸šåŠ¡å¤šäº†åï¼Œåœ¨å›½å†…å‘ç°äº†ä¸€ä¸ªå½±å“ Go è¯­è¨€å‘å±•çš„è‡´å‘½é—®é¢˜æˆ–ç°è±¡ã€‚&lt;span&gt;å¥½å®¶ä¼™ï¼Œäººå®¶çš„é¢„æ‹›æ ‡ã€æ‹›æ ‡ä¹¦ä¸Šï¼Œå°±ä¼šç›´æ¥è¦æ±‚éœ€è¦ Java è¯­è¨€å¼€å‘ã€è¦èƒ½å¤Ÿæ”¯æŒäº‘åŸç”Ÿç¯å¢ƒç­‰ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŸå› ä¸€ï¼šä¿¡åˆ›ï¼Œå¯¹äºè¿™ç±»çš„æ›¿æ¢åŸåˆ™ï¼ˆåˆ†çº§åˆ†ç±»é€æ­¥æ¨è¿›åº”æ›¿å°½æ›¿ï¼‰ï¼Œå°†ä¼šå¯¼è‡´è¿™å®¶ä¼ä¸šé Java è¯­è¨€çš„æŠ•æ ‡å¯èƒ½ä¸èƒ½å…¥é€‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŸå› äºŒï¼šJava ç¾¤ä½“è¿‡äºåºå¤§ï¼Œå¾ˆå¤šæœ‰å¹´ä»£çš„ä¼ä¸šç³»ç»Ÿæ—©æœŸå»ºè®¾ã€å¤–åŒ…éƒ½é‡‡å–äº† Java ä½“ç³»æ¥å¼€å‘ã€‚æˆç†Ÿã€ä¾¿å®œã€å¥½æ‹›äººç­‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;çœ‹å®Œä½ ä¼šæƒ³è¿™å°±æ˜¯é Java åˆ«æ¥ï¼Œå’±ä»¬ Go èƒ½ä¸èƒ½è¡Œï¼Ÿæ€ä¹ˆ Java å°±æ²¡é—®é¢˜äº†ï¼Ÿ&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ä¸èƒ½ç”¨ Goï¼Œå› ä¸º Google&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœä½ æ˜¯ç”¨ Go è¯­è¨€å†™çš„ï¼Œå°´å°¬çš„æƒ…å†µå°±ä¼šå‡ºç°ã€‚å¦‚æœç”²æ–¹æœ‰æ˜ç¡®è¦æ±‚ï¼Œä¸€æ—¦ä½ å‘ç”²æ–¹è§£é‡Šï¼Œå¹¶ç»™å‡ºå¯¹åº”çš„è¯­è¨€æ¸…å•ã€‚å°±ä¼šå‡ºç°ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šGo è¯­è¨€æ˜¯ï¼ŸèƒŒæ™¯ï¼Ÿå½’å±ï¼Ÿ&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ–æ˜¯å»æœç´¢ã€‚å°±ä¼šå‘ç°ä»¥ä¸‹çš„æƒ…å†µï¼š&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2541766109785203&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KVl0giak5ib4jund4TOYhNBWo4zNT6Rt30QsWDoLAdR5QpBLnMC6ezEXUtib3iaDCSCmZpG7C6ibyQ3szpDw8JQuOyg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1676&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åˆæˆ–æ˜¯ï¼š&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6237424547283702&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/KVl0giak5ib4jund4TOYhNBWo4zNT6Rt30cGb9pC4KMPISmaryhlCOfE5jLMgNnAicrwAIorhEUq6AndwkHGUxytw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;994&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¼šå‡ºç°ä»¥ä¸‹ç±»ä¼¼çš„è¨€è®ºï¼šGo è¯­è¨€æ˜¯ Google å¼€å‘çš„ï¼Œå¦‚æœä¸€æ—¦ ZM å…¨é¢è„±é’©ï¼ŒGitHub ä¼šè¢«å°ï¼Œè¿™é—¨è¯­è¨€ä¹Ÿå¾ˆå®¹æ˜“å°±ä¼šè¢«ç¦æ­¢ä½¿ç”¨ã€‚&lt;span&gt;è¿™å°†ä¼šä½¿å¾— Go è¯­è¨€åœ¨éƒ¨åˆ†å›½å¤®ä¼ç§æœ‰åŒ–çš„æ‹›æŠ•æ ‡ä¸Šï¼Œç›´æ¥æ— æ³•ä¸ Java ç³»çš„å…¶ä»–ä¾›åº”å•†ç«äº‰ã€‚&lt;/span&gt;&lt;span&gt;Go å°±è¢«å¡è„–å­äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°¤å…¶æ˜¯ç°åœ¨è¡Œæƒ…ä¸å¥½æ—¶ï¼Œ&lt;span&gt;ä¼ä¸š&lt;/span&gt;&lt;span&gt;æœ¬èº«ä¹Ÿä¼šå—åˆ°è¾ƒå¤§çš„å†²å‡»ã€‚å¯¹æ­¤é™·å…¥æ²‰æ€ï¼ŒæŠ±æœ‰è¾ƒå¤§çš„æŒ£æ‰ï¼Œä¼šæ€è€ƒè¦ä¸è¦æ¢ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;æ€è€ƒ&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Go è¯­è¨€çš„æ ¸å¿ƒå¼€å‘å›¢é˜Ÿï¼Œå¤§å¤šä»åœ¨ Googleã€‚Google ä¸ºä»–ä»¬æä¾›äº†å·¥ä½œã€è–ªé…¬ã€èµ„æºã€‚è®©è¿™é—¨è¯­è¨€åœ¨å­µåŒ–ã€æˆé•¿æœŸä¸éœ€è¦é‡åˆ°å¤ªå¤šçš„ç”Ÿå­˜é—®é¢˜ã€‚çŸ­æ—¶é—´å†…ï¼ŒGo è¯­è¨€ä¸å¤§å¯èƒ½è‡ªå·±å¼€åˆ›åŸºé‡‘ä¼šï¼Œå› ä¸ºå·²ç»æœ‰äº†é‡‘ä¸»çˆ¸çˆ¸ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œæˆ‘ä»¬åœ¨å›½å†…çš„è¿›ä¸€æ­¥åº”ç”¨ä¸­ï¼Œå¾ˆå¤šä¼šè€ƒè™‘åˆ°ä¼ä¸šå†…éƒ¨çš„å›½äº§åŒ–ã€è‡ªä¸»å¯æ§ã€æŠ€æœ¯ä½“ç³»å»ºè®¾ç­‰é—®é¢˜ã€‚åœ¨ Go è¯­è¨€è¯•å›¾å’Œ Java è¯­è¨€åˆ†è›‹ç³•æ—¶ï¼Œä»ç„¶æ˜¯ä¼šå¤„äºç›¸å¯¹åŠ£åŠ¿çš„ä¸€ä¸ªå¤§å‘ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è½åˆ°ç°å®å¤„ï¼Œå¦‚æœåˆ©æ¶¦å¤Ÿå¤§ï¼Œ è¿™äº›åº”ç”¨çš„ Go å¼€å‘æ•´ä½“éƒ½ä¼šè¢«è¿«è½¬æˆ Java å¼€å‘ï¼Œå±Šæ—¶ï¼Œä½ è·Ÿä¸è·Ÿï¼Ÿ&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™æ˜¯ä¸€ä¸ªå€¼å¾—æ·±æ€çš„é—®é¢˜ã€‚&lt;span&gt;æ¯•ç«Ÿä»Šå¤©æ˜¯ Javaï¼Œæ˜å¤©å¯èƒ½å°±æ˜¯ PHPã€C#ã€C++...è®²é“ç†ï¼Œä¸ºä»€ä¹ˆ Java å°±ç¬¦åˆè¦æ±‚äº†ï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¨èé˜…è¯»&lt;/h4&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;å…³æ³¨å’ŒåŠ ç…é±¼å¾®ä¿¡ï¼Œ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ä¸€æ‰‹æ¶ˆæ¯å’ŒçŸ¥è¯†ï¼Œæ‹‰ä½ è¿›æŠ€æœ¯äº¤æµç¾¤&lt;span&gt;&lt;span&gt;ğŸ‘‡&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9988738738738738&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/KVl0giak5ib4jVkzHVvaqjo3O0BIqDRJKkEyib7SJsryxHBFGsvek0FkdiczfJP6AdbWnK25DvlX3dY8wRObPbVJQg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;888&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.07106598984771574&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/486RHs1WbcgGib6o96dHbvGUGGwPicd8wusUGH1cXR29tM4bO0lNzialzkQhvU6m5ZUdaKibmcF2OQayjMe9Bia6iaXQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;394&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ä½ å¥½ï¼Œæˆ‘æ˜¯ç…é±¼ï¼Œ&lt;span&gt;å‡ºç‰ˆè¿‡ Go ç•…é”€ä¹¦ã€ŠGo è¯­è¨€ç¼–ç¨‹ä¹‹æ—…ã€‹ï¼Œå†åˆ°è·å¾— GOPï¼ˆGo é¢†åŸŸæœ€æœ‰è§‚ç‚¹ä¸“å®¶ï¼‰è£èª‰ï¼Œ&lt;/span&gt;&lt;strong&gt;&lt;span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxMDI4MDc1NA==&amp;amp;mid=2247483854&amp;amp;idx=1&amp;amp;sn=ec422fbf4d846975f2930ddeb5e81373&amp;amp;chksm=f9041493ce739d85a4b987eece14da627206cdad798f645cc770868312e4a22b6df24804f186&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ç‚¹å‡»è“å­—æŸ¥çœ‹æˆ‘çš„å‡ºä¹¦ä¹‹è·¯&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;ç‚¹å‡»è“å­—æŸ¥çœ‹æˆ‘çš„å‡ºä¹¦ä¹‹è·¯&lt;/a&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;æ—¥å¸¸åˆ†äº«é«˜è´¨é‡æ–‡ç« ï¼Œè¾“å‡º Go é¢è¯•ã€å·¥ä½œç»éªŒã€æ¶æ„è®¾è®¡ï¼Œ&lt;span&gt;åŠ å¾®ä¿¡æ‹‰è¯»è€…äº¤æµç¾¤ï¼Œå’Œå¤§å®¶äº¤æµï¼&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>b2a02b4c06759ff9e32a6ae7b069363d</guid>
<title>ç”¨ Three.js æ„å»ºä¸‰ç»´ä¸–ç•Œçš„æˆ¿å­</title>
<link>https://toutiao.io/k/tc75ecp</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;æ–‡ç« ç¯‡å¹…ä¼šæ¯”è¾ƒé•¿ï¼Œè¯·è€å¿ƒçœ‹å®Œï¼Œä½†æ˜¯ä¸€å®šä¼šæ”¶è´§æ»¡æ»¡ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€è¿‘åœ¨å­¦ä¹ Three.jsï¼Œæ— å¥ˆä¸çŸ¥é“ä»å“ªé‡Œä¸‹æ‰‹ï¼ŒæŸ¥é˜…å¤§éƒ¨åˆ†èµ„æ–™éƒ½æ˜¯å…ˆä»‹ç»æ¸²æŸ“å™¨ï¼ˆRendererï¼‰ã€åœºæ™¯ï¼ˆSceneï¼‰ã€ç…§ç›¸æœºï¼ˆCameraï¼‰ï¼Œå…¶å®è¿™äº›æ¦‚å¿µç¡®å®éœ€è¦äº†è§£ï¼Œå¦‚æœä¸ç»™ä½ ç«‹ä½“æ¨¡å‹ï¼Œä½ å§‹ç»ˆæ˜¯æ— æ³•ç†è§£çš„ã€‚ç½‘ä¸Šçœ‹äº†ä¸€ä¸ªå¤§ä½¬ï¼ˆç¥è¯´è¦æœ‰å…‰ï¼‰çš„æ•™ç¨‹ï¼Œæ„Ÿè§‰ç®—æ˜¯ä¸€åªè„šå·²ç»å…¥äº†é—¨ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä»é€ ç‰©ä¸»çš„è§†è§’å¼€å§‹åˆ›å»ºä¸€ä¸ªæˆ¿å­ã€‚æˆ‘ä»¬å…ˆçœ‹ä¸‹æœ€ç»ˆæ•ˆæœã€‚Â &lt;/p&gt;&lt;section/&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;1 åˆ›é€ ä¸–ç•Œ&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æˆ‘ä»¬ç°åœ¨çœ‹åˆ°çš„ä¸–ç•Œï¼Œç”¨Three.jsåšå‡ºæ¥ã€‚æ•ˆæœå¦‚ä¸‹&lt;/p&gt;&lt;section/&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;br/&gt;é¦–å…ˆå¯¹Three.jsè¿˜æ˜¯è¦äº†è§£å…¶ä¸€äº›æ¦‚å¿µçš„ï¼Œè¿™æ ·æ‰èƒ½çœ‹çš„æ›´æ˜ç™½ã€‚æ–°å»ºä¸€ä¸ªé¡¹ç›®ï¼Œå¼•å…¥Three.jsï¼Œç½‘ä¸Šä¸å¥½jsæ‰¾æ²¡å…³ç³»ï¼Œæˆ‘ä¼šåœ¨æœ€åæä¾›æœ¬ç¯‡æ–‡ç« çš„å®Œæ•´demoã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»ºåœºæ™¯&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;Â &lt;span&gt;const&lt;/span&gt;Â sceneÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Scene();&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»ºé€è§†ç›¸æœº&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â è·å–çª—å£æ–‡æ¡£åŒºåŸŸçš„å®½åº¦&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â widthÂ =Â &lt;span&gt;window&lt;/span&gt;.innerWidth;&lt;br/&gt;&lt;span&gt;//Â è·å–çª—å£æ–‡æ¡£åŒºåŸŸçš„é«˜åº¦&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â heightÂ =Â &lt;span&gt;window&lt;/span&gt;.innerHeight;&lt;br/&gt;&lt;span&gt;//Â åˆ›å»ºé€è§†ç›¸æœº&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â cameraÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.PerspectiveCamera(&lt;span&gt;45&lt;/span&gt;,Â &lt;span&gt;window&lt;/span&gt;.innerWidthÂ /Â &lt;span&gt;window&lt;/span&gt;.innerHeight,Â &lt;span&gt;0.1&lt;/span&gt;,Â &lt;span&gt;10000&lt;/span&gt;);&lt;br/&gt;&lt;span&gt;//Â ç›¸æœºä½ç½®&lt;/span&gt;&lt;br/&gt;camera.position.set(&lt;span&gt;500&lt;/span&gt;,Â &lt;span&gt;60&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;//Â ç›¸æœºç„¦ç‚¹æ–¹å‘&lt;/span&gt;&lt;br/&gt;camera.lookAt(scene.position);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»ºæ¸²æŸ“å™¨&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åˆ›å»ºWebGLæ¸²æŸ“&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â rendererÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.WebGLRenderer();&lt;br/&gt;&lt;span&gt;//Â è®¾ç½®canvasçš„å¤§å°&lt;/span&gt;&lt;br/&gt;renderer.setSize(width,Â height);&lt;br/&gt;&lt;span&gt;//è®¾ç½®èƒŒæ™¯é¢œè‰²&lt;/span&gt;&lt;br/&gt;renderer.setClearColor(&lt;span&gt;0xcce0ff&lt;/span&gt;,Â &lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;&lt;span&gt;//Â æ·»åŠ åˆ°body&lt;/span&gt;&lt;br/&gt;&lt;span&gt;document&lt;/span&gt;.body.appendChild(renderer.domElement);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;æ¸²æŸ“ç›¸æœºå’Œåœºæ™¯&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;Â renderer.render(scene,Â camera);&lt;br/&gt;Â requestAnimationFrame(render)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åœºæ™¯è´´å›¾&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;let&lt;/span&gt;Â urlsÂ =Â [&lt;br/&gt;Â Â Â Â Â &lt;span&gt;&#x27;./img/skyBox6/posx.jpg&#x27;&lt;/span&gt;,&lt;br/&gt;Â Â Â Â Â &lt;span&gt;&#x27;./img/skyBox6/negx.jpg&#x27;&lt;/span&gt;,&lt;br/&gt;Â Â Â Â &lt;span&gt;&#x27;./img/skyBox6/posy.jpg&#x27;&lt;/span&gt;,&lt;br/&gt;Â Â Â Â &lt;span&gt;&#x27;./img/skyBox6/negy.jpg&#x27;&lt;/span&gt;,&lt;br/&gt;Â Â Â Â &lt;span&gt;&#x27;./img/skyBox6/posz.jpg&#x27;&lt;/span&gt;,&lt;br/&gt;Â Â Â Â &lt;span&gt;&#x27;./img/skyBox6/negz.jpg&#x27;&lt;/span&gt;&lt;br/&gt;];&lt;br/&gt;&lt;span&gt;let&lt;/span&gt;Â cubeTextureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.CubeTextureLoader().load(urls);&lt;br/&gt;scene.backgroundÂ =Â cubeTexture;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€ç»ˆæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸Šé¢çš„ä¸€ä¸ªæ—‹è½¬çš„ä¸–ç•Œã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;2 åˆ›å»ºä¸€ä¸ªåœ°é¢&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸Šé¢çš„æ­¥éª¤åªæ˜¯åˆ›å»ºäº†å…¨æ™¯çš„ä¸–ç•Œï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦æœ‰ä¸ªåœ°é¢æ¥æ”¾ç½®æˆ‘ä»¬ä¹‹åè¦åˆ›å»ºçš„æˆ¿å­ï¼Œå› æ­¤ï¼Œè¿™ä¸ªåœ°é¢è¦æ¯”è¾ƒå¤§ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»º&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–¹æ³•æ¥åˆ›å»ºï¼Œåé¢åªéœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•å³å¯&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createGrass&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â &lt;span&gt;//Â åˆ›å»ºä¸€ä¸ªå¹³é¢ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;const&lt;/span&gt;Â geometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.PlaneGeometry(&lt;span&gt;10000&lt;/span&gt;,Â &lt;span&gt;10000&lt;/span&gt;);&lt;br/&gt;Â Â &lt;span&gt;//Â åŠ è½½è‰åœ°å›¾ç‰‡&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;const&lt;/span&gt;Â textureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.TextureLoader().load(&lt;span&gt;&quot;img/grass.jpg&quot;&lt;/span&gt;);&lt;br/&gt;Â Â texture.wrapSÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â texture.wrapTÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â &lt;span&gt;//Â çº¹ç†å¯¹è±¡é˜µåˆ—&lt;/span&gt;&lt;br/&gt;Â Â texture.repeat.set(&lt;span&gt;100&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;);&lt;br/&gt;Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;const&lt;/span&gt;Â grassMaterialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;map&lt;/span&gt;:Â textureÂ });&lt;br/&gt;Â Â &lt;span&gt;//Â ç½‘æ ¼&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;const&lt;/span&gt;Â grassÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(geometry,Â grassMaterial);&lt;br/&gt;Â Â &lt;span&gt;//Â æ—‹è½¬&lt;/span&gt;&lt;br/&gt;Â Â grass.rotation.xÂ =Â &lt;span&gt;-0.5&lt;/span&gt;Â *Â &lt;span&gt;Math&lt;/span&gt;.PI;&lt;br/&gt;Â Â &lt;span&gt;//Â æ·»åŠ åˆ°åœºæ™¯&lt;/span&gt;&lt;br/&gt;Â Â scene.add(grass);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ•ˆæœ&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAlfzPR39qeNKtZI80JdxUxlpJmKHcLg8paBV3r8icBl559LDwmf4rGSWg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;3 å»ºæˆ¿å­&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬å…ˆè¯´è¯´ç°å®ä¸­å¦‚ä½•æ–°å»ºæˆ¿å­&lt;br/&gt;1 é€‰ä¸€ä¸ªåœ°æ–¹å½“ä½œåœ°åŸº&lt;br/&gt;2 å’å¢™ï¼ˆå¢™é¢ï¼‰&lt;br/&gt;3 å°é¡¶ï¼ˆæˆ¿é¡¶ï¼‰&lt;br/&gt;å…¶å®ç”¨Threejsä¹Ÿæ˜¯ä¸€æ ·&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»ºåœ°åŸºï¼ˆåœ°æ¿ï¼‰&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åˆ›å»ºåœ°æ¿æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createFloor&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åˆ›å»ºä¸€ä¸ªå¹³é¢ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â geometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.PlaneGeometry(&lt;span&gt;200&lt;/span&gt;,Â &lt;span&gt;300&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŠ è½½åœ°æ¿å›¾ç‰‡&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â textureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.TextureLoader().load(&lt;span&gt;&#x27;img/wood.jpg&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â texture.wrapSÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â Â Â texture.wrapTÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â çº¹ç†å¯¹è±¡é˜µåˆ—&lt;/span&gt;&lt;br/&gt;Â Â Â Â texture.repeat.set(&lt;span&gt;2&lt;/span&gt;,Â &lt;span&gt;2&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â materialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;map&lt;/span&gt;:Â textureÂ });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ç½‘æ ¼&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â floorÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(geometry,Â material);&lt;br/&gt;&lt;br/&gt;Â Â Â Â floor.rotation.xÂ =Â &lt;span&gt;-0.5&lt;/span&gt;Â *Â &lt;span&gt;Math&lt;/span&gt;.PI;&lt;br/&gt;Â Â Â Â floor.position.yÂ =Â &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;Â Â Â Â floor.position.zÂ =Â &lt;span&gt;150&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åœ°æ¿æ·»åŠ åˆ°æˆ¿é—´&lt;/span&gt;&lt;br/&gt;Â Â Â Â house.add(floor);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAldhVPe1TVnIXqQADDFdHbrXoVe1y1HknQggdEKzdveibDy8Fmvqic9hjw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»ºä¾§å¢™&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åˆ›å»ºæµ‹å¢™æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createSideWall&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åˆ›å»ºå½¢çŠ¶&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â shapeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Shape();&lt;br/&gt;Â Â Â Â shape.moveTo(&lt;span&gt;-100&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;100&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;100&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;150&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;-100&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;-100&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â æŒ¤å‹ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â extrudeGeometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.ExtrudeGeometry(shape,Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;depth&lt;/span&gt;:Â &lt;span&gt;5&lt;/span&gt;&lt;br/&gt;Â Â Â Â });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŠ è½½å¢™é¢å›¾ç‰‡&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â textureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.TextureLoader().load(&lt;span&gt;&#x27;./img/wall.jpg&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â texture.wrapSÂ =Â texture.wrapTÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â Â Â texture.repeat.set(&lt;span&gt;0.01&lt;/span&gt;,Â &lt;span&gt;0.005&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;var&lt;/span&gt;Â materialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;map&lt;/span&gt;:Â textureÂ });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ç½‘æ ¼&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â sideWallÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(extrudeGeometry,Â material);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å¢åŠ å¢™é¢&lt;/span&gt;&lt;br/&gt;Â Â Â Â house.add(sideWall);&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â sideWall;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¾§å¢™æœ‰ä¸¤ä¸ªæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æ˜¯ä½ç½®ï¼ˆåæ ‡ï¼‰ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬åªéœ€è¦æŒªä¸‹ä½ç½®å³å¯ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åˆ›å»ºä¾§å¢™&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â sideWall2Â =Â createSideWall();&lt;br/&gt;&lt;span&gt;//Â ä¾§å¢™å‘zè½´ç§»åŠ¨&lt;/span&gt;&lt;br/&gt;sideWall2.position.zÂ =Â &lt;span&gt;295&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAljnn4ZtS7OM21d1JdZf7f4ssNzXBNOJLrZIflmqaaJg5eiasSpFZj8ag/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;åˆ›å»ºå‰é¢çš„å¢™&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å› ä¸ºå‰é¢çš„å¢™ä¸Šæœ‰é—¨å’Œçª—æˆ·ï¼Œå› æ­¤æˆ‘ä»¬å•ç‹¬åˆ›å»º&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â å‰é¢å¢™çš„æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createFrontWall&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åˆ›å»ºå½¢çŠ¶&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â shapeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Shape();&lt;br/&gt;Â Â Â Â shape.moveTo(&lt;span&gt;-150&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;150&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;150&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;-150&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;-150&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åˆ›å»ºçª—æˆ·&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â &lt;span&gt;window&lt;/span&gt;Â =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Path();&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.moveTo(&lt;span&gt;30&lt;/span&gt;,Â &lt;span&gt;30&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.lineTo(&lt;span&gt;80&lt;/span&gt;,Â &lt;span&gt;30&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.lineTo(&lt;span&gt;80&lt;/span&gt;,Â &lt;span&gt;80&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.lineTo(&lt;span&gt;30&lt;/span&gt;,Â &lt;span&gt;80&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.lineTo(&lt;span&gt;30&lt;/span&gt;,Â &lt;span&gt;30&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å½¢çŠ¶ä¸Šçš„å­”æ´&lt;/span&gt;&lt;br/&gt;Â Â Â Â shape.holes.push(&lt;span&gt;window&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åˆ›å»ºé—¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â doorÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Path();&lt;br/&gt;Â Â Â Â door.moveTo(&lt;span&gt;-30&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â Â door.lineTo(&lt;span&gt;-30&lt;/span&gt;,Â &lt;span&gt;80&lt;/span&gt;)&lt;br/&gt;Â Â Â Â door.lineTo(&lt;span&gt;-80&lt;/span&gt;,Â &lt;span&gt;80&lt;/span&gt;)&lt;br/&gt;Â Â Â Â door.lineTo(&lt;span&gt;-80&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â door.lineTo(&lt;span&gt;-30&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å½¢çŠ¶ä¸Šçš„å­”æ´&lt;/span&gt;&lt;br/&gt;Â Â Â Â shape.holes.push(door);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â æŒ¤å‹ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â extrudeGeometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.ExtrudeGeometry(shape,Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;depth&lt;/span&gt;:Â &lt;span&gt;5&lt;/span&gt;&lt;br/&gt;Â Â Â Â })&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â è´´å›¾&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â textureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.TextureLoader().load(&lt;span&gt;&#x27;./img/wall.jpg&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â texture.wrapSÂ =Â texture.wrapTÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â Â Â texture.repeat.set(&lt;span&gt;0.01&lt;/span&gt;,Â &lt;span&gt;0.005&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â materialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;map&lt;/span&gt;:Â textureÂ });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ç½‘æ ¼&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â frontWallÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(extrudeGeometry,Â material);&lt;br/&gt;&lt;br/&gt;Â Â Â Â frontWall.position.zÂ =Â &lt;span&gt;150&lt;/span&gt;;&lt;br/&gt;Â Â Â Â frontWall.position.xÂ =Â &lt;span&gt;95&lt;/span&gt;;&lt;br/&gt;Â Â Â Â frontWall.rotation.yÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ *Â &lt;span&gt;0.5&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å‰å¢™æ·»åŠ åˆ°æˆ¿é—´&lt;/span&gt;&lt;br/&gt;Â Â Â Â house.add(frontWall);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAlBXfdo4nF0wBmzcgvdd11ibibCNPtCdafwtJibzUQyMkIjLQ6Kc8xJUia0w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™æ ·é—¨å’Œçª—æˆ·å°±æœ‰äº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åŠ ç‚¹è£…é¥°&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â çª—æˆ·ä¿®é¥°&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createWindow&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â shapeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Shape();&lt;br/&gt;Â Â Â Â shape.moveTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;50&lt;/span&gt;,Â &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;50&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â holeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Path();&lt;br/&gt;Â Â Â Â hole.moveTo(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;)&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;45&lt;/span&gt;)&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;45&lt;/span&gt;,Â &lt;span&gt;45&lt;/span&gt;)&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;45&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;);&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.holes.push(hole);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â æŒ¤å‹ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â extrudeGeometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.ExtrudeGeometry(shape,Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;depth&lt;/span&gt;:Â &lt;span&gt;5&lt;/span&gt;&lt;br/&gt;Â Â Â Â });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;var&lt;/span&gt;Â extrudeMaterialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;color&lt;/span&gt;:Â &lt;span&gt;&#x27;silver&#x27;&lt;/span&gt;Â });&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;var&lt;/span&gt;Â &lt;span&gt;window&lt;/span&gt;Â =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(extrudeGeometry,Â extrudeMaterial);&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.rotation.yÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;2&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.position.yÂ =Â &lt;span&gt;30&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.position.xÂ =Â &lt;span&gt;95&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;window&lt;/span&gt;.position.zÂ =Â &lt;span&gt;120&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â Â Â Â house.add(&lt;span&gt;window&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;window&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;span&gt;//Â é—¨ä¿®é¥°&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createDoor&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â shapeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Shape();&lt;br/&gt;Â Â Â Â shape.moveTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;80&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;50&lt;/span&gt;,Â &lt;span&gt;80&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;50&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â holeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Path();&lt;br/&gt;Â Â Â Â hole.moveTo(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;);&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;75&lt;/span&gt;);&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;45&lt;/span&gt;,Â &lt;span&gt;75&lt;/span&gt;);&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;45&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;);&lt;br/&gt;Â Â Â Â hole.lineTo(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;);&lt;br/&gt;Â Â Â Â shape.holes.push(hole);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â æŒ¤å‹ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â extrudeGeometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.ExtrudeGeometry(shape,Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;depth&lt;/span&gt;:Â &lt;span&gt;5&lt;/span&gt;&lt;br/&gt;Â Â Â Â });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â materialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;color&lt;/span&gt;:Â &lt;span&gt;&#x27;silver&#x27;&lt;/span&gt;Â });&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â doorÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(extrudeGeometry,Â material);&lt;br/&gt;&lt;br/&gt;Â Â Â Â door.rotation.yÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;2&lt;/span&gt;;&lt;br/&gt;Â Â Â Â door.position.yÂ =Â &lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;Â Â Â Â door.position.xÂ =Â &lt;span&gt;95&lt;/span&gt;;&lt;br/&gt;Â Â Â Â door.position.zÂ =Â &lt;span&gt;230&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â Â Â Â house.add(door);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAlsFVKU1o9eRGvUC6Tibmg30WmBTibNXYBGh25icEerySLe1GPxBuzlZB3A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åˆ›å»ºåå¢™&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åˆ›å»ºåå¢™æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createBackWall&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åˆ›å»ºå½¢çŠ¶&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â shapeÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Shape();&lt;br/&gt;Â Â Â Â shape.moveTo(&lt;span&gt;-150&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;150&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;150&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;Â Â Â Â shape.lineTo(&lt;span&gt;-150&lt;/span&gt;,Â &lt;span&gt;100&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â æŒ¤å‹ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â extrudeGeometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.ExtrudeGeometry(shape)&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â è´´å›¾&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â textureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.TextureLoader().load(&lt;span&gt;&#x27;./img/wall.jpg&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â texture.wrapSÂ =Â texture.wrapTÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â Â Â texture.repeat.set(&lt;span&gt;0.01&lt;/span&gt;,Â &lt;span&gt;0.005&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â materialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;map&lt;/span&gt;:Â textureÂ });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ç½‘æ ¼&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â backWallÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(extrudeGeometry,Â material);&lt;br/&gt;&lt;br/&gt;Â Â Â Â backWall.position.zÂ =Â &lt;span&gt;150&lt;/span&gt;;&lt;br/&gt;Â Â Â Â backWall.position.xÂ =Â &lt;span&gt;-100&lt;/span&gt;;&lt;br/&gt;Â Â Â Â backWall.rotation.yÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ *Â &lt;span&gt;0.5&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åå¢™æ·»åŠ åˆ°æˆ¿é—´ä¸­&lt;/span&gt;&lt;br/&gt;Â Â Â Â house.add(backWall);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAl95lhAt0XxVzle8UicbpwIJPhlHVguavibPkmXhcNgIlq4woHLQEQbjRw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å±‹é¡¶&lt;span/&gt;&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åˆ›å»ºå±‹é¡¶æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt;Â &lt;span&gt;createRoof&lt;/span&gt;(&lt;span/&gt;)Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ç«‹æ–¹ç¼“å†²å‡ ä½•ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â geometryÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.BoxGeometry(&lt;span&gt;120&lt;/span&gt;,Â &lt;span&gt;320&lt;/span&gt;,Â &lt;span&gt;5&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â textureÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.TextureLoader().load(&lt;span&gt;&#x27;./img/tile.jpg&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â texture.wrapSÂ =Â texture.wrapTÂ =Â THREE.RepeatWrapping;&lt;br/&gt;Â Â Â Â texture.repeat.set(&lt;span&gt;5&lt;/span&gt;,Â &lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;Â Â Â Â texture.rotationÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;2&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨Â -Â ç“¦ç‰‡&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â textureMaterialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;map&lt;/span&gt;:Â textureÂ });&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºç¡€ç½‘æ ¼æè´¨Â -Â å…¶ä»–&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â colorMaterialÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.MeshBasicMaterial({Â &lt;span&gt;color&lt;/span&gt;:Â &lt;span&gt;&#x27;grey&#x27;&lt;/span&gt;Â });&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â materialsÂ =Â [&lt;br/&gt;Â Â Â Â Â Â Â Â colorMaterial,&lt;br/&gt;Â Â Â Â Â Â Â Â colorMaterial,&lt;br/&gt;Â Â Â Â Â Â Â Â colorMaterial,&lt;br/&gt;Â Â Â Â Â Â Â Â colorMaterial,&lt;br/&gt;Â Â Â Â Â Â Â Â colorMaterial,&lt;br/&gt;Â Â Â Â Â Â Â Â textureMaterial&lt;br/&gt;Â Â Â Â ];&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;const&lt;/span&gt;Â roofÂ =Â &lt;span&gt;new&lt;/span&gt;Â THREE.Mesh(geometry,Â materials);&lt;br/&gt;&lt;br/&gt;Â Â Â Â house.add(roof);&lt;br/&gt;&lt;br/&gt;Â Â Â Â roof.rotation.xÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;2&lt;/span&gt;;&lt;br/&gt;Â Â Â Â roof.rotation.yÂ =Â -Â &lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;4&lt;/span&gt;Â *Â &lt;span&gt;0.6&lt;/span&gt;;&lt;br/&gt;Â Â Â Â roof.position.yÂ =Â &lt;span&gt;125&lt;/span&gt;;&lt;br/&gt;Â Â Â Â roof.position.xÂ =Â &lt;span&gt;50&lt;/span&gt;;&lt;br/&gt;Â Â Â Â roof.position.zÂ =Â &lt;span&gt;150&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â roof;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAl18MkU6l119ogvapsbT7YSDtMId8pTVtm6MKianWVyQR7O2Vq01eN74w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å±‹é¡¶ä¹Ÿæ˜¯æœ‰ä¸¤ä¸ªï¼Œåªä¸è¿‡æ˜¯ç©ºé—´ä¸Šä¸ä¸€æ ·ï¼Œæˆ‘ä»¬ç¨å¾®è°ƒæ•´ä¸‹ä½ç½®&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;const&lt;/span&gt;Â roof2Â =Â createRoof();&lt;br/&gt;roof2.rotation.xÂ =Â &lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;2&lt;/span&gt;;&lt;br/&gt;roof2.rotation.yÂ =Â (&lt;span&gt;Math&lt;/span&gt;.PIÂ /Â &lt;span&gt;4&lt;/span&gt;)Â *Â &lt;span&gt;0.6&lt;/span&gt;;&lt;br/&gt;roof2.position.yÂ =Â &lt;span&gt;125&lt;/span&gt;;&lt;br/&gt;roof2.position.xÂ =Â &lt;span&gt;-50&lt;/span&gt;;&lt;br/&gt;roof2.position.zÂ =Â &lt;span&gt;150&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ldv96ZtlFHQ1vC5lJjOIhILYicZdib4QAlZibFgEcUzuETrLZEyVBSw5byGFM7MDEkNHbpHu884lcD8BvRIm1aMMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;å…‹éš†&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸€ä¸ªæˆ¿å­å¤ªå•è°ƒï¼Œæˆ‘ä»¬å…‹éš†å‡ ä¸ª&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â clone&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â house1Â =Â house.clone();&lt;br/&gt;house1.position.set(&lt;span&gt;300&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;scene.add(house1);&lt;br/&gt;&lt;span&gt;//Â clone2&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â house2Â =Â house.clone();&lt;br/&gt;house2.position.set(&lt;span&gt;-300&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;scene.add(house2);&lt;br/&gt;&lt;span&gt;//Â clone3&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â house3Â =Â house.clone();&lt;br/&gt;house3.position.set(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;-350&lt;/span&gt;);&lt;br/&gt;scene.add(house3);&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â clone4&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â house4Â =Â house.clone();&lt;br/&gt;house4.position.set(&lt;span&gt;300&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;-350&lt;/span&gt;);&lt;br/&gt;scene.add(house4);&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â clone5&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt;Â house5Â =Â house.clone();&lt;br/&gt;house5.position.set(&lt;span&gt;-300&lt;/span&gt;,Â &lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;-350&lt;/span&gt;);&lt;br/&gt;scene.add(house5);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>5ccc0b8ec884932b746171494770ae3b</guid>
<title>String åº•å±‚å®ç°ä¹‹ COW</title>
<link>https://toutiao.io/k/806gq63</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;Mzk0MzI4OTI1Ng==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/p3sYCQXkuHhKgtwWvzaYZodgfpphdA6WWKEMXTn6ImCCCuEzlPKicNBcpzBUyjK1XicWwqIwusqLGpwyyOc87JPQ/0?wx_fmt=png&quot; data-nickname=&quot;é«˜æ€§èƒ½æ¶æ„æ¢ç´¢&quot; data-alias=&quot;gxnjgts&quot; data-signature=&quot;ä¸“æ³¨äºåˆ†äº«å¹²è´§ï¼Œç¡¬è´§ï¼Œæ¬¢è¿å…³æ³¨ğŸ˜„&quot; data-from=&quot;0&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;ä½ å¥½ï¼Œæˆ‘æ˜¯é›¨ä¹ï¼&lt;/p&gt;&lt;p&gt;åœ¨å¼€å§‹æ­£æ–‡ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€æ®µä»£ç ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;std&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;string&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;s&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&lt;span&gt;&quot;str&quot;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â std&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;string&lt;/span&gt;&lt;span&gt;Â s1Â &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â s&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;char&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;pÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const_cast&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;char&lt;/span&gt;&lt;span&gt;*&amp;gt;(&lt;/span&gt;&lt;span&gt;s1&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;data&lt;/span&gt;&lt;span&gt;());&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â p&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;2&lt;/span&gt;&lt;span&gt;]&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&#x27;\0&#x27;&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â std&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;coutÂ &lt;/span&gt;&lt;span&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span&gt;Â sÂ &lt;/span&gt;&lt;span&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span&gt;Â std&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;endl&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â std&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;coutÂ &lt;/span&gt;&lt;span&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span&gt;Â s1Â &lt;/span&gt;&lt;span&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span&gt;Â std&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;endl&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯èƒ½ä¼šæœ‰éƒ¨åˆ†äººè®¤ä¸ºä¸Šé¢ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;st&lt;/span&gt;&lt;br/&gt;&lt;span&gt;st&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¹Ÿæœ‰éƒ¨åˆ†äººè®¤ä¸ºä¸Šè¿°ä»£ç è¾“å‡ºç»“æœæ˜¯:&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;str&lt;/span&gt;&lt;br/&gt;&lt;span&gt;st&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…¶å®ï¼Œä¸Šè¿°ä¸¤ç§ç»“æœéƒ½æ˜¯æ­£ç¡®çš„ï¼Œç¬¬ä¸€ç§æ­£ç¡®çš„å‰ææ˜¯åŸºäºgcc5.1ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œç¬¬äºŒç§æ­£ç¡®çš„å‰ææ˜¯åŸºäºgcc5.1ï¼ˆåŒ…å«ï¼‰ä»¥åçš„ç‰ˆæœ¬ã€‚&lt;/p&gt;&lt;p&gt;è€Œç¬¬ä¸€ç§ä¹‹æ‰€ä»¥æ­£ç¡®ï¼Œè¿™æ˜¯åŸºäºstd::stringçš„å¦å¤–ä¸€ä¸ªç‰¹æ€§ï¼šCOW(Copy On Write)ã€‚&lt;/p&gt;&lt;h2&gt;COW&lt;/h2&gt;&lt;p&gt;COWæ˜¯Copy On Writeçš„ç¼©å†™ï¼Œæ˜¯ä¸€ç§å¾ˆå¸¸è§ä¸”å¾ˆé‡è¦çš„ä¼˜åŒ–æ–¹å¼ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯å¯¹å¤šä¸ªå®ä½“çš„èµ„æºè¯·æ±‚è¿›è¡Œå»¶æ—¶å¤„ç†ï¼Œå¦‚æœä¸å­˜åœ¨èµ„æºæ›´æ”¹è¡Œä¸ºï¼Œåˆ™å¤šä¸ªå®ä½“å…±äº«è¯¥å—èµ„æºï¼Œç›´åˆ°æœ‰å®ä½“éœ€è¦å¯¹èµ„æºè¿›è¡Œä¿®æ”¹æ—¶ï¼Œæ‰çœŸæ­£ä¸ºè¯¥å®ä½“åˆ†é…ç§æœ‰çš„èµ„æºã€‚&lt;/p&gt;&lt;p&gt;COWæŠ€æœ¯çš„ä¸€ä¸ªç»å…¸åº”ç”¨åœ¨äºLinuxå†…æ ¸åœ¨è¿›ç¨‹forkæ—¶å¯¹è¿›ç¨‹åœ°å€ç©ºé—´çš„å¤„ç†ã€‚ç”±äºforkäº§ç”Ÿçš„å­è¿›ç¨‹éœ€è¦ä¸€ä»½å’Œçˆ¶è¿›ç¨‹å†…å®¹ç›¸åŒä½†å®Œå…¨ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ç§åšæ³•æ˜¯å°†çˆ¶è¿›ç¨‹çš„åœ°å€ç©ºé—´å®Œå…¨å¤åˆ¶ä¸€ä»½ï¼Œå¦ä¸€ç§åšæ³•æ˜¯å°†çˆ¶è¿›ç¨‹åœ°å€ç©ºé—´ä¸­çš„é¡µé¢æ ‡è®°ä¸º&lt;strong&gt;å…±äº«çš„&lt;/strong&gt;ï¼ˆå¼•ç”¨è®¡æ•°+1ï¼‰ï¼Œä½¿å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹å…±äº«åœ°å€ç©ºé—´ï¼Œä½†å½“æœ‰ä¸€æ–¹éœ€è¦å¯¹å†…å­˜ä¸­æŸä¸ªé¡µé¢è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé‡æ–°åˆ†é…ä¸€ä¸ªæ–°çš„é¡µé¢ï¼ˆæ‹·è´åŸå†…å®¹ï¼‰ï¼Œå¹¶ä½¿ä¿®æ”¹è¿›ç¨‹çš„è™šæ‹Ÿåœ°å€é‡å®šå‘åˆ°æ–°çš„é¡µé¢ä¸Šã€‚&lt;/p&gt;&lt;p&gt;COWæŠ€æœ¯æœ‰å“ªäº›ä¼˜ç‚¹å‘¢?&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1.Â å‡å°‘äº†åˆ†é…ï¼ˆå’Œå¤åˆ¶ï¼‰å¤§é‡èµ„æºå¸¦æ¥çš„ç¬é—´å»¶è¿Ÿï¼ˆæ³¨æ„ä»…ä»…æ˜¯latencyï¼Œä½†å®é™…ä¸Šè¯¥å»¶è¿Ÿè¢«åˆ†æ‘Šåˆ°åç»­çš„æ“ä½œä¸­ï¼Œå…¶ç´¯ç§¯è€—æ—¶å¾ˆå¯èƒ½æ¯”ä¸€æ¬¡ç»Ÿä¸€å¤„ç†çš„å»¶è¿Ÿè¦é«˜ï¼Œé€ æˆthroughputä¸‹é™æ˜¯æœ‰å¯èƒ½çš„ï¼‰&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2. å¦ä¸€æ–¹é¢å‡å°‘ä¸å¿…è¦çš„èµ„æºåˆ†é…ã€‚ï¼ˆä¾‹å¦‚åœ¨forkçš„ä¾‹å­ä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„é¡µé¢éƒ½éœ€è¦å¤åˆ¶ï¼Œæ¯”å¦‚çˆ¶è¿›ç¨‹çš„ä»£ç æ®µ(.code)å’Œåªè¯»æ•°æ®(.rodata)æ®µï¼Œç”±äºä¸å…è®¸ä¿®æ”¹ï¼Œæ ¹æœ¬å°±æ— éœ€å¤åˆ¶ã€‚è€Œå¦‚æœforkåé¢ç´§è·Ÿexecçš„è¯ï¼Œä¹‹å‰çš„åœ°å€ç©ºé—´éƒ½ä¼šåºŸå¼ƒï¼ŒèŠ±å¤§åŠ›æ°”çš„åˆ†é…å’Œå¤åˆ¶åªæ˜¯å¾’åŠ³æ— åŠŸã€‚ï¼‰&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;COWçš„æ€æƒ³åœ¨èµ„æºç®¡ç†ä¸Šè¢«å¹¿æ³›ä½¿ç”¨ï¼Œæœ¬æ–‡ä¸­åˆ†æçš„stringä¸­ä¹Ÿç”¨åˆ°äº†~~ã€‚&lt;/p&gt;&lt;h2&gt;å®ç°&lt;/h2&gt;&lt;p&gt;ä¸ºäº†åˆ†æCOWåœ¨stringä¸­çš„å®ç°æœºåˆ¶ï¼Œæˆ‘ä»¬å¯¹ä¸Šè¿°ä»£ç è¿›è¡Œåˆ†æã€‚ä¸‹é¢æºç ç‰ˆæœ¬ä¸º4.6.0(åœ¨çº¿åœ°å€ä¸º:&lt;span&gt;stringæºç &lt;/span&gt;)ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ä¸ŠèŠ‚å†…å®¹ä¸­ï¼Œæˆ‘ä»¬æåˆ°ä¸€èˆ¬å®ç°COWçš„ç­–ç•¥ï¼Œéƒ½ç”¨äº†å¼•ç”¨è®¡æ•°ï¼Œstd::stringä¹Ÿä¸ä¾‹å¤–ï¼Œä½¿ç”¨å¦‚ä¸‹ç»“æ„ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;struct&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep_base&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â size_typeÂ Â Â Â Â Â Â _M_length&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â size_typeÂ Â Â Â Â Â Â _M_capacity&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_Atomic_word&lt;/span&gt;&lt;span&gt;Â Â Â Â Â Â Â Â _M_refcount&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;};&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;struct&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep_base&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â Types:&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;typedef&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;Â rebind&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;char&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;otherÂ &lt;/span&gt;&lt;span&gt;_Raw_bytes_alloc&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;bool&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_is_leaked&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcountÂ &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;bool&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_is_shared&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcountÂ &lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_set_leaked&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcountÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_set_sharable&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcountÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_set_length_and_sharable&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;size_typeÂ __n&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;ifndef&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â _GLIBCXX_FULLY_DYNAMIC_STRING&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__builtin_expect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;_S_empty_rep&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_set_sharable&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;//Â OneÂ reference.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_lengthÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â __n&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â traits_type&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;assign&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;()[&lt;/span&gt;&lt;span&gt;__n&lt;/span&gt;&lt;span&gt;],&lt;/span&gt;&lt;span&gt;Â _S_terminal&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â grrr.Â (perÂ 21.3.4)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â YouÂ cannotÂ leaveÂ thoseÂ LWGÂ peopleÂ aloneÂ forÂ aÂ second.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_refdata&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;reinterpret_cast&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&amp;gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_grab&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __alloc1&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __alloc2&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(!&lt;/span&gt;&lt;span&gt;_M_is_leaked&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __alloc1Â &lt;/span&gt;&lt;span&gt;==&lt;/span&gt;&lt;span&gt;Â __alloc2&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;Â _M_refcopy&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â _M_clone&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__alloc1&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â CreateÂ &amp;amp;Â Destroy&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;static&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _S_create&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;size_type&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â size_type&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_dispose&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;ifndef&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â _GLIBCXX_FULLY_DYNAMIC_STRING&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__builtin_expect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;_S_empty_rep&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â BeÂ race-detector-friendly.Â Â ForÂ moreÂ infoÂ seeÂ bits/c++config.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â _GLIBCXX_SYNCHRONIZATION_HAPPENS_BEFORE&lt;/span&gt;&lt;span&gt;(&amp;amp;&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcount&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__gnu_cxx&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;__exchange_and_add_dispatch&lt;/span&gt;&lt;span&gt;(&amp;amp;&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcount&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;lt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â _GLIBCXX_SYNCHRONIZATION_HAPPENS_AFTER&lt;/span&gt;&lt;span&gt;(&amp;amp;&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcount&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â _M_destroy&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__a&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;//Â XXXÂ MT&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;void&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_destroy&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_refcopy&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;ifndef&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â _GLIBCXX_FULLY_DYNAMIC_STRING&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__builtin_expect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;_S_empty_rep&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â __gnu_cxx&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;__atomic_add_dispatch&lt;/span&gt;&lt;span&gt;(&amp;amp;&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcount&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â _M_refdata&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;//Â XXXÂ MT&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_clone&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;,&lt;/span&gt;&lt;span&gt;Â size_typeÂ __resÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;};&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨ä¸Šè¿°ç»“æ„ä¸­ï¼Œæœ‰ä¸€ä¸ªå˜é‡&lt;code&gt;_M_refcount&lt;/code&gt;ï¼Œç”¨æ¥è®°å½•å½“å‰å¼•ç”¨è¯¥stringçš„å¯¹è±¡ä¸ªæ•°ã€‚åœ¨stringçš„COWå®ç°ä¸­ï¼Œå½“æ–°å»ºä¸€ä¸ªstringæˆ–è€…ä¸ºå…¶åˆ†é…å†…å­˜æ—¶ï¼Œä¼šé¢å¤–åˆ›å»ºä¸€ä¸ª_Rep_baseå¯¹è±¡ç”¨æ¥å­˜æ”¾å¼•ç”¨å¯¹è±¡çš„ä¸ªæ•°ï¼Œå½“å‘ç”Ÿæ‹·è´æˆ–è€…èµ‹å€¼çš„æ—¶å€™ï¼Œè¿™ä¸ªå¼•ç”¨è®¡æ•°å°±ä¼š+1ã€‚è€Œåœ¨å†…å®¹ä¿®æ”¹æ—¶ï¼Œstringç±»ä¸ºæŸ¥çœ‹è¿™ä¸ªå¼•ç”¨è®¡æ•°æ˜¯å¦ä¸º0ï¼Œå¦‚æœä¸ä¸ºé›¶ï¼Œè¡¨ç¤ºæœ‰äººåœ¨å…±äº«è¿™å—å†…å­˜ï¼Œé‚£ä¹ˆè‡ªå·±éœ€è¦å…ˆåšä¸€ä»½æ‹·è´ï¼Œç„¶åæŠŠå¼•ç”¨è®¡æ•°-1ï¼Œå†æŠŠæ•°æ®æ‹·è´è¿‡æ¥ã€‚_Repçš„å„ç§æˆå‘˜å‡½æ•°ï¼Œåˆ™æ˜¯ç”¨æ¥å¯¹å¼•ç”¨è®¡æ•°è¿›è¡Œæ“ä½œã€‚&lt;/p&gt;&lt;h3&gt;æ„é€ å‡½æ•°&lt;/h3&gt;&lt;p&gt;åœ¨ä»£ç &lt;code&gt;std::string s(&quot;str&quot;);&lt;/code&gt;æ„å»ºä¸€ä¸ªstringå¯¹è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸‹å…¶å…·ä½“å®ç°ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â basic_string&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;::&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;basic_string&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __s&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â _M_dataplus&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_S_construct&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__s&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â __sÂ &lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;Â __sÂ &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;Â traits_type&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;length&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__s&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â __sÂ &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;Â npos&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;),&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¯¥å®ç°ä¸­ï¼Œè°ƒç”¨äº†_M_dataplus()å‡½æ•°ï¼Œå…¶å®é™…ä¸Šæ˜¯æŸä¸ªå¯¹è±¡çš„æ„é€ å‡½æ•°ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸º_S_constructç”Ÿæˆçš„char*æŒ‡é’ˆï¼Œå¦ä¸€ä¸ªåˆ™ä¸ºåˆ†é…å™¨ã€‚&lt;/p&gt;&lt;p&gt;_M_dataplusçš„å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;struct&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __dat&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__a&lt;/span&gt;&lt;span&gt;),&lt;/span&gt;&lt;span&gt;Â _M_p&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__dat&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â _M_p&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;//Â TheÂ actualÂ data.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;};&lt;/span&gt;&lt;br/&gt;&lt;span&gt;mutable&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;Â Â _M_dataplus&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;_M_dataplusä¸­æœ‰ä¸ªæˆå‘˜å˜é‡_M_pæŒ‡å‘å®é™…çš„å­—ç¬¦ä¸²åœ°å€ï¼Œè€Œè¯¥åœ°å€æ˜¯ç”±_S_constructç”Ÿæˆï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_InIterator&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â basic_string&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;::&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â _S_construct&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_InIterator&lt;/span&gt;&lt;span&gt;Â __beg&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_InIterator&lt;/span&gt;&lt;span&gt;Â __end&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â input_iterator_tag&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;ifndef&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â _GLIBCXX_FULLY_DYNAMIC_STRING&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__begÂ &lt;/span&gt;&lt;span&gt;==&lt;/span&gt;&lt;span&gt;Â __endÂ &lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __aÂ &lt;/span&gt;&lt;span&gt;==&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;())&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â _S_empty_rep&lt;/span&gt;&lt;span&gt;().&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â AvoidÂ reallocationÂ forÂ commonÂ case.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;Â __buf&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;128&lt;/span&gt;&lt;span&gt;];&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â size_typeÂ __lenÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__begÂ &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt;Â __endÂ &lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __lenÂ &lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;sizeof&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__buf&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;/&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;sizeof&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â __buf&lt;/span&gt;&lt;span&gt;[&lt;/span&gt;&lt;span&gt;__len&lt;/span&gt;&lt;span&gt;++]&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;__beg&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;__beg&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __rÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;_S_create&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__len&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;size_type&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;),&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;//Â åˆ›å»ºRep*å¯¹è±¡ï¼Œå³åŒ…å«æœ‰å¼•ç”¨è®¡æ•°çš„&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_copy&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â __buf&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â __len&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â __try&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;while&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__begÂ &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt;Â __end&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__lenÂ &lt;/span&gt;&lt;span&gt;==&lt;/span&gt;&lt;span&gt;Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_capacity&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â AllocateÂ moreÂ space.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __anotherÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;_S_create&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__lenÂ &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â __len&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â _M_copy&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__another&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â __len&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_destroy&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__a&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â __rÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â __another&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;()[&lt;/span&gt;&lt;span&gt;__len&lt;/span&gt;&lt;span&gt;++]&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;__beg&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;__beg&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â __catch&lt;/span&gt;&lt;span&gt;(...)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_destroy&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__a&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â __throw_exception_again&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_set_length_and_sharable&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__len&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â __r&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refdata&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸Šè¿°ä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•æ˜“ç†è§£çš„ï¼Œæ— éå°±æ˜¯å°†å­—ç¬¦ä¸²æ‹·è´åˆ°å†…å­˜ï¼Œç”ŸæˆCOWæ‰€éœ€è¦çš„å¯¹è±¡~~&lt;/p&gt;&lt;p&gt;è¿™å—éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨stringå®šä¹‰ä¸­ï¼Œ&lt;strong&gt;å¹¶æ²¡æœ‰ä¸€ä¸ªå•ç‹¬çš„_Repå¯¹è±¡ï¼Œå³å¹¶æ²¡æœ‰ä¸ºäº†å®ç°COWçš„å¼•ç”¨è®¡æ•°åŠŸèƒ½è€Œå•ç‹¬å®šä¹‰ä¸€ä¸ªå¯¹è±¡&lt;/strong&gt;ï¼Œè€Œæ˜¯&lt;strong&gt;ä¸ºäº†èŠ‚çœå†…å­˜ï¼Œè¯¥_Repå¯¹è±¡å‡æ˜¯é€šè¿‡æŒ‡é’ˆåç§»æ¥å®ç°&lt;/strong&gt;ã€‚åœ¨å‰é¢å†…å®¹ä¸­ï¼Œæœ‰æåˆ°ï¼Œ_M_dataplus._M_pç”¨æ¥æŒ‡å‘çœŸæ­£çš„å­˜å‚¨æ•°æ®çš„åœ°å€ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢æ˜¯stringçš„æ•°æ®æˆå‘˜ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;class&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;basic_string&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â &lt;/span&gt;&lt;span&gt;//Â **********&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â &lt;/span&gt;&lt;span&gt;static&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â size_typeÂ Â Â Â nposÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;static_cast&lt;/span&gt;&lt;span&gt;&amp;lt;size_type&amp;gt;&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â &lt;/span&gt;&lt;span&gt;mutable&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;Â Â _M_dataplus&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸‹é¢ç»§ç»­åˆ†æ_S_constructä»£ç ï¼Œåœ¨è¯¥å‡½æ•°ä¸­ï¼Œæ¯”è¾ƒé‡è¦çš„ä¸€è¡Œ&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __rÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;_S_create&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__len&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;size_type&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;),&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¯¥è¡Œä¸­ä¸»è¦è´Ÿè´£åˆ†é…å†…å­˜ï¼Œç”±åˆ†é…å™¨__aè¿›è¡Œåˆ†é…ï¼ˆstringä¸­çš„åˆ†é…æ–¹å¼ä¸vectorç±»ä¼¼ï¼Œéƒ½é‡‡ç”¨äº†é¢„åˆ†é…æ–¹å¼ï¼Œä»¥æå‡æ€§èƒ½ï¼‰ï¼Œå…¶å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.6265060240963856&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/p3sYCQXkuHj2uv1XkUtr9JZnbicsiaagOzBxViasF6VPiciacKEr9icaicFb1klxOicZDWBia9ZQDia9yG9QWObOGzJwj9vw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;664&quot;/&gt;&lt;/p&gt;&lt;p&gt;è¿™å—è®¾è®¡éå¸¸å·§å¦™ï¼Œåœ¨_Rep::_S_createæºç å®ç°ä¸­ï¼Œé€šè¿‡åˆ†é…å™¨åˆ†é…ä¸€å—å†…å­˜ï¼Œç„¶åé€šè¿‡&lt;code&gt;placement new&lt;/code&gt;æ„å»º_Repå¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;void&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __placeÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Raw_bytes_alloc&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__alloc&lt;/span&gt;&lt;span&gt;).&lt;/span&gt;&lt;span&gt;allocate&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__size&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;__pÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__place&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â __p&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_capacityÂ &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;Â __capacity&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é‚£ä¹ˆæœ‰ä¸ªç–‘é—®ï¼Œstringå¦‚ä½•è·å–åˆ°å­˜å‚¨å®é™…æ•°æ®çš„æŒ‡é’ˆï¼Œä»¥åŠåˆå¦‚ä½•å¯¹å¼•ç”¨è®¡æ•°è¿›è¡Œæ“ä½œçš„å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;ç›¸ä¿¡æˆ‘ä»¬ç»å¸¸éƒ½ä¼šç”¨åˆ°string::c_str()æ“ä½œï¼Œè¿™ä¸ªå‡½æ•°çš„ä½œç”¨å°±æ˜¯è¿”å›å®é™…çš„å­˜å‚¨æ•°æ®çš„åœ°å€ï¼Œå®ç°å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;const&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;c_str&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;const&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â _M_data&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â _M_data&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â Â _M_dataplus&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;_M_p&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é€šè¿‡å¦‚ä¸Šä»£ç ï¼Œè¿›ä¸€æ­¥è¯æ˜_M_dataplus._M_pæŒ‡å‘å®é™…å­˜å‚¨æ•°æ®çš„åœ°å€ã€‚è€Œ_M_påˆ™æ˜¯åœ¨æ„é€ å‡½æ•°_M_dataplusï¼ˆï¼‰ä¸­ç”±_S_construct()ç”Ÿæˆï¼Œåœ¨_S_constructå‡½æ•°çš„æœ€åä¸€è¡Œä¸º&lt;code&gt;return __r-&amp;gt;_M_refdata();&lt;/code&gt;ï¼Œå…¶è¿”å›çš„æ˜¯å®é™…å­˜å‚¨æ•°æ®åœ°å€ï¼Œä½†__rç±»å‹ä¸º_Repï¼Œåˆæ˜¯å¦‚ä½•è¿”å›çš„å‘¢ï¼Œä¸å¦¨çœ‹ä¸‹å‡½æ•°å®ç°ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_refdata&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;reinterpret_cast&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&amp;gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç»“åˆä¸Šå›¾ï¼Œé€šè¿‡this + 1ï¼Œç§»åŠ¨æŒ‡é’ˆï¼Œè‡ªç„¶å°±åˆ°äº†å¯å­˜å‚¨æ•°æ®éƒ¨åˆ†ã€‚é‚£ä¹ˆstringåˆæ˜¯å¦‚ä½•è¿›è¡Œå¼•ç”¨è®¡æ•°æ“ä½œçš„å‘¢ï¼Ÿé€šè¿‡_M_dataplus._M_pæŒ‡é’ˆåå‘æ“ä½œï¼Œè‡ªç„¶å¯ä»¥å¾—åˆ°_Repå¯¹è±¡ã€‚&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â _M_rep&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;((&lt;/span&gt;&lt;span&gt;reinterpret_cast&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;_Rep&lt;/span&gt;&lt;span&gt;*&amp;gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_M_data&lt;/span&gt;&lt;span&gt;()))[&lt;/span&gt;&lt;span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span&gt;]);&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;æ‹·è´æ„é€ &lt;/h3&gt;&lt;p&gt;åœ¨æœ¬æ–‡ä¾‹å­ä¸­ï¼ŒåŒæ ·ä¸€å—ä»£ç ï¼Œåœ¨ä¸åŒç‰ˆæœ¬ä¸­çš„è¿è¡Œç»“æœä¸ä¸€è‡´ï¼Œå…¶æ ¹æºå°±åœ¨äº&lt;code&gt;std::string s1 = s;&lt;/code&gt;ï¼Œè¿™å¥ä»£ç è°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥ï¼Œä¸å¦¨ä»å…¶æ„é€ å‡½æ•°å…¥æ‰‹ï¼Œæ¥ç ”ç©¶å…¶å®ç°ğŸ˜ã€‚&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;template&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;typename&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â basic_string&lt;/span&gt;&lt;span&gt;&amp;lt;&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Traits&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;gt;::&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;basic_string&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â basic_string&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __str&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â _M_dataplus&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__str&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;_M_rep&lt;/span&gt;&lt;span&gt;()-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_grab&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__str&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;get_allocator&lt;/span&gt;&lt;span&gt;()),&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â __str&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;get_allocator&lt;/span&gt;&lt;span&gt;()),&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â __str&lt;/span&gt;&lt;span&gt;.&lt;/span&gt;&lt;span&gt;get_allocator&lt;/span&gt;&lt;span&gt;())&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ˜¾ç„¶ï¼Œè¯¥å‡½æ•°å®ç°ç®€å•ï¼Œåªè°ƒç”¨äº†&lt;code&gt;_M_dataplus&lt;/code&gt;å‡½æ•°ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;struct&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â __dat&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __a&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__a&lt;/span&gt;&lt;span&gt;),&lt;/span&gt;&lt;span&gt;Â _M_p&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__dat&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;Â _M_p&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;//Â TheÂ actualÂ data.&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;};&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;mutable&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc_hider&lt;/span&gt;&lt;span&gt;Â Â _M_dataplus&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é€šè¿‡ä¸Šè¿°å®šä¹‰ï¼Œå¯ä»¥çœ‹å‡ºï¼Œ&lt;code&gt;_M_dataplus&lt;/code&gt;æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨å…¶æ„é€ å‡½æ•°ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸ºchar&lt;span&gt;ç±»å‹çš„å®é™…æ•°æ®ï¼Œå¦å¤–ä¸€ä¸ªä¸ºåˆ†é…å™¨(åˆ†é…å™¨ä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´å†…)ï¼Œæ‰€ä»¥é‡ç‚¹å°±åœ¨äºchar&lt;/span&gt;æ•°æ®äº†ï¼Œé€šè¿‡å‡½æ•°è°ƒç”¨å‘ç°ï¼Œchar&lt;span&gt;æ˜¯é€šè¿‡&lt;/span&gt;*_M_grab**æ¥è·å–çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ&lt;code&gt;stringçš„æ‹·è´æ„é€ å‡½æ•°ä»…ä»…å¯¹_M_datapluså¯¹è±¡è¿›è¡Œæ„é€ ï¼Œçœ‹æ¥é‡ç‚¹åœ¨```__str._M_rep()-&amp;gt;_M_grab&lt;/code&gt;è¿™å—äº†ï¼Œæºç å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_grab&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __alloc1&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;const&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;_Alloc&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __alloc2&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(!&lt;/span&gt;&lt;span&gt;_M_is_leaked&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span&gt;Â __alloc1Â &lt;/span&gt;&lt;span&gt;==&lt;/span&gt;&lt;span&gt;Â __alloc2&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;?&lt;/span&gt;&lt;span&gt;Â _M_refcopy&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span&gt;Â _M_clone&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__alloc1&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨_M_grabå‡½æ•°ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²å¯å…±äº«ï¼Œè¿›è¡Œå¼•ç”¨æ‹·è´(å³å¼•ç”¨è®¡æ•°+1ï¼Œè¿”å›æºæ•°æ®åœ°å€)ï¼Œå¦åˆ™è¿›è¡Œæ·±åº¦æ‹·è´ã€‚é‚£ä¹ˆåˆ¤æ–­å­—ç¬¦ä¸²å…±äº«çš„æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ˜¾ç„¶**!M_is_leaked() &amp;amp;&amp;amp; __alloc1 == __alloc2**ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå­—ç¬¦ä¸²éƒ½å¯è¢«å…±äº«(ä½¿ç”¨ä¸åŒåˆ†é…å™¨è¿™ç§æƒ…å†µå¿½ç•¥å“ˆ)ï¼Œåªæœ‰ä¸ªåˆ«æƒ…å†µä¸‹ä¸å¯å…±äº«ï¼Œæ¯”å¦‚è¿™ä¸ªå­—ç¬¦ä¸²æ­£åœ¨è¢«å†™å…¥æ—¶å°±ä¸å¯è¢«å…±äº«(æ¯”å¦‚è°ƒç”¨äº†insertå‡½æ•°ç­‰)ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;å¼•ç”¨æ‹·è´&lt;/strong&gt;æ˜¯é€šè¿‡_M_refcopy()å‡½æ•°æ¥å®ç°çš„ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;_CharT&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â _M_refcopy&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;ifndef&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â _GLIBCXX_FULLY_DYNAMIC_STRING&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;__builtin_expect&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;_S_empty_rep&lt;/span&gt;&lt;span&gt;(),&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;))&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;#&lt;/span&gt;&lt;span&gt;&lt;span&gt;endif&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â __gnu_cxx&lt;/span&gt;&lt;span&gt;::&lt;/span&gt;&lt;span&gt;__atomic_add_dispatch&lt;/span&gt;&lt;span&gt;(&amp;amp;&lt;/span&gt;&lt;span&gt;this&lt;/span&gt;&lt;span&gt;-&amp;gt;&lt;/span&gt;&lt;span&gt;_M_refcount&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;1&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â Â Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â _M_refdata&lt;/span&gt;&lt;span&gt;();&lt;/span&gt;&lt;br/&gt;&lt;span&gt;Â Â Â Â Â &lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;//Â XXXÂ MT&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨å¼•ç”¨æ‹·è´çš„æ–¹æ³•å®ç°_M_refcopyä¸­ï¼Œå¯¹å­—ç¬¦ä¸²çš„å¼•ç”¨è®¡æ•°+1ï¼Œç„¶åç›´æ¥è¿”å›æºå­—ç¬¦ä¸²çš„å­—ç¬¦ä¸²åœ°å€ã€‚&lt;/p&gt;&lt;p&gt;å¿…é¡»è¯´æ˜çš„è¯¥å‡½æ•°åªæœ‰åœ¨basic_stringçš„copy ctorå’Œassignmentä¸­æ‰å¯èƒ½è¢«è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰åœ¨æ–°çš„å­—ç¬¦ä¸²æŒ‰copyæˆ–è€…èµ‹å€¼åˆ›å»ºçš„æ—¶å€™æ‰è€ƒè™‘ä½¿ç”¨å¼•ç”¨è®¡æ•°ã€‚è¿›è¡Œrefcopyæˆ–è€…cloneçš„å…³é”®æ ‡è¯†æ˜¯ï¼šé¦–å…ˆæ²¡æœ‰å†…å­˜æ³„æ¼æ ‡å¿—ï¼ˆå…³äºè¿™ä¸ªæ ‡å¿—ä¸»è¦æ˜¯ç¦æ­¢stringå†æ¬¡è¢«å…±äº«ï¼‰ï¼Œç„¶åå°±æ˜¯ä¸¤ä¸ªstringå¯¹è±¡çš„åˆ†é…ç›¸åŒã€‚&lt;/p&gt;&lt;h2&gt;ç»“è¯­&lt;/h2&gt;&lt;p&gt;COWçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯&lt;strong&gt;lazy-copy&lt;/strong&gt;ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„ä¼˜åŒ–æ‰‹æ®µï¼Œé€šå¸¸å‘ç”Ÿåœ¨æ‹·è´ã€èµ‹å€¼ç­‰æ“ä½œä¸Šï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨ä¸å½“ï¼Œåˆ™ä¼šå¯¼è‡´é¢„æœŸä¹‹å¤–çš„ç»“æœï¼Œè™½ç„¶COWåœ¨gccçš„é«˜ç‰ˆæœ¬å®ç°ä¸­å·²ç»å»æ‰äº†ï¼Œä½†æ˜¯ï¼Œå› ä¸ºç§ç§åŸå› ï¼Œä»ç„¶æœ‰è®¸å¤šå¼€å‘äººå‘˜ä½¿ç”¨çš„è€ç‰ˆæœ¬gccï¼Œé‚£ä¹ˆè¿™ä¸ªä¼˜åŒ–å¯¼è‡´çš„é—®é¢˜å°±ä¸å¾—ä¸å¼•èµ·å…³æ³¨ï¼Œæ­£æ‰€è°“&lt;code&gt;çŸ¥å·±çŸ¥å½¼ï¼Œæ–¹èƒ½ç™¾æˆ˜ä¸æ®†&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;å¥½äº†ï¼Œä»Šå¤©çš„æ–‡ç« å°±åˆ°è¿™ï¼Œæˆ‘ä»¬ä¸‹æœŸè§ï¼&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;å¦‚æœå¯¹æœ¬æ–‡æœ‰ç–‘é—®å¯ä»¥åŠ ç¬”è€…&lt;span&gt;&lt;strong&gt;å¾®ä¿¡&lt;/strong&gt;&lt;/span&gt;ç›´æ¥äº¤æµï¼Œç¬”è€…ä¹Ÿå»ºäº†C/C++ç›¸å…³çš„æŠ€æœ¯ç¾¤ï¼Œæœ‰å…´è¶£çš„å¯ä»¥è”ç³»ç¬”è€…åŠ ç¾¤ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/p3sYCQXkuHiaA3xxTGkIcH0JjQo83fJ8JZPMOM7IrSb3r6zGUQGsP6fMsBhGXeoMw43aL9OEACnPAHdSKmuDljQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;400&quot;/&gt;&lt;span/&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;br/&gt;&lt;/figure&gt;&lt;/section&gt;&lt;section data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;90215&quot;&gt;&lt;section&gt;&lt;section data-brushtype=&quot;text&quot; data-width=&quot;100%&quot;&gt;&lt;strong&gt;å¾€æœŸ&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;ç²¾å½©&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;å›é¡¾&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-bdless=&quot;spin&quot; data-bdlessp=&quot;280&quot; data-bdopacity=&quot;50%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247489003&amp;amp;idx=1&amp;amp;sn=14d7cdd4bdca41cc260763328649c8b4&amp;amp;chksm=c337732cf440fa3a5ee529957c7ac81680ff5d4d3ecf38865af13dcf3b3e96b68fbd9a6719e4&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Cè¯­è¨€ä¸æ”¯æŒé‡è½½ï¼Œå¤šç§main()å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;Cè¯­è¨€ä¸æ”¯æŒé‡è½½ï¼Œå¤šç§main()å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488842&amp;amp;idx=1&amp;amp;sn=d39efe4a60dfc2a2146bbdfa37442e71&amp;amp;chksm=c337738df440fa9bd4000d097c76ef530b13f0d4c53ee45a03a0a033ea57b7b0b3f436af1e4a&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;æƒ¯ç”¨æ³•ä¹‹CRTP&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;æƒ¯ç”¨æ³•ä¹‹CRTP&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488826&amp;amp;idx=1&amp;amp;sn=5ec3f6e6959b51de02b850aeee609f34&amp;amp;chksm=c33773fdf440faebd97a0184c3e30ce77b3ce306d7d6dea9967ece6bef41e9f6d9d9030b2a62&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;èŠèŠå†…å­˜æ¨¡å‹ä¸å†…å­˜åº&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;èŠèŠå†…å­˜æ¨¡å‹ä¸å†…å­˜åº&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488441&amp;amp;idx=1&amp;amp;sn=f75be00bcd12934c2e7331956707a429&amp;amp;chksm=c337757ef440fc6816fdef3c144361a0e21ebe24da6ea497d8122ca04c81c7dcc40445ae3f1a&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;vectoråˆå§‹åŒ–ä¸å¦å¯¼è‡´çš„å·¨å¤§æ€§èƒ½å·®å¼‚&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;vectoråˆå§‹åŒ–ä¸å¦å¯¼è‡´çš„å·¨å¤§æ€§èƒ½å·®å¼‚&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488372&amp;amp;idx=1&amp;amp;sn=f3acc2893cbafc99c21203f4db0e24ee&amp;amp;chksm=c33775b3f440fca5410edde4ce29f1cbeec7c1734357e54c02bbe549ed3f435a4243f7e8d297&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;é—®é¢˜è§£å†³äº†ï¼Œæˆ‘å´ä¸çŸ¥é“åŸå› &quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;é—®é¢˜è§£å†³äº†ï¼Œæˆ‘å´ä¸çŸ¥é“åŸå› &lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488290&amp;amp;idx=1&amp;amp;sn=c4d2416b3ee3968303379a8cef66105d&amp;amp;chksm=c33775e5f440fcf30a3a8bef429eb199577f71a15d688ddf729ed1edbb94d119d58c470195f1&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;æ­å¼€lambdaçš„ç¥ç§˜é¢çº±&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;æ­å¼€lambdaçš„ç¥ç§˜é¢çº±&lt;/a&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488149&amp;amp;idx=1&amp;amp;sn=4b7718a8798245b3a50e1fc9aebf5dee&amp;amp;chksm=c3377452f440fd44d13a4a99d3e16a2d06de0539b9f8365b7346de9c8037ea91b59f46df934f&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;å¤šæ€å®ç°-è™šå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆä»¥åŠå˜ä½“&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;å¤šæ€å®ç°-è™šå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆä»¥åŠå˜ä½“&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247488000&amp;amp;idx=1&amp;amp;sn=156cad69e290f1e898cded46cd4cedc9&amp;amp;chksm=c33774c7f440fdd1e7db21f175029adcf622fe53f1968bb8acefa027bf95f01d5e2c2bb3d7a7&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ã€Modern C++ã€‘æ·±å…¥ç†è§£ç§»åŠ¨è¯­ä¹‰&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;ã€Modern C++ã€‘æ·±å…¥ç†è§£ç§»åŠ¨è¯­ä¹‰&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247487751&amp;amp;idx=1&amp;amp;sn=3da21227cb1a4c80e36f91dc823529af&amp;amp;chksm=c33777c0f440fed6f9ebaa7f206f1e423f68c09a809a4d30033f34bd123ccf45d9e42655e199&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ã€Modern C++ã€‘æ·±å…¥ç†è§£å·¦å€¼ã€å³å€¼&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;ã€Modern C++ã€‘æ·±å…¥ç†è§£å·¦å€¼ã€å³å€¼&lt;/a&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247487474&amp;amp;idx=1&amp;amp;sn=e29d0178bfd4139313c44139e1cb3899&amp;amp;chksm=c3376935f440e023b96e9f8feeb34e4e22fbb74f00ca345a2b867edfd4c088bc595821fe878e&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;æ™ºèƒ½æŒ‡é’ˆ-ä½¿ç”¨ã€é¿å‘å’Œå®ç°&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;æ™ºèƒ½æŒ‡é’ˆ-ä½¿ç”¨ã€é¿å‘å’Œå®ç°&lt;/a&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247487009&amp;amp;idx=1&amp;amp;sn=a812d27b9d65369ce2f38375b4a4ee96&amp;amp;chksm=c33768e6f440e1f015252fecf354f9f3712f59fc04b47b03401486c86fe51875428503ee9819&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;å†…å­˜æ³„æ¼-åŸå› ã€é¿å…ä»¥åŠå®šä½&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;å†…å­˜æ³„æ¼-åŸå› ã€é¿å…ä»¥åŠå®šä½&lt;/a&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247486816&amp;amp;idx=1&amp;amp;sn=a6dfc1361ce15ce5ad1c7d7734f9c939&amp;amp;chksm=c3376ba7f440e2b18267c303c35572ab089fb97d3b2fe0adb58009637d6631020bb52bd9a28c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;GDBè°ƒè¯•-ä»å…¥é—¨å®è·µåˆ°åŸç†&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;GDBè°ƒè¯•-ä»å…¥é—¨å®è·µåˆ°åŸç†&lt;/a&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247486357&amp;amp;idx=1&amp;amp;sn=3e7b88218f4416980b20add7575baa9a&amp;amp;chksm=c3376d52f440e444d28a01ef930ddfb92b5d30f26e7284012f08624ca1599e7efac1da3fb17c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ã€çº¿ä¸Šé—®é¢˜ã€‘P1çº§å…¬å¸æ•…éšœï¼Œå¹´ç»ˆå¥–ä¸ä¿&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;ã€çº¿ä¸Šé—®é¢˜ã€‘P1çº§å…¬å¸æ•…éšœï¼Œå¹´ç»ˆå¥–ä¸ä¿&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247486254&amp;amp;idx=1&amp;amp;sn=ebce58aa6b547af2a818faa5a6412e89&amp;amp;chksm=c3376de9f440e4ffea267926b7ce09ac439ab33a1da9dc6b4d631c971053f628cf91202d0f53&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ã€æ€§èƒ½ä¼˜åŒ–ã€‘é«˜æ•ˆå†…å­˜æ± çš„è®¾è®¡ä¸å®ç°&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;ã€æ€§èƒ½ä¼˜åŒ–ã€‘é«˜æ•ˆå†…å­˜æ± çš„è®¾è®¡ä¸å®ç°&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzk0MzI4OTI1Ng==&amp;amp;mid=2247485953&amp;amp;idx=1&amp;amp;sn=f8cd484607ab07f15247ecde773d2e1c&amp;amp;chksm=c3376cc6f440e5d047f7e648c951fd583df82ab4e3dab5767baeddef9fe7c1270f05b039d8c4&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;2ä¸‡å­—|30å¼ å›¾å¸¦ä½ é¢†ç•¥glibcå†…å­˜ç®¡ç†ç²¾é«“&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;2ä¸‡å­—|30å¼ å›¾å¸¦ä½ é¢†ç•¥glibcå†…å­˜ç®¡ç†ç²¾é«“&lt;/a&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ä½ å¥½ï¼Œæˆ‘æ˜¯é›¨ä¹ï¼Œä»ä¸šåäºŒå¹´æœ‰ä½™ï¼Œå†ç»è¿‡ä¼ ç»Ÿè¡Œä¸šç½‘ç»œç ”å‘ã€äº’è”ç½‘æ¨èå¼•æ“ç ”å‘ï¼Œç›®å‰åœ¨å¹¿å‘Šè¡Œä¸šä»ä¸š8å¹´ã€‚ç›®å‰ä»»èŒæŸäº’è”ç½‘å…¬å¸é«˜çº§æŠ€æœ¯ä¸“å®¶ä¸€èŒï¼Œè´Ÿè´£å¹¿å‘Šå¼•æ“çš„æ¶æ„å’Œç ”å‘ã€‚&lt;/span&gt;&lt;span/&gt;&lt;span/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;æœ¬å…¬ä¼—å·ä¸“æ³¨äºæ¶æ„ã€æŠ€æœ¯ã€çº¿ä¸Šbugåˆ†æç­‰å¹²è´§ï¼Œæ¬¢è¿å…³æ³¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;Mzk0MzI4OTI1Ng==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/p3sYCQXkuHhKgtwWvzaYZodgfpphdA6WWKEMXTn6ImCCCuEzlPKicNBcpzBUyjK1XicWwqIwusqLGpwyyOc87JPQ/0?wx_fmt=png&quot; data-nickname=&quot;é«˜æ€§èƒ½æ¶æ„æ¢ç´¢&quot; data-alias=&quot;gxnjgts&quot; data-signature=&quot;ä¸“æ³¨äºåˆ†äº«å¹²è´§ï¼Œç¡¬è´§ï¼Œæ¬¢è¿å…³æ³¨ğŸ˜„&quot; data-from=&quot;0&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>