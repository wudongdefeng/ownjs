<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>7ffc0b9c3522b4c5cd619dc0e55d2c00</guid>
<title>MetaFlowå³å°†å¼€æºï¼5æœˆ11æ—¥â€œè®©è§‚æµ‹æ›´è‡ªåŠ¨ï¼Œè®©å¼€å‘è€…æ›´è‡ªç”±â€</title>
<link>https://toutiao.io/k/djdvbzm</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                                                     &quot; id=&quot;js_content&quot;&gt;
            &lt;p&gt;&lt;span&gt;åŸºäºåœ¨æ··åˆäº‘ç¯å¢ƒä¸‹çš„å¤šå¹´è€•è€˜ï¼Œäº‘æ‰ç½‘ç»œè‡ªä¸»ç ”å‘çš„äº‘ç›‘æ§æœåŠ¡å¹³å°DeepFlowå·²åœ¨é‡‘èã€ç”µä¿¡ã€èƒ½æºç­‰è¡Œä¸šä¸­çš„æ•°åå®¶ä¸–ç•Œäº”ç™¾å¼ºå®¢æˆ·å¤„å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚&lt;span&gt;&lt;strong&gt;æˆ‘ä»¬å®£å¸ƒå°†DeepFlowæ ¸å¿ƒçš„å¯è§‚æµ‹æ€§æ•°æ®å¼•æ“MetaFlowæ­£å¼å¼€æºï¼ˆ5æœˆ11æ—¥æ­æ™“ï¼‰&lt;/strong&gt;&lt;/span&gt;ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ›´å¥½çš„å¯è§‚æµ‹æ€§èƒ½åŠ›ã€è‡ªåŠ¨è¿½è¸ªå’Œè‡ªåŠ¨æ ‡ç­¾èƒ½åŠ›å¼€æ”¾åˆ°æ•´ä¸ªè¡Œä¸šï¼Œå¸®åŠ©ä¼ä¸šå®¢æˆ·æ”¹è¿›äº‘åŸç”Ÿè¿ç»´å·¥ä½œçš„è¿è¡Œæ•ˆç‡ã€ç¨³å®šæ€§å’Œè®¡ç®—æˆæœ¬ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;89460&quot;&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.832&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcciaTS9dBmHP2K2hLLjCUuKTpANbOgYeZxkyoK354eZibIr36ohQ9OicLA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;125&quot;/&gt;&lt;p data-brushtype=&quot;text&quot;&gt;&lt;span&gt;&lt;strong&gt;MetaFlowæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;MetaFlowæ˜¯ä¸€ä¸ª&lt;span&gt;&lt;strong&gt;é«˜åº¦è‡ªåŠ¨åŒ–çš„å¯è§‚æµ‹æ€§å¹³å°&lt;/strong&gt;&lt;/span&gt;ï¼Œæ˜¯ä¸ºäº‘åŸç”Ÿåº”ç”¨å¼€å‘è€…å»ºè®¾å¯è§‚æµ‹æ€§è€Œé‡èº«æ‰“é€ çš„å…¨æ ˆã€å…¨é“¾è·¯ã€é«˜æ€§èƒ½æ•°æ®å¼•æ“ã€‚&lt;/span&gt;&lt;span&gt;&lt;strong&gt;MetaFlowçš„AutoTracing&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;èƒ½åŠ›&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;åˆ›æ–°çš„ä½¿ç”¨eBPFå®ç°è‡ªåŠ¨åŒ–çš„åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª&lt;/span&gt;&lt;span&gt;ï¼Œå¹¶è‡ªåŠ¨å…³è”OpenTelemetryå®ç°çœŸæ­£çš„äº‘åŸç”Ÿç¯å¢ƒ&lt;span&gt;å…¨æ ˆã€&lt;/span&gt;å…¨é“¾è·¯è¿½è¸ªã€‚&lt;/span&gt;&lt;span&gt;&lt;strong&gt;MetaFlowçš„AutoTaggingæœºåˆ¶&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;èƒ½å¤Ÿè‡ªåŠ¨ä¸ºæ‰€æœ‰è§‚æµ‹æ•°æ®æ³¨å…¥ä¸°å¯Œçš„äº‘åŸç”Ÿèµ„æºå±æ€§ã€APIå±æ€§æ ‡ç­¾&lt;/span&gt;&lt;span&gt;ï¼Œæ‰“ç ´æ•°æ®å­¤å²›ï¼Œé‡Šæ”¾æ•°æ®çš„ä¸‹é’»åˆ‡åˆ†èƒ½åŠ›ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;MetaFlowæ‹¥æœ‰å¼€æ”¾çš„æ¶æ„&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ï¼ŒåŸºäºWASMçš„å¯ç¼–ç¨‹åº”ç”¨åè®®è§£æèƒ½åŠ›ã€å¯æ‰©å±•çš„è§‚æµ‹æ•°æ®æºã€æ’ä»¶å¼çš„åˆ†ææ•°æ®åº“æ¥å£ã€ç»Ÿä¸€çš„SQLæŸ¥è¯¢æ¥å£ï¼Œè®©ä½¿ç”¨è€…å¯å°†å…¶å¿«é€Ÿèå…¥è‡ªå·±çš„å¯è§‚æµ‹æ€§å¹³å°ä¸­ã€‚&lt;/span&gt;&lt;span&gt;&lt;strong&gt;MetaFlowæ˜“äºç»´æŠ¤&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ï¼Œä»…ç”±Agentã€Serverä¸¤ä¸ªç»„ä»¶æ„æˆï¼Œæ— éœ€ä¾èµ–ä»»ä½•å…¶ä»–ç»„ä»¶å³å¯å®ç°æ°´å¹³æ‰©å±•ä¸è´Ÿè½½å‡è¡¡ã€‚&lt;/span&gt;&lt;span&gt;&lt;strong&gt;MetaFlowè¿½æ±‚æä½çš„èµ„æºæ¶ˆè€—&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ï¼Œä½¿ç”¨Rustå®ç°é‡‡é›†å™¨ï¼Œé€šè¿‡SmartEncodingå®ç°10å€æ€§èƒ½çš„æ•°æ®æ ‡ç­¾æ³¨å…¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;89460&quot;&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.832&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcciaTS9dBmHP2K2hLLjCUuKTpANbOgYeZxkyoK354eZibIr36ohQ9OicLA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;125&quot;/&gt;&lt;p data-brushtype=&quot;text&quot;&gt;&lt;span&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆè¦å¼€æºï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;å»ºè®¾å¯è§‚æµ‹æ€§å·²ç»æˆä¸ºäº‘åŸç”Ÿåº”ç”¨å¼€å‘è€…çš„å¿…è¦å·¥ä½œï¼Œç„¶è€Œç°æœ‰çš„è§£å†³æ–¹æ¡ˆæ­£æ‚„æ— å£°æ¯çš„æ¶ˆè€—ç€å¼€å‘è€…è¶Šæ¥è¶Šå¤šçš„æ—¶é—´ã€‚å¼€å‘è€…éœ€è¦è€ƒè™‘å¦‚ä½•åŸ‹ç‚¹æ’ç ï¼Œå¦‚ä½•ä¼ é€’è¿½è¸ªä¸Šä¸‹æ–‡ï¼Œå¦‚ä½•å…³è”ä¸åŒç±»å‹çš„æ•°æ®ï¼Œå¦‚ä½•æ§åˆ¶æ•°æ®çš„çŒ–ç—å¢é•¿ï¼Œå¦‚ä½•é¿å…é«˜åŸºæ ‡ç­¾ï¼Œå¦‚ä½•ç»´æŠ¤è¶Šæ¥è¶Šå¤æ‚çš„å¹³å°ï¼Œè¿™äº›å·¥ä½œä¸¥é‡æŒ¤å äº†ä¸šåŠ¡å¼€å‘å·¥ä½œçš„æ—¶é—´ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;MetaFlowæ‹¥æŠ±å¼€æºç¤¾åŒºï¼Œè®¾è®¡äº†è‰¯å¥½çš„æ•°æ®æºã€å­˜å‚¨ã€å¯è§†åŒ–æ‰©å±•èƒ½åŠ›ã€‚é€šè¿‡MetaFlowï¼Œæˆ‘ä»¬å¸Œæœ›&lt;/span&gt;&lt;span&gt;&lt;strong&gt;è®©è§‚æµ‹æ›´è‡ªåŠ¨ï¼Œè®©å¼€å‘è€…æ›´è‡ªç”±&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/section&gt;&lt;p/&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;å‘å¸ƒå†…å®¹ï¼š&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;MetaFlowï¼šå¼€æºçš„é«˜åº¦è‡ªåŠ¨åŒ–å¯è§‚æµ‹æ€§å¹³å°&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;å‘å¸ƒæ–¹å¼ï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;çº¿ä¸Šå¤šå¹³å°ç›´æ’­&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ï¼ˆ&lt;/span&gt;&lt;span&gt;äº‘æ‰ç½‘ç»œè§†é¢‘å·ã€å¼€æºä¸­å›½è§†é¢‘å·ã€äº‘åŸç”Ÿç¤¾åŒºè§†é¢‘å·ã€å¼€æºç¤¾KAIYUANSHEè§†é¢‘å·ã€ç¤ºè¯´å¹³å°ç­‰ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;å‘å¸ƒæ—¶é—´ï¼š&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;2022å¹´5æœˆ11æ—¥ æ™š20:00ï½21:30&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;channels_iframe_wrp&quot;&gt;&lt;mpvideosnap class=&quot;js_uneditable custom_select_card channels_live_iframe&quot; data-pluginname=&quot;videosnap&quot; data-headimgurl=&quot;https://wx.qlogo.cn/finderhead/zVWR28oR4EQlYWARgp79CfZGRAbn06k1Y6CdErMu5fQ/0&quot; data-username=&quot;v2_060000231003b20faec8c7e08911c0ddc807eb31b077550620f62b06b6e9891cfe048009add4@finder&quot; data-nickname=&quot;äº‘æ‰ç½‘ç»œ&quot; data-desc=&quot;å°†åœ¨05æœˆ11æ—¥ 20:00 ç›´æ’­&quot; data-intro=&quot;ã€ŠMetaFlowï¼šå¼€æºçš„é«˜åº¦è‡ªåŠ¨åŒ–å¯è§‚æµ‹æ€§å¹³å°ã€‹&quot; data-noticeid=&quot;finderlivenotice-v2_060000231003b20faec8c7e08911c0ddc807eb31b077550620f62b06b6e9891cfe048009add4@finder-1651673179224998-570728353&quot; data-type=&quot;live&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;1217&quot; data-galleryid=&quot;&quot; data-ratio=&quot;2.1658615136876005&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcBXQU1P9My2xicC8SqWqBQUS2liaJW7IpB9zPSbX16D0bhnOibqLmlBZYQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1242&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;p data-brushtype=&quot;text&quot;&gt;&lt;strong&gt;&lt;span&gt;æ¼”è®²ä¸»é¢˜&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span/&gt;ã€ŠMetaFlowï¼šå¼€æºçš„é«˜åº¦è‡ªåŠ¨åŒ–å¯è§‚æµ‹æ€§å¹³å°ã€‹â€”â€” äº‘æ‰ç½‘ç»œ ç ”å‘VP å‘é˜³&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;p data-brushtype=&quot;text&quot;&gt;&lt;strong&gt;&lt;span&gt;æ¼”è®²å†…å®¹&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;p data-brushtype=&quot;text&quot;&gt;&lt;strong&gt;&lt;span&gt;å¬ä¼—å—ç›Š&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;span&gt;&lt;strong&gt;è®©è§‚æµ‹æ›´è‡ªåŠ¨ï¼Œè®©å¼€å‘è€…æ›´è‡ªç”±&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;â€ï¼Œé€šè¿‡æ­¤æ¬¡åˆ†äº«ä½ èƒ½äº†è§£æˆ‘ä»¬å¦‚ä½•ä»ç»†èŠ‚çš„è½¯ä»¶æ¶æ„è®¾è®¡ä¸­ä½“ç°å¯¹è¿™ä¸€ä½¿å‘½çš„è¿½æ±‚ï¼Œè€Œä¸”ä¹Ÿèƒ½çœ‹åˆ°eBPFã€AutoTracingã€AutoTaggingã€SmartEncodingç­‰æ–°æŠ€æœ¯åœ¨å¯è§‚æµ‹æ€§é¢†åŸŸæå¯Œåˆ›æ–°çš„è½åœ°å®è·µã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;æƒ³è¦äº†è§£æ›´å¤šMetaFlowä¿¡æ¯ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section data-id=&quot;103251&quot; data-tools=&quot;135ç¼–è¾‘å™¨&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;strong&gt;æ‰«ç äºŒç»´ç &lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;è”ç³»æˆ‘ä»¬&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;60&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;60&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHc9JLtKzbRCvvBW6bqF9BH9EpfsH2B4icVOLshA9mttsib1K9vlOuCtXuw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;860&quot; data-width=&quot;100%&quot; title=&quot;æˆ‘çš„ä¼ä¸šå¾®ä¿¡äºŒç»´ç .jpeg&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9913793103448276&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHc6UDwfjfCyOoCKLL2RVicYnDvQLhx7X4k253fCJicPNic1ibetWZhtPBpAg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;116&quot; data-width=&quot;100%&quot; title=&quot;MetaFlowäº¤æµç¾¤5.5.jpeg&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;å…³æ³¨äº‘æ‰å…¬ä¼—å·Â  Â MetaFlowäº¤æµç¾¤&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;å®˜ç½‘é“¾æ¥ï¼šhttps://deepflow.yunshan.net/metaflow.html&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;ï¼ˆç‚¹å‡»æ–‡ç« æœ«å°¾ã€&lt;strong&gt;é˜…è¯»åŸæ–‡&lt;/strong&gt;ã€‘å¯ç›´æ¥è·³è½¬ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&amp;gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;p data-brushtype=&quot;text&quot;&gt;&lt;strong&gt;&lt;span&gt;è§‚çœ‹ç›´æ’­èµ¢å¤§å¥–Â &lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot;&gt;&lt;section data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;94621&quot;&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section data-width=&quot;50%&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcHhQKic0UrKsia5SH3UnYOvWW0hrKmtC4K0lbj2GicDAc1qCjugxbZAv8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;535&quot; data-width=&quot;100%&quot; title=&quot;&quot;/&gt;&lt;/section&gt;&lt;section data-width=&quot;50%&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcI3njjVycVOEJBgSibMWF4XpjPs6gx0BiaUjLX0QLrBskaX8ib2jVy0C6A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;300&quot; data-width=&quot;100%&quot; title=&quot;äº¬ä¸œå¡æ­£æ–¹å›¾.jpg&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;section data-width=&quot;50%&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcpHNSJcDMtQKoQ6M4NXzCEkHqSfwsYbtplibpH2sTGr7d4rWIosmzeEw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;466&quot; data-width=&quot;100%&quot; title=&quot;&quot;/&gt;&lt;/section&gt;&lt;section data-width=&quot;50%&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHcLeCEzJ2S7TD7b1N97micibkAzAb4s0A5qVpPjQIBchP5hJ48rXzbG9Og/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;300&quot; data-width=&quot;100%&quot; title=&quot;é¼ æ ‡å«æ­£æ–¹å›¾.jpg&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;5æœˆ11æ—¥&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;â€œ&lt;strong&gt;è®©è§‚æµ‹æ›´è‡ªåŠ¨ï¼Œè®©å¼€å‘è€…æ›´è‡ªç”±&lt;/strong&gt;â€&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;ä¸è§ä¸æ•£&lt;/strong&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/p&gt;&lt;section data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;94089&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;25%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;RECOMMEND&lt;/section&gt;&lt;section data-width=&quot;25%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;æ¨èé˜…è¯»&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3ODM4ODIzNQ==&amp;amp;mid=2650724094&amp;amp;idx=1&amp;amp;sn=47beef2188b52b25d5f0de274df1243e&amp;amp;chksm=8749fb9ab03e728c11ba3f0c6826ed9d46de76c875b69451d7a20907e3fb43b104e1ec0bc061&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;113&quot; data-fileid=&quot;503239848&quot; data-ratio=&quot;0.2&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7auJryibpuIN7ubiakfFvbQEZXPZaeickgC93ZG8MicTRtmwtIbfPQ9zNusBOqW8cA8xGxbLbibhYelB4xg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1000&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3ODM4ODIzNQ==&amp;amp;mid=2650723832&amp;amp;idx=1&amp;amp;sn=d8e08eaade71d0da21e9c26f5cc020cc&amp;amp;chksm=8749f89cb03e718aac169d5006c3d4f4c11fcdbbfbdb2b58c7e018a815b7a01a500c28620003&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;113&quot; data-fileid=&quot;503239847&quot; data-ratio=&quot;0.2&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7auKx6zQH7ICibiaC4CuSYXaic68LibDWRHXsbrsicAhTzM3lFNxN8Y99NaKn18FJDPA6FwbJCvBE7lCrpw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1000&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3ODM4ODIzNQ==&amp;amp;mid=2650723892&amp;amp;idx=1&amp;amp;sn=86532f2eba7c95d7720e22d68252871c&amp;amp;chksm=8749fb50b03e724697461bba371a65c54cf915a07a7e331717db6e24c5159f3ad3886644c997&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;113&quot; data-fileid=&quot;503239846&quot; data-ratio=&quot;0.2&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aundLHUlntWzGylymqyNS5icbx6a6TEFLFrpicSwlMshGBFFN5Ex0XMgDua6OUVkY2UQ4ibLrcicFH05Q/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1000&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;ğŸŒ²&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;562&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/j6qn90Jia7aurmWHcbEACtRNjsTdZ4FHc7v4kEloVptJfia9GT719fUd3VTmqcKpibEq7J6mOb0qZumU0N1WFficVA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;ã€é˜…è¯»åŸæ–‡ã€‘&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Â &lt;strong&gt;ç‚¹å‡»å‰å¾€MetaFlowå®˜æ–¹ç½‘ç«™ï¼&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>e9607c5300db759f154684363dd6faa6</guid>
<title>[æ¨è] 15K Starï¼Github ä¸Šæœ€ç«çš„ä½ä»£ç å¼€å‘å¹³å°ï¼</title>
<link>https://toutiao.io/k/3qv24va</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                                                     &quot; id=&quot;js_content&quot;&gt;
            &lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ã€å¯¼è¯­ã€‘ï¼šç”¨äºæ„å»ºç®¡ç†é¢æ¿ã€å†…éƒ¨å·¥å…·å’Œä»ªè¡¨æ¿çš„ä½ä»£ç å¹³å°ã€‚&lt;br/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.521875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYKlyFTIFWgUkUvD41FsnFKXv4qQW4o2KsRm0px9EyHGPCMeN9WszPtQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ç®€ä»‹&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Appsmith æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç®¡ç†é¢æ¿ã€å†…éƒ¨å·¥å…·å’Œä»ªè¡¨æ¿çš„ä½ä»£ç å¹³å°ï¼Œå¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…å°†ä»»ä½•æ•°æ®æºè½¬æ¢ä¸ºå†…éƒ¨åº”ç”¨ç¨‹åºï¼Œå…è®¸æ‹–æ”¾ UI ç»„ä»¶æ¥æ„å»ºé¡µé¢ï¼Œè¿æ¥åˆ°ä»»ä½• APIã€æ•°æ®åº“æˆ– GraphQL æºï¼Œå¹¶ä½¿ç”¨ JavaScript è¯­è¨€ç¼–å†™é€»è¾‘ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4955595026642984&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYuYMT7H6eVfJSPHo3sU0ja1VR4QptLIUTPOVP4Hs39THhz5iaKjzFGMw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;563&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŠŸèƒ½ï¼š&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;ä½¿ç”¨ç°æˆçš„ç»„ä»¶æ„å»ºå·¥ä½œæµï¼Œå°†è¡¨æ ¼ã€å›¾è¡¨ã€è¡¨å•ç­‰å¸¸è§å…ƒç´ ç›´æ¥æ‹–å…¥åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€è¡¨å•ã€è¾“å…¥ã€æŒ‰é’®ã€è¡¨æ ¼ã€å›¾åƒã€å¤é€‰æ¡†ã€å¼€å…³ã€å•é€‰æŒ‰é’®ã€æ—¥æœŸé€‰æ‹©å™¨ã€ä¸‹æ‹‰åˆ—è¡¨ã€æ–‡ä»¶é€‰æ‹©å™¨ã€å®¹å™¨ã€åœ°å›¾ã€æ¨¡å¼ã€å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€é€‰é¡¹å¡å’Œè§†é¢‘ç­‰ã€‚&lt;br/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img __bg_gif&quot; data-ratio=&quot;0.625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqY160klanwzJz8y98a9GibYDJ3rADlib4T59kuhnD13OgIoOXKuwOW7QXA/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Appsmith å¯ä»¥ä½¿ç”¨ 15+ ç§ DBã€Rest API æˆ– GraphQL ä½œä¸ºæ•°æ®æºï¼Œæ”¯æŒ OAuth 2.0 åè®®å’Œ CURLã€‚&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img __bg_gif&quot; data-ratio=&quot;0.625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYHWNiaJCW29kibZdaLYibiaxoAQmOORR1ccOFG0E0Cmdy6NiaRS5WianyKaiaQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;ä½¿ç”¨ JavaScript è¯­è¨€ç¼–å†™é€»è¾‘ï¼Œå…ƒç´ ä¹‹é—´çš„ä»£ç äº¤äº’ã€æ›´æ–°æ•°æ®æºæˆ–æ“ä½œ SQL æŸ¥è¯¢éƒ½å¯ä»¥ä½¿ç”¨ã€‚&lt;br/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img __bg_gif&quot; data-ratio=&quot;0.625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYREt4KOGZBrucfIicYYwQuHzkibv7ZPfr2iaiaBicxyqo29S2p7fj9Bd0GWA/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;å¯ä»¥ä¸å›¢é˜Ÿå…±äº«åˆ›å»ºçš„åº”ç”¨ç¨‹åºï¼Œä¸ºå›¢é˜Ÿæˆå‘˜åˆ†é…è§’è‰²ï¼Œé™å®šè§’è‰²çš„è®¿é—®æƒé™ã€‚&lt;br/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img __bg_gif&quot; data-ratio=&quot;0.625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYx84FkIT8SyFkGnwRtFXCo5hibAOKHQEO7iaevzJel5ySKZ7HJtIYGPLA/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;å¯é å®‰å…¨çš„åŠ å¯†ä¼ è¾“ã€‚Appsmith åº”ç”¨ç¨‹åºé»˜è®¤æ˜¯å®‰å…¨çš„ï¼Œæ‰€æœ‰è¿æ¥éƒ½ç»è¿‡ TLS åŠ å¯†ï¼Œå‡­æ®ä½¿ç”¨ AES-256 åŠ å¯†ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²ã€‚&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é¡¹ç›®åœ°å€ï¼š&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;https://github.com/appsmithorg/appsmith&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;å®‰è£…&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å®˜æ–¹æœ€æ¨èä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨ Appsmith Cloud æ„å»ºåº”ç”¨ç¨‹åºï¼Œä¸€ç§æ˜¯ä½¿ç”¨ Docker è¿›è¡Œå®‰è£…ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½¿ç”¨ Docker è¿›è¡Œå®‰è£…è¦æ±‚ Docker ç‰ˆæœ¬ 20.10.7 æˆ–ä»¥ä¸Šï¼ŒDocker-Compose ç‰ˆæœ¬ 1.29.2 æˆ–ä»¥ä¸Šã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨ appsmith å®‰è£…æ–‡ä»¶å¤¹ä¸­æ·»åŠ ä»¥ä¸‹ docker-compose.yml æ–‡ä»¶ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;version:Â &lt;span&gt;&quot;3&quot;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;services:&lt;br/&gt;Â Â appsmith:&lt;br/&gt;Â Â Â Â image:Â index.docker.io/appsmith/appsmith-ce&lt;br/&gt;Â Â Â Â container_name:Â appsmith&lt;br/&gt;Â Â Â Â ports:&lt;br/&gt;Â Â Â Â Â Â -Â &lt;span&gt;&quot;80:80&quot;&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â -Â &lt;span&gt;&quot;443:443&quot;&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â -Â &lt;span&gt;&quot;9001:9001&quot;&lt;/span&gt;&lt;br/&gt;Â Â Â Â volumes:&lt;br/&gt;Â Â Â Â Â Â -Â ./stacks:/appsmith-stacks&lt;br/&gt;Â Â Â Â labels:&lt;br/&gt;Â Â Â Â Â Â com.centurylinklabs.watchtower.enable:Â &lt;span&gt;&quot;true&quot;&lt;/span&gt;&lt;br/&gt;Â Â Â Â restart:Â unless-stopped&lt;br/&gt;&lt;br/&gt;Â Â auto_update:&lt;br/&gt;Â Â Â Â image:Â containrrr/watchtower:latest-dev&lt;br/&gt;Â Â Â Â volumes:&lt;br/&gt;Â Â Â Â Â Â -Â /var/run/docker.sock:/var/run/docker.sock&lt;br/&gt;Â Â Â Â &lt;span&gt;#Â UpdateÂ checkÂ intervalÂ inÂ seconds.&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;command&lt;/span&gt;:Â --scheduleÂ &lt;span&gt;&quot;0Â 0Â *Â ?Â *Â *&quot;&lt;/span&gt;Â --label-enableÂ --cleanup&lt;br/&gt;Â Â Â Â restart:Â unless-stopped&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœæ˜¯åœ¨è¿œç¨‹æœºå™¨ä¸Šå®‰è£…å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸‹è½½ docker-compose.yml æ–‡ä»¶ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;curlÂ -LÂ https://bit.ly/32jBNinÂ -oÂ &lt;span&gt;$PWD&lt;/span&gt;/docker-compose.yml&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªé…ç½®æ–‡ä»¶ä¼šè¿è¡Œ Appsmith ç¤ºä¾‹å’Œ Watchtower å®ä¾‹ï¼Œä»¥ä¾¿ä½¿ Appsmith è‡ªåŠ¨ä¿æŒæœ€æ–°çŠ¶æ€ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨ docker å®¹å™¨ï¼Œå¦‚æœæç¤ºæ²¡æœ‰æƒé™éœ€è¦ä»¥ sudo èº«ä»½æ‰§è¡Œå‘½ä»¤ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;docker-composeÂ upÂ -d&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è·Ÿè¸ªæ—¥å¿—ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;dockerÂ logsÂ -fÂ appsmith&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯åŠ¨æˆåŠŸåï¼Œä¼šçœ‹åˆ° Appsmith is Running! çš„æ¶ˆæ¯ï¼Œé€šè¿‡ http://localhost è®¿é—®ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœè¦è¿›è¡Œåº”ç”¨ç¨‹åºçš„æ›´æ–°ï¼Œå¯ä»¥åˆ°å®‰è£…çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;docker-composeÂ pull&lt;br/&gt;docker-composeÂ rmÂ -fsvÂ appsmith&lt;br/&gt;docker-composeÂ upÂ -d&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section/&gt;&lt;/section&gt;&lt;section&gt;è§†é¢‘å¯¹åº”çš„å®‰è£…æ­¥éª¤æ–‡æ¡£å®˜ç½‘åœ°å€ä¸ºï¼š&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;https://docs.appsmith.com/setup/docker&lt;/span&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ç®€å•ä½¿ç”¨&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥æ•°æ®åº“ä½œä¸ºæ•°æ®æºç®€å•ä»‹ç»ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;è¿æ¥åˆ°æ•°æ®åº“&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Appsmith ä¼šåˆ›å»ºä¸€ä¸ªä¸æ•°æ®åº“æœåŠ¡å™¨è¿æ¥çš„è¿æ¥æ± ï¼Œåç»­æŸ¥è¯¢å¯ä»¥é‡ç”¨è¿æ¥æ± ä¸­çš„è¿æ¥ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;ç‚¹å‡» Datasources æ—è¾¹çš„ + å·&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;çœ‹åˆ° Appsmith å¯ä»¥è¿æ¥çš„æ•°æ®æºåˆ—è¡¨&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ä»æ”¯æŒçš„åˆ—è¡¨ä¸­é€‰ä¸­ä¸€ä¸ªæ•°æ®åº“&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å¡«å†™è¿æ¥åˆ°æ•°æ®åº“æ‰€éœ€çš„é…ç½®ä¿¡æ¯&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å•å‡»æµ‹è¯•éªŒè¯æ˜¯å¦èƒ½è¿æ¥æˆåŠŸ&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ä¿å­˜&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section/&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;æ˜¾ç¤ºæ•°æ®&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Appsmith æ‹¥æœ‰ä¸€ç³»åˆ—å¯ç”¨äºæ„å»º UI çš„å°éƒ¨ä»¶ï¼Œæ•°æ®æ˜¾ç¤ºéœ€è¦å’Œè¿™äº›å°éƒ¨ä»¶ç»“åˆèµ·æ¥ã€‚&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;å°éƒ¨ä»¶å¯ä»¥ç”¨éƒ¨ä»¶çª—å£ä¸­æ‹–åŠ¨é˜²æ­¢åˆ°ç”»å¸ƒä¸Šï¼Œè°ƒæ•´å¤§å°ä»¥é€‚åº”ä»–ä»¬éœ€è¦æ˜¾ç¤ºçš„æ•°æ®ï¼Œå…·æœ‰å¯è§†åŒ–ç¼–è¾‘çš„å±æ€§ï¼Œå¯ä»¥è®¾ç½®æ•°æ®ã€æ ·å¼ç­‰ã€‚&lt;br/&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img __bg_gif&quot; data-ratio=&quot;0.6832460732984293&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYaH6fuPuev9GDKibq17ufEjN542uibqtvwydVUkic4m5OiapibmNk2STPInw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1146&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;åœ¨å°éƒ¨ä»¶ä¸­æ˜¾ç¤ºæ•°æ®ã€‚å¯ä»¥æ‰“å¼€å±æ€§çª—å£æ¥ç¼–è¾‘å°éƒ¨ä»¶å±æ€§ï¼Œé€šè¿‡å¼•ç”¨ Query çš„åç§°ï¼ˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼‰ï¼Œå¯ä»¥åœ¨å°éƒ¨ä»¶å±æ€§ä¸­è®¾ç½®æ¥è‡ª Query çš„æ•°æ®ã€‚Appsmith æ˜¯å“åº”å¼çš„ï¼Œåªè¦æŸ¥è¯¢ä¸­çš„æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œå°éƒ¨ä»¶å°±ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†æŸ¥è¯¢çš„ç»“æœç»‘å®šå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;{{Â Table1.selectedRow.idÂ }}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img __bg_gif&quot; data-ratio=&quot;0.7375132837407014&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/DSU8cv1j3ibRxk625TiaCcrttze4vRZCqYr7h7KVt0ZibhksW9XickSmpNRHR67E3BtSVIhOYfPv4icBKgXAIbKPCHw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;941&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;- EOF -&lt;/span&gt;&lt;/p&gt;&lt;section donone=&quot;shifuMouseDownCard(&#x27;shifu_c_030&#x27;)&quot; label=&quot;Copyright Reserved by PLAYHUDONG.&quot;&gt;&lt;section&gt;&lt;span&gt;æ¨èé˜…è¯»&lt;/span&gt;Â Â &lt;span&gt;ç‚¹å‡»æ ‡é¢˜å¯è·³è½¬&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;span&gt;1ã€&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3MDMyMzk0NA==&amp;amp;mid=2650830310&amp;amp;idx=1&amp;amp;sn=7b7b383c90d58d646f34e5fe786792e3&amp;amp;chksm=84ca4e61b3bdc777986a757015bcfc4a33daa85557cc336827dcc7f2fae830142c1037791f2b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;çŸ¥åè€ç‰ŒåˆŠç‰©â€œè®¡ç®—æœºä¸–ç•Œâ€åœå·¥åœä¸šï¼›åä¸ºå›åº”æ‰‹æœºåªèƒ½å……ç”µè‡³ 80%&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;å†è§ï¼â€œè®¡ç®—æœºä¸–ç•Œâ€&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2ã€&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3MDMyMzk0NA==&amp;amp;mid=2650830290&amp;amp;idx=1&amp;amp;sn=a9040c13e5f7bc670bd7e3b927ba974d&amp;amp;chksm=84ca4e55b3bdc743c8306e26eb8cb8ba30de2c14c5b5f799836c4dc69f851829b9bf20bbbd1b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;åä¸ºå†æ¬¡å…¨çƒæ‹›å¤©æ‰å°‘å¹´ï¼Œæœ€é«˜å¹´è–ªè¶…200ä¸‡ï¼›å¸‚åœºç›‘ç®¡æ€»å±€ç§°å·²å…³æ³¨çŸ¥ç½‘æ¶‰å«Œå„æ–­é—®é¢˜&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;å¸‚åœºç›‘ç®¡æ€»å±€ç§°å·²å…³æ³¨çŸ¥ç½‘æ¶‰å«Œå„æ–­é—®é¢˜&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3ã€&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzA3MDMyMzk0NA==&amp;amp;mid=2650830277&amp;amp;idx=1&amp;amp;sn=45eeb8123089e2bc050e23e5ada904fc&amp;amp;chksm=84ca4e42b3bdc754ac31623058965e508487a226b987e4fc7933e7f3d4cdf662a90b5153d883&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;å¾®ä¿¡è¾Ÿè°£â€œåˆ†å‰²ä¸Šæµ·çš„æœ‹å‹åœˆâ€ï¼›è‹¹æœâ€œæ€æ­»â€macOS Serverï¼›æœºæ™ºå·ç«æ˜Ÿç›´å‡æœºé¦–é£ä¸€å‘¨å¹´&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;è‹¹æœâ€œæ€æ­»â€macOS Serverï¼›æœºæ™ºå·ç«æ˜Ÿç›´å‡æœºé¦–é£ä¸€å‘¨å¹´&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è§‰å¾—è¿™æ¡èµ„è®¯æœ‰å¸®åŠ©ï¼Ÿè¯·è½¬å‘ç»™æ›´å¤šäºº&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;æ¨èå…³æ³¨Â &lt;/span&gt;&lt;strong&gt;&lt;span&gt;æŠ€æœ¯æœ€å‰çº¿&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;ï¼Œ&lt;/span&gt;&lt;strong&gt;&lt;span&gt;çœ‹ IT è¦é—»&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzA3MDMyMzk0NA==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/gDmjibFWrFyNNcKCx7SURQWib5e6XYy3wV3mSa4XCjRo4iazUcgB8UGWg410zrXvefSNCoF1Xx1HoW2BC2oY4ADyQ/0?wx_fmt=png&quot; data-nickname=&quot;æŠ€æœ¯æœ€å‰çº¿&quot; data-alias=&quot;topitnews&quot; data-signature=&quot;å…³æ³¨ IT ä¸šç•Œçš„æ–°æŠ€æœ¯å’Œæ–°åŠ¨æ€&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;ç‚¹èµå’Œåœ¨çœ‹å°±æ˜¯æœ€å¤§çš„æ”¯æŒâ¤ï¸&lt;/span&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>66fe17a538f4e7e1e6ad113bcbc41465</guid>
<title>[æ¨è] æ·±å…¥æµ…å‡ºåˆ†å¸ƒå¼é”</title>
<link>https://toutiao.io/k/957qnad</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                                                     &quot; id=&quot;js_content&quot;&gt;
            &lt;h2&gt;&lt;strong&gt;&lt;span&gt;1. åˆ†å¸ƒå¼é”&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;1.1 åˆ†å¸ƒå¼é”ä»‹ç»&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;åˆ†å¸ƒå¼é”æ˜¯æ§åˆ¶ä¸åŒç³»ç»Ÿä¹‹é—´è®¿é—®å…±äº«èµ„æºçš„ä¸€ç§é”å®ç°ï¼Œå¦‚æœä¸åŒçš„ç³»ç»Ÿæˆ–åŒä¸€ä¸ªç³»ç»Ÿçš„ä¸åŒä¸»æœºä¹‹é—´å…±äº«äº†æŸä¸ªèµ„æºæ—¶ï¼Œå¾€å¾€éœ€è¦äº’æ–¥æ¥é˜²æ­¢å½¼æ­¤å¹²æ‰°æ¥ä¿è¯ä¸€è‡´æ€§ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;1.2 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼é”&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;åœ¨å•æœºéƒ¨ç½²çš„ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨çº¿ç¨‹é”æ¥è§£å†³é«˜å¹¶å‘çš„é—®é¢˜ï¼Œå¤šçº¿ç¨‹è®¿é—®å…±äº«å˜é‡çš„é—®é¢˜è¾¾åˆ°æ•°æ®ä¸€è‡´æ€§ï¼Œå¦‚ä½¿ç”¨synchornizedã€ReentrantLockç­‰ã€‚ä½†æ˜¯åœ¨åç«¯é›†ç¾¤éƒ¨ç½²çš„ç³»ç»Ÿä¸­ï¼Œç¨‹åºåœ¨ä¸åŒçš„JVMè™šæ‹Ÿæœºä¸­è¿è¡Œï¼Œä¸”å› ä¸ºsynchronizedæˆ–ReentrantLockéƒ½åªèƒ½ä¿è¯åŒä¸€ä¸ªJVMè¿›ç¨‹ä¸­ä¿è¯æœ‰æ•ˆï¼Œæ‰€ä»¥&lt;span&gt;è¿™æ—¶å°±éœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;äº†&lt;/span&gt;ã€‚&lt;span&gt;è¿™é‡Œå°±ä¸å†èµ˜è¿°&lt;/span&gt;&lt;span&gt;synchornizedé”çš„åŸç†ï¼Œæƒ³äº†è§£å¯ä»¥è¯»è¿™ç¯‡æ–‡ç« &lt;/span&gt;&lt;/span&gt;&lt;a target=&quot;_blank&quot; href=&quot;https://mp.weixin.qq.com/s?__biz=MzkxNTE3ODU0NA==&amp;amp;mid=2247486419&amp;amp;idx=1&amp;amp;sn=74a364f15280f0b65f2ea6bba960b318&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€ã€Šæ·±å…¥ç†è§£synchronziedåº•å±‚åŸç†ã€‹â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;ã€Šæ·±å…¥ç†è§£synchronziedåº•å±‚åŸç†ã€‹&lt;/span&gt;&lt;/a&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;1.3 åˆ†å¸ƒå¼é”éœ€è¦å…·å¤‡çš„æ¡ä»¶&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;åˆ†å¸ƒå¼é”éœ€è¦å…·å¤‡äº’æ–¥æ€§ã€ä¸ä¼šæ­»é”å’Œå®¹é”™ç­‰ã€‚äº’æ–¥æ€§ï¼Œåœ¨äºä¸ç®¡ä»»ä½•æ—¶å€™ï¼Œåº”è¯¥åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æŒæœ‰ä¸€æŠŠé”ï¼›ä¸ä¼šæ­»é”åœ¨äºå³ä½¿æ˜¯æŒæœ‰é”çš„å®¢æˆ·ç«¯æ„å¤–å®•æœºæˆ–å‘ç”Ÿè¿›ç¨‹è¢«killç­‰æƒ…å†µæ—¶ä¹Ÿèƒ½é‡Šæ”¾é”ï¼Œä¸è‡³äºå¯¼è‡´æ•´ä¸ªæœåŠ¡æ­»é”ã€‚å®¹é”™æ€§æŒ‡çš„æ˜¯åªè¦å¤§å¤šæ•°èŠ‚ç‚¹æ­£å¸¸å·¥ä½œï¼Œå®¢æˆ·ç«¯åº”è¯¥éƒ½èƒ½è·å–å’Œé‡Šæ”¾é”ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;2. åˆ†å¸ƒå¼é”çš„å®ç°æ–¹å¼&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç›®å‰ä¸»æµçš„åˆ†å¸ƒå¼é”çš„å®ç°æ–¹å¼ï¼ŒåŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ã€åŸºäºRediså®ç°åˆ†å¸ƒå¼é”ã€åŸºäº&lt;span&gt;ZooKeeperå®ç°åˆ†å¸ƒå¼é”ï¼Œæœ¬ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†Rediså®ç°çš„åˆ†å¸ƒå¼é”ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;2.1 ç”±å•æœºéƒ¨ç½²åˆ°é›†ç¾¤éƒ¨ç½²é”çš„æ¼”å˜&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;ä¸€å¼€å§‹åœ¨redisè®¾ç½®ä¸€ä¸ªé»˜è®¤å€¼keyï¼š&lt;/span&gt;ticket å¯¹åº”çš„&lt;span&gt;å€¼ä¸º20ï¼Œå¹¶æ­å»ºä¸€ä¸ªSpring BootæœåŠ¡ï¼Œç”¨æ¥æ¨¡æ‹Ÿå¤šçª—å£å–ç¥¨ç°è±¡ï¼Œé…ç½®ç±»çš„ä»£ç å°±ä¸ä¸€ä¸€åˆ—å‡ºäº†ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;h4&gt;&lt;br/&gt;&lt;/h4&gt;&lt;h4&gt;&lt;strong&gt;&lt;span&gt;2.1.1 å•æœºæ¨¡å¼è§£å†³å¹¶å‘é—®é¢˜&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;span&gt;ä¸€å¼€å§‹çš„æ—¶å€™åœ¨redisé¢„è®¾ç½®çš„é—¨ç¥¨å€¼ticket=20ï¼Œé‚£ä¹ˆå½“ä¸€ä¸ªè¯·æ±‚è¿›æ¥ä¹‹åï¼Œä¼šåˆ¤æ–­æ˜¯å¦ä½™ç¥¨æ˜¯å¦æ˜¯å¤§äº0ï¼Œè‹¥å¤§äº0é‚£ä¹ˆå°±å°†ä½™ç¥¨å‡ä¸€ï¼Œå†é‡æ–°å†™å…¥Redisä¸­ï¼Œå€˜è‹¥åº“å­˜å°äº0ï¼Œé‚£ä¹ˆå°±ä¼šæ‰“å°é”™è¯¯æ—¥å¿—ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;java&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf&lt;/span&gt;4j&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping&lt;/span&gt;(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;code-snippet__title&quot;&gt;deductTicket&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().get(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            stringRedisTemplate.opsForValue().set(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æï¼š&lt;/strong&gt;è¿™é‡Œæ˜æ˜¾æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“å‰è‹¥æœ‰ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¯·æ±‚è¿›æ¥ï¼Œé‚£ä¹ˆä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è¯·æ±‚è¿™æ®µä»£ç æ—¶ï¼Œå¦‚å›¾thread 1 å’Œthread 2åŒæ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹ä»Redisæ‹¿åˆ°çš„æ•°æ®éƒ½æ˜¯20ï¼Œé‚£ä¹ˆæ‰§è¡Œå®Œæˆåthread 1 å’Œthread 2åˆå°†å‡å®Œåçš„åº“å­˜ticket=19é‡æ–°å†™å…¥Redisï¼Œé‚£ä¹ˆæ•°æ®å°±ä¼šäº§ç”Ÿé—®é¢˜ï¼Œå®é™…ä¸Šä¸¤ä¸ªçº¿ç¨‹å„å‡å»äº†ä¸€å¼ ç¥¨æ•°ï¼Œç„¶è€Œå®é™…å†™è¿›å°±å‡äº†ä¸€æ¬¡ç¥¨æ•°ï¼Œå°±å‡ºç°äº†æ•°æ®ä¸ä¸€è‡´çš„ç°è±¡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6200417536534447&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSERWxRzJK8h7icthDVgYwKRrDmQvicIDRNboX9lhHhU9N7h6UoqjE4GNw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1916&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™ç§é—®é¢˜å¾ˆå¥½è§£å†³ï¼Œä¸Šè¿°é—®é¢˜çš„äº§ç”Ÿå…¶å®å°±æ˜¯ä»Redisä¸­æ‹¿æ•°æ®å’Œå‡ä½™ç¥¨ä¸æ˜¯åŸå­æ“ä½œï¼Œé‚£ä¹ˆæ­¤æ—¶åªéœ€è¦å°†æŒ‰ä¸‹å›¾ä»£ç ç»™è¿™ä¿©æ“ä½œåŠ ä¸ŠsynchronizedåŒæ­¥ä»£ç å¿«å°±èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;java&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf&lt;/span&gt;4j&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping&lt;/span&gt;(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;code-snippet__title&quot;&gt;deductTicket&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-snippet__keyword&quot;&gt;this&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().get(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                stringRedisTemplate.opsForValue().set(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æï¼š&lt;/strong&gt;æ­¤æ—¶å½“å¤šä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°ç¬¬14è¡Œçš„ä½ç½®æ—¶ï¼Œåªä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å–é”ï¼Œè¿›å…¥synchronizedä»£ç å—ä¸­æ‰§è¡Œï¼Œå½“è¯¥çº¿ç¨‹æ‰§è¡Œå®Œæˆåæ‰ä¼šé‡Šæ”¾é”ï¼Œç­‰ä¸‹ä¸ªçº¿ç¨‹è¿›æ¥ä¹‹åå°±ä¼šé‡æ–°ç»™è¿™æ®µä»£ç ä¸Šé”å†æ‰§è¡Œã€‚è¯´ç®€å•äº›å°±æ˜¯è®©æ¯ä¸ªçº¿ç¨‹æ’é˜Ÿæ‰§è¡Œä»£ç å—ä¸­çš„ä»£ç ï¼Œä»è€Œä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸Šè¿°çš„è¿™ç§åšæ³•å¦‚æœåç«¯æœåŠ¡åªæœ‰ä¸€å°æœºå™¨ï¼Œé‚£æ¯«æ— ç–‘é—®æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯ç°åœ¨äº’è”ç½‘å…¬å¸æˆ–è€…æ˜¯ä¸€èˆ¬è½¯ä»¶å…¬å¸ï¼Œåç«¯æœåŠ¡éƒ½ä¸å¯èƒ½åªç”¨ä¸€å°æœºå™¨ï¼Œæœ€å°‘éƒ½æ˜¯2å°æœåŠ¡å™¨ç»„æˆçš„åç«¯æœåŠ¡é›†ç¾¤æ¶æ„ï¼Œé‚£ä¹ˆsynchronizedåŠ é”å°±æ˜¾ç„¶æ²¡æœ‰ä»»ä½•ä½œç”¨äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè‹¥åç«¯æ˜¯ä¸¤ä¸ªå¾®æœåŠ¡æ„æˆçš„æœåŠ¡é›†ç¾¤ï¼Œç”±nginxå°†å¤šä¸ªçš„è¯·æ±‚è´Ÿè½½å‡è¡¡è½¬å‘åˆ°ä¸åŒçš„åç«¯æœåŠ¡ä¸Šï¼Œç”±äºsynchronizeä»£ç å—åªèƒ½åœ¨åŒä¸€ä¸ªJVMè¿›ç¨‹ä¸­ç”Ÿæ•ˆï¼Œä¸¤ä¸ªè¯·æ±‚èƒ½å¤ŸåŒæ—¶è¿›ä¸¤ä¸ªæœåŠ¡ï¼Œæ‰€ä»¥ä¸Šé¢ä»£ç ä¸­çš„synchronizedå°±ä¸€ç‚¹ä½œç”¨æ²¡æœ‰äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.2380952380952381&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSMoiaybFXoxCdk9FXMLl0a67vEEJ6BKBc3eTOpjwW4Sia1Valgez1Qb6g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1092&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç”¨JMeterå·¥å…·éšä¾¿æµ‹è¯•ä¸€ä¸‹ï¼Œå°±å¾ˆç®€å•èƒ½å‘ç°ä¸Šè¿°ä»£ç çš„bugã€‚å®é™…ä¸Šsynchronizedå’ŒjucåŒ…ä¸‹ä¸ªé‚£äº›é”éƒ½æ˜¯åªèƒ½ç”¨äºJVMè¿›ç¨‹ç»´åº¦çš„é”ï¼Œå¹¶ä¸èƒ½è¿ç”¨åœ¨é›†ç¾¤æˆ–åˆ†å¸ƒå¼éƒ¨ç½²çš„ç¯å¢ƒä¸­ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h4&gt;&lt;strong&gt;&lt;span&gt;2.1.2 é›†ç¾¤æ¨¡å¼è§£å†³å¹¶å‘é—®é¢˜&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;span&gt;é€šè¿‡ä¸Šé¢çš„å®éªŒå¾ˆå®¹æ˜“å°±å‘ç°äº†synchronizedç­‰JVMè¿›ç¨‹çº§åˆ«çš„é”å¹¶ä¸èƒ½è§£å†³åˆ†å¸ƒå¼åœºæ™¯ä¸­çš„å¹¶å‘é—®é¢˜ï¼Œå°±æ˜¯ä¸ºäº†åº”å¯¹è¿™ç§åœºæ™¯äº§ç”Ÿäº†åˆ†å¸ƒå¼é”ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æœ¬ç¯‡æ–‡ç« ä»‹ç»äº†&lt;span&gt;Rediså®ç°çš„åˆ†å¸ƒå¼é”ï¼Œ&lt;/span&gt;å¯ä»¥é€šè¿‡Redisçš„setnxï¼ˆåªåœ¨é”®keyä¸å­˜åœ¨çš„æƒ…å†µä¸‹, å°†é”®keyçš„å€¼è®¾ç½®ä¸ºvalueã€‚è‹¥é”®keyå·²ç»å­˜åœ¨, åˆ™SETNXå‘½ä»¤ä¸åšä»»ä½•åŠ¨ä½œã€‚ï¼‰çš„æŒ‡ä»¤æ¥è§£å†³çš„ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³ä¸Šé¢é›†ç¾¤ç¯å¢ƒçš„é”ä¸å”¯ä¸€çš„æƒ…å†µã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf4j&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping(&lt;span class=&quot;code-snippet__meta-string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String deductTicket() throws InterruptedException {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; result = stringRedisTemplate.opsForValue().setIfAbsent(lockKey, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;dewu&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;.FALSE.equals(result)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;error&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        int ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            int realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt;(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        stringRedisTemplate.delete(lockKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æï¼š&lt;/strong&gt;ä»£ç æ˜¯æœ‰é—®é¢˜çš„ï¼Œå°±æ˜¯å½“æ‰§è¡Œæ‰£å‡ä½™ç¥¨æ“ä½œæ—¶ï¼Œè‹¥ä¸šåŠ¡ä»£ç æŠ¥äº†å¼‚å¸¸ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´åé¢çš„åˆ é™¤Redisçš„keyä»£ç æ²¡æœ‰æ‰§è¡Œåˆ°ï¼Œå°±ä¼šä½¿Redisçš„keyæ²¡æœ‰åˆ æ‰çš„æƒ…å†µï¼Œé‚£ä¹ˆRedisçš„è¿™ä¸ªkeyå°±ä¼šä¸€ç›´å­˜åœ¨Redisä¸­ï¼Œåé¢çš„çº¿ç¨‹å†è¿›æ¥æ‰§è¡Œä¸‹é¢è¿™è¡Œä»£ç éƒ½æ˜¯æ‰§è¡Œä¸æˆåŠŸçš„ï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ­»é”ï¼Œé‚£ä¹ˆé—®é¢˜å°±ä¼šå¾ˆä¸¥é‡äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜å…¶å®å¾ˆç®€å•ï¼Œåªè¦åŠ ä¸Šä¸€ä¸ªtry...finallyå³å¯ï¼Œè¿™æ ·ä¸šåŠ¡ä»£ç å³ä½¿æŠ›äº†å¼‚å¸¸ä¹Ÿå¯ä»¥æ­£å¸¸çš„é‡Šæ”¾é”ã€‚&lt;strong&gt;setnx + try ... finallyè§£å†³&lt;/strong&gt;ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf4j&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping(&lt;span class=&quot;code-snippet__meta-string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String deductTicket() throws InterruptedException {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; result = stringRedisTemplate.opsForValue().setIfAbsent(lockKey, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;dewu&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;.FALSE.equals(result)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;error&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            int ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              int realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt;(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            stringRedisTemplate.delete(lockKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æ&lt;/strong&gt;ï¼šä¸Šè¿°é—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯åˆä¼šæœ‰æ–°çš„é—®é¢˜ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°tryä»£ç å—ä¸­æŸä¸ªä½ç½®æœåŠ¡å®•æœºæˆ–è€…æœåŠ¡é‡æ–°å‘å¸ƒï¼Œè¿™æ ·å°±è¿˜æ˜¯ä¼šæœ‰ä¸Šè¿°çš„Redisçš„keyæ²¡æœ‰åˆ æ‰å¯¼è‡´æ­»é”çš„æƒ…å†µã€‚è¿™æ ·å¯ä»¥ä½¿ç”¨Redisçš„è¿‡æœŸæ—¶é—´æ¥è¿›è¡Œè®¾ç½®keyï¼Œ&lt;strong&gt;setnx + è¿‡æœŸæ—¶é—´è§£å†³&lt;/strong&gt;ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf4j&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping(&lt;span class=&quot;code-snippet__meta-string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String deductTicket() throws InterruptedException {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; result = stringRedisTemplate.opsForValue().setIfAbsent(lockKey, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;dewu&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            stringRedisTemplate.expire(lockKey, &lt;span class=&quot;code-snippet__number&quot;&gt;10&lt;/span&gt;, TimeUnit.SECONDS);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;.FALSE.equals(result)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;error&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            int ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              int realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt;(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            stringRedisTemplate.delete(lockKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æ&lt;/strong&gt;ï¼šä¸Šè¿°ä»£ç è§£å†³äº†å› ä¸ºç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­å®•æœºå¯¼è‡´çš„é”æ²¡æœ‰é‡Šæ”¾å¯¼è‡´çš„æ­»é”é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœä»£ç åƒä¸Šè¿°çš„è¿™ç§å†™æ³•ä»ç„¶è¿˜æ˜¯ä¼šæœ‰é—®é¢˜ï¼Œå½“ç¨‹åºæ‰§è¡Œåˆ°ç¬¬18è¡Œæ—¶ï¼Œç¨‹åºå®•æœºäº†ï¼Œæ­¤æ—¶Redisçš„è¿‡æœŸæ—¶é—´å¹¶æ²¡æœ‰è®¾ç½®ï¼Œä¹Ÿä¼šå¯¼è‡´çº¿ç¨‹æ­»é”çš„ç°è±¡ã€‚å¯ä»¥ç”¨äº†Redisè®¾ç½®çš„åŸå­å‘½è®¾ç½®è¿‡æœŸæ—¶é—´çš„å‘½ä»¤ï¼Œ&lt;strong&gt;åŸå­æ€§è¿‡æœŸæ—¶é—´çš„setnxå‘½ä»¤&lt;/strong&gt;ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf4j&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping(&lt;span class=&quot;code-snippet__meta-string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String deductTicket() throws InterruptedException {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; result = stringRedisTemplate.opsForValue().setIfPresent(lockKey, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;dewu&quot;&lt;/span&gt;, &lt;span class=&quot;code-snippet__number&quot;&gt;10&lt;/span&gt;, TimeUnit.SECONDS);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;.FALSE.equals(result)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;error&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            int ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              int realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt;(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            stringRedisTemplate.delete(lockKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æ&lt;/strong&gt;ï¼šé€šè¿‡è®¾ç½®åŸå­æ€§è¿‡æœŸæ—¶é—´å‘½ä»¤å¯ä»¥å¾ˆå¥½çš„è§£å†³ä¸Šè¿°è¿™ç§ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çªç„¶å®•æœºçš„æƒ…å†µã€‚è¿™ç§Redisåˆ†å¸ƒå¼é”çš„å®ç°çœ‹ä¼¼å·²ç»æ²¡æœ‰é—®é¢˜äº†ï¼Œä½†åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ä»»ä¼šå­˜åœ¨é—®é¢˜ï¼Œä¸€èˆ¬è½¯ä»¶å…¬å¸å¹¶å‘é‡ä¸æ˜¯å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼Œè¿™ç§å®ç°åˆ†å¸ƒå¼é”çš„æ–¹å¼å·²ç»å¤Ÿç”¨äº†ï¼Œå³ä½¿å‡ºäº†äº›å°çš„æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯èƒ½å¤Ÿæ¥å—çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œä¸Šè¿°çš„è¿™ç§å®ç°æ–¹å¼è¿˜æ˜¯ä¼šå­˜åœ¨å¾ˆå¤§é—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5625562556255626&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSZmWP3JH2B6wwIkdHBCvqw4rTXrjYWfTglN3wdK3FTiaag9AwDchicicKw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2222&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚ä¸Šé¢ä»£ç æ‰€ç¤ºï¼Œè¯¥åˆ†å¸ƒå¼é”çš„è¿‡æœŸæ—¶é—´æ˜¯10sï¼Œå‡å¦‚thread 1æ‰§è¡Œå®Œæˆæ—¶é—´éœ€è¦15sï¼Œä¸”å½“thread 1çº¿ç¨‹æ‰§è¡Œåˆ°10sæ—¶ï¼ŒRedisçš„keyæ°å¥½å°±æ˜¯è¿‡æœŸå°±ç›´æ¥é‡Šæ”¾é”äº†ï¼Œæ­¤æ—¶thread 2å°±å¯ä»¥è·å¾—é”æ‰§è¡Œä»£ç äº†ï¼Œå‡å¦‚thread 2çº¿ç¨‹æ‰§è¡Œå®Œæˆæ—¶é—´éœ€è¦8sï¼Œé‚£ä¹ˆå½“thread 2çº¿ç¨‹æ‰§è¡Œåˆ°ç¬¬5sæ—¶ï¼Œæ°å¥½thread 1çº¿ç¨‹æ‰§è¡Œäº†é‡Šæ”¾é”çš„ä»£ç â€”â€”â€”â€”&lt;strong&gt;&lt;span&gt;stringRedisTemplate&lt;/span&gt;&lt;/strong&gt;.delete(lockKey); Â æ­¤æ—¶ï¼Œå°±ä¼šå‘ç°thread 1çº¿ç¨‹åˆ é™¤çš„é”å¹¶ä¸æ˜¯å…¶è‡ªå·±çš„åŠ é”ï¼Œè€Œæ˜¯thread 2åŠ çš„é”ï¼›é‚£ä¹ˆthread 3å°±åˆå¯ä»¥è¿›æ¥äº†ï¼Œé‚£ä¹ˆå‡å¦‚ä¸€å…±æ‰§è¡Œ5sï¼Œé‚£ä¹ˆå½“thread 3æ‰§è¡Œåˆ°ç¬¬3sæ—¶ï¼Œthread 2åˆä¼šæ°å¥½æ‰§è¡Œåˆ°é‡Šæ”¾é”çš„ä»£ç ï¼Œé‚£ä¹ˆthread 2åˆåˆ é™¤äº†thread 3 åŠ çš„é”ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå€˜è‹¥é‡åˆ°ä¸Šè¿°é—®é¢˜ï¼Œé‚£å°†æ˜¯ç¾éš¾æ€§çš„bugï¼Œåªè¦é«˜å¹¶å‘å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ†å¸ƒå¼é”å°±ä¼šæ—¶è€ŒåŠ é”æˆåŠŸæ—¶è€ŒåŠ é”å¤±è´¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è§£å†³ä¸Šè¿°é—®é¢˜å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œè®©æ¯ä¸ªçº¿ç¨‹åŠ çš„é”æ—¶ç»™Redisè®¾ç½®ä¸€ä¸ªå”¯ä¸€idçš„valueï¼Œæ¯æ¬¡é‡Šæ”¾é”çš„æ—¶å€™å…ˆåˆ¤æ–­ä¸€ä¸‹çº¿ç¨‹çš„å”¯ä¸€idä¸Redis å­˜çš„å€¼æ˜¯å¦ç›¸åŒï¼Œè‹¥ç›¸åŒå³å¯é‡Šæ”¾é”ã€‚&lt;strong&gt;è®¾ç½®çº¿ç¨‹idçš„åŸå­æ€§è¿‡æœŸæ—¶é—´çš„setnxå‘½ä»¤ï¼Œ&lt;/strong&gt;å…·ä½“ä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@RestController&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__meta&quot;&gt;@Slf4j&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__class&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Resource&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@RequestMapping(&lt;span class=&quot;code-snippet__meta-string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String deductTicket() throws InterruptedException {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String threadUniqueKey = UUID.randomUUID().toString();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; result = stringRedisTemplate.opsForValue().setIfPresent(lockKey, threadUniqueKey, &lt;span class=&quot;code-snippet__number&quot;&gt;10&lt;/span&gt;, TimeUnit.SECONDS);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;.FALSE.equals(result)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;error&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            int ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              int realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt;(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (Objects.equals(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey), threadUniqueKey)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                stringRedisTemplate.delete(lockKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä»£ç è¿è¡Œåˆ†æ&lt;/strong&gt;ï¼šä¸Šè¿°å®ç°çš„Redisåˆ†å¸ƒå¼é”å·²ç»èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†åº”ç”¨åœºæ™¯äº†ï¼Œä½†æ˜¯è¿˜æ˜¯ç•¥æœ‰ä¸è¶³ï¼Œæ¯”å¦‚å½“çº¿ç¨‹è¿›æ¥éœ€è¦çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†Redis keyçš„è¿‡æœŸæ—¶é—´ï¼Œé‚£ä¹ˆæ­¤æ—¶å·²ç»é‡Šæ”¾äº†ï¼Œä½ å…¶ä»–çº¿ç¨‹å°±å¯ä»¥ç«‹é©¬è·å¾—é”æ‰§è¡Œä»£ç ï¼Œå°±åˆä¼šäº§ç”Ÿbugäº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ†å¸ƒå¼é”Redis keyçš„è¿‡æœŸæ—¶é—´ä¸ç®¡è®¾ç½®æˆå¤šå°‘éƒ½ä¸åˆé€‚ï¼Œæ¯”å¦‚å°†è¿‡æœŸæ—¶é—´è®¾ç½®ä¸º30sï¼Œé‚£ä¹ˆå¦‚æœä¸šåŠ¡ä»£ç å‡ºç°äº†ç±»ä¼¼æ…¢SQLã€æŸ¥è¯¢æ•°æ®é‡å¾ˆå¤§é‚£ä¹ˆè¿‡æœŸæ—¶é—´å°±ä¸å¥½è®¾ç½®äº†ã€‚é‚£ä¹ˆè¿™é‡Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ¡ˆå‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„â€”â€”é”ç»­å‘½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£ä¹ˆé”ç»­å‘½æ–¹æ¡ˆçš„åŸæ¥å°±åœ¨äºå½“çº¿ç¨‹åŠ é”æˆåŠŸæ—¶ï¼Œä¼šå¼€ä¸€ä¸ªåˆ†çº¿ç¨‹ï¼Œå–é”è¿‡æœŸæ—¶é—´çš„1/3æ—¶é—´ç‚¹å®šæ—¶æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚ä¸Šå›¾çš„é”ä¸ºä¾‹ï¼Œæ¯10såˆ¤æ–­ä¸€æ¬¡é”æ˜¯å¦å­˜åœ¨(å³Redisçš„key)ï¼Œè‹¥é”è¿˜å­˜åœ¨é‚£ä¹ˆå°±ç›´æ¥é‡æ–°è®¾ç½®é”çš„è¿‡æœŸæ—¶é—´ï¼Œè‹¥é”å·²ç»ä¸å­˜åœ¨äº†é‚£ä¹ˆå°±ç›´æ¥ç»“æŸå½“å‰çš„åˆ†çº¿ç¨‹ã€‚&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;2.2 Redisonæ¡†æ¶å®ç°Redisåˆ†å¸ƒå¼é”&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;ä¸Šè¿°â€œé”ç»­å‘½â€æ–¹æ¡ˆè¯´èµ·æ¥ç®€å•ï¼Œä½†æ˜¯å®ç°èµ·æ¥è¿˜æ˜¯æŒºå¤æ‚çš„ï¼Œäºæ˜¯å¸‚é¢ä¸Šæœ‰å¾ˆå¤šå¼€æºæ¡†æ¶å·²ç»å¸®æˆ‘ä»¬å®ç°å¥½äº†ï¼Œæ‰€ä»¥å°±ä¸éœ€è¦è‡ªå·±å†å»é‡å¤é€ è½®å­å†å»å†™ä¸€ä¸ªåˆ†å¸ƒå¼é”äº†ï¼Œæ‰€ä»¥æœ¬æ¬¡å°±æ‹¿Redisonæ¡†æ¶æ¥ä¸¾ä¾‹ï¼Œä¸»è¦æ˜¯å¯ä»¥å­¦ä¹ è¿™ç§è®¾è®¡åˆ†å¸ƒå¼é”çš„æ€æƒ³ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h4&gt;&lt;br/&gt;&lt;/h4&gt;&lt;h4&gt;&lt;strong&gt;&lt;span&gt;2.2.1 Redisonåˆ†å¸ƒå¼é”çš„ä½¿ç”¨&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;span&gt;Redisonå®ç°çš„åˆ†å¸ƒå¼é”ï¼Œä½¿ç”¨èµ·æ¥è¿˜æ˜¯éå¸¸ç®€å•çš„ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;@RestController&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;@Slf4j&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;RedisLockController&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    @Resource&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Redisson redisson;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    @Resource&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    @RequestMapping(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;/lock&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;code-snippet__title&quot;&gt;deductTicket&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;/&gt;) throws InterruptedException&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String lockKey = &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;ticket&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        RLock &lt;span class=&quot;code-snippet__keyword&quot;&gt;lock&lt;/span&gt; = redisson.getLock(lockKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;lock&lt;/span&gt;.&lt;span class=&quot;code-snippet__keyword&quot;&gt;lock&lt;/span&gt;();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; ticketCount = Integer.parseInt(stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(lockKey));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ticketCount &amp;gt; &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              &lt;span class=&quot;code-snippet__keyword&quot;&gt;int&lt;/span&gt; realTicketCount = ticketCount - &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.info(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡æˆåŠŸï¼Œå‰©ä½™ç¥¨æ•°ï¼š&quot;&lt;/span&gt; + realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;set&lt;/span&gt;(lockKey, realTicketCount + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;              log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;æ‰£å‡å¤±è´¥ï¼Œä½™ç¥¨ä¸è¶³&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;lock&lt;/span&gt;.unlock();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end&quot;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;h4&gt;&lt;br/&gt;&lt;/h4&gt;&lt;h4&gt;&lt;strong&gt;&lt;span&gt;2.2.2 Redisonåˆ†å¸ƒå¼é”çš„åŸç†&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;span&gt;Redisonå®ç°åˆ†å¸ƒå¼é”çš„åŸç†æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå½“çº¿ç¨‹1åŠ é”æˆåŠŸï¼Œå¹¶å¼€å§‹æ‰§è¡Œä¸šåŠ¡ä»£ç æ—¶ï¼ŒRedisonæ¡†æ¶ä¼šå¼€å¯ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œæ¯éš”é”è¿‡æœŸæ—¶é—´çš„1/3æ—¶é—´å®šæ—¶åˆ¤æ–­ä¸€æ¬¡æ˜¯å¦è¿˜æŒæœ‰é”(Redisä¸­çš„keyæ˜¯å¦è¿˜å­˜åœ¨)ï¼Œè‹¥ä¸æŒæœ‰é‚£ä¹ˆå°±ç›´æ¥ç»“æŸå½“å‰çš„åå°çº¿ç¨‹ï¼Œè‹¥è¿˜æŒæœ‰é”ï¼Œé‚£ä¹ˆå°±é‡æ–°è®¾ç½®é”çš„è¿‡æœŸæ—¶é—´ã€‚å½“çº¿ç¨‹1åŠ é”æˆåŠŸåï¼Œé‚£ä¹ˆçº¿ç¨‹2å°±ä¼šåŠ é”å¤±è´¥ï¼Œæ­¤æ—¶çº¿ç¨‹2å°±ä¼šå°±ä¼šåšç±»ä¼¼äºCASçš„è‡ªæ—‹æ“ä½œï¼Œä¸€ç›´ç­‰å¾…çº¿ç¨‹1é‡Šæ”¾äº†ä¹‹åçº¿ç¨‹2æ‰èƒ½åŠ é”æˆåŠŸã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7936016511867905&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSSney9J4VJ6loppgSJOT2wGjc46iaYQlf0GJ0HhuIvAnVsib5JMlwK4Gg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1938&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h4&gt;&lt;strong&gt;&lt;span&gt;2.2.3 Redisonåˆ†å¸ƒå¼é”çš„æºç åˆ†æ&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p&gt;&lt;span&gt;Redisonåº•å±‚å®ç°åˆ†å¸ƒå¼é”æ—¶ä½¿ç”¨äº†å¤§é‡çš„luaè„šæœ¬ä¿è¯äº†å…¶åŠ é”æ“ä½œçš„å„ç§åŸå­æ€§ã€‚Redisonå®ç°åˆ†å¸ƒå¼é”ä½¿ç”¨luaè„šæœ¬çš„å¥½å¤„ä¸»è¦æ˜¯èƒ½ä¿è¯Redisçš„æ“ä½œæ˜¯åŸå­æ€§çš„ï¼ŒRedisä¼šå°†æ•´ä¸ªè„šæœ¬ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œï¼Œä¸­é—´ä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’å…¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Redissonæ ¸å¿ƒä½¿ç”¨luaè„šæœ¬åŠ é”æºç åˆ†æï¼š&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ–¹æ³•åä¸ºtryLockInnerAsync(long leaseTime, TimeUnit unit, long threadId, RedisStrictCommand&amp;lt;T&amp;gt; command)ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&amp;lt;T&amp;gt; &lt;span class=&quot;code-snippet__function&quot;&gt;RFuture&amp;lt;T&amp;gt; &lt;span class=&quot;code-snippet__title&quot;&gt;tryLockInnerAsync&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; leaseTime, TimeUnit unit, &lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; threadId, RedisStrictCommand&amp;lt;T&amp;gt; command&lt;/span&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     internalLockLeaseTime = unit.toMillis(leaseTime);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; commandExecutor.evalWriteAsync(getName(), LongCodec.INSTANCE, command,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;if (redis.call(&#x27;exists&#x27;, KEYS[1]) == 0) then &quot;&lt;/span&gt; +  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;hset&#x27;, KEYS[1], ARGV[2], 1); &quot;&lt;/span&gt; +  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;pexpire&#x27;, KEYS[1], ARGV[1]); &quot;&lt;/span&gt; +    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return nil; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;if (redis.call(&#x27;hexists&#x27;, KEYS[1], ARGV[2]) == 1) then &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;hincrby&#x27;, KEYS[1], ARGV[2], 1); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;pexpire&#x27;, KEYS[1], ARGV[1]); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return nil; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return redis.call(&#x27;pttl&#x27;, KEYS[1]);&quot;&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             Collections.&amp;lt;Object&amp;gt;singletonList(getName()), internalLockLeaseTime, getLockName(threadId));   &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è®¾ç½®ç›‘å¬å™¨æ–¹æ³•ï¼šæ–¹æ³•åtryAcquireOnceAsync(long leaseTime, TimeUnit unit, final long threadId)ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; RFuture&amp;lt;&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;&amp;gt; tryAcquireOnceAsync(long leaseTime, TimeUnit unit, &lt;span class=&quot;code-snippet__keyword&quot;&gt;final&lt;/span&gt; long threadId) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (leaseTime != -&lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; tryLockInnerAsync(leaseTime, unit, threadId, RedisCommands.EVAL_NULL_BOOLEAN);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        RFuture&amp;lt;&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;&amp;gt; ttlRemainingFuture = tryLockInnerAsync(commandExecutor.getConnectionManager().getCfg().getLockWatchdogTimeout(), TimeUnit.MILLISECONDS, threadId, RedisCommands.EVAL_NULL_BOOLEAN);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        ttlRemainingFuture.addListener(new FutureListener&amp;lt;&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;&amp;gt;() {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; void operationComplete(Future&amp;lt;&lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt;&amp;gt; future) throws Exception {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (!future.isSuccess()) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; ttlRemaining = future.getNow();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ttlRemaining) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    scheduleExpirationRenewal(threadId);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; ttlRemainingFuture;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å®šæ—¶ä»»åŠ¡æ‰§è¡Œæ–¹æ³•: Â æ–¹æ³•åscheduleExpirationRenewal(final long threadId)ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;java&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;scheduleExpirationRenewal&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(&lt;span class=&quot;code-snippet__keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; threadId)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (expirationRenewalMap.containsKey(getEntryName())) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        Timeout task = commandExecutor.getConnectionManager().newTimeout(&lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; TimerTask() {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(Timeout timeout)&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                RFuture&amp;lt;Boolean&amp;gt; future = commandExecutor.evalWriteAsync(getName(), LongCodec.INSTANCE, RedisCommands.EVAL_BOOLEAN,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;if (redis.call(&#x27;hexists&#x27;, KEYS[1], ARGV[2]) == 1) then &quot;&lt;/span&gt; + &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                            &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;pexpire&#x27;, KEYS[1], ARGV[1]); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                            &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return 1; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;             &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return 0;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                          Collections.&amp;lt;Object&amp;gt;singletonList(getName()), internalLockLeaseTime, getLockName(threadId));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                future.addListener(&lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; FutureListener&amp;lt;Boolean&amp;gt;() {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;operationComplete&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(Future&amp;lt;Boolean&amp;gt; future)&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        expirationRenewalMap.remove(getEntryName());&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (!future.isSuccess()) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                            log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;Can&#x27;t update lock &quot;&lt;/span&gt; + getName() + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot; expiration&quot;&lt;/span&gt;, future.cause());&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                            &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (future.getNow()) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                            &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                            scheduleExpirationRenewal(threadId);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }, internalLockLeaseTime / &lt;span class=&quot;code-snippet__number&quot;&gt;3&lt;/span&gt;, TimeUnit.MILLISECONDS);  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (expirationRenewalMap.putIfAbsent(getEntryName(), task) != &lt;span class=&quot;code-snippet__keyword&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            task.cancel();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; Long &lt;span class=&quot;code-snippet__title&quot;&gt;tryAcquire&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; leaseTime, TimeUnit unit, &lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; threadId&lt;/span&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(tryAcquireAsync(leaseTime, unit, threadId));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;java&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;lockInterruptibly&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(&lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; leaseTime, TimeUnit unit)&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; threadId = Thread.currentThread().getId();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        Long ttl = tryAcquire(leaseTime, unit, threadId);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ttl == &lt;span class=&quot;code-snippet__keyword&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        RFuture&amp;lt;RedissonLockEntry&amp;gt; future = subscribe(threadId);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        commandExecutor.syncSubscription(future);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;code-snippet__keyword&quot;&gt;true&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                ttl = tryAcquire(leaseTime, unit, threadId);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ttl == &lt;span class=&quot;code-snippet__keyword&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__keyword&quot;&gt;break&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (ttl &amp;gt;= &lt;span class=&quot;code-snippet__number&quot;&gt;0&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    getEntry(threadId).getLatch().tryAcquire(ttl, TimeUnit.MILLISECONDS);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    getEntry(threadId).getLatch().acquire();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            unsubscribe(future, threadId);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Redisonåº•å±‚è§£é”æºç åˆ†æï¼š&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;typescript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;void&lt;/span&gt; unlock() {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; opStatus = &lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(unlockInnerAsync(Thread.currentThread().getId()));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (opStatus == &lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; IllegalMonitorStateException(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;attempt to unlock lock, not locked by current thread by node id: &quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    + id + &lt;span class=&quot;code-snippet__string&quot;&gt;&quot; thread-id: &quot;&lt;/span&gt; + Thread.currentThread().getId());&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (opStatus) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;          &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            cancelExpirationRenewal();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;protected&lt;/span&gt; RFuture&amp;lt;Boolean&amp;gt; &lt;span class=&quot;code-snippet__title&quot;&gt;unlockInnerAsync&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;long&lt;/span&gt; threadId&lt;/span&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; commandExecutor.evalWriteAsync(getName(), LongCodec.INSTANCE, RedisCommands.EVAL_BOOLEAN,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;if (redis.call(&#x27;exists&#x27;, KEYS[1]) == 0) then &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;publish&#x27;, KEYS[2], ARGV[1]); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return 1; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end;&quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;if (redis.call(&#x27;hexists&#x27;, KEYS[1], ARGV[3]) == 0) then &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return nil;&quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;local counter = redis.call(&#x27;hincrby&#x27;, KEYS[1], ARGV[3], -1); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;if (counter &amp;gt; 0) then &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;pexpire&#x27;, KEYS[1], ARGV[2]); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return 0; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;else &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;del&#x27;, KEYS[1]); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;redis.call(&#x27;publish&#x27;, KEYS[2], ARGV[1]); &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return 1; &quot;&lt;/span&gt;+&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;end; &quot;&lt;/span&gt; +&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;return nil;&quot;&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                Arrays.&amp;lt;Object&amp;gt;asList(getName(), getChannelName()), LockPubSub.unlockMessage, internalLockLeaseTime, getLockName(threadId));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;cancelExpirationRenewal&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;/&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        Timeout task = expirationRenewalMap.&lt;span class=&quot;code-snippet__keyword&quot;&gt;remove&lt;/span&gt;(getEntryName());&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (task != &lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            task.cancel();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸Šè¿°æƒ…å†µå¦‚æœæ˜¯å•å°Redisï¼Œé‚£ä¹ˆåˆ©ç”¨Redisonå¼€æºæ¡†æ¶å®ç°Redisçš„åˆ†å¸ƒå¼é”å·²ç»å¾ˆå®Œç¾äº†ï¼Œä½†æ˜¯å¾€å¾€ç”Ÿäº§ç¯å¢ƒçš„çš„Redisä¸€èˆ¬éƒ½æ˜¯å“¨å…µä¸»ä»æ¶æ„ï¼ŒRedisçš„ä¸»ä»æ¶æ„æœ‰åˆ«ä¸Zookeeperçš„ä¸»ä»ï¼Œå®¢æˆ·ç«¯åªèƒ½è¯·æ±‚Redisä¸»ä»æ¶æ„çš„MasterèŠ‚ç‚¹ï¼ŒSlaveèŠ‚ç‚¹åªèƒ½åšæ•°æ®å¤‡ä»½ï¼ŒRedisä»MasteråŒæ­¥æ•°æ®åˆ°Slaveå¹¶ä¸éœ€è¦åŒæ­¥å®Œæˆåæ‰èƒ½ç»§ç»­æ¥æ”¶æ–°çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ä¸ªä¸»ä»åŒæ­¥çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å½“Redisçš„é”è®¾ç½®æˆåŠŸï¼Œæ­£åœ¨æ‰§è¡Œä¸šåŠ¡ä»£ç ï¼Œå½“Rediså‘ä»æœåŠ¡å™¨åŒæ­¥æ—¶ï¼ŒRedisçš„MasteèŠ‚ç‚¹å®•æœºäº†ï¼ŒRedisåˆšåˆšè®¾ç½®æˆåŠŸçš„é”è¿˜æ²¡æ¥å¾—åŠåŒæ­¥åˆ°SlaveèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ­¤æ—¶Redisçš„ä¸»ä»å“¨å…µæ¨¡å¼å°±ä¼šé‡æ–°é€‰ä¸¾å‡ºæ–°çš„MasterèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°çš„MasterèŠ‚ç‚¹å…¶å®å°±æ˜¯åŸæ¥çš„SlaveèŠ‚ç‚¹ï¼Œæ­¤æ—¶åé¢è¯·æ±‚è¿›æ¥çš„çº¿ç¨‹éƒ½ä¼šè¯·æ±‚è¿™ä¸ªæ–°çš„MasterèŠ‚ç‚¹ï¼Œç„¶è€Œé€‰ä¸¾åäº§ç”Ÿçš„æ–°MasterèŠ‚ç‚¹å®é™…ä¸Šæ˜¯æ²¡æœ‰é‚£æŠŠé”çš„ï¼Œé‚£ä¹ˆä»è€Œå¯¼è‡´äº†é”çš„å¤±æ•ˆã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5574817518248175&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSmka3ics0rkZIvYq7iasHeN1AYIU7woZJh84jqVz5KtHRqibbbPyoUaSMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2192&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸Šè¿°é—®é¢˜ç”¨Redisä¸»ä»å“¨å…µæ¶æ„å®ç°çš„åˆ†å¸ƒå¼é”åœ¨è¿™ç§æç«¯æƒ…å†µä¸‹æ˜¯æ— æ³•é¿å…çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ç”Ÿäº§ä¸Šè¿™ç§æ•…éšœçš„æ¦‚ç‡æä½ï¼Œå³ä½¿å¶å°”æœ‰é—®é¢˜ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚æœæƒ³ä½¿åˆ†å¸ƒå¼é”å˜çš„ç™¾åˆ†ç™¾å¯é ï¼Œé‚£å¯ä»¥é€‰ç”¨Zookeeperä½œä¸ºåˆ†å¸ƒå¼é”ï¼Œå°±èƒ½å®Œç¾çš„è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç”±äºzkçš„ä¸»ä»æ•°æ®åŒæ­¥æœ‰åˆ«ä¸Redisä¸»ä»åŒæ­¥ï¼Œzkçš„å¼ºä¸€è‡´æ€§ä½¿å¾—å½“å®¢æˆ·ç«¯è¯·æ±‚zkçš„LeaderèŠ‚ç‚¹åŠ é”æ—¶ï¼Œå½“Leaderå°†è¿™ä¸ªé”åŒæ­¥åˆ°äº†zké›†ç¾¤çš„å¤§éƒ¨åˆ†èŠ‚ç‚¹æ—¶ï¼ŒLeaderèŠ‚ç‚¹æ‰ä¼šè¿”å›å®¢æˆ·ç«¯åŠ é”æˆåŠŸï¼Œæ­¤æ—¶å½“LeaderèŠ‚ç‚¹å®•æœºä¹‹åï¼Œzkå†…éƒ¨é€‰ä¸¾äº§ç”Ÿæ–°çš„LeaderèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ–°çš„å®¢æˆ·æ¬¾è®¿é—®æ–°çš„LeaderèŠ‚ç‚¹æ—¶ï¼Œè¿™ä¸ªé”ä¹Ÿä¼šå­˜åœ¨ï¼Œæ‰€ä»¥zké›†ç¾¤èƒ½å¤Ÿå®Œç¾è§£å†³ä¸Šè¿°Redisé›†ç¾¤çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç”±äºRediså’ŒZookeeperçš„è®¾è®¡æ€è·¯ä¸ä¸€æ ·ï¼Œä»»ä½•åˆ†å¸ƒå¼æ¶æ„éƒ½éœ€è¦æ»¡è¶³CAPç†è®ºï¼Œâ€œé±¼å’Œç†ŠæŒä¸å¯å…¼å¾—â€ï¼Œè¦ä¹ˆé€‰æ‹©APè¦ä¹ˆé€‰æ‹©CPï¼Œå¾ˆæ˜¾ç„¶Redisæ˜¯APç»“æ„ï¼Œè€Œzkæ˜¯å±äºCPæ¶æ„ï¼Œä¹Ÿå¯¼è‡´äº†ä¸¤è€…çš„æ•°æ®åŒæ­¥æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å…¶å®è®¾è®¡Redisåˆ†å¸ƒå¼é”æœ‰ç§RedLockçš„æ€æƒ³å°±æ˜¯å€Ÿé‰´zkå®ç°åˆ†å¸ƒå¼é”çš„è¿™ä¸ªç‰¹ç‚¹ï¼Œè¿™ç§Redisçš„åŠ é”æ–¹å¼åœ¨Redisonæ¡†æ¶ä¸­ä¹Ÿæœ‰æä¾›apiï¼Œå…·ä½“ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œè¿™é‡Œå°±ä¸ä¸€ä¸€èµ˜è¿°äº†ã€‚å…¶ä¸»è¦æ€æƒ³å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4489795918367347&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSF5QS0HdR9HMsfBsodTTyIebjGruUp4U6LSgp2QE1EVn2WicicCDEzVMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1862&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™ç§å®ç°æ–¹å¼ï¼Œæˆ‘è®¤ä¸ºç”Ÿäº§ä¸Šå¹¶ä¸æ¨èä½¿ç”¨ã€‚å¾ˆç®€å•åŸæœ¬åªéœ€è¦å¯¹ä¸€ä¸ªRedisåŠ é”ï¼Œè®¾ç½®æˆåŠŸè¿”å›å³å¯ï¼Œä½†æ˜¯ç°åœ¨éœ€è¦å¯¹å¤šä¸ªRedisè¿›è¡ŒåŠ é”ï¼Œæ— å½¢ä¹‹ä¸­å¢åŠ äº†å¥½å‡ æ¬¡ç½‘ç»œIOï¼Œä¸‡ä¸€ç¬¬ä¸€ä¸ªRedisåŠ é”æˆåŠŸåï¼Œåé¢å‡ ä¸ªRedisåœ¨åŠ é”è¿‡ç¨‹ä¸­å‡ºç°äº†ç±»ä¼¼ç½‘ç»œå¼‚å¸¸çš„è¿™ç§æƒ…å†µï¼Œé‚£ç¬¬ä¸€ä¸ªRedisçš„æ•°æ®å¯èƒ½å°±éœ€è¦åšæ•°æ®å›æ»šæ“ä½œäº†ï¼Œé‚£ä¸ºäº†è§£å†³ä¸€ä¸ªæä½æ¦‚ç‡å‘ç”Ÿçš„é—®é¢˜åˆå¼•å…¥äº†å¤šä¸ªå¯èƒ½äº§ç”Ÿçš„æ–°é—®é¢˜ï¼Œå¾ˆæ˜¾ç„¶å¾—ä¸å¿å¤±ã€‚å¹¶ä¸”è¿™é‡Œè¿˜æœ‰å¯èƒ½å‡ºç°æ›´å¤šä¹±ä¸ƒå…«ç³Ÿçš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºè¿™ç§Redisåˆ†å¸ƒå¼é”çš„å®ç°æ–¹å¼æå…¶ä¸æ¨èç”Ÿäº§ä½¿ç”¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é€€ä¸€ä¸‡è¯´å¦‚æœçœŸçš„éœ€è¦è¿™ç§å¼ºä¸€è‡´æ€§çš„åˆ†å¸ƒå¼é”çš„è¯ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨zkå®ç°çš„åˆ†å¸ƒå¼é”å‘¢ï¼Œæ€§èƒ½è‚¯å®šä¹Ÿæ¯”è¿™ä¸ªRedLockçš„æ€§èƒ½è¦å¥½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;strong&gt;&lt;span&gt;3. åˆ†å¸ƒå¼é”ä½¿ç”¨åœºæ™¯&lt;/span&gt;&lt;/strong&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™é‡Œç€é‡è®²ä¸€ä¸‹åˆ†å¸ƒå¼é”çš„ä¸¤ç§ä»¥ä¸‹ä½¿ç”¨åœºæ™¯ï¼š&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt; &lt;strong&gt;3.1 çƒ­ç‚¹ç¼“å­˜keyé‡å»ºä¼˜åŒ–&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸€èˆ¬æƒ…å†µä¸‹äº’è”ç½‘å…¬å¸åŸºæœ¬éƒ½æ˜¯ä½¿ç”¨â€œç¼“å­˜â€åŠ è¿‡æœŸæ—¶é—´çš„ç­–ç•¥ï¼Œè¿™æ ·ä¸ä»…åŠ å¿«æ•°æ®è¯»å†™ï¼Œ è€Œä¸”è¿˜èƒ½ä¿è¯æ•°æ®çš„å®šæœŸæ›´æ–°ï¼Œè¿™ç§ç­–ç•¥èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚ï¼Œä½†æ˜¯ä¹Ÿä¼šæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µä¼šæœ‰é—®é¢˜ï¼šåŸæœ¬å°±å­˜åœ¨ä¸€ä¸ªå†·é—¨çš„keyï¼Œå› ä¸ºæŸä¸ªçƒ­ç‚¹æ–°é—»çš„å‡ºç°ï¼Œçªç„¶è¿™ä¸ªå†·é—¨çš„keyè¯·æ±‚é‡æš´å¢æˆäº†ä½¿å…¶ç§°ä¸ºäº†ä¸€ä¸ªçƒ­ç‚¹keyï¼Œæ­¤æ—¶ç¼“å­˜å¤±æ•ˆï¼Œå¹¶ä¸”åˆæ— æ³•åœ¨å¾ˆçŸ­æ—¶é—´å†…é‡æ–°è®¾ç½®ç¼“å­˜ï¼Œé‚£ä¹ˆç¼“å­˜å¤±æ•ˆçš„ç¬é—´ï¼Œå°±ä¼šæœ‰å¤§é‡çº¿ç¨‹æ¥è®¿é—®åˆ°åç«¯ï¼Œé€ æˆæ•°æ®åº“è´Ÿè½½åŠ å¤§ï¼Œä»è€Œå¯èƒ½ä¼šè®©åº”ç”¨å´©æºƒã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¾‹å¦‚ï¼šâ€œAir Force oneâ€åŸæœ¬å°±æ˜¯ä¸€ä¸ªå†·é—¨çš„keyå­˜åœ¨äºç¼“å­˜ä¸­ï¼Œå¾®åšçªç„¶æœ‰ä¸ªæ˜æ˜Ÿç©¿ç€â€œAir Force oneâ€ä¸Šäº†çƒ­æœï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å¾ˆå¤šæ˜æ˜Ÿçš„ç²‰ä¸æ¥å¾—ç‰©appè´­ä¹°â€œAir Force oneâ€ï¼Œæ­¤æ—¶çš„â€œAir Force oneâ€å°±ç›´æ¥æˆä¸ºäº†ä¸€ä¸ªçƒ­ç‚¹keyï¼Œé‚£ä¹ˆæ­¤æ—¶â€œAir Force oneâ€è¿™ä¸ªkeyå¦‚æœç¼“å­˜æ°å¥½å¤±æ•ˆäº†ä¹‹åï¼Œå°±ä¼šæœ‰å¤§é‡çš„è¯·æ±‚åŒæ—¶è®¿é—®åˆ°dbï¼Œä¼šç»™åç«¯é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œç”šè‡³ä¼šè®©ç³»ç»Ÿå®•æœºã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¦è§£å†³è¿™ä¸ªé—®é¢˜åªéœ€è¦ç”¨ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒå¼é”å³å¯è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªå…è®¸ä¸€ä¸ªçº¿ç¨‹å»é‡å»ºç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…é‡å»ºç¼“å­˜çš„çº¿ç¨‹æ‰§è¡Œå®Œï¼Œ é‡æ–°ä»ç¼“å­˜è·å–æ•°æ®å³å¯ã€‚å¯è§ä¸‹é¢çš„å®ä¾‹ä¼ªä»£ç ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;//åˆ†å¸ƒå¼é”è§£å†³çƒ­ç‚¹ç¼“å­˜ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;public&lt;/span&gt; String &lt;span class=&quot;code-snippet__title&quot;&gt;getCache&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;String key&lt;/span&gt;)&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        String &lt;span class=&quot;code-snippet__keyword&quot;&gt;value&lt;/span&gt; = stringRedisTemplate.opsForValue().&lt;span class=&quot;code-snippet__keyword&quot;&gt;get&lt;/span&gt;(key);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (Objects.isNull(&lt;span class=&quot;code-snippet__keyword&quot;&gt;value&lt;/span&gt;)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                String mutexKey = key;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;value&lt;/span&gt; = mysql.getDataFromMySQL();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                stringRedisTemplate.opsForValue().setIfPresent(mutexKey, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;poizon&quot;&lt;/span&gt;, &lt;span class=&quot;code-snippet__number&quot;&gt;60&lt;/span&gt;, TimeUnit.SECONDS);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                stringRedisTemplate.delete(mutexKey);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                Thread.sleep(&lt;span class=&quot;code-snippet__number&quot;&gt;100&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                getCache(key);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        } &lt;span class=&quot;code-snippet__keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException e) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            log.error(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;getCache is error&quot;&lt;/span&gt;, e);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;value&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;3.2 è§£å†³ç¼“å­˜ä¸æ•°æ®åº“æ•°æ®ä¸ä¸€è‡´é—®é¢˜&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;å¦‚æœä¸šåŠ¡å¯¹æ•°æ®çš„ç¼“å­˜ä¸æ•°æ®åº“éœ€è¦å¼ºä¸€è‡´æ—¶ï¼Œä¸”å¹¶å‘é‡ä¸æ˜¯å¾ˆé«˜çš„æƒ…å†µä¸‹çš„æƒ…å†µä¸‹æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥åŠ ä¸€ä¸ªåˆ†å¸ƒå¼è¯»å†™é”å°±å¯ä»¥ç›´æ¥è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚å¯ä»¥ç›´æ¥åˆ©ç”¨å¯ä»¥åŠ åˆ†å¸ƒå¼è¯»å†™é”ä¿è¯å¹¶å‘è¯»å†™æˆ–å†™å†™çš„æ—¶å€™æŒ‰é¡ºåºæ’å¥½é˜Ÿï¼Œè¯»è¯»çš„æ—¶å€™ç›¸å½“äºæ— é”ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¹¶å‘é‡ä¸æ˜¯å¾ˆé«˜ä¸”ä¸šåŠ¡å¯¹ç¼“å­˜ä¸æ•°æ®åº“æœ‰ç€å¼ºä¸€è‡´å¯¹è¦æ±‚æ—¶ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å®ç°æœ€ç®€å•ï¼Œä¸”æ•ˆæœç«‹ç«¿è§å½±ã€‚å€˜è‹¥åœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œå¦‚æœè¿˜ç›‘å¬binlogé€šè¿‡æ¶ˆæ¯çš„æ–¹å¼å»¶è¿ŸåŒåˆ çš„æ–¹å¼å»ä¿è¯æ•°æ®ä¸€è‡´æ€§çš„è¯ï¼Œå¼•å…¥äº†æ–°çš„ä¸­é—´ä»¶å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œå¾—ä¸å¿å¤±ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;3.3è¶…é«˜å¹¶å‘åœºæ™¯ä¸‹çš„åˆ†å¸ƒå¼é”è®¾è®¡ç†è®º&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;ä¸ConcurrentHashMapçš„è®¾è®¡æ€æƒ³æœ‰ç‚¹ç±»ä¼¼ï¼Œç”¨åˆ†æ®µé”æ¥å®ç°ï¼Œè¿™ä¸ªæ˜¯ä¹‹å‰åœ¨ç½‘ä¸Šçœ‹åˆ°çš„å®ç°æ€è·¯ï¼Œæœ¬äººå¹¶æ²¡æœ‰å®é™…ä½¿ç”¨è¿‡ï¼Œä¸çŸ¥é“æ°´æ·±ä¸æ·±ï¼Œä½†æ˜¯å¯ä»¥å­¦ä¹ ä¸€ä¸‹å®ç°æ€è·¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å‡å¦‚Aå•†å“çš„åº“å­˜æ˜¯2000ä¸ªï¼Œç°åœ¨å¯ä»¥å°†è¯¥Aå•†å“çš„2000ä¸ªåº“å­˜åˆ©ç”¨ç±»ä¼¼ConcurrentHashMapçš„åŸç†å°†ä¸åŒæ•°é‡æ®µä½çš„åº“å­˜çš„åˆ©ç”¨å–æ¨¡æˆ–è€…æ˜¯hashç®—æ³•è®©å…¶æ‰©å®¹åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šå»ï¼Œè¿™æ ·è¿™2000çš„åº“å­˜å°±æ°´å¹³æ‰©å®¹åˆ°äº†å¤šä¸ªRedisèŠ‚ç‚¹ä¸Šï¼Œç„¶åè¯·æ±‚Redisæ‹¿åº“å­˜çš„æ—¶å€™è¯·æ±‚åŸæœ¬åªèƒ½ä»ä¸€ä¸ªRedisä¸Šå–æ•°æ®ï¼Œç°åœ¨å¯ä»¥ä»äº”ä¸ªRedisä¸Šå–æ•°æ®ï¼Œä»è€Œå¯ä»¥å¤§å¤§æé«˜å¹¶å‘æ•ˆç‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.52516010978957&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUSeKj1wibtG5DyNpFK6lfVrvv8k0FU0erejpqmMMeUAwSiaOcibDl3wIqnQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2186&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;4. æ€»ç»“ä¸æ€è€ƒ&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;ç»¼ä¸Šå¯çŸ¥ï¼ŒRedisåˆ†å¸ƒå¼é”å¹¶ä¸æ˜¯ç»å¯¹å®‰å…¨ï¼ŒRedisåˆ†å¸ƒå¼é”åœ¨æŸç§æç«¯æƒ…å†µä¸‹æ˜¯æ— æ³•é¿å…çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ç”Ÿäº§ä¸Šè¿™ç§æ•…éšœçš„æ¦‚ç‡æä½ï¼Œå³ä½¿å¶å°”æœ‰é—®é¢˜ä¹Ÿæ˜¯å¯ä»¥æ¥å—ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;CAP åŸåˆ™æŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰è¿™ä¸‰ä¸ªè¦ç´ æœ€å¤šåªèƒ½åŒæ—¶å®ç°ä¸¤ç‚¹ï¼Œä¸å¯èƒ½ä¸‰è€…å…¼é¡¾ã€‚é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—â€ï¼Œè¦ä¹ˆé€‰æ‹©APè¦ä¹ˆé€‰æ‹©CPï¼Œé€‰æ‹©Redisä½œä¸ºåˆ†å¸ƒå¼é”çš„ç»„ä»¶åœ¨äºå…¶å•çº¿ç¨‹å†…å­˜æ“ä½œæ•ˆç‡å¾ˆé«˜ï¼Œä¸”åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ä¹Ÿå¯ä»¥ä¿æŒå¾ˆå¥½çš„æ€§èƒ½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚æœä¸€å®šè¦è¦æ±‚åˆ†å¸ƒå¼é”ç™¾åˆ†ç™¾å¯é ï¼Œé‚£å¯ä»¥é€‰ç”¨&lt;span&gt;Zookeeper&lt;/span&gt;æˆ–è€…MySQLä½œä¸ºåˆ†å¸ƒå¼é”ï¼Œå°±èƒ½å®Œç¾çš„è§£å†³é”å®‰å…¨çš„é—®é¢˜ï¼Œä½†æ˜¯é€‰æ‹©äº†ä¸€è‡´æ€§é‚£å°±è¦å¤±å»å¯ç”¨æ€§ï¼Œæ‰€ä»¥&lt;span&gt;Zookeeper&lt;/span&gt;æˆ–è€…MySQLå®ç°çš„åˆ†å¸ƒå¼é”çš„æ€§èƒ½è¿œä¸å¦‚Rediså®ç°çš„åˆ†å¸ƒå¼é”ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æœ€åç€é‡æ„Ÿè°¢ç»„å†…åŒå­¦å¯¹æœ¬ç¯‡blogçš„å»ºè®®ä¸æ”¯æŒï¼Œè‹¥æœ‰ä¸è¶³çš„åœ°æ–¹çƒ¦è¯·æŒ‡å‡ºï¼Œå¤§å®¶å¯ä»¥ä¸€èµ·æ¢è®¨å­¦ä¹ ï¼Œå…±åŒè¿›æ­¥ã€‚ğŸ˜ğŸ˜&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.0707964601769913&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74B6eN0ZqvvMibcS9HYWaZiaUS0bjUXeXE5xJhN4ldJDSPcmnRDUWDGneH2aBxP7a8qTtSTVr2gredOQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;113&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Â *æ–‡&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;/harmony&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;Â å…³æ³¨å¾—ç‰©æŠ€æœ¯ï¼Œæ¯å‘¨ä¸€ä¸‰äº”æ™š18:30æ›´æ–°æŠ€æœ¯å¹²è´§&lt;br/&gt;è¦æ˜¯è§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©çš„è¯ï¼Œæ¬¢è¿è¯„è®ºè½¬å‘ç‚¹èµï½&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzkxNTE3ODU0NA==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/AAQtmjCc74Diclic7XyegA4UmC0SqoT4jDEpdzibjkibmAvz8svbJwfsufiaBqOWx9sskIrickxzGfCwkjuMBiaNLDxNA/0?wx_fmt=png&quot; data-nickname=&quot;å¾—ç‰©æŠ€æœ¯&quot; data-alias=&quot;&quot; data-signature=&quot;æŠ€æœ¯çŸ¥è¯†åˆ†äº«äº¤æµå¹³å°ï¼Œä¸ä½ ä¸€åŒèµ°å‘æŠ€æœ¯çš„äº‘ç«¯ã€‚&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;ä¸ŠæœŸï¼ˆ0422ï¼‰æ´»åŠ¨ä¸­å¥–è€…åå•å…¬ç¤ºï¼š&lt;br/&gt;&lt;/span&gt;&lt;span&gt;å¾—ç‰©æ–‡åŒ–Tæ¤ï¼š.w&lt;br/&gt;éšè¡Œæ¯ï¼šæ ‘*é™&lt;br/&gt;å¾—ç‰©æ¸”å¤«å¸½ï¼šçº³*æ–¯&lt;br/&gt;&lt;/span&gt;&lt;span&gt;ï¼ˆæ³¨æ„ï¼šç”±äºä¸Šæµ·ç›®å‰å¿«é€’ä¸æ”¯æŒå‘è´§ï¼Œé¢„è®¡å‘å‡ºæ—¶é—´ä¸º5æœˆåº•ï¼Œå¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥å¾®ä¿¡å…¬ä¼—å·åå°ç•™è¨€ï¼‰&lt;/span&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>