<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>2638db18b14d1c0f423ceab33671904d</guid>
<title>认识区块链，认知区块链——Web3</title>
<link>https://toutiao.io/k/78f76n5</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;profile_inner&quot;&gt;
                  &lt;strong class=&quot;profile_nickname&quot;&gt;MavenTalk&lt;/strong&gt;
                  &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;/&gt;

                  &lt;p class=&quot;profile_meta&quot;&gt;
                  &lt;label class=&quot;profile_meta_label&quot;&gt;Weixin ID&lt;/label&gt;
                  &lt;span class=&quot;profile_meta_value&quot;&gt;mavenTalk&lt;/span&gt;
                  &lt;/p&gt;

                  &lt;p class=&quot;profile_meta&quot;&gt;
                  &lt;label class=&quot;profile_meta_label&quot;&gt;About Feature&lt;/label&gt;
                  &lt;span class=&quot;profile_meta_value&quot;&gt;创业者，关注人与自然的和谐成长.&lt;/span&gt;
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>e2437de811620049013bfb0665bb6fea</guid>
<title>推荐 4 个开源工具</title>
<link>https://toutiao.io/k/g30nqhu</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;span&gt;Hi，艾瑞巴蒂，晚上好！今天推荐 4 个登上 GitHub 热搜的开源项目，它们分别是：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;1. 炫酷的 UI 工具：glslViewer&lt;/section&gt;&lt;p&gt;2. Textual&lt;/p&gt;&lt;p&gt;3. ToolJet：开源的低代码开发框架&lt;/p&gt;&lt;p&gt;4.  Linux 命令大全搜索工具&lt;/p&gt;&lt;hr/&gt;&lt;section&gt;&lt;span&gt;01&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;炫酷的 UI 工具：glslViewer&lt;/span&gt;&lt;/p&gt;&lt;p&gt;glslViewer 是由 @patriciogonzalezvivo 发布的，无需 UI 就能够显示 2D/3D GLSL 着色器，目前在 Github 上已经获得了 3.6k 的 stars。&lt;/p&gt;&lt;p&gt;可以使用 Python 或者任何可以和 glslViewer back/forth communication 的工具来定制喜欢的 UI。接下来，让我们一起欣赏炫酷画面~~&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.85875&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3IaF1PDquP4c4k3IHpbgEkbN8epYUhSqYTYRLm1bE8yYNnTZckND3ghw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;800&quot;/&gt;&lt;/p&gt;&lt;p&gt;开源地址：https://github.com/patriciogonzalezvivo/glslViewer&lt;/p&gt;&lt;h1&gt;02&lt;/h1&gt;&lt;p&gt;&lt;span&gt;Textual&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Textual 是由 @Textualize 开源基于 Python 框架搭建，可以创建能够在终端运行的交互式应用程序，作者的设计灵感来源于现代的 Web 开发，目前在 Github 上已经获得了 15.2k 的 stars。&lt;/p&gt;&lt;p&gt;Textual  使用 Rich 来渲染富文本，所以 Rich 可以渲染的任何东西都可以在 Textual 中使用。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3IBxx8icd0Sd6UE3ianVRBOhJOFDpttQcXeq2d4TqahHCBJJKhrpSFu9nw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.1879629629629629&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3IsriaxiaEB2CKwYXUIT7t9CyuJc2LC47G94PHl3TwytgONSCwclTpAopQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;开源地址：https://github.com/Textualize/textual&lt;/p&gt;&lt;h1&gt;03&lt;/h1&gt;&lt;p&gt;&lt;span&gt;ToolJet：开源的低代码开发框架&lt;/span&gt;&lt;/p&gt;&lt;p&gt;ToolJet 是一个开源的低代码开发框架，拥有丰富的可视化工具，仅需要几步就可以快速构建和部署企业级工具，目前在 Github 已经获得了 14.5k 的 stars。&lt;/p&gt;&lt;p&gt;ToolJet 支持连接多种数据源，包括数据库、云平台、第三方服务接口等 40 多种数据源。在应用层可以发布到 APP、制作数据面板、表单等。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5488888888888889&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3IOa1Yz6lDZOrLLN9aVeyFicafqqujHmgbdbWmibpviaMzbNG9tQsTwzr8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5731481481481482&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3InibyS8fu4ZmeWVXGsx1cuuNLKYT6x6ez3zV4BjYGZjxk1hwNJGKRa2w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5981481481481481&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3IKib0Exr4PZicK7Osgia1DPxJNWmXB4iaia87xIKJ62IeoMiadAr5PZZdsuZQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5981481481481481&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3I6Ly4xecOPqwDblHKT5yK2R2BichG11hULAcpsVwSuR5pJBYM8cgHMzw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;开源地址：https://github.com/ToolJet/ToolJet&lt;/p&gt;&lt;h1&gt;04&lt;/h1&gt;&lt;p&gt;&lt;span&gt;Linux 命令大全搜索工具&lt;/span&gt;&lt;/p&gt;&lt;p&gt;Linux Command 是 Linux 命令大全搜索工具，该工具当前搜集了 570 多个 Linux 命令，主要内容包含：Linux 基础命令、Linux 学习资源整理，例如社区网站、相关知识、软件工具、开源镜像站点等，目前在 Github 已经获得 20.8k 的 stars。&lt;/p&gt;&lt;p&gt;该工具支持移动端和 Web 搜索，默认从 A-Z 排序，每条命令都会有注释说明，带有语法、参数及命令示例~逛姐觉得非常贴心，墙裂推荐！！！&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.35600425079702447&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruw9icwlLVIghYgr2ia8bZLP3I3QyHhWaJw8WvcBMWfjViaibVJLsUJE2egib8qFfECBzAfovjTupDHU4Hw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;941&quot;/&gt;&lt;/p&gt;&lt;p&gt;开源地址：https://wangchujiang.com/linux-command/&lt;/p&gt;&lt;p&gt;&lt;span&gt;历史盘点&lt;/span&gt;&lt;/p&gt;&lt;section&gt;逛逛 GitHub 每天推荐一个好玩有趣的开源项目。历史推荐的开源项目已经收录到 GitHub 项目，欢迎 Star：&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;https:&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.8091503267973856&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruzicgHPfCeAsrkT2JZwiaOF05zRiaXr2dUukXKGk8CJwfrXALKJ5l0fLpV2abibCYKb7d8B7vNp2u3iccg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1530&quot;/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-paragraph-type=&quot;ignored&quot;&gt;&lt;hr/&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;section&gt;&lt;span&gt;推荐阅读&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;span&gt;1. &lt;/span&gt;&lt;/em&gt;&lt;/span&gt;&lt;span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxNjg4NDEzNA==&amp;amp;mid=2247498662&amp;amp;idx=1&amp;amp;sn=0087c4f3b79ba3420e917e9b42d45eda&amp;amp;chksm=f9a2286fced5a1794eb9a73d0be7c2e16eaceabf3a0420647c40cb4202bd116d9a15dd57c008&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;GitHub 上有什么好玩的项目？&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;span&gt;2.&lt;/span&gt;&lt;/em&gt;&lt;span&gt; &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxNjg4NDEzNA==&amp;amp;mid=2247507541&amp;amp;idx=1&amp;amp;sn=79edebda20ac94221aa641090fc9878e&amp;amp;chksm=f9a20d9cced5848a5ba699a819f52907f537e557c10c7bb24bf87b2e0212feecfb06419b2feb&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;推荐一款高颜值网易云播放器&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot; hasload=&quot;1&quot;&gt;推荐一款高颜值网易云播放器&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;span&gt;3. &lt;/span&gt;&lt;/em&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxNjg4NDEzNA==&amp;amp;mid=2247500031&amp;amp;idx=1&amp;amp;sn=b4349fc85264c255bf9a22e1f25b035a&amp;amp;chksm=f9a21336ced59a20518444a3e2bddb584f6d02266e831546ee5c00935d01d5bd61ed86ab606f&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;基于 Spring Boot 的百度云高仿项目&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;em&gt;&lt;span&gt;4. &lt;/span&gt;&lt;/em&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxNjg4NDEzNA==&amp;amp;mid=2247498464&amp;amp;idx=1&amp;amp;sn=4f85123d6ca67578ca7bad8f7dc71453&amp;amp;chksm=f9a22929ced5a03ffded2c41fd257d3eb96be02195de3ca66a083177bf5f73e2f418728f7f06&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;盘点百度 4 个牛逼哄哄的开源项目&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUxNjg4NDEzNA==&amp;amp;mid=2247498464&amp;amp;idx=1&amp;amp;sn=4f85123d6ca67578ca7bad8f7dc71453&amp;amp;chksm=f9a22929ced5a03ffded2c41fd257d3eb96be02195de3ca66a083177bf5f73e2f418728f7f06&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot; wah-hotarea=&quot;click&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;172&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;172&quot; data-ratio=&quot;1.005449591280654&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ePw3ZeGRruxW7LMX2Iz5DfjRIbFTS7UROhxibBmicicT0HpjIh1yniaJJibSnLFuicMHRx5NEdiaOh2OOACfr6MvR38ibQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;734&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>912e60a13dffef733e08bffd6fa38523</guid>
<title>Flink 反压原理深入浅出及解决思路</title>
<link>https://toutiao.io/k/cnvz5r1</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;1. 前言&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Apache Flink 是一个分布式大数据处理引擎，可对有限数据流和无限数据流进行有状态或无状态的计算，能够部署在各种集群环境，对各种规模大小的数据进行快速计算。既然是对流式数据进行处理，那么就要面临数据在流动计算时，上下游数据通信以及数据处理速度不一致所带来的问题。&lt;br/&gt;本文先从「生产者-消费者模式」的角度介绍了Flink中的数据传输，从而引出了「反压」的概念。接着介绍了Flink在V1.5前「基于TCP的反压机制」以及V1.5后「基于Credit的反压机制」分别如何实现网络流控。最后针对一个反压案例进行分析，介绍了如何进行反压定位和资源调优，并展示了调优结果。&lt;br/&gt;希望在阅读完本文后，读者可以深入理解Flink节点反压的概念以及背后的原理，在遇到反压场景时，能够快速定位瓶颈点，并拥有一套基本的调优思路。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;2. 从Flink数据传输看「反压」&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;2.1 生产者-消费者模式&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Flink作业在运行状态时，数据会在各个TaskManager（TM）之间流动交换，上游TM到下游TM的数据传输，可以简单看作是生产者&amp;amp;消费者模式。&lt;br/&gt;下面将会介绍 Producer 和 Consumer 在吞吐率&lt;strong&gt;不同&lt;/strong&gt;时，导致的普遍性问题。&lt;br/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.759656652360515&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/1skeHK2Gybwtm3boGkxFwnF811Jz3tzophIYg1n06lNfcOYlFiaFugJKkxGxS7jK1QRTdxq0iax9phYIIlLe7G8Q/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;932&quot;/&gt;&lt;br/&gt;假设 Producer的吞吐率为 2 MB/s，Consumer是 1 MB/s ，此时上游产生数据的速度 大于 下游处理数据的速度，且假设两端都存在Buffer，用来暂时存放数据，再假设底层网络传输速度为 2 MB/s。&lt;br/&gt;若Buffer有界，经过5s后，Consumer 端的 Receive Buffer 会被打满，后面新到达的数据就只能被丢弃掉；但在实际场景中，通常生产者在发送数据前会检查 buffer 的可用状态，若 buffer 处于不可用状态，则不会发送新的数据。&lt;br/&gt;面对上述问题，需要有一种动态反馈的机制，根据数据实时传输的情况，动态调整数据的发送速率和接收速率，从而更好的进行网络传输。&lt;br/&gt;动态反馈可以分为以下两种：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;正向反馈：当Producer的发送速率 小于 Consumer的接受速率时，需要通知 Producer可以&lt;strong&gt;提高&lt;/strong&gt;发送速率&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;负向反馈：当Producer的发送速率 大于 Consumer的接受速率时，需要通知 Producer可以&lt;strong&gt;降低&lt;/strong&gt;发送速率&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;2.2 何为「反压」&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过上小节的介绍，我们了解到，当上游生产数据和下游消费数据速率不一致时，会导致一些问题，这时候需要一种「动态反馈」机制，下面引入「反压」的概念&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;「反压」是流式系统中关于数据处理能力的动态反馈机制，并且是从下游到上游的反馈，一般发生在实时数据处理的过程中，上游节点的生产速度大于下游节点的消费速度的情况下。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面将会介绍在Flink中，TaskManager之间如何传输数据，看看 Flink 中数据传输的生产者-消费者模式的具体形式。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;2.3 TaskManager之间的数据传输&lt;/h2&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;下图来源于Apache Flink (http://flink.apache.org) 图中相关概念： ResultPartition（RP） ResultSubPartition（RS） InputChannel（IC） InputGate（IG）&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8101851851851852&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzo2X9JBhLLAwNoxo5K21IibdMIzkZEk709qichxEj7ibYKmKQVeDHqR1Mcg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;figcaption&gt;&lt;span/&gt;&lt;/figcaption&gt;&lt;figcaption&gt;&lt;span&gt;MapDriver 将数据传递给 RecordWriter，之后经由 ChannelSelector 做数据分发，将数据传递到一个或多个 RecordSerializer 做序列化操作，转换为二进制流。ChannelSelector 的分发有两种模式，一种是广播模式，会将数据发送到每个序列化器进行处理，另一种是按某种逻辑进行选择，比如计算数据的hash，然后路由到命中的序列化器。&lt;/span&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * The {&lt;span&gt;@link&lt;/span&gt; ChannelSelector} determines to which logical channels a record should be written to.&lt;br/&gt; *&lt;br/&gt; * &lt;span&gt;@param&lt;/span&gt; &amp;lt;T&amp;gt; the type of record which is sent through the attached output gate&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;interface&lt;/span&gt; &lt;span&gt;ChannelSelector&lt;/span&gt;&amp;lt;&lt;span&gt;T&lt;/span&gt; &lt;span&gt;extends&lt;/span&gt; &lt;span&gt;IOReadableWritable&lt;/span&gt;&amp;gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * Initializes the channel selector with the number of output channels.&lt;br/&gt;     *&lt;br/&gt;     * &lt;span&gt;@param&lt;/span&gt; numberOfChannels the total number of output channels which are attached to respective&lt;br/&gt;     *     output gate.&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;void&lt;/span&gt; &lt;span&gt;setup&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; numberOfChannels)&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * Returns the logical channel index, to which the given record should be written. It is illegal&lt;br/&gt;     * to call this method for broadcast channel selectors and this method can remain not&lt;br/&gt;     * implemented in that case (for example by throwing {&lt;span&gt;@link&lt;/span&gt; UnsupportedOperationException}).&lt;br/&gt;     * &lt;br/&gt;     * 选择模式&lt;br/&gt;     *&lt;br/&gt;     * &lt;span&gt;@param&lt;/span&gt; record the record to determine the output channels for.&lt;br/&gt;     * &lt;span&gt;@return&lt;/span&gt; an integer number which indicates the index of the output channel through which the&lt;br/&gt;     *     record shall be forwarded.&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;int&lt;/span&gt; &lt;span&gt;selectChannel&lt;/span&gt;&lt;span&gt;(T record)&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * Returns whether the channel selector always selects all the output channels.&lt;br/&gt;     * 广播模式&lt;br/&gt;     *&lt;br/&gt;     * &lt;span&gt;@return&lt;/span&gt; true if the selector is for broadcast mode.&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;boolean&lt;/span&gt; &lt;span&gt;isBroadcast&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;序列化输出的二进制流数据会被存放在buffer块中，之后 BufferWriter 会将这些buffer块写入到指定的ResultPartition（RP）中。RP中又包含多个子分区（ResultSubpartitions，如RS1，RS2），每个子分区只会存放特定消费者需要的数据。由图可见，一个 buffer 已经被 BufferWriter 放入了 RS2 中，这时 RS2 这个子分区已经变成了可被消费状态，接下来会通知 JobManager。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;abstract&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;ResultPartition&lt;/span&gt; &lt;span&gt;implements&lt;/span&gt; &lt;span&gt;ResultPartitionWriter&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ResultPartitionID partitionId;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/** 该分区的类型，定义要使用的具体子分区实现 */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ResultPartitionType partitionType;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ResultPartitionManager partitionManager;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/** Subpartition 的个数 */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; numSubpartitions;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;// - Runtime state --------------------------------------------------------&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/** ResultPartition 中的缓冲区 */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; BufferPool bufferPool;&lt;br/&gt;    &lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;3&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;JobManager 会寻找 RS2 的消费者，通知TaskManager2，该数据块可以消费了。接着InputChannel会接收到该消息（图中是 IC1，用于接收上一步中存放到 RS2 中的 buffer，且 InputChannel 和 ResultSubpartition 是1-1对应的，一个 InputChannel 接收一个 ResultSubpartition 的输出），并通知 RS2 初始化网络连接，可以开始传输数据了。然后 RS2 通过 TaskManager1 的网络栈基于 Netty 进行数据传输，该网络连接是在各个TaskManager 之间长期存在的。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * An input channel consumes a single {&lt;span&gt;@link&lt;/span&gt; ResultSubpartitionView}.&lt;br/&gt; *&lt;br/&gt; * &amp;lt;p&amp;gt;For each channel, the consumption life cycle is as follows:&lt;br/&gt; *&lt;br/&gt; * &amp;lt;ol&amp;gt;&lt;br/&gt; *   &amp;lt;li&amp;gt;{&lt;span&gt;@link&lt;/span&gt; #requestSubpartition()}&lt;br/&gt; *   &amp;lt;li&amp;gt;{&lt;span&gt;@link&lt;/span&gt; #getNextBuffer()}&lt;br/&gt; *   &amp;lt;li&amp;gt;{&lt;span&gt;@link&lt;/span&gt; #releaseAllResources()}&lt;br/&gt; * &amp;lt;/ol&amp;gt;&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;abstract&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;InputChannel&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;/** 输入通道的信息，以便在任务中全局识别它. */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; InputChannelInfo channelInfo;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/** 此通道消费接收的RP编号. */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; ResultPartitionID partitionId;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/** 此通道使用的子分区的索引. */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; consumedSubpartitionIndex;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;protected&lt;/span&gt; &lt;span&gt;final&lt;/span&gt; SingleInputGate inputGate;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;4&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;基于 Netty 的网络传输，buffer块被传递到 TaskManager2 网络栈，之后由 ConnectionManager 来控制将 buffer数据传递到指定的 InputChannel 中，并进入InputGate，最终进入反序列化器 （RecordDeserializer）将buffer中的数据还原成制定类型的对象，最后传递给接收数据的task。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其实这是典型的生产者-消费者模式，上游生产数据到 &lt;strong&gt;ResultPartition&lt;/strong&gt;（由&lt;strong&gt;ResultSubpartition&lt;/strong&gt;构成） 中，下游通过 &lt;strong&gt;InputGate&lt;/strong&gt; （由&lt;strong&gt;InputChannel&lt;/strong&gt;构成）消费数据。不同的 task 可能在同一个 TaskManager 中运行，此时这些task可以看做是同一个 TaskManager进程中的不同线程，可以在本地进行数据交换；不同的 task 也可能在不同的 TaskManger 中运行，此时就要通过TaskManager 间的网络通信进行数据交换。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;3. Flink网络流控&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前面介绍了 Flink 基于生产者-消费者模式的数据传输方式，且我们了解到，流式系统在处理数据时，如果上下游处理速度不一致，会出现数据堵塞等问题。这时候需要一种动态反馈的机制，根据数据实时传输的情况，动态调整数据的发送速率和接受速率，从而更好的进行网络传输，即「网络流控」。&lt;br/&gt;本章将会介绍 Flink 在V1.5前后进行网络流控的两种方式：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;基于 TCP 的反压机制&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;基于 Credit 的反压机制&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;3.1 基于TCP的反压机制&lt;/h2&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;我们先来看看Flink在V1.5前是如何做动态反馈，进而实现网络流控的。 基于TCP的反压机制底层依赖于「&lt;strong&gt;TCP的滑动窗口算法&lt;/strong&gt;」，本章不会赘述，而会重点描述反压现象的传递过程。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.5675487465181058&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzoZVcXz9n4ribelbIS5wMVQJgDs6fLdJMmfQ6PnnFGO6htRDfGkaTY7mw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2872&quot;/&gt;&lt;br/&gt;由上图可见，每个TaskManager中都会有个被内部所有task共享的 Network Buffer Pool，它从堆外内存申请内存资源，之后可以为每个 ResultSubpartition 创建 Local Buffer Pool。&lt;br/&gt;假设生产者的速率是 2 MB/S，消费者的速率是 1 MB/S。下面会描述，由于速度不匹配，各层buffer被打满，从而引起反压的过程。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.1 InputChannel Buffer 打满&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一段时间后，会达到下图的状态，此时 InputChannel 暂时被打满，需要向 Local Buffer Pool 申请新的 buffer，此时 Local Buffer Pool 里的一个 buffer 被标记为 Used。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5657407407407408&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzoZNxk2NTfpPAb0xvk5waLUuyDHMS0wPEOxwNuGdgbiagkkRA6aNx2qcA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.2 Consumer Local Buffer Pool 打满&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由上下游处理速率不一致，一段时间过后，InputChannel 将 Local Buffer Pool 的内存申请完了，此时 Local Buffer Pool 的所有 buffer 都被标记为 Used，但还可以向 Network Buffer Pool 继续申请 buffer。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5648148148148148&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzorQHpEQY8elAH6iaI8EFxv3zrFbZgHftiaQkfxOEnzCnQLajXn0VNZdNA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;figcaption/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.3 Consumer Network Buffer Pool 打满&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;渐渐 Network Buffer Pool 也没有可用 buffer 了，全都变成了 Used，此时消费者无法再读取数据了，Netty也不会接收Socket的数据了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5638002773925104&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzojwfU3NoaqdZS74b8PHg6VAOYNm2cB817iaFPAkkLcanocdNtZVuAqoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2884&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.4 socket停止数据传输&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当消费者的 socket 被用尽，此时会将 windows=0 发送给生产者的发送端（TCP滑动窗口），此时socket会停止发送数据。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5615120274914089&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzoTqIl1xcGl3u5Wsva2j325fMnoahkgDaXr51MIBIyURPL7Cdbb8SAVg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2910&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.5 Netty不可写&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不久socket buffer用尽，Netty检测到后会停止向socket发送数据，之后由于 RecordWriter 还在发送数据，这些数据会堆积在Netty Buffer中，到一定程度后，Netty会变为不可写状态，ResultSubpartition 发送数据前都会检测 Netty是否可写，此时 ResultSubpartition 会停止向 Netty 中写数据。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5648148148148148&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzomVvyrm8NmAHPhia3k22ylb3pT6ib6fuS0iaqLsniaEpAg3siaicYgkNDswJQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.5 RecordWriter 停止写数据&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;ResultSubpartition 的空间很快被用尽，直到 Local Buffer Pool 和 Network Buffer Pool 的 buffer都被打满后，RecordWriter 就会停止写数据，至此，完成了跨TaskManager的反压。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5775862068965517&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzoORyE3LJliavljibAhXU1FYYv29a8jicjnXPc3jXwB0ic19fAEibCkUWaEaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2784&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1.6 TCP反压机制的问题&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当一个 Task 的缓冲池用尽之后，网络连接就处于阻塞状态，上游 Task 无法产出数据，下游 Task 无法接收数据，也就是我们所说的「反压」状态。&lt;br/&gt;但是基于TCP的反压机制有以下问题：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;一个 TaskManager 内通常会有多个Task，它们底层会复用同一个Socket，一旦某个Task反压导致Socket阻塞不可用，即便其它 Task 关联的缓冲池仍然存在空余，但也都无法向 TCP 连接中写入数据或者从中读取数据。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;基于底层TCP流控的反压机制，从 ResultPartition 到 Netty 到 Socket整条链路较长，会导致反压行为不够灵敏，动态反馈过程比较迟钝。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;3.2 基于Credit的反压机制&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.2.1 算法介绍&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了解决上述问题，Flink 1.5 重构了网络栈，引入了“基于信用值的流量控制算法”（Credit-based Flow Control），即在Flink层实现网络流控，缩短反压链路，且确保 TaskManager 之间的网络连接始终不会处于阻塞状态。&lt;br/&gt;Credit-based Flow Control 的思路其实很简单，它在接收端和发送端之间建立一种类似“信用评级”的机制，发送端向接收端发送的数据永远不会超过接收端的信用值的大小。对于 Flink来说，信用值就是接收端TaskManager 可用的 Buffer 的数量，这样就可以保证发送端 TaskManager 不会向 TCP 连接中发送超出接收端缓冲区可用容量的数据。&lt;br/&gt;基于Credit 实现流量控制 的具体机制为：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;当发送端发送 buffer 的时候，它把当前堆积数据的 buffer 数量（backlog size）告知接收端；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;接收端将根据发送端堆积的数量来申请 buffer；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;接收端向发送端声明可用的 Credit（一个可用的 buffer 对应一个 credit）；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;当接收端分配了 N 点 Credit 给发送端，表明它有 N 个空闲的 buffer 可以接收数据；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;当发送端获得了 N 点 Credit，表明它可以向网络中发送 N 个 buffer；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;只有在 Credit &amp;gt; 0 的情况下发送端才发送 buffer；发送端每发送一个 buffer，Credit 也相应地减少；&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.2.2 反压过程&lt;/h3&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;如图所示，当前 ResultPartition 已经堆积了两个 Buffer 的数据，所以在底层网络传输会将 要传输的数据以及backlog size = 2 发送至接收端；下游收到了之后，会计算获得credit信用值，此时接收端共剩下 6 个buffer， 接收速率是 1 个buffer，backlog size 为2个buffer， credit 为 3 个buffer（6-1-2 = 3）。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.55&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzozXDYvIgXxiaVP60TgL4299NSj81vJJcUxsjdAZsCQ4uS6Hmtiauwt7ibw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;下图中，发送端发送的 backlog size = 2，但接收端的各级Buffer已经打满，所以下游向上游返回的 credit 为0，说明由于上下游处理速率不一致，导致了下游暂时无法处理数据；此时 ResultPartition 就不会向 Netty 传输数据，数据很快就会积压打满，从而达到反压的效果；&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5556309362279511&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1skeHK2Gybwtm3boGkxFwnF811Jz3tzo7qaODsoAg3gfBhVCa5Tm2Q54CgvZpHoDAbBQ7dgDQJF9BZ1DGPNS7g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2948&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.2.3 优化点&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;基于Credit算法的反压机制，解决了两个问题：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;可以直接在 ResultPartition 层实现反压，而不用将压力流经过多层传递，层层反馈。提高了反压效率，降低了延迟；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;不会把底层socket打满，从而阻碍网络数据传输，不会让单个 Task 的瓶颈成为整个TaskManager 的瓶颈；&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;4. 小结&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文首先介绍了Flink中跨TaskManager的数据传输，引出了「生产者-消费者模式」在吞吐率&lt;strong&gt;不同&lt;/strong&gt;时，导致的普遍性问题，以及「&lt;strong&gt;动态反馈&lt;/strong&gt;」机制的必要性，并明确了「&lt;strong&gt;反压&lt;/strong&gt;」的概念，「&lt;strong&gt;反压&lt;/strong&gt;」是流式系统中关于处理能力的动态反馈机制，并且是从下游到上游的反馈。&lt;br/&gt;接着介绍了Flink的网络流控机制，Flink在V1.5前，「&lt;strong&gt;基于TCP的滑动窗口机制&lt;/strong&gt;」实现反压，但是存在单个Task反压会导致整个TaskManager共享的Socket不可用，而且反压链路较长，动态反馈机制较为迟钝等缺点。Flink在V1.5后，采用「&lt;strong&gt;基于Credit算法的反压机制&lt;/strong&gt;」，在ResultPartition层实现反压，提高了反压效率。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;5. 参考资料&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;https://cwiki.apache.org/confluence/display/FLINK/Data+exchange+between+tasks&lt;br/&gt;https://www.ververica.com/blog/how-flink-handles-backpressure&lt;br/&gt;https://docs.google.com/document/d/1chTOuOqe0sBsjldA_r-wXYeSIhU2zRGpUaTaik7QZ84/edit#heading=h.pjh6mv7m2hjn&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>fb2d64c3ce4446871d55da7ab3e44904</guid>
<title>一文读懂遗传算法工作原理（附 Python 实现）</title>
<link>https://toutiao.io/k/3rz8ru3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;103122&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-id=&quot;85660&quot; data-custom=&quot;rgb(117, 117, 118)&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-id=&quot;85660&quot; data-custom=&quot;rgb(117, 117, 118)&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;转自：机器之心&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;近日，Analyticsvidhya 上发表了一篇题为《Introduction to Genetic Algorithm &amp;amp; their application in data science》的文章，作者 Shubham Jain 现身说法，用通俗易懂的语言对遗传算法作了一个全面而扼要的概述，并列举了其在多个领域的实际应用，其中重点介绍了遗传算法的数据科学应用。机器之心对该文进行了编译。&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;简介&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;几天前，我着手解决一个实际问题——大型超市销售问题。在使用了几个简单模型做了一些特征工程之后，我在排行榜上名列第 219 名。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5622254758418741&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHLH0YoKPSFJCnY7lfSSURcXZeEZ0n7gTD0gm28xVfl1gQ1v3hRMqw9w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1366&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;虽然结果不错，但是我还是想做得更好。于是，我开始研究可以提高分数的优化方法。结果我果然找到了一个，它叫遗传算法。在把它应用到超市销售问题之后，最终我的分数在排行榜上一下跃居前列。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5622254758418741&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHY2Bicvlib53rYVFx5ibibRyGc9fKHwOnncbex5SANereKTq7gsmicqF08tA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1366&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;没错，仅靠遗传算法我就从 219 名直接跳到 15 名，厉害吧！相信阅读完本篇文章后，你也可以很自如地应用遗传算法，而且会发现，当把它用到你自己正在处理的问题时，效果也会有很大提升。&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;目录&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;1、遗传算法理论的由来&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2、生物学的启发&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3、遗传算法定义&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;4、遗传算法具体步骤&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;5、遗传算法的应用&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;6、实际应用&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;7、结语&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;1、遗传算法理论的由来&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们先从查尔斯·达尔文的一句名言开始：&lt;/span&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;能够生存下来的往往不是最强大的物种，也不是最聪明的物种，而是最能适应环境的物种。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;你也许在想：这句话和遗传算法有什么关系？其实遗传算法的整个概念就基于这句话。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;让我们用一个基本例子来解释 ：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们先假设一个情景，现在你是一国之王，为了让你的国家免于灾祸，你实施了一套法案：&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;你选出所有的好人，要求其通过生育来扩大国民数量。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;这个过程持续进行了几代。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;你将发现，你已经有了一整群的好人。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这个例子虽然不太可能，但是我用它是想帮助你理解概念。也就是说，我们改变了输入值（比如：人口），就可以获得更好的输出值（比如：更好的国家）。现在，我假定你已经对这个概念有了大致理解，认为遗传算法的含义应该和生物学有关系。那么我们就快速地看一些小概念，这样便可以将其联系起来理解。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;2、生物学的启发&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;相信你还记得这句话：「细胞是所有生物的基石。」由此可知，在一个生物的任何一个细胞中，都有着相同的一套染色体。所谓染色体，就是指由 DNA 组成的聚合体。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.646551724137931&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHG7iaWib1CDoecNBWmJp6ck0oI0d4lv2pJlrW8drrJFKcLeuII7pAGqyg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;348&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;传统上看，这些染色体可以被由数字 0 和 1 组成的字符串表达出来。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9513888888888888&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHajX8ovKGxpMn513mkb09RvSMC5icxVHGWfG2x2l8CxW8scdIDT3qeCQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;288&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;一条染色体由基因组成，这些基因其实就是组成 DNA 的基本结构，DNA 上的每个基因都编码了一个独特的性状，比如，头发或者眼睛的颜色。希望你在继续阅读之前先回忆一下这里提到的生物学概念。结束了这部分，现在我们来看看所谓遗传算法实际上指的是什么？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;3、遗传算法定义&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;首先我们回到前面讨论的那个例子，并总结一下我们做过的事情。&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;首先，我们设定好了国民的初始人群大小。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;然后，我们定义了一个函数，用它来区分好人和坏人。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;再次，我们选择出好人，并让他们繁殖自己的后代。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;最后，这些后代们从原来的国民中替代了部分坏人，并不断重复这一过程。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;遗传算法实际上就是这样工作的，也就是说，它基本上尽力地在某种程度上模拟进化的过程。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;因此，为了形式化定义一个遗传算法，我们可以将它看作一个优化方法，它可以尝试找出某些输入，凭借这些输入我们便可以得到最佳的输出值或者是结果。&lt;/span&gt;&lt;span&gt;遗传算法的工作方式也源自于生物学，具体流程见下图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.4285714285714286&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHutFzSgRkgWyonGs1xxbHPqGiaKOqM7thLbawRYYnIp8OcwqnmII5CkA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;343&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;那么现在我们来逐步理解一下整个流程。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;4、遗传算法具体步骤&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;为了让讲解更为简便，我们先来理解一下著名的组合优化问题「背包问题」。如果你还不太懂，这里有一个我的解释版本。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;比如，你准备要去野游 1 个月，但是你只能背一个限重 30 公斤的背包。现在你有不同的必需物品，它们每一个都有自己的「生存点数」（具体在下表中已给出）。因此，你的目标是在有限的背包重量下，最大化你的「生存点数」。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3292867981790592&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBH4leq6TE8EPwkaIDiaJTFKjTcibibbSNoOH6IWGn9LkswNlK3aKbjKSpUw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;659&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;4.1 初始化&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这里我们用遗传算法来解决这个背包问题。第一步是定义我们的总体。总体中包含了个体，每个个体都有一套自己的染色体。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们知道，染色体可表达为二进制数串，在这个问题中，1 代表接下来位置的基因存在，0 意味着丢失。&lt;/span&gt;&lt;span&gt;（译者注：&lt;/span&gt;&lt;span&gt;作者这里借用染色体、基因来解决前面的背包问题，所以特定位置上的基因代表了上方背包问题表格中的物品，比如第一个位置上是 Sleeping Bag，那么此时反映在染色体的『基因』位置就是该染色体的第一个『基因』。&lt;/span&gt;&lt;span&gt;）&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6212389380530974&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHQIMhPGWMg1tSGAFbJhlapRX6ezqDwE5JnCo1DPU7rTfDIX9Wopg7IQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;565&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;现在，我们将图中的 4 条染色体看作我们的总体初始值。&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;4.2 适应度函数&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;接下来，让我们来计算一下前两条染色体的适应度分数。对于 A1 染色体 [100110] 而言，有：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.24605678233438485&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHcmc28iclsu512VHWhmv3dKlJasYMxzM4VAAk3NTAiaLcuynHUtMRaAqQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;634&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;类似地，对于 A2 染色体 [001110] 来说，有：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.24726134585289514&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHzvrSfpnlJVib2rb6XHTvCR0z6ibhoJCmYgNvMVRmFiapMrxQbn1g1Kzww/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;639&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;对于这个问题，我们认为，当染色体包含更多生存分数时，也就意味着它的适应性更强。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;因此，由图可知，染色体 1 适应性强于染色体 2。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;4.3 选择&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;现在，我们可以开始从总体中选择适合的染色体，来让它们互相『交配』，产生自己的下一代了。这个是进行选择操作的大致想法，但是这样将会导致染色体在几代之后相互差异减小，失去了多样性。因此，我们一般会进行「轮盘赌选择法」（Roulette Wheel Selection method）。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6266666666666667&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBH0eqgCp3trAYNZnnp3Iiad1dC8Y35r4vpiarJqKLjm6UibskTwLIJAy8vg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;300&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;想象有一个轮盘，现在我们将它分割成 m 个部分，这里的 m 代表我们总体中染色体的个数。每条染色体在轮盘上占有的区域面积将根据适应度分数成比例表达出来。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2406832298136646&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBH6fN7MSzSx5WSfUWeQicEJ4XyREJaF7ojcInDoc0xlrnV0KN7uJQlobw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;644&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;基于上图中的值，我们建立如下「轮盘」。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6808510638297872&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHQm3N5ibYicWBTcqTofAEQOPKKBcdhkG47kK1ABc2ZawZOotttSM8SMrA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;564&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;现在，这个轮盘开始旋转，我们将被图中固定的指针（fixed point）指到的那片区域选为第一个亲本。然后，对于第二个亲本，我们进行同样的操作。有时候我们也会在途中标注两个固定指针，如下图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6459854014598541&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHAjGWy9DFINWLuHX9JicHqwj81hvXMtzMkAbu4rnzbxjcibobluiaGK46g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;548&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;通过这种方法，我们可以在一轮中就获得两个亲本。我们将这种方法成为「随机普遍选择法」（Stochastic Universal Selection method）。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;4.4 交叉&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;在上一个步骤中，我们已经选择出了可以产生后代的亲本染色体。&lt;/span&gt;&lt;span&gt;那么用生物学的话说，所谓「交叉」，其实就是指的繁殖。&lt;/span&gt;&lt;span&gt;现在我们来对染色体 1 和 4（在上一个步骤中选出来的）进行「交叉」，见下图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3089983022071307&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBH0v7C6ic9J1vhNEfCMDfiagLOtzAv1oQ8ToKfoLt0Jo5ptmibUYpGCBpcg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;589&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这是交叉最基本的形式，我们称其为「单点交叉」。这里我们随机选择一个交叉点，然后，将交叉点前后的染色体部分进行染色体间的交叉对调，于是就产生了新的后代。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你设置两个交叉点，那么这种方法被成为「多点交叉」，见下图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3373913043478261&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHdqffObMKQPNuxBldqCK76GeSRu8Qb2zUNRuyeS3tJmLibXrl8EELY8g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;575&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.5 变异&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如&lt;/span&gt;&lt;span&gt;果现在我们从生物学的角度来看这个问题，那么请问：&lt;/span&gt;&lt;span&gt;由上述过程产生的后代是否有和其父母一样的性状呢？&lt;/span&gt;&lt;span&gt;答案是否。&lt;/span&gt;&lt;span&gt;在后代的生长过程中，它们体内的基因会发生一些变化，使得它们与父母不同。&lt;/span&gt;&lt;span&gt;这个过程我们称为「变异」，它可以被定义为染色体上发生的随机变化，正是因为变异，种群中才会存在多样性。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;下图为变异的一个简单示例：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.18538324420677363&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHDIm24dBUtuhnqJ5w1d9qLh1ccsT1O18YqNxuRqicYVorAassubwuU9w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;561&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;变异完成之后，我们就得到了新为个体，进化也就完成了，整个过程如下图：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6549707602339181&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBH33j7Xgp6ZvoVENCic66kdcMiaKsvwIXvMtxaXA2yk8Jexp7d7cljrPRg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;513&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在进行完一轮「遗传变异」之后，我们用适应度函数对这些新的后代进行验证，如果函数判定它们适应度足够，那么就会用它们从总体中替代掉那些适应度不够的染色体。这里有个问题，我们最终应该以什么标准来判断后代达到了最佳适应度水平呢？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;一般来说，有如下几个终止条件：&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;在进行 X 次迭代之后，总体没有什么太大改变。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;我们事先为算法定义好了进化的次数。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;当我们的适应度函数已经达到了预先定义的值。&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;好了，现在我假设你已基本理解了遗传算法的要领，那么现在让我们用它在数据科学的场景中应用一番。&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;5、遗传算法的应用&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;5.1 特征选取&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;试想一下每当你参加一个数据科学比赛，你会用什么方法来挑选那些对你目标变量的预测来说很重要的特征呢？你经常会对模型中特征的重要性进行一番判断，然后手动设定一个阈值，选择出其重要性高于这个阈值的特征。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;那么，有没有什么方法可以更好地处理这个问题呢？其实处理特征选取任务最先进的算法之一就是遗传算法。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们前面处理背包问题的方法可以完全应用到这里。现在，我们还是先从建立「染色体」总体开始，这里的染色体依旧是二进制数串，「1」表示模型包含了该特征，「0 表示模型排除了该特征」。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;不过，有一个不同之处，即我们的适应度函数需要改变一下。这里的适应度函数应该是这次比赛的的精度的标准。也就是说，如果染色体的预测值越精准，那么就可以说它的适应度更高。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;现在我假设你已经对这个方法有点一概念了。下面我不会马上讲解这个问题的解决过程，而是让我们先来用 TPOT 库去实现它。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;5.2 用 TPOT 库来实现&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这个部分相信是你在一开始读本文时心里最终想实现的那个目标。即：实现。那么首先我们来快速浏览一下 TPOT 库（Tree-based Pipeline Optimisation Technique，树形传递优化技术），该库基于 scikit-learn 库建立。下图为一个基本的传递结构。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5243243243243243&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHL8JsH1wntNfeMlguGeGCibYia5OJZGuCfw5jCDwiaT7Evtv2nDrLRhDFA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;925&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图中的灰色区域用 TPOT 库实现了自动处理。实现该部分的自动处理需要用到遗传算法。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们这里不深入讲解，而是直接应用它。为了能够使用 TPOT 库，你需要先安装一些 TPOT 建立于其上的 python 库。下面我们快速安装它们：&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code codemark=&quot;1&quot;&gt;&lt;span&gt;# installing DEAP, update_checker and tqdm &lt;br/&gt;&lt;br/&gt;&lt;/span&gt;pip install deap update_checker tqdm&lt;br/&gt;&lt;span&gt;# installling TPOT &lt;br/&gt;&lt;/span&gt;pip install tpot&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;这里，我用了 Big Mart Sales（数据集地址：https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/）数据集，为实现做准备，我们先快速下载训练和测试文件，以下是 python 代码：&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code codemark=&quot;1&quot;&gt;&lt;span&gt;# import basic libraries&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;import&lt;/span&gt; numpy &lt;span&gt;as&lt;/span&gt; np &lt;br/&gt;&lt;span&gt;import&lt;/span&gt; pandas &lt;span&gt;as&lt;/span&gt; pd &lt;br/&gt;&lt;span&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span&gt;as&lt;/span&gt; plt &lt;br/&gt;%matplotlib inline &lt;br/&gt;&lt;span&gt;from&lt;/span&gt; sklearn &lt;span&gt;import&lt;/span&gt; preprocessing &lt;br/&gt;&lt;span&gt;from&lt;/span&gt; sklearn.metrics &lt;span&gt;import&lt;/span&gt; mean_squared_error &lt;br/&gt;&lt;span&gt;## preprocessing &lt;br/&gt;&lt;/span&gt;&lt;span&gt;### mean imputations &lt;br/&gt;&lt;br/&gt;&lt;/span&gt;train[&lt;span&gt;&#x27;Item_Weight&#x27;&lt;/span&gt;].fillna((train[&lt;span&gt;&#x27;Item_Weight&#x27;&lt;/span&gt;].mean()), inplace=&lt;span&gt;True&lt;/span&gt;)&lt;br/&gt;test[&lt;span&gt;&#x27;Item_Weight&#x27;&lt;/span&gt;].fillna((test[&lt;span&gt;&#x27;Item_Weight&#x27;&lt;/span&gt;].mean()), inplace=&lt;span&gt;True&lt;/span&gt;) &lt;br/&gt;&lt;span&gt;### reducing fat content to only two categories &lt;br/&gt;&lt;br/&gt;&lt;/span&gt;train[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;] = train[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;].replace([&lt;span&gt;&#x27;low fat&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;LF&#x27;&lt;/span&gt;], [&lt;span&gt;&#x27;Low Fat&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Low Fat&#x27;&lt;/span&gt;]) &lt;br/&gt;train[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;] = train[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;].replace([&lt;span&gt;&#x27;reg&#x27;&lt;/span&gt;], [&lt;span&gt;&#x27;Regular&#x27;&lt;/span&gt;]) &lt;br/&gt;test[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;] = test[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;].replace([&lt;span&gt;&#x27;low fat&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;LF&#x27;&lt;/span&gt;], [&lt;span&gt;&#x27;Low Fat&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Low Fat&#x27;&lt;/span&gt;]) &lt;br/&gt;test[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;] = test[&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;].replace([&lt;span&gt;&#x27;reg&#x27;&lt;/span&gt;], [&lt;span&gt;&#x27;Regular&#x27;&lt;/span&gt;]) &lt;br/&gt;train[&lt;span&gt;&#x27;Outlet_Establishment_Year&#x27;&lt;/span&gt;] = &lt;span&gt;2013&lt;/span&gt; - train[&lt;span&gt;&#x27;Outlet_Establishment_Year&#x27;&lt;/span&gt;] &lt;br/&gt;test[&lt;span&gt;&#x27;Outlet_Establishment_Year&#x27;&lt;/span&gt;] = &lt;span&gt;2013&lt;/span&gt; - test[&lt;span&gt;&#x27;Outlet_Establishment_Year&#x27;&lt;/span&gt;] &lt;br/&gt;&lt;br/&gt;train[&lt;span&gt;&#x27;Outlet_Size&#x27;&lt;/span&gt;].fillna(&lt;span&gt;&#x27;Small&#x27;&lt;/span&gt;,inplace=&lt;span&gt;True&lt;/span&gt;)&lt;br/&gt;test[&lt;span&gt;&#x27;Outlet_Size&#x27;&lt;/span&gt;].fillna(&lt;span&gt;&#x27;Small&#x27;&lt;/span&gt;,inplace=&lt;span&gt;True&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;train[&lt;span&gt;&#x27;Item_Visibility&#x27;&lt;/span&gt;] = np.sqrt(train[&lt;span&gt;&#x27;Item_Visibility&#x27;&lt;/span&gt;])&lt;br/&gt;test[&lt;span&gt;&#x27;Item_Visibility&#x27;&lt;/span&gt;] = np.sqrt(test[&lt;span&gt;&#x27;Item_Visibility&#x27;&lt;/span&gt;])&lt;br/&gt;&lt;br/&gt;col = [&lt;span&gt;&#x27;Outlet_Size&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Outlet_Location_Type&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Outlet_Type&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Fat_Content&#x27;&lt;/span&gt;]&lt;br/&gt;test[&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;] = &lt;span&gt;0&lt;/span&gt;combi = train.append(test)&lt;span&gt;for&lt;/span&gt; i &lt;span&gt;in&lt;/span&gt; col:&lt;br/&gt; combi[i] = number.fit_transform(combi[i].astype(&lt;span&gt;&#x27;str&#x27;&lt;/span&gt;))&lt;br/&gt; combi[i] = combi[i].astype(&lt;span&gt;&#x27;object&#x27;&lt;/span&gt;)&lt;br/&gt;train = combi[:train.shape[&lt;span&gt;0&lt;/span&gt;]]&lt;br/&gt;test = combi[train.shape[&lt;span&gt;0&lt;/span&gt;]:]&lt;br/&gt;test.drop(&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;,axis=&lt;span&gt;1&lt;/span&gt;,inplace=&lt;span&gt;True&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;## removing id variables &lt;br/&gt;&lt;br/&gt;&lt;/span&gt;tpot_train = train.drop([&lt;span&gt;&#x27;Outlet_Identifier&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Type&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Identifier&#x27;&lt;/span&gt;],axis=&lt;span&gt;1&lt;/span&gt;)&lt;br/&gt;tpot_test = test.drop([&lt;span&gt;&#x27;Outlet_Identifier&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Type&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Identifier&#x27;&lt;/span&gt;],axis=&lt;span&gt;1&lt;/span&gt;)&lt;br/&gt;target = tpot_train[&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;]&lt;br/&gt;tpot_train.drop(&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;,axis=&lt;span&gt;1&lt;/span&gt;,inplace=&lt;span&gt;True&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;# finally building model using tpot library&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;span&gt;from&lt;/span&gt; tpot &lt;span&gt;import&lt;/span&gt; TPOTRegressor&lt;br/&gt;X_train, X_test, y_train, y_test = train_test_split(tpot_train, target,&lt;br/&gt; train_size=&lt;span&gt;0.75&lt;/span&gt;, test_size=&lt;span&gt;0.25&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;tpot = TPOTRegressor(generations=&lt;span&gt;5&lt;/span&gt;, population_size=&lt;span&gt;50&lt;/span&gt;, verbosity=&lt;span&gt;2&lt;/span&gt;)&lt;br/&gt;tpot.fit(X_train, y_train)&lt;br/&gt;print(tpot.score(X_test, y_test))&lt;br/&gt;tpot.export(&lt;span&gt;&#x27;tpot_boston_pipeline.py&#x27;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.46806569343065696&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHfW4ngVXhg7jmaHM8dHJLfwGl4JzYf382Y1dD0LmPEruEXc9pkq0GQQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1096&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;一旦这些代码运行完成，tpot_exported_pipeline.py 里就将会放入用于路径优化的 python 代码。我们可以发现，ExtraTreeRegressor 可以最好地解决这个问题。&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code codemark=&quot;1&quot;&gt;&lt;span&gt;## predicting using tpot optimised pipeline&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;tpot_pred = tpot.predict(tpot_test)&lt;br/&gt;sub1 = pd.DataFrame(data=tpot_pred)&lt;br/&gt;&lt;span&gt;#sub1.index = np.arange(0, len(test)+1)&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;sub1 = sub1.rename(columns = {&lt;span&gt;&#x27;0&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;})&lt;br/&gt;sub1[&lt;span&gt;&#x27;Item_Identifier&#x27;&lt;/span&gt;] = test[&lt;span&gt;&#x27;Item_Identifier&#x27;&lt;/span&gt;]&lt;br/&gt;sub1[&lt;span&gt;&#x27;Outlet_Identifier&#x27;&lt;/span&gt;] = test[&lt;span&gt;&#x27;Outlet_Identifier&#x27;&lt;/span&gt;]&lt;br/&gt;sub1.columns = [&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Identifier&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Outlet_Identifier&#x27;&lt;/span&gt;]&lt;br/&gt;sub1 = sub1[[&lt;span&gt;&#x27;Item_Identifier&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Outlet_Identifier&#x27;&lt;/span&gt;,&lt;span&gt;&#x27;Item_Outlet_Sales&#x27;&lt;/span&gt;]]&lt;br/&gt;sub1.to_csv(&lt;span&gt;&#x27;tpot.csv&#x27;&lt;/span&gt;,index=&lt;span&gt;False&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你提交了这个 csv，那么你会发现我一开始保证的那些还没有完全实现。那是不是我在骗你们呢？当然不是。实际上，TPOT 库有一个简单的规则。如果你不运行 TPOT 太久，那么它就不会为你的问题找出最可能传递方式。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;所以，你得增加进化的代数，拿杯咖啡出去走一遭，其它的交给 TPOT 就行。此外，你也可以用这个库来处理分类问题。进一步内容可以参考这个文档：http://rhiever.github.io/tpot/。除了比赛，在生活中我们也有很多应用场景可以用到遗传算法。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;6、 实际应用&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;遗传算法在真实世界中有很多应用。这里我列了部分有趣的场景，但是由于篇幅限制，我不会逐一详细介绍。&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;6.1 工程设计&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;工程设计非常依赖计算机建模以及模拟，这样才能让设计周期过程即快又经济。遗传算法在这里可以进行优化并给出一个很好的结果。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;相关资源：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;6.2 交通与船运路线（Travelling Salesman Problem，巡回售货员问题）&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;这是一个非常著名的问题，它已被很多贸易公司用来让运输更省时、经济。解决这个问题也要用到遗传算法。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6237006237006237&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHv6FHClEovkFsV9RHV6QQbLz3iaJ8iccYprM9PViceAv4qb8rAqcPZ9fIQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;962&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6242171189979123&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhicNo19DhbmjLzzbmsqicbuBHxiaepMZIdicSqh4ah8JeHakL13pdpfGoZVmfZ933GAwCDjkfcCc1ju9Q/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;958&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;6.3 机器人&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;遗传算法在机器人领域中的应用非常广泛。实际上，目前人们正在用遗传算法来创造可以像人类一样行动的自主学习机器人，其执行的任务可以是做饭、洗衣服等等。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;相关资源：&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;&lt;strong&gt;7、结语&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;希望通过本文介绍，你现在已经对遗传算法有了足够的理解，而且也会用 TPOT 库来实现它了。但是如果你不亲身实践，本文的知识也是非常有限的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;所以，请各位读者朋友一定要在无论是数据科学比赛或是生活中尝试自己去实现它。 &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;原文链接：https://www.analyticsvidhya.com/blog/2017/07/introduction-to-genetic-algorithm/&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/hN1l83J6PhibzTThwgCJCtA4NOgYX7VmE5iammZsZmxuEWDgxG0dxkGIUbMzjI3Y1Wj1biaRKw1EWkUhiaRhyjkdag/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;430&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>664b51d71327466496c01e281bc0b80e</guid>
<title>Python 3.11 新加入的和类型系统相关的新特性</title>
<link>https://toutiao.io/k/7oqpyy2</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;post-content&quot;&gt;
      &lt;h3 id=&quot;PEP646â€“VariadicGenerics&quot;&gt;PEP 646 â€“ Variadic Generics&lt;/h3&gt;
&lt;p&gt;ä»‹ç»�è¿™ä¸ª PEP ä¹‹å‰�éœ€è¦�è¡¥ä¸€äº›çŸ¥è¯†ï¼Œæˆ‘ä»¬é€�æ­¥æ·±å…¥å…ˆäº†è§£ä¸€ä¸‹æ³›å�‹ (Generics)ã€‚&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt; æ³›å�‹æ˜¯æŒ‡åœ¨å®šä¹‰å‡½æ•°æˆ–ç±»çš„æ—¶å€™ï¼Œä¸�é¢„å…ˆæŒ‡å®šå…·ä½“çš„ç±»å�‹ï¼Œè€Œåœ¨ä½¿ç”¨çš„æ—¶å€™å†�æŒ‡å®šç±»å�‹çš„ä¸€ç§�ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹äº� Python è¿™ç§�åŠ¨æ€�è¯­è¨€ï¼Œå› ä¸ºä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡å¼•ç”¨ï¼Œå�¯ä»¥åœ¨ä½¿ç”¨æ—¶ç›´æ�¥åˆ¤æ–­ç±»å�‹:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;In&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;say_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;     &lt;span class=&quot;n&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;             &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;int&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;             &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;str&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;             &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;float&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;         &lt;span class=&quot;n&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;             &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;other type&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;In&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;say_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;In&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;say_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;ss&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;In&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;say_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;float&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;In&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;say_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;other&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½†æ˜¯åœ¨ç±»å�‹æ£€æŸ¥æ—¶ï¼Œå°±ä¼šæ¶‰å�Šåˆ°æ³›å�‹é—®é¢˜ï¼Œå�¯ä»¥åœ¨è¿�è¡Œå‰�å°±å�‘ç�°é—®é¢˜ã€‚ä¸¾ä¸ªä¾‹å­�:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;U&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;U&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;max_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bar&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­�ä¸­ï¼Œå�‚æ•°å�¯ä»¥æ˜¯æ•°å­—æˆ–è€…å­—ç¬¦ä¸²ã€‚ä½†æ˜¯å�¯ä»¥æ˜�æ˜¾çš„å�‘ç�°&lt;code&gt;max_1(&quot;foo&quot;, 1)&lt;/code&gt;å’Œ&lt;code&gt;max_1(1, &quot;foo&quot;)&lt;/code&gt;è¿�è¡Œæ—¶ä¼šæŠ›é”™ï¼Œå› ä¸ºç±»å�‹ä¸�å�Œã€‚ä½†æ˜¯ mypy å�´æ²¡æœ‰å�‘ç�°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Python çš„ç±»å�‹ç³»ç»Ÿä¸­ï¼Œæ³›å�‹ç±»å�‹å�˜é‡�åº”è¯¥ä½¿ç”¨&lt;code&gt;TypeVar&lt;/code&gt;ï¼Œå°±å�¯ä»¥æš´éœ²é—®é¢˜äº†:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVar&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;T&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# å®šä¹‰ç±»å�‹å�˜é‡�&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# æ³›å�‹å‡½æ•°&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;max_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;foo&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;bar&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å‰�é�¢çš„ 2 ä¸ªä¾‹å­�ä¸­çš„&lt;code&gt;T&lt;/code&gt;æˆ–è€…&lt;code&gt;U&lt;/code&gt;éƒ½æ˜¯ç±»å�‹å�˜é‡�ï¼Œæˆ‘çš„ç�†è§£ä¹Ÿæ˜¯ç±»å�‹åˆ«å��ï¼ˆType aliasesï¼‰ï¼Œå�¯ä»¥è¢«é‡�å¤�åˆ©ç”¨ (è¿˜æ›´å®¹æ˜“è¡¨è¾¾å¤�æ�‚çš„ç»“æ�„)ï¼Œå› ä¸ºå�‚æ•°å’Œè¿”å›�å€¼çš„ç±»å�‹ç›¸å�Œå°±ç›´æ�¥ç”¨å®ƒä»¬ã€�æ›¿ä»£ã€‘äº†ã€‚TypeVar å�¯ä»¥é€šè¿‡ bound å�‚æ•°ç»‘å®šæŸ�ä¸ªç±»å�‹ï¼Œè¿˜å�¯ä»¥æŒ‰ç…§æˆ‘ä¸Šé�¢å†™çš„ï¼Œè®©å®ƒæ”¯æŒ� int å’Œ strã€‚æˆ‘è¿˜æ˜¯å»ºè®®ä½ ç¨�å¾®å�»å®˜ç½‘çœ‹ä¸€ä¸‹ TypeVar çš„ç”¨æ³•ï¼Œå› ä¸ºå®ƒç¡®å®�åœ¨æ³›å�‹ä¸­å¾ˆé‡�è¦�ã€‚&lt;/p&gt;
&lt;p&gt;è€Œè¿™ç§�å�˜é‡�è¿˜å�¯ä»¥ä½œä¸ºå®¹å™¨ä¸­çš„å…ƒç´ ï¼Œä¸¾ä¸ªä¾‹å­�:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;max_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;max_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# OK&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;max_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;3&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨å¸¸è§�æƒ…å†µä¸‹ï¼Œé€šè¿‡ Union çš„æ–¹å¼�ç»„å�ˆå¯¹åº”çš„ç±»å�‹å°±å�¯ä»¥è®© mypy ç�†è§£ç¨‹åº�ä¸­å�‚æ•°å’Œè¿”å›�å€¼çš„ç±»å�‹æœ‰å¤šä¸ªï¼Œå¦‚ä¸Šé�¢çš„ä¾‹å­� items æ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºå­—ç¬¦ä¸²æˆ–è€…æ•°å­—çš„åˆ—è¡¨ã€‚&lt;strong&gt;Python å†…ç½®çš„é›†å�ˆç±»å�‹ (collections.abc.Collection) å�¯ä»¥æ”¯æŒ�å�„ç§�ç±»å�‹å…ƒç´ ï¼Œå°±æ˜¯å› ä¸ºå®ƒä»¬éƒ½æ˜¯æ³›å�‹ç±»&lt;/strong&gt;ã€‚è€Œç�°å®�ä¸–ç•Œä¸Šï¼Œæˆ‘ä»¬åœ¨å¼€å�‘ä¸­å¿…ç„¶å®šä¹‰å�„ç§�ç±»ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦�è®©è‡ªå®šä¹‰ç±»æ”¯æŒ�æ³›å�‹ã€‚&lt;/p&gt;
&lt;p&gt;æƒ³æƒ³ä¹‹å‰�çš„æ³›å�‹å®šä¹‰ã€�ä¸�é¢„å…ˆæŒ‡å®šå…·ä½“çš„ç±»å�‹ï¼Œè€Œåœ¨ä½¿ç”¨çš„æ—¶å€™å†�æŒ‡å®šç±»å�‹ã€‘ã€‚æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;typing.Generic&lt;/code&gt;å®šä¹‰ä¸€ä¸ªç±»:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Generic&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;K&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;V&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Generic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Itemæ˜¯ä¸€ä¸ªæ³›å�‹ç±»ï¼Œå�¯ä»¥ç¡®å®šå…¶ä¸­çš„2ä¸ªç±»å�‹&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;V&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;a&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# OK Itemæ˜¯æ³›å�‹ç±»ï¼Œæ‰€ä»¥ç¬¦å�ˆè¦�æ±‚çš„ç±»å�‹å€¼éƒ½å�¯ä»¥ä½œä¸ºå�‚æ•°&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;i2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;a&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#  OK æ˜�ç¡®çš„æŒ‡å®šäº†Itemçš„K, Vçš„ç±»å�‹&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;i3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;#  OK æ˜�ç¡®çš„æŒ‡å®šæˆ�äº†å�¦å¤–çš„ç±»å�‹&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;i4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;a&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected å› ä¸ºä¼ å…¥çš„å�‚æ•°å’ŒæŒ‡å®šçš„ç±»å�‹Vä¸�å�Œ&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¥½ï¼Œæœ‰äº†ä¸Šé�¢çš„é“ºå�«ï¼Œè¿›å…¥æ­£é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ PEP çš„æ ‡é¢˜ï¼Œè¯´çš„æ˜¯ã€�å�¯å�˜æ•°é‡�çš„æ³›å�‹å‡½æ•°ã€‘ã€‚ä¹‹å‰�ä»‹ç»�çš„&lt;code&gt;TypeVar&lt;/code&gt;æ˜¯å�•ä¸ªæ³›å�‹ï¼Œè€Œè¿™æ¬¡å¼•å…¥äº†æ•°é‡�ä¸�ç¡®å®šçš„æ³›å�‹ç±»å�‹&lt;code&gt;TypeVarTuple&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­�å°±èƒ½ç�†è§£äº†:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVarTuple&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;K2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;K2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;V2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypeVarTuple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;V2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Item2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Generic&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;V2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;3&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;d&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{},&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;1&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{},&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Item2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;1&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{})&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™é‡Œä¾‹å­�ä¸­ï¼ŒDict çš„å±�æ€§&lt;code&gt;key&lt;/code&gt;å’Œ&lt;code&gt;values&lt;/code&gt;éƒ½æ˜¯æ³›å�‹ï¼Œä¹Ÿå°±è¯´ï¼Œ&lt;code&gt;key&lt;/code&gt;ä¹Ÿå�¯ä»¥æ˜¯ int ä¹Ÿå�¯ä»¥æ˜¯ strï¼Œè€Œ values æ˜¯é��å›ºå®šé•¿åº¦çš„ï¼Œç”±äº�ä½¿ç”¨&lt;code&gt;TypeVarTuple&lt;/code&gt;æ—¶æ²¡æœ‰æŒ‡å®šç±»å�‹ï¼Œæ‰€ä»¥å�„ç§�ç±»å�‹éƒ½å�¯ä»¥ç”¨ã€‚è€Œå› ä¸ºå¼•å…¥äº†&lt;code&gt;TypeVarTuple&lt;/code&gt;ï¼Œå�¯ä»¥è®©ç±»å�‹æ£€æŸ¥çš„ç�µæ´»åº¦æ��å�‡äº†å¾ˆå¤šã€‚&lt;/p&gt;
&lt;p&gt;PS: ç›®å‰� mypy è¿˜æ²¡æœ‰æ”¯æŒ�è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œç�°åœ¨è¿�è¡Œ mypy ä¼šæŠ¥é”™:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;s2&quot;&gt;&quot;TypeVarTuple&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;supported&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;by&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mypy&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;yet&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;PEP673â€“SelfType&quot;&gt;PEP 673 â€“ Self Type&lt;/h3&gt;
&lt;p&gt;Self é¡¾å��æ€�ä¹‰å°±æ˜¯ç”³æ˜�è‡ªå·±ï¼Œä¸¾ 2 ä¸ªä¾‹å­�çœ‹ä¸€ä¸‹è¿‡å�»å¸¸è§�çš„ç”¨æ³•:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__class__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;(value=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&#x27;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;Result&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;Result&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NewResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NewResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NewResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;Node&#x27;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;previous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;Node&#x27;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;node&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;previous&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­�ä¸­æœ‰ä¸‰ä¸ªåœ°æ–¹çš„è¿”å›�å€¼é€šè¿‡ç±»å�‹å­—ç¬¦ä¸²æ�¥è¡¨ç¤ºå¼•ç”¨è‡ªèº«:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å£°æ˜�å®�ä¾‹æ–¹æ³• &lt;code&gt;add_value&lt;/code&gt; è¿”å›�ä¸€ä¸ª Result å®�ä¾‹&lt;/li&gt;
&lt;li&gt;å£°æ˜�ç±»æ–¹æ³• &lt;code&gt;get&lt;/code&gt; è¿”å›�ä¸€ä¸ª Result å®�ä¾‹&lt;/li&gt;
&lt;li&gt;Node åˆ�å§‹åŒ–æ—¶å£°æ˜� &lt;code&gt;self.next&lt;/code&gt; å’Œ &lt;code&gt;self.previous&lt;/code&gt; éƒ½å�¯ä»¥æ˜¯ &lt;code&gt;None&lt;/code&gt; æˆ–è€… Node å®�ä¾‹&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨è¿™é‡Œæ˜¯ä¸�èƒ½ç›´æ�¥å†™ç±»å��çš„ï¼Œå› ä¸ºå£°æ˜�æ—¶ç±»è¿˜æ²¡æœ‰åˆ›å»ºå¥½ï¼Œmypy å�¯ä»¥ç�†è§£ï¼Œä½†æ˜¯è¿�è¡Œæ—¶ä¼šæŠ¥&lt;code&gt;NameError: name &#x27;XXX&#x27; is not defined&lt;/code&gt;è¿™æ ·çš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†ä½¿ç”¨å­—ç¬¦ä¸²å®šä¹‰ä»¥å¤–ï¼Œè¿˜æœ‰ä¸‰ç§�æ–¹æ³•ï¼Œæˆ‘è¿™é‡Œç®€å�•æ��ä¸€ä¸‹å°±ä¸�æŒ¨ä¸ªç»†è¯´äº† (å› ä¸º Python 3.11 æ›´å®Œç¾�çš„è§£å†³è¿™ä¸ªé—®é¢˜):&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Python 3.8 ä»¥ä¸Šä½¿ç”¨ &lt;code&gt;ForwardRef&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯¼å…¥ &lt;code&gt;from __future__ import annotations&lt;/code&gt;(Python 3.10 å¼€å§‹é»˜è®¤å¼€å�¯)&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;TResult = TypeVar (&quot;TResult&quot;, bound=&quot;Result&quot;)&lt;/code&gt; è¿™æ ·çš„æ–¹å¼�ç»‘å®šåˆ°ä¸€ä¸ª TypeVar ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä½†æ˜¯è¿™äº›æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªå¾ˆæœºæ¢°çš„é—®é¢˜ï¼Œå°±æ˜¯å¯¹äº�ç»§æ‰¿å��çš„ç±»çš„æ”¯æŒ�å’Œè¡¨ç¤ºã€‚ä¾‹å¦‚ä¸Šé�¢çš„å­—ç¬¦ä¸²å®šä¹‰ï¼Œ&lt;code&gt;NewResult&lt;/code&gt;ç»§æ‰¿äº†&lt;code&gt;Result&lt;/code&gt;çš„å�Œæ—¶ä¹Ÿç»§æ‰¿äº†æ–¹æ³•æ³¨è§£ï¼Œä¹Ÿå°±æ˜¯è¯´ç±»ä¼¼äº�&lt;code&gt;NewResult.get&lt;/code&gt;æ–¹æ³•çš„è¿”å›�å€¼ï¼Œå…¶å®�æ˜¯ä¸€ä¸ª&lt;code&gt;Result&lt;/code&gt;çš„å®�ä¾‹ã€‚å½“ç„¶æœ¬è´¨ä¸ŠæŒ‰ç…§&lt;code&gt;isinstance&lt;/code&gt;çš„é€»è¾‘çœ‹ç¡®å®�ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰çœŸå®�çš„è¡¨è¾¾&lt;code&gt;self&lt;/code&gt;ã€‚è€Œè¿™ä¸ª PEP 673 æ��ä¾›äº†&lt;code&gt;Self&lt;/code&gt;ï¼Œè¿™æ ·æ˜¯æœ€ç¾�å¥½çš„æ–¹æ¡ˆäº†:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__str__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__class__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__name__&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;(value=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&#x27;&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;add_value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@classmethod&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;cls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;NewResult&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;previous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;PS: ç›®å‰� mypy è¿˜æ²¡æœ‰æ”¯æŒ�è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œç�°åœ¨è¿�è¡Œ mypy ä¼šæŠ¥é”™:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;typing.Self&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;See&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mypy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;readthedocs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;io&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;en&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;common_issues&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#variables-vs-type-aliases&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;PEP675â€“ArbitraryLiteralStringType&quot;&gt;PEP 675 â€“ Arbitrary Literal String Type&lt;/h3&gt;
&lt;p&gt;åœ¨è¯´è¿™ä¸ª&lt;code&gt;LiteralString&lt;/code&gt;ä¹‹å‰�ï¼Œå…ˆè¯´ä¸€ä¸‹åœ¨ Python 3.8 å¼•å…¥çš„&lt;code&gt;Literal&lt;/code&gt;ï¼Œä¼šè®©ä½ æ›´å®¹æ˜“ç�†è§£ã€‚&lt;code&gt;Literal&lt;/code&gt;çš„æ„�æ€�æ˜¯å­—é�¢å€¼ï¼Œå¸¸è§�çš„å­—ç¬¦ä¸²ã€�æ•°å­—ã€�åˆ—è¡¨ã€�å­—å…¸ã€�å¸ƒå°”å€¼ç­‰éƒ½å�¯ä»¥ä½œä¸º\ å­—é�¢å€¼ã€‚&lt;code&gt;typing.Literal&lt;/code&gt;çš„æ„�æ€�æ˜¯å�¯ä»¥æ�¥å�—å¯¹åº”åˆ—å‡ºæ�¥çš„å­—é�¢å€¼:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Literal&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;accepts_only_four&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Literal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;accepts_only_four&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# OK&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;accepts_only_four&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;19&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;accepts_only_four&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;Literal[4]&lt;/code&gt;è¡¨ç¤ºå�ªæ�¥å�—å�‚æ•°çš„å€¼ä¸º 4ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªä¼ å…¥ 19 ä¸�è¡Œï¼Œç¬¬ä¸‰ä¸ª&lt;code&gt;2 + 2&lt;/code&gt;çš„ç»“æ�œä¹Ÿæ˜¯ 4ï¼Œä½†äº‹å®�ä¸Šä¹Ÿä¸�è¡Œï¼Œå› ä¸ºæ‰€è°“çš„å­—é�¢å€¼çš„æ„�æ€�æ˜¯è¦�ç›´æ�¥æ˜�ç¡®çš„ç»™æˆ‘è¿™ä¸ªå€¼ï¼Œè€Œä¸�æ˜¯é€šè¿‡è®¡ç®—å¾—æ�¥çš„ï¼Œå¯¹äº�è¿™ä¸ªåœ°æ–¹ï¼Œå®ƒå�ªåˆ¤æ–­â€˜å­—é�¢â€™ä¸Š&lt;code&gt;4&lt;/code&gt;å’Œ&lt;code&gt;2+2&lt;/code&gt;ä¸�ä¸€æ ·å°± Rejected äº†ã€‚è¿™æ®µå¾ˆé‡�è¦�ï¼Œå¤šç�†è§£ç�†è§£ã€‚&lt;/p&gt;
&lt;p&gt;å›�åˆ°æ­£é¢˜ï¼Œè¿™ä¸ª PEP çš„åŠ¨æœºæ�¥æº�äº�æ��ä¾›ä¸€ä¸ªæ›´ç›´è§‚ä¸”é€šç”¨çš„æ–¹æ¡ˆè§£å†³ SQL æ³¨å…¥é—®é¢˜ã€‚å…ˆçœ‹ PEP é‡Œé�¢æ��ä¾›çš„ä¾‹å­�:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM data WHERE user_id = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;user123&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# OK.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Delete the table.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;user123; DROP TABLE data;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fetch all users (since 1 = 1 is always true).&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;user123 OR 1 = 1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œ&lt;code&gt;user_id&lt;/code&gt;æ˜¯ä¸€ä¸ªç¬¦å�ˆè¦�æ±‚çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ç”±äº�&lt;code&gt;user_id&lt;/code&gt;å�¯èƒ½æ˜¯å¤–éƒ¨å�‚æ•°è�·å�–çš„ï¼Œæ�¥æº�æ˜¯ä¸�å�¯é� çš„ï¼Œå°±å�¯èƒ½å‡ºç�°æ‹¼è£… SQL è¯­å�¥å®�ç�°ä¸€äº›é¢�å¤–çš„ç›®çš„çš„å®‰å…¨é£�é™©ã€‚ä¸¾ä¸ªä¾‹å­�:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;åœ¨è¿™é‡Œæˆ‘ç”¨&lt;code&gt;input&lt;/code&gt;å‡½æ•°è¡¨ç¤ºå¤–éƒ¨æ¸ é�“ä¼ å…¥è¿™ä¸ª&lt;code&gt;user_id&lt;/code&gt;ã€‚å¦‚æ�œæŒ‰ç…§è¿‡å�»çš„ str å£°æ˜�çœ‹ä¸�å‡ºæ�¥é—®é¢˜ï¼Œä½†æ˜¯ä½¿ç”¨æ–°å¢�çš„&lt;code&gt;LiteralString&lt;/code&gt;å°±ä¼šè®©è¯­å�¥ä¸�é€šè¿‡:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LiteralString&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LiteralString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;query&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM data WHERE user_id = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user_id&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;query_user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å› ä¸º&lt;code&gt;user_id&lt;/code&gt;å¹¶ä¸�æ˜¯ç›´æ�¥ä¼ å…¥äº†å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯é€šè¿‡&lt;code&gt;input&lt;/code&gt;è®¡ç®—è€Œæ�¥ã€‚&lt;code&gt;LiteralString&lt;/code&gt;å°±å¦‚ PEP çš„æ ‡é¢˜ï¼Œå�¯ä»¥è¡¨ç¤ºä»»æ„�çš„å­—ç¬¦ä¸²å­—é�¢å€¼ï¼Œä¸�æƒ³å‰�é�¢çš„&lt;code&gt;typing.Literal&lt;/code&gt;ï¼Œå�ªèƒ½è§„å®šå‡ ä¸ªå¯¹åº”çš„ç¡®å®šçš„å€¼ï¼Œç�µæ´»æ€§å¤ªå·®ã€‚&lt;/p&gt;
&lt;p&gt;å�¦å¤–å¦‚æ�œå­—ç¬¦ä¸²æ˜¯æ‹¼æ�¥çš„ï¼Œéœ€è¦�æ‰€æœ‰éƒ¨åˆ†éƒ½æ˜¯å­—é�¢å€¼:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;execute_sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LiteralString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;execute_sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;execute_sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;execute_sql&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user_input&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šè¿° 2 ä¸ªä¾‹å­�ä¹Ÿä¼šè¢« Rejectedï¼Œå› ä¸ºå��å�Šéƒ¨åˆ†çš„ user_input ä¸�æ˜¯ä¸€ä¸ªå­—é�¢å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™ä¸ªç‰¹æ€§æˆ‘è§‰å¾—ä¸»è¦�é’ˆå¯¹äº� f-stringï¼Œæ¯•ç«Ÿ input è¿™ç§�ç”¨æ³•å¾ˆå°‘è§�&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;PS: ç›®å‰� mypy è¿˜æ²¡æœ‰æ”¯æŒ�è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œæ‰€ä»¥æœ‰é—®é¢˜çš„åœ°æ–¹è¿˜ä¸�ä¼šæŠ›é”™ã€‚&lt;/p&gt;
&lt;h3 id=&quot;PEP681â€“DataClassTransforms&quot;&gt;PEP 681 â€“ Data Class Transforms&lt;/h3&gt;
&lt;p&gt;ç›®å‰�ç±»å�‹æ£€æŸ¥å¯¹äº�æ ‡å‡†åº“å†…å�„ä¸ªåŒ…çš„æ”¯æŒ�éƒ½æ˜¯å¾ˆå¥½çš„ï¼ŒåŒ…å�«&lt;code&gt;dataclasses&lt;/code&gt;ï¼ŒäºŒè¿™ä¸ª PEP å®�ç�°äº†ä¸€ç§�æŠŠæ™®é€šç±»çš„ä¸€äº›å’Œæ ‡å‡†åº“&lt;code&gt;dataclasses&lt;/code&gt;ç›¸ä¼¼çš„è¡Œä¸ºçš„ç±»å�‹æ£€æŸ¥è‡ªåŠ¨è½¬æ�¢çš„æ–¹æ¡ˆã€‚è¿™äº›è¡Œä¸ºåŒ…å�«:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ ¹æ�®å£°æ˜�çš„æ•°æ�®å­—æ®µå�ˆæˆ�çš„ &lt;code&gt;__init__&lt;/code&gt; æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;å�¯é€‰çš„å�ˆæˆ� &lt;code&gt;__eq__&lt;/code&gt;, &lt;code&gt;__ne__&lt;/code&gt;, &lt;code&gt;__lt__&lt;/code&gt;, &lt;code&gt;__le__&lt;/code&gt;, &lt;code&gt;__gt__&lt;/code&gt; å’Œ &lt;code&gt;__ge__&lt;/code&gt; æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒ� frozen å�‚æ•°ï¼Œé�™æ€�ç±»å�‹æ£€æŸ¥æ—¶ä¼šç¡®è®¤å­—æ®µçš„ä¸�å�¯å�˜ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒ�ã€�å­—æ®µè¯´æ˜�ç¬¦ã€‘ï¼Œé�™æ€�ç±»å�‹æ£€æŸ¥æ—¶ä¼šäº†è§£çš„å�„ä¸ªå­—æ®µçš„å±�æ€§ï¼Œä¾‹å¦‚æ˜¯å�¦ä¸ºè¯¥å­—æ®µæ��ä¾›äº†é»˜è®¤å€¼ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ¬å°�èŠ‚ç›¸å…³çš„ dataclasses å’Œ attrs å�¯ä»¥çœ‹ä¹‹å‰�æˆ‘çš„å�šå®¢æ–‡ç« : &lt;a href=&quot;https://www.dongwm.com/post/129/&quot;&gt;attrs å’Œ Python3.7 çš„ dataclasses&lt;/a&gt; ï¼Œè¿™é‡Œå°±ä¸�å…·ä½“å±•å¼€äº†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ²¡æœ‰è¿™ä¸ª PEP çš„å®�ç�°å‰�ï¼Œå½“ä½ åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†ç›¸å…³çš„åº“ï¼Œå¦‚ attrs, pydantic, å�„ç§� ORMï¼ˆå¦‚ SQLAlchemyã€�Django ç­‰ï¼‰ï¼Œé‚£ä¹ˆåœ¨é�™æ€�ç±»å�‹æ£€æŸ¥æ—¶è¿™äº›åº“å°±éœ€è¦�æ��ä¾›å¯¹åº”çš„ç±»å�‹æ³¨è§£ï¼Œå�¦åˆ™å°±å¾—è‡ªå·±å†™ä¸€é��æˆ–è€…æƒ³åŠ�æ³•å¿½ç•¥ç›¸å…³çš„æ£€æŸ¥ã€‚è€Œè¿™ä¸ª PEP å°±æ˜¯ä¸ºäº†é™�ä½�è¿™ç§�æˆ�æœ¬ï¼Œé€šè¿‡&lt;code&gt;dataclass_transform&lt;/code&gt;å�¯ä»¥æ–¹ä¾¿çš„åœ¨è£…é¥°å™¨ã€�ç±»ã€�å…ƒç±»ä¸‰ä¸ªçº§åˆ«ä¸�éœ€è¦�é¢�å¤–å†™æ³¨é‡Šå°±æ”¯æŒ�å¯¹åº”çš„ç±»å�‹æ£€æŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸ªäººè§‰å¾—è¿™ä¸ª PEP ä¸»è¦�æ—¨åœ¨å¸®åŠ©åº“çš„ä½œè€…ï¼Œé™¤é��åœ¨é¡¹ç›®ä¸­è‡ªå·±é€ äº†æœ‰ç±»ä¼¼&lt;code&gt;dataclasses&lt;/code&gt;åº“é‚£äº›è¡Œä¸ºçš„è½®å­�ï¼Œæ‰€ä»¥å¯¹äº�å¼€å�‘è€…å¼€å§‹å½±å“�è¾ƒå°�ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­�ï¼Œå�¯èƒ½æ›´å¥½èƒ½ç�†è§£ã€‚æˆ‘ä¸ªäººæ˜¯æ¯”è¾ƒå–œæ¬¢ç”¨&lt;code&gt;attrs&lt;/code&gt;çš„ï¼Œåœ¨æˆ‘çš„é¡¹ç›®ä¸­ä¼šè¿™ä¹ˆå®šä¹‰ Model (ä¸ºäº†ä¸¾ä¾‹å�šäº†æ��å¤§çš„ç®€åŒ–):&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;attr&lt;/span&gt;


&lt;span class=&quot;nd&quot;&gt;@attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;



&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Rejected&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æˆ‘æ²¡æœ‰å®šä¹‰&lt;code&gt;__init__&lt;/code&gt;æ–¹æ³•ï¼Œä½†æ˜¯å½“æˆ‘ä½¿ç”¨&lt;code&gt;attrs&lt;/code&gt;å��ï¼Œå®ƒä¼šå¸®åŠ©æˆ‘è‡ªåŠ¨åˆ›å»ºä¸€ç³»åˆ—å¯¹åº”çš„æ–¹æ³•ã€‚ç”¨çš„æ—¶å€™&lt;code&gt;Model(1, 2)&lt;/code&gt;æ˜¯åº”è¯¥ä¸�é€šè¿‡ç±»å�‹æ£€æŸ¥çš„ (å› ä¸º title åº”è¯¥æ˜¯å­—ç¬¦ä¸²ï¼Œæˆ‘ä¼ å…¥äº† int)&lt;/p&gt;
&lt;p&gt;æ�¥ç�€å…ˆå®‰è£…æœªæ”¯æŒ�è¿™ä¸ªç‰¹æ€§çš„ attrs ç‰ˆæœ¬ï¼Œè¿�è¡Œ pyright (å�¦å¤–ä¸€ä¸ªé�™æ€�æ£€æŸ¥å·¥å…·ï¼Œmypy ç�°åœ¨è¿˜æ²¡æœ‰æ”¯æŒ�è¿™ä¸ª PEP) è¯•è¯•:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;err&quot;&gt;â�œ&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;20.3.0&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;â�œ&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyright&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;â�œ&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyright&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pep681&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pyright&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1.276&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pep681&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pep681&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Expected&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;no&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arguments&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Model&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;constructor&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reportGeneralTypeIssues&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;informations&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;pyright ç‰¹åˆ«å‚»ï¼Œå®ƒè®¤ä¸ºæ²¡æœ‰åœ¨è¿™ä¸ªç±»ä¸­å®šä¹‰æ�„é€ æ–¹æ³•&lt;code&gt;__init__&lt;/code&gt;ã€‚è¿™ä¸ªæ—¶å€™&lt;code&gt;attrs&lt;/code&gt;è¿˜æ²¡æœ‰æ”¯æŒ�å¯¹åº”çš„ç±»å�‹æ³¨è§£ã€‚æœ‰å…´è¶£å�¯ä»¥çœ‹å¯¹åº”çš„ PR: &lt;a href=&quot;https://github.com/python-attrs/attrs/pull/796/&quot;&gt;Implement pyright support via dataclass_transforms&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¹‹å��ï¼Œpyright ä¼šç�†è§£ attrs é‡Œé�¢çš„ä¸Šè¿°ç”¨æ³•:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;err&quot;&gt;â�œ&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pip&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attrs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;22.1.0&lt;/span&gt;
&lt;span class=&quot;err&quot;&gt;â�œ&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pyright&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pep681&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pyright&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.1.276&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pep681&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;home&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ubuntu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2022&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pep681&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Argument&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Literal[2]&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cannot&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;be&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;assigned&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameter&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;title&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;str&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;__init__&quot;&lt;/span&gt;
  Â Â &lt;span class=&quot;s2&quot;&gt;&quot;Literal[2]&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;incompatible&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;str&quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reportGeneralTypeIssues&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;informations&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å�¯ä»¥çœ‹åˆ°ä¸Šé�¢è¿™ä¸ªé”™è¯¯å°±æ­£ç¡®äº†ã€‚&lt;/p&gt;
&lt;h3 id=&quot;PEP655â€“MarkingindividualTypedDictitemsasrequiredorpotentially-missing&quot;&gt;PEP 655 â€“ Marking individual TypedDict items as required or potentially-missing&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;TypedDict&lt;/code&gt;æ˜¯ Python 3.8 æ—¶åŠ å…¥çš„ä¸€ä¸ªé��å¸¸æœ‰ç”¨çš„ç±»å�‹ï¼Œæˆ‘ä»¬å…ˆæŠŠå®ƒè¯´æ¸…æ¥šã€‚åœ¨æ—¥å¸¸å¼€å�‘ä¸­ç»�å¸¸ä¼šå®šä¹‰ä¸€ä¸ªå¤�æ�‚çš„å­—å…¸ç±»å�‹ï¼Œå¦‚æ�œä½ å¸Œæœ› mypy å¯¹è¿™ä¸ªå­—å…¸é”®å€¼ç±»å�‹å�šéªŒè¯�ï¼Œå¤§æ¦‚éœ€è¦�è¿™æ ·:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#x27;title&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;test&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#x27;items&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;1&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;2&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä¸Šé�¢çš„ä¾‹å­�ä¸­æˆ‘ä¼šå°½é‡�çš„å…·ä½“å‡ºå€¼çš„ç±»å�‹ï¼Œä½†æ˜¯ç”±äº�è¿™ä¸ªå­—å…¸çš„å€¼çš„ç±»å�‹å¤ªå¤šï¼Œå�ªèƒ½ä½¿ç”¨ Union çš„æ–¹æ³•ä¸²èµ·æ�¥ã€‚ä½†æ˜¯å®ƒåœ¨ mypy å“ªé‡Œå�´ä¸�å¤Ÿæ˜�ç¡®ã€‚æ¯”å¦‚æ‰§è¡Œè¿™ä¹ˆä¸€æ®µé€»è¾‘:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;items&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;mypy ä¼šæŠ›é”™:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;pep655&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Unsupported&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operand&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;str&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;int&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pep655&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Unsupported&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operand&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;types&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;List[str]&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;int&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pep655&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Left&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;operand&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;of&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Union[int, str, List[str]]&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pep655&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Argument&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;len&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;has&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;incompatible&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Union[int, str, List[str]]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;expected&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Sized&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æ‰€ä»¥å¾ˆå¤šæ—¶å€™å¯¹äº�è¿™ä¸ªè¿”å›�å€¼å°±æ— æ³•å…·ä½“çš„ç¡®è®¤ç±»å�‹äº†ã€‚è€Œ&lt;code&gt;TypedDict&lt;/code&gt;å°±æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TypedDict&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TypedDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;



&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#x27;title&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;test&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&#x27;items&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;1&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;2&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;items&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;code&gt;TypedDict&lt;/code&gt;é€šè¿‡ä¸€ä¸ªç±»ä¼¼äº�&lt;code&gt;dataclass&lt;/code&gt;çš„å½¢å¼�æ˜�ç¡®ä¸ªå�„ä¸ªé”®å€¼çš„ç±»å�‹ã€‚å�¯ä»¥å¸®åŠ© mypy æ›´ç�†è§£è¿™ä¸ªè¿”å›�çš„å€¼çš„ç»“æ�„ï¼Œä»�è€Œåœ¨é€»è¾‘ä¸­åˆ¤æ–­å‡ºæ›´å¤šç±»å�‹é—®é¢˜:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;x&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# TypedDict &quot;Summary&quot; has no key &quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Value of &quot;total&quot; has incompatible type &quot;str&quot;; expected &quot;int&quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½†æ˜¯åœ¨ Python 3.11 å‰�ï¼Œå®ƒåœ¨å®�ç�°ä¸Šå¯¹äº�å®šä¹‰çš„é”®å€¼çš„è¦�æ±‚å¾ˆæ��ç«¯ï¼Œè¦�ä¸�ç„¶éœ€è¦�å…¨éƒ¨å­˜åœ¨ï¼Œè¦�ä¸�ç„¶ä¸�å…³å¿ƒç¼ºå°‘å“ªä¸€ä¸ªé”®:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Summary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TypedDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Missing keys (&quot;title&quot;, &quot;items&quot;) for TypedDict &quot;Summary&quot;&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Summary2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TypedDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# ä½¿ç”¨total=Falseä¼šè®©ç±»å�‹æ£€æŸ¥ä¸�å…³æ³¨æ˜¯å�¦ç¼ºå°‘é”®&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;s2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# OK&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# OK&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è¿‡å�»ä¸ºäº†åˆ†åˆ«å¯¹äº�ä¸�å�Œçš„é”®æ˜¯å�¦æ˜¯ä¸€ä¸ª Optionalï¼Œå�ªèƒ½ç”¨ç»§æ‰¿çš„æ–¹å¼�:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Summary3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TypedDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Summary4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Summary3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;s4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Missing keys (&quot;total&quot;, &quot;title&quot;) for TypedDict &quot;Summary4&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;title&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;Title&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# OKï¼Œç¼ºå°‘äº†itemsä¹Ÿæ²¡å…³ç³»&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;è€Œ PEP 655 é€šè¿‡å¼•å…¥&lt;code&gt;Required[]&lt;/code&gt;å’Œ&lt;code&gt;NotRequired[]&lt;/code&gt;å�¯ä»¥è®© TypedDict é‡Œé�¢çš„é”®çš„å®šä¹‰æ˜�ç¡®æ˜¯å�¦å¼ºä¾�èµ–:&lt;/p&gt;
&lt;figure class=&quot;highlight python3&quot; data-lang=&quot;python3&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre class=&quot;hljs python3&quot;&gt;&lt;span/&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;typing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Required&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NotRequired&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Summary5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TypedDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Required&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# æ˜�ç¡®totalæ˜¯å¿…é€‰çš„&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# é»˜è®¤å°±æ˜¯Required&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;NotRequired&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# æ˜�ç¡®itemsæ˜¯å�¯é€‰çš„&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;s6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Missing keys (&quot;total&quot;, &quot;title&quot;) for TypedDict &quot;Summary5&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Summary4&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;total&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;title&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;Title&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# OKï¼Œå®�ç�°å’Œä¸Šé�¢ä¸€æ ·çš„æ•ˆæ�œ&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;å��è®°&quot;&gt;å��è®°&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;é™¤äº† PEP 655 ä»¥å¤–ï¼Œç›®å‰� mypy éƒ½è¿˜æ²¡æœ‰æ”¯æŒ�ï¼Œå…·ä½“çš„å�¯ä»¥çœ‹å»¶ä¼¸é˜…è¯»è¿�æ�¥ 6 çš„è¿›åº¦ã€‚ è¿™... ğŸ’Šã€‚&lt;/li&gt;
&lt;li&gt;å‡†å¤‡å†™ä¸€ç¯‡æ–‡ç« å®Œæ•´çš„ä»‹ç»� Python ç±»å�‹ç³»ç»Ÿçš„å‰�ä¸–ä»Šç”Ÿ&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;ä»£ç �ç›®å½•&quot;&gt;ä»£ç �ç›®å½•&lt;/h3&gt;
&lt;p&gt;æœ¬æ–‡ä»£ç �å�¯ä»¥åœ¨ &lt;a href=&quot;https://github.com/dongweiming/mp/tree/master/2022-10-23&quot;&gt;mp&lt;/a&gt; é¡¹ç›®æ‰¾åˆ°&lt;/p&gt;
&lt;h3 id=&quot;å»¶ä¼¸é˜…è¯»&quot;&gt;å»¶ä¼¸é˜…è¯»&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://peps.python.org/pep-0646/&quot;&gt;https://peps.python.org/pep-0646/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://peps.python.org/pep-0673/&quot;&gt;https://peps.python.org/pep-0673/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/python/mypy/issues/12840&quot;&gt;https://github.com/python/mypy/issues/12840&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://mypy.readthedocs.io/en/stable/more_types.html#typeddict&quot;&gt;https://mypy.readthedocs.io/en/stable/more_types.html#typeddict&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

    &lt;/div&gt;

  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>