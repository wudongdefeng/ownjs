<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>ee0e5ef8336bc1ddc8642839df3816d2</guid>
<title>ä¸‡å­—å›¾æ–‡è®²é€æ•°æ®åº“ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</title>
<link>https://toutiao.io/k/1exlsmh</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section&gt;&lt;span&gt;ç‚¹ä¸ªå…³æ³¨ğŸ‘†è·Ÿè…¾è®¯å·¥ç¨‹å¸ˆå­¦æŠ€æœ¯&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.10084033613445378&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/VY8SELNGe94NkoG8ic4cxAHXIAeNJugn2C3ibibg0zRygM6XpWUCFCS2jFyBK9J6WPBv8hzQFpnNHoneSEGMe8mqQ/640?wx_fmt=gif&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&quot; data-w=&quot;1071&quot;/&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.10899182561307902&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDWibXoicOmWRPWDtKd4KicjNbOybYFjuxwAMrXNWs2cE6DjLKhzDwE48IQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1468&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;å¯¼è¯­|&lt;/span&gt;Â &lt;/span&gt;&lt;span&gt;ç¼“å­˜åˆç†ä½¿ç”¨ç¡®æå‡äº†ç³»ç»Ÿçš„ååé‡å’Œç¨³å®šæ€§ï¼Œç„¶è€Œè¿™æ˜¯æœ‰ä»£ä»·çš„ã€‚è¿™ä¸ªä»£ä»·ä¾¿æ˜¯ç¼“å­˜å’Œæ•°æ®åº“çš„ä¸€è‡´æ€§å¸¦æ¥äº†æŒ‘æˆ˜ï¼Œæœ¬æ–‡å°†é’ˆå¯¹æœ€å¸¸è§çš„cache-asideç­–ç•¥ä¸‹å¦‚ä½•ç»´æŠ¤ç¼“å­˜ä¸€è‡´æ€§å½»åº•è®²é€ã€‚&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span/&gt;&lt;span&gt;ä½†&lt;/span&gt;&lt;span&gt;æ˜¯&lt;/span&gt;&lt;span&gt;å®¢è§‚ä¸Šï¼Œæˆ‘ä»¬çš„ä¸šåŠ¡è§„æ¨¡&lt;/span&gt;&lt;span&gt;å¾ˆå¯èƒ½è¦æ±‚ç€æ›´é«˜çš„ QPSï¼Œæœ‰äº›ä¸šåŠ¡çš„è§„æ¨¡æœ¬èº«å°±éå¸¸å¤§ï¼Œä¹Ÿæœ‰äº›ä¸šåŠ¡ä¼šé‡åˆ°ä¸€äº›æµé‡é«˜å³°ï¼Œæ¯”å¦‚ç”µå•†ä¼šé‡åˆ°å¤§ä¿ƒçš„æƒ…å†µã€‚&lt;/span&gt;&lt;/section&gt;&lt;article&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œè¿™æ—¶å€™å¤§éƒ¨åˆ†çš„æµé‡å®é™…ä¸Šéƒ½æ˜¯è¯»è¯·æ±‚ï¼Œè€Œä¸”å¤§éƒ¨åˆ†æ•°æ®ä¹Ÿæ˜¯æ²¡æœ‰é‚£ä¹ˆå¤šå˜åŒ–çš„ï¼Œå¦‚çƒ­é—¨å•†å“ä¿¡æ¯ã€å¾®åšçš„å†…å®¹ç­‰å¸¸è§æ•°æ®å°±æ˜¯å¦‚æ­¤ã€‚æ­¤æ—¶ï¼Œç¼“å­˜å°±æ˜¯æˆ‘ä»¬åº”å¯¹æ­¤ç±»åœºæ™¯çš„åˆ©å™¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08148148148148149&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9FiaZYIGick0nWJJXC1lSLI8zy2asbcicfNgvgJXexvB9rOnicPxbKFdEibPg/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-w=&quot;1080&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;ç¼“å­˜çš„æ„ä¹‰&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€è°“ç¼“å­˜ï¼Œå®é™…ä¸Šå°±æ˜¯ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œå‡†ç¡®åœ°è¯´æ˜¯ç”¨æ›´é«˜é€Ÿçš„ç©ºé—´æ¥æ¢æ—¶é—´ï¼Œä»è€Œæ•´ä½“ä¸Šæå‡è¯»çš„æ€§èƒ½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä½•ä¸ºæ›´é«˜é€Ÿçš„ç©ºé—´å‘¢ï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ›´å¿«çš„å­˜å‚¨ä»‹è´¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœè¯´æ•°æ®åº“çš„é€Ÿåº¦æ…¢ï¼Œå°±å¾—ç”¨æ›´å¿«çš„å­˜å‚¨ç»„ä»¶å»æ›¿ä»£å®ƒï¼Œç›®å‰æœ€å¸¸è§çš„å°±æ˜¯Redisï¼ˆå†…å­˜å­˜å‚¨ï¼‰ã€‚Redis å•å®ä¾‹çš„è¯» QPS å¯ä»¥é«˜è¾¾ 10w/sï¼Œ90% çš„åœºæ™¯ä¸‹åªéœ€è¦æ­£ç¡®ä½¿ç”¨ Redis å°±èƒ½åº”å¯¹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å°±è¿‘ä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚å°±åƒ CPU ä¹Ÿæœ‰é«˜é€Ÿç¼“å­˜ä¸€æ ·ï¼Œç¼“å­˜ä¹Ÿå¯ä»¥åˆ†ä¸ºä¸€çº§ç¼“å­˜ã€äºŒçº§ç¼“å­˜ã€‚å³ä¾¿ Redis æœ¬èº«æ€§èƒ½å·²ç»è¶³å¤Ÿé«˜äº†ï¼Œä½†è®¿é—®ä¸€æ¬¡ Redis æ¯•ç«Ÿä¹Ÿéœ€è¦ä¸€æ¬¡ç½‘ç»œ IOï¼Œè€Œä½¿ç”¨æœ¬åœ°å†…å­˜æ— ç–‘æœ‰æ›´å¿«çš„é€Ÿåº¦ã€‚ä¸è¿‡å•æœºçš„å†…å­˜æ˜¯ååˆ†æœ‰é™çš„ï¼Œæ‰€ä»¥è¿™ç§ä¸€çº§ç¼“å­˜åªèƒ½å­˜å‚¨éå¸¸å°‘é‡çš„æ•°æ®ï¼Œé€šå¸¸æ˜¯æœ€çƒ­ç‚¹çš„é‚£äº› key å¯¹åº”çš„æ•°æ®ã€‚è¿™å°±ç›¸å½“äºé¢å¤–æ¶ˆè€—å®è´µçš„æœåŠ¡å†…å­˜å»æ¢å–é«˜é€Ÿçš„è¯»å–æ€§èƒ½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08148148148148149&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9F812pnpTVKsrLmlcKHlIuuBvuwqeIqmOLOsD9nTpkow7FlAh45LKRLA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-w=&quot;1080&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;å¼•å…¥ç¼“å­˜åçš„ä¸€è‡´æ€§æŒ‘æˆ˜&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œæ„å‘³ç€æ•°æ®åŒæ—¶å­˜åœ¨äºå¤šä¸ªç©ºé—´ã€‚æœ€å¸¸è§çš„åœºæ™¯å°±æ˜¯æ•°æ®åŒæ—¶å­˜åœ¨äº Redis ä¸ MySQL ä¸Šï¼ˆä¸ºäº†é—®é¢˜çš„æ™®é€‚æ€§ï¼Œåé¢ä¸¾ä¾‹ä¸­è‹¥æ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œç¼“å­˜å‡æŒ‡ Redis ç¼“å­˜ï¼‰ã€‚&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å®é™…ä¸Šï¼Œæœ€æƒå¨æœ€å…¨çš„æ•°æ®è¿˜æ˜¯åœ¨ MySQL é‡Œçš„ã€‚è€Œä¸‡ä¸€ Redisæ•°æ®æ²¡æœ‰å¾—åˆ°åŠæ—¶çš„æ›´æ–°ï¼ˆä¾‹å¦‚æ•°æ®åº“æ›´æ–°äº†æ²¡æ›´æ–°åˆ°Redisï¼‰ï¼Œå°±å‡ºç°äº†æ•°æ®ä¸ä¸€è‡´ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåªè¦ä½¿ç”¨äº†ç¼“å­˜ï¼Œå°±å¿…ç„¶ä¼šæœ‰ä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°ï¼Œåªæ˜¯è¯´è¿™ä¸ªä¸ä¸€è‡´çš„æ—¶é—´çª—å£æ˜¯å¦èƒ½åšåˆ°è¶³å¤Ÿçš„å°ã€‚æœ‰äº›ä¸åˆç†çš„è®¾è®¡å¯èƒ½ä¼šå¯¼è‡´æ•°æ®æŒç»­ä¸ä¸€è‡´ï¼Œè¿™æ˜¯æˆ‘ä»¬éœ€è¦æ”¹å–„è®¾è®¡å»é¿å…çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™é‡Œçš„ä¸€è‡´æ€§å®é™…ä¸Šå¯¹äºæœ¬åœ°ç¼“å­˜ä¹Ÿæ˜¯åŒç†çš„ï¼Œä¾‹å¦‚æ•°æ®åº“æ›´æ–°åæ²¡æœ‰åŠæ—¶æ›´æ–°æœ¬åœ°ç¼“å­˜ï¼Œä¹Ÿæ˜¯æœ‰ä¸€è‡´æ€§é—®é¢˜çš„ï¼Œä¸‹æ–‡ç»Ÿä¸€ä»¥Redisç¼“å­˜ä½œä¸ºå¼•å­è®²è¿°ï¼Œå®é™…ä¸Šå¤„ç†æœ¬åœ°ç¼“å­˜åŸç†åŸºæœ¬ä¸€è‡´ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;ï¼ˆä¸€ï¼‰ç¼“å­˜ä¸ä¸€è‡´æ€§æ— æ³•å®¢è§‚åœ°å®Œå…¨æ¶ˆç­&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸ºä»€ä¹ˆæˆ‘ä»¬å‡ ä¹æ²¡åŠæ³•åšåˆ°ç¼“å­˜å’Œæ•°æ®åº“ä¹‹é—´çš„å¼ºä¸€è‡´å‘¢ï¼Ÿ&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ•°æ®åº“æ›´æ–°å®ŒåæŠŠå¯¹åº”çš„æœ€æ–°æ•°æ®åŒæ­¥åˆ°ç¼“å­˜ä¸­ï¼Œä»¥ä¾¿åœ¨è¯»è¯·æ±‚çš„æ—¶å€™èƒ½è¯»åˆ°æ–°çš„æ•°æ®è€Œä¸æ˜¯æ—§çš„æ•°æ®ï¼ˆè„æ•°æ®ï¼‰ã€‚ä½†æ˜¯å¾ˆå¯æƒœï¼Œç”±äºæ•°æ®åº“å’Œ Redis ä¹‹é—´æ˜¯æ²¡æœ‰äº‹åŠ¡ä¿è¯çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•ç¡®ä¿å†™å…¥æ•°æ®åº“æˆåŠŸåï¼Œå†™å…¥ Redis ä¹Ÿæ˜¯ä¸€å®šæˆåŠŸçš„ï¼›å³ä¾¿ Redis å†™å…¥èƒ½æˆåŠŸï¼Œåœ¨æ•°æ®åº“å†™å…¥æˆåŠŸååˆ° Redis å†™å…¥æˆåŠŸå‰çš„è¿™æ®µæ—¶é—´é‡Œï¼ŒRedis æ•°æ®ä¹Ÿè‚¯å®šæ˜¯å’Œ MySQL ä¸ä¸€è‡´çš„ã€‚å¦‚ä¸‹ä¸¤å›¾æ‰€ç¤ºï¼š&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.7667844522968198&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDjuald3fWYEiaCKDZ84tTkAYBaG4SLicEcYuFT4O75icGgZSxuQjGVA7Xw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1132&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ— æ³•äº‹åŠ¡ä¿æŒä¸€è‡´&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥è¯´è¿™ä¸ªæ—¶é—´çª—å£æ˜¯æ²¡åŠæ³•å®Œå…¨æ¶ˆç­çš„ï¼Œé™¤éæˆ‘ä»¬ä»˜å‡ºæå¤§çš„ä»£ä»·ï¼Œä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡ç­‰å„ç§æ‰‹æ®µå»ç»´æŒå¼ºä¸€è‡´ï¼Œä½†æ˜¯è¿™æ ·ä¼šä½¿å¾—ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å¤§å¹…åº¦ä¸‹é™ï¼Œç”šè‡³æ¯”ä¸ç”¨ç¼“å­˜è¿˜æ…¢ï¼Œè¿™æ ·ä¸å°±ä¸æˆ‘ä»¬ä½¿ç”¨ç¼“å­˜çš„ç›®æ ‡èƒŒé“è€Œé©°äº†å—ï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;ä¸è¿‡è™½ç„¶æ— æ³•åšåˆ°å¼ºä¸€è‡´ï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½åšåˆ°çš„æ˜¯ç¼“å­˜ä¸æ•°æ®åº“è¾¾åˆ°æœ€ç»ˆä¸€è‡´ï¼Œè€Œä¸”ä¸ä¸€è‡´çš„æ—¶é—´çª—å£æˆ‘ä»¬èƒ½åšåˆ°å°½å¯èƒ½çŸ­ï¼ŒæŒ‰ç…§ç»éªŒæ¥è¯´ï¼Œå¦‚æœèƒ½å°†æ—¶é—´ä¼˜åŒ–åˆ° 1ms ä¹‹å†…ï¼Œè¿™ä¸ªä¸€è‡´æ€§é—®é¢˜å¸¦æ¥çš„å½±å“æˆ‘ä»¬å°±å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚&lt;/span&gt;&lt;/section&gt;&lt;/article&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.35962145110410093&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyD1629nYc12ZjrgVbH8d4qFjW8KGB7sicSVTfqM8rJiaZnMliaqQXHgzh3Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1268&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9Fl62j5eylelCcZwNOEv5HRg9xicSj2KIwvdQMPbwiau3eqyIUpKbjQ6nA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜çš„æ‰‹æ®µ&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;é€šå¸¸æƒ…å†µ&lt;/span&gt;&lt;span&gt;ä¸‹&lt;/span&gt;&lt;span&gt;ï¼Œ&lt;/span&gt;&lt;span&gt;æˆ‘ä»¬åœ¨&lt;/span&gt;&lt;span&gt;å¤„ç†æŸ¥è¯¢&lt;/span&gt;&lt;span&gt;è¯·æ±‚çš„&lt;/span&gt;&lt;span&gt;æ—¶å€™ï¼Œä½¿ç”¨ç¼“å­˜çš„é€»è¾‘å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt; = queryDataRedis(key);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt; ==&lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     &lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt; = queryDataMySQL(key); &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt;!=&lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;         updateRedis(key, &lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;article&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¹Ÿå°±æ˜¯è¯´ä¼˜å…ˆæŸ¥è¯¢ç¼“å­˜ï¼ŒæŸ¥è¯¢ä¸åˆ°æ‰æŸ¥è¯¢æ•°æ®åº“ã€‚å¦‚æœè¿™æ—¶å€™æ•°æ®åº“æŸ¥åˆ°æ•°æ®äº†ï¼Œå°±å°†ç¼“å­˜çš„æ•°æ®è¿›è¡Œæ›´æ–°ã€‚è¿™æ˜¯æˆ‘ä»¬å¸¸è¯´çš„cache asideçš„ç­–ç•¥ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ç­–ç•¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™æ ·çš„é€»è¾‘æ˜¯æ­£ç¡®çš„ï¼Œè€Œä¸€è‡´æ€§çš„é—®é¢˜ä¸€èˆ¬ä¸æ¥æºäºæ­¤ï¼Œè€Œæ˜¯å‡ºç°åœ¨å¤„ç†å†™è¯·æ±‚çš„æ—¶å€™ã€‚æ‰€ä»¥æˆ‘ä»¬ç®€åŒ–æˆæœ€ç®€å•çš„å†™è¯·æ±‚çš„é€»è¾‘ï¼Œæ­¤æ—¶ä½ å¯èƒ½ä¼šé¢ä¸´å¤šä¸ªé€‰æ‹©ï¼Œç©¶ç«Ÿæ˜¯ç›´æ¥æ›´æ–°ç¼“å­˜ï¼Œè¿˜æ˜¯å¤±æ•ˆç¼“å­˜ï¼Ÿè€Œæ— è®ºæ˜¯æ›´æ–°ç¼“å­˜è¿˜æ˜¯å¤±æ•ˆç¼“å­˜ï¼Œéƒ½å¯ä»¥é€‰æ‹©åœ¨æ›´æ–°æ•°æ®åº“ä¹‹å‰ï¼Œè¿˜æ˜¯ä¹‹åæ“ä½œã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;è¿™æ ·å°±æ¼”å˜å‡º 4 ä¸ªç­–ç•¥ï¼šæ›´æ–°æ•°æ®åº“åæ›´æ–°ç¼“å­˜ã€æ›´æ–°æ•°æ®åº“å‰æ›´æ–°ç¼“å­˜ã€æ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜ã€æ›´æ–°æ•°æ®åº“å‰åˆ é™¤ç¼“å­˜ã€‚ä¸‹é¢æˆ‘ä»¬æ¥åˆ†åˆ«è®²è¿°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;ï¼ˆä¸€ï¼‰æ›´æ–°æ•°æ®åº“åæ›´æ–°ç¼“å­˜çš„ä¸ä¸€è‡´é—®é¢˜&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸€ç§å¸¸è§çš„æ“ä½œæ˜¯ï¼Œè®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œè®©å†™è¯·æ±‚ä»¥æ•°æ®åº“ä¸ºå‡†ï¼Œè¿‡æœŸåï¼Œè¯»è¯·æ±‚åŒæ­¥æ•°æ®åº“ä¸­çš„æœ€æ–°æ•°æ®ç»™ç¼“å­˜ã€‚é‚£ä¹ˆåœ¨åŠ å…¥äº†è¿‡æœŸæ—¶é—´åï¼Œæ˜¯å¦å°±ä¸ä¼šæœ‰é—®é¢˜äº†å‘¢ï¼Ÿå¹¶ä¸æ˜¯è¿™æ ·ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¤§å®¶è®¾æƒ³ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å‡å¦‚è¿™é‡Œæœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼ŒæŠŠæ•°æ®åº“è‡ªå‡ 1ï¼ŒåŸå§‹æ•°æ®åº“æ•°æ®æ˜¯ 100ï¼ŒåŒæ—¶æœ‰ä¸¤ä¸ªå†™è¯·æ±‚ç”³è¯·è®¡æ•°å‡ä¸€ï¼Œå‡è®¾çº¿ç¨‹ A å…ˆå‡æ•°æ®åº“æˆåŠŸï¼Œçº¿ç¨‹ B åå‡æ•°æ®åº“æˆåŠŸã€‚é‚£ä¹ˆè¿™æ—¶å€™æ•°æ®åº“çš„å€¼æ˜¯ 98ï¼Œç¼“å­˜é‡Œæ­£ç¡®çš„å€¼åº”è¯¥ä¹Ÿè¦æ˜¯ 98ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä½†æ˜¯ç‰¹æ®Šåœºæ™¯ä¸‹ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹ A å’Œçº¿ç¨‹ B åŒæ—¶æ›´æ–°è¿™ä¸ªæ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“çš„é¡ºåºæ˜¯å…ˆ A å B&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜æ—¶é¡ºåºæ˜¯å…ˆ B å A&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¦‚æœæˆ‘ä»¬çš„ä»£ç é€»è¾‘è¿˜æ˜¯æ›´æ–°æ•°æ®åº“åç«‹åˆ»æ›´æ–°ç¼“å­˜çš„æ•°æ®ï¼Œé‚£ä¹ˆâ€”â€”&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;powershell&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateMySQL();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateRedis(key, &lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å°±å¯èƒ½å‡ºç°ï¼šæ•°æ®åº“çš„å€¼æ˜¯ 100-&amp;gt;99-&amp;gt;98ï¼Œä½†æ˜¯ç¼“å­˜çš„æ•°æ®å´æ˜¯ 100-&amp;gt;98-&amp;gt;99ï¼Œä¹Ÿå°±æ˜¯æ•°æ®åº“ä¸ç¼“å­˜çš„ä¸ä¸€è‡´ã€‚è€Œä¸”è¿™ä¸ªä¸ä¸€è‡´åªèƒ½ç­‰åˆ°ä¸‹ä¸€æ¬¡æ•°æ®åº“æ›´æ–°æˆ–è€…ç¼“å­˜å¤±æ•ˆæ‰å¯èƒ½ä¿®å¤ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table align=&quot;left&quot;&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Aï¼ˆå†™è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Bï¼ˆå†™è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“ä¸º99&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T2&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“ä¸º98&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜æ•°æ®ä¸º98&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T4&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜æ•°æ®ä¸º99&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;br/&gt;&lt;/td&gt;&lt;td align=&quot;left&quot; valign=&quot;top&quot;&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶ç¼“å­˜çš„å€¼è¢«æ˜¾å¼æ›´æ–°ä¸º99ï¼Œä½†æ˜¯å®é™…ä¸Šæ•°æ®åº“çš„å€¼å·²ç»æ˜¯98ï¼Œæ•°æ®ä¸ä¸€è‡´&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å½“ç„¶ï¼Œå¦‚æœæ›´æ–°Redisæœ¬èº«æ˜¯å¤±è´¥çš„è¯ï¼Œä¸¤è¾¹çš„å€¼å›ºç„¶ä¹Ÿæ˜¯ä¸ä¸€è‡´çš„ï¼Œè¿™ä¸ªå‰æ–‡ä¹Ÿé˜è¿°è¿‡ï¼Œå‡ ä¹æ— æ³•æ ¹é™¤ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/article&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.8894472361809045&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyD66JhRse8ousJOZCLKN0gU6g65uWeW0j6hLj2kZAbhPPL2Sibkhuialkg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;796&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;ï¼ˆäºŒï¼‰æ›´æ–°æ•°æ®åº“å‰æ›´æ–°ç¼“å­˜çš„ä¸ä¸€è‡´é—®é¢˜&lt;/span&gt;&lt;/p&gt;&lt;article&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£ä½ å¯èƒ½ä¼šæƒ³ï¼Œè¿™æ˜¯å¦è¡¨ç¤ºï¼Œæˆ‘åº”è¯¥å…ˆè®©ç¼“å­˜æ›´æ–°ï¼Œä¹‹åå†å»æ›´æ–°æ•°æ®åº“å‘¢ï¼Ÿç±»ä¼¼è¿™æ ·ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateRedis(key, &lt;span class=&quot;code-snippet__keyword&quot;&gt;data&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateMySQL();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;pre&gt;&lt;br/&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;è¿™æ ·æ“ä½œäº§ç”Ÿçš„é—®é¢˜æ›´æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•ä¿è¯æ•°æ®åº“çš„æ›´æ–°æˆåŠŸï¼Œä¸‡ä¸€æ•°æ®åº“æ›´æ–°å¤±è´¥äº†ï¼Œä½ ç¼“å­˜çš„æ•°æ®å°±ä¸åªæ˜¯è„æ•°æ®ï¼Œè€Œæ˜¯é”™è¯¯æ•°æ®äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/article&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.9209876543209876&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDMHedlaqeQDJxkNhtVUWWvEE1vWibcbEFhUvwbvxjUCqp2kVVdNTXC8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;810&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;ä½ å¯èƒ½ä¼šæƒ³ï¼Œæ˜¯å¦æˆ‘åœ¨æ›´æ–°æ•°æ®åº“å¤±è´¥çš„æ—¶å€™åš Redis å›æ»šçš„æ“ä½œèƒ½å¤Ÿè§£å†³å‘¢ï¼Ÿè¿™å…¶å®ä¹Ÿæ˜¯ä¸é è°±çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¹Ÿä¸èƒ½ä¿è¯è¿™ä¸ªå›æ»šçš„æ“ä½œ 100% è¢«æˆåŠŸæ‰§è¡Œã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;åŒæ—¶ï¼Œåœ¨å†™å†™å¹¶å‘çš„åœºæ™¯ä¸‹ï¼ŒåŒæ ·æœ‰ç±»ä¼¼çš„ä¸€è‡´æ€§é—®é¢˜&lt;/span&gt;&lt;span&gt;ï¼Œè¯·çœ‹ä»¥ä¸‹æƒ…å†µï¼š&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;article&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹ A å’Œçº¿ç¨‹ B åŒæ—¶æ›´æ–°åŒè¿™ä¸ªæ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜çš„é¡ºåºæ˜¯å…ˆ A å B&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“çš„é¡ºåºæ˜¯å…ˆ B å A&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸¾ä¸ªä¾‹å­ã€‚çº¿ç¨‹ A å¸Œæœ›æŠŠè®¡æ•°å™¨ç½®ä¸º 0ï¼Œçº¿ç¨‹ B å¸Œæœ›ç½®ä¸º 1ã€‚è€ŒæŒ‰ç…§ä»¥ä¸Šåœºæ™¯ï¼Œç¼“å­˜ç¡®å®è¢«è®¾ç½®ä¸º 1ï¼Œä½†æ•°æ®åº“å´è¢«è®¾ç½®ä¸º 0ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Aï¼ˆå†™è¯·&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Bï¼ˆå†™è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜ä¸º0&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T2&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜ä¸º1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“ä¸º1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T4&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“æ•°æ®ä¸º0&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶ç¼“å­˜çš„å€¼è¢«æ˜¾å¼æ›´æ–°ä¸º1ï¼Œä½†æ˜¯å®é™…ä¸Šæ•°æ®åº“çš„å€¼æ˜¯0ï¼Œæ•°æ®ä¸ä¸€è‡´&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥é€šå¸¸æƒ…å†µä¸‹ï¼Œæ›´æ–°ç¼“å­˜å†æ›´æ–°æ•°æ®åº“æ˜¯æˆ‘ä»¬åº”è¯¥é¿å…ä½¿ç”¨çš„ä¸€ç§æ‰‹æ®µã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;br/&gt;&lt;h1&gt;&lt;span&gt;ï¼ˆä¸‰ï¼‰æ›´æ–°æ•°æ®åº“å‰åˆ é™¤ç¼“å­˜çš„é—®é¢˜&lt;/span&gt;&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£å¦‚æœé‡‡å–åˆ é™¤ç¼“å­˜çš„ç­–ç•¥å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åœ¨æ›´æ–°æ•°æ®åº“çš„æ—¶å€™å¤±æ•ˆå¯¹åº”çš„ç¼“å­˜ï¼Œè®©ç¼“å­˜åœ¨ä¸‹æ¬¡è§¦å‘è¯»è¯·æ±‚æ—¶è¿›è¡Œæ›´æ–°ï¼Œæ˜¯å¦ä¼šæ›´å¥½å‘¢ï¼ŸåŒæ ·åœ°ï¼Œé’ˆå¯¹åœ¨æ›´æ–°æ•°æ®åº“å‰å’Œæ•°æ®åº“åè¿™ä¸¤ä¸ªåˆ é™¤æ—¶æœºï¼Œæˆ‘ä»¬æ¥æ¯”è¾ƒä¸‹å…¶å·®å¼‚ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æœ€ç›´è§‚çš„åšæ³•ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå…ˆè®©ç¼“å­˜å¤±æ•ˆï¼Œç„¶åå»æ›´æ–°æ•°æ®åº“ï¼Œä»£ç é€»è¾‘å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;deleteRedis(key);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateMySQL();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™æ ·çš„é€»è¾‘çœ‹ä¼¼æ²¡æœ‰é—®é¢˜ï¼Œæ¯•ç«Ÿåˆ é™¤ç¼“å­˜åå³ä¾¿æ•°æ®åº“æ›´æ–°å¤±è´¥äº†ï¼Œä¹Ÿåªæ˜¯ç¼“å­˜ä¸Šæ²¡æœ‰æ•°æ®è€Œå·²ã€‚ç„¶åå¹¶å‘ä¸¤ä¸ªå†™è¯·æ±‚è¿‡æ¥ï¼Œæ— è®ºæ€ä¹ˆæ ·çš„æ‰§è¡Œé¡ºåºï¼Œç¼“å­˜æœ€åçš„å€¼ä¹Ÿéƒ½æ˜¯ä¼šè¢«åˆ é™¤çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¹¶å‘å†™å†™çš„è¯·æ±‚ä¸‹è¿™æ ·çš„å¤„ç†æ˜¯æ²¡é—®é¢˜çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç„¶è€Œï¼Œè¿™ç§å¤„ç†åœ¨è¯»å†™å¹¶å‘çš„åœºæ™¯ä¸‹å´å­˜åœ¨ç€éšæ‚£ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿˜æ˜¯åˆšåˆšæ›´æ–°è®¡æ•°çš„ä¾‹å­ã€‚ä¾‹å¦‚ç°åœ¨ç¼“å­˜çš„æ•°æ®æ˜¯ 100ï¼Œæ•°æ®åº“ä¹Ÿæ˜¯ 100ï¼Œè¿™æ—¶å€™éœ€è¦å¯¹æ­¤è®¡æ•°å‡ 1ï¼Œå‡æˆåŠŸåï¼Œæ•°æ®åº“åº”è¯¥æ˜¯ 99ã€‚å¦‚æœè¿™ä¹‹åè§¦å‘è¯»è¯·æ±‚ï¼Œç¼“å­˜å¦‚æœæœ‰æ•ˆçš„è¯ï¼Œé‡Œé¢åº”è¯¥ä¹Ÿè¦è¢«æ›´æ–°ä¸º 99 æ‰æ˜¯æ­£ç¡®çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£ä¹ˆæ€è€ƒä¸‹è¿™æ ·çš„è¯·æ±‚æƒ…å†µï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹ A æ›´æ–°è¿™ä¸ªæ•°æ®çš„åŒæ—¶ï¼Œçº¿ç¨‹ B è¯»å–è¿™ä¸ªæ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹ A æˆåŠŸåˆ é™¤äº†ç¼“å­˜é‡Œçš„è€æ•°æ®ï¼Œè¿™æ—¶å€™çº¿ç¨‹ B æŸ¥è¯¢æ•°æ®å‘ç°ç¼“å­˜å¤±æ•ˆ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹ A æ›´æ–°æ•°æ®åº“æˆåŠŸ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Aï¼ˆå†™è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Bï¼ˆè¯»è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç¼“å­˜å€¼&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T2&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;1.è¯»å–ç¼“å­˜æ•°æ®ï¼Œç¼“å­˜ç¼ºå¤±ï¼Œä»æ•°æ®åº“è¯»å–æ•°æ®100&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®Xçš„å€¼ä¸º99&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T4&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å°†æ•°æ®100çš„å€¼å†™å…¥ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶ç¼“å­˜çš„å€¼è¢«æ˜¾å¼æ›´æ–°ä¸º100ï¼Œä½†æ˜¯å®é™…ä¸Šæ•°æ®åº“çš„å€¼å·²ç»æ˜¯99äº†&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¯»å†™å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œä¸€æ ·ä¼šæœ‰ä¸ä¸€è‡´çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é’ˆå¯¹è¿™ç§åœºæ™¯ï¼Œæœ‰ä¸ªåšæ³•æ˜¯æ‰€è°“çš„â€œå»¶è¿ŸåŒåˆ ç­–ç•¥â€ï¼Œå°±æ˜¯è¯´ï¼Œæ—¢ç„¶å¯èƒ½å› ä¸ºè¯»è¯·æ±‚æŠŠä¸€ä¸ªæ—§çš„å€¼åˆå†™å›å»ï¼Œé‚£ä¹ˆæˆ‘åœ¨å†™è¯·æ±‚å¤„ç†å®Œä¹‹åï¼Œç­‰åˆ°å·®ä¸å¤šçš„æ—¶é—´å»¶è¿Ÿå†é‡æ–°åˆ é™¤è¿™ä¸ªç¼“å­˜å€¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Aï¼ˆå†™è¯·æ±‚&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Cï¼ˆæ–°çš„è¯»è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Dï¼ˆæ–°çš„è¯»è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T5&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;sleep(N)&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;ç¼“å­˜å­˜åœ¨ï¼Œè¯»å–åˆ°ç¼“å­˜æ—§å€¼100&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å…¶ä»–çº¿ç¨‹å¯èƒ½åœ¨åŒåˆ æˆåŠŸå‰è¯»åˆ°è„æ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T6&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç¼“å­˜å€¼&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T7&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;ç¼“å­˜ç¼ºå¤±ï¼Œä»æ•°æ®åº“è¯»å–æ•°æ®çš„æœ€æ–°å€¼ï¼ˆ99ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™ç§è§£å†³æ€è·¯çš„å…³é”®åœ¨äºå¯¹ N çš„æ—¶é—´çš„åˆ¤æ–­ï¼Œå¦‚æœ N æ—¶é—´å¤ªçŸ­ï¼Œçº¿ç¨‹ A ç¬¬äºŒæ¬¡åˆ é™¤ç¼“å­˜çš„æ—¶é—´ä¾æ—§æ—©äºçº¿ç¨‹ B æŠŠè„æ•°æ®å†™å›ç¼“å­˜çš„æ—¶é—´ï¼Œé‚£ä¹ˆç›¸å½“äºåšäº†æ— ç”¨åŠŸã€‚è€Œ N å¦‚æœè®¾ç½®å¾—å¤ªé•¿ï¼Œé‚£ä¹ˆåœ¨è§¦å‘åŒåˆ ä¹‹å‰ï¼Œæ–°è¯·æ±‚çœ‹åˆ°çš„éƒ½æ˜¯è„æ•°æ®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;ï¼ˆå››ï¼‰æ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£å¦‚æœæˆ‘ä»¬æŠŠæ›´æ–°æ•°æ®åº“æ”¾åœ¨åˆ é™¤ç¼“å­˜ä¹‹å‰å‘¢ï¼Œé—®é¢˜æ˜¯å¦è§£å†³ï¼Ÿæˆ‘ä»¬ç»§ç»­ä»è¯»å†™å¹¶å‘çš„åœºæ™¯çœ‹ä¸‹å»ï¼Œæœ‰æ²¡æœ‰ç±»ä¼¼çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Aï¼ˆå†™è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Bï¼ˆè¯»è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Cï¼ˆè¯»è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ½œåœ¨é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ä¸»åº“ X = 99ï¼ˆåŸå€¼ X = 100ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T2&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;è¯»å–æ•°æ®ï¼ŒæŸ¥è¯¢åˆ°ç¼“å­˜è¿˜æœ‰æ•°æ®ï¼Œè¿”å›100&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹Cå®é™…ä¸Šè¯»å–åˆ°äº†å’Œæ•°æ®åº“ä¸ä¸€è‡´çš„æ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T4&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æŸ¥è¯¢ç¼“å­˜ï¼Œç¼“å­˜ç¼ºå¤±ï¼ŒæŸ¥è¯¢æ•°æ®åº“å¾—åˆ°å½“å‰å€¼99&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T5&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å°†&lt;/span&gt;&lt;span&gt;99å†™å…¥ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¯ä»¥çœ‹åˆ°ï¼Œå¤§ä½“ä¸Šï¼Œé‡‡å–å…ˆæ›´æ–°æ•°æ®åº“å†åˆ é™¤ç¼“å­˜çš„ç­–ç•¥æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä»…åœ¨æ›´æ–°æ•°æ®åº“æˆåŠŸåˆ°ç¼“å­˜åˆ é™¤ä¹‹é—´çš„æ—¶é—´å·®å†…â€”â€”[T2,T3)çš„çª—å£ ï¼Œå¯èƒ½ä¼šè¢«åˆ«çš„çº¿ç¨‹è¯»å–åˆ°è€å€¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œåœ¨å¼€ç¯‡çš„æ—¶å€™æˆ‘ä»¬è¯´è¿‡ï¼Œç¼“å­˜ä¸ä¸€è‡´æ€§çš„é—®é¢˜æ— æ³•åœ¨å®¢è§‚ä¸Šå®Œå…¨æ¶ˆç­ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•ä¿è¯æ•°æ®åº“å’Œç¼“å­˜çš„æ“ä½œæ˜¯ä¸€ä¸ªäº‹åŠ¡é‡Œçš„ï¼Œè€Œæˆ‘ä»¬èƒ½åšåˆ°çš„åªæ˜¯å°½é‡ç¼©çŸ­ä¸ä¸€è‡´çš„æ—¶é—´çª—å£ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åœ¨æ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œä¸ä¸€è‡´çª—å£ä»…ä»…æ˜¯ T2 åˆ° T3 çš„æ—¶é—´ï¼Œå†…ç½‘çŠ¶æ€ä¸‹é€šå¸¸ä¸è¿‡ 1msï¼Œåœ¨å¤§éƒ¨åˆ†ä¸šåŠ¡åœºæ™¯ä¸‹æˆ‘ä»¬éƒ½å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚å› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚å¾ˆéš¾èƒ½å†1mså†…å¿«é€Ÿå‘èµ·ç¬¬äºŒæ¬¡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä½†æ˜¯çœŸå®åœºæ™¯ä¸‹ï¼Œè¿˜æ˜¯ä¼šæœ‰ä¸€ä¸ªæƒ…å†µå­˜åœ¨ä¸ä¸€è‡´çš„å¯èƒ½æ€§ï¼Œè¿™ä¸ªåœºæ™¯æ˜¯è¯»çº¿ç¨‹å‘ç°ç¼“å­˜ä¸å­˜åœ¨ï¼Œäºæ˜¯è¯»å†™å¹¶å‘æ—¶ï¼Œè¯»çº¿ç¨‹å›å†™è¿›å»è€å€¼ã€‚å¹¶å‘æƒ…å†µå¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Aï¼ˆå†™è¯·æ±‚ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;çº¿ç¨‹Bï¼ˆè¯»è¯·æ±‚--ç¼“å­˜ä¸å­˜åœ¨åœºæ™¯ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ½œåœ¨é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T1&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æŸ¥è¯¢ç¼“å­˜ï¼Œç¼“å­˜ç¼ºå¤±ï¼ŒæŸ¥è¯¢æ•°æ®åº“å¾—åˆ°å½“å‰å€¼100&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T2&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ä¸»åº“ X = 99ï¼ˆåŸå€¼ X = 100ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T3&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;T4&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;br/&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å°†100å†™å…¥ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶ç¼“å­˜çš„å€¼è¢«æ˜¾å¼æ›´æ–°ä¸º100ï¼Œä½†æ˜¯å®é™…ä¸Šæ•°æ®åº“çš„å€¼å·²ç»æ˜¯99äº†&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªä¸ä¸€è‡´åœºæ™¯å‡ºç°æ¡ä»¶éå¸¸ä¸¥æ ¼ï¼Œå› ä¸ºå¹¶å‘é‡å¾ˆå¤§æ—¶ï¼Œç¼“å­˜ä¸å¤ªå¯èƒ½ä¸å­˜åœ¨ï¼›å¦‚æœå¹¶å‘å¾ˆå¤§ï¼Œè€Œç¼“å­˜çœŸçš„ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯è¿™æ—¶çš„å†™åœºæ™¯å¾ˆå¤šï¼Œå› ä¸ºå†™åœºæ™¯ä¼šåˆ é™¤ç¼“å­˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥å¾…ä¼šæˆ‘ä»¬ä¼šæåˆ°ï¼Œå†™åœºæ™¯å¾ˆå¤šæ—¶å€™å®é™…ä¸Šå¹¶ä¸é€‚åˆé‡‡å–åˆ é™¤ç­–ç•¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;ï¼ˆäº”ï¼‰æ€»ç»“å››ç§æ›´æ–°ç­–ç•¥&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç»ˆä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯¹æ¯”äº†å››ä¸ªæ›´æ–°ç¼“å­˜çš„æ‰‹æ®µï¼Œåšä¸€ä¸ªæ€»ç»“å¯¹æ¯”ï¼Œå…¶ä¸­åº”å¯¹æ–¹æ¡ˆä¹Ÿæä¾›å‚è€ƒï¼Œå…·ä½“ä¸åšå±•å¼€ï¼Œå¦‚ä¸‹è¡¨ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;ç­–ç•¥&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;å¹¶å‘åœºæ™¯&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;æ½œåœ¨é—®é¢˜&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;åº”å¯¹æ–¹æ¡ˆ&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td rowspan=&quot;2&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“+æ›´æ–°ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™+è¯»&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹Aæœªæ›´æ–°å®Œç¼“å­˜ä¹‹å‰ï¼Œçº¿ç¨‹Bçš„è¯»è¯·æ±‚ä¼šçŸ­æš‚è¯»åˆ°æ—§å€¼&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å¯ä»¥å¿½ç•¥&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™+å†™&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“çš„é¡ºåºæ˜¯å…ˆAåBï¼Œä½†æ›´æ–°ç¼“å­˜æ—¶é¡ºåºæ˜¯å…ˆBåAï¼Œæ•°æ®åº“å’Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ†å¸ƒå¼é”ï¼ˆæ“ä½œé‡ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td rowspan=&quot;2&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜+æ›´æ–°æ•°æ®åº“&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ— å¹¶å‘&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹Aè¿˜æœªæ›´æ–°å®Œç¼“å­˜ä½†æ˜¯æ›´æ–°æ•°æ®åº“å¯èƒ½å¤±è´¥&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ©ç”¨MQç¡®è®¤æ•°æ®åº“æ›´æ–°æˆåŠŸï¼ˆè¾ƒå¤æ‚ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™+å†™&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ç¼“å­˜çš„é¡ºåºæ˜¯å…ˆAåBï¼Œä½†æ›´æ–°æ•°æ®åº“æ—¶é¡ºåºæ˜¯å…ˆBåA&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ†å¸ƒå¼é”ï¼ˆæ“ä½œå¾ˆé‡ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç¼“å­˜å€¼+æ›´æ–°æ•°æ®åº“&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™+è¯»&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™è¯·æ±‚çš„çº¿ç¨‹Aåˆ é™¤äº†ç¼“å­˜åœ¨æ›´æ–°æ•°æ®åº“ä¹‹å‰ï¼Œè¿™æ—¶å€™è¯»è¯·æ±‚çº¿ç¨‹Båˆ°æ¥ï¼Œå› ä¸ºç¼“å­˜ç¼ºå¤±ï¼Œåˆ™æŠŠå½“å‰æ•°æ®è¯»å–å‡ºæ¥æ”¾åˆ°ç¼“å­˜ï¼Œè€Œåçº¿ç¨‹Aæ›´æ–°æˆåŠŸäº†æ•°æ®åº“&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å»¶è¿ŸåŒåˆ ï¼ˆä½†æ˜¯å»¶è¿Ÿçš„æ—¶é—´ä¸å¥½ä¼°è®¡ï¼Œä¸”å»¶è¿Ÿçš„è¿‡ç¨‹ä¸­ä¾æ—§æœ‰ä¸ä¸€è‡´çš„æ—¶é—´çª—å£ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td rowspan=&quot;2&quot;&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°æ•°æ®åº“+åˆ é™¤ç¼“å­˜å€¼&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™+è¯»ï¼ˆç¼“å­˜å‘½ä¸­ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;çº¿ç¨‹Aå®Œæˆæ•°æ®åº“æ›´æ–°æˆåŠŸåï¼Œå°šæœªåˆ é™¤ç¼“å­˜ï¼Œçº¿ç¨‹Bæœ‰å¹¶å‘è¯»è¯·æ±‚ä¼šè¯»åˆ°æ—§çš„è„æ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å¯ä»¥å¿½ç•¥&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;å†™+è¯»ï¼ˆç¼“å­˜ä¸å‘½ä¸­ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;è¯»è¯·æ±‚ä¸å‘½ä¸­ç¼“å­˜ï¼Œå†™è¯·æ±‚å¤„ç†å®Œä¹‹åè¯»è¯·æ±‚æ‰å›å†™ç¼“å­˜ï¼Œæ­¤æ—¶ç¼“å­˜ä¸ä¸€è‡´&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;td&gt;&lt;p&gt;&lt;span&gt;åˆ†å¸ƒå¼é”ï¼ˆæ“ä½œé‡ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä»ä¸€è‡´æ€§çš„è§’åº¦æ¥çœ‹ï¼Œé‡‡å–æ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜å€¼ï¼Œæ˜¯æ›´ä¸ºé€‚åˆçš„ç­–ç•¥ã€‚å› ä¸ºå‡ºç°ä¸ä¸€è‡´çš„åœºæ™¯çš„æ¡ä»¶æ›´ä¸ºè‹›åˆ»ï¼Œæ¦‚ç‡ç›¸æ¯”å…¶ä»–æ–¹æ¡ˆæ›´ä½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£ä¹ˆæ˜¯å¦æ›´æ–°ç¼“å­˜è¿™ä¸ªç­–ç•¥å°±ä¸€æ— æ˜¯å¤„å‘¢ï¼Ÿä¸æ˜¯çš„ï¼&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç¼“å­˜å€¼æ„å‘³ç€å¯¹åº”çš„ key ä¼šå¤±æ•ˆï¼Œé‚£ä¹ˆè¿™æ—¶å€™è¯»è¯·æ±‚éƒ½ä¼šæ‰“åˆ°æ•°æ®åº“ã€‚å¦‚æœè¿™ä¸ªæ•°æ®çš„å†™æ“ä½œéå¸¸é¢‘ç¹ï¼Œå°±ä¼šå¯¼è‡´ç¼“å­˜çš„ä½œç”¨å˜å¾—éå¸¸å°ã€‚è€Œå¦‚æœè¿™æ—¶å€™æŸäº› Key è¿˜æ˜¯éå¸¸å¤§çš„çƒ­ keyï¼Œå°±å¯èƒ½å› ä¸ºæ‰›ä¸ä½æ•°æ®é‡è€Œå¯¼è‡´ç³»ç»Ÿä¸å¯ç”¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.3665943600867679&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDE1oYyJic1e5ibyWB7rntUV6wtTZhSiao8YMRKXexSzjyo1aMz8L50Sib4Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1844&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ç­–ç•¥é¢‘ç¹çš„ç¼“å­˜å¤±æ•ˆå¯¼è‡´è¯»è¯·æ±‚æ— æ³•åˆ©ç”¨ç¼“å­˜&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥åšä¸ªç®€å•æ€»ç»“ï¼Œè¶³ä»¥é€‚åº”ç»å¤§éƒ¨åˆ†çš„äº’è”ç½‘å¼€å‘åœºæ™¯çš„å†³ç­–ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é’ˆå¯¹å¤§éƒ¨åˆ†è¯»å¤šå†™å°‘åœºæ™¯ï¼Œå»ºè®®é€‰æ‹©æ›´æ–°æ•°æ®åº“ååˆ é™¤ç¼“å­˜çš„ç­–ç•¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é’ˆå¯¹è¯»å†™ç›¸å½“æˆ–è€…å†™å¤šè¯»å°‘çš„åœºæ™¯ï¼Œå»ºè®®é€‰æ‹©æ›´æ–°æ•°æ®åº“åæ›´æ–°ç¼“å­˜çš„ç­–ç•¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h1&gt;&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9FPB6mZB01WGXHsGUE2UYENHAJNeKa8y0qwiajZdfHR5lvk4rjnrQabwg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;æœ€ç»ˆä¸€è‡´æ€§å¦‚ä½•ä¿è¯ï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç¼“å­˜è®¾ç½®è¿‡æœŸæ—¶é—´&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ç¬¬ä¸€ä¸ªæ–¹æ³•ä¾¿æ˜¯æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ï¼Œå½“æˆ‘ä»¬æ— æ³•ç¡®å®š MySQL æ›´æ–°å®Œæˆåï¼Œç¼“å­˜çš„æ›´æ–°/åˆ é™¤ä¸€å®šèƒ½æˆåŠŸï¼Œä¾‹å¦‚ Redis æŒ‚äº†å¯¼è‡´å†™å…¥å¤±è´¥äº†ï¼Œæˆ–è€…å½“æ—¶ç½‘ç»œå‡ºç°æ•…éšœï¼Œæ›´å¸¸è§çš„æ˜¯æœåŠ¡å½“æ—¶åˆšå¥½å‘ç”Ÿé‡å¯äº†ï¼Œæ²¡æœ‰æ‰§è¡Œè¿™ä¸€æ­¥çš„ä»£ç ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;è¿™äº›æ—¶å€™ MySQL çš„æ•°æ®å°±æ— æ³•åˆ·åˆ° Redis äº†ã€‚ä¸ºäº†é¿å…è¿™ç§ä¸ä¸€è‡´æ€§æ°¸ä¹…å­˜åœ¨ï¼Œä½¿ç”¨ç¼“å­˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¿…é¡»è¦ç»™ç¼“å­˜è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´ï¼Œä¾‹å¦‚ 1 åˆ†é’Ÿï¼Œè¿™æ ·å³ä½¿å‡ºç°äº†æ›´æ–° Redis å¤±è´¥çš„æç«¯åœºæ™¯ï¼Œä¸ä¸€è‡´çš„æ—¶é—´çª—å£æœ€å¤šä¹Ÿåªæ˜¯ 1 åˆ†é’Ÿã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;è¿™æ˜¯æˆ‘ä»¬æœ€ç»ˆä¸€è‡´æ€§çš„å…œåº•æ–¹æ¡ˆï¼Œä¸‡ä¸€å‡ºç°ä»»ä½•æƒ…å†µçš„ä¸ä¸€è‡´é—®é¢˜ï¼Œæœ€åéƒ½èƒ½é€šè¿‡ç¼“å­˜å¤±æ•ˆåé‡æ–°æŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå›å†™åˆ°ç¼“å­˜ï¼Œæ¥åšåˆ°ç¼“å­˜ä¸æ•°æ®åº“çš„æœ€ç»ˆä¸€è‡´ã€‚&lt;/span&gt;&lt;/section&gt;&lt;h1&gt;&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9F9gEWETfj769ZEnnF4YHYbm1UBFpYldG1ibl6E9owa0M3yRB40WtEqLg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;å¦‚ä½•å‡å°‘ç¼“å­˜åˆ é™¤/æ›´æ–°çš„å¤±è´¥ï¼Ÿ&lt;/span&gt;&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸‡ä¸€åˆ é™¤ç¼“å­˜è¿™ä¸€æ­¥å› ä¸ºæœåŠ¡é‡å¯æ²¡æœ‰æ‰§è¡Œï¼Œæˆ–è€… Redis ä¸´æ—¶ä¸å¯ç”¨å¯¼è‡´åˆ é™¤ç¼“å­˜å¤±è´¥äº†ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªè¾ƒé•¿çš„æ—¶é—´ï¼ˆç¼“å­˜çš„å‰©ä½™è¿‡æœŸæ—¶é—´ï¼‰æ˜¯æ•°æ®ä¸ä¸€è‡´çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£æˆ‘ä»¬æœ‰æ²¡æœ‰ä»€ä¹ˆæ‰‹æ®µæ¥å‡å°‘è¿™ç§ä¸ä¸€è‡´çš„æƒ…å†µå‡ºç°å‘¢ï¼Ÿè¿™æ—¶å€™å€ŸåŠ©ä¸€ä¸ªå¯é çš„æ¶ˆæ¯ä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å› ä¸ºæ¶ˆæ¯ä¸­é—´ä»¶æœ‰ ATLEAST-ONCE çš„æœºåˆ¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.8088803088803089&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDbhKBOIj2FNXuTYicyU1K5jITpzSkTrpKv19YcPzj1XPwPWrU6ZdmGWg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1036&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æˆ‘ä»¬æŠŠåˆ é™¤ Redis çš„è¯·æ±‚ä»¥æ¶ˆè´¹ MQ æ¶ˆæ¯çš„æ‰‹æ®µå»å¤±æ•ˆå¯¹åº”çš„ Key å€¼ï¼Œå¦‚æœ Redis çœŸçš„å­˜åœ¨å¼‚å¸¸å¯¼è‡´æ— æ³•åˆ é™¤æˆåŠŸï¼Œæˆ‘ä»¬ä¾æ—§å¯ä»¥ä¾é  MQ çš„é‡è¯•æœºåˆ¶æ¥è®©æœ€ç»ˆ Redis å¯¹åº”çš„ Key å¤±æ•ˆã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œä½ ä»¬æˆ–è®¸ä¼šé—®ï¼Œæç«¯åœºæ™¯ä¸‹ï¼Œæ˜¯å¦å­˜åœ¨æ›´æ–°æ•°æ®åº“å MQ æ¶ˆæ¯æ²¡å‘é€æˆåŠŸï¼Œæˆ–è€…æ²¡æœºä¼šå‘é€å‡ºå»æœºå™¨å°±é‡å¯çš„æƒ…å†µï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;è¿™ä¸ªåœºæ™¯çš„ç¡®æ¯”è¾ƒéº»çƒ¦ï¼Œå¦‚æœ MQ ä½¿ç”¨çš„æ˜¯ RocketMQï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ© RocketMQ çš„äº‹åŠ¡æ¶ˆæ¯ï¼Œæ¥è®©åˆ é™¤ç¼“å­˜çš„æ¶ˆæ¯æœ€ç»ˆä¸€å®šå‘é€å‡ºå»ã€‚è€Œå¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ RocketMQï¼Œæˆ–è€…ä½ ä½¿ç”¨çš„æ¶ˆæ¯ä¸­é—´ä»¶å¹¶æ²¡æœ‰äº‹åŠ¡æ¶ˆæ¯çš„ç‰¹æ€§ï¼Œåˆ™å¯ä»¥é‡‡å–æ¶ˆæ¯è¡¨çš„æ–¹å¼è®©æ›´æ–°æ•°æ®åº“å’Œå‘é€æ¶ˆæ¯ä¸€èµ·æˆåŠŸã€‚äº‹å®ä¸Šè¿™ä¸ªè¯é¢˜æ¯”è¾ƒå¤§äº†ï¼Œæˆ‘ä»¬ä¸åœ¨è¿™é‡Œå±•å¼€ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9FibDz8VdeMtTPP6QGg7Qg03rhEzsPz8nRZlEVnmBdT96EyJFHfMz0iavQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;å¦‚ä½•å¤„ç†å¤æ‚çš„å¤šç¼“å­˜åœºæ™¯ï¼Ÿ&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æœ‰äº›æ—¶å€™ï¼ŒçœŸå®çš„ç¼“å­˜åœºæ™¯å¹¶ä¸æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè®°å½•å¯¹åº”ä¸€ä¸ª Key è¿™ä¹ˆç®€å•ï¼Œæœ‰å¯èƒ½ä¸€ä¸ªæ•°æ®åº“è®°å½•çš„æ›´æ–°ä¼šç‰µæ‰¯åˆ°å¤šä¸ª Key çš„æ›´æ–°ã€‚è¿˜æœ‰å¦å¤–ä¸€ä¸ªåœºæ™¯æ˜¯ï¼Œæ›´æ–°ä¸åŒçš„æ•°æ®åº“çš„è®°å½•æ—¶å¯èƒ½éœ€è¦æ›´æ–°åŒä¸€ä¸ª Key å€¼ï¼Œè¿™å¸¸è§äºä¸€äº› App é¦–é¡µæ•°æ®çš„ç¼“å­˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æˆ‘ä»¬ä»¥ä¸€ä¸ªæ•°æ®åº“è®°å½•å¯¹åº”å¤šä¸ª Key çš„åœºæ™¯æ¥ä¸¾ä¾‹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å‡å¦‚ç³»ç»Ÿè®¾è®¡ä¸Šæˆ‘ä»¬ç¼“å­˜äº†ä¸€ä¸ªç²‰ä¸çš„ä¸»é¡µä¿¡æ¯ã€ä¸»æ’­æ‰“èµæ¦œ TOP10 çš„ç²‰ä¸ã€å•æ—¥ TOP 100 çš„ç²‰ä¸ç­‰å¤šä¸ªä¿¡æ¯ã€‚å¦‚æœè¿™ä¸ªç²‰ä¸æ³¨é”€äº†ï¼Œæˆ–è€…è¿™ä¸ªç²‰ä¸è§¦å‘äº†æ‰“èµçš„è¡Œä¸ºï¼Œä¸Šé¢å¤šä¸ª Key å¯èƒ½éƒ½éœ€è¦æ›´æ–°ã€‚åªæ˜¯ä¸€ä¸ªæ‰“èµçš„è®°å½•ï¼Œä½ å¯èƒ½å°±è¦åšï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateMySQL();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;deleteRedisKey1();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;updateRedisKey2();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;deleteRedisKey3();&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;pre&gt;&lt;br/&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;è¿™å°±æ¶‰åŠå¤šä¸ª Redis çš„æ“ä½œï¼Œæ¯ä¸€æ­¥éƒ½å¯èƒ½å¤±è´¥ï¼Œå½±å“åˆ°åé¢çš„æ›´æ–°ã€‚ç”šè‡³ä»ç³»ç»Ÿè®¾è®¡ä¸Šï¼Œæ›´æ–°æ•°æ®åº“å¯èƒ½æ˜¯å•ç‹¬çš„ä¸€ä¸ªæœåŠ¡ï¼Œè€Œè¿™å‡ ä¸ªä¸åŒçš„ Key çš„ç¼“å­˜ç»´æŠ¤å´åœ¨ä¸åŒçš„ 3 ä¸ªå¾®æœåŠ¡ä¸­ï¼Œè¿™å°±å¤§å¤§å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦å’Œæé«˜äº†ç¼“å­˜æ“ä½œå¤±è´¥çš„å¯èƒ½æ€§ã€‚æœ€å¯æ€•çš„æ˜¯ï¼Œæ“ä½œæ›´æ–°è®°å½•çš„åœ°æ–¹å¾ˆå¤§æ¦‚ç‡ä¸åªåœ¨ä¸€ä¸ªä¸šåŠ¡é€»è¾‘ä¸­ï¼Œè€Œæ˜¯æ•£å‘åœ¨ç³»ç»Ÿå„ä¸ªé›¶æ•£çš„ä½ç½®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é’ˆå¯¹è¿™ä¸ªåœºæ™¯ï¼Œè§£å†³æ–¹æ¡ˆå’Œä¸Šæ–‡æåˆ°çš„ä¿è¯æœ€ç»ˆä¸€è‡´æ€§çš„æ“ä½œä¸€æ ·ï¼Œå°±æ˜¯æŠŠæ›´æ–°ç¼“å­˜çš„æ“ä½œä»¥ MQ æ¶ˆæ¯çš„æ–¹å¼å‘é€å‡ºå»ï¼Œç”±ä¸åŒçš„ç³»ç»Ÿæˆ–è€…ä¸“é—¨çš„ä¸€ä¸ªç³»ç»Ÿè¿›è¡Œè®¢é˜…ï¼Œè€Œåšèšåˆçš„æ“ä½œã€‚å¦‚ä¸‹å›¾ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4594240837696335&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDk6GxakNUd7Gia5VOXPs9s3Vj7aO1YEUuEB2SsM5lM7ASr6oPia19LeYA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1528&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸åŒä¸šåŠ¡ç³»ç»Ÿè®¢é˜…MQæ¶ˆæ¯å•ç‹¬ç»´æŠ¤å„è‡ªçš„ç¼“å­˜Key&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.47368421052631576&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDtHXHmQb1SH28bWzquewVMDecoAS9cecdGs7pueIDVXeY1A8aCjjYDg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1444&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸“é—¨æ›´æ–°ç¼“å­˜çš„æœåŠ¡è®¢é˜…MQæ¶ˆæ¯ç»´æŠ¤æ‰€æœ‰ç›¸å…³Keyçš„ç¼“å­˜æ“ä½œ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe97wd1kjBtWzys9nG2SWzoiabw5V7EdjQsD9xVByPSSQwIdCa4YpoKGZCP5ZbMK6SBl0eqVapQznw0g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;é€šè¿‡è®¢é˜…MySQL binlogçš„æ–¹å¼å¤„ç†ç¼“å­˜&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸Šé¢è®²åˆ°çš„ MQ å¤„ç†æ–¹å¼éœ€è¦ä¸šåŠ¡ä»£ç é‡Œé¢æ˜¾å¼åœ°å‘é€ MQ æ¶ˆæ¯ã€‚è¿˜æœ‰ä¸€ç§ä¼˜é›…çš„æ–¹å¼ä¾¿æ˜¯è®¢é˜… MySQL çš„ binlogï¼Œç›‘å¬æ•°æ®çš„çœŸå®å˜åŒ–æƒ…å†µä»¥å¤„ç†ç›¸å…³çš„ç¼“å­˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¾‹å¦‚åˆšåˆšæåˆ°çš„ä¾‹å­ä¸­ï¼Œå¦‚æœç²‰ä¸åˆè§¦å‘æ‰“èµäº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åˆ©ç”¨ binlog è¡¨ç›‘å¬æ˜¯èƒ½åŠæ—¶å‘ç°çš„ï¼Œå‘ç°åå°±èƒ½é›†ä¸­å¤„ç†äº†ï¼Œè€Œä¸”æ— è®ºæ˜¯åœ¨ä»€ä¹ˆç³»ç»Ÿä»€ä¹ˆä½ç½®å»æ›´æ–°æ•°æ®ï¼Œéƒ½èƒ½åšåˆ°é›†ä¸­å¤„ç†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç›®å‰ä¸šç•Œç±»ä¼¼çš„äº§å“æœ‰ Canalï¼Œå…·ä½“çš„æ“ä½œå›¾å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4147651006711409&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDs4B8jltwmUAamAoTO76ZDaib3ibspONEHfucuToF46g95RaX41CQMoKQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1490&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ©ç”¨Canelè®¢é˜…æ•°æ®åº“binlogå˜æ›´ä»è€Œå‘å‡ºMQæ¶ˆæ¯ï¼Œè®©ä¸€ä¸ªä¸“é—¨æ¶ˆè´¹è€…æœåŠ¡ç»´æŠ¤æ‰€æœ‰ç›¸å…³Keyçš„ç¼“å­˜æ“ä½œ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ°è¿™é‡Œï¼Œé’ˆå¯¹å¤§å‹ç³»ç»Ÿç¼“å­˜è®¾è®¡å¦‚ä½•ä¿è¯æœ€ç»ˆä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å·²ç»ä»ç­–ç•¥ã€åœºæ™¯ã€æ“ä½œæ–¹æ¡ˆç­‰è§’åº¦è¿›è¡Œäº†ç»†è‡´çš„è®²è¿°ï¼Œå¸Œæœ›èƒ½å¯¹ä½ èµ·åˆ°å¸®åŠ©ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;ç‚¹å‡»ä¸‹æ–¹ç©ºç™½ â–¼ æŸ¥çœ‹æ˜æ—¥å¼€å‘è€…é»„å†&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img data-ratio=&quot;0.3222222&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDM3RtYXiaicydYd6oAnjecFFekk7QdwJd3v4e33liaTcEYMIic1GBWtEfMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewbox=&quot;0 0 375 138&quot; opacity=&quot;1&quot;&gt;&lt;svg&gt;&lt;svg&gt;&lt;rect fill=&quot;rgb(254, 254, 254)&quot; x=&quot;0%&quot; y=&quot;0%&quot;/&gt;&lt;/svg&gt;&lt;svg x=&quot;32.80%&quot; y=&quot;335.53%&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; styel=&quot;vertical-align: middle; max-width: 100%;&quot;&gt;&lt;foreignobject&gt;&lt;p&gt;summer&lt;/p&gt;&lt;p&gt;time&lt;/p&gt;&lt;/foreignobject&gt;&lt;/svg&gt;&lt;svg x=&quot;61.07%&quot; y=&quot;26.18%&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; styel=&quot;vertical-align: middle; max-width: 100%;&quot;&gt;&lt;foreignobject&gt;&lt;p&gt;2022&lt;/p&gt;&lt;p&gt;/&lt;/p&gt;&lt;p&gt;07.23&lt;/p&gt;&lt;/foreignobject&gt;&lt;/svg&gt;&lt;svg x=&quot;22.93%&quot; y=&quot;280.89%&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; styel=&quot;vertical-align: middle; max-width: 100%;&quot;&gt;&lt;foreignobject&gt;&lt;p&gt;&lt;/p&gt;&lt;/foreignobject&gt;&lt;/svg&gt;&lt;/svg&gt;&lt;animate fill=&quot;freeze&quot; attributename=&quot;opacity&quot; begin=&quot;click&quot; from=&quot;1&quot; to=&quot;0&quot; dur=&quot;1&quot; restart=&quot;never&quot;/&gt;&lt;animate fill=&quot;freeze&quot; attributename=&quot;width&quot; begin=&quot;click + 1s&quot; from=&quot;1&quot; to=&quot;0&quot; dur=&quot;0.01&quot; restart=&quot;never&quot;/&gt;&lt;/svg&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.0599455&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe955YQIYia0ZAfHTHlbdfNjyDzmCVibvoCq3NNLJp0pObVR8AcFNFCgxLJj7QKZ5MEZZ7ecic8TVS3dMw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;734&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;em&gt;æ³¨ï¼šæœ¬æ–‡åŸºäºæœ¬äººåšå®¢https://jaskey.github.io/blog/2022/04/14/cache-consistency/&lt;/em&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt; ä½œè€…ä¸ªäººé‚®ç®±jaskeylin@apache.orgï¼Œå¾®ä¿¡ï¼šJaskeyLam&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;/article&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>e7c0e5d4882eca7b08357e501003bf0b</guid>
<title>é‡ç£…å‡ºå‡»ï¼Œ20 å¼ å›¾å¸¦ä½ å½»åº•äº†è§£ ReentrantLock åŠ é”è§£é”çš„åŸç†</title>
<link>https://toutiao.io/k/jyfkfs8</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;center data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç‚¹å‡»â€œé˜¿Qè¯´ä»£ç â€ï¼Œå…³æ³¨ï¼Œè®¾ä¸ºæ˜Ÿæ ‡&lt;/center&gt;&lt;center data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¯æ—¥æŠ€æœ¯å¹²è´§ï¼Œç¬¬ä¸€æ—¶é—´é€è¾¾ï¼&lt;/center&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å“ˆå–½å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é˜¿Qã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€è¿‘æ˜¯ä¸Šç­å¿™é¡¹ç›®ï¼Œä¸‹ç­å¸¦å¨ƒï¼Œå¿™çš„ä¸å¯å¼€äº¤ï¼Œè¿æ‘¸é±¼çš„æ—¶é—´éƒ½æ²¡æœ‰äº†ã€‚ä»Šå¤©è¶å‡æœŸç”¨&lt;strong&gt;å›¾è§£&lt;/strong&gt;çš„æ–¹å¼ä»&lt;strong&gt;æºç &lt;/strong&gt;è§’åº¦ç»™å¤§å®¶è¯´ä¸€ä¸‹&lt;code&gt;ReentrantLock&lt;/code&gt;åŠ é”è§£é”çš„å…¨è¿‡ç¨‹ã€‚ç³»å¥½å®‰å…¨å¸¦ï¼Œå‘è½¦äº†ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ç®€å•ä½¿ç”¨&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨èŠå®ƒçš„æºç ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥åšä¸ªç®€å•çš„ä½¿ç”¨è¯´æ˜ã€‚å½“æˆ‘åœ¨&lt;code&gt;IDEA&lt;/code&gt;ä¸­åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„&lt;code&gt;Demo&lt;/code&gt;ä¹‹åï¼Œå®ƒä¼šç»™å‡ºä»¥ä¸‹æç¤º&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.09851694915254237&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/55HPQyguvpPBhg9teBc79RAt13jsfx2pna3LEdkvS8c5jUVUafakicrIFibLLKPQOwzyibsk4icCBjogcm4qWLn3IQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1888&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æç¤ºæ–‡å­—&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨ä½¿ç”¨é˜»å¡ç­‰å¾…è·å–é”çš„æ–¹å¼ä¸­ï¼Œå¿…é¡»åœ¨&lt;code&gt;try&lt;/code&gt;ä»£ç å—ä¹‹å¤–ï¼Œå¹¶ä¸”åœ¨åŠ é”æ–¹æ³•ä¸&lt;code&gt;try&lt;/code&gt;ä»£ç å—ä¹‹é—´æ²¡æœ‰ä»»ä½•å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨&lt;code&gt;finally&lt;/code&gt;ä¸­æ— æ³•è§£é”ã€‚&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;1ã€å¦‚æœåœ¨&lt;code&gt;lock&lt;/code&gt;æ–¹æ³•ä¸&lt;code&gt;try&lt;/code&gt;ä»£ç å—ä¹‹é—´çš„æ–¹æ³•è°ƒç”¨æŠ›å‡ºå¼‚å¸¸ï¼Œé‚£ä¹ˆæ— æ³•è§£é”ï¼Œé€ æˆå…¶å®ƒçº¿ç¨‹æ— æ³•æˆåŠŸè·å–é”ã€‚&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;2ã€å¦‚æœ&lt;code&gt;lock&lt;/code&gt;æ–¹æ³•åœ¨&lt;code&gt;try&lt;/code&gt;ä»£ç å—ä¹‹å†…ï¼Œå¯èƒ½ç”±äºå…¶å®ƒæ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´åœ¨&lt;code&gt;finally&lt;/code&gt;ä»£ç å—ä¸­ï¼Œ&lt;code&gt;unlock&lt;/code&gt;å¯¹æœªåŠ é”çš„å¯¹è±¡è§£é”ï¼Œå®ƒä¼šè°ƒç”¨&lt;code&gt;AQS&lt;/code&gt;çš„&lt;code&gt;tryRelease&lt;/code&gt;æ–¹æ³•ï¼ˆå–å†³äºå…·ä½“å®ç°ç±»ï¼‰ï¼ŒæŠ›å‡º&lt;code&gt;IllegalMonitorStateException&lt;/code&gt;å¼‚å¸¸ã€‚&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;3ã€åœ¨&lt;code&gt;Lock&lt;/code&gt;å¯¹è±¡çš„&lt;code&gt;lock&lt;/code&gt;æ–¹æ³•å®ç°ä¸­å¯èƒ½æŠ›å‡º&lt;code&gt;unchecked&lt;/code&gt;å¼‚å¸¸ï¼Œäº§ç”Ÿçš„åæœä¸è¯´æ˜äºŒç›¸åŒã€‚&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;java.concurrent.LockShouldWithTryFinallyRule.rule.desc&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿˜ä¸¾äº†ä¸¤ä¸ªä¾‹å­ï¼Œæ­£ç¡®æ¡ˆä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;LockÂ lockÂ =Â &lt;span&gt;new&lt;/span&gt;Â XxxLock();&lt;br/&gt;&lt;span&gt;//Â ...&lt;/span&gt;&lt;br/&gt;lock.lock();&lt;br/&gt;&lt;span&gt;try&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â doSomething();&lt;br/&gt;Â Â Â Â doOthers();&lt;br/&gt;}Â &lt;span&gt;finally&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â lock.unlock();&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é”™è¯¯æ¡ˆä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;LockÂ lockÂ =Â &lt;span&gt;new&lt;/span&gt;Â XxxLock();&lt;br/&gt;&lt;span&gt;//Â ...&lt;/span&gt;&lt;br/&gt;&lt;span&gt;try&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å¦‚æœåœ¨æ­¤æŠ›å‡ºå¼‚å¸¸ï¼Œä¼šç›´æ¥æ‰§è¡ŒÂ finallyÂ å—çš„ä»£ç &lt;/span&gt;&lt;br/&gt;Â Â Â Â doSomething();&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ä¸ç®¡é”æ˜¯å¦æˆåŠŸï¼ŒfinallyÂ å—éƒ½ä¼šæ‰§è¡Œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â lock.lock();&lt;br/&gt;Â Â Â Â doOthers();&lt;br/&gt;&lt;br/&gt;}Â &lt;span&gt;finally&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â lock.unlock();&lt;br/&gt;}Â &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;AQS&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸Šè¾¹çš„æ¡ˆä¾‹ä¸­åŠ é”è°ƒç”¨çš„æ˜¯&lt;code&gt;lock()&lt;/code&gt;æ–¹æ³•ï¼Œè§£é”ç”¨çš„æ˜¯&lt;code&gt;unlock()&lt;/code&gt;æ–¹æ³•ï¼Œè€Œé€šè¿‡æŸ¥çœ‹æºç å‘ç°å®ƒä»¬éƒ½æ˜¯è°ƒç”¨çš„å†…éƒ¨é™æ€æŠ½è±¡ç±»&lt;code&gt;Sync&lt;/code&gt;çš„ç›¸å…³æ–¹æ³•ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;abstract static class Sync extends AbstractQueuedSynchronizer&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;Sync &lt;/code&gt;æ˜¯é€šè¿‡ç»§æ‰¿&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;æ¥å®ç°çš„ï¼Œæ²¡é”™ï¼Œ&lt;code&gt;AbstractQueuedSynchronizer&lt;/code&gt;å°±æ˜¯&lt;code&gt;AQS&lt;/code&gt;çš„å…¨ç§°ã€‚&lt;code&gt;AQS&lt;/code&gt;å†…éƒ¨ç»´æŠ¤ç€ä¸€ä¸ª&lt;code&gt;FIFO&lt;/code&gt;çš„åŒå‘é˜Ÿåˆ—ï¼ˆ&lt;code&gt;CLH&lt;/code&gt;ï¼‰ï¼Œ&lt;code&gt;ReentrantLock&lt;/code&gt;ä¹Ÿæ˜¯åŸºäºå®ƒæ¥å®ç°çš„ï¼Œå…ˆæ¥å¼ å›¾æ„Ÿå—ä¸‹ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5121042830540037&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pHjNyqyUzooc9ZmbJ15vnaCSBM63hnIXLgYkbibnmEOvwZx7PSmlJPyQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1074&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Node å±æ€§&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//æ­¤å¤„æ˜¯Â NodeÂ çš„éƒ¨åˆ†å±æ€§&lt;/span&gt;&lt;br/&gt;&lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;Node&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;br/&gt;Â &lt;span&gt;//æ’ä»–é”æ ‡è¯†&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â NodeÂ EXCLUSIVEÂ =Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;//å¦‚æœå¸¦æœ‰è¿™ä¸ªæ ‡è¯†ï¼Œè¯æ˜æ˜¯å¤±æ•ˆäº†&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;int&lt;/span&gt;Â CANCELLEDÂ =Â Â &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;Â &lt;br/&gt;Â &lt;span&gt;//å…·æœ‰è¿™ä¸ªæ ‡è¯†ï¼Œè¯´æ˜åç»§èŠ‚ç‚¹éœ€è¦è¢«å”¤é†’&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;int&lt;/span&gt;Â SIGNALÂ =Â -&lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;//Nodeå¯¹è±¡å­˜å‚¨æ ‡è¯†çš„åœ°æ–¹&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â &lt;span&gt;int&lt;/span&gt;Â waitStatus;&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;//æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â NodeÂ prev;&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;//æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â NodeÂ next;&lt;br/&gt;Â &lt;br/&gt;Â &lt;span&gt;//å½“å‰Nodeç»‘å®šçš„çº¿ç¨‹&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â ThreadÂ thread;&lt;br/&gt;Â &lt;br/&gt;Â &lt;span&gt;//è¿”å›å‰é©±èŠ‚ç‚¹å³ä¸Šä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœå‰é©±èŠ‚ç‚¹ä¸ºç©ºï¼ŒæŠ›å‡ºå¼‚å¸¸&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â NodeÂ &lt;span&gt;predecessor&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;span&gt;throws&lt;/span&gt;Â NullPointerExceptionÂ &lt;/span&gt;{&lt;br/&gt;Â Â NodeÂ pÂ =Â prev;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (pÂ ==Â &lt;span&gt;null&lt;/span&gt;)&lt;br/&gt;Â Â Â &lt;span&gt;throw&lt;/span&gt;Â &lt;span&gt;new&lt;/span&gt;Â NullPointerException();&lt;br/&gt;Â Â &lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;return&lt;/span&gt;Â p;&lt;br/&gt;Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯¹äºé‡Œè¾¹çš„&lt;code&gt;waitStatus&lt;/code&gt;å±æ€§ï¼Œæˆ‘ä»¬éœ€è¦åšä¸ªè§£é‡Šï¼š&lt;strong&gt;ï¼ˆéå¸¸é‡è¦ï¼‰&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;CANCELLED(1)ï¼šå½“å‰èŠ‚ç‚¹å–æ¶ˆè·å–é”ã€‚å½“ç­‰å¾…è¶…æ—¶æˆ–è¢«ä¸­æ–­(å“åº”ä¸­æ–­)ï¼Œä¼šè§¦å‘å˜æ›´ä¸ºæ­¤çŠ¶æ€ï¼Œè¿›å…¥è¯¥çŠ¶æ€åèŠ‚ç‚¹çŠ¶æ€ä¸å†å˜åŒ–ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;SIGNAL(-1)ï¼šåé¢èŠ‚ç‚¹ç­‰å¾…å½“å‰èŠ‚ç‚¹å”¤é†’ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;CONDITION(-2)ï¼š&lt;code&gt;Condition&lt;/code&gt;ä¸­ä½¿ç”¨ï¼Œå½“å‰çº¿ç¨‹é˜»å¡åœ¨&lt;code&gt;Condition&lt;/code&gt;ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹è°ƒç”¨äº†&lt;code&gt;Condition&lt;/code&gt;çš„&lt;code&gt;signal&lt;/code&gt;æ–¹æ³•ï¼Œè¿™ä¸ªç»“ç‚¹å°†ä»ç­‰å¾…é˜Ÿåˆ—è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—é˜Ÿå°¾ï¼Œç­‰å¾…è·å–åŒæ­¥é”ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;PROPAGATE(-3)ï¼šå…±äº«æ¨¡å¼ï¼Œå‰ç½®èŠ‚ç‚¹å”¤é†’åé¢èŠ‚ç‚¹åï¼Œå”¤é†’æ“ä½œæ— æ¡ä»¶ä¼ æ’­ä¸‹å»ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;0ï¼šä¸­é—´çŠ¶æ€ï¼Œå½“å‰èŠ‚ç‚¹åé¢çš„èŠ‚ç‚¹å·²ç»å”¤é†’ï¼Œä½†æ˜¯å½“å‰èŠ‚ç‚¹çº¿ç¨‹è¿˜æ²¡æœ‰æ‰§è¡Œå®Œæˆï¼›&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;AQS å±æ€§&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â å¤´ç»“ç‚¹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;transient&lt;/span&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â NodeÂ head;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â å°¾ç»“ç‚¹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;transient&lt;/span&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â NodeÂ tail;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//0-&amp;gt;1Â æ‹¿åˆ°é”ï¼Œå¤§äº0Â è¯´æ˜å½“å‰å·²ç»æœ‰çº¿ç¨‹å ç”¨äº†é”èµ„æº&lt;/span&gt;&lt;br/&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;volatile&lt;/span&gt;Â &lt;span&gt;int&lt;/span&gt;Â state;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»Šå¤©æˆ‘ä»¬å…ˆç®€å•äº†è§£ä¸‹&lt;code&gt;AQS&lt;/code&gt;çš„æ„é€ ä»¥å¸®åŠ©å¤§å®¶æ›´å¥½çš„ç†è§£&lt;code&gt;ReentrantLock&lt;/code&gt;ï¼Œè‡³äºæ·±å±‚æ¬¡çš„ä¸œè¥¿å…ˆä¸åšå±•å¼€ï¼&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;åŠ é”&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯¹&lt;code&gt;AQS&lt;/code&gt;çš„ç»“æ„æœ‰äº†åŸºæœ¬äº†è§£ä¹‹åï¼Œæˆ‘ä»¬æ­£å¼è¿›å…¥ä¸»é¢˜â€”â€”åŠ é”ã€‚ä»æºç ä¸­å¯ä»¥çœ‹å‡ºé”è¢«åˆ†ä¸º&lt;strong&gt;å…¬å¹³é”&lt;/strong&gt;å’Œ&lt;strong&gt;éå…¬å¹³é”&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.40091743119266054&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pgeX5C1jibmET92ZYicT4Z93t0E6gXxWl31WIsIMzrZm6uQ3aoBaQyiaMA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1090&quot;/&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt;Â *Â å…¬å¹³é”ä»£ç &lt;br/&gt;Â */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt;Â *Â éå…¬å¹³é”ä»£ç &lt;br/&gt;Â */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetState(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;1&lt;/span&gt;))&lt;br/&gt;Â Â Â Â Â Â Â Â setExclusiveOwnerThread(Thread.currentThread());&lt;br/&gt;Â Â Â Â &lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åˆæ­¥æŸ¥çœ‹ä»£ç å‘ç°éå…¬å¹³é”ä¼¼ä¹åŒ…å«å…¬å¹³é”çš„é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä»â€œéå…¬å¹³é”â€å¼€å§‹ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;éå…¬å¹³é”&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//é€šè¿‡Â CASÂ çš„æ–¹å¼å°è¯•å°†Â stateÂ ä»0æ”¹ä¸º1ï¼Œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;//å¦‚æœè¿”å›Â trueï¼Œä»£è¡¨ä¿®æ”¹æˆåŠŸï¼Œè·å¾—é”èµ„æº;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;//å¦‚æœè¿”å›falseï¼Œä»£è¡¨ä¿®æ”¹å¤±è´¥ï¼Œæœªè·å–é”èµ„æº&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetState(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;1&lt;/span&gt;))&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â å°†å±æ€§exclusiveOwnerThreadè®¾ç½®ä¸ºå½“å‰çº¿ç¨‹ï¼Œè¯¥å±æ€§æ˜¯AQSçš„çˆ¶ç±»æä¾›çš„&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â setExclusiveOwnerThread(Thread.currentThread());&lt;br/&gt;Â Â Â Â &lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;&lt;code&gt;compareAndSetState()&lt;/code&gt;ï¼šåº•å±‚è°ƒç”¨çš„æ˜¯&lt;code&gt;unsafe&lt;/code&gt;çš„&lt;code&gt;compareAndSwapInt&lt;/code&gt;ï¼Œè¯¥æ–¹æ³•æ˜¯åŸå­æ“ä½œï¼›&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å‡è®¾æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼ˆ&lt;code&gt;t1&lt;/code&gt;ã€&lt;code&gt;t2&lt;/code&gt;ï¼‰åœ¨ç«äº‰é”èµ„æºï¼Œçº¿ç¨‹1è·å–é”èµ„æºä¹‹åï¼Œæ‰§è¡Œ&lt;code&gt;setExclusiveOwnerThread&lt;/code&gt;æ“ä½œï¼Œè®¾ç½®å±æ€§å€¼ä¸ºå½“å‰çº¿ç¨‹&lt;code&gt;t1&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.4702702702702704&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pEMmXYa0YJaVFhPF2Eic2dlXqM9E9H3OVsyOVQiarGMQ0MDKUWljSSh4A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;370&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¤æ—¶ï¼Œå½“&lt;code&gt;t2&lt;/code&gt;æƒ³è¦è·å–é”èµ„æºï¼Œè°ƒç”¨&lt;code&gt;lock()&lt;/code&gt;æ–¹æ³•ä¹‹åï¼Œæ‰§è¡Œ&lt;code&gt;compareAndSetState(0, 1)&lt;/code&gt;è¿”å›&lt;code&gt;false&lt;/code&gt;ï¼Œä¼šèµ°&lt;code&gt;else&lt;/code&gt;æ‰§è¡Œ&lt;code&gt;acquire()&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ–¹æ³•æŸ¥çœ‹&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;accquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â arg)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â tryAcquireÂ å†æ¬¡å°è¯•è·å–é”èµ„æºï¼Œå¦‚æœå°è¯•æˆåŠŸï¼Œè¿”å›trueï¼Œå°è¯•å¤±è´¥è¿”å›false&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (!tryAcquire(arg)Â &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â èµ°åˆ°è¿™ï¼Œä»£è¡¨è·å–é”èµ„æºå¤±è´¥ï¼Œéœ€è¦å°†å½“å‰çº¿ç¨‹å°è£…æˆä¸€ä¸ªNodeï¼Œè¿½åŠ åˆ°AQSçš„é˜Ÿåˆ—ä¸­&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â acquireQueued(addWaiter(Node.EXCLUSIVE),Â arg))&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â çº¿ç¨‹ä¸­æ–­&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â selfInterrupt();&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;accquire()&lt;/code&gt;ä¸­æ¶‰åŠçš„æ–¹æ³•æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬å°†è¿›è¡Œæ‹†è§£ï¼Œä¸€ä¸ªä¸€ä¸ªæ¥åˆ†æï¼Œé¡ºåºï¼š&lt;code&gt;tryAcquire() -&amp;gt; addWaiter() -&amp;gt; acquireQueued()&lt;/code&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹ tryAcquire() æ–¹æ³•&lt;/h4&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//AQSä¸­&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â arg)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;//AQSÂ æ˜¯åŸºç±»ï¼Œå…·ä½“å®ç°åœ¨è‡ªå·±çš„ç±»ä¸­å®ç°ï¼Œæˆ‘ä»¬å»æŸ¥çœ‹â€œéå…¬å¹³é”â€ä¸­çš„å®ç°&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;throw&lt;/span&gt;Â &lt;span&gt;new&lt;/span&gt;Â UnsupportedOperationException();&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//ReentrantLockÂ ä¸­&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â acquires)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â nonfairTryAcquire(acquires);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;nonfairTryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â acquires)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;//Â è·å–å½“å‰çº¿ç¨‹&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;final&lt;/span&gt;Â ThreadÂ currentÂ =Â Thread.currentThread();&lt;br/&gt;Â &lt;span&gt;//è·å–AQSÂ çš„Â stateÂ &lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;int&lt;/span&gt;Â cÂ =Â getState();&lt;br/&gt;Â &lt;span&gt;//Â å¦‚æœÂ stateÂ ä¸º0ï¼Œä»£è¡¨å°è¯•å†æ¬¡è·å–é”èµ„æº&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (cÂ ==Â &lt;span&gt;0&lt;/span&gt;)Â {&lt;br/&gt;Â Â &lt;span&gt;//Â æ­¥éª¤åŒä¸Šï¼šé€šè¿‡ CAS çš„æ–¹å¼å°è¯•å°† state ä»0æ”¹ä¸º1ï¼Œ&lt;/span&gt;&lt;br/&gt;Â  &lt;span&gt;//å¦‚æœè¿”å›Â trueï¼Œä»£è¡¨ä¿®æ”¹æˆåŠŸï¼Œè·å¾—é”èµ„æº;&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;//å¦‚æœè¿”å›falseï¼Œä»£è¡¨ä¿®æ”¹å¤±è´¥ï¼Œæœªè·å–é”èµ„æº&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetState(&lt;span&gt;0&lt;/span&gt;,Â acquires))Â {&lt;br/&gt;Â Â Â &lt;span&gt;//è®¾ç½®å±æ€§ä¸ºå½“å‰çº¿ç¨‹&lt;/span&gt;&lt;br/&gt;Â Â Â setExclusiveOwnerThread(current);&lt;br/&gt;Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â Â }&lt;br/&gt;Â }&lt;br/&gt;Â &lt;span&gt;//å½“å‰å æœ‰é”èµ„æºçš„çº¿ç¨‹æ˜¯å¦æ˜¯å½“å‰çº¿ç¨‹ï¼Œå¦‚æœæ˜¯åˆ™è¯æ˜æ˜¯å¯é‡å…¥æ“ä½œ&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;else&lt;/span&gt;Â &lt;span&gt;if&lt;/span&gt;Â (currentÂ ==Â getExclusiveOwnerThread())Â {&lt;br/&gt;Â Â &lt;span&gt;//å°†Â stateÂ +Â 1&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;int&lt;/span&gt;Â nextcÂ =Â cÂ +Â acquires;&lt;br/&gt;Â Â &lt;span&gt;//ä¸ºä»€ä¹ˆä¼šå°äºÂ 0Â å‘¢ï¼Ÿå› ä¸ºæœ€å¤§å€¼Â + 1 åä¼šå°†ç¬¦å·ä½çš„0æ”¹ä¸º1 ä¼šå˜æˆè´Ÿæ•°(å¯å‚è€ƒInteger.MAX_VALUE + 1)&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (nextcÂ &amp;lt;Â &lt;span&gt;0&lt;/span&gt;)Â &lt;span&gt;//Â overflow&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;//åŠ 1åå°äº0ï¼Œè¶…å‡ºé”å¯é‡å…¥çš„æœ€å¤§å€¼ï¼ŒæŠ›å¼‚å¸¸&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;throw&lt;/span&gt;Â &lt;span&gt;new&lt;/span&gt;Â Error(&lt;span&gt;&quot;MaximumÂ lockÂ countÂ exceeded&quot;&lt;/span&gt;);&lt;br/&gt;Â Â &lt;span&gt;//è®¾ç½®Â stateÂ çŠ¶æ€&lt;/span&gt;&lt;br/&gt;Â Â setState(nextc);&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â }&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å› ä¸ºçº¿ç¨‹1å·²ç»è·å–åˆ°äº†é”ï¼Œæ­¤æ—¶&lt;code&gt;state&lt;/code&gt;ä¸º1ï¼Œæ‰€ä»¥ä¸èµ°&lt;code&gt;nonfairTryAcquire()&lt;/code&gt;çš„&lt;code&gt;if&lt;/code&gt;ã€‚åˆå› ä¸ºå½“å‰æ˜¯çº¿ç¨‹2ï¼Œä¸æ˜¯å æœ‰å½“å‰é”çš„çº¿ç¨‹1ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šèµ°&lt;code&gt;else if&lt;/code&gt;ï¼Œå³&lt;code&gt;tryAcquire()&lt;/code&gt;æ–¹æ³•è¿”å›&lt;code&gt;false&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹ addWaiter() æ–¹æ³•&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;èµ°åˆ°æœ¬æ–¹æ³•ä¸­ï¼Œä»£è¡¨è·å–é”èµ„æºå¤±è´¥ã€‚&lt;code&gt;addWaiter()&lt;/code&gt;å°†æ²¡æœ‰è·å–åˆ°é”èµ„æºçš„çº¿ç¨‹ç”©åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â NodeÂ &lt;span&gt;addWaiter&lt;/span&gt;&lt;span&gt;(NodeÂ mode)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;//åˆ›å»ºÂ NodeÂ ç±»ï¼Œå¹¶ä¸”è®¾ç½®Â threadÂ ä¸ºå½“å‰çº¿ç¨‹ï¼Œè®¾ç½®ä¸ºæ’å®ƒé”&lt;/span&gt;&lt;br/&gt;Â NodeÂ nodeÂ =Â &lt;span&gt;new&lt;/span&gt;Â Node(Thread.currentThread(),Â mode);&lt;br/&gt;Â &lt;span&gt;//Â è·å–Â AQSÂ ä¸­é˜Ÿåˆ—çš„å°¾éƒ¨èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â NodeÂ predÂ =Â tail;&lt;br/&gt;Â &lt;span&gt;//Â å¦‚æœÂ tailÂ ==Â nullï¼Œè¯´æ˜æ˜¯ç©ºé˜Ÿåˆ—ï¼Œ&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;//Â ä¸ä¸ºÂ nullï¼Œè¯´æ˜ç°åœ¨é˜Ÿåˆ—ä¸­æœ‰æ•°æ®ï¼Œ&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (predÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â &lt;span&gt;//Â å°†å½“å‰èŠ‚ç‚¹çš„Â prevÂ æŒ‡å‘åˆšæ‰çš„å°¾éƒ¨èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹åº”è¯¥è®¾ç½®ä¸ºå°¾éƒ¨èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â node.prevÂ =Â pred;&lt;br/&gt;Â Â &lt;span&gt;//Â CASÂ å°†Â tailÂ èŠ‚ç‚¹è®¾ç½®ä¸ºå½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetTail(pred,Â node))Â {&lt;br/&gt;Â Â Â &lt;span&gt;//Â å°†ä¹‹å‰å°¾èŠ‚ç‚¹çš„Â nextÂ è®¾ç½®ä¸ºå½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â pred.nextÂ =Â node;&lt;br/&gt;Â Â Â &lt;span&gt;//Â è¿”å›å½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;return&lt;/span&gt;Â node;&lt;br/&gt;Â Â }&lt;br/&gt;Â }&lt;br/&gt;Â enq(node);&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â node;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“&lt;code&gt;tail&lt;/code&gt;ä¸ä¸ºç©ºï¼Œå³é˜Ÿåˆ—ä¸­æœ‰æ•°æ®æ—¶ï¼Œæˆ‘ä»¬æ¥å›¾è§£ä¸€ä¸‹&lt;code&gt;pred!=null&lt;/code&gt;ä»£ç å—ä¸­çš„ä»£ç ã€‚åˆå§‹åŒ–çŠ¶æ€å¦‚ä¸‹ï¼Œ&lt;code&gt;pred&lt;/code&gt;æŒ‡å‘å°¾èŠ‚ç‚¹ï¼Œ&lt;code&gt;node&lt;/code&gt;æŒ‡å‘æ–°çš„èŠ‚ç‚¹ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5639344262295082&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pK24dh2HXmuaX0ib4l3gptj34aYl6lLv2GyP83dYVX9ic68ycI78NDNAQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1220&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;node.prev = pred;&lt;/code&gt;å°†&lt;code&gt;node&lt;/code&gt;çš„å‰é©±èŠ‚ç‚¹è®¾ç½®ä¸º&lt;code&gt;pred&lt;/code&gt;æŒ‡å‘çš„èŠ‚ç‚¹&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5517241379310345&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pg322lJ6Ht8v7ChiaGRjDsa8uObjQ0CfX9od2cjIx957IMEoKCt7XNnw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1218&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;compareAndSetTail(pred, node)&lt;/code&gt;é€šè¿‡&lt;code&gt;CAS&lt;/code&gt;çš„æ–¹å¼å°è¯•å°†å½“å‰èŠ‚ç‚¹&lt;code&gt;node&lt;/code&gt;è®¾ç½®ä¸ºå°¾ç»“ç‚¹ï¼Œæ­¤å¤„æˆ‘ä»¬å‡è®¾è®¾ç½®æˆåŠŸï¼Œåˆ™&lt;code&gt;FIFO&lt;/code&gt;é˜Ÿåˆ—çš„&lt;code&gt;tail&lt;/code&gt;æŒ‡å‘&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5475223395613322&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pOwXUliaGvl5u3CPnaDzOWx4Tcfp7c882KiaicljNjVSxjxFbweGmAwRuA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1231&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;pred.next = node;&lt;/code&gt;å°†&lt;code&gt;pred&lt;/code&gt;èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹è®¾ç½®ä¸º&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹ï¼Œæ­¤æ—¶&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹æˆåŠŸè¿›å…¥&lt;code&gt;FIFO&lt;/code&gt;é˜Ÿåˆ—å°¾éƒ¨ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5646586345381526&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pGKibxvmluEgZnLZicDgq1eyL3AiaamnT3QOPLko8nolibG9c6eEzJgiaRxg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1245&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œå½“&lt;code&gt;pred&lt;/code&gt;ä¸ºç©ºï¼Œå³é˜Ÿåˆ—ä¸­æ²¡æœ‰èŠ‚ç‚¹æˆ–å°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹è®¾ç½®ä¸ºå°¾ç»“ç‚¹å¤±è´¥æ—¶ï¼Œä¼šèµ°&lt;code&gt;enq()&lt;/code&gt;æ–¹æ³•ã€‚æˆ‘ä»¬åˆ—ä¸¾çš„ä¾‹å­å°±ç¬¦åˆ&lt;code&gt;pred&lt;/code&gt;ä¸ºç©ºçš„æƒ…å†µï¼Œå°±è®©æˆ‘ä»¬ä»¥ä¾‹å­ä¸ºåŸºç¡€ç»§ç»­åˆ†æå§ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//ç°åœ¨æ²¡äººæ’é˜Ÿï¼Œæˆ‘æ˜¯ç¬¬ä¸€ä¸ªÂ ||Â å‰è¾¹CASå¤±è´¥ä¹Ÿä¼šè¿›å…¥è¿™ä¸ªä½ç½®é‡æ–°å¾€é˜Ÿåˆ—å°¾å·´å»å¡&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â NodeÂ &lt;span&gt;enq&lt;/span&gt;&lt;span&gt;(&lt;span&gt;final&lt;/span&gt;Â NodeÂ node)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;//æ­»å¾ªç¯&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;for&lt;/span&gt;Â (;;)Â {&lt;br/&gt;Â Â &lt;span&gt;//é‡æ–°è·å–tailèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â NodeÂ tÂ =Â tail;&lt;br/&gt;Â Â &lt;span&gt;//Â æ²¡äººæ’é˜Ÿï¼Œé˜Ÿåˆ—ä¸ºç©º&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (tÂ ==Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â &lt;span&gt;//Â åˆå§‹åŒ–ä¸€ä¸ªÂ NodeÂ ä¸ºÂ headï¼Œè€Œè¿™ä¸ªheadÂ æ²¡æœ‰æ„ä¹‰&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetHead(&lt;span&gt;new&lt;/span&gt;Â Node()))&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å°†å¤´å°¾éƒ½æŒ‡å‘äº†è¿™ä¸ªåˆå§‹åŒ–çš„Nodeï¼Œç¬¬ä¸€æ¬¡å¾ªç¯ç»“æŸ&lt;/span&gt;&lt;br/&gt;Â Â Â Â tailÂ =Â head;&lt;br/&gt;Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â &lt;span&gt;//Â æœ‰äººæ’é˜Ÿï¼Œå¾€é˜Ÿåˆ—å°¾å·´å¡&lt;/span&gt;&lt;br/&gt;Â Â Â node.prevÂ =Â t;&lt;br/&gt;Â Â Â &lt;span&gt;//Â CASÂ å°†Â tailÂ èŠ‚ç‚¹è®¾ç½®ä¸ºå½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetTail(t,Â node))Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;//å°†ä¹‹å‰å°¾èŠ‚ç‚¹çš„Â nextÂ è®¾ç½®ä¸ºå½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â Â t.nextÂ =Â node;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â t;&lt;br/&gt;Â Â Â }&lt;br/&gt;Â Â }&lt;br/&gt;Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿›å…¥æ­»å¾ªç¯ï¼Œé¦–å…ˆä¼šèµ°&lt;code&gt;if&lt;/code&gt;æ–¹æ³•çš„é€»è¾‘ï¼Œé€šè¿‡&lt;code&gt;CAS&lt;/code&gt;çš„æ–¹å¼å°è¯•å°†ä¸€ä¸ªæ–°èŠ‚ç‚¹è®¾ç½®ä¸º&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹ï¼Œç„¶åå°†&lt;code&gt;tail&lt;/code&gt;ä¹ŸæŒ‡å‘æ–°èŠ‚ç‚¹ã€‚å¯ä»¥çœ‹å‡ºé˜Ÿåˆ—ä¸­çš„å¤´èŠ‚ç‚¹åªæ˜¯ä¸ªåˆå§‹åŒ–çš„èŠ‚ç‚¹ï¼Œæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.574487895716946&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pXETtXibjDQMYusCF8OSdeJFywFdyo0WR3XjYjKKNQLe8WDoPWL3lMzw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1074&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»§ç»­èµ°æ­»å¾ªç¯ä¸­çš„ä»£ç ï¼Œæ­¤æ—¶&lt;code&gt;t&lt;/code&gt;ä¸ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œæ‰€ä»¥ä¼šèµ°&lt;code&gt;else&lt;/code&gt;æ–¹æ³•ã€‚å°†&lt;code&gt;node&lt;/code&gt;çš„å‰é©±èŠ‚ç‚¹æŒ‡å‘&lt;code&gt;t&lt;/code&gt;ï¼Œé€šè¿‡&lt;code&gt;CAS&lt;/code&gt;æ–¹å¼å°†å½“å‰èŠ‚ç‚¹&lt;code&gt;node&lt;/code&gt;è®¾ç½®ä¸ºå°¾ç»“ç‚¹ï¼Œç„¶åå°†&lt;code&gt;t&lt;/code&gt;çš„åç»§èŠ‚ç‚¹æŒ‡å‘&lt;code&gt;node&lt;/code&gt;ã€‚æ­¤æ—¶çº¿ç¨‹2çš„èŠ‚ç‚¹å°±è¢«æˆåŠŸå¡å…¥&lt;code&gt;FIFO&lt;/code&gt;é˜Ÿåˆ—å°¾éƒ¨ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6016949152542372&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pyibKScicqpShhDYKBfwWrHSJWGa5lCqa90G2M0miaOTcgt7VSQLvA7Guw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1062&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹ acquireQueued()æ–¹æ³•&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°†å·²ç»åœ¨é˜Ÿåˆ—ä¸­çš„&lt;code&gt;node&lt;/code&gt;å°è¯•å»è·å–é”å¦åˆ™æŒ‚èµ·ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;acquireQueued&lt;/span&gt;&lt;span&gt;(&lt;span&gt;final&lt;/span&gt;Â NodeÂ node,Â &lt;span&gt;int&lt;/span&gt;Â arg)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;//Â è·å–é”èµ„æºçš„æ ‡è¯†,å¤±è´¥ä¸ºÂ trueï¼ŒæˆåŠŸä¸ºÂ false&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â failedÂ =Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â &lt;span&gt;try&lt;/span&gt;Â {&lt;br/&gt;Â Â &lt;span&gt;//Â çº¿ç¨‹ä¸­æ–­çš„æ ‡è¯†ï¼Œä¸­æ–­ä¸ºÂ trueï¼Œä¸ä¸­æ–­ä¸ºÂ false&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;boolean&lt;/span&gt;Â interruptedÂ =Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;Â Â &lt;span&gt;for&lt;/span&gt;Â (;;)Â {&lt;br/&gt;Â Â Â &lt;span&gt;//Â è·å–å½“å‰èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;final&lt;/span&gt;Â NodeÂ pÂ =Â node.predecessor();&lt;br/&gt;Â Â Â &lt;span&gt;//pä¸ºå¤´èŠ‚ç‚¹ï¼Œå°è¯•è·å–é”æ“ä½œ&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;if&lt;/span&gt;Â (pÂ ==Â headÂ &amp;amp;&amp;amp;Â tryAcquire(arg))Â {&lt;br/&gt;Â Â Â Â setHead(node);&lt;br/&gt;Â Â Â Â p.nextÂ =Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å°†è·å–é”å¤±è´¥æ ‡è¯†ç½®ä¸ºfalse&lt;/span&gt;&lt;br/&gt;Â Â Â Â failedÂ =Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â è·å–åˆ°é”èµ„æºï¼Œä¸ä¼šè¢«ä¸­æ–­&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â interrupted;&lt;br/&gt;Â Â Â }&lt;br/&gt;Â Â Â &lt;span&gt;//Â pÂ ä¸æ˜¯Â headÂ æˆ–è€…Â æ²¡æ‹¿åˆ°é”èµ„æºï¼Œ&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;if&lt;/span&gt;Â (shouldParkAfterFailedAcquire(p,Â node)Â &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â åŸºäºÂ UnsafeÂ çš„Â parkæ–¹æ³•ï¼ŒæŒ‚èµ·çº¿ç¨‹&lt;/span&gt;&lt;br/&gt;Â Â Â Â parkAndCheckInterrupt())&lt;br/&gt;Â Â Â Â interruptedÂ =Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â Â }&lt;br/&gt;Â }Â &lt;span&gt;finally&lt;/span&gt;Â {&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (failed)&lt;br/&gt;Â Â Â cancelAcquire(node);&lt;br/&gt;Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œåˆå‡ºç°äº†ä¸€æ¬¡æ­»å¾ªç¯ï¼Œé¦–å…ˆè·å–å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹pï¼Œå¦‚æœpæ˜¯å¤´èŠ‚ç‚¹(å¤´èŠ‚ç‚¹æ²¡æœ‰æ„ä¹‰)ï¼Œè¯´æ˜&lt;code&gt;node&lt;/code&gt;æ˜¯&lt;code&gt;head&lt;/code&gt;åçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶å½“å‰è·å–é”èµ„æºçš„çº¿ç¨‹1å¯èƒ½ä¼šé‡Šæ”¾é”ï¼Œæ‰€ä»¥çº¿ç¨‹2å¯ä»¥å†æ¬¡å°è¯•è·å–é”ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å‡è®¾è·å–æˆåŠŸï¼Œè¯æ˜æ‹¿åˆ°é”èµ„æºäº†ï¼Œå°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹è®¾ç½®ä¸º&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹ï¼Œå¹¶å°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹çš„&lt;code&gt;pre&lt;/code&gt;å’Œ&lt;code&gt;thread&lt;/code&gt;è®¾ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ã€‚å› ä¸ºæ‹¿åˆ°é”èµ„æºäº†ï¼Œ&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹å°±ä¸éœ€è¦æ’é˜Ÿäº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°†å¤´èŠ‚ç‚¹pçš„&lt;code&gt;next&lt;/code&gt;ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œæ­¤æ—¶pèŠ‚ç‚¹å°±ä¸åœ¨é˜Ÿåˆ—ä¸­å­˜åœ¨äº†ï¼Œå¯ä»¥å¸®åŠ©&lt;code&gt;GC&lt;/code&gt;å›æ”¶(å¯è¾¾æ€§åˆ†æ)ã€‚&lt;code&gt;failed&lt;/code&gt;è®¾ç½®ä¸º&lt;code&gt;false&lt;/code&gt;ï¼Œè¡¨æ˜è·å–é”æˆåŠŸï¼›&lt;code&gt;interrupted&lt;/code&gt;ä¸º&lt;code&gt;false&lt;/code&gt;ï¼Œåˆ™çº¿ç¨‹ä¸ä¼šä¸­æ–­ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6571428571428571&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2p6Th6NW86sGRdwk9gOrjx63bHRhqrwzHOLAjTDVVBZco7qoa44FbKYA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1050&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœpä¸æ˜¯&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹æˆ–è€…æ²¡æœ‰æ‹¿åˆ°é”èµ„æºï¼Œä¼šæ‰§è¡Œä¸‹è¾¹çš„ä»£ç ï¼Œå› ä¸ºæˆ‘ä»¬çš„çº¿ç¨‹1æ²¡æœ‰é‡Šæ”¾é”èµ„æºï¼Œæ‰€ä»¥çº¿ç¨‹2è·å–é”å¤±è´¥ï¼Œä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//è¯¥æ–¹æ³•çš„ä½œç”¨æ˜¯ä¿è¯ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„waitStatusçŠ¶æ€ä¸º-1ï¼ˆä¸ºäº†å”¤é†’åç»§èŠ‚ç‚¹ï¼‰&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;shouldParkAfterFailedAcquire&lt;/span&gt;&lt;span&gt;(NodeÂ pred,Â NodeÂ node)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;//è·å–ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€,è¯¥çŠ¶æ€ä¸º-1ï¼Œæ‰ä¼šå”¤é†’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;int&lt;/span&gt;Â wsÂ =Â pred.waitStatus;&lt;br/&gt;Â &lt;span&gt;//Â å¦‚æœä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€æ˜¯SIGNALå³-1ï¼Œå¯ä»¥å”¤é†’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›true&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (wsÂ ==Â Node.SIGNAL)&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â &lt;span&gt;//Â å¦‚æœä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€å¤§äº0ï¼Œè¯´æ˜å·²ç»å¤±æ•ˆäº†&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (wsÂ &amp;gt;Â &lt;span&gt;0&lt;/span&gt;)Â {&lt;br/&gt;Â Â &lt;span&gt;do&lt;/span&gt;Â {&lt;br/&gt;Â Â Â &lt;span&gt;//Â å°†nodeÂ çš„èŠ‚ç‚¹ä¸Â predÂ çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ç›¸å…³è”ï¼Œå¹¶å°†å‰ä¸€ä¸ªèŠ‚ç‚¹èµ‹å€¼ç»™Â pred&lt;/span&gt;&lt;br/&gt;Â Â Â node.prevÂ =Â predÂ =Â pred.prev;&lt;br/&gt;Â Â }Â &lt;span&gt;while&lt;/span&gt;Â (pred.waitStatusÂ &amp;gt;Â &lt;span&gt;0&lt;/span&gt;);Â &lt;span&gt;//Â ä¸€ç›´æ‰¾åˆ°å°äºç­‰äº0çš„&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;//Â å°†é‡æ–°æ ‡è¯†å¥½çš„æœ€è¿‘çš„æœ‰æ•ˆèŠ‚ç‚¹çš„Â nextÂ æŒ‡å‘å½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â pred.nextÂ =Â node;&lt;br/&gt;Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â &lt;span&gt;//Â å°äºç­‰äº0ï¼Œä½†æ˜¯ä¸ç­‰äº-1ï¼Œå°†ä¸Šä¸€ä¸ªæœ‰æ•ˆèŠ‚ç‚¹çŠ¶æ€ä¿®æ”¹ä¸º-1&lt;/span&gt;&lt;br/&gt;Â Â compareAndSetWaitStatus(pred,Â ws,Â Node.SIGNAL);&lt;br/&gt;Â }&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;åªæœ‰èŠ‚ç‚¹çš„çŠ¶æ€ä¸º-1ï¼Œæ‰ä¼šå”¤é†’åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœèŠ‚ç‚¹çŠ¶æ€æœªè®¾ç½®ï¼Œé»˜è®¤ä¸º0ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å›¾è§£ä¸€ä¸‹&lt;code&gt;ws&amp;gt;0&lt;/code&gt;çš„è¿‡ç¨‹ï¼Œå› ä¸º&lt;code&gt;ws&amp;gt;0&lt;/code&gt;çš„èŠ‚ç‚¹ä¸ºå¤±æ•ˆèŠ‚ç‚¹ï¼Œæ‰€ä»¥&lt;code&gt;do...while&lt;/code&gt;ä¸­ä¼šé‡å¤å‘å‰æŸ¥æ‰¾å‰é©±èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ª&lt;code&gt;ws&amp;lt;=0&lt;/code&gt;çš„èŠ‚ç‚¹ä¸ºæ­¢ï¼Œå°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹æŒ‚åˆ°è¯¥èŠ‚ç‚¹ä¸Šã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.611965811965812&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2piaOhg4jjiaUUv4HpfRt8VEo90Qv8aROA6LIeWpdnCWKtUndcSQmEppFA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1170&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬çš„&lt;code&gt;pred&lt;/code&gt;æ˜¯å¤´ç»“ç‚¹ä¸”æœªè®¾ç½®çŠ¶æ€ï¼Œæ‰€ä»¥çŠ¶æ€ä¸º0ï¼Œä¼šèµ°&lt;code&gt;else&lt;/code&gt;ã€‚é€šè¿‡&lt;code&gt;CAS&lt;/code&gt;å°è¯•å°†&lt;code&gt;pred&lt;/code&gt;èŠ‚ç‚¹çš„&lt;code&gt;waitStatus&lt;/code&gt;è®¾ç½®ä¸º-1ï¼Œè¡¨æ˜&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹éœ€è¦è¢«&lt;code&gt;pred&lt;/code&gt;å”¤é†’ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6170009551098377&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pcoxEbW5zPHyqDOE7DPElqmiawJQfrMoFU0MuwAVf6tsRjjP4JgxP34A/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1047&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;shouldParkAfterFailedAcquire()&lt;/code&gt;è¿”å›&lt;code&gt;false&lt;/code&gt;ï¼Œç»§ç»­æ‰§è¡Œ&lt;code&gt;acquireQueued()&lt;/code&gt;ä¸­çš„æ­»å¾ªç¯ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¥éª¤å’Œä¸Šè¾¹ä¸€æ ·ï¼Œ&lt;code&gt;node&lt;/code&gt;çš„å‰é©±èŠ‚ç‚¹è¿˜æ˜¯&lt;code&gt;head&lt;/code&gt;ï¼Œç»§ç»­å°è¯•è·å–é”ã€‚å¦‚æœçº¿ç¨‹1é‡Šæ”¾äº†é”ï¼Œçº¿ç¨‹2å°±å¯ä»¥æ‹¿åˆ°ï¼Œè¿”å›&lt;code&gt;true&lt;/code&gt;ï¼›å¦åˆ™ç»§ç»­è°ƒç”¨&lt;code&gt;shouldParkAfterFailedAcquire()&lt;/code&gt;ï¼Œå› ä¸ºä¸Šä¸€æ­¥å·²ç»å°†å‰é©±ç»“ç‚¹çš„&lt;code&gt;ws&lt;/code&gt;è®¾ç½®ä¸º-1äº†ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›&lt;code&gt;true&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰§è¡Œ&lt;code&gt;parkAndCheckInterrupt()&lt;/code&gt;æ–¹æ³•ï¼Œé€šè¿‡&lt;code&gt;UNSAFE.park();&lt;/code&gt;æ–¹æ³•é˜»å¡å½“å‰çº¿ç¨‹2ã€‚ç­‰ä»¥åæ‰§è¡Œ&lt;code&gt;unpark&lt;/code&gt;æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœ&lt;code&gt;node&lt;/code&gt;æ˜¯å¤´èŠ‚ç‚¹åçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¼šè¿›å…¥&lt;code&gt;acquireQueued()&lt;/code&gt;æ–¹æ³•ä¸­èµ°&lt;code&gt;if (p == head &amp;amp;&amp;amp; tryAcquire(arg))&lt;/code&gt;çš„é€»è¾‘è·å–é”èµ„æºå¹¶ç»“æŸæ­»å¾ªç¯ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹cancelAcquire()æ–¹æ³•&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯¥æ–¹æ³•æ‰§è¡Œçš„æœºç‡çº¦ç­‰äº0ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´å‘¢ï¼Ÿå› ä¸ºé’ˆå¯¹&lt;code&gt;failed&lt;/code&gt;å±æ€§ï¼Œåªæœ‰&lt;code&gt;JVM&lt;/code&gt;å†…éƒ¨å‡ºç°é—®é¢˜æ—¶ï¼Œæ‰å¯èƒ½å‡ºç°å¼‚å¸¸ï¼Œæ‰§è¡Œè¯¥æ–¹æ³•ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â nodeÂ ä¸ºå½“å‰èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;cancelAcquire&lt;/span&gt;&lt;span&gt;(NodeÂ node)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (nodeÂ ==Â &lt;span&gt;null&lt;/span&gt;)&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;;&lt;br/&gt;Â node.threadÂ =Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;Â &lt;span&gt;//Â ä¸Šä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â NodeÂ predÂ =Â node.prev;&lt;br/&gt;Â &lt;span&gt;//Â èŠ‚ç‚¹çŠ¶æ€å¤§äº0ï¼Œè¯´æ˜èŠ‚ç‚¹å¤±æ•ˆ&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;while&lt;/span&gt;Â (pred.waitStatusÂ &amp;gt;Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â node.prevÂ =Â predÂ =Â pred.prev;&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;//Â å°†ç¬¬ä¸€ä¸ªä¸æ˜¯å¤±æ•ˆèŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹å£°æ˜å‡ºæ¥&lt;/span&gt;&lt;br/&gt;Â NodeÂ predNextÂ =Â pred.next;&lt;br/&gt;Â &lt;span&gt;//Â èŠ‚ç‚¹çŠ¶æ€å˜ä¸ºå¤±æ•ˆ&lt;/span&gt;&lt;br/&gt;Â node.waitStatusÂ =Â Node.CANCELLED;&lt;br/&gt;Â &lt;span&gt;//Â nodeä¸ºå°¾èŠ‚ç‚¹ï¼Œcasè®¾ç½®predä¸ºå°¾èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (nodeÂ ==Â tailÂ &amp;amp;&amp;amp;Â compareAndSetTail(node,Â pred))Â {&lt;br/&gt;Â Â &lt;span&gt;//caså°†predçš„nextè®¾ç½®ä¸ºnull&lt;/span&gt;&lt;br/&gt;Â Â compareAndSetNext(pred,Â predNext,Â &lt;span&gt;null&lt;/span&gt;);&lt;br/&gt;Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â &lt;span&gt;int&lt;/span&gt;Â ws;&lt;br/&gt;Â Â &lt;span&gt;//Â ä¸­é—´èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;//Â å¦‚æœä¸Šä¸€ä¸ªèŠ‚ç‚¹ä¸æ˜¯headÂ èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (predÂ !=Â headÂ &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â ((wsÂ =Â pred.waitStatus)Â ==Â Node.SIGNALÂ ||&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â å‰è¾¹å·²ç»åˆ¤æ–­äº†å¤§äº0çš„æ“ä½œï¼Œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â predÂ æ˜¯éœ€è¦å”¤é†’åç»§èŠ‚ç‚¹çš„ï¼Œæ‰€ä»¥å½“Â waitStatusÂ ä¸ä¸ºÂ -1Â æ—¶ï¼Œéœ€è¦å°†Â predÂ èŠ‚ç‚¹çš„Â waitStatusÂ è®¾ç½®ä¸ºÂ -1Â &lt;/span&gt;&lt;br/&gt;Â Â Â Â (wsÂ &amp;lt;=Â &lt;span&gt;0&lt;/span&gt;Â &amp;amp;&amp;amp;Â compareAndSetWaitStatus(pred,Â ws,Â Node.SIGNAL)))Â &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â pred.threadÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â NodeÂ nextÂ =Â node.next;&lt;br/&gt;Â Â Â &lt;span&gt;if&lt;/span&gt;Â (nextÂ !=Â &lt;span&gt;null&lt;/span&gt;Â &amp;amp;&amp;amp;Â next.waitStatusÂ &amp;lt;=Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â CASÂ å°è¯•å°†Â predÂ çš„Â nextÂ æŒ‡å‘å½“å‰èŠ‚ç‚¹çš„Â next&lt;/span&gt;&lt;br/&gt;Â Â Â Â compareAndSetNext(pred,Â predNext,Â next);&lt;br/&gt;Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â &lt;span&gt;//Â headÂ èŠ‚ç‚¹ï¼Œå”¤é†’åç»§èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â unparkSuccessor(node);&lt;br/&gt;Â Â }&lt;br/&gt;&lt;br/&gt;Â Â node.nextÂ =Â node;Â &lt;span&gt;//Â helpÂ GC&lt;/span&gt;&lt;br/&gt;Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰§è¡Œåˆ°&lt;code&gt;while&lt;/code&gt;æ—¶æ‰¾åˆ°å‰é©±èŠ‚ç‚¹ä¸­æœ€è¿‘çš„æœ‰æ•ˆèŠ‚ç‚¹ï¼ŒæŠŠå½“å‰èŠ‚ç‚¹&lt;code&gt;node&lt;/code&gt;æŒ‚åˆ°æœ‰æ•ˆèŠ‚ç‚¹åè¾¹ï¼Œå¯ä»¥è¿‡æ»¤æ‰å½“å‰èŠ‚ç‚¹å‰çš„å¤±æ•ˆèŠ‚ç‚¹ã€‚å£°æ˜å‡ºæœ‰æ•ˆèŠ‚ç‚¹çš„ç¬¬ä¸€ä¸ªåç»§æ— æ•ˆèŠ‚ç‚¹&lt;code&gt;predNext&lt;/code&gt;ï¼Œå¹¶æŠŠå½“å‰çš„&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹çŠ¶æ€è®¾ç½®ä¸ºå¤±æ•ˆçŠ¶æ€ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4808219178082192&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pcKWLnKoEh33VAmssQQqeRXZHua57kN08fSUP1BObsiabRxVVcLN5vcw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;730&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;if&lt;/code&gt;ä¸­çš„æ“ä½œï¼šå¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯å°¾èŠ‚ç‚¹ï¼Œ&lt;code&gt;CAS&lt;/code&gt;å°è¯•å°†æœ€è¿‘çš„æœ‰æ•ˆèŠ‚ç‚¹è®¾ç½®ä¸ºå°¾èŠ‚ç‚¹ï¼Œå¹¶å°†å°¾èŠ‚ç‚¹çš„&lt;code&gt;next&lt;/code&gt;è®¾ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3598901098901099&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pazKPf17j7RyjZVplaCcv8bOkVqfPBavYiawhshybAMwPgHic4LSu6tiaA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1092&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;else&lt;/code&gt;ä¸­çš„æ“ä½œï¼š&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœ&lt;code&gt;pred&lt;/code&gt;èŠ‚ç‚¹ä¸æ˜¯å¤´ç»“ç‚¹å³ä¸­é—´èŠ‚ç‚¹ï¼Œå¹¶ä¸”&lt;code&gt;pred&lt;/code&gt;çš„&lt;code&gt;waitStatus&lt;/code&gt;ä¸º-1æˆ–è€…&lt;code&gt;waitStatus&amp;lt;=0&lt;/code&gt;ï¼Œä¸ºäº†è®©&lt;code&gt;pred&lt;/code&gt;èŠ‚ç‚¹èƒ½å”¤é†’åç»§èŠ‚ç‚¹ï¼Œéœ€è¦è®¾ç½®ä¸º-1ï¼Œå¹¶ä¸”&lt;code&gt;pred&lt;/code&gt;èŠ‚ç‚¹çš„çº¿ç¨‹ä¸ä¸ºç©ºã€‚è·å–&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ï¼Œå¦‚æœåç»§èŠ‚ç‚¹æœ‰æ•ˆï¼Œ&lt;code&gt;CAS&lt;/code&gt;å°è¯•å°†&lt;code&gt;pred&lt;/code&gt;çš„&lt;code&gt;next&lt;/code&gt;æŒ‡å‘&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹çš„&lt;code&gt;next&lt;/code&gt;ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2698289269051322&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2p9kZicgQriauOUbSbf6BUtRYFtTFPedG3CyicjZGIcMegU4R4HmOxjHsicw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1286&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“å…¶ä»–èŠ‚ç‚¹æ¥æ‰¾æœ‰æ•ˆèŠ‚ç‚¹çš„æ—¶å€™èµ°å½“å‰&lt;code&gt;node&lt;/code&gt;çš„&lt;code&gt;prev&lt;/code&gt;è¿™æ¡çº¿ï¼Œè€Œä¸æ˜¯å†ä¸€ä¸ªä¸€ä¸ªå¾€å‰æ‰¾ï¼Œå¯ä»¥æé«˜æ•ˆç‡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœæ˜¯å¤´ç»“ç‚¹åˆ™å”¤é†’åç»§èŠ‚ç‚¹ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€åå°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹çš„&lt;code&gt;next&lt;/code&gt;æŒ‡å‘è‡ªå·±ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;è§£é”&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‡Šæ”¾é”æ˜¯ä¸åŒºåˆ†å…¬å¹³é”å’Œéå…¬å¹³é”çš„ï¼Œé‡Šæ”¾é”çš„æ ¸å¿ƒæ˜¯å°†&lt;code&gt;state&lt;/code&gt;ç”±å¤§äº 0 çš„æ•°ç½®ä¸º 0ã€‚åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šä»£ç &lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//é‡Šæ”¾é”æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;unlock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â sync.release(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;release&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â arg)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â &lt;span&gt;//å°è¯•é‡Šæ”¾é”èµ„æºï¼Œå¦‚æœé‡Šæ”¾æˆåŠŸï¼Œè¿”å›true&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (tryRelease(arg))Â {&lt;br/&gt;Â Â NodeÂ hÂ =Â head;&lt;br/&gt;Â Â &lt;span&gt;//Â headÂ ä¸ä¸ºç©ºä¸”Â headÂ çš„Â wsÂ ä¸ä¸º0ï¼ˆå¦‚æœä¸º0ï¼Œä»£è¡¨åè¾¹æ²¡æœ‰å…¶ä»–çº¿ç¨‹æŒ‚èµ·ï¼‰&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â (hÂ !=Â &lt;span&gt;null&lt;/span&gt;Â &amp;amp;&amp;amp;Â h.waitStatusÂ !=Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â &lt;span&gt;//Â AQSçš„é˜Ÿåˆ—ä¸­æœ‰Â nodeÂ åœ¨æ’é˜Ÿï¼Œå¹¶ä¸”çº¿ç¨‹å·²ç»æŒ‚èµ·&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;//Â éœ€è¦å”¤é†’è¢«æŒ‚èµ·çš„Â Node&lt;/span&gt;&lt;br/&gt;Â Â Â unparkSuccessor(h);&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â }&lt;br/&gt;Â &lt;span&gt;//Â ä»£è¡¨é‡Šæ”¾ä¸€æ¬¡æ²¡æœ‰å®Œå…¨é‡Šæ”¾&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœé‡Šæ”¾é”æˆåŠŸï¼Œéœ€è¦è·å–&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹ã€‚å¦‚æœå¤´ç»“ç‚¹ä¸ä¸ºç©ºä¸”&lt;code&gt;waitStatus&lt;/code&gt;ä¸ä¸º0ï¼Œåˆ™è¯æ˜æœ‰&lt;code&gt;node&lt;/code&gt;åœ¨æ’é˜Ÿï¼Œæ‰§è¡Œå”¤é†’æŒ‚èµ·å…¶ä»–&lt;code&gt;node&lt;/code&gt;çš„æ“ä½œã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹tryRelease()æ–¹æ³•&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;tryRelease&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â releases)&lt;/span&gt;Â &lt;/span&gt;&lt;span&gt;{&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;//è·å–å½“å‰é”çš„çŠ¶æ€ï¼Œå…ˆè¿›è¡Œå‡1æ“ä½œï¼Œä»£è¡¨é‡Šæ”¾ä¸€æ¬¡é”èµ„æº&lt;/span&gt;&lt;span&gt;&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;Â cÂ =Â getState()Â -Â releases;&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;//å¦‚æœé‡Šæ”¾é”çš„çº¿ç¨‹ä¸æ˜¯å ç”¨é”çš„çº¿ç¨‹ï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸&lt;/span&gt;&lt;span&gt;&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â (Thread.currentThread()Â !=Â getExclusiveOwnerThread())&lt;br/&gt;Â Â &lt;/span&gt;&lt;span&gt;throw&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;new&lt;/span&gt;&lt;span&gt;Â IllegalMonitorStateException();&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;boolean&lt;/span&gt;&lt;span&gt;Â freeÂ =Â &lt;/span&gt;&lt;span&gt;false&lt;/span&gt;&lt;span&gt;;&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;//Â å¦‚æœÂ cÂ ä¸º0Â ï¼Œä»£è¡¨é”å®Œå…¨é‡Šæ”¾äº†ï¼Œå¦‚æœä¸ä¸º0ï¼Œä»£è¡¨é”ä¹‹å‰é‡å…¥äº†ï¼Œä¸€æ¬¡æ²¡é‡Šæ”¾æ‰ï¼Œç­‰å¾…ä¸‹æ¬¡å†æ¬¡æ‰§è¡Œæ—¶ï¼Œå†æ¬¡åˆ¤æ–­&lt;/span&gt;&lt;span&gt;&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt;Â (cÂ ==Â &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;)Â {&lt;br/&gt;Â Â &lt;/span&gt;&lt;span&gt;//Â é‡Šæ”¾é”æ ‡å¿—ä¸ºÂ trueï¼Œä»£è¡¨å®Œå…¨é‡Šæ”¾äº†&lt;/span&gt;&lt;span&gt;&lt;br/&gt;Â Â freeÂ =Â &lt;/span&gt;&lt;span&gt;true&lt;/span&gt;&lt;span&gt;;&lt;br/&gt;Â Â &lt;/span&gt;&lt;span&gt;//Â å°†å ç”¨äº’æ–¥é”çš„æ ‡è¯†ç½®ä¸ºÂ null&lt;/span&gt;&lt;span&gt;&lt;br/&gt;Â Â setExclusiveOwnerThread(&lt;/span&gt;&lt;span&gt;null&lt;/span&gt;&lt;span&gt;);&lt;br/&gt;Â }&lt;br/&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt; &lt;/span&gt;&lt;/span&gt;&lt;span&gt;//Â è®¾ç½®Â stateÂ çŠ¶æ€&lt;/span&gt;&lt;span&gt;&lt;br/&gt;Â setState(c);&lt;br/&gt;Â &lt;/span&gt;&lt;span&gt;return&lt;/span&gt;&lt;span&gt;Â free;&lt;br/&gt;}&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬çš„ä¾‹å­ä¸­çº¿ç¨‹1å ç”¨é”èµ„æºï¼Œçº¿ç¨‹1é‡Šæ”¾é”ä¹‹åï¼Œ&lt;code&gt;state&lt;/code&gt;ä¸º0ã€‚è¿›å…¥&lt;code&gt;if&lt;/code&gt;æ“ä½œï¼Œå°†é‡Šæ”¾æ ‡å¿—æ›´æ–°ä¸º&lt;code&gt;true&lt;/code&gt;ï¼Œå°†&lt;code&gt;FIFO&lt;/code&gt;é˜Ÿåˆ—çš„&lt;code&gt;exclusiveOwnerThread&lt;/code&gt;æ ‡å¿—ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5366079703429101&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pZYdxaoOTX1y38TicBhpDDgm3P3DsuRiaC7kk7nEAZfSzGUSUwb4G2DVQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1079&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹unparkSuccessor()æ–¹æ³•&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç”¨äºå”¤é†’&lt;code&gt;AQS&lt;/code&gt;ä¸­è¢«æŒ‚èµ·çš„çº¿ç¨‹ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â æ³¨æ„å½“å‰çš„Â nodeÂ èŠ‚ç‚¹æ˜¯Â headÂ èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;unparkSuccessor&lt;/span&gt;&lt;span&gt;(NodeÂ node)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â &lt;span&gt;//è·å–Â headÂ çš„çŠ¶æ€&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;int&lt;/span&gt;Â wsÂ =Â node.waitStatus;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (wsÂ &amp;lt;Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â &lt;span&gt;//Â CASÂ å°†Â nodeÂ çš„Â wsÂ è®¾ç½®ä¸º0ï¼Œä»£è¡¨å½“å‰Â nodeÂ æ¥ä¸‹æ¥ä¼šèˆå¼ƒ&lt;/span&gt;&lt;br/&gt;Â Â compareAndSetWaitStatus(node,Â ws,Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;//Â è·å–å¤´èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â NodeÂ sÂ =Â node.next;&lt;br/&gt;Â &lt;span&gt;//Â å¦‚æœä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ºnullÂ æˆ–è€…Â ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ºå¤±æ•ˆèŠ‚ç‚¹ï¼Œéœ€è¦æ‰¾åˆ°ç¦»Â headÂ æœ€è¿‘çš„æœ‰æ•ˆnode&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (sÂ ==Â &lt;span&gt;null&lt;/span&gt;Â ||Â s.waitStatusÂ &amp;gt;Â &lt;span&gt;0&lt;/span&gt;)Â {&lt;br/&gt;Â Â sÂ =Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;Â Â &lt;span&gt;//Â ä»å°¾èŠ‚ç‚¹å¼€å§‹å¾€å‰æ‰¾ä¸ç­‰äºnullä¸”ä¸æ˜¯nodeçš„èŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â &lt;span&gt;for&lt;/span&gt;Â (NodeÂ tÂ =Â tail;Â tÂ !=Â &lt;span&gt;null&lt;/span&gt;Â &amp;amp;&amp;amp;Â tÂ !=Â node;Â tÂ =Â t.prev)&lt;br/&gt;Â Â Â &lt;span&gt;//Â å¦‚æœè¯¥èŠ‚ç‚¹æœ‰æ•ˆï¼Œåˆ™å°†sèŠ‚ç‚¹æŒ‡å‘tèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â &lt;span&gt;if&lt;/span&gt;Â (t.waitStatusÂ &amp;lt;=Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â Â sÂ =Â t;&lt;br/&gt;Â }&lt;br/&gt;Â Â &lt;span&gt;//Â æ‰¾åˆ°æœ€è¿‘çš„nodeåï¼Œç›´æ¥å”¤é†’&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â (sÂ !=Â &lt;span&gt;null&lt;/span&gt;)&lt;br/&gt;Â Â LockSupport.unpark(s.thread);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é—®é¢˜è§£æï¼šä¸ºä»€ä¹ˆè¦ä»å°¾ç»“ç‚¹å¾€å‰æŸ¥æ‰¾å‘¢ï¼Ÿ&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å› ä¸ºåœ¨&lt;code&gt;addWaiter&lt;/code&gt;æ–¹æ³•ä¸­æ˜¯å…ˆç»™&lt;code&gt;prev&lt;/code&gt;æŒ‡é’ˆèµ‹å€¼ï¼Œæœ€åæ‰å°†ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„&lt;code&gt;next&lt;/code&gt;æŒ‡é’ˆèµ‹å€¼ï¼Œä¸ºäº†é¿å…é˜²æ­¢ä¸¢å¤±èŠ‚ç‚¹æˆ–è€…è·³è¿‡èŠ‚ç‚¹ï¼Œå¿…é¡»ä»åå¾€å‰æ‰¾ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬ä¸¾ä¾‹ä¸­&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹çš„çŠ¶æ€ä¸º&lt;code&gt;-1&lt;/code&gt;ï¼Œé€šè¿‡&lt;code&gt;CAS&lt;/code&gt;çš„æ–¹å¼å°†&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹çš„&lt;code&gt;waitStatus&lt;/code&gt;è®¾ç½®ä¸º0ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6102514506769826&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pOCBpJLJ0sBHiaZWLLibje87Znicia24v9Rl7tZaV6bz9wDMZ4ETBu2BG5w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1034&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬çš„å¤´ç»“ç‚¹çš„åç»§èŠ‚ç‚¹æ˜¯çº¿ç¨‹2æ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œä¸ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œæ‰€ä»¥è¿™è¾¹ä¼šæ‰§è¡Œ&lt;code&gt;unpark&lt;/code&gt;æ“ä½œï¼Œä»ä¸Šè¾¹çš„&lt;code&gt;acquireQueued()&lt;/code&gt;å†…çš„&lt;code&gt;parkAndCheckInterrupt()&lt;/code&gt;æ–¹æ³•ç»§ç»­æ‰§è¡Œã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;parkAndCheckInterrupt&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â LockSupport.park(&lt;span&gt;this&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;//è¿”å›ç›®æ ‡çº¿ç¨‹æ˜¯å¦ä¸­æ–­çš„å¸ƒå°”å€¼:ä¸­æ–­è¿”å›trueï¼Œä¸ä¸­æ–­è¿”å›falseï¼Œä¸”è¿”å›åä¼šé‡ç½®ä¸­æ–­çŠ¶æ€ä¸ºæœªä¸­æ–­&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â Thread.interrupted();&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å› ä¸ºçº¿ç¨‹2æœªä¸­æ–­ï¼Œæ‰€ä»¥è¿”å›&lt;code&gt;false&lt;/code&gt;ã€‚ç»§ç»­æ‰§è¡Œ&lt;code&gt;acquireQueued()&lt;/code&gt;ä¸­çš„æ­»å¾ªç¯&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;for&lt;/span&gt;Â (;;)Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â è·å–å½“å‰èŠ‚ç‚¹çš„ä¸Šä¸€ä¸ªèŠ‚ç‚¹&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;final&lt;/span&gt;Â NodeÂ pÂ =Â node.predecessor();&lt;br/&gt;Â Â Â Â &lt;span&gt;//pä¸ºå¤´èŠ‚ç‚¹ï¼Œå°è¯•è·å–é”æ“ä½œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (pÂ ==Â headÂ &amp;amp;&amp;amp;Â tryAcquire(arg))Â {&lt;br/&gt;Â Â Â Â Â Â Â Â setHead(node);&lt;br/&gt;Â Â Â Â Â Â Â Â p.nextÂ =Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â å°†è·å–é”å¤±è´¥æ ‡è¯†ç½®ä¸ºfalse&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â failedÂ =Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â è·å–åˆ°é”èµ„æºï¼Œä¸ä¼šè¢«ä¸­æ–­&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â interrupted;&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â pÂ ä¸æ˜¯Â headÂ æˆ–è€…Â æ²¡æ‹¿åˆ°é”èµ„æºï¼Œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (shouldParkAfterFailedAcquire(p,Â node)Â &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â åŸºäºÂ UnsafeÂ çš„Â parkæ–¹æ³•ï¼ŒæŒ‚èµ·çº¿ç¨‹&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â parkAndCheckInterrupt())&lt;br/&gt;Â Â Â Â Â Â Â Â interruptedÂ =Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¤æ—¶pæ˜¯å¤´èŠ‚ç‚¹ï¼Œä¸”èƒ½è·å–é”æˆåŠŸï¼Œå°†&lt;code&gt;exclusiveOwnerThread&lt;/code&gt;è®¾ç½®ä¸ºçº¿ç¨‹2ï¼Œå³çº¿ç¨‹2 è·å–é”èµ„æºã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹è®¾ç½®ä¸º&lt;code&gt;head&lt;/code&gt;èŠ‚ç‚¹ï¼Œå¹¶å°†&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹çš„&lt;code&gt;pre&lt;/code&gt;å’Œ&lt;code&gt;thread&lt;/code&gt;è®¾ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ã€‚å› ä¸ºæ‹¿åˆ°é”èµ„æºäº†ï¼Œ&lt;code&gt;node&lt;/code&gt;èŠ‚ç‚¹å°±ä¸éœ€è¦æ’é˜Ÿäº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°†å¤´èŠ‚ç‚¹pçš„&lt;code&gt;next&lt;/code&gt;ç½®ä¸º&lt;code&gt;null&lt;/code&gt;ï¼Œæ­¤æ—¶pèŠ‚ç‚¹å°±ä¸åœ¨é˜Ÿåˆ—ä¸­å­˜åœ¨äº†ï¼Œå¯ä»¥å¸®åŠ©&lt;code&gt;GC&lt;/code&gt;å›æ”¶(å¯è¾¾æ€§åˆ†æ)ã€‚&lt;code&gt;failed&lt;/code&gt;è®¾ç½®ä¸º&lt;code&gt;false&lt;/code&gt;ï¼Œè¡¨æ˜è·å–é”æˆåŠŸï¼›&lt;code&gt;interrupted&lt;/code&gt;ä¸º&lt;code&gt;false&lt;/code&gt;ï¼Œåˆ™çº¿ç¨‹ä¸ä¼šä¸­æ–­ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.7521367521367521&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2puqyW9XU80hIsibda5MhdvZRnXNsAjXlkpnwDiaP7rUwzxFojHmfmZIDg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;936&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºä»€ä¹ˆè¢«å”¤é†’çš„çº¿ç¨‹è¦è°ƒç”¨Thread.interrupted()æ¸…é™¤ä¸­æ–­æ ‡è®°&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»ä¸Šè¾¹çš„æ–¹æ³•å¯ä»¥çœ‹å‡ºï¼Œå½“&lt;code&gt;parkAndCheckInterrupt()&lt;/code&gt;æ–¹æ³•è¿”å›&lt;code&gt;true&lt;/code&gt;æ—¶ï¼Œå³&lt;code&gt;Thread.interrupted()&lt;/code&gt;æ–¹æ³•è¿”å›äº†&lt;code&gt;true&lt;/code&gt;ï¼Œä¹Ÿå°±æ˜¯è¯¥çº¿ç¨‹è¢«ä¸­æ–­äº†ã€‚ä¸ºäº†è®©è¢«å”¤é†’çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œåç»­è·å–é”çš„æ“ä½œï¼Œå°±éœ€è¦è®©ä¸­æ–­çš„çº¿ç¨‹åƒæ²¡æœ‰è¢«ä¸­æ–­è¿‡ä¸€æ ·ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ‰€ä»¥åœ¨è¿”å›ä¸­æ–­æ ‡è®°çš„åŒæ—¶è¦æ¸…é™¤ä¸­æ–­æ ‡è®°ï¼Œå°†å…¶è®¾ç½®ä¸º&lt;code&gt;false&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¸…é™¤ä¸­æ–­æ ‡è®°ä¹‹åä¸ä»£è¡¨è¯¥çº¿ç¨‹ä¸éœ€è¦ä¸­æ–­äº†ï¼Œæ‰€ä»¥åœ¨&lt;code&gt;parkAndCheckInterrupt()&lt;/code&gt;æ–¹æ³•è¿”å›&lt;code&gt;true&lt;/code&gt;æ—¶ï¼Œè¦è‡ªå·±è®¾ç½®ä¸€ä¸ªä¸­æ–­æ ‡å¿—&lt;code&gt;interrupted = true&lt;/code&gt;ï¼Œä¸ºçš„å°±æ˜¯å½“è·å–åˆ°é”èµ„æºæ‰§è¡Œå®Œç›¸å…³çš„æ“ä½œä¹‹åè¿›è¡Œä¸­æ–­è¡¥å¿ï¼Œæ•…è€Œéœ€è¦æ‰§è¡Œ&lt;code&gt;selfInterrupt()&lt;/code&gt;æ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬åŠ é”è§£é”çš„å›¾è§£è¿‡ç¨‹äº†ã€‚æœ€åæˆ‘ä»¬å†æ¥è¯´ä¸€ä¸‹å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;åŒºåˆ«&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å‰è¾¹å·²ç»è¯´è¿‡äº†ï¼Œä¼¼ä¹éå…¬å¹³é”åŒ…å«äº†å…¬å¹³é”çš„å…¨éƒ¨æ“ä½œã€‚æ‰“å¼€å…¬å¹³é”çš„ä»£ç ï¼Œæˆ‘ä»¬å‘ç°&lt;code&gt;accquire()&lt;/code&gt;æ–¹æ³•ä¸­åªæœ‰è¯¥æ–¹æ³•çš„å®ç°æœ‰ç‚¹åŒºåˆ«ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8236040609137056&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/55HPQyguvpPBhg9teBc79RAt13jsfx2pibtvDzPzQG1odBkib7PrsgC0f8riaJQTQpq7u0vjbfyJncE0MlPB6EBBg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;788&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;hasQueuedPredecessors()&lt;/code&gt;è¿”å›&lt;code&gt;false&lt;/code&gt;æ—¶æ‰ä¼šå°è¯•è·å–é”èµ„æºã€‚è¯¥æ–¹æ³•ä»£ç å®ç°å¦‚ä¸‹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;hasQueuedPredecessors&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â NodeÂ tÂ =Â tail;Â &lt;br/&gt;Â Â Â Â NodeÂ hÂ =Â head;&lt;br/&gt;Â Â Â Â NodeÂ s;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â hÂ !=Â tÂ &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â Â Â Â Â Â ((sÂ =Â h.next)Â ==Â &lt;span&gt;null&lt;/span&gt;Â ||Â s.threadÂ !=Â Thread.currentThread());&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;h==t&lt;/code&gt;æ—¶ï¼Œé˜Ÿåˆ—ä¸ºç©ºï¼Œè¡¨ç¤ºæ²¡äººæ’é˜Ÿï¼Œå¯ä»¥è·å–é”èµ„æºï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œå¤´ç»“ç‚¹æœ‰åç»§èŠ‚ç‚¹ä¸ä¸ºç©ºä¸”sèŠ‚ç‚¹è·å–é”çš„çº¿ç¨‹æ˜¯å½“å‰çº¿ç¨‹ä¹Ÿå¯ä»¥è·å–é”èµ„æºï¼Œä»£è¡¨é”é‡å…¥æ“ä½œï¼›&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬çš„å…¨éƒ¨å†…å®¹äº†ï¼Œæˆ‘ä»¬åœ¨æœ€åå†åšä¸ªæ€»ç»“ï¼š&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;ä»£ç ä½¿ç”¨è¦åˆä¹è§„èŒƒï¼Œé¿å…åŠ é”æˆåŠŸåï¼Œåœ¨&lt;code&gt;finally&lt;/code&gt;ä¸­æ— æ³•è§£é”ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ç†è§£&lt;code&gt;AQS&lt;/code&gt;çš„&lt;code&gt;FIFO&lt;/code&gt;é˜Ÿåˆ—ä»¥åŠ&lt;code&gt;Node&lt;/code&gt;çš„ç›¸å…³å±æ€§ï¼Œå°¤å…¶æ³¨æ„&lt;code&gt;waitStatus&lt;/code&gt;çš„çŠ¶æ€ï¼›&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;åˆ©ç”¨å›¾åŠ æ·±å¯¹éå…¬å¹³é”æºç çš„ç†è§£ï¼›&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>31427bc13e77fa17f0aa374d289eb27a</guid>
<title>æˆ‘ç”»äº† 42 å¼ å›¾çˆ†è‚ Nacos æºç ï¼Œè·Ÿç€çœ‹ä¸€éä¿è¯å¤§å®¶éƒ½å­¦åºŸäº†</title>
<link>https://toutiao.io/k/6s1twtt</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;ã€ŒÂ &lt;/strong&gt;å…³æ³¨&lt;/span&gt;&lt;span&gt;&lt;strong&gt;â€œçŸ³æ‰çš„æ¶æ„ç¬”è®°â€&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ï¼Œå¤§å‚æ¶æ„ç»éªŒ&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;å€¾å›Šç›¸æˆ&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;Â &lt;strong&gt;ã€&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1.7786666666666666&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/1J6IbIcPCLbJbVwpE6KkQ3uSdUskKzrUSMYhGU1tKgaSdvUvXOicExwsSQjoiaIxA2av43tbR9mmjlibQaiaeunhOw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;750&quot;/&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;æ–‡ç« æ¥æºï¼šã€å…¬ä¼—å·ï¼š&lt;/span&gt;&lt;span&gt;CodeFox&lt;/span&gt;&lt;span&gt;ã€‘&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/3GHDOauYyUGbiaHXGx1ib5UxkKzSNtpMzY5tbbGdibG7icBSxlH783x1YTF0icAv8MWrmanB4u5qjyKfmYo1dDf7YbA/640?wx_fmt=gif&quot; data-w=&quot;100&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;å‰è¨€&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¤§å®¶å¥½ï¼Œè¿™ç¯‡æ–‡ç« è·Ÿå¤§å®¶èŠä¸‹ SpringCloudAlibaba ä¸­çš„å¾®æœåŠ¡ç»„ä»¶ Nacosã€‚&lt;/span&gt;&lt;span&gt;Nacos æ—¢èƒ½åšæ³¨å†Œä¸­å¿ƒï¼Œåˆèƒ½åšé…ç½®ä¸­å¿ƒï¼Œè¿™ç¯‡æ–‡ç« ä¸»è¦æ¥èŠä¸‹åšé…ç½®ä¸­å¿ƒæ—¶ client ç«¯çš„ä¸€äº›è®¾è®¡ï¼Œä¸»è¦ä»æºç å±‚é¢è¿›è¡Œåˆ†æï¼Œç›¸ä¿¡çœ‹å®Œè¿™ç¯‡æ–‡ç« ä½ å¯¹ Nacos client ç«¯çš„å·¥ä½œåŸç†åº”è¯¥æœ‰æ¯”è¾ƒæ·±åˆ»çš„äº†è§£ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;SpringCloud åº”ç”¨å¯åŠ¨æ‹‰å»é…ç½®&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ä¹‹å‰å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œä»‹ç»äº†ä¸€äº› Spring æä¾›çš„æ‰©å±•æœºåˆ¶ã€‚å…¶ä¸­è¯´åˆ°äº†Â &lt;strong&gt;ApplicationContextInitializer&lt;/strong&gt;ï¼Œè¯¥æ‰©å±•æ˜¯åœ¨ä¸Šä¸‹æ–‡å‡†å¤‡é˜¶æ®µï¼ˆprepareContextï¼‰ï¼Œå®¹å™¨åˆ·æ–°ä¹‹å‰åšä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„é…ç½®ä¸­å¿ƒ client åŸºæœ¬éƒ½æ˜¯ç»§æ‰¿è¯¥åˆå§‹åŒ–å™¨ï¼Œåœ¨å®¹å™¨åˆ·æ–°å‰å°†é…ç½®ä»è¿œç¨‹æ‹‰åˆ°æœ¬åœ°ï¼Œç„¶åå°è£…æˆ PropertySource æ”¾åˆ° Environment ä¸­ä¾›ä½¿ç”¨ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ SpringCloud åœºæ™¯ä¸‹ï¼ŒSpringCloud è§„èŒƒä¸­æä¾›äº† PropertySourceBootstrapConfiguration ç»§æ‰¿ ApplicationContextInitializerï¼Œå¦å¤–è¿˜æä¾›äº†ä¸ª PropertySourceLocatorï¼ŒäºŒè€…é…åˆå®Œæˆé…ç½®ä¸­å¿ƒçš„æ¥å…¥ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.958904109589041&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVuS86eYnAKicqZtzgDDsnAJ90H96KMQeWgKibCfKiccFA4mtiafpSjLvhxw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1241&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä»ä¸Šè¿°æˆªå›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨ PropertySourceBootstrapConfiguration è¿™ä¸ªå•ä¾‹å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™ä¼šå°† Spring å®¹å™¨ä¸­æ‰€æœ‰çš„ PropertySourceLocator å®ç°æ³¨å…¥è¿›æ¥ã€‚ç„¶ååœ¨ initialize æ–¹æ³•ä¸­å¾ªç¯æ‰€æœ‰çš„ PropertySourceLocator è¿›è¡Œé…ç½®çš„è·å–ï¼Œä»è¿™å„¿å¯ä»¥çœ‹å‡º SpringCloud åº”ç”¨æ˜¯æ”¯æŒæˆ‘ä»¬å¼•å…¥å¤šä¸ªé…ç½®ä¸­å¿ƒå®ç°çš„ï¼Œè·å–åˆ°é…ç½®åè°ƒç”¨ insertPropertySources æ–¹æ³•å°†æ‰€æœ‰çš„ PropertySourceï¼ˆå°è£…çš„ä¸€ä¸ªä¸ªé…ç½®æ–‡ä»¶ï¼‰æ·»åŠ åˆ° Spring çš„ç¯å¢ƒå˜é‡ environment ä¸­ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.33719704952581664&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVaKbszAEibpZiciazLAVxah619tjj1UlmOjVbHJErIep50SV4Ro9dz981w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1898&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸Šå›¾å±•ç¤ºäº†åœ¨ spring-cloud-starter-alibaba-nacos-config åŒ…æä¾›çš„è‡ªåŠ¨è£…é…ç±»ä¸­è¿›è¡Œäº† NacosPropertySourceLocator çš„å®šä¹‰ï¼Œè¯¥ç±»ç»§æ‰¿è‡ªä¸Šè¿°è¯´çš„ PropertySourceLocatorï¼Œé‡å†™äº† locate æ–¹æ³•è¿›è¡Œé…ç½®çš„è¯»å–ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬æ¥åˆ†æä¸‹ NacosPropertySourceLocatorï¼Œlocate æ–¹æ³•åªæå–äº†ä¸»è¦æµç¨‹ä»£ç ï¼Œå¯ä»¥çœ‹åˆ° Nacos å¯åŠ¨ä¼šåŠ è½½ä»¥ä¸‹ä¸‰ç§é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ bootstrap.yml æ–‡ä»¶é‡Œé…ç½®çš„æ‰©å±•é…ç½® extension-configsã€å…±äº«é…ç½® shared-configs ä»¥åŠåº”ç”¨è‡ªå·±çš„é…ç½®ï¼ŒåŠ è½½åˆ°é…ç½®æ–‡ä»¶åä¼šå°è£…æˆ NacosPropertySource è¿”å›ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4268867924528302&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVzIYX5ytGyibuP7zQib2Yv1kwhet9nt0UUa5gaX2cAd1OicVuDwsUvR57w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1272&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;pre&gt;&lt;code&gt;Â Â Â Â &lt;span&gt;public&lt;/span&gt;Â PropertySource&amp;lt;?&amp;gt;Â locate(EnvironmentÂ env)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â ç”ŸæˆÂ NacosConfigServiceÂ å®ä¾‹ï¼Œåç»­é…ç½®æ“ä½œéƒ½æ˜¯å›´ç»•è¯¥ç±»è¿›è¡Œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;ConfigService&lt;/span&gt;Â &lt;span&gt;configService&lt;/span&gt;Â =Â nacosConfigManager.getConfigService();&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (&lt;span&gt;null&lt;/span&gt;Â ==Â configService)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â log.warn(&lt;span&gt;&quot;noÂ instanceÂ ofÂ configÂ serviceÂ found,Â can&#x27;tÂ loadÂ configÂ fromÂ nacos&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;long&lt;/span&gt;Â &lt;span&gt;timeout&lt;/span&gt;Â =Â nacosConfigProperties.getTimeout();&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â é…ç½®è·å–ï¼ˆä½¿ç”¨Â configServiceï¼‰ã€é…ç½®å°è£…ã€é…ç½®ç¼“å­˜ç­‰æ“ä½œ&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â nacosPropertySourceBuilderÂ =Â &lt;span&gt;new&lt;/span&gt;Â NacosPropertySourceBuilder(configService,&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â timeout);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;CompositePropertySource&lt;/span&gt;Â &lt;span&gt;composite&lt;/span&gt;Â =Â &lt;span&gt;new&lt;/span&gt;Â CompositePropertySource(&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â NACOS_PROPERTY_SOURCE_NAME);&lt;br/&gt;Â Â Â Â Â Â Â Â loadSharedConfiguration(composite);&lt;br/&gt;Â Â Â Â Â Â Â Â loadExtConfiguration(composite);&lt;br/&gt;Â Â Â Â Â Â Â Â loadApplicationConfiguration(composite,Â dataIdPrefix,Â nacosConfigProperties,Â env);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â composite;&lt;br/&gt;Â Â Â Â }&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;loadApplicationConfiguration åŠ è½½åº”ç”¨é…ç½®æ—¶ï¼ŒåŒæ—¶ä¼šåŠ è½½ä»¥ä¸‹ä¸‰ç§é…ç½®ï¼Œåˆ†åˆ«æ˜¯&lt;/p&gt;&lt;blockquote&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1.Â ä¸å¸¦æ‰©å±•ååç¼€ï¼Œapplication&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2.Â å¸¦æ‰©å±•ååç¼€ï¼Œapplication.yml&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;3.Â å¸¦ç¯å¢ƒï¼Œå¸¦æ‰©å±•ååç¼€ï¼Œapplication-prod.yml&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;å¹¶ä¸”ä»ä¸Šåˆ°ä¸‹ï¼Œä¼˜å…ˆçº§ä¾æ¬¡å¢é«˜&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong/&gt;&lt;/h4&gt;&lt;/section&gt;&lt;/section&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6292725679228747&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVXylL6RS4yojytPZF0sYWf56q6R0knRgKt9gg8DOTqzPhAWiavqficpqQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1141&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;åŠ è½½çš„æ ¸å¿ƒæ–¹æ³•æ˜¯ loadNacosDataIfPresent -&amp;gt; loadNacosPropertySource&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3842887473460722&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVeqlCiajwStUxYDYO4uhibRQxJBaIFzyibKRhJVbsiaVnxey4QkMQ9AQ2NQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;942&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;build æ–¹æ³•è°ƒç”¨ loadNacosData è·å–é…ç½®ï¼Œç„¶åå°è£…æˆ NacosPropertySourceï¼Œå¹¶ä¸”å°†è¯¥å¯¹è±¡ç¼“å­˜åˆ° NacosPropertySourceRepository ä¸­ï¼Œåç»­ä¼šç”¨åˆ°ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3415559772296015&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVwydUdEl9eOYneJmF0BsFyyK9TwZDriaVxtKbqk8EaqNliak6KmWJaATw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1054&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.23814773980154355&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVd7kMyBuL3JF1CJC5FVLgCcJsLaibGiabgHBFzX88ibYvddwgePohEjq7A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;907&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;loadNacosData æ–¹æ³•ä¸­ä¼šå°†å®é™…é…ç½®åŠ è½½è¯·æ±‚å§”æ‰˜ç»™ configService å»åšï¼Œç„¶åè§£æè¿”å›çš„å­—ç¬¦ä¸²ï¼Œè§£æå™¨å®ç°äº† PropertySourceLoader æ¥å£ï¼Œæ”¯æŒ ymlã€propertiesã€xmlã€json è¿™å‡ ç§ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7071197411003236&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVicprCwNiac2kuD4ytz61PSW7EVzfx7sCXFN3DwhnoEOVURLYO4wfpsWA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1236&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;getConfig æ–¹æ³•ä¼šè°ƒç”¨åˆ° getConfigInner æ–¹æ³•ï¼Œé€šè¿‡ namespace, dataId, group å”¯ä¸€å®šä½ä¸€ä¸ªé…ç½®æ–‡ä»¶&lt;/p&gt;&lt;blockquote&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1.Â é¦–å…ˆè·å–æœ¬åœ°ç¼“å­˜æ–‡ä»¶çš„é…ç½®å†…å®¹ï¼Œå¦‚æœæœ‰ç›´æ¥è¿”å›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2.Â å¦‚æœæ­¥éª¤ 1 ä»æœ¬åœ°æ²¡æ‰¾åˆ°ç›¸åº”é…ç½®æ–‡ä»¶ï¼Œå¼€å§‹ä»è¿œå¤„æ‹‰å»ï¼ŒNacos 2.0 ä»¥ä¸Šç‰ˆæœ¬ä½¿ç”¨ Grpc åè®®è¿›è¡Œè¿œç¨‹é€šä¿¡ï¼Œ1.0 åŠä»¥ä¸‹ä½¿ç”¨ Http åè®®è¿›è¡Œè¿œç¨‹é€šä¿¡ï¼Œæˆ‘ä»¬è¿™è¾¹ä»¥ 1.x ä¸ºä¾‹æ¥è§£è¯»&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7729166666666667&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVSicD7b2UnlmfbFa53LpZ1eKF1ySTMZTpItpSCWT0XoD21rCKcCYdpgA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1440&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;getServerConfig æ–¹æ³•ä¼šæ„é€ æœ€ç»ˆçš„ http è¯·æ±‚å‚æ•°è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè¿”å› okï¼Œåˆ™å°†è¿”å›å†…å®¹å†™å…¥åˆ°æœ¬åœ°ç¼“å­˜æ–‡ä»¶ä¸­ï¼Œå¹¶è¿›è¡Œè¿”å›ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8301620859760395&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVKKJeAmoAgSIL2As8Ziah3fJcfNaOmYHWRq6ibFXAQHUoLqHIHgqic8D1Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1419&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;è‡³æ­¤ï¼Œåœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™ï¼ˆä¸Šä¸‹æ–‡å‡†å¤‡é˜¶æ®µï¼‰æˆ‘ä»¬å°±æ‹‰åˆ°äº†è¿œç¨‹ Nacos ä¸­çš„é…ç½®ï¼Œå¹¶ä¸”å°è£…æˆ NacosPropertySource æ”¾åˆ°äº† Spring çš„ç¯å¢ƒå˜é‡é‡Œã€‚&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;h2&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;ç›‘å¬å™¨æ³¨å†Œ&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h4&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;ä¸Šé¢ç« èŠ‚æˆ‘ä»¬è¯´äº†æœåŠ¡å¯åŠ¨çš„æ—¶å€™ä»è¿œç¨‹ Nacos æœåŠ¡ç«¯æ‹‰åˆ°é…ç½®ï¼Œè¿™ä¸ªç« èŠ‚æˆ‘ä»¬æ¥è¯´ä¸‹é…ç½®å˜åŠ¨æ€ä¹ˆå®æ—¶é€šçŸ¥åˆ°å®¢æˆ·ç«¯ï¼Œé¦–å…ˆéœ€è¦æ³¨å†Œç›‘å¬å™¨ã€‚&lt;/p&gt;&lt;p&gt;ä¸»è¦çœ‹ NacosContextRefresher ç±»ï¼Œè¯¥ç±»ä¼šç›‘å¬æœåŠ¡å¯åŠ¨å‘å¸ƒçš„ ApplicationReadyEvent äº‹ä»¶ï¼Œç„¶åè¿›è¡Œé…ç½®ç›‘å¬å™¨çš„æ³¨å†Œã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7611940298507462&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVmzjghRNHyxHgdQsuZEj2AFdg2xGACuCEKR5O0xqqwhqOhQnAemiaMNw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1072&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;registerNacosListenersForApplications æ–¹æ³•é‡Œä¼šè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœè‡ªåŠ¨åˆ·æ–°æœºåˆ¶æ˜¯å¼€å¯çš„ï¼Œåˆ™è¿›è¡Œç›‘å¬å™¨æ³¨å†Œã€‚ä¸Šä¸ªç« èŠ‚æˆ‘ä»¬è¯´åˆ°äº†ä¼šå°†æ‹‰åˆ°çš„é…ç½®ç¼“å­˜åˆ° NacosPropertySourceRepository ä¸­ï¼Œ è¿™å„¿å°±ä»ç¼“å­˜ä¸­è·å–æ‰€æœ‰çš„é…ç½®ï¼Œç„¶åå¾ªç¯è¿›è¡Œç›‘å¬å™¨æ³¨å†Œï¼ˆå¦‚æœé…ç½®æ–‡ä»¶ä¸­é…ç½® refresh å­—æ®µä¸º falseï¼Œåˆ™ä¸æ³¨å†Œç›‘å¬å™¨ï¼‰ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.49375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVBdBd3n0xMjIibG9pQ0WaqQDFnLNz5r4ibhtp7kyl3q2YrkXDBWWN9Bjg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;800&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç›‘å¬å™¨æ˜¯ä»¥ dataId + groupId + namespace ä¸ºç»´åº¦è¿›è¡Œæ³¨å†Œçš„ï¼Œç›‘å¬å™¨çš„ä¸»è¦æ“ä½œå°±ä¸‰æ­¥ã€‚&lt;/p&gt;&lt;blockquote&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1.Â REFRESH_COUNT ++ï¼Œåœ¨ä¸Šè¿°è¯´çš„ loadNacosPropertySource æ–¹æ³•æœ‰ç”¨åˆ°&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2.Â å¾€ NacosRefreshHistory#records ä¸­æ·»åŠ ä¸€æ¡åˆ·æ–°è®°å½•&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;3.Â å‘å¸ƒä¸€ä¸ª RefreshEvent äº‹ä»¶ï¼Œè¯¥äº‹ä»¶æ˜¯ SpringCloud æä¾›çš„ï¼Œä¸»è¦å°±æ˜¯ç”¨æ¥åšç¯å¢ƒå˜æ›´åˆ·æ–°ç”¨çš„&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6911447084233261&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVS2Cd6O1uNwbgNEKNibVCRKECicv68udbZDJicicH9ex3qb94ickib3uc0Nxw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;926&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ³¨å†Œæ“ä½œç»è¿‡ ConfigServiceï¼Œåœ¨ ClientWorker ä¸­å¤„ç†ï¼Œè¿™å—ä¼šåˆ›å»ºä¸€ä¸ª CacheData å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸»è¦å°±æ˜¯ç”¨æ¥ç®¡ç†ç›‘å¬å™¨çš„ï¼Œä¹Ÿæ˜¯éå¸¸é‡è¦çš„ä¸€ä¸ªç±»ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.38177874186550975&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVoh5Clbho2nVIml1JSq4k5PEQoFx7RSNnaQDomycUQEtrguuFwADhpA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;922&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;CacheData ä¸­å­—æ®µå¦‚ä¸‹å›¾ï¼ŒManagerListenerWrap å¯¹ Listener åšå±‚åŒ…è£…ï¼Œå†…éƒ¨ä¼šä¿å­˜ listenerã€ä¸Šæ¬¡å˜æ›´çš„ content ä»¥åŠ md5ï¼ˆç”¨æ¥åˆ¤æ–­é…ç½®æœ‰æ²¡æœ‰å˜æ›´ç”¨ï¼‰ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4104401228249744&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVTWIKnArwgWD218PA9bKKribJeX2eISdf4tDCJ5gCD2gbmMwJqTjpzKw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;977&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7438650306748467&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVNa9BTxbkGTGibRahfpVvM3XT1xGHxDicrAnCmEQPotP99HVQMvb4QK8Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;652&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¹¶ä¸”åœ¨ addCacheDataIfAbsent æ–¹æ³•ä¸­ä¼šå°†åˆšæ‰åˆ›å»ºçš„ CacheData ç¼“å­˜åˆ° ClientWorker ä¸­çš„ä¸€ä¸ª Map ä¸­ï¼Œåç»­ä¼šç”¨åˆ°ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2682926829268293&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVwOXpvrluN1scqm8jzNOU7ibVnZfSRZBPLDUNJK2cERvrAgsOPrrCwvw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;984&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;è‡³æ­¤ï¼Œåœ¨æœåŠ¡å¯åŠ¨åå‘æ¯ä¸€ä¸ªéœ€è¦æ”¯æŒçƒ­æ›´æ–°çš„é…ç½®éƒ½æ³¨å†Œäº†ä¸€ä¸ªç›‘å¬å™¨ï¼Œç”¨æ¥ç›‘å¬è¿œç¨‹é…ç½®çš„å˜åŠ¨ï¼Œä»¥åŠåšç›¸åº”çš„å¤„ç†&lt;/strong&gt;&lt;strong/&gt;&lt;/p&gt;&lt;h2&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;é…ç½®çƒ­æ›´æ–°&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;ä¸Šé¢ç« èŠ‚æˆ‘ä»¬è®²äº†æœåŠ¡å¯åŠ¨çš„æ—¶å€™ä»è¿œç¨‹ Nacos æœåŠ¡ç«¯æ‹‰åˆ°é…ç½®ï¼Œä»¥åŠæœåŠ¡å¯åŠ¨åå¯¹éœ€è¦æ”¯æŒçƒ­æ›´æ–°çš„é…ç½®éƒ½æ³¨å†Œäº†ä¸€ä¸ªç›‘å¬å™¨ï¼Œè¿™ä¸ªç« èŠ‚æˆ‘ä»¬æ¥è¯´ä¸‹é…ç½®å˜åŠ¨åå…·ä½“æ˜¯æ€ä¹ˆå¤„ç†çš„ã€‚&lt;/p&gt;&lt;p&gt;å›åˆ°ä¸Šè¿°è¯´è¿‡çš„ NacosPropertySourceLocator çš„ locate æ–¹æ³•çœ‹çœ‹ï¼Œè¯¥æ–¹æ³•é¦–å…ˆä¼šè·å–ä¸€ä¸ª ConfigServiceã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.39567430025445294&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVeSlYBnicAicNeGG6bec1QCdbcpoMHa6iblZh5EpTYvILuzXarVLbgccjg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;786&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;NacosConfigManager ä¸­ä¼šè¿›è¡Œä¸€ä¸ª ConfigService å•ä¾‹å¯¹è±¡çš„åˆ›å»ºï¼Œåˆ›å»ºæµç¨‹æœ€ç»ˆä¼šå§”æ‰˜ç»™ ConfigFactoryï¼Œä½¿ç”¨åå°„æ–¹å¼åˆ›å»ºä¸€ä¸ª NacosConfigService çš„å®ä¾‹å¯¹è±¡ï¼ŒNacosConfigService æ˜¯ä¸€ä¸ªå¾ˆæ ¸å¿ƒçš„ç±»ï¼Œé…ç½®çš„è·å–ï¼Œç›‘å¬å™¨çš„æ³¨å†Œéƒ½éœ€è¦ç»æ­¤ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.48662041625371655&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVgOZlsPn1xsSSBajl9AEGwKll4Sl72uiasBL6QflEYT3DFLc251EaiaeQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1009&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æˆ‘ä»¬çœ‹ä¸‹ NacosConfigService çš„æ„é€ å‡½æ•°ï¼Œä¼šå»åˆ›å»ºä¸€ä¸ª ClientWorker ç±»çš„å¯¹è±¡ï¼Œè¿™ä¸ªç±»æ˜¯å®ç°é…ç½®çƒ­æ›´æ–°çš„æ ¸å¿ƒç±»ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42528735632183906&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVp5VPaDsOa3sOGgemKdvVZOY6eYKZLPHFI6SrvQ8ClgGdAUMb1mf0JA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;870&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ClientWorker çš„æ„é€ å‡½æ•°é‡Œä¼šå»åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œexecutor ä¼šæ¯éš” 10ms è¿›è¡Œä¸€æ¬¡é…ç½®å˜æ›´çš„æ£€æŸ¥ï¼ŒexecutorService ä¸»è¦æ˜¯ç”¨æ¥å¤„ç†é•¿è½®è¯¢è¯·æ±‚çš„ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.920314253647587&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVibeJNGcMErvlRfc1fOwKc2u4ClSs4PzO2S7a1o4YmWYickpHaqztiaPxw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;891&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;checkConfigInfo æ–¹æ³•ä¸­ä¼šåˆ›å»ºä¸€ä¸ªé•¿è½®è¯¢ä»»åŠ¡ä¸¢åˆ° executorService çº¿ç¨‹æ± ä¸­å»å¤„ç†ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.47085201793721976&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVMTB3amtvl9FfHE9USIsVHZoqibVDGO3D7df1S0KerBeRTMgNfmK2mUw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;892&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;LongPollingRunnable çš„ run æ–¹æ³•ä»£ç æœ‰ç‚¹å¤šï¼Œä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;blockquote&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1.Â è·å–ä¸Šä¸ªç« èŠ‚ä¸­è¯´åˆ°çš„ç¼“å­˜ cacheMapï¼Œç„¶åéå†ï¼Œåˆ¤æ–­å¦‚æœè¯¥é…ç½®ä½¿ç”¨çš„æ˜¯æœ¬åœ°ç¼“å­˜æ¨¡å¼ï¼Œåˆ™è°ƒç”¨ checkListenerMd5 å»æ£€æŸ¥è¯»åˆ°çš„æœ¬åœ°ç¼“å­˜æ–‡ä»¶ä¸­å†…å®¹çš„ Md5 è·Ÿä¸Šæ¬¡æ›´æ–°çš„ Md5 æ˜¯ä¸æ˜¯ä¸€æ ·ï¼Œä¸ä¸€æ ·åˆ™è°ƒç”¨ safeNotifyListener å»é€šçŸ¥ç›‘å¬å™¨å¤„ç†ï¼Œå¹¶ä¸”æ›´æ–° listenerWrap ä¸­çš„ contentã€Md5&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6317241379310344&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVkaFjZ3jbVcVYcX6hMk351OnsDicG1nwALDRHDQBxkOX9O6hzrDog3pA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;725&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;blockquote&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1. checkUpdateDataIds è¯¥æ–¹æ³•ä¸­ï¼Œä¼šå°†æ‰€æœ‰çš„ dataId æŒ‰å®šä¹‰æ ¼å¼æ‹¼æ¥å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ„é€ ä¸€ä¸ªé•¿è½®è¯¢è¯·æ±‚ï¼Œå‘ç»™æœåŠ¡ç«¯ï¼ŒLong-Pulling-Timeout è¶…æ—¶æ—¶é—´é»˜è®¤ 30sï¼Œå¦‚æœæœåŠ¡ç«¯æ²¡æœ‰é…ç½®å˜æ›´ï¼Œåˆ™ä¼šä¿æŒè¯¥è¯·æ±‚ç›´åˆ°è¶…æ—¶ï¼Œæœ‰é…ç½®å˜æ›´åˆ™ç›´æ¥è¿”å›æœ‰å˜æ›´çš„ dataId åˆ—è¡¨ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6905286343612335&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVPPPFDqb9micuqKfJrlTOH4kjFHdh7sGrBq86AXkMicq0AJrDPy5VXU6A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;908&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;blockquote&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1.Â æ‹¿åˆ°ç¬¬äºŒæ­¥æœ‰å˜æ›´çš„ dataId åä¼šè°ƒç”¨ getServerConfig è·å–æœ€æ–°çš„é…ç½®å†…å®¹ï¼Œç„¶åéå†è°ƒç”¨ checkListenerMd5 å»æ£€æŸ¥æœ€æ–°æ‹‰å–çš„é…ç½®å†…å®¹çš„ Md5 è·Ÿä¸Šæ¬¡æ›´æ–°çš„ Md5 æ˜¯ä¸æ˜¯ä¸€æ ·ï¼Œä¸ä¸€æ ·åˆ™è°ƒç”¨ safeNotifyListener å»é€šçŸ¥ç›‘å¬å™¨å¤„ç†ï¼Œå¹¶ä¸”æ›´æ–° listenerWrap ä¸­çš„ contentã€Md5&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/blockquote&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6696629213483146&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVRdlm9Dnvp773YA1QMAuiblKsIwwiaewzBfcndAMuM83bGTVGBNZcVcqg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;890&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;checkListenerMd5 æ–¹æ³•å¦‚ä¸‹ï¼Œä¸»è¦å°±æ˜¯åˆ¤æ–­ä¸¤ä¸ª md5 æ˜¯ä¸æ˜¯ç›¸åŒï¼Œä¸åŒåˆ™è°ƒç”¨ safeNotifyListener å¤„ç†ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.25949367088607594&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVn9T4H91icaLfNqPUhcLOQBzj96QzlS6RiaE327ibko4XupfNLMbI8cuJQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;790&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;safeNotifyListener æ–¹æ³•ä¸»è¦å°±æ˜¯è°ƒç”¨ç›‘å¬å™¨çš„ receiveConfigInfo æ–¹æ³•ï¼Œç„¶åæ›´æ–°ç›‘å¬å™¨åŒ…è£…å™¨ä¸­çš„ lastContentã€lastCallMd5 å­—æ®µã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8957894736842106&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVjkO92az6NEOUmQ87X7aaw5PKvpWkI9OOSia6NiblQQlJ0d3oMUmoibR9A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;950&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç›‘å¬å™¨è¦æ‰§è¡Œçš„æ–¹æ³•æˆ‘ä»¬ä¸Šé¢ä¹Ÿå·²ç»è®²è¿‡äº†ï¼Œè¿™è¾¹å†è´´ä¸‹æˆªå›¾ï¼Œä¸»è¦å°±æ˜¯å‘å¸ƒ RefreshEvent äº‹ä»¶ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6380434782608696&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVr0pno3XVRcDu1F8ZTdUDlIw6ZRTyazQMaC6QF8LOAseel0qHcfpGVw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;920&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;è‡³æ­¤ï¼ŒNacos çš„å¤„ç†æµç¨‹å·²ç»ç»“æŸäº†ï¼ŒRefreshEvent äº‹ä»¶ä¸»è¦ç”± SpringCloud ç›¸å…³ç±»æ¥å¤„ç†ã€‚&lt;/strong&gt;&lt;strong/&gt;&lt;/p&gt;&lt;h2&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;RefreshEvent äº‹ä»¶å¤„ç†&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;RefreshEvent äº‹ä»¶ä¼šç”± RefreshEventListener æ¥å¤„ç†ï¼Œè¯¥ listener å«æœ‰ä¸€ä¸ª ContextRefresher çš„å¯¹è±¡ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7460484720758693&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVKg2khnphUeBgNpUVpHP0tuUAsfleRb2J6RVp2DA7HfpAtqPXoEg2Jg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;949&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒrefreshEnvironment ä¼šå»åˆ·æ–° Spring ç¯å¢ƒå˜é‡ï¼Œå®é™…ä¸Šæ˜¯äº¤ç»™ updateEnvironment æ–¹æ³•å»åšçš„åˆ·æ–°ï¼Œå…·ä½“åˆ·æ–°æ€æƒ³å°±æ˜¯é‡æ–°åˆ›å»ºä¸€ä¸ª Spring å®¹å™¨ï¼Œç„¶åå°†è¿™ä¸ªæ–°å®¹å™¨ä¸­çš„ç¯å¢ƒä¿¡æ¯è®¾ç½®åˆ°åŸæœ‰çš„ Spring ç¯å¢ƒä¸­ã€‚æ‹¿åˆ°æ‰€æœ‰å˜åŒ–çš„é…ç½®é¡¹åï¼Œå‘å¸ƒä¸€ä¸ªç¯å¢ƒå˜åŒ–çš„ EnvironmentChangeEvent äº‹ä»¶ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4802494802494803&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVUZiaEC1oggzA1sv3pBOkjcTibMPOrPe7YzV6hWAtyQlHmA8NXA5dwPZw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;962&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7754459601259182&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVjfETff9ibicvpK3iaJMG2dWpMeRUxuq8CkpdJhxNicZz4eDmlHp2KCV7Tw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;953&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ConfigurationPropertiesRebinder ä¼šç›‘å¬ EnvironmentChangeEvent äº‹ä»¶ï¼Œç›‘å¬åˆ°äº‹ä»¶åä¼šå¯¹æ‰€æœ‰çš„æ ‡æ³¨æœ‰ ConfigurationProperties æ³¨è§£çš„é…ç½®ç±»è¿›è¡Œé”€æ¯åé‡æ–°åˆå§‹åŒ–çš„æ“ä½œï¼Œå®Œä¹‹åæˆ‘ä»¬çš„é…ç½®ç±»ä¸­çš„å±æ€§å°±æ˜¯æœ€æ–°çš„äº†ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7336065573770492&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVFZw8giagr5T8iarLOw92hL60QNia6CSTtXNt2X9icia1ov5K77Ie9F1U3jQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;976&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7626774847870182&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxV4x5anmTb6Vyh6uic9XPAA8SHllicQNiatczEmORk2pPoK61rfa13EOJ6Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;986&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™é‡Œæˆ‘ä»¬è¯´åˆ°äº†ä¼šå¯¹æ ‡æœ‰ ConfigurationProperties æ³¨è§£çš„é…ç½®ç±»è¿›è¡Œ rebindï¼Œé‚£å¯¹äºæ™®é€šç»„ä»¶ç±»é‡Œæ ‡æœ‰ @Value æ³¨è§£çš„å±æ€§è¦æ€ä¹ˆç”Ÿæ•ˆå‘¢ï¼Ÿè¿™ä¸ªå…¶å®éœ€è¦é…åˆ @RefreshScope æ³¨è§£æ¥ç”Ÿæ•ˆçš„ã€‚&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ç»§ç»­å›åˆ°ä¸Šè¿°çš„ refresh() æ–¹æ³•ï¼Œæ¥ç€ä¼šæœ‰ä¸€æ­¥ refreshAll çš„æ“ä½œï¼Œä¼šè°ƒç”¨çˆ¶ç±»çš„ destroy æ–¹æ³•ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2900763358778626&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVKwxBZ9QN6mzg4FGHH2YC1veLjruuiaksibaAn044GtNv1ketbS1n1Cww/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;524&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.23439667128987518&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVccwok8o41licleZ9NdV40SOag0WmxXp5GAJNP93pMz7XuPCRoCT1O6Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;721&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;çˆ¶ç±»å°±æ˜¯ GenericScopeï¼Œæˆ‘ä»¬çŸ¥é“ Spring ä¸­çš„ Bean æ˜¯æœ‰Scope çš„æ¦‚å¿µçš„ï¼ŒSpring é»˜è®¤ Scope æœ‰å•ä¾‹å’ŒåŸå‹ä¸¤ç§ï¼ŒåŒæ—¶æä¾›äº† Scope æ‰©å±•æ¥å£ï¼Œé€šè¿‡å®ç°è¯¥æ¥å£æˆ‘ä»¬å¯ä»¥å®šä¹‰è‡ªå·±çš„ Scopeã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6775631500742942&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVzORrlJJhmW1tibwvEAKPTlNufjfdfDW7iaHsLzEALFvbVrjK4q2ZGQxA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;673&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;é€šè¿‡doGetBean æ–¹æ³•å¯ä»¥çœ‹å‡ºï¼Œè¿™äº›è‡ªå®šä¹‰ Scope ç±»å‹å¯¹è±¡çš„ç®¡ç†ä¼šäº¤ç»™ç›¸åº”çš„ Scope å®ç°å»ç®¡ç†ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8311068702290076&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVyBluk9ib0CAjvRfiaKf1iaAaMZGBhQYK0RyL4skIYLpSsBSehhtfcsDgg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1048&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;SpringCloud å®ç°çš„ RefreshScope å°±æ˜¯ç”¨æ¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ·æ–° Bean ç”¨çš„ï¼ŒRefreshScope ç»§æ‰¿ GenericScopeï¼Œæä¾› get å’Œ destroy æ–¹æ³•ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.28955866523143164&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVp7cksicbpGC2qPEZmQ8ScOTh3M3bc6hxV3bKNYpGesb7HgvMopjDQoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;929&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;GenericScope å†…éƒ¨æœ‰ä¸€ä¸ª cacheï¼Œç”¨æ¥ä¿å­˜æ‰€æœ‰è¯¥ Scope ç±»å‹çš„å¯¹è±¡ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2790202342917998&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxV2EKoEP5NVZLs3oJ5uXj7gkzunlYibcBOY9uvPNtbra5IbDTxULZ7fgw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;939&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å›åˆ°ä¸»çº¿ï¼Œæ‰€ä»¥åœ¨ refreshAll ä¸­è°ƒç”¨ super.destroy æ–¹æ³•æ—¶ä¼šå°†è¯¥ scope çš„è¿™äº› Bean éƒ½é”€æ¯æ‰ï¼Œåœ¨ä¸‹æ¬¡ get çš„æ—¶å€™åœ¨é‡æ–°åˆ›å»º Beanï¼Œæ–°åˆ›å»ºçš„ Bean å°±æœ‰äº†æˆ‘ä»¬æœ€æ–°çš„é…ç½®ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9163591635916359&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVARRkPUsGAVaF5K6Y0KMzLfSCmwuB0OwTnoH0cJd6lEajRh6gaaKhzg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;813&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.310752688172043&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/MT0dU22BS4ndD8zxwAP34SlX2j2upiaxVrE8Jv1yd5AErQvaYVkcvicX6ia0vqy1Ok6Ss8dFDYemcyygagqNpMMWA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;930&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®ç°äº†é…ç½®çƒ­æ›´æ–°çš„æ•ˆæœäº†ã€‚&lt;/strong&gt;&lt;strong/&gt;&lt;/p&gt;&lt;h2&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;æ€»ç»“&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;æ–‡ç« ä»æœåŠ¡å¯åŠ¨æ—¶çš„é…ç½®æ‹‰å–ï¼ŒæœåŠ¡å¯åŠ¨åçš„é…ç½®ç›‘å¬å™¨æ³¨å†Œï¼Œä»¥åŠé…ç½®å˜åŠ¨åçš„çƒ­æ›´æ–°å®ç°ä¸‰ä¸ªæ–¹é¢ä»æºç å±‚é¢è§£æäº†æ•´ä¸ªçš„åŸç†ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ã€‚&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.21428571428571427&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/84QSpkgaj14GBzMnf1ibXkydLwCmhrWBooDwrdnlqYlsyB5PetG1T1oXxJ63G8TK58dqkDo7uzR7bKic50DxbTQQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-w=&quot;336&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6538461538461539&quot; data-w=&quot;52&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BXOuoE8lPAIR47zmQ1XOqSQszO2PjLgkgakpDZQSsUkLLnGszEu0eyGjvHNRqu6picb2kicC4lo95WZGiaxqibqW4A/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot; mpa-is-content=&quot;t&quot;&gt;&lt;span&gt;æ¬¢è¿æ‰«ç åŠ å…¥å„’çŒ¿æŠ€æœ¯äº¤æµç¾¤ï¼Œæ¯å¤©æ™šä¸Š20:00éƒ½æœ‰Javaé¢è¯•ã€Redisã€MySQLã€RocketMQã€SpringCloudAlibabaã€Javaæ¶æ„ç­‰æŠ€æœ¯ç­”ç–‘åˆ†äº«ï¼Œæ›´èƒ½è·Ÿå°ä¼™ä¼´ä»¬ä¸€èµ·äº¤æµæŠ€æœ¯&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;267&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;267&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLbPrUTW4zORxkXJU3pH9mPiawH9oZtZGKTkHyVL2wemkqNmPoJKDZlAt5ibgr2CibGkffw2ozqicds4gw/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;396&quot;/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;41056&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;41056&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;94152&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-autoskip=&quot;1&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span&gt;&lt;strong&gt;å¦å¤–æ¨èå„’çŒ¿è¯¾å ‚çš„1å…ƒç³»åˆ—è¯¾ç¨‹ç»™æ‚¨ï¼Œæ¬¢è¿åŠ å…¥ä¸€èµ·å­¦ä¹ ~&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;äº’è”ç½‘Javaå·¥ç¨‹å¸ˆé¢è¯•çªå‡»è¯¾&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295hjkFx86RFTZFibdBopicpMl5Scptaibp0pQAe5jUBMtXym9w4CncFBHsQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;SpringCloudAlibabaé›¶åŸºç¡€å…¥é—¨åˆ°é¡¹ç›®å®æˆ˜&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295NSLHaU5cHQTtyG2K5uK4iaA70v1g50BoQIRUVz4FBN1iahXdqc1M99Ww/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;äº¿çº§æµé‡ä¸‹çš„ç”µå•†è¯¦æƒ…é¡µç³»ç»Ÿå®æˆ˜é¡¹ç›®&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295I9n8XXUWoEeuogklrbj2QN4JZ6cdgYeRys5CCsml2tkFfibLXdeqoFA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;Kafkaæ¶ˆæ¯ä¸­é—´ä»¶å†…æ ¸æºç ç²¾è®²&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295yiaEcp1k5HBVycE8BGD0lGz5NZmKWmKXUtSBS7Jnm4FkTY8R5XFZkPw/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;12ä¸ªå®æˆ˜æ¡ˆä¾‹å¸¦ä½ ç©è½¬Javaå¹¶å‘ç¼–ç¨‹&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295WWU9o0Pj51xAIa2qCs9xD2rdDIRLriaibePNSrWJVCknYn6b5lrF3CQQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;Elasticsearché›¶åŸºç¡€å…¥é—¨åˆ°ç²¾é€š&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295QdxHC6HadPfaakPOo7DxxQpLH19lMZH0yAwRI3iajVXblNnwfMxBk9A/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;åŸºäºJavaæ‰‹å†™åˆ†å¸ƒå¼ä¸­é—´ä»¶ç³»ç»Ÿå®æˆ˜&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295r0mR5hhVpAlXTAZzlVvSg1dxegAaZrIZ9ftePV5QQQg2ibIZbiaA6CCg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;160&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;åŸºäºShardingSphereçš„åˆ†åº“åˆ†è¡¨å®æˆ˜è¯¾&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;ï¼ˆ1å…ƒä¸“äº«ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295hicEliaIKPfLpHqQAo4CdAorqyxd9HvqD8sADicO7wFHGJxNtRus6LlBA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;160&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>1f982678174c93fc49f12db25939cf4f</guid>
<title>Rust ç”Ÿå‘½å‘¨æœŸ</title>
<link>https://toutiao.io/k/o8t36hx</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.1153846153846154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HlNkQjetfwiaeG2eibibS4RBQY8AFicia9q36jicvERnwdOiatCCicr8H3m5do4ZANHLuqF8yiawknQEaR6LFmL7e97iazfA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;52&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;æ¥”å­&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08421052631578947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/iaFp77VHVDePrc5TvQGXzzWwicp8jNAyz4O2uURnfYBeoHZ1VItu2A5IQFO5ohzNYV0ABcPcHCZeOtMomUILe16g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;380&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Rust çš„æ¯ä¸ªå¼•ç”¨éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œç”Ÿå‘½å‘¨æœŸæŒ‡çš„æ˜¯å¼•ç”¨ä¿æŒæœ‰æ•ˆçš„ä½œç”¨åŸŸã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¼•ç”¨æ˜¯éšå¼çš„ã€å¯ä»¥è¢«æ¨æ–­å‡ºæ¥çš„ï¼Œä½†å½“å¼•ç”¨å¯èƒ½ä»¥ä¸åŒçš„æ–¹å¼äº’ç›¸å…³è”æ—¶ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â r;&lt;br/&gt;Â Â Â Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â xÂ =Â &lt;span&gt;5&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â rÂ =Â &amp;amp;x;&lt;br/&gt;Â Â Â Â }Â Â &lt;span&gt;//Â æ­¤å¤„Â rÂ ä¸å†æœ‰æ•ˆ&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;{}&quot;&lt;/span&gt;,Â r);&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;æ‰§è¡Œçš„æ—¶å€™ä¼šæŠ¥å‡ºå¦‚ä¸‹é”™è¯¯ï¼šborrowed value does not live long enoughï¼Œæ„æ€å°±æ˜¯å€Ÿç”¨çš„å€¼å­˜æ´»çš„æ—¶é—´ä¸å¤Ÿé•¿ã€‚å› ä¸ºæŠŠ x çš„å¼•ç”¨ç»™ r ä¹‹åï¼Œx å°±è¢«é”€æ¯äº†ï¼Œé‚£ä¹ˆ r å°±æˆä¸ºäº†ä¸€ä¸ªæ‚¬ç©ºå¼•ç”¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œ Rust ä¼šé€šè¿‡å€Ÿç”¨æ£€æŸ¥å™¨ï¼Œæ¥æ£€æŸ¥å€Ÿç”¨æ˜¯å¦åˆæ³•ï¼Œæ˜¾ç„¶ä¸Šè¿°ä»£ç åœ¨æ‰§è¡Œæ‰“å°è¯­å¥çš„æ—¶å€™ï¼Œr å·²ç»ä¸åˆæ³•äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;longest&lt;/span&gt;&lt;/span&gt;(x:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;,Â y:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â x.len()Â &amp;gt;Â y.len()Â {&lt;br/&gt;Â Â Â Â Â Â Â Â x&lt;br/&gt;Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â yÂ &lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;è¿™æ®µä»£ç ä¹Ÿæ˜¯ä¸åˆæ³•çš„ï¼ŒåŸå› å°±æ˜¯è¿”å›å€¼è¦ä¹ˆæ˜¯ x è¦ä¹ˆæ˜¯ yï¼Œä½†å…·ä½“æ˜¯å“ªä¸€ä¸ªä¸çŸ¥é“ï¼Œå¹¶ä¸”å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸä¹Ÿéƒ½ä¸çŸ¥é“ã€‚æ‰€ä»¥æ— æ³•é€šè¿‡æ¯”è¾ƒä½œç”¨åŸŸï¼Œæ¥åˆ¤æ–­è¿”å›çš„å¼•ç”¨æ˜¯å¦æ˜¯ä¸€è‡´æœ‰æ•ˆçš„ï¼Œè€Œå€Ÿç”¨æ£€æŸ¥å™¨ä¹Ÿæ˜¯åšä¸åˆ°çš„ï¼ŒåŸå› å°±æ˜¯å®ƒä¸çŸ¥é“è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸæ˜¯è·Ÿ x æœ‰å…³ç³»è¿˜æ˜¯è·Ÿ y æœ‰å…³ç³»ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªè·Ÿå‡½æ•°ä½“çš„é€»è¾‘ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œå‡½æ•°çš„å£°æ˜å°±å†³å®šäº†å®ƒåšä¸åˆ°è¿™ä¸€ç‚¹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å› æ­¤æˆ‘ä»¬éœ€è¦å¼•å…¥ç”Ÿå‘½å‘¨æœŸã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.1153846153846154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HlNkQjetfwiaeG2eibibS4RBQY8AFicia9q36jicvERnwdOiatCCicr8H3m5do4ZANHLuqF8yiawknQEaR6LFmL7e97iazfA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;52&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;&lt;span&gt;ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨è¯­æ³•&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08421052631578947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/iaFp77VHVDePrc5TvQGXzzWwicp8jNAyz4O2uURnfYBeoHZ1VItu2A5IQFO5ohzNYV0ABcPcHCZeOtMomUILe16g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;380&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é¦–å…ˆç”Ÿå‘½å‘¨æœŸæ ‡æ³¨å¹¶ä¸ä¼šæ”¹å˜å¼•ç”¨çš„ç”Ÿå‘½é•¿åº¦ï¼Œå½“æŒ‡å®šäº†ç”Ÿå‘½å‘¨æœŸå‚æ•°ï¼Œå‡½æ•°å¯ä»¥æ¥æ”¶å¸¦æœ‰ä»»ä½•ç”Ÿå‘½å‘¨æœŸçš„å¼•ç”¨ã€‚ç”Ÿå‘½å‘¨æœŸçš„æ ‡æ³¨ï¼šæè¿°äº†å¤šä¸ªå¼•ç”¨çš„ç”Ÿå‘½å‘¨æœŸé—´çš„å…³ç³»ï¼Œä½†ä¸å½±å“ç”Ÿå‘½å‘¨æœŸæœ¬èº«ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç°åœ¨å…‰è¯»èµ·æ¥å¯èƒ½æœ‰ç‚¹ç»•ï¼Œåˆ«æ€¥ï¼Œä¸€ä¼šå„¿ä¼šè§£é‡Šã€‚&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç”Ÿå‘½å‘¨æœŸå‚æ•°åä»¥Â &lt;/span&gt;&lt;span&gt;&lt;strong&gt;&#x27;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; å¼€å¤´ï¼Œå¹¶ä¸”åå­—éå¸¸çŸ­ï¼Œé€šå¸¸ä¸º aï¼›æ ‡æ³¨ä½ç½®åœ¨Â &amp;amp; åé¢ï¼Œåªæœ‰ &amp;amp; æ‰éœ€è¦ç”Ÿå‘½å‘¨æœŸã€‚å› ä¸ºä½ å¼•ç”¨äº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼çš„å­˜æ´»æ—¶é—´éœ€è¦çŸ¥é“ï¼Œä¸ç„¶äººå®¶éƒ½è¢«é”€æ¯äº†è¿˜å‚»å‚»åœ°ç”¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å…¶å®å•ä¸ªç”Ÿå‘½å‘¨æœŸæ ‡æ³¨æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œå®ƒæ˜¯ä¸ºäº†å‘ Rust æè¿°å¤šä¸ªå…·æœ‰ç”Ÿå‘½å‘¨æœŸçš„å‚æ•°ä¹‹é—´çš„å…³ç³»ã€‚å¹¶ä¸”ç”Ÿå‘½å‘¨æœŸå’Œæ³›å‹ä¸€æ ·ï¼Œä¹Ÿè¦å£°æ˜åœ¨å°–æ‹¬å·å†…ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;//Â ç­¾åé‡Œé¢çš„ç”Ÿå‘½å‘¨æœŸå¿…é¡»è¦æœ‰&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â &lt;span&gt;ç›¸å½“äºå‘Šè¯‰Â RustÂ æœ‰è¿™ä¹ˆä¸€ä¸ªç”Ÿå‘½å‘¨æœŸÂ &#x27;a&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;longest&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(x:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,Â y:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â x.len()Â &amp;gt;Â y.len()Â {&lt;br/&gt;Â Â Â Â Â Â Â Â x&lt;br/&gt;Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â y&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶ä»£ç æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯æ³¨æ„ï¼šæˆ‘ä»¬å¹¶æ²¡æœ‰æ”¹å˜&lt;/span&gt;&lt;span&gt;ä¼ å…¥çš„å€¼&lt;/span&gt;&lt;span&gt;å’Œ&lt;/span&gt;&lt;span&gt;è¿”å›çš„å€¼&lt;/span&gt;&lt;span&gt;çš„ç”Ÿå‘½å‘¨æœŸï¼Œæˆ‘ä»¬åªæ˜¯å‘å€Ÿç”¨æ£€æŸ¥å™¨æŒ‡å‡ºäº†ä¸€äº›ç”¨äºæ£€æŸ¥éæ³•è°ƒç”¨çš„ä¸€äº›çº¦æŸè€Œå·²ï¼Œè€Œå€Ÿç”¨æ£€æŸ¥å™¨å¹¶ä¸éœ€è¦çŸ¥é“ xã€y çš„å…·ä½“å­˜æ´»æ—¶é•¿ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œäº‹å®ä¸Šå¦‚æœå‡½æ•°å¼•ç”¨å¤–éƒ¨çš„å˜é‡ï¼Œé‚£ä¹ˆå•é  Rust ç¡®å®šå‡½æ•°å’Œè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸå‡ ä¹æ˜¯ä¸å¯èƒ½çš„äº‹æƒ…ã€‚å› ä¸ºå‡½æ•°ä¼ é€’ä»€ä¹ˆå‚æ•°éƒ½æ˜¯æˆ‘ä»¬å†³å®šçš„ï¼Œè¿™æ ·çš„è¯å‡½æ•°åœ¨æ¯æ¬¡è°ƒç”¨æ—¶ä½¿ç”¨çš„ç”Ÿå‘½å‘¨æœŸéƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œæ­£å› å¦‚æ­¤æˆ‘ä»¬æ‰éœ€è¦æ‰‹åŠ¨å¯¹ç”Ÿå‘½å‘¨æœŸè¿›è¡Œæ ‡æ³¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;//Â å‡†ç¡®æ¥è¯´Â &#x27;aÂ æŒ‡çš„å°±æ˜¯Â xÂ å’ŒÂ yÂ ç”Ÿå‘½å‘¨æœŸé‡å çš„é‚£ä¸€éƒ¨åˆ†&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â è€Œè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½è¶…é‡å çš„éƒ¨åˆ†&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;longest&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(x:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,Â y:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â x.len()Â &amp;gt;Â y.len()Â {&lt;br/&gt;Â Â Â Â Â Â Â Â x&lt;br/&gt;Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â y&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â xÂ =Â &lt;span&gt;String&lt;/span&gt;::from(&lt;span&gt;&quot;hello&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â yÂ =Â &lt;span&gt;String&lt;/span&gt;::from(&lt;span&gt;&quot;satori&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â resultÂ =Â longest(&amp;amp;x,Â &amp;amp;y);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;resultÂ =Â {}&quot;&lt;/span&gt;,Â result);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â resultÂ =Â satori&lt;/span&gt;&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;ç›®å‰æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸º x å’Œ y çš„ç”Ÿå‘½å‘¨æœŸé‡å çš„éƒ¨åˆ†æ˜¯ yï¼Œç„¶åè¿”å›å€¼ result å’Œ y ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ä½†å¦‚æœæˆ‘ä»¬æŠŠä»£ç æ”¹ä¸€ä¸‹ï¼Œå°† println! è¯­å¥ç§»åˆ°èŠ±æ‹¬å·å¤–é¢ï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;longest&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(x:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,Â y:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â x.len()Â &amp;gt;Â y.len()Â {&lt;br/&gt;Â Â Â Â Â Â Â Â x&lt;br/&gt;Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â y&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â xÂ =Â &lt;span&gt;&quot;hello&quot;&lt;/span&gt;.to_string();&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â result;&lt;br/&gt;Â Â Â Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â yÂ =Â &lt;span&gt;&quot;satori&quot;&lt;/span&gt;.to_string();&lt;br/&gt;Â Â Â Â Â Â Â Â resultÂ =Â longest(&amp;amp;x,Â &amp;amp;y);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;resultÂ =Â {}&quot;&lt;/span&gt;,Â result);Â Â &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶å°±æŠ¥é”™äº†ï¼šborrowed value does not live long enoughã€‚ç›¸ä¿¡ä½ å·²ç»çŒœåˆ°äº†ï¼Œå› ä¸º xã€y ç”Ÿå‘½å‘¨æœŸé‡å çš„éƒ¨åˆ†æ˜¯ yï¼Œ&lt;/span&gt;&lt;span&gt;è¿”å›å€¼ result çš„ç”Ÿå‘½å‘¨æœŸä¸èƒ½è¶…è¿‡å®ƒã€‚ä½†å½“å‰æ˜æ˜¾è¶…è¿‡äº†ï¼Œæ‰€ä»¥æŠ¥é”™&lt;/span&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥è¯´ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨å¯¹å˜é‡æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œå®ƒåªæ˜¯ç»™äº†å€Ÿç”¨æ£€æŸ¥å™¨ä¸€ä¸ªå¯ä»¥ç”¨æ¥åˆ¤æ–­çš„çº¦æŸç½¢äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šç”Ÿå‘½å‘¨æœŸç”¨æ¥å…³è”å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ä¹‹é—´çš„è”ç³»ï¼Œä¸€æ—¦å®ƒä»¬å–å¾—äº†æŸç§è”ç³»ï¼Œé‚£ä¹ˆ Rust å°±è·å¾—äº†è¶³å¤Ÿå¤šçš„ä¿¡æ¯æ¥ä¿è¯å†…å­˜å®‰å…¨çš„æ“ä½œï¼Œå¹¶ä¸”é˜»æ­¢é‚£äº›å‡ºç°æ‚¬ç©ºæŒ‡é’ˆæˆ–è€…å…¶å®ƒå¯¼è‡´å†…å­˜å®‰å…¨çš„è¡Œä¸ºã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ ä¹Ÿè®¸è¿˜ä¸å¤ªäº†è§£ç”Ÿå‘½å‘¨æœŸï¼Œåˆ«ç€æ€¥ï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.1153846153846154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HlNkQjetfwiaeG2eibibS4RBQY8AFicia9q36jicvERnwdOiatCCicr8H3m5do4ZANHLuqF8yiawknQEaR6LFmL7e97iazfA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;52&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;&lt;span&gt;ç»“æ„ä½“ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08421052631578947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/iaFp77VHVDePrc5TvQGXzzWwicp8jNAyz4O2uURnfYBeoHZ1VItu2A5IQFO5ohzNYV0ABcPcHCZeOtMomUILe16g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;380&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;struct é‡Œé¢å¯ä»¥æ”¾ä»»æ„ç±»å‹ï¼Œä½†æ˜¯ä¸èƒ½æ”¾å¼•ç”¨ï¼Œæ¯”å¦‚ä¸‹é¢çš„ç»“æ„ä½“å®šä¹‰å°±æ˜¯é”™è¯¯çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;struct&lt;/span&gt;Â &lt;span&gt;Girl&lt;/span&gt;&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â name:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;,&lt;br/&gt;Â Â Â Â age:Â &lt;span&gt;i32&lt;/span&gt;&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;ç»“æ„ä½“å¦‚æœæ˜¯åˆæ³•çš„ï¼Œé‚£ä¹ˆå®ƒå†…éƒ¨çš„æ‰€æœ‰æˆå‘˜å€¼éƒ½è¦æ˜¯åˆæ³•çš„ã€‚ä½†ç°åœ¨ name æ˜¯ä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥ç»“æ„ä½“å®ä¾‹åŒ–çš„æ—¶å€™ä¸€å®šä¼šå¼•ç”¨æŸä¸ªå­—ç¬¦ä¸²ï¼Œè¿™å°±ä½¿å¾—&lt;/span&gt;&lt;span&gt;å­—ç¬¦ä¸²å­˜æ´»&lt;/span&gt;&lt;span&gt;æ˜¯&lt;/span&gt;&lt;span&gt;ç»“æ„ä½“å®ä¾‹å­˜æ´»&lt;/span&gt;&lt;span&gt;çš„å‰æã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä½†åœ¨å®é™…ç¼–ç ä¸­ï¼Œè¿™ä¸¤è€…çš„å­˜æ´»æ—¶é—´æ²¡æœ‰ä»€ä¹ˆå…³ç³»ï¼Œæœ‰å¯èƒ½ä½ åœ¨ä½¿ç”¨ç»“æ„ä½“å®ä¾‹è®¿é—® name æˆå‘˜çš„æ—¶å€™ï¼Œå®ƒå¼•ç”¨çš„å­—ç¬¦ä¸²éƒ½å·²ç»è¢«é”€æ¯äº†ã€‚æ‰€ä»¥ Rust ä¸å…è®¸æˆ‘ä»¬è¿™ä¹ˆåšï¼Œæˆ‘ä»¬ä¹‹å‰æ˜¯å°† name çš„ç±»å‹æŒ‡å®šä¸º Stringï¼Œä¹Ÿå°±æ˜¯è®©ç»“æ„ä½“æŒæœ‰å…¨éƒ¨æ•°æ®çš„æ‰€æœ‰æƒã€‚Â &lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œå¦‚æœéè¦å°†ç±»å‹æŒ‡å®šä¸ºå¼•ç”¨çš„è¯ï¼Œé‚£ä¹ˆå¿…é¡»æŒ‡å®šç”Ÿå‘½å‘¨æœŸã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;//Â å®ä¾‹.nameÂ ä¼šå¼•ç”¨å¤–éƒ¨çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥è¦æŒ‡å®šç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â è¡¨ç¤ºå­—ç¬¦ä¸²çš„å­˜æ´»æ—¶é—´ä¸€å®šæ¯”ç»“æ„ä½“å®ä¾‹è¦é•¿&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â å¦åˆ™å­—ç¬¦ä¸²æ²¡äº†ï¼Œè€Œå®ä¾‹è¿˜åœ¨ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ‚¬ç©ºå¼•ç”¨&lt;/span&gt;&lt;br/&gt;&lt;span&gt;#[derive(Debug)]&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;struct&lt;/span&gt;Â &lt;span&gt;Girl&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;Â {&lt;br/&gt;Â Â Â Â name:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,&lt;br/&gt;Â Â Â Â age:Â &lt;span&gt;i32&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â g;&lt;br/&gt;Â Â Â Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â nameÂ =Â &lt;span&gt;String&lt;/span&gt;::from(&lt;span&gt;&quot;å¤æ˜åœ°è§‰&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â gÂ =Â Girl{name:Â &amp;amp;name,Â age:Â &lt;span&gt;16&lt;/span&gt;};&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;{:?}&quot;&lt;/span&gt;,Â g);&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;å› ä¸ºæŒ‡å®šäº†ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨ç¼–è¯‘çš„æ—¶å€™å€Ÿç”¨æ£€æŸ¥å™¨å°±å¯ä»¥æ£€æµ‹å‡ºå­˜æ´»æ—¶é—´æ˜¯å¦åˆæ³•ã€‚&lt;/span&gt;&lt;span&gt;é¦–å…ˆ g çš„å­˜æ´»æ—¶é—´æ˜¯æ•´ä¸ª main å‡½æ•°ï¼Œè€Œ name çš„å­˜æ´»æ—¶é—´æ˜¯å†…éƒ¨çš„èŠ±æ‹¬å·é‚£ä¸€æ®µä½œç”¨åŸŸï¼Œæ¯” g çš„å­˜æ´»æ—¶é—´çŸ­ï¼Œå› æ­¤ç¼–è¯‘å‡ºé”™ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥é€šè¿‡ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ï¼ŒRust åœ¨ç¼–è¯‘æœŸé—´å°±èƒ½é€šè¿‡&lt;span&gt;å€Ÿç”¨æ£€æŸ¥å™¨&lt;/span&gt;æ£€æµ‹å‡ºå¼•ç”¨æ˜¯å¦åˆæ³•ï¼ŒRust ä¸ä¼šå°†è¿™ç§é”™è¯¯ç•™åˆ°è¿è¡Œæ—¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.1153846153846154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HlNkQjetfwiaeG2eibibS4RBQY8AFicia9q36jicvERnwdOiatCCicr8H3m5do4ZANHLuqF8yiawknQEaR6LFmL7e97iazfA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;52&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;&lt;span&gt;ç”Ÿå‘½å‘¨æœŸçš„çœç•¥&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08421052631578947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/iaFp77VHVDePrc5TvQGXzzWwicp8jNAyz4O2uURnfYBeoHZ1VItu2A5IQFO5ohzNYV0ABcPcHCZeOtMomUILe16g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;380&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å½“ä¸€ä¸ªå‡½æ•°è¿”å›äº†ä¸€ä¸ªå¼•ç”¨æ—¶ï¼Œå¾€å¾€éœ€è¦æŒ‡å®šç”Ÿå‘½å‘¨æœŸï¼Œè€Œå®ƒçš„ç›®çš„å°±æ˜¯ä¸ºäº†ä¿è¯è¿”å›çš„å¼•ç”¨æ˜¯åˆæ³•çš„ã€‚å¦‚æœä¸åˆæ³•ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½æ‰¾å‡ºæ¥ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;f&lt;/span&gt;&lt;/span&gt;(s:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â s&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;å‡½æ•°å‚æ•°å‡ºç°äº†å¼•ç”¨ï¼Œè¿”å›å€¼ä¹Ÿæœ‰å¼•ç”¨ï¼Œåº”è¯¥æŒ‡å®šç”Ÿå‘½å‘¨æœŸå‘€ã€‚æ˜¯çš„ï¼Œåœ¨æ—©æœŸç‰ˆæœ¬è¿™æ®µä»£ç æ˜¯ç¼–è¯‘ä¸è¿‡çš„ï¼Œå®ƒéœ€è¦ä½ è¿™ä¹ˆå†™ï¼š&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;f&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(s:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;&quot;xxx&quot;&lt;/span&gt;&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;ä½†æ˜¯ä¹…è€Œä¹…ä¹‹ï¼ŒRust å›¢é˜Ÿå‘ç°å¯¹äºè¿™ç§åœºæ™¯å®åœ¨æ²¡æœ‰å¿…è¦ä¸€éåˆä¸€éçš„é‡å¤ç¼–å†™ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”è¿™ç§åªæœ‰ä¸€ä¸ªå‚æ•°å®Œå…¨æ˜¯å¯ä»¥é¢„æµ‹çš„ï¼Œæœ‰æ˜ç¡®çš„æ¨¡å¼ã€‚äºæ˜¯ Rust å›¢é˜Ÿå°±å°†è¿™äº›æ¨¡å¼å†™å…¥äº†å€Ÿç”¨æ£€æŸ¥å™¨ï¼Œå¯ä»¥è‡ªåŠ¨è¿›è¡Œæ¨å¯¼ï¼Œè€Œæ— éœ€æ˜¾å¼åœ°å†™ä¸Šç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ‰€ä»¥åœ¨ Rust å¼•ç”¨åˆ†æä¸­ç¼–å…¥çš„æ¨¡å¼è¢«ç§°ä¸ºç”Ÿå‘½å‘¨æœŸçœç•¥è§„åˆ™ï¼š&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;å¦‚æœç”Ÿå‘½å‘¨æœŸåœ¨å‡½æ•°/æ–¹æ³•çš„å‚æ•°ä¸­ï¼Œåˆ™è¢«ç§°ä¸º&lt;/span&gt;&lt;span&gt;è¾“å…¥ç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;span&gt;ï¼›åœ¨å‡½æ•°/æ–¹æ³•çš„è¿”å›å€¼ä¸­ï¼Œåˆ™è¢«ç§°ä¸º&lt;/span&gt;&lt;span&gt;è¾“å‡ºç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;span&gt;ã€‚è€Œ Rust è¦èƒ½å¤Ÿåœ¨ç¼–è¯‘æœŸé—´åŸºäºè¾“å…¥ç”Ÿå‘½å‘¨æœŸï¼Œæ¥ç¡®å®šè¾“å‡ºç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœèƒ½å¤Ÿç¡®å®šï¼Œé‚£ä¹ˆä¾¿æ˜¯åˆæ³•çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œå½“æˆ‘ä»¬çœç•¥ç”Ÿå‘½å‘¨æœŸæ—¶ï¼ŒRust å°±ä¼šåŸºäºå†…ç½®çš„çœç•¥è§„åˆ™è¿›è¡Œæ¨æ–­ï¼Œå¦‚æœæ¨æ–­å®Œæˆåå‘ç°å¼•ç”¨ä¹‹é—´çš„å…³ç³»è¿˜æ˜¯æ¨¡ç³Šä¸æ¸…ï¼Œå°±ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ã€‚è€Œè§£å†³åŠæ³•å°±éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸäº†ï¼Œè¡¨æ˜å¼•ç”¨ä¹‹é—´çš„ç›¸äº’å…³ç³»ã€‚&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;é‚£ä¹ˆ Rust çœç•¥è§„åˆ™åˆ°åº•æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚æœç¼–è¯‘å™¨åœ¨åº”ç”¨å®Œä¸Šè¿°ä¸‰ä¸ªè§„åˆ™åï¼Œèƒ½å¤Ÿè®¡ç®—å‡ºè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸï¼Œåˆ™å¯ä»¥çœç•¥ï¼Œå¦åˆ™ä¸èƒ½çœç•¥ã€‚è¿™äº›è§„åˆ™åŒæ ·é€‚ç”¨äº fn å®šä¹‰å’Œ impl å—ï¼Œæˆ‘ä»¬æ¥ä¸¾å‡ ä¸ªä¾‹å­ï¼Œæ„Ÿå—ä¸€ä¸‹æ•´ä¸ªè¿‡ç¨‹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;//Â å‡½æ•°å¦‚ä¸‹ï¼Œç„¶åå¼€å§‹åº”ç”¨ä¸‰ä¸ªè§„åˆ™&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;first_word&lt;/span&gt;&lt;/span&gt;(s:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;{};&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â 1.Â æ¯ä¸ªå¼•ç”¨ç±»å‹çš„å‚æ•°éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ»¡è¶³&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â Â Â Â æ‰€ä»¥å‡½æ•°ç›¸å½“äºå˜æˆå¦‚ä¸‹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;first_word&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(s:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;{};&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â 2.Â åªæœ‰ä¸€ä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸè¢«èµ‹ç»™æ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â Â Â Â æ˜¾ç„¶ä¹Ÿæ˜¯æ»¡è¶³çš„ï¼Œæ‰€ä»¥å‡½æ•°å˜æˆå¦‚ä¸‹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;first_word&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(s:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;{};&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â 3.Â ä¸æ»¡è¶³ï¼Œæ‰€ä»¥æ— äº‹å‘ç”Ÿ&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;åº”ç”¨å®Œä¸‰ä¸ªè§„åˆ™ä¹‹åï¼Œè®¡ç®—å‡ºäº†è¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥åˆæ³•ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å†ä¸¾ä¸ªä¾‹å­ï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;//Â å‡½æ•°å¦‚ä¸‹ï¼Œç„¶åå¼€å§‹åº”ç”¨ä¸‰ä¸ªè§„åˆ™&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;first_word&lt;/span&gt;&lt;/span&gt;(s1:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;,Â s2:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;{};&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â 1.Â æ¯ä¸ªå¼•ç”¨ç±»å‹çš„å‚æ•°éƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â Â Â Â æ˜¾ç„¶æ»¡è¶³ï¼Œæ‰€ä»¥å‡½æ•°å˜æˆå¦‚ä¸‹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;first_word&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;,Â &lt;span&gt;&#x27;b&lt;/span&gt;&amp;gt;(s1:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,Â s2:Â &amp;amp;&lt;span&gt;&#x27;b&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;{};&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â 2.Â åªæœ‰ä¸€ä¸ªè¾“å…¥ç”Ÿå‘½å‘¨æœŸï¼Œè¯¥ç”Ÿå‘½å‘¨æœŸè¢«èµ‹äºˆæ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â ä½†æ˜¯è¿™é‡Œæœ‰ä¸¤ä¸ªï¼Œæ‰€ä»¥ä¸æ»¡è¶³&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â 3.Â ä¸æ»¡è¶³&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;å½“ç¼–è¯‘å™¨ä½¿ç”¨äº† 3 ä¸ªè§„åˆ™ä¹‹åä»ç„¶æ— æ³•è®¡ç®—å‡ºè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼Œå°±ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œæ˜¾ç„¶ä¸Šé¢ä»£ç æ˜¯ä¼šæŠ¥é”™çš„ã€‚æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;longest&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;(x:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,Â y:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â {}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;ä»è¡¨é¢ä¸Šæ¥çœ‹ xã€y çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ &#x27;aï¼Œä½†å‡†ç¡®æ¥è¯´å®ƒè¡¨ç¤ºçš„æ˜¯ xã€y ç”Ÿå‘½å‘¨æœŸé‡å çš„éƒ¨åˆ†ã€‚è€Œè¿”å›å€¼çš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨ä¹Ÿæ˜¯ &#x27;aï¼Œæ‰€ä»¥æ­¤å¤„çš„å«ä¹‰å°±è¡¨ç¤º&lt;/span&gt;&lt;span&gt;è¾“å‡ºç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;span&gt;æ˜¯ä¸¤ä¸ª&lt;/span&gt;&lt;span&gt;è¾“å…¥ç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;span&gt;é‡å çš„éƒ¨åˆ†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;longest å‡½æ•°è¿™ä¹ˆæ”¹çš„è¯ï¼Œæ˜¯åˆæ³•çš„ã€‚&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.1153846153846154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HlNkQjetfwiaeG2eibibS4RBQY8AFicia9q36jicvERnwdOiatCCicr8H3m5do4ZANHLuqF8yiawknQEaR6LFmL7e97iazfA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;52&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;&lt;span&gt;æ–¹æ³•ä¸­çš„ç”Ÿå‘½å‘¨æœŸæ ‡æ³¨&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08421052631578947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/iaFp77VHVDePrc5TvQGXzzWwicp8jNAyz4O2uURnfYBeoHZ1VItu2A5IQFO5ohzNYV0ABcPcHCZeOtMomUILe16g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;380&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç„¶åæ˜¯åœ¨æ–¹æ³•ä¸­æ ‡æ³¨ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒçš„è¯­æ³•å’Œæ³›å‹æ˜¯ç›¸ä¼¼çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;//Â å£°æ˜å‘¨æœŸçš„è¯­æ³•ç±»ä¼¼äºæ³›å‹&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â å¿…é¡»è¦å…ˆé€šè¿‡Â &amp;lt;&#x27;a&amp;gt;Â è¿›è¡Œå£°æ˜ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;struct&lt;/span&gt;Â &lt;span&gt;Girl&lt;/span&gt;&lt;/span&gt;Â &amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;Â {&lt;br/&gt;Â Â Â Â name:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â åœ¨å­¦ä¹ æ³›å‹çš„æ—¶å€™æˆ‘ä»¬çŸ¥é“&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â è¿™ç§æ–¹å¼è¡¨ç¤ºä¸ºæŸä¸ªç±»å‹å®ç°æ–¹æ³•&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//Â ç°åœ¨åˆ™å˜æˆç”Ÿå‘½å‘¨æœŸï¼Œå¹¶ä¸”Â &amp;lt;&#x27;a&amp;gt;Â ä¸å¯ä»¥çœç•¥&lt;/span&gt;&lt;br/&gt;&lt;span&gt;impl&lt;/span&gt;Â &amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;Â GirlÂ &amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;&amp;gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;say_hi&lt;/span&gt;&lt;/span&gt;(&amp;amp;&lt;span&gt;self&lt;/span&gt;)Â -&amp;gt;Â &lt;span&gt;String&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;String&lt;/span&gt;::from(&lt;span&gt;&quot;helloÂ world&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â æ­¤å¤„æ— éœ€æŒ‡å®šç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºÂ RustÂ å¯ä»¥æ¨æ–­å‡ºæ¥&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â ä¼šè‡ªåŠ¨å°†Â selfÂ çš„ç”Ÿå‘½å‘¨æœŸèµ‹å€¼ç»™æ‰€æœ‰çš„è¾“å‡ºç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;get_name&lt;/span&gt;&lt;/span&gt;(&amp;amp;&lt;span&gt;self&lt;/span&gt;,Â useless_arg:Â &amp;amp;&lt;span&gt;str&lt;/span&gt;)Â -&amp;gt;Â &amp;amp;&lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;self&lt;/span&gt;.name&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â nameÂ =Â &lt;span&gt;String&lt;/span&gt;::from(&lt;span&gt;&quot;å¤æ˜åœ°è§‰&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â gÂ =Â Girl{name:&amp;amp;name};&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;{}&quot;&lt;/span&gt;,Â g.say_hi());Â Â &lt;span&gt;//Â helloÂ world&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;{}&quot;&lt;/span&gt;,Â g.get_name(&lt;span&gt;&quot;&quot;&lt;/span&gt;))Â Â &lt;span&gt;//Â å¤æ˜åœ°è§‰&lt;/span&gt;&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;æ¯”è¾ƒç®€å•ï¼Œå¦å¤–ç¨‹åºä¸­è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ç”Ÿå‘½å‘¨æœŸå« &lt;/span&gt;&lt;span&gt;&#x27;static&lt;/span&gt;&lt;span&gt;ï¼Œå®ƒè¡¨ç¤ºæ•´ä¸ªç¨‹åºçš„æŒç»­æ—¶é—´ã€‚æ‰€æœ‰çš„å­—ç¬¦ä¸²å­—é¢é‡éƒ½æ‹¥æœ‰ &#x27;static ç”Ÿå‘½å‘¨æœŸï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â s:Â &amp;amp;&lt;span&gt;&#x27;static&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â =Â &lt;span&gt;&quot;hello&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;ä¸ºå¼•ç”¨æŒ‡å®š &#x27;static ä¹‹å‰éœ€è¦ä¸‰æ€ï¼Œæ˜¯å¦éœ€è¦å¼•ç”¨åœ¨æ•´ä¸ªç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸå†…éƒ½å­˜æ´»ã€‚&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.1153846153846154&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/HlNkQjetfwiaeG2eibibS4RBQY8AFicia9q36jicvERnwdOiatCCicr8H3m5do4ZANHLuqF8yiawknQEaR6LFmL7e97iazfA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;52&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;&lt;span&gt;åŒæ—¶æŒ‡å®šç”Ÿå‘½å‘¨æœŸå’Œæ³›å‹&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08421052631578947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/iaFp77VHVDePrc5TvQGXzzWwicp8jNAyz4O2uURnfYBeoHZ1VItu2A5IQFO5ohzNYV0ABcPcHCZeOtMomUILe16g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;380&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç”Ÿå‘½å‘¨æœŸçš„æŒ‡å®šæ–¹å¼å’Œæ³›å‹æ˜¯ä¸€æ ·çš„ï¼Œé‚£å¦‚æœæƒ³åŒæ—¶æŒ‡å®šç”Ÿå‘½å‘¨æœŸå’Œæ³›å‹ï¼Œåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;largest&lt;/span&gt;&lt;/span&gt;&amp;lt;&lt;span&gt;&#x27;a&lt;/span&gt;,Â T&amp;gt;(x:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,Â y:Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;,&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â useless_arg:Â T)Â -&amp;gt;Â &amp;amp;&lt;span&gt;&#x27;a&lt;/span&gt;Â &lt;span&gt;str&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â xÂ &amp;gt;Â yÂ {&lt;br/&gt;Â Â Â Â Â Â Â Â x&lt;br/&gt;Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â y&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;fn&lt;/span&gt;Â &lt;span&gt;main&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â s1Â =Â &lt;span&gt;&quot;hello&quot;&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;let&lt;/span&gt;Â s2Â =Â &lt;span&gt;&quot;hellO&quot;&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;println!&lt;/span&gt;(&lt;span&gt;&quot;{}&quot;&lt;/span&gt;,Â largest(s1,Â s2,Â &lt;span&gt;&quot;&quot;&lt;/span&gt;));&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â hello&lt;/span&gt;&lt;br/&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;éå¸¸ç®€å•ï¼Œä½†è¦ä¿è¯ç”Ÿå‘½å‘¨æœŸåœ¨å‰ï¼Œæ³›å‹åœ¨åã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä»¥ä¸Šå°±æ˜¯ Rust çš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒå¹¶æ²¡æœ‰æ”¹å˜ Rust å˜é‡çš„å­˜æ´»æ—¶é—´ï¼Œåªæ˜¯ç»™äº†å€Ÿç”¨æ£€æŸ¥å™¨æ›´å¤šçš„ä½™åœ°å»æ¨æ–­å¼•ç”¨æ˜¯å¦åˆæ³•ã€‚&lt;/span&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;å°±ç›®å‰æ¥è¯´ï¼Œæˆ‘ä»¬ä»‹ç»çš„å†…å®¹éƒ½è¿˜å¾ˆåŸºç¡€ï¼Œåº”è¯¥å¾ˆå¥½ç†è§£ã€‚ç­‰æŠŠåŸºç¡€è¯´å®Œäº†ï¼Œåé¢ä¼šä»‹ç»æ›´å¤šå…³äº Rust çš„ç»†èŠ‚ã€‚&lt;/span&gt;&lt;span&gt;æœ€åçš„æœ€åï¼Œæˆ‘ä»¬&lt;/span&gt;å†&lt;span&gt;ä¸€èµ·ç”¨ Rust æ‰‹å†™ä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Redisï¼Œå¹¶å’Œç°æœ‰çš„ Redis åšä¸€ä¸‹æ€§èƒ½å¯¹æ¯”ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>b1b3a8c08d220f607528af3eb7e62096</guid>
<title>Bigkey é—®é¢˜çš„è§£å†³æ€è·¯ä¸æ–¹å¼æ¢ç´¢</title>
<link>https://toutiao.io/k/ne5syi3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ä½œè€…ï¼švivo äº’è”ç½‘æ•°æ®åº“å›¢é˜Ÿ- Du Ting&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;åœ¨Redisè¿ç»´è¿‡ç¨‹ä¸­ï¼Œç”±äºBigkey çš„å­˜åœ¨ï¼Œä¼šå½±å“ä¸šåŠ¡ç¨‹åºçš„å“åº”é€Ÿåº¦ï¼Œä¸¥é‡çš„è¿˜ä¼šé€ æˆå¯ç”¨æ€§æŸå¤±ï¼ŒDBAä¹Ÿä¸€ç›´å’Œä¸šåŠ¡å¼€å‘æ–¹å¼ºè°ƒ Bigkey çš„è§„é¿æ–¹æ³•ä»¥åŠå±å®³ã€‚&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;ä¸€ã€èƒŒæ™¯&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;åœ¨Redisè¿ç»´è¿‡ç¨‹ä¸­ï¼Œç”±äºBigkeyçš„å­˜åœ¨ï¼Œä¼šå½±å“ä¸šåŠ¡ç¨‹åºçš„å“åº”é€Ÿåº¦ï¼Œä¸¥é‡çš„è¿˜ä¼šé€ æˆå¯ç”¨æ€§æŸå¤±ï¼ŒDBAä¹Ÿä¸€ç›´å’Œä¸šåŠ¡å¼€å‘æ–¹å¼ºè°ƒ Bigkey çš„è§„é¿æ–¹æ³•ä»¥åŠå±å®³ï¼Œä½†æ˜¯Bigkeyä¸€ç›´æ²¡æœ‰å®Œå…¨é¿å…ã€‚å…¨ç½‘Redisé›†ç¾¤æœ‰2200ä¸ªä»¥ä¸Šï¼Œå®ä¾‹æ•°é‡è¾¾åˆ°4.5ä¸‡ä»¥ä¸Šï¼Œåœ¨å½“å‰é˜¶æ®µè¿›è¡Œä¸€æ¬¡å…¨ç½‘ Bigkeyæ£€æŸ¥ï¼Œä¼°è®¡éœ€è¦ä»¥å¹´ä¸ºæ—¶é—´å•ä½ï¼Œéå¸¸è€—æ—¶ã€‚æˆ‘ä»¬éœ€è¦æ–°çš„æ€è·¯å»è§£å†³Bigkeyé—®é¢˜ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;äºŒã€Bigkey ä»‹ç»&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;2.1ã€ä»€ä¹ˆæ˜¯ Bigkey&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;åœ¨Redisä¸­ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹æœ€å¤§å¯ä»¥åˆ°512MBï¼Œä¸€ä¸ªäºŒçº§æ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚hashã€listã€setã€zsetç­‰ï¼‰å¯ä»¥å­˜å‚¨å¤§çº¦40äº¿ä¸ª(2^32-1)ä¸ªå…ƒç´ ï¼Œä½†å®é™…ä¸Šä¸ä¼šè¾¾åˆ°è¿™ä¹ˆå¤§çš„å€¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¦‚æœè¾¾åˆ°ä¸‹é¢çš„æƒ…å†µï¼Œå°±å¯ä»¥è®¤ä¸ºå®ƒæ˜¯B&lt;/p&gt;&lt;p&gt;igkeyäº†ã€‚&lt;/p&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;2.2 Bigkeyæ˜¯æ€ä¹ˆäº§ç”Ÿçš„&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬é‡åˆ°çš„Bigkeyä¸€èˆ¬éƒ½æ˜¯ç”±äºç¨‹åºè®¾è®¡ä¸å½“æˆ–è€…å¯¹äºæ•°æ®è§„æ¨¡é¢„æ–™ä¸æ¸…æ¥šé€ æˆçš„ï¼Œæ¯”å¦‚ä»¥ä¸‹çš„æƒ…å†µã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot; powered-by=&quot;xiumi.us&quot;&gt;&lt;li&gt;&lt;p&gt;ã€ç»Ÿè®¡ã€‘ï¼šé‡åˆ°ä¸€ä¸ªç»Ÿè®¡ç±»çš„keyï¼Œæ˜¯è®°å½•æŸç½‘ç«™çš„è®¿é—®ç”¨æˆ·çš„IPï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œç½‘ç«™è®¿é—®çš„ç”¨æˆ·è¶Šæ¥è¶Šå¤šï¼Œè¿™ä¸ªkeyçš„å…ƒç´ æ•°é‡ä¹Ÿä¼šè¶Šæ¥è¶Šå¤§ï¼Œå½¢æˆBigkeyã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ã€ç¼“å­˜ã€‘ï¼šÂ ç¼“å­˜ç±»keyä¸€èˆ¬æ˜¯è¿™æ ·çš„é€»è¾‘ï¼Œå°†æ•°æ®ä»æ•°æ®åº“æŸ¥è¯¢å‡ºæ¥åºåˆ—åŒ–æ”¾åˆ°Redisé‡Œï¼Œå¦‚æœä¸šåŠ¡ç¨‹åºä»Redisæ²¡æœ‰è®¿é—®åˆ°ï¼Œå°±ä¼šæŸ¥è¯¢æ•°æ®åº“å¹¶å°†æŸ¥è¯¢åˆ°çš„æ•°æ®è¿½åŠ åˆ°Redisç¼“å­˜ä¸­ï¼ŒçŸ­æ—¶é—´å†…ä¼šç¼“å­˜å¤§é‡çš„æ•°æ®åˆ°Redisçš„keyä¸­ï¼Œå½¢æˆBigkeyã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;ã€é˜Ÿåˆ—ã€‘ï¼šæŠŠRediså½“åšé˜Ÿåˆ—ä½¿ç”¨ï¼Œå¤„ç†ä»»åŠ¡ï¼Œå¦‚æœæ¶ˆè´¹å‡ºç°ä¸åŠæ—¶æƒ…å†µï¼Œå°†å¯¼è‡´é˜Ÿåˆ—è¶Šæ¥è¶Šå¤§ï¼Œå½¢æˆBigkeyã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;è¿™ä¸‰ç§æƒ…å†µï¼Œéƒ½æ˜¯æˆ‘ä»¬å®é™…è¿ç»´ä¸­é‡åˆ°çš„ï¼Œéœ€è¦è°¨æ…ä½¿ç”¨ï¼Œåˆç†ä¼˜åŒ–ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;2.3 BigkeyÂ çš„å±å®³&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬åœ¨è¿ç»´ä¸­ï¼Œé‡åˆ°Bigkeyçš„æƒ…å†µä¸‹ï¼Œä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ï¼Œä¼šè§¦å‘ç›‘æ§æŠ¥è­¦ï¼Œä¸¥é‡çš„è¿˜ä¼šå½±å“Rediså®ä¾‹å¯ç”¨æ€§ï¼Œè¿›è€Œå½±å“ä¸šåŠ¡å¯ç”¨æ€§ï¼Œåœ¨éœ€è¦æ°´å¹³æ‰©å®¹æ—¶å€™ï¼Œå¯èƒ½å¯¼è‡´æ°´å¹³æ‰©å®¹å¤±è´¥ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;strong&gt;2.3.1å†…å­˜ç©ºé—´ä¸å‡åŒ€&lt;/strong&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;å†…å­˜ç©ºé—´ä¸å‡åŒ€ä¼šä¸åˆ©äºé›†ç¾¤å¯¹å†…å­˜çš„ç»Ÿä¸€ç®¡ç†ï¼Œæœ‰æ•°æ®ä¸¢å¤±é£é™©ã€‚ä¸‹å›¾ä¸­çš„ä¸‰ä¸ªèŠ‚ç‚¹æ˜¯åŒå±äºä¸€ä¸ªé›†ç¾¤ï¼Œå®ƒä»¬çš„keyçš„æ•°é‡æ¯”è¾ƒæ¥è¿‘ï¼Œä½†å†…å­˜å®¹é‡ç›¸å·®æ¯”è¾ƒå¤šï¼Œå­˜åœ¨Bigkeyçš„å®ä¾‹å ç”¨çš„å†…å­˜å¤šäº†4Gä»¥ä¸Šäº†ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.3495248152059134&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;947&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uY0zRzeYyNKnryI8vA1FibO1eBqEqWoE7sJmNSW1piaG1j9niblaFojp7Rw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;å¯ä»¥ä½¿ç”¨ä½¿ç”¨Daaså¹³å°â€œå·¥å…·é›†-æ“ä½œé¡¹ç®¡ç†â€ï¼Œé€‰æ‹©å¯¹åº”çš„slaveå®ä¾‹æ‰§è¡Œåˆ†æï¼Œæ‰¾å‡ºå…·ä½“çš„Bigkeyã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;strong&gt;2.3.2 è¶…æ—¶é˜»å¡&lt;/strong&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;Redisæ˜¯å•çº¿ç¨‹å·¥ä½œçš„ï¼Œé€šä¿—ç‚¹è®²å°±æ˜¯åŒä¸€æ—¶é—´åªèƒ½å¤„ç†ä¸€ä¸ªRedisçš„è®¿é—®å‘½ä»¤ï¼Œæ“ä½œBigkeyçš„å‘½ä»¤é€šå¸¸æ¯”è¾ƒè€—æ—¶ï¼Œè¿™æ®µæ—¶é—´Redisä¸èƒ½å¤„ç†å…¶ä»–å‘½ä»¤ï¼Œå…¶ä»–å‘½ä»¤åªèƒ½é˜»å¡ç­‰å¾…ï¼Œè¿™æ ·ä¼šé€ æˆå®¢æˆ·ç«¯é˜»å¡ï¼Œå¯¼è‡´å®¢æˆ·ç«¯è®¿é—®è¶…æ—¶ï¼Œæ›´ä¸¥é‡çš„ä¼šé€ æˆmaster-slaveçš„æ•…éšœåˆ‡æ¢ã€‚é€ æˆé˜»å¡çš„æ“ä½œä¸ä»…ä»…æ˜¯ä¸šåŠ¡ç¨‹åºçš„è®¿é—®ï¼Œè¿˜æœ‰keyçš„è‡ªåŠ¨è¿‡æœŸçš„åˆ é™¤ã€delåˆ é™¤å‘½ä»¤ï¼Œå¯¹äºBigkeyï¼Œè¿™äº›æ“ä½œä¹Ÿéœ€è¦è°¨æ…ä½¿ç”¨ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;strong&gt;è¶…æ—¶é˜»å¡æ¡ˆä¾‹&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬é‡åˆ°ä¸€ä¸ªè¿™æ ·è¶…æ—¶é˜»å¡çš„æ¡ˆä¾‹ï¼Œä¸šåŠ¡æ–¹åæ˜ ç¨‹åºè®¿é—®Redisé›†ç¾¤å‡ºç°è¶…æ—¶ç°è±¡ï¼Œhkeysè®¿é—®Redisçš„å¹³å‡å“åº”æ—¶é—´åœ¨200æ¯«ç§’å·¦å³ï¼Œæœ€å¤§å“åº”æ—¶é—´è¾¾åˆ°äº†500æ¯«ç§’ä»¥ä¸Šï¼Œå¦‚ä¸‹å›¾ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.7634011090573013&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;541&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uYyLf2ib0jb4V2qsuxXOTg5I8c4A6PleyOaWks4jnln56TTY04XWZlqcw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;hkeysæ˜¯è·å–æ‰€æœ‰å“ˆå¸Œè¡¨ä¸­çš„å­—æ®µçš„å‘½ä»¤ï¼Œåˆ†æåº”è¯¥æ˜¯é›†ç¾¤ä¸­æŸäº›å®ä¾‹å­˜åœ¨hashç±»å‹çš„Bigkeyï¼Œå¯¼è‡´hkeyså‘½ä»¤æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œå‘ç”Ÿäº†é˜»å¡ç°è±¡ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;1.ä½¿ç”¨Daaså¹³å°â€œæœåŠ¡ç›‘æ§-æ•°æ®åº“å®ä¾‹ç›‘æ§â€ï¼Œé€‰æ‹©masterèŠ‚ç‚¹ï¼Œé€‰æ‹©Rediså“åº”æ—¶é—´ç›‘æ§æŒ‡æ ‡â€œredis.instance.latency.maxâ€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»ç›‘æ§å›¾ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ï¼ˆ1ï¼‰æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¯¥å®ä¾‹çš„å“åº”æ—¶é—´åœ¨0.1æ¯«ç§’å·¦å³ã€‚&lt;/p&gt;&lt;p&gt;ï¼ˆ2ï¼‰ç›‘æ§æŒ‡æ ‡ä¸Šé¢æœ‰å¾ˆå¤šçªåˆºï¼Œè¯¥å®ä¾‹çš„å“åº”æ—¶é—´åˆ°äº†70æ¯«ç§’å·¦å³ï¼Œæœ€å¤§åˆ°äº†100æ¯«ç§’å·¦å³ï¼Œè¿™ç§æƒ…å†µå°±æ˜¯è¯¥å®ä¾‹ä¼šæœ‰100æ¯«ç§’éƒ½åœ¨å¤„ç†Bigkeyçš„è®¿é—®å‘½ä»¤ï¼Œä¸èƒ½å¤„ç†å…¶ä»–å‘½ä»¤ã€‚&lt;/p&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;é€šè¿‡æŸ¥çœ‹ç›‘æ§æŒ‡æ ‡ï¼ŒéªŒè¯äº†æˆ‘ä»¬åˆ†ææ˜¯æ­£ç¡®çš„ï¼Œæ˜¯è¿™äº›ç›‘æ§æŒ‡æ ‡çš„çªåˆºé€ æˆäº†hkeyså‘½ä»¤çš„å“åº”æ—¶é—´æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†å…·ä½“çš„masterå®ä¾‹ï¼Œç„¶åä½¿ç”¨masterå®ä¾‹çš„slaveå»åˆ†æä¸‹Bigkeyæƒ…å†µã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.6415770609318996&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;558&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uYLpJQLJVQ4AWBVBnp7Fs9plSFDhc0HmL2oUTnicLcu4eibX9joeqx9UFA/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.6432432432432432&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;555&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uYSFX0oFOhics1uNVeAdFhclHMRA5m5TEJTyRwUeWvacw0Pvib4ZVEibUUQ/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;2.ä½¿ç”¨Daaså¹³å°â€œå·¥å…·é›†-æ“ä½œé¡¹ç®¡ç†â€ï¼Œé€‰æ‹©slaveå®ä¾‹æ‰§è¡Œåˆ†æï¼Œåˆ†æç»“æœå¦‚ä¸‹å›¾ï¼Œæœ‰ä¸€ä¸ªhashç±»å‹keyæœ‰12102218ä¸ªfieldsã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.3089430894308943&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;738&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uYn8Tp3ibz9ADxfbGE1X8uiaGr9ju4BB4max0jPw8l2IYa19QUDZoiawb4A/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;3. å’Œä¸šåŠ¡æ²Ÿé€šï¼Œè¿™ä¸ªBigkeyæ˜¯è¿ç»­å­˜æ”¾äº†30å¤©çš„ä¸šåŠ¡æ•°æ®äº†ï¼Œå»ºè®®æ ¹æ®äºŒæ¬¡hashæ–¹å¼æ‹†åˆ†æˆå¤šä¸ªkeyï¼Œä¹Ÿå¯æŠŠ30å¤©çš„æ•°æ®æ ¹æ®åˆ†é’Ÿçº§åˆ«æ‹†åˆ†æˆå¤šä¸ªkeyï¼ŒæŠŠæ¯ä¸ªkeyçš„å…ƒç´ æ•°é‡æ§åˆ¶åœ¨5000ä»¥å†…ï¼Œç›®å‰ä¸šåŠ¡æ­£åœ¨æ’æœŸä¼˜åŒ–ä¸­ã€‚ä¼˜åŒ–åï¼Œç›‘æ§æŒ‡æ ‡çš„å“åº”æ—¶é—´çš„çªåˆºå°±ä¼šæ¶ˆå¤±äº†ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;strong&gt;2.3.3 ç½‘ç»œé˜»å¡&lt;/strong&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;Bigkeyçš„valueæ¯”è¾ƒå¤§ï¼Œä¹Ÿæ„å‘³ç€æ¯æ¬¡è·å–è¦äº§ç”Ÿçš„ç½‘ç»œæµé‡è¾ƒå¤§ï¼Œå‡è®¾ä¸€ä¸ªBigkeyä¸º10MBï¼Œå®¢æˆ·ç«¯æ¯ç§’è®¿é—®é‡ä¸º100ï¼Œé‚£ä¹ˆæ¯ç§’äº§ç”Ÿ1000MBçš„æµé‡ï¼Œå¯¹äºæ™®é€šçš„åƒå…†ç½‘å¡(æŒ‰ç…§å­—èŠ‚ç®—æ˜¯128MB/s)çš„æœåŠ¡å™¨æ¥è¯´ç®€ç›´æ˜¯ç­é¡¶ä¹‹ç¾ã€‚è€Œä¸”æˆ‘ä»¬ç°åœ¨çš„RedisæœåŠ¡å™¨æ˜¯é‡‡ç”¨å•æœºå¤šå®ä¾‹çš„æ–¹å¼æ¥éƒ¨ç½²Rediså®ä¾‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªBigkeyå¯èƒ½ä¼šå¯¹åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„å…¶ä»–Redisé›†ç¾¤å®ä¾‹é€ æˆå½±å“ï¼Œå½±å“åˆ°å…¶ä»–çš„ä¸šåŠ¡ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;strong&gt;2.3.4 è¿ç§»å›°éš¾&lt;/strong&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬åœ¨è¿ç»´ä¸­ç»å¸¸åšçš„å˜æ›´æ“ä½œæ˜¯æ°´å¹³æ‰©å®¹ï¼Œå°±æ˜¯å¢åŠ Redisé›†ç¾¤çš„èŠ‚ç‚¹æ•°é‡æ¥è¾¾åˆ°æ‰©å®¹çš„ç›®çš„ï¼Œè¿™ä¸ªæ°´å¹³æ‰©å®¹æ“ä½œå°±ä¼šæ¶‰åŠåˆ°keyçš„è¿ç§»ï¼ŒæŠŠåŸå®ä¾‹ä¸Šçš„keyè¿ç§»åˆ°æ–°æ‰©å®¹çš„å®ä¾‹ä¸Šã€‚å½“è¦å¯¹keyè¿›è¡Œè¿ç§»æ—¶ï¼Œæ˜¯é€šè¿‡migrateå‘½ä»¤æ¥å®Œæˆçš„ï¼Œmigrateå®é™…ä¸Šæ˜¯é€šè¿‡dump + restore + delä¸‰ä¸ªå‘½ä»¤ç»„åˆæˆåŸå­å‘½ä»¤å®Œæˆï¼Œå®ƒåœ¨æ‰§è¡Œçš„æ—¶å€™ä¼šé˜»å¡è¿›è¡Œè¿ç§»çš„ä¸¤ä¸ªå®ä¾‹ï¼Œç›´åˆ°ä»¥ä¸‹ä»»æ„ç»“æœå‘ç”Ÿæ‰ä¼šé‡Šæ”¾ï¼šè¿ç§»æˆåŠŸï¼Œè¿ç§»å¤±è´¥ï¼Œç­‰å¾…è¶…æ—¶ã€‚å¦‚æœkeyçš„è¿ç§»è¿‡ç¨‹ä¸­é‡åˆ°Bigkeyï¼Œä¼šé•¿æ—¶é—´é˜»å¡è¿›è¡Œè¿ç§»çš„ä¸¤ä¸ªå®ä¾‹ï¼Œå¯èƒ½é€ æˆå®¢æˆ·ç«¯é˜»å¡ï¼Œå¯¼è‡´å®¢æˆ·ç«¯è®¿é—®è¶…æ—¶ï¼›ä¹Ÿå¯èƒ½è¿ç§»æ—¶é—´å¤ªé•¿ï¼Œé€ æˆè¿ç§»è¶…æ—¶å¯¼è‡´è¿ç§»å¤±è´¥ï¼Œæ°´å¹³æ‰©å®¹å¤±è´¥ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;strong&gt;è¿ç§»å¤±è´¥æ¡ˆä¾‹&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬ä¹Ÿé‡åˆ°è¿‡ä¸€äº›å› ä¸ºBigkeyæ‰©å®¹è¿ç§»å¤±è´¥çš„æ¡ˆä¾‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ˜¯ä¸€ä¸ªRedisé›†ç¾¤æ°´å¹³æ‰©å®¹çš„å·¥å•ï¼Œéœ€è¦è¿›è¡Œkeyçš„è¿ç§»ï¼Œå½“å·¥å•æ‰§è¡Œåˆ°60%çš„æ—¶å€™ï¼Œè¿ç§»å¤±è´¥äº†ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;1. è¿›å…¥å·¥å•æ‰¾åˆ°å¤±è´¥çš„å®ä¾‹ï¼Œä½¿ç”¨å¤±è´¥å®ä¾‹çš„slaveèŠ‚ç‚¹ï¼Œåœ¨Daaså¹³å°çš„â€œå·¥å…·é›†-æ“ä½œé¡¹ç®¡ç†â€è¿›è¡ŒBigkeyåˆ†æã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.32890625&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uYj3pHUicWAhJBpZHEAlrogdBiceV7DQ3TNGF8ia6pUaiaagKJcFr5DUFYiaw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;2. ç»è¿‡åˆ†ææ‰¾å‡ºäº†hashç±»å‹çš„Bigkeyæœ‰8421874ä¸ªfieldsï¼Œæ­£æ˜¯è¿™ä¸ªBigkeyå¯¼è‡´è¿ç§»æ—¶é—´å¤ªé•¿ï¼Œè¶…è¿‡äº†è¿ç§»æ—¶é—´é™åˆ¶ï¼Œå¯¼è‡´å·¥å•å¤±è´¥äº†ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.19976635514018692&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;856&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt6WBnmfRxTkUDeeKXdtp7uYjqO7lad0oQCc4wiceIrqDibYwvzeuqb5jUwSN8c7ib5ibbRDNjanXP7Akw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;3.å’Œä¸šåŠ¡æ²Ÿé€šï¼Œè¿™äº›keyæ˜¯è®°å½•ç”¨æˆ·è®¿é—®ç³»ç»Ÿçš„æŸä¸ªåŠŸèƒ½æ¨¡å—çš„ipåœ°å€çš„ï¼Œè®¿é—®è¯¥åŠŸèƒ½æ¨¡å—çš„æ‰€æœ‰ipéƒ½ä¼šè®°å½•åˆ°ç»™keyé‡Œé¢ï¼Œéšç€æ—¶é—´çš„ç§¯ç´¯ï¼Œè¿™ä¸ªkeyå˜çš„è¶Šæ¥è¶Šå¤§ã€‚åŒæ ·æ˜¯é‡‡ç”¨æ‹†åˆ†çš„æ–¹å¼è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥è€ƒè™‘æŒ‰ç…§æ—¶é—´æ—¥æœŸç»´åº¦æ¥æ‹†åˆ†ï¼Œå°±æ˜¯ä¸€æ®µæ—¶é—´æ®µçš„è®¿é—®ipè®°å½•åˆ°ä¸€ä¸ªkeyä¸­ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;4.Bigkeyä¼˜åŒ–åï¼Œæ‰©å®¹çš„å·¥å•å¯ä»¥é‡è¯•ï¼Œå®Œæˆé›†ç¾¤æ‰©å®¹æ“ä½œã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;ä¸‰ã€Bigkeyçš„å‘ç°&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;Bigkeyé¦–å…ˆéœ€è¦é‡æºå¤´æ²»ç†ï¼Œé˜²æ­¢Bigkeyçš„äº§ç”Ÿï¼›å…¶æ¬¡æ˜¯éœ€è¦èƒ½å¤ŸåŠæ—¶çš„å‘ç°ï¼Œå‘ç°ååŠæ—¶å¤„ç†ã€‚åˆ†æBigkeyçš„æ–¹æ³•ä¸å°‘ï¼Œè¿™é‡Œä»‹ç»ä¸¤ç§æ¯”è¾ƒå¸¸ç”¨çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯Daaså¹³å°åˆ†æBigkeyä½¿ç”¨çš„ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯Bigkeyså‘½ä»¤åˆ†ææ³•ã€RDBæ–‡ä»¶åˆ†ææ³•ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;3.1 scanå‘½ä»¤åˆ†æ&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;Redis4.0åŠä»¥ä¸Šç‰ˆæœ¬æä¾›äº†--Bigkeyså‘½ä»¤ï¼Œå¯ä»¥åˆ†æå‡ºå®ä¾‹ä¸­æ¯ç§æ•°æ®ç»“æ„çš„top 1çš„Bigkeyï¼ŒåŒæ—¶ç»™å‡ºäº†æ¯ç§æ•°æ®ç±»å‹çš„é”®å€¼ä¸ªæ•°ä»¥åŠå¹³å‡å¤§å°ã€‚æ‰§è¡Œ--Bigkeyså‘½ä»¤æ—¶å€™éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;å»ºè®®åœ¨slaveèŠ‚ç‚¹æ‰§è¡Œï¼Œå› ä¸º--Bigkeysä¹Ÿæ˜¯é€šè¿‡scanå®Œæˆçš„ï¼Œå¯èƒ½ä¼šå¯¹èŠ‚ç‚¹é€ æˆé˜»å¡ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;å»ºè®®åœ¨èŠ‚ç‚¹æœ¬æœºæ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç½‘ç»œå¼€é”€ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;å¦‚æœæ²¡æœ‰ä»èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨--iå‚æ•°ï¼Œä¾‹å¦‚(--i 0.1 ä»£è¡¨100æ¯«ç§’æ‰§è¡Œä¸€æ¬¡)ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;--Bigkeysåªèƒ½è®¡ç®—æ¯ç§æ•°æ®ç»“æ„çš„top1ï¼Œå¦‚æœæœ‰äº›æ•°æ®ç»“æ„æœ‰æ¯”è¾ƒå¤šçš„Bigkeyï¼Œæ˜¯æŸ¥æ‰¾ä¸å‡ºæ¥çš„ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;Daaså¹³å°é›†æˆäº†åŸºäºåŸç”Ÿ--Bigkeysä»£ç å®ç°çš„æŸ¥è¯¢Bigkeyçš„æ–¹å¼ï¼Œè¿™ä¸ªæ–¹å¼çš„ç¼ºç‚¹æ˜¯åªèƒ½è®¡ç®—æ¯ç§æ•°æ®ç»“æ„çš„top1ï¼Œå¦‚æœæœ‰äº›æ•°æ®ç»“æ„æœ‰æ¯”è¾ƒå¤šçš„Bigkeyï¼Œæ˜¯æŸ¥æ‰¾ä¸å‡ºæ¥çš„ã€‚è¯¥æ–¹å¼ç›¸å¯¹æ¯”è¾ƒå®‰å…¨ï¼Œå·²ç»å¼€æ”¾å‡ºæ¥ç»™ä¸šåŠ¡å¼€å‘åŒå­¦ä½¿ç”¨ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;3.2 RDBæ–‡ä»¶åˆ†æ&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;å€ŸåŠ©å¼€æºçš„å·¥å…·ï¼Œæ¯”å¦‚rdb-toolsï¼Œåˆ†æRediså®ä¾‹çš„RDBæ–‡ä»¶ï¼Œæ‰¾å‡ºå…¶ä¸­çš„Bigkeyï¼Œè¿™ç§æ–¹å¼éœ€è¦ç”ŸæˆRDBæ–‡ä»¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;Daaså¹³å°é›†æˆäº†åŸºäºRDBæ–‡ä»¶åˆ†æä»£ç å®ç°çš„æŸ¥è¯¢Bigkeyçš„æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è‡ªå®šä¹‰å¡«å†™Nï¼Œåˆ†æçš„top Nä¸ªBigkeyã€‚è¯¥æ–¹å¼ç›¸å¯¹æœ‰ä¸€å®šé£é™©ï¼Œåªæœ‰DBAæœ‰æƒé™æ‰§è¡Œåˆ†æã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;3.3 Bigkey å·¡æ£€&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;é€šè¿‡å·¡æ£€ï¼Œå¯ä»¥æš´éœ²å‡ºéšæ‚£ï¼Œæå‰è§£å†³ï¼Œé¿å…æ•…éšœçš„å‘ç”Ÿï¼Œè¿›è¡Œå…¨ç½‘Bigkeyçš„å·¡æ£€ï¼Œæ˜¯é¿å…Bigkeyæ•…éšœçš„æ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚ç”±äºå…¨ç½‘Rediså®ä¾‹æ•°é‡éå¸¸å¤§ï¼Œåˆ†æçš„é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œä½¿ç”¨å½“å‰çš„åˆ†ææ–¹æ³•å¾ˆéš¾å®Œæˆã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå­˜å‚¨ç ”å‘ç»„åˆ†å¸ƒå¼æ•°æ®åº“åŒå­¦è®¡åˆ’å¼€å‘ä¸€ä¸ªé«˜æ•ˆçš„RDBè§£æå·¥å…·ï¼Œç„¶åé€šè¿‡å¤§è§„æ¨¡è§£æRDBæ–‡ä»¶æ¥åˆ†æBigkeyï¼Œå¯ä»¥æé«˜åˆ†æé€Ÿåº¦ï¼Œå®ç°Bigkeyçš„å·¡æ£€ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;å››ã€ Bigkeyå¤„ç†ä¼˜åŒ–&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;4.1 Bigkeyæ‹†åˆ†&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;ä¼˜åŒ–Bigkeyçš„åŸåˆ™å°±æ˜¯stringå‡å°‘å­—ç¬¦ä¸²é•¿åº¦ï¼Œlistã€hashã€setã€zsetç­‰å‡å°‘å…ƒç´ æ•°é‡ã€‚å½“æˆ‘ä»¬çŸ¥é“å“ªäº›keyæ˜¯Bigkeyæ—¶ï¼Œå¯ä»¥æŠŠå•ä¸ªkeyæ‹†åˆ†æˆå¤šä¸ªkeyï¼Œæ¯”å¦‚ä»¥ä¸‹æ‹†åˆ†æ–¹å¼å¯ä»¥å‚è€ƒã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot; powered-by=&quot;xiumi.us&quot;&gt;&lt;li&gt;&lt;p&gt;big listï¼šlist1ã€list2ã€...listN&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;big hashï¼šå¯ä»¥åšäºŒæ¬¡çš„hashï¼Œä¾‹å¦‚hash%100&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;æŒ‰ç…§æ—¥æœŸæ‹†åˆ†å¤šä¸ªï¼škey20220310ã€key20220311ã€key202203212&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;4.2 Bigkeyåˆ†æå·¥å…·ä¼˜åŒ–&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬å…¨ç½‘Redisé›†ç¾¤æœ‰2200ä»¥ä¸Šï¼Œå®ä¾‹æ•°é‡è¾¾åˆ°4.5ä¸‡ä»¥ä¸Šï¼Œæœ‰çš„æ¯”è¾ƒå¤§çš„é›†ç¾¤çš„å®ä¾‹æ•°é‡è¾¾åˆ°äº†1000ä»¥ä¸Šï¼Œå‰é¢æåˆ°çš„ä¸¤ç§Bigkeyåˆ†æå·¥å…·è¿˜éƒ½æ˜¯å®ä¾‹ç»´åº¦åˆ†æï¼Œå¯¹äºå®ä¾‹æ•°é‡æ¯”è¾ƒå¤§çš„é›†ç¾¤ï¼Œè¿›è¡Œå…¨é›†ç¾¤åˆ†æä¹Ÿæ˜¯æ¯”è¾ƒè€—æ—¶çš„ï¼Œä¸ºäº†æé«˜åˆ†ææ•ˆç‡ï¼Œä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢è¿›è¡Œä¼˜åŒ–ï¼š&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot; powered-by=&quot;xiumi.us&quot;&gt;&lt;li&gt;&lt;p&gt;å¯ä»¥ä»é›†ç¾¤ç»´åº¦é€‰æ‹©å…¨éƒ¨slaveè¿›è¡Œåˆ†æã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;åŒä¸€ä¸ªé›†ç¾¤çš„ç›¸åŒæœåŠ¡å™¨slaveå®ä¾‹ä¸²è¡Œåˆ†æï¼Œä¸åŒæœåŠ¡å™¨çš„slaveå®ä¾‹å¹¶è¡Œåˆ†æï¼Œæœ€å¤§å¹¶å‘åº¦é»˜è®¤10ï¼ŒåŒæ—¶å¯ä»¥åˆ†æ10ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥è‡ªå®šä¹‰è¾“å…¥æ‰§è¡Œåˆ†æçš„å¹¶å‘åº¦ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;åˆ†æå‡ºç¬¦åˆBigkeyè§„å®šæ ‡å‡†çš„æ‰€æœ‰keyä¿¡æ¯ï¼šå¤§äº1MBçš„stringç±»å‹çš„æ‰€æœ‰keyï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ—å‡ºæœ€å¤§çš„50ä¸ªkeyï¼›hashã€listã€setã€zsetç­‰ç±»å‹å…ƒç´ ä¸ªæ•°å¤§äº2000çš„æ‰€æœ‰keyï¼Œå¦‚ä¸å­˜åœ¨å°±ç»™å‡ºæ¯ç§ç±»å‹æœ€å¤§çš„50ä¸ªkeyã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;å¢åŠ æš‚åœã€é‡æ–°å¼€å§‹ã€ç»“æŸåŠŸèƒ½ï¼Œæš‚åœåˆ†æåå¯ä»¥é‡æ–°å¼€å§‹ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;span&gt;4.3 æ°´å¹³æ‰©å®¹è¿ç§»ä¼˜åŒ–&lt;/span&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;ç›®å‰æƒ…å†µï¼Œæˆ‘ä»¬æœ‰ä¸€äº›Bigkeyçš„å‘ç°æ˜¯è¢«åŠ¨çš„ï¼Œä¸€äº›æ˜¯åœ¨æ°´å¹³æ‰©å®¹æ—¶å€™å‘ç°çš„ï¼Œç”±äºBigkeyçš„å­˜åœ¨å¯¼è‡´æ‰©å®¹å¤±è´¥äº†ï¼Œä¸¥é‡çš„è¿˜è§¦å‘äº†master-slaveçš„æ•…éšœåˆ‡æ¢ï¼Œè¿™ä¸ªæ—¶å€™å¯èƒ½å·²ç»é€ æˆä¸šåŠ¡ç¨‹åºè®¿é—®è¶…æ—¶ï¼Œå¯¼è‡´äº†å¯ç”¨æ€§ä¸‹é™ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬åˆ†æäº†Daaså¹³å°çš„æ°´å¹³æ‰©å®¹æ—¶è¿ç§»keyçš„è¿‡ç¨‹åŠå½±å“å‚æ•°ï¼Œå†…å®¹å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ï¼ˆ1ï¼‰ã€cluster-node-timeoutã€‘ï¼šæ§åˆ¶é›†ç¾¤çš„èŠ‚ç‚¹åˆ‡æ¢å‚æ•°ï¼Œmasterå µå¡è¶…è¿‡cluster-node-timeout/2è¿™ä¸ªæ—¶é—´ï¼Œå°±ä¼šä¸»è§‚åˆ¤å®šè¯¥èŠ‚ç‚¹ä¸‹çº¿pfailçŠ¶æ€ï¼Œå¦‚æœè¿ç§»Bigkeyé˜»å¡æ—¶é—´è¶…è¿‡cluster-node-timeout/2ï¼Œå°±å¯èƒ½ä¼šå¯¼è‡´master-slaveå‘ç”Ÿåˆ‡æ¢ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ2ï¼‰ã€migrate timeoutã€‘ï¼šæ§åˆ¶è¿ç§»ioçš„è¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¿™ä¸ªæ—¶é—´è¿ç§»æ²¡æœ‰å®Œæˆï¼Œè¿ç§»å°±ä¼šä¸­æ–­ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ3ï¼‰ã€è¿ç§»é‡è¯•å‘¨æœŸã€‘ï¼šè¿ç§»çš„é‡è¯•å‘¨æœŸæ˜¯ç”±æ°´å¹³æ‰©å®¹çš„èŠ‚ç‚¹æ•°å†³å®šçš„ï¼Œæ¯”å¦‚ä¸€ä¸ªé›†ç¾¤æ‰©å®¹10ä¸ªèŠ‚ç‚¹ï¼Œè¿ç§»å¤±è´¥åçš„é‡è¯•å‘¨æœŸå°±æ˜¯10æ¬¡ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ4ï¼‰ã€ä¸€ä¸ªè¿ç§»é‡è¯•å‘¨æœŸå†…çš„é‡è¯•æ¬¡æ•°ã€‘ï¼šåœ¨ä¸€ä¸ªèµ·è¿ç§»é‡è¯•å‘¨æœŸå†…ï¼Œä¼šæœ‰3æ¬¡é‡è¯•è¿ç§»ï¼Œæ¯ä¸€æ¬¡çš„migrate timeoutçš„æ—¶é—´åˆ†åˆ«æ˜¯10ç§’ã€20ç§’ã€30ç§’ï¼Œæ¯æ¬¡é‡è¯•ä¹‹é—´æ— é—´éš”ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªé›†ç¾¤æ‰©å®¹10ä¸ªèŠ‚ç‚¹ï¼Œè¿ç§»æ—¶å€™é‡åˆ°ä¸€ä¸ªBigkeyï¼Œç¬¬ä¸€æ¬¡è¿ç§»çš„migrate timeoutæ˜¯10ç§’ï¼Œ10ç§’åæ²¡æœ‰å®Œæˆè¿ç§»ï¼Œå°±ä¼šè®¾ç½®migrate timeoutä¸º20ç§’é‡è¯•ï¼Œå¦‚æœå†æ¬¡å¤±è´¥ï¼Œä¼šè®¾ç½®migrate timeoutä¸º30ç§’é‡è¯•ï¼Œå¦‚æœè¿˜æ˜¯å¤±è´¥ï¼Œç¨‹åºä¼šè¿ç§»å…¶ä»–æ–°9ä¸ªçš„èŠ‚ç‚¹ï¼Œä½†æ˜¯æ¯æ¬¡åœ¨è¿ç§»å…¶ä»–æ–°çš„èŠ‚ç‚¹ä¹‹å‰è¿˜ä¼šåˆ†åˆ«è®¾ç½®migrate timeoutä¸º10ç§’ã€20ç§’ã€30ç§’é‡è¯•è¿ç§»é‚£ä¸ªè¿ç§»å¤±è´¥çš„Bigkeyã€‚è¿™ä¸ªé‡è¯•è¿‡ç¨‹ï¼Œæ¯ä¸ªé‡è¯•å‘¨æœŸé˜»å¡ï¼ˆ10+20+30ï¼‰ç§’ï¼Œä¼šé‡è¯•10ä¸ªå‘¨æœŸï¼Œå…±é˜»å¡600ç§’ã€‚å…¶å®åé¢çš„9ä¸ªé‡è¯•å‘¨æœŸéƒ½æ˜¯æ— ç”¨çš„ï¼Œæ¯æ¬¡é‡è¯•ä¹‹é—´æ²¡æœ‰é—´éš”ï¼Œä¼šè¿ç»­é˜»å¡äº†Rediså®ä¾‹ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ5ï¼‰ã€è¿ç§»å¤±è´¥æ—¥å¿—ã€‘ï¼šè¿ç§»å¤±è´¥åï¼Œè®°å½•çš„æ—¥å¿—æ²¡æœ‰åŒ…æ‹¬è¿ç§»èŠ‚ç‚¹ã€soltã€keyä¿¡æ¯ï¼Œä¸èƒ½æ ¹æ®æ—¥å¿—ç«‹å³å®šä½åˆ°é—®é¢˜keyã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æˆ‘ä»¬å¯¹è¿™ä¸ªè¿ç§»è¿‡ç¨‹åšäº†ä¼˜åŒ–ï¼Œå…·ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ï¼ˆ1ï¼‰ã€cluster-node-timeoutã€‘ï¼šé»˜è®¤æ˜¯60ç§’ï¼Œåœ¨è¿ç§»ä¹‹å‰è®¾ç½®ä¸º15åˆ†é’Ÿï¼Œé˜²æ­¢ç”±äºè¿ç§»Bigkeyé˜»å¡å¯¼è‡´master-slaveæ•…éšœåˆ‡æ¢ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ2ï¼‰ã€migrate timeoutã€‘ï¼šä¸ºäº†æœ€å¤§é™åº¦å‡å°‘å®ä¾‹é˜»å¡æ—¶é—´ï¼Œæ¯æ¬¡é‡è¯•çš„è¶…æ—¶æ—¶é—´éƒ½æ˜¯10ç§’ï¼Œ3æ¬¡é‡è¯•ä¹‹é—´é—´éš”30ç§’ï¼Œè¿™æ ·æœ€å¤šåªä¼šè¿ç»­é˜»å¡Rediså®ä¾‹10ç§’ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ3ï¼‰ã€é‡è¯•æ¬¡æ•°ã€‘ï¼šè¿ç§»å¤±è´¥åï¼Œåªé‡è¯•3æ¬¡ï¼ˆé‡è¯•æ˜¯ä¸ºäº†é¿å…ç½‘ç»œæŠ–åŠ¨ç­‰åŸå› é€ æˆçš„è¿ç§»å¤±è´¥ï¼‰ï¼Œæ¯æ¬¡é‡è¯•é—´éš”30ç§’ï¼Œé‡è¯•3æ¬¡åéƒ½å¤±è´¥äº†ï¼Œä¼šæš‚åœè¿ç§»ï¼Œæ—¥å¿—è®°å½•ä¸‹Bigkeyï¼Œå»æ‰äº†å…¶ä»–èŠ‚ç‚¹è¿ç§»çš„é‡è¯•ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ï¼ˆ4ï¼‰ã€ä¼˜åŒ–æ—¥å¿—è®°å½•ã€‘ï¼šè¿ç§»å¤±è´¥æ—¥å¿—è®°å½•è¿ç§»èŠ‚ç‚¹ã€soltã€keyä¿¡æ¯ï¼Œå¯ä»¥ç«‹å³å®šä½åˆ°é—®é¢˜èŠ‚ç‚¹åŠkeyã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;äº”ã€æ€»ç»“&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;æœ¬æ–‡é€šè¿‡å¯¹Bigkeyçš„åˆ†æï¼Œé‡ç‚¹ä»‹ç»äº†åœ¨è¿ç»´ä¸­å¯¹bigkeyé—®é¢˜çš„å¤„ç†æ€è·¯ã€è§£å†³æ–¹å¼ã€‚é¦–å…ˆæ˜¯éœ€è¦ä»æºå¤´æ²»ç†ï¼Œé˜²æ­¢Bigkeyå½¢æˆï¼ŒDBAåº”è¯¥åŠ å¼ºå¯¹ä¸šåŠ¡å¼€å‘åŒå­¦bigkeyç›¸å…³é—®é¢˜çš„å®£å¯¼ï¼›å…¶æ¬¡æ˜¯éœ€è¦å…·å¤‡åŠæ—¶å‘ç°çš„èƒ½åŠ›ï¼Œè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬ç°åœ¨çš„ä¸è¶³ä¹‹å¤„ã€‚æˆ‘ä»¬åé¢ä¼šä»Bigkeyå·¡æ£€ã€Bigkeyåˆ†æå·¥å…·çš„è¿™ä¸¤ä¸ªæ–¹é¢ï¼Œæé«˜Bigkeyå‘ç°èƒ½åŠ›ã€‚&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://doc.redisfans.com/index.html&quot; textvalue=&quot;Rediså‘½ä»¤å‚è€ƒ&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; tab=&quot;outerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;Rediså‘½ä»¤å‚è€ƒ&lt;/span&gt;&lt;/a&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;https://github.com/sripathikrishnan/redis-rdb-tools&quot; textvalue=&quot;Githubï¼šrdb-tools&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; tab=&quot;outerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;Githubï¼šrdb-tools&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;https://www.cnblogs.com/szq95716/p/14271108.html&quot; textvalue=&quot;redisä¹‹bigkeyï¼ˆçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿï¼‰&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; tab=&quot;outerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;redisä¹‹bigkeyï¼ˆçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿï¼‰&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;END&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;span title=&quot;&quot; opera-tn-ra-cell=&quot;_$.pages:0.layers:0.comps:129.title1&quot;&gt;&lt;p&gt;çŒœä½ å–œæ¬¢&lt;/p&gt;&lt;/span&gt; &lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p powered-by=&quot;xiumi.us&quot;&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mp-common-profile&quot; data-from=&quot;0&quot; data-id=&quot;MzI4NjY4MTU5Nw==&quot; data-alias=&quot;vivoVMIC&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/4g5IMGibSxt45QXJZicZ9gaNU2mRSlvqhQd94MJ7oQh4QFj1ibPV66xnUiaKoicSatwaGXepL5sBDSDLEckicX1ttibHg/0?wx_fmt=png&quot; data-nickname=&quot;vivoäº’è”ç½‘æŠ€æœ¯&quot; data-signature=&quot;åˆ†äº«&quot; vivo=&quot;&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>