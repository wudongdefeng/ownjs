<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>d017438c5fe9e8283bc3240e4ae2244e</guid>
<title>超大体量项目，微前端落地方案，看完后悔来找我</title>
<link>https://toutiao.io/k/xb3o4g5</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;介绍&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;先介绍一下我们的项目背景，该项目是从18年开始启动的中间搁置了很久导致项目架构比较落后并且后期继续业务开发的时候也没有持续对架构进行优化迭代而是直接进行了业务开发，导致后面有很多的问题比如&lt;code&gt;启动慢&lt;/code&gt;、&lt;code&gt;代码耦合性强&lt;/code&gt;、&lt;code&gt;项目体量巨大&lt;/code&gt;导致开发效率降低之类的问题&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;问题描述&lt;/span&gt;&lt;/h3&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;目前项目体量达到了&lt;code&gt;400&lt;/code&gt;个路由&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;打包完的包大小为&lt;code&gt;60MB&lt;/code&gt;左右&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;首次启动时间为&lt;code&gt;3分钟&lt;/code&gt;左右&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;热更新时间为&lt;code&gt;10s&lt;/code&gt;左右&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;过程&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经过一段时间对项目架构的优化迭代，包括对路由架构的划分重构，解决了一部分在开发中的问题，但是对于项目体量巨大导致&lt;code&gt;耦合性强&lt;/code&gt;和&lt;code&gt;启动较慢&lt;/code&gt;的问题还是没办法从根本上解决，所以我们准备采用&lt;code&gt;微前端&lt;/code&gt;的方案来对项目进行具体的拆分，最后达到的一个目的解决代码之间&lt;code&gt;耦合性&lt;/code&gt;的问题、解决项目&lt;code&gt;开发效率&lt;/code&gt;的问题、划分清楚每个子应用可以支持&lt;code&gt;单独部署&lt;/code&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;计划&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们项目核心是从场景+管控+支付生成的每一条线，之后的计划是按照这三部分划分子应用，所以采用的大的框架方案就是这样&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;先定好目标和计划然后一步步向着这个方向慢慢搞&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9777777777777777&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELThquXAe28IcGYwmJpQfZj5L9kOpV2rEW4Db80bnf37Vqjbfa65EibMEw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;720&quot;/&gt;&lt;figcaption&gt;lQDPJxaA_CIoPGDNBCDNBDiwwqe6X4-bMxUC1GUVWYB_AA_1080_1056.jpg_720x720g.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;核心逻辑&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;场景&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;管控&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;支付&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;场景是一个子应用我们有比如酒店、火车等场景&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;管控是一个子应用他可以接收来自场景的参数渲染不同的管控页面&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;收银台是一个子应用提供场景支付能力&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;方案&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们采用的是当下比较成熟的方案&lt;code&gt;qinakun&lt;/code&gt;，这个在社区已经活跃很久了并且有一定的稳定性，开发接入文档和可能遇到的一些异常的问题社区都有很好的回答，接下来看看我们的具体操作&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;梳理当前需要拆分子应用涉及到的问题和依赖&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;使用的组件依赖&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;样式上的依赖&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;适配方案的依赖&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;路由的依赖划分&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;去除当前应用之外的代码 --- 瘦身操作&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;创建一个新的架构用来承载子应用&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;采用react-scripts重新cra配置快速构建&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;搭建环境用到的依赖比如需要用到的&lt;code&gt;ts、less、vw/vh适配方案&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;根据主项目用到的依赖去构建子应用的&lt;code&gt;package&lt;/code&gt;尽量不要改动太大防止子项目启动失败&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;之后根据qiankun文档的提示去改造主应用和子应用&lt;/span&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { registerMicroApps, start } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;qiankun&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;registerMicroApps([&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&#x27;webapp-qkrechargecenter&#x27;&lt;/span&gt;, &lt;span&gt;//对应的子应用package的name&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;entry&lt;/span&gt;: &lt;span&gt;&#x27;//localhost:3000/&#x27;&lt;/span&gt;, &lt;span&gt;//子应用域名&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;container&lt;/span&gt;: &lt;span&gt;&#x27;#webapp-qkrechargecenter&#x27;&lt;/span&gt;, &lt;span&gt;//承载子应用的容器&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;activeRule&lt;/span&gt;: &lt;span&gt;(&lt;span&gt;location&lt;/span&gt;)=&amp;gt;&lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; location.pathname.startsWith(&lt;span&gt;&#x27;/nav/normal&#x27;&lt;/span&gt;) &lt;span&gt;//渲染子应用的路由匹配&lt;/span&gt;&lt;br/&gt;        },&lt;br/&gt;        &lt;span&gt;props&lt;/span&gt;: { &lt;span&gt;//传递到子应用的组件或者参数等&lt;/span&gt;&lt;br/&gt;            PrivatePayment,&lt;br/&gt;            Test1&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;])&lt;br/&gt;&lt;br/&gt;start()&lt;br/&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;在主应用中需要创建一个容器路由页面这个也就是我们的场景入口，这里面渲染的就是我们的子应用&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; React, { useEffect } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { start } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;qiankun&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; RechargeCenterPage: React.FC&amp;lt;any&amp;gt; = &lt;span&gt;&lt;span&gt;props&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    useEffect(&lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;console&lt;/span&gt;.log(&lt;span&gt;&#x27;卸载&#x27;&lt;/span&gt;)&lt;br/&gt;        }&lt;br/&gt;    }, [])&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;webapp-qkrechargecenter&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;default&lt;/span&gt; RechargeCenterPage&lt;br/&gt; &lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里只会有针对微前端之间的交互进行改造，其他的配置就看大家自己的一个具体方案了&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * 重写 react-scripts 默认配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt; &lt;br/&gt;&lt;span&gt;const&lt;/span&gt; appPackageJson = &lt;span&gt;require&lt;/span&gt;(&lt;span&gt;&#x27;../package.json&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;&lt;span&gt;module&lt;/span&gt;.exports = &lt;span&gt;(&lt;span&gt;config, env&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;br/&gt;  config.output.library = &lt;span&gt;`&lt;span&gt;${appPackageJson.name}&lt;/span&gt;-[name]`&lt;/span&gt;&lt;br/&gt;  config.output.libraryTarget = &lt;span&gt;&#x27;umd&#x27;&lt;/span&gt;&lt;br/&gt;  config.output.jsonpFunction = &lt;span&gt;`webpackJsonp_&lt;span&gt;${appPackageJson.name}&lt;/span&gt;`&lt;/span&gt;,&lt;br/&gt;  &lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; config;&lt;br/&gt;};&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; ReactDOM &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&quot;react-dom&quot;&lt;/span&gt;;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; * &lt;span&gt;as&lt;/span&gt; React &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&quot;react&quot;&lt;/span&gt;;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; RouteComp &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&quot;./routes/routerList&quot;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;render&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; { container } = props;&lt;br/&gt;  ReactDOM.render(&lt;span&gt;&amp;lt;&lt;span&gt;RouteComp&lt;/span&gt; {&lt;span&gt;...props&lt;/span&gt;}/&amp;gt;&lt;/span&gt;, container ? container.querySelector(&lt;span&gt;&#x27;#root&#x27;&lt;/span&gt;) : &lt;span&gt;document&lt;/span&gt;.querySelector(&lt;span&gt;&#x27;#root&#x27;&lt;/span&gt;));&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;window&lt;/span&gt;.__POWERED_BY_QIANKUN__) {&lt;br/&gt;  render({});&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * bootstrap 只会在微应用初始化的时候调用一次，下次微应用重新进入时会直接调用 mount 钩子，不会再重复触发 bootstrap。&lt;br/&gt; * 通常我们可以在这里做一些全局变量的初始化，比如不会在 unmount 阶段被销毁的应用级别的缓存等。&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;bootstrap&lt;/span&gt;() &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(&lt;span&gt;&quot;react app bootstraped&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * 应用每次进入都会调用 mount 方法，通常我们在这里触发应用的渲染方法&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;mount&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  render(props);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * 应用每次 切出/卸载 会调用的方法，通常在这里我们会卸载微应用的应用实例&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;unmount&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  ReactDOM.unmountComponentAtNode(&lt;br/&gt;    props.container&lt;br/&gt;      ? props.container.querySelector(&lt;span&gt;&quot;#root&quot;&lt;/span&gt;)&lt;br/&gt;      : &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&quot;root&quot;&lt;/span&gt;)&lt;br/&gt;  );&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * 可选生命周期钩子，仅使用 loadMicroApp 方式加载微应用时生效&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;update&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(&lt;span&gt;&quot;update props&quot;&lt;/span&gt;, props);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里我是采用 react-router-config 直接渲染的路由如果大家有其他特殊配置可以自行配一下&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;import&lt;/span&gt; React &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { renderRoutes } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react-router-config&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { BrowserRouter &lt;span&gt;as&lt;/span&gt; Router } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react-router-dom&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; rechange &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;app/index/index&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; paymentRechargePrivateView &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;app/paymentRechargePrivateView&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; NoFound = &lt;span&gt;(&lt;span&gt;props&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;        NoFound&lt;br/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; routerList = [&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/recharge/center&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: rechange,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&#x27;充值中心&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/paymentRechargePrivateView&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: paymentRechargePrivateView,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&quot;充值中心个人消费收银台&quot;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: NoFound,&lt;br/&gt;    }&lt;br/&gt;]&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// 重点是basename需要匹配上主应用activeRule对应的路径&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; RouteComp = &lt;span&gt;(&lt;span&gt;props&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &lt;span&gt;&lt;span&gt;&amp;lt;&lt;span&gt;Router&lt;/span&gt; &lt;span&gt;basename&lt;/span&gt;=&lt;span&gt;{window.__POWERED_BY_QIANKUN__&lt;/span&gt; ? &#x27;/&lt;span&gt;nav&lt;/span&gt;/&lt;span&gt;normal&lt;/span&gt;&#x27; &lt;span&gt;:&lt;/span&gt; &#x27;/&#x27;}&amp;gt;&lt;/span&gt;&lt;br/&gt;    {renderRoutes(routerList, props)}&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;Router&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;default&lt;/span&gt; RouteComp&lt;br/&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;子应用配置跨域处理&lt;/span&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * config-overrides.js&lt;br/&gt; * 重写 react-scripts 默认配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; configDev = &lt;span&gt;require&lt;/span&gt;(&lt;span&gt;&quot;./config/webpack.config.dev&quot;&lt;/span&gt;);&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; configProd = &lt;span&gt;require&lt;/span&gt;(&lt;span&gt;&quot;./config/webpack.config.prod&quot;&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;&lt;span&gt;module&lt;/span&gt;.exports = {&lt;br/&gt;  &lt;span&gt;webpack&lt;/span&gt;: &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;override&lt;/span&gt;(&lt;span&gt;config, env&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;if&lt;/span&gt; (env == &lt;span&gt;&quot;development&quot;&lt;/span&gt;) {&lt;br/&gt;      &lt;span&gt;return&lt;/span&gt; configDev(config, env)&lt;br/&gt;    } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;      &lt;span&gt;return&lt;/span&gt; configProd(config, env)&lt;br/&gt;    }&lt;br/&gt;  },&lt;br/&gt;  &lt;span&gt;devServer&lt;/span&gt;: &lt;span&gt;(&lt;span&gt;configFunction&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; (&lt;span&gt;proxy, allowedHost&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; config = configFunction(proxy, allowedHost);&lt;br/&gt;      config.open = &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;      config.hot = &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;      config.headers = {&lt;br/&gt;        &lt;span&gt;&#x27;Access-Control-Allow-Origin&#x27;&lt;/span&gt;: &lt;span&gt;&#x27;*&#x27;&lt;/span&gt;, &lt;span&gt;//设置允许跨域&lt;/span&gt;&lt;br/&gt;      };&lt;br/&gt;      &lt;span&gt;return&lt;/span&gt; config;&lt;br/&gt;    };&lt;br/&gt;  },&lt;br/&gt;};&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;整体的思路都是按照这种方式去做拆分，中间遇到了很多的问题我们在下面分享一下，如果大家也有这种比较历史悠久的项目拆分那大概率也会遇到&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;实现目标过程中的遇到的比较&lt;code&gt;麻烦&lt;/code&gt;的问题&lt;/span&gt;&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4406392694063927&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELTrf5XsrY0NnWickfODiaAaRPdxiavr91SxRVdMd66CiaIE610RjtfPDjy2g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;876&quot;/&gt;&lt;figcaption&gt;image.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;拆分完成的子应用内部路由跳转一直找不到路径或者一直向主应用路由去跳&lt;/span&gt;&lt;/h3&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;出现问题的原因是我们之前老的路由name有一些自己的前缀规则&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;老的路由规则新的路由规则匹配的时候发生了异常，导致进行跳转的时候脱离了当前子应用的容器出现了跳转白屏&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;解决办法是针对子应用里面跳转的路径需要在主应用里面也配置一个对应的路由指向的是同一个容器页面，相当于重新加载了子应用容器这样不会在跳转的时候产生页面跳转错误导致白屏问题&lt;/p&gt;&lt;/blockquote&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;//主应用&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//引用同一个页面RechargeCenter&lt;/span&gt;&lt;br/&gt;&amp;lt;Route path=&lt;span&gt;&quot;/nav/normal/views/recharge/center&quot;&lt;/span&gt; component={RechargeCenter} /&amp;gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;Route&lt;/span&gt; &lt;span&gt;path&lt;/span&gt;=&lt;span&gt;&quot;/nav/normal/views/paymentRechargePrivateView&quot;&lt;/span&gt; &lt;span&gt;component&lt;/span&gt;=&lt;span&gt;{RechargeCenter}&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//子应用&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; routerList = [&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/recharge/center&#x27;&lt;/span&gt;, &lt;span&gt;//该路径在主应用中注册&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: rechange,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&#x27;充值中心&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/paymentRechargePrivateView&#x27;&lt;/span&gt;, &lt;span&gt;//该路径在主应用中注册&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: paymentRechargePrivateView,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&quot;充值中心个人消费收银台&quot;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: NoFound,&lt;br/&gt;    }&lt;br/&gt;]&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;子应用使用主应用传递下来的函数组件使用异常&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;异常图🔽&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.30017152658662094&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELTk1BPbxl6QqDphMfb5cYz0qxSDtREN6s27M5Qmy9JVbibWupSiaJAr42g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;2332&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意是只有函数组件传递到子应用中使用才有异常提示，类组件是没有的，原因是当前使用的地方和传递下来的组件不是同一个实例，hooks组件需要在同一个实例下&lt;/p&gt;&lt;/blockquote&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;pre&gt;&lt;code&gt;借助`webpack`的`externals`，去使用同一份react，同时改造子应用和主应用&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;//主应用&lt;/span&gt;&lt;br/&gt;&lt;span&gt;externals&lt;/span&gt;:{&lt;br/&gt;    &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;React&#x27;&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&#x27;react-dom&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;ReactDOM&#x27;&lt;/span&gt;,&lt;br/&gt;},&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;//子应用&lt;/span&gt;&lt;br/&gt;config.externals = {&lt;br/&gt;    &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;React&#x27;&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&#x27;react-dom&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;ReactDOM&#x27;&lt;/span&gt;,&lt;br/&gt;}&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;pre&gt;&lt;code&gt;在主应用的入口文件引入react的cdn链接注意尽量和本地用的是同一个版本，防止兼容问题&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;  &amp;lt;script src=&lt;span&gt;&quot;https://unpkg.com/react@16.13.1/umd/react.development.js&quot;&lt;/span&gt;&amp;gt;&amp;lt;&lt;span&gt;/script&amp;gt;&lt;br/&gt;  &amp;lt;script src=&quot;https://unpkg.com/&lt;/span&gt;react-dom@&lt;span&gt;16.13.1&lt;/span&gt;/umd/react-dom.development.js&lt;span&gt;&quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;结束&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上是我们项目拆分的整体思路和具体落实方案第一季，后面肯定还会遇到更多的问题，所以不出意外还有第二季和第三季..... 谁家还有特别大的项目可以按照这种思路参考一下，按照业务线或者是比较独立的模块去单独拆子应用&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;如果大家有更好的方案可以在评论区讨论一下~&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7597222222222222&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELTv5eJmRlzQibepS97bXY5Rgl8Oibtul1b1awUicibybPK4WR9OVl07voQFg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;720&quot;/&gt;&lt;figcaption&gt;lQDPJxaA_BWj4-nNA1bNBGWwP4d5S3bIu2cC1GUUMcB_AA_1125_854.jpg_720x720g.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;关于本文&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 data-v-a4949a24=&quot;&quot;&gt;&lt;span&gt;作者：零狐冲&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;https://juejin.cn/post/7121244973558661150&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2 data-id=&quot;heading-13&quot;&gt;最后&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;欢迎关注「&lt;/span&gt;&lt;span&gt;三分钟学前端&lt;/span&gt;&lt;span&gt;」&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile data-index=&quot;0&quot; data-id=&quot;Mzg2NjUxOTM2Mg==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/bwG40XYiaOKmTRcFWKB5pLtwz9auwyvjn6nhiaSydyGVuAfOfGmdpTBaqLJyLHVwDgXKNicS1VHhJSBADHCk2dib4Q/0?wx_fmt=png&quot; data-nickname=&quot;三分钟学前端&quot; data-alias=&quot;&quot; data-signature=&quot;每日三分钟，学习一个前端小 Tip！&quot; data-origin_num=&quot;145&quot; data-isban=&quot;0&quot; class=&quot;js_wx_tap_highlight&quot; data-from=&quot;2&quot; has-insert-preloading=&quot;1&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;号内回复：&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;「&lt;span&gt;网络&lt;/span&gt;」，自动获取三分钟学前端网络篇小书（90+页）&lt;/section&gt;&lt;section&gt;「&lt;span&gt;JS&lt;/span&gt;」，自动获取三分钟学前端 JS 篇小书（120+页）&lt;/section&gt;&lt;section&gt;「&lt;span&gt;算法&lt;/span&gt;」，自动获取 github 2.9k+ 的前端算法小书&lt;/section&gt;&lt;section&gt;「&lt;span&gt;面试&lt;/span&gt;」，自动获取 github 23.2k+ 的前端面试小书&lt;/section&gt;&lt;section&gt;「&lt;span&gt;简历&lt;/span&gt;」，自动获取程序员系列的 &lt;code&gt;120&lt;/code&gt; 套模版&lt;/section&gt;&lt;section&gt;&lt;a class=&quot;weapp_text_link&quot; data-miniprogram-appid=&quot;wx27c980b913cbfb08&quot; data-miniprogram-path=&quot;pages/index/index&quot; data-miniprogram-nickname=&quot;高级前端面试&quot; data-miniprogram-type=&quot;text&quot; data-miniprogram-servicetype=&quot;0&quot; wah-hotarea=&quot;click&quot; href=&quot;&quot;&gt;》》面试官也在看的前端面试资料《《&lt;/a&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;span&gt;“在看和转发”&lt;/span&gt;&lt;span&gt;就是最大的支持&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3fe39475bcc40cfc6eafce9ba2e0a6f3</guid>
<title>手把手教你用eNSP模拟器配置防火墙源NAT</title>
<link>https://toutiao.io/k/k4tdksx</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;&lt;section data-mpa-category=&quot;背景&quot; data-mpa-template=&quot;t&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-paragraph-type=&quot;ignored&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-paragraph-type=&quot;ignored&quot;&gt;&lt;p&gt;&lt;span&gt;点击上方&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;网工进阶之路&lt;/span&gt;&lt;span&gt;，&lt;/span&gt;&lt;span&gt;选择&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;span&gt;设为星标&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;优质文章，及时送达&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.43581445523193096&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/jTZc8FxPKxSXK06vHeN8bic3OEa3leaBGdJR9LSib4CA0PaES0Nia79ic9FaAwicOCuStU5iaUwNhiciaq66nxZ20szbmw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1854&quot;/&gt;&lt;/p&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;99638&quot;&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Part1&lt;/span&gt;&lt;span&gt;需求说明&lt;/span&gt;&lt;/h1&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mpa-category=&quot;背景&quot; data-mpa-template=&quot;t&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4868255959849435&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGo5NKwgiavfaOq3QoNXG0YIaADNgkxTTvq9KazNf2iaIAahmNkmJFsLEZg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;797&quot;/&gt;&lt;/figure&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;配置PC1和PC2的IP地址&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;设置防火墙GE1/0/0和GE1/0/1的IP地址&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;将接口加入防火墙安全区域&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;配置域间包过滤策略&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;配置NAT地址池，公网地址范围2.2.2.2-2.2.2.5&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;配置NAT policy&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;验证结果，从PC1 ping PC2地址，使用display firewall session table命令查看NAT转换情况。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Part2&lt;/span&gt;&lt;span&gt;配置过程&lt;/span&gt;&lt;/h1&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span&gt;配置PC1和PC2的IP地址&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;根据拓扑图，PC1配置如下IP地址、掩码、网关，配置完后记得点击应用：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6895213454075032&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoA4As6BJCqoaZg2zYLQ9hNWLk6GzdkE7xXeGJDFqgLgS8iaVfbOBJBhQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;773&quot;/&gt;根据拓扑图，PC2配置如下IP地址、掩码、网关，配置完后记得点击应用：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6850899742930592&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGowS6dgKCZ1LT0h8HibFdZqXdomX2FUKsZw9EUEGXibnTmiaOqKl5Tpz2OQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;778&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;2&lt;/span&gt;&lt;/span&gt;&lt;span&gt;设置防火墙GE1/0/0和GE1/0/1的IP地址&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;首次登陆，防火墙默认账号为&lt;code&gt;admin&lt;/code&gt;，密码为&lt;code&gt;Admin@123&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5464015151515151&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoPP84K31F6PCgzCv5EEatvmINuQwGEcwcBUpFPjtLNavfz4BnSVUhOg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1056&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;进行设置防火墙的接口IP地址：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;[USG6000V1]int g1/0/0&lt;br/&gt;&lt;br/&gt;[USG6000V1-GigabitEthernet1/0/0]ip add 192.168.1.1 24&lt;br/&gt;&lt;br/&gt;[USG6000V1-GigabitEthernet1/0/0]ip binding vpn-instance default&lt;br/&gt;&lt;br/&gt;[USG6000V1-GigabitEthernet1/0/0]qu&lt;br/&gt;&lt;br/&gt;[USG6000V1]&lt;br/&gt;&lt;br/&gt;[USG6000V1]int g0/0/0&lt;br/&gt;&lt;br/&gt;[USG6000V1-GigabitEthernet0/0/0]ip add 2.2.2.1 24&lt;br/&gt;&lt;br/&gt;[USG6000V1-GigabitEthernet0/0/0]qu&lt;br/&gt;&lt;br/&gt;[USG6000V1]&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;3&lt;/span&gt;&lt;/span&gt;&lt;span&gt;将接口加入防火墙安全区域&lt;/span&gt;&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;[USG6000V1]firewall zone trust  &lt;br/&gt;&lt;br/&gt;[USG6000V1-zone-trust]add interface GigabitEthernet 1/0/0&lt;br/&gt;&lt;br/&gt;[USG6000V1-zone-trust]add interface GigabitEthernet 0/0/0&lt;br/&gt;&lt;br/&gt;[USG6000V1-zone-trust]&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;4&lt;/span&gt;&lt;/span&gt;&lt;span&gt;配置域间包过滤策略&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;配置策略如下：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;[USG6000V1]security-policy &lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-security]rule name policy-permit01&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-security-rule-policy-permit01]&lt;span&gt;source&lt;/span&gt;-address 192.168.1.0 24&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-security-rule-policy-permit01]destination-address 2.2.2.0 24&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-security-rule-policy-permit01]action permit&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-security-rule-policy-permit01]quit&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-security]quit&lt;br/&gt;&lt;br/&gt;[USG6000V1]&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;5&lt;/span&gt;&lt;/span&gt;&lt;span&gt;配置NAT地址池，公网地址范围2.2.2.2-2.2.2.5&lt;/span&gt;&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;[USG6000V1]nat address-group add-group01&lt;br/&gt;&lt;br/&gt;[USG6000V1-address-group-add-group01]section 0 2.2.2.2 2.2.2.5&lt;br/&gt;&lt;br/&gt;[USG6000V1-address-group-add-group01]mode pat&lt;br/&gt;&lt;br/&gt;[USG6000V1-address-group-add-group01]qu&lt;br/&gt;&lt;br/&gt;[USG6000V1]&lt;br/&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;6&lt;/span&gt;&lt;/span&gt;&lt;span&gt;配置NAT policy&lt;/span&gt;&lt;/h2&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;[USG6000V1]nat-policy &lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-nat]rule name nat-policy01&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-nat-rule-nat-policy01]&lt;span&gt;source&lt;/span&gt;-address 192.168.1.0 24&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-nat-rule-nat-policy01]destination-address 2.2.2.0 24&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-nat-rule-nat-policy01]action &lt;span&gt;source&lt;/span&gt;-nat  address-group add-group01&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-nat-rule-nat-policy01]quit&lt;br/&gt;&lt;br/&gt;[USG6000V1-policy-nat]quit&lt;br/&gt;&lt;br/&gt;[USG6000V1]&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;7&lt;/span&gt;&lt;/span&gt;&lt;span&gt;验证结果&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从PC1 ping PC2地址，使用display firewall session table命令查看NAT转换情况。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7105691056910569&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoJiaiaJyibVM6sicDKySGwMtKb4rMeuKIicQGZ66AQEx5G3nhH3ZTgxs9FMg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;615&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.35&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGovlH3xfkc9j6c5FyKX9tibVicXadcrzslfaI5AkdDsSm72sToNuZTeoiaQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上图，我们可以看到192.168.1.10这个源IP地址被替换成2.2.2.4这个IP了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接下来，我们也可以在PC1和PC2接口上抓包，观察他们的源IP地址是否有变化：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5068181818181818&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoibearT5d0NVibibIYcZ2wsysTuGDPibq2ge29ee6gOKziaR3xM3et7J9J6w/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;880&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.34444444444444444&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoUS8NSanz0xtx2ThdDqLwoVTy0zwlWV6SE4iaicTnoho6KCbxuW9wKucA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.36666666666666664&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoleh8UrXQ4rJ8gqfzniahUDDDsBQ0Y3eSmCHkD8icgPhPRRupBNFhGxFg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.13796296296296295&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGoAmvE446zAucNgbW1Z13T3EjRV5oYLMu1jHutcsgT5sfLvfvUVdBxEQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.12685185185185185&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1cZiaCeD3MkSPztM0J1sgvcRrVdjWkLGo3FMuIwMfMhPYBCoDj9MKdkpMbPF3vgvicovbNiaocibVDHhhBk7veq5Gg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过上图，小白们应该能对NAT源地址转换有个更清晰的认识了吧！&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;---END---&lt;/strong&gt;&lt;/p&gt;&lt;section data-mpa-category=&quot;背景&quot; data-mpa-template=&quot;t&quot;&gt;&lt;section&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;94063&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;感谢大家的阅读，如果本文有收获，也请给一个 &lt;strong&gt;点赞 + 在看&lt;/strong&gt; 支持，谢谢大家。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;欢迎加入 &lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzIwOTcyNjA3Mw==&amp;amp;mid=2247509162&amp;amp;idx=1&amp;amp;sn=733c0649ce02903a422e422ec8b7a0db&amp;amp;chksm=976d9bbca01a12aad77fa02476ade2cf4016f90675966fa332cf3325f042a9222ca5e51616b7&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;网工资源导航知识星球&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;网工资源导航知识星球&lt;/a&gt;（点击了解详情），和100 多名小伙伴们一起交流学习网络技术，共享星球&lt;span&gt;内的 全部资源（&lt;/span&gt;&lt;span&gt;各种视频教程、电子书源文件、网工资料等）、&lt;/span&gt;&lt;span&gt;参与打卡等&lt;/span&gt;&lt;span&gt;。&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;关注公众号&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;网工进阶之路 &lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;后台回复&lt;/span&gt;&lt;span&gt;&lt;span&gt;合集 &lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;获取网络技术合集PDF版本&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-id=&quot;Mzg4MzY5NTgwOA==&quot; data-pluginname=&quot;mpprofile&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/jTZc8FxPKxTsCDAau0fMJZgIkTPYf0oBic2cfKREqlww6xMhAPHasuoHvn6G3LfB39Rrd04eFgT1ZtFpUtlZbbQ/0?wx_fmt=png&quot; data-nickname=&quot;网工进阶之路&quot; data-alias=&quot;&quot; data-signature=&quot;计算机网络基础、数通路由交换、网络安全、Linux、python自动化运维等方向&quot; data-from=&quot;2&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;重磅！网工进阶之路-技术交流群已成立&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;后台回复 &lt;strong&gt;加群 &lt;/strong&gt;可添加小编微信，&lt;strong&gt;申请进&lt;/strong&gt;&lt;strong&gt;群。&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;一定要备注：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;工种+地点+学校/公司+昵称&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;（如网络工程师+南京+苏宁+猪八戒）&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，根据格式备注，可更快被通过且邀请进群&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;

          

          
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>54fdd939842a81c4f06c9d2bb9ec9289</guid>
<title>扩散模型背后数学太难了，啃不动？谷歌用统一视角讲明白了</title>
<link>https://toutiao.io/k/odb6dq6</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;profile_inner&quot;&gt;
                  &lt;strong class=&quot;profile_nickname&quot;&gt;机器之心&lt;/strong&gt;
                  &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;/&gt;

                  &lt;p class=&quot;profile_meta&quot;&gt;
                  &lt;label class=&quot;profile_meta_label&quot;&gt;Weixin ID&lt;/label&gt;
                  &lt;span class=&quot;profile_meta_value&quot;&gt;almosthuman2014&lt;/span&gt;
                  &lt;/p&gt;

                  &lt;p class=&quot;profile_meta&quot;&gt;
                  &lt;label class=&quot;profile_meta_label&quot;&gt;About Feature&lt;/label&gt;
                  &lt;span class=&quot;profile_meta_value&quot;&gt;专业的人工智能媒体和产业服务平台&lt;/span&gt;
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>9243db5234b430e5d05ea15a1dffc0ef</guid>
<title>如何快速把你的 Python 代码变为 API</title>
<link>https://toutiao.io/k/88kznci</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;&lt;section data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section&gt;提到 API 开发，你可能会想到 Django REST Framework，Flask，FastAPI，没错，它们完全可以用来编写 API，不过，今天分享的这个框架可以让你更快把现有的函数转化为 API，它就是 Sanic。&lt;/section&gt;&lt;h2&gt;&lt;span&gt;# &lt;/span&gt;&lt;span&gt;Sanic 简介&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;Sanic[1]，是 Python3.7+ Web 服务器和 Web 框架，旨在提高性能。它允许使用 Python3.5 中添加的 async/await 语法，这可以有效避免阻塞从而达到提升响应速度的目的。Sanic致力于提供一种简单且快速，集创建和启动于一体的方法，来实现一个易于修改和拓展的 HTTP 服务，Sanic 具备开箱即用的功能，它可以用于编写，部署和扩展生产级 Web 应用程序。目前 Github 有 16.3k 的星，有广泛的社区支持。&lt;/p&gt;&lt;p&gt;有以下特性：&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;内置极速 web server&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;生产准备就绪&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;极高的拓展性&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;支持 ASGI&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;简单直观的 API 设计&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;社区保障&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;&lt;span&gt;# &lt;/span&gt;&lt;span&gt;如何将现有代码快速转化为 API&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;现在让我们看，如何将代码转为 API，假如有已经在 functions.py 写好的两个函数：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;import&lt;/span&gt; datetime&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;get_datetime&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; datetime.datetime.now().strftime(&lt;span&gt;&quot;%Y-%m-%d %H:%M:%S&quot;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;sum_x_y&lt;/span&gt;&lt;span&gt;(x, y)&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; x + y&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;转化为 API 只需再编写一个 sanic_app.py :&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;from&lt;/span&gt; sanic &lt;span&gt;import&lt;/span&gt; Sanic, json&lt;br/&gt;&lt;span&gt;from&lt;/span&gt; functions &lt;span&gt;import&lt;/span&gt; get_datetime, sum_x_y&lt;br/&gt;&lt;br/&gt;app = Sanic(&lt;span&gt;&quot;CodeToAPI&quot;&lt;/span&gt;)&lt;br/&gt;HOST = &lt;span&gt;&quot;localhost&quot;&lt;/span&gt;&lt;br/&gt;PORT = &lt;span&gt;8000&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;@app.route(&quot;/getdatetime&quot;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;getdatetime&lt;/span&gt;&lt;span&gt;(request)&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; json({&lt;span&gt;&quot;now&quot;&lt;/span&gt;: get_datetime()})&lt;br/&gt;&lt;br/&gt;&lt;span&gt;@app.get(&#x27;/sumxy&#x27;)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;def&lt;/span&gt; &lt;span&gt;sumxy&lt;/span&gt;&lt;span&gt;(request)&lt;/span&gt;:&lt;/span&gt;&lt;br/&gt;    parameters = request.args&lt;br/&gt;    result = sum_x_y(int(parameters[&lt;span&gt;&#x27;x&#x27;&lt;/span&gt;][&lt;span&gt;0&lt;/span&gt;]), int(parameters[&lt;span&gt;&#x27;y&#x27;&lt;/span&gt;][&lt;span&gt;0&lt;/span&gt;]))&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; json({&lt;span&gt;&#x27;result&#x27;&lt;/span&gt;: result})&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;if&lt;/span&gt; __name__ == &lt;span&gt;&quot;__main__&quot;&lt;/span&gt;:&lt;br/&gt;    app.run(host=HOST, port=PORT, debug=&lt;span&gt;False&lt;/span&gt;)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后，只需要执行 python sanic_app.py 就可以启动 API 服务：&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.44074074074074077&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/EnE7vpEWFnq95icLWWdwnjSB01W0CAE2RwG0lpLqVIlSystRGatG0Zw6XeBEJ3eykUMgQm4ORgRq8MZv6vTgtIA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-w=&quot;1080&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;从运行结果可以得知，sanic 已经运行在生产环境模式，这与其他 Web 框架不同，其他框架带有一个内置的开发服务器，并明确表示它只用于开发。而 Sanic 的情况恰好相反，内置的服务器可以直接用于生产环境。&lt;/p&gt;&lt;p&gt;可以用 curl 进行接口测试：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;❯ curl &lt;span&gt;&quot;http://localhost:8000/getdatetime&quot;&lt;/span&gt;&lt;br/&gt;{&lt;span&gt;&quot;now&quot;&lt;/span&gt;:&lt;span&gt;&quot;2022-07-25 06:34:25&quot;&lt;/span&gt;}%                                                  ❯ curl &lt;span&gt;&quot;http://localhost:8000/sumxy?x=12&amp;amp;y=34&quot;&lt;/span&gt;&lt;br/&gt;{&lt;span&gt;&quot;result&quot;&lt;/span&gt;:46}%&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;如果用 post，且使用 json 传参，也是简单的：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;@app.post(&lt;span&gt;&#x27;/sumxy&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;&lt;span&gt;async&lt;/span&gt; def &lt;span&gt;sumxy&lt;/span&gt;(&lt;span&gt;request&lt;/span&gt;):&lt;br/&gt;    parameters &lt;/span&gt;= request.&lt;span&gt;json&lt;br/&gt;    &lt;span&gt;print&lt;/span&gt;(&lt;span&gt;parameters&lt;/span&gt;)&lt;br/&gt;    result &lt;/span&gt;= sum_x_y(&lt;span&gt;int&lt;/span&gt;(parameters[&lt;span&gt;&#x27;x&#x27;&lt;/span&gt;]), &lt;span&gt;int&lt;/span&gt;(parameters[&lt;span&gt;&#x27;y&#x27;&lt;/span&gt;]))&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; json({&lt;span&gt;&#x27;result&#x27;&lt;/span&gt;: result})&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;curl 这样测试：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;❯ curl -X &lt;span&gt;&#x27;POST&#x27;&lt;/span&gt; &lt;span&gt;&#x27;http://localhost:8000/sumxy&#x27;&lt;/span&gt; -H &lt;span&gt;&quot;Content-Type: application/json&quot;&lt;/span&gt; -d &lt;span&gt;&#x27;{&quot;x&quot;:10,&quot;y&quot;:20}&#x27;&lt;/span&gt;&lt;br/&gt;{&lt;span&gt;&quot;result&quot;&lt;/span&gt;:30}%&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;&lt;span&gt;# &lt;/span&gt;&lt;span&gt;部署在其他&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;Sanic 除了自带的服务器（大多数情况推荐自带的服务器用于生产），同样兼容 ASGI。这意味着您可以使用你喜欢的 ASGI 服务器来运行 Sanic。现在有三大主流的 ASGI 服务器， Daphne、&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzU0OTg3NzU2NA==&amp;amp;mid=2247484552&amp;amp;idx=1&amp;amp;sn=614693063d2eea248e03b7683c880128&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;Uvicorn&lt;/a&gt; (FastAPI 用的就是这个）、Hypercorn。&lt;/p&gt;&lt;p&gt;也可以部署在 Gunicorn：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;&lt;span&gt;gunicorn&lt;/span&gt; &lt;span&gt;myapp&lt;/span&gt;&lt;span&gt;:app&lt;/span&gt; &lt;span&gt;--bind&lt;/span&gt; 0&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;:1337&lt;/span&gt; &lt;span&gt;--worker-class&lt;/span&gt; &lt;span&gt;sanic&lt;/span&gt;&lt;span&gt;.worker&lt;/span&gt;&lt;span&gt;.GunicornWorker&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;静态文件的处理，及记录请求访问日志，又想获得更好的性能，可以考虑使用 Nginx 作为代理，让 Nginx 来处理访问日志和静态文件，这种方式要比用 Python 处理快得多得多。&lt;/p&gt;&lt;h2&gt;&lt;span&gt;# &lt;/span&gt;&lt;span&gt;最后的话&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;本文分享了下一代的 Python Web 框架 Sanic，直接支持异步，且内置生产级别的 Web 服务器，可以说是编写 API 相当快的工具了，如果有帮助，还请点赞、在看、转发&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-copyright=&quot;0&quot; data-ratio=&quot;0.07625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/WLXa0NsmXuiap5yprf7DJXhpdhC0XIBAopbpFTUe1eSSuGbT5Kg63CPBicfpxwLAFIm2wPkicB5NWdSicbzziaibPXSA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;800&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;Mzg5OTU3NjczMQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/l7Q86F4y59slsYFabiaMvsUqjfaiaYpna1x1A7kSMayLARTdwoGSWVSHYSYczYQRhhdbNv9vlHXDnlab2GtrYKLw/0?wx_fmt=png&quot; data-nickname=&quot;早起Python&quot; data-alias=&quot;Zaoqi_Python&quot; data-signature=&quot;点击领取pandas数据分析300题&quot; data-from=&quot;0&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;/div&gt;

          

          
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>25d5e8e74fde99c1251687d1857227c7</guid>
<title>什么是顶级的思维？</title>
<link>https://toutiao.io/k/ulqvlcd</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;&lt;p data-first-child=&quot;&quot; data-pid=&quot;m8v6gniB&quot;&gt;分享几个非常适合职场人的顶级思维&lt;/p&gt;&lt;p data-pid=&quot;Hqu0GVua&quot;&gt;&lt;strong&gt;1、麦肯锡七步成诗：解决问题的7个步骤&lt;/strong&gt;&lt;/p&gt;&lt;p data-pid=&quot;9ZCkEKV3&quot;&gt;ProcessOn模板社区-麦肯锡解决问题的七个步骤&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.836111111111111&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ysfza24cADtY5Wf2P8EkX4IPzpwPqD7V0ibDlsnwgqRISTeSCAADOl652AhbIyd93GvZRnowCTC1juiaPUcZ8rdA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;720&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;2、SWOT分析法：基于竞争环境和竞争条件的态势分析&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8694444444444445&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ysfza24cADtY5Wf2P8EkX4IPzpwPqD7VTcfkwvwXe4Qb7UesmFfjzCtVZDBCDfO1qNFSh2Fz73hOCOBrskiaDbw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;720&quot;/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;3、TWOS分析法：基于SWOT的战略制定&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.49027777777777776&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ysfza24cADtY5Wf2P8EkX4IPzpwPqD7VBC7DcPiaEKQCjkSic1Xc8fXJOKfdFDNVfPV2e1GyickzQ6yYBzibribNjfA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;720&quot;/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;4、PEST分析模型：宏观环境分析&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6430555555555556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ysfza24cADtY5Wf2P8EkX4IPzpwPqD7V4C5u3FEUgHN9W4ZsSic1vecVNsBg8wHz3zlfbNk3Uo3Q2X6K4ibWDTCg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;720&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;

          

          
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>