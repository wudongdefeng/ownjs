<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>bd26d1732fcf2620f7f462c3574d0e01</guid>
<title>线程数，512是否合理？</title>
<link>https://toutiao.io/k/r06r6ur</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;profile_inner&quot;&gt;
                  &lt;strong class=&quot;profile_nickname&quot;&gt;架构师之路&lt;/strong&gt;
                  &lt;img class=&quot;profile_avatar&quot; id=&quot;js_profile_qrcode_img&quot; src=&quot;&quot; alt=&quot;&quot;/&gt;

                  &lt;p class=&quot;profile_meta&quot;&gt;
                  &lt;label class=&quot;profile_meta_label&quot;&gt;Weixin ID&lt;/label&gt;
                  &lt;span class=&quot;profile_meta_value&quot;&gt;road5858&lt;/span&gt;
                  &lt;/p&gt;

                  &lt;p class=&quot;profile_meta&quot;&gt;
                  &lt;label class=&quot;profile_meta_label&quot;&gt;About Feature&lt;/label&gt;
                  &lt;span class=&quot;profile_meta_value&quot;&gt;架构师之路，坚持撰写接地气的架构文章&lt;/span&gt;
                  &lt;/p&gt;
                &lt;/div&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>4ea076563f056605dcd7c5f861525530</guid>
<title>日志的艺术</title>
<link>https://toutiao.io/k/rw81b80</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;&lt;em&gt;良好的日志是运维、开发人员排查问题的好工具，本文建议定义JSON格式的结构化日志格式，从而有效优化人工以及机器排查日志的效能，并能方便创建机器索引。原文: &lt;span&gt;The Art of Logging&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6642512077294686&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0W84B5AtJtbCAHibVicetDfXlQsZ4TOYxwqeo1yTN5GKibVcCicq3nqypFwGSquqCicFDK7XzqXFrmGZTA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;828&quot;/&gt;&lt;figcaption&gt;Viktor Talashuk@Unsplash&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从历史上看，日志对于诊断应用程序和基础设施性能非常重要，被广泛应用于业务仪表板的可视化和性能分析。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对日志文件中的数据进行结构化，以便能够有效提取、操作和分析数据(除了便于人类理解，也便于机器分析)的重要性正在迅速上升。此外，微服务的兴起也带来了另一个挑战，即怎样在整个系统中跟踪请求的传播。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文将介绍便于人和机器解析、理解的日志结构的最佳格式，特别是跟用户登录有关的关键信息及数据结构的建议，并将尝试提供一些重要的注意事项。&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;为什么日志应该是人类可读的?&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;尽管日志最初是由机器来解析、处理和存储的，但现在正越来越多的由人类来读取、理解和诊断。日志是我们调查凶杀现场的最佳指标，而凶手正是我们的死敌: Bug!🐛&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6666666666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0W84B5AtJtbCAHibVicetDfXl4j24ia6icZAzynXdxtAVeIODraicibmRwfnz5H8CS54OvFmpbrch3gXBvQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;828&quot;/&gt;&lt;figcaption&gt;Elsa Ventur@Unsplash&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;没什么比试图理解冗长而且非结构化的日志线中丢失的信息更令人沮丧和耗时的了。日志必须有有意义，并且人们应该可以很容易理解和深入挖掘与他们有关的内容。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;66.249.65.159 - - [06/Nov/2014:19:10:38 +0000] &lt;span&gt;&quot;GET /news/53f8d72920ba2744fe873ebc.html HTTP/1.1&quot;&lt;/span&gt; 404 177 &lt;span&gt;&quot;-&quot;&lt;/span&gt; &lt;span&gt;&quot;Debian APT-HTTP/1.3 (0.8.16~exp12ubuntu10.16)&quot;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;尽管我们已经习惯了默认的Nginx格式，但上面的示例仍然很难阅读和处理。例如，这是为了再现生产bug而提取的巨大日志文件的一部分，很难理解其背后含义是什么。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;JSON相对于其他数据交换格式(如XML)的优势非常明显，这是一种在数组中有序嵌套的键值对的简单语法，对人类来说很容易读、写和理解。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么，用JSON编写的日志消息是什么样子的呢？以下是与之前相同的JSON格式的Nginx web服务器日志示例:&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;{&lt;br/&gt;&lt;span&gt;&quot;time&quot;&lt;/span&gt;: &lt;span&gt;&quot;06/May/2022:19:10:38 +0100&quot;&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;remote_ip&quot;&lt;/span&gt;: &lt;span&gt;&quot;66.249.65.159&quot;&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;remote_user&quot;&lt;/span&gt;: &lt;span&gt;&quot;-&quot;&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;request&quot;&lt;/span&gt;: &lt;span&gt;&quot;GET /news/53f8d72920ba2744fe873ebc.html HTTP/1.1&quot;&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;response&quot;&lt;/span&gt;: &lt;span&gt;404&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;bytes&quot;&lt;/span&gt;: &lt;span&gt;177&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;referrer&quot;&lt;/span&gt;: &lt;span&gt;&quot;-&quot;&lt;/span&gt;,&lt;br/&gt;&lt;span&gt;&quot;agent&quot;&lt;/span&gt;: &lt;span&gt;&quot;Debian APT-HTTP/1.3 (0.8.16~exp12ubuntu10.16)&quot;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;为什么日志应该是对机器友好的?&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;再次考虑上面的日志线示例:&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;66.249.65.159 - - [06/Nov/2014:19:10:38 +0000] &lt;span&gt;&quot;GET /news/53f8d72920ba2744fe873ebc.html HTTP/1.1&quot;&lt;/span&gt; 404 177 &lt;span&gt;&quot;-&quot;&lt;/span&gt; &lt;span&gt;&quot;Debian APT-HTTP/1.3 (0.8.16~exp12ubuntu10.16)&quot;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了理解，我们需要:&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不幸的是，这种逻辑很脆弱，如果日志格式发生了更改(比如开发人员添加了一个新字段或更改了字段顺序)，那么解析器就会崩溃，相信任何人都有面对或经历类似问题的时候。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;而这就是像JSON这样的结构化格式可以提供帮助的地方。键值对使提取特定值和跨数据集筛选和搜索变得容易，如果添加了新的键值对，解析日志消息的软件将只是忽略那些非期望的键，而不会完全失效。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6666666666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0W84B5AtJtbCAHibVicetDfXlHibM9K2xWsxOuSbMpOqDoIjTltyJzvj3muCm45iaibnyfFfKTG5hibYVOA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;828&quot;/&gt;&lt;figcaption&gt;Alex Knight@Unsplash&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在机器上使用JSON日志的好处是:&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;具有结构化的格式，因此便于分析日志和查询每个字段。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;每种编程语言都可以对其进行解析。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通常，我们可以在日志解析系统(ELK、newRelic、Datadog等)中聚合JSON数据，从而为我们提供强大的报告、搜索和对数据的洞察能力。这些工具使索引某些字段变得更容易，从而解决在微服务环境下跟踪请求的问题。&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;应该包含哪些信息?&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里列举了应该包含在日志中的信息列表，有些元素是可选的，字段名前面的(o)表示可选字段。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;message &amp;lt;string&amp;gt;&lt;/code&gt;: 用于描述情况的人类可读的信息，在过滤时易于阅读，以获得对内容的概述。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;level &amp;lt;integer&amp;gt;&lt;/code&gt;: 优先级级别的数值表示(下一节将详细介绍)，对于将消息按不同优先级排序或生成包含系统概述的仪表板非常有用。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;level_name &amp;lt;string&amp;gt;&lt;/code&gt;: 优先级级别的字符串表示(更多细节将在下一节中介绍)。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;datetime_iso &amp;lt;DateTime&amp;gt;&lt;/code&gt;: &lt;span&gt;iso8601格式&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;的日期，因为我们需要将时间与其他事件相关联，因此是必填项。尽管可以使用服务器的日期-时间，但可能会产生误导，因为服务器的时间可能并不一致，甚至可能位于不同的时区。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;correlation_id &amp;lt;string(uuidv4)&amp;gt;&lt;/code&gt;: 这是微服务环境的一个重要字段，我们将基于解析后的消息/请求的correlation id来跟踪服务之间整个链路的请求。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;hostname &amp;lt;string&amp;gt;&lt;/code&gt;: 用于确定是哪台机器生成了此日志，建议在微服务环境中使用。当服务器日志已经从docker的服务名映射到原始主机时，可能是多余的。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;build_id &amp;lt;string&amp;gt;&lt;/code&gt;: 记录信息的软件版本，可以帮助跟踪不兼容问题，特别是那些在服务器端软件部署期间发生的问题。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;application&amp;lt;string&amp;gt;&lt;/code&gt;: 用于识别哪个设备或应用程序生成了此日志。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;owner_id &amp;lt;string(uuidv4)/null&amp;gt;&lt;/code&gt;: 报告用户id或API key id(如果有的话)，可以追踪用户执行了哪些步骤来再现他的操作。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;tenant_id &amp;lt;string(uuidv4)/null&amp;gt;&lt;/code&gt;: 报告可用的租户id，对于多租户系统非常有用。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;tags &amp;lt;string[]&amp;gt;&lt;/code&gt;: 可以是一个元素数组，包含关于请求的元信息，如类型、使用的协议等。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;stacktrace: &amp;lt;string/null&amp;gt;&lt;/code&gt;: 有stack trace时以字符串格式显示stack trace。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;(o)&lt;code&gt;exception: &amp;lt;string/null&amp;gt;&lt;/code&gt;: 有异常消息时显示异常消息。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;日志级别和相关日志码&lt;/h5&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;日志级别&lt;/th&gt;&lt;th&gt;日志码&lt;/th&gt;&lt;th&gt;描述&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;Debug&lt;/td&gt;&lt;td&gt;100&lt;/td&gt;&lt;td&gt;详细的调试信息。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Info&lt;/td&gt;&lt;td&gt;200&lt;/td&gt;&lt;td&gt;感兴趣的事件。例如: 用户登录或SQL日志。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Notice&lt;/td&gt;&lt;td&gt;250&lt;/td&gt;&lt;td&gt;正常但重要的事件。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Warning&lt;/td&gt;&lt;td&gt;300&lt;/td&gt;&lt;td&gt;不是错误的异常事件。示例: 使用已弃用的API; API使用不当。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Error&lt;/td&gt;&lt;td&gt;400&lt;/td&gt;&lt;td&gt;不需要立即处理的运行时错误，但通常应该记录和监控。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Critical&lt;/td&gt;&lt;td&gt;500&lt;/td&gt;&lt;td&gt;严重事件。示例: 应用组件不可用; 意想不到的异常。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Alert&lt;/td&gt;&lt;td&gt;550&lt;/td&gt;&lt;td&gt;必须立即采取行动。例如: 整个网站瘫痪。应该会触发SMS告警。&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Emergency&lt;/td&gt;&lt;td&gt;600&lt;/td&gt;&lt;td&gt;紧急情况: 系统不可用。&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;建议格式&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那么，用JSON编写的日志消息是什么样的呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以下是示例建议的日志概念格式:&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6304347826086957&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0W84B5AtJtbCAHibVicetDfXlKbwFUkzXWh46ZiaApR32CqlhHicqFTKYzevNVkEJ56vypTdVIjyUicDcA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;828&quot;/&gt;&lt;figcaption&gt;使用carbon生成的示例消息&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;观察&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;在日志服务器中，应该为以下元素建立索引，以便更快搜索: &lt;code&gt;owner_id&lt;/code&gt;、&lt;code&gt;tenant_id&lt;/code&gt;、&lt;code&gt;correlation_id&lt;/code&gt;、&lt;code&gt;level&lt;/code&gt;、&lt;code&gt;level_name&lt;/code&gt;和&lt;code&gt;application&lt;/code&gt;。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;当可选字段可用时，应该添加到日志中，只能在没有的时候将其忽略，而在调试系统时，它们的值将是可见的。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;context元素可以包含其他有用的字段(比如传入请求的打印)。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;出于安全性或合规性原因(个人信息保护)，日志应该对请求中可能出现的关键字段(比如密码)设置一些过滤器，以便在输出内容之前匿名化。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;每个服务都应该转发收到的&lt;code&gt;correlation_id&lt;/code&gt;，如果这个值不存在，应该生成一个新值并将其传递给下一个服务。API网关(如果有的话)应该始终关注该字段是否存在、是否需要生成。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;最佳实践&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;花时间设计日志结构，使格式满足我们的需要，并且可以很容易复制。然而，有些团队可能需要不同的版本，还要考虑适合需求的粒度级别。通常，公司内部的&quot;日志概念&quot;文档可以让所有团队遵循同一种模式，并且有新的开发人员加入时会非常有用。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;尽可能多的记录日志。在发生致命异常时知道模块和行号，或者在遇到安全漏洞时知道IP/用户名，对于更快、更准确解决问题是非常宝贵的。如果想避免一些不必要的噪音，仍然可以调整级别，通过经验可以知道什么级别最适合当前项目！&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;保持一致性是每个人的首要任务。JSON消息中适当的键和准确的值使调试更容易、更有效。Correlation Id和日志级别可以明确证明这一点。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;编写代码的同时记录日志，像编写单元测试一样，尝试保持相同的风格并记录系统交互。为了避免丢失函数的上下文和边缘情况，当场完成比稍后添加更容易。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;最后&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;本文不是要推动标准，而是要尝试创建一种逻辑化组织的日志格式，以优化如newRelic或ELK等日志解析系统。这一格式将帮助我们生成有用的仪表板、指标和事件通知(例如，在错误百分比超过5%时触发警报)。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;在应用程序中实现标准化日志系统将花费一定的时间和金钱，调试也需要付出代价，特别是有关关键边界条件信息的情况下。在做出决定的时候应该权衡考虑。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;日志记录是一个公说公有理、婆说婆有理的话题，有时还会引起分歧。但是，无论使用哪种格式，总是比完全不用日志要好。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;建议使用异步日志记录来避免性能问题。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;em&gt;你好，我是俞凡，在Motorola做过研发，现在在Mavenir做技术工作，对通信、网络、后端架构、云原生、DevOps、CICD、区块链、AI等技术始终保持着浓厚的兴趣，平时喜欢阅读、思考，相信持续学习、终身成长，欢迎一起交流学习。&lt;br/&gt;微信公众号：DeepNoMind&lt;/em&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;参考资料&lt;/span&gt;&lt;/h3&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;The Art of Logging: &lt;em&gt;https://betterprogramming.pub/creating-a-human-and-machine-freindly-logging-format-bb6d4bb01dca&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;iso8601格式: &lt;em&gt;https://en.wikipedia.org/wiki/ISO_8601&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>a80c2f17350837ba34c933a4dcf19d81</guid>
<title>万字讲解数仓宽表在Flink中的设计与实践</title>
<link>https://toutiao.io/k/kieobwg</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;section&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-weui-theme=&quot;light&quot; data-id=&quot;MzI3NTU5ODA2NA==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyOSsjsl4sqSHZVqMolbicDgXR8ue0fC5EZTjvXJHuzD050cAy6mhWuzEiaT6CMQMJdCFEicg3FDCqpw/0?wx_fmt=png&quot; data-nickname=&quot;大数据兵工厂&quot; data-alias=&quot;&quot; data-signature=&quot;资深数据老兵，专注Flink、Clickhouse、Spark、Kafka、ES、Hive、Hbase、Java、Python、数仓、机器学习、推荐算法等领域，欢迎一起学习交流~&quot; data-from=&quot;0&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;大家好，我是老兵。&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;为何要使用大宽表？大宽表有什么优缺点？设计大宽表需要注意什么？如何将数据打宽了？今天我们一起聊聊。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本期将为大家介绍一期&lt;code&gt;数仓宽表&lt;/code&gt;的原理及&lt;code&gt;Flink宽表设计技术&lt;/code&gt;内容，文章内容有点肝，请大家搬好小板凳观看。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;em&gt;&lt;span&gt;本文参考：https://zhuanlan.zhihu.com/p/454600683&lt;/span&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;1 宽表基础知识&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;1.1 基本概念&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;数据仓库模型一般有四种：&lt;code&gt;宽表模型&lt;/code&gt;，&lt;code&gt;星型模型&lt;/code&gt;，&lt;code&gt;雪花模型&lt;/code&gt;，&lt;code&gt;星座模型&lt;/code&gt;。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.25903614457831325&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKibRDCicAtiaxxfmweuAwKVhgdfRQz4qGm6mBGyPZ6SlND9jJUzQiaYX9VmQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;830&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;四种模型定义如下：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）宽表模型（单例模型）&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通常是指业务主体相关的&lt;code&gt;指标、维度、属性&lt;/code&gt;关联在一起的一张数据库表。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2）星型模型&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由&lt;code&gt;事实表和维度表&lt;/code&gt;组成，一个星型模型中可以有&lt;code&gt;一个或者多个&lt;/code&gt;事实表，每个事实表引用任意数量的&lt;code&gt;维度表&lt;/code&gt;。星型模式的物理模型像一颗星星的形状，中心是一个事实表，围绕在事实表周围的维度表表示星星的放射状分支，这就是星型模式这个名字的由来。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3）雪花模型&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;雪花模式也是由&lt;code&gt;事实表&lt;/code&gt;和&lt;code&gt;维度表&lt;/code&gt;所组成，它将低基数的属性从维度表中移除并形成单独的表。基数指的是一个字段中不同值的个数，如性别这样的列基数就很低。在雪花模式中，一个维度被规范化成多个关联的表，而在星型模式中，每个维度由一个&lt;code&gt;单一的&lt;/code&gt;维度表所表示。星型模式是雪花模式的一个特例(维度没有多个层级)。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;4）星座模型&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;由&lt;code&gt;多个事实表&lt;/code&gt;组合，维表是公共的，可以被多个事实表共享。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;1.2 宽表优缺点&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在数据仓库建设中，组织相关和相似数据，采用&lt;code&gt;明细宽表&lt;/code&gt;，减少数据扫描，提高明细数据表的易用性，以及查询性能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;然而宽表也存在一些缺点：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;数据冗余，由于把不同的内容都放在同一张表存储，宽表已经不符合&lt;code&gt;三范式&lt;/code&gt;的模型设计规范，随之带来的主要坏处就是数据的&lt;code&gt;大量冗余&lt;/code&gt;，对存储是个挑战。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;灵活性差，比如线上业务表结构&lt;code&gt;变更&lt;/code&gt;，宽表模式&lt;code&gt;改造量&lt;/code&gt;也比较大。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;开发流程变长，我们需要去了解&lt;code&gt;业务全流程&lt;/code&gt;，得需要知道需扩展哪些维度，沉淀哪些指标，这样就流程会比较长，特别是有些业务快速迭代的话，就有点捉襟见肘。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;1.3 怎么判断是宽表好还是多维表好？&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;数据仓库每张表的搭建，主要依赖于这个表在整个数据仓库中的&lt;code&gt;作用和相关意义&lt;/code&gt;。首先要清楚这个表的存在是为了&lt;code&gt;解决那些问题&lt;/code&gt;，&lt;code&gt;什么角色使用&lt;/code&gt;，&lt;code&gt;怎么保证使用者尽可能好的体验&lt;/code&gt;解决问题。从以上所提到的角度去看待问题，拆解以下几点因素：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;1）多表关联查询的使用频次有多高，将重复高频的事情简化，是不是更好？&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;2）查询体验上需要考虑多表关联之后的查询性能问题，关联表，是否影响查询速度？&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;3）某些场景下，是否存在不能打宽的情况，比如事实维度一对多场景&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;1.4 策略总结&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从规范化的角度来讲，数据仓库的设计者是希望&lt;code&gt;越规范越好&lt;/code&gt;，因为这样会减少数据的冗余，而且也便于模型的扩展。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从反规范化的角度来讲，数据仓库的使用者是希望使用&lt;code&gt;越方便越好&lt;/code&gt;，他们并不太关系规范不规范冗余不冗余，只要用着方便就好。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种情况在工作中是十分常见的，那么该怎样来解决它？下面有两个思路：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）两种方式都存&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;虽然，这样看起来会占用更多的存储空间，但不失为一种合适的解决方案，因为宽表是通过别的表拼接而成的，因此宽表的&lt;code&gt;存储周期是可以短一些&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2）只存多个维度表&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过&lt;code&gt;视图&lt;/code&gt;来创建宽表。这种方式适合于宽表的&lt;code&gt;查询次数较少&lt;/code&gt;的情况。比如在Hive中，宽表其实只是为了计算出来之后导入Es等系统中供其它系统查询，那么久没必要存储一份宽表，直接通过视图来封装就可以。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;鉴于以上的一些考量，在数仓底层可以使用&lt;code&gt;星型模型&lt;/code&gt;，而宽表则可以存在于更靠后的层次。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;2 如何设计宽表&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;宽表的好处和不足我们都讲了，也就是说宽表虽好，但是带来的问题也很多，下面我们就看一下如何从设计的角度来避免宽表的不足之处。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.1 宽表到底多宽&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们要思考到底多宽才合适的，我们可以反着思考，宽表&lt;code&gt;不应该包含什么数据&lt;/code&gt;，这个问题很好回答，宽表不应该包含不属于它所在域的数据，例如会员域的宽表只应该包含会员相关的信息，同理我们的宽表是针对某一个域而言的，也就是说它是&lt;code&gt;有边界的&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以可以大胆点说宽表只要&lt;code&gt;不跨域&lt;/code&gt;，并且&lt;code&gt;方便使用&lt;/code&gt;都是合理的。但是这似乎并不能解决我们上面提到的宽表的不足，只是指明了宽表的一个大致的方向。有了方向之后我们通过我们的设计策略就可以让宽表瘦下来。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.2 宽表设计策略&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;设计策略主要包括：主次分类、冷热分离、稳定与不稳定分离。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）主次分类&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假设我们做的是一个会员域的宽表，但是会员域是还是一个比较大的概念，所以我们还要发掘出我们这个表的主题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;例如我们做的是一张&lt;code&gt;会员域&lt;/code&gt;下的&lt;code&gt;会员基本信息宽表&lt;/code&gt;，那么我们专注的肯定就是基本信息，例如&lt;code&gt;会员信息打通&lt;/code&gt;。当然因为宽表你可能还会冗余的其他信息进来，但是当这样的信息越来越多的时候，我们这张表的主题就越来越弱，所以我们就需要&lt;code&gt;做拆分&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;拆分可以让我们更加聚焦表的主题，对于数仓开发人员而言可以更好的维护、对于使用方而言可以更加清楚的理解这张表的主题。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2）冷热分离&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;假设我有一张宽表，里面有&lt;code&gt;200个&lt;/code&gt;字段，有&lt;code&gt;30张报表&lt;/code&gt;在使用它，但是我发现前面150个经常字段经常被使用，后面 50个字段只有一两张报表使用到了，那么我们就可以做一个冷热分离，将&lt;code&gt;宽表拆分&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3）稳定与不稳定分离&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们经常有这样的宽表，它依赖埋点数据，但是我们的埋点数据的特点就是量大，导致计算&lt;code&gt;经常延迟&lt;/code&gt;，那么我们的宽表就会受影响，从而我们的报表就受影响，但是很多时候你发现报表根本没有用过埋点计算出来的指标，或者是只用了一两个。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;那我们可以将其拆分，如果报表没有使用到那就最好了，如果使用到了，那就后推，在报表层面上做关联，这样我们的埋点数据即使出不来，我们的报表数据还是可以看的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;3 Flink中的宽表实现&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;下面内容均来自：&lt;span&gt;阿里基于 Flink SQL 构建流批一体的 ETL 数据集成&lt;/span&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;数据打宽是数据集成中最为常见的业务加工场景，数据打宽最主要的手段就是&lt;code&gt;Join&lt;/code&gt;，Flink SQL 提供了丰富的 Join 支持，包括&lt;code&gt; Regular Join&lt;/code&gt;、&lt;code&gt;Interval Join&lt;/code&gt;、&lt;code&gt;Temporal Join&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这些JOIN技术细节老兵也单独讲过一期文章，详情查看：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI3NTU5ODA2NA==&amp;amp;mid=2247498708&amp;amp;idx=1&amp;amp;sn=637aedf1f046947058fdffd1f9c5d262&amp;amp;chksm=eb00e44bdc776d5d244db7d033f6e84771d74dab445bfa13b3441bc9a5911beafa4e209af67b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;面试高频 | 你追我赶的Flink双流join&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;面试高频 | 你追我赶的Flink双流join&lt;/a&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.1 Regular join&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4703703703703704&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKib98ZOiaDYHMJQt27rtBicUJgnmib25ECiasM9llQUiaUFGO6gf1sRjsKYc7A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;810&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;Regular Join 就是大家熟知的双流 Join，语法上就是普通的 JOIN 语法。图中案例是通过广告曝光流关联广告点击流将广告数据打宽，打宽后可以进一步计算广告费用。&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;从图中可以看出，曝光流和点击流都会存入 join 节点的 state，join 算子通过关联曝光流和点击流的 state 实现数据打宽。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Regular Join 的特点是，任意一侧流都会触发结果的更新，比如案例中的曝光流和点击流。同时 Regular Join 的语法与传统批 SQL 一致，用户学习门槛低。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;但需要注意的是，Regular join 通过 state 来存储双流已经到达的数据，state 默认永久保留，所以 Regular join 的一个问题是默认情况下 state 会持续增长，一般我们会结合 state TTL 使用。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.2 Interval Join&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4963855421686747&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKibWjK7vOsL3QnhDkkSYb9N0ErW8AaoXMen5tFKhrU6IKic78fpIUzL5tQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;830&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;Interval Join 是一条流上需要有时间区间的 join，比如刚刚的广告计费案例中，它有一个非常典型的业务特点在里面，就是点击一般发生在曝光之后的 10 分钟内。&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;相对于 Regular Join，我们其实只需要关联这10分钟内的曝光数据，所以 state 不用存储全量的曝光数据，它是在 Regular Join 之上的一种优化。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;要转成一个 Interval Join，需要在两个流上都定义时间属性字段（如图中的 click_time 和 show_time）。并在 join 条件中定义左右流的时间区间，比如这里我们增加了一个条件：点击时间需要大于等于曝光时间，同时小于等于曝光后 10 分钟。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;与 Regular Join 相同， Interval Join 任意一条流都会触发结果更新，但相比 Regular Join，Interval Join 最大的优点是 state 可以自动清理，根据时间区间保留数据，state 占用大幅减少。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Interval Join 适用于业务有明确的时间区间，比如曝光流关联点击流，点击流关联下单流，下单流关联成交流。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.3 Temporal Join&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4870848708487085&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKib9B2kbYicLIVVDlx1r9v1QFCSiaTniaZ7libj3ExgJvGBV4fmiaa5Tquoia9w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;813&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;Temporal join (时态表关联) 是最常用的数据打宽方式，它常用来做我们熟知的维表 Join。在语法上，它需要一个显式的 FOR SYSTEM_TIME AS OF 语句。&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;它与 Regular Join 以及 Interval Join 最大的区别就是，维度数据的变化不会触发结果更新，所以主流关联上的维度数据不会再改变。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;Flink 支持非常丰富的 Temporal join 功能，包括关联 lookup DB，关联 changelog，关联 Hive 表。在以前，大家熟知的维表 join 一般都是关联一个可以查询的数据库，因为维度数据在数据库里面，但实际上维度数据可能有多种物理形态，比如 binlog 形式，或者定期同步到 Hive 中变成了 Hive 分区表的形式。在 Flink 1.12 中，现在已经支持关联这两种新的维表形态。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）Temporal Join Lookup DB&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4749082007343941&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKibwRibKA64m2KAOjBfEmSsOtJmjmkIEEyNtcIfWSvcZH6XT5xwBpy3tBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;817&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;Temporal Join Lookup DB 是最常见的维表 Join 方式，比如在用户点击流关联用户画像的案例中，用户点击流在 Kafka 中，用户实时画像存放在 HBase 数据库中，每个点击事件通过查询并关联 HBase 中的用户实时画像完成数据打宽。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Temporal Join Lookup DB 的特点是，维表的更新不会触发结果的更新，维度数据存放在数据库中，适用于实时性要求较高的场景，使用时我们一般会开启 Async IO 和内存 cache 提升查询效率。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3）Temporal Join Binlog&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5084541062801933&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKib8GOLfEP2gntNKJriaANdjmyVdjVUNoXpPtmY8NWFZVhtngicWAHRXS2w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;828&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;通过从 changelog在 Flink state 中物化出维表来实现维表关联。，我们可以通过 Flink CDC connector 把直播间数据库表的 changelog 同步到 Kafka 中。&lt;/p&gt;&lt;/blockquote&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;右边这段 SQL我们用了 upsert-kafka connector 来将 MySQL binlog 写入了 Kafka，也就是 Kafka 中存放了直播间变更数据的 upsert 流。然后我们将互动数据 temporal join 这个直播间 upsert 流，便实现了直播数据打宽的功能。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;这里 FOR SYSTEM_TIME AS OF 不是跟一个 processing time，而是左流的 event time，它的含义是去关联这个 event time 时刻的直播间数据，同时我们在直播间 upsert 流上也定义了 watermark，所以 temporal join changelog 在执行上会做 watermark 等待和对齐，保证关联上精确版本的结果，从而解决先前方案中关联不上的问题。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3）Temporal Join Hive&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5072815533980582&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKibIromnXCadaic8vOibsdT0GVricf6aCrxMb0jFauBvGcYrb7r4nUaaRCCg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;824&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;在数仓场景中，Hive 的使用是非常广泛的，Flink 与 Hive 的集成非常友好，现在已经支持 Temporal Join Hive 分区表和非分区表。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们举个典型的关联 Hive 分区表的案例：订单流关联店铺数据。店铺数据一般是变化比较缓慢的，所以业务方一般会按天全量同步店铺表到 Hive 分区中，每天会产生一个新分区，每个分区是当天全量的店铺数据。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;为了关联这种 Hive 数据，只需我们在创建 Hive 分区表时指定右侧这两个红圈中的参数，便能实现自动关联 Hive 最新分区功能，partition.include = latestb 表示只读取 Hive 最新分区，partition-name 表示选择最新分区时按分区名的字母序排序。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;到 10 月 3 号的时候，Hive 中已经产生了 10 月 2 号的新分区, Flink 监控到新分区后，就会重新加载10月2号的数据到 cache 中并替换掉10月1号的数据作为最新的维表。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;之后的订单流数据关联上的都是 cache 10 月 2 号分区的数据。Temporal join Hive 的特点是可以自动关联 Hive 最新分区，适用于维表缓慢更新，高吞吐的业务场景。&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;3.4 总结&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5124378109452736&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/lvcHBkdwcibyPAoiaDlUNgKcqI7JticYicKibBsj4VAc3levOPib7pXystiazM5en5ncziaIdKE4UN7Ma61zpibiabG2QOwA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;804&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;总结一下我们刚刚介绍的几种在数据打宽中使用的 join：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;Regular Join 的实效性非常高，吞吐一般，因为 state 会保留所有到达的数据，适用于双流关联场景；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Interval Jon 的时效性非常好，吞吐较好，因为 state 只保留时间区间内的数据，适用于有业务时间区间的双流关联场景；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Temporal Join Lookup DB 的时效性比较好，吞吐较差，因为每条数据都需要查询外部系统，会有 IO 开销，适用于维表在数据库中的场景；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Temporal Join Changelog 的时效性很好，吞吐也比较好，因为它没有 IO 开销，适用于需要维表等待，或者关联准确版本的场景；&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Temporal Join Hive 的时效性一般，但吞吐非常好，因为维表的数据存放在cache 中，适用于维表缓慢更新的场景，高吞吐的场景。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>521c5473a6ae479bc1e8115172eb53f5</guid>
<title>缓存数据丢了，原来是Redis持久化没玩明白</title>
<link>https://toutiao.io/k/wrohpih</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;p&gt;我们又见面了，我是码哥，可以叫我靓仔&lt;/p&gt;&lt;section&gt;&lt;mp-common-profile class=&quot;custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-weuitheme=&quot;light&quot; data-id=&quot;MzkzMDI1NjcyOQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/EoJib2tNvVtf7icAmS0BQH6oDVG37Q8NzcfdguS5qAqOhfxvZyIKqmuX5BbnDjynrBbZzktp1EiaeFLzapp1nHysw/0?wx_fmt=png&quot; data-nickname=&quot;码哥字节&quot; data-alias=&quot;MageByte&quot; data-signature=&quot;拥抱硬核技术和对象，面向人民币编程。&quot; data-from=&quot;0&quot; data-weui-theme=&quot;light&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;strong data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;真正的大师永远怀着一颗学徒的心&lt;/span&gt;&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;我们都知道Redis是微服务架构中重要的基础数据库中间件，通过Redis可以将数据库中的数据缓存到内存中，当服务端有数据查询请求的时候，可以直接从内存中获取数据。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;如此，一方面服务端可以获得比较快的数据请求响应，另一方面降低了后端关系数据库的业务请求压力。但是正所谓尺有所短，寸有所长，Redis最大的优势就是内存数据也是最大的劣势，因为一旦服务器宕机或者服务器重启，内存中缓存的数据也会丢失。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;针对这样的场景，Redis提供了三种数据持久化机制，分别是AOF、RDB以及混合持久化来应对这种异常情况。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;本文主要从Redis实现持久化遇到的问题出发，站在设计者的角度思考相关问题的解决思路。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.2517482517482517&quot; data-type=&quot;png&quot; data-w=&quot;429&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnnIGHWhUDGWTiareIplIRs2bdaaXr49w82Ribf3HQ2cGBzE5j893jibZFsavw5K3cYfApXry45xQMEg/640?wx_fmt=png&quot;/&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin-top: 2.2em; margin-bottom: 35px; outline: 0px; font-weight: bold; font-size: 22px; max-width: 100%; background-color: rgb(255, 255, 255); color: black; white-space: normal; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; line-height: 1.5em; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(255, 177, 27)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 177, 27)&quot; data-darkmode-color-16661378184925=&quot;rgb(81, 81, 81)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot;&gt;AOF持久化&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;AOF持久化方式，即Append Only File，Redis通过记录执行修改操作命令这种记小本本的方式进行内存数据持久化。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;当需要通过AOF日志进行恢复数据时，Redis服务端启动后可以从日志文件中回放执行命令来实现内存数据恢复。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;当然了，AOF日志中记录的都是修改的命令，查询命令不会修改数据所以不需要进行记录。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;可能大家都比较熟悉WAL(Write Ahead Log)，即日志预写机制，它是数据库非常常用的确保数据操作原子性以及持久性的技术手段。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;拿Mysql举栗子，Mysql的WAL体现在undo log以及redo log等这些日志文件中，数据库在执行修改操作的时候并不是立刻将数据更新到磁盘上，而是先记录在日志中，主要目的是如果出现异常，可以直接从redo log中进行数据恢复，也就是说让Mysql知道上次意外发生的时候操作到底有没有成功，另外还可以将Mysql的随机写转换为顺序写，提升IO性能。但是AOF却不同，它是在Redis将数据写入内存之后，再将相关的操作命令写入AOF文件中。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6446351931330472&quot; data-type=&quot;png&quot; data-w=&quot;1165&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnnIGHWhUDGWTiareIplIRs2bvs7wibMT8mFBo2yLicAS2xxJazwuQjBx4ALicSKKqRdZT7ZXjwiagWVJg/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;那么问题来了，为什么Redis要采取这种独特的数据记录方式，而不是业界常用的WAL的方式呢？其实可以从以下两个层面思考原因。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（1）AOF文件中保存了执行缓存的命令，以便于保证在需要恢复数据的时候可以进行命令重放恢复数据，因此需要保证执行命令的合法性，而通过先缓存数据再进行命令追加日志的方式可以确保追加到AOF文件中的的命令都是合法有效的，redis在恢复数据的时候不需要再去检查命令是否有效，进一步提升内存数据恢复的效率。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（2）另外由于是在修改操作命令之后进行日志记录，日志记录的时候需要进行磁盘IO操作，因此不会阻塞当前的修改命令。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin: 10px 0px 5px; padding: 10px 0px 0px; font-weight: bold; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; outline: 0px; max-width: 100%; color: black; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; background-color: rgb(255, 255, 255); line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(149, 149, 149)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot; data-style=&quot;margin: 0px; padding: 0px 0px 0px 20px; outline: 0px; max-width: 100%; color: rgb(81, 81, 81); font-weight: 700; font-size: 1em; border-left: 3px solid rgb(249, 191, 69); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;AOF文件内容是什么？&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;在搞清楚Redis为什么采用AOF文件记录修改命令之后，我们再来看看AOF文件中到底包含了&lt;/span&gt;哪&lt;span&gt;些内容。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;redis&amp;gt; SET mufeng handsome&lt;br/&gt;OK&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;Redis客户端与服务端之间采用RESP协议进行通信，它是一种应用层协议，对于Redis这种以效率为追求目标的中间件，通信协议必定要简单高效。就上面一条缓存操作命令来说：set mufeng handsome 对应的&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;RESP&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;报文就是*3$3set$6mufeng$8handsome，为了方便查看进行了手动换行。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2797147385103011&quot; data-type=&quot;png&quot; data-w=&quot;1262&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnnIGHWhUDGWTiareIplIRs2QhvR9kYJuxScnqtSEvCaUuyOXCz7J0Sr4tmuthgKMw1M2fO3Mu5www/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;我们来拆解下报文中各个属性的含义，“*3”代表本次操作命令将由三个分布组成，每一部分都是通过&quot;$数字&quot;的形式作为起始，后面为对应的命令、键或者值。如此处的&quot;$6&quot;就表示后面的命令是一个6个字节的键值。所以，appenonly.aof文件中实际保存的就是这种格式的内容。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5335438042620363&quot; data-type=&quot;png&quot; data-w=&quot;1267&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnnIGHWhUDGWTiareIplIRs2OHweoSwUwQ7ukBwJwbcVqRaRTGDKsqibbHbEgCy0UFVSh9ZbKHrUKGg/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin: 10px 0px 5px; padding: 10px 0px 0px; font-weight: bold; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; outline: 0px; max-width: 100%; color: black; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; background-color: rgb(255, 255, 255); line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(149, 149, 149)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot; data-style=&quot;margin: 0px; padding: 0px 0px 0px 20px; outline: 0px; max-width: 100%; color: rgb(81, 81, 81); font-weight: 700; font-size: 1em; border-left: 3px solid rgb(249, 191, 69); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;AOF有没有丢数据的风险？&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;上文说到Redis通过AOF文件实现内存数据持久化，那么是不是就代表缓存数据保存就万无一失了？这样的持久化方式还有没有数据丢失的风险呢？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;大家可以设想一下假设在操作完Redis之后，还没来得及将命令写入AOF文件就宕机了，那么这个操作命令就会丢失，对应的缓存数据最新值也会丢失。因为即便宕机异常恢复之后，也没办法从AOF文件中执行丢失的操作命令了。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;因此，写入AOF缓冲区的数据什么时候进行持久化落盘，直接决定着AOF持久化方式缓存数据丢失的风险大小。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;三种AOF落盘策略&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;针对AOF缓存中的数据在什么时机写入磁盘，Redis提供了三种AOF日志写入策略供用户进行选择，通过后台线程执行不同时机的AOF文件数据同步操作，在redis.conf配置文件中的配置项appendfsync可以进行配置。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【appendfsync:no】&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;Redis不用管AOF缓冲区的数据什么时候写入磁盘，将AOF缓冲区同步数据的操作权交给操作系统，操作系统决定什么时候将缓冲区的数据写入磁盘中。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【appendfsync:everysec】&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;当Redis将数据写入AOF缓冲区后，每隔1s将缓冲区的数据进行磁盘写入。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【appendfsync:always】&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;每执行一个修改命令，都需要&lt;/span&gt;将&lt;span&gt;修改的命令进行落盘操作。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;虽然Redis提供了这三种AOF日志落盘策略供用户进行选择，但是这三种策略实际上各有优缺点。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【appendfsync:no】如果设置了由操作系统进行AOF缓冲区数据写入，那么就相当于写数据的时机完全交由操作系统来决定，此时redis对于缓冲区数据并不可以控制。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span/&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【appendfsync:everysec】如果设置成每隔一秒进行缓存数据写入，虽然不会像同步写入那样存在一定的性能消耗，但是由于存在一秒的时间间隔，如果在此期间出现服务器宕机，那么就会损失这一秒的缓存数据。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;【appendfsync:always】虽然可以基本实现数据不丢失，但是由于每次进行内存数据修改都要进行落盘操作，因此在一定程度上&lt;/span&gt;会&lt;span&gt;影响主线程性能。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;具体采取怎样的配置策略还是要根据实际的业务场景来决定，一般推荐使用第二种配置策略&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【appendfsync:everysec】&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;，在可靠性以及性能方面相对平衡一点。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin: 10px 0px 5px; padding: 10px 0px 0px; font-weight: bold; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; outline: 0px; max-width: 100%; color: black; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; background-color: rgb(255, 255, 255); line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(149, 149, 149)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot; data-style=&quot;margin: 0px; padding: 0px 0px 0px 20px; outline: 0px; max-width: 100%; color: rgb(81, 81, 81); font-weight: 700; font-size: 1em; border-left: 3px solid rgb(249, 191, 69); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;AOF文件会越来越大吗？&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;在了解了AOF日志磁盘写入时机之后，我们继续来思考下一个问题。无论采取什么样的同步数据策略，最终都是要将修改命令写入AOF文件中，因此随着时间的推移，这个文件必定会越来越大。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;那么如果文件变得很大之后，无论是文件数据新写入还是Redis通过AOF文件进行数据恢复，大文件的操作都会造成IO性能损耗。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;假如你是Redis的设计者，如果遇到这种情况你会怎么进行设计优化呢？我想无非有两个优化思路，一个是化整为零，一个是想办法缩小大文件。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;化整为零&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;当单个文件过大时，我们很容易想到的优化方法就是将这个大文件拆分为若干个小文件。这就好比系统中一旦出现过千万数据库表的时候，我们就要结合实际的业务场景考虑要不要进行分库分表了。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;所以如果单个AOF文件太大，那么是不是可以考虑将其按照固定大小进行拆分，这样可以避免单个AOF文件过大的问题。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;那么Redis小于7.0版本为什么没有采用这种方案呢？主要是这种方案并不符合Redis追求简单高效的设计思想。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;假设采用了这种数据分块的方式，那必定需要实现文件大小检测、文件创建、文件索引维护等等一系列技术细节问题，对于低版本的Redis来说这些都太繁琐了，还不如一个AOF文件来的爽快。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;PS：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;在最新的Redis 7.0版本中，Redis已经支持多AOF文件分片机制，原始的单个AOF文件会被拆分为一个基础文件以及多个增量文件。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;新版本中之所以开始支持多文件存储，我想也是随着业务发展内存数据可能会很庞大，Redis设计者发现如果还是使用单文件存储，大AOF文件操作以及数据恢复都是一个挑战。&lt;br/&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8866141732283465&quot; data-type=&quot;png&quot; data-w=&quot;635&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnnIGHWhUDGWTiareIplIRs2yLYTwSVGuQPDTnBwv9D9QZVJDohozQK9MEKOcoK3Iu0epQhDw91y6A/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;AOF重写&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;既然进行文件切割太繁琐了，那么就单个AOF文件来说怎么才能减小文件大小呢？那就要从AOF文件的记录内容入手，通过上文我们了解到AOF文件中实际存储了修改内存数据的操作命令，因此我们在分析完这些操作命令之后发现，当多条命令操作同一个key的时候，实际我们需要的是最新的一条操作命令，除此之外的历史操作命令我们并不需要关心。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;比如【set mufeng handsome】、【set mufeng cool】，如果先后执行了这两个命令，那么在最终恢复数据的时候，只要恢复【set mufeng cool】即可。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;因此AOF重写的本质就是合并命令，也就是说将多条对同一key进行操作的命令进行合并，实际就是使用最新的key值操作命令来代替之前所有关于这个key值的命令。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;Redis通过fork子进程来完成AOF文件重写，因此在讲AOF重写过程之前，我们需要先了解下什么是fork子进程的原理，这样更加有利于我们后面了解AOF文件重写的过程。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;什么是fork？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;fork函数是linux内核提供给用户创建进程的API，应用程序通过调用fork函数创建子进程，这个子进程可以和原来父进程干同样的事情，也可以和原来主进程干不同的事情，这主要取决于对应的参数。这个过程就好比孙悟空拔了一根自己的猴毛变出来一个和自己一模一样的孙悟空。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;因此在fork子进程的过程之中，子进程复制了父进程的代码段、数据段、堆栈、页表等，同时子进程拥有独立的虚拟内存空间（当然是从父进程那里复制过来的）。如下所示，实际上fork()最终调用的是&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;内核copy_process方法复制进程。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4268104776579353&quot; data-type=&quot;png&quot; data-w=&quot;649&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGlQPdRtv7d2ekt6Kt67Q5EMmLmOhJ41Rd7iaxe3JLYPfHibsRLrUticxKDicgwKptk69CBhwHlzTIMANg/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;父进程fork子进程的时候，子进程拥有独立的虚拟内存空间，那么对应的物理内存空间是不是也是独立的呢？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;我们都知道在计算机中，内存属于非常宝贵的系统资源，所以大佬们在设计的时候都尽可能的减少内存空间占用从而提高系统资源利用率。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;fork子进程过程中用到的Copy-On-Write就是典型的内存资源管理优化机制，如果子进程只是读取数据不进行任何的数据写入，那么就和父进程公用内存空间。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;当子进程需要进行数据写入的时候，发现没有内控空间可以写入，此时会触发一个系统中断来分配内存空间给子进程进行数据写入。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.9959016393442623&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;976&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnsBMHvWibvy7pbfiaYCFUOt3JIVN8dIMLcTWXHjQLnbQib8KOcvQsTsrJtibdFSDF0gw9uPaOW9uic8Kw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;什么时机触发AOF重写？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;执行bgrewriteaof 命令&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;当我们在客户端手动执行bgrewriteaof 命令后，可以触发AOF文件进行重写，对应Redis源码中进行重写的bgrewriteaofCommand 函数会检测检测是否满足进行重写的条件，主要检测以下两个条件：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【Condition1】：检测当前是否存在已经在执行的AOF重写子进程，如果存在的话Redis将不再执行AOF文件重写。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;【Condition2】：检测当前是否存在已经在创建RDB文件的子进程，如果存在的话Redis将AOF文件重写任务置为待调度状态，后续如果满足了重写条件，则继续执行AOF文件重写任务。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;也就是说，Redis检测到当前既没有AOF重写子进程也没有RDB文件创建子进程，那么就可以进行AOF文件重写。对应源码如下：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//of_child_pid(aof rewrite进程pid)、rdb_child_pid(rdb dump进程pid)&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;void&lt;/span&gt; &lt;span&gt;bgrewriteaofCommand&lt;/span&gt;&lt;span&gt;(redisClient *c)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;if&lt;/span&gt; (server.aof_child_pid != &lt;span&gt;-1&lt;/span&gt;) {&lt;br/&gt;        &lt;span&gt;//如果正在aof rewrite，返回错误信息&lt;/span&gt;&lt;br/&gt;        addReplyError(c,&lt;span&gt;&quot;Background append only file rewriting already in progress&quot;&lt;/span&gt;);&lt;br/&gt;    } &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (server.rdb_child_pid != &lt;span&gt;-1&lt;/span&gt;) {&lt;br/&gt;        &lt;span&gt;//如果正在rdb dump，为了避免磁盘压力，将aof重写计划状态置为1，后期再进行rewrite；&lt;/span&gt;&lt;br/&gt;        server.aof_rewrite_scheduled = &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;        addReplyStatus(c,&lt;span&gt;&quot;Background append only file rewriting scheduled&quot;&lt;/span&gt;);&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;//如果当前没有aof rewrite和rdb dump在进行，则调用rewriteAppendOnlyFileBackground开始aof rewrite。&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;else&lt;/span&gt; &lt;span&gt;if&lt;/span&gt; (rewriteAppendOnlyFileBackground() == REDIS_OK) {&lt;br/&gt;        addReplyStatus(c,&lt;span&gt;&quot;Background append only file rewriting started&quot;&lt;/span&gt;);&lt;br/&gt;    } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;        &lt;span&gt;//出现异常返回错误。&lt;/span&gt;&lt;br/&gt;        addReply(c,shared.err);&lt;br/&gt;    }&lt;br/&gt;}&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;超出配置阈值&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;如果Redis实例开启了AOF配置，同时配置了&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;auto-aof-rewrite-percentage以及&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;auto-aof-rewrite-min-size，如果超出了阈值会触发AOF重写。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;  &lt;span&gt;//没有rdb子进程、没有aof重写子进程、aof文件设定了阈值以及aof文件大小绝对值超过阈值&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;if&lt;/span&gt; (server.rdb_child_pid == &lt;span&gt;-1&lt;/span&gt; &amp;amp;&amp;amp;&lt;br/&gt;         server.aof_child_pid == &lt;span&gt;-1&lt;/span&gt; &amp;amp;&amp;amp;&lt;br/&gt;         server.aof_rewrite_perc &amp;amp;&amp;amp;&lt;br/&gt;         server.aof_current_size &amp;gt; server.aof_rewrite_min_size)&lt;br/&gt;     {&lt;br/&gt;        &lt;span&gt;long&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; base = server.aof_rewrite_base_size ?&lt;br/&gt;                        server.aof_rewrite_base_size : &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;        &lt;span&gt;long&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; growth = (server.aof_current_size*&lt;span&gt;100&lt;/span&gt;/base) - &lt;span&gt;100&lt;/span&gt;;&lt;br/&gt;        &lt;span&gt;//超过阈值则进行重写&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (growth &amp;gt;= server.aof_rewrite_perc) {&lt;br/&gt;            serverLog(LL_NOTICE,&lt;span&gt;&quot;Starting automatic rewriting of AOF on %lld%% growth&quot;&lt;/span&gt;,growth);&lt;br/&gt;            rewriteAppendOnlyFileBackground();&lt;br/&gt;        }&lt;br/&gt;     }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;aof_rewrite_scheduled&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;被设置为待调度状态&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;在&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;bgrewriteaofCommand函数中，如果当前正在执行RDB dump操作，那么对应的aof待调度&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;aof_rewrite_scheduled状态就会被置为1，当前&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;RDB dump完成之后，会继续执行AOF重写操作。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;AOF重写过程是怎样的？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;通过上文的描述，我们知道了Redis触发AOF重写的时机，那么当触发重写之后的具体业务是怎样的呢？我们一起看下AOF重写的大致流程：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（1）Redis主进程首先检查是不是存在rdb dump进程或者aof重写进程正在运行，如果不存在Redis主进程fork子进程进行aof文件重写；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（2）fork出来的子进程和原来的Redis主进程拥有同样的内存数据，子进程遍历此时的内存数据同时将内存数据写入到临时的AOF文件中；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（3）主进程此时仍然可以接收客户端请求，同时将新的缓存操作写入aof_buf以及aof_rewrite_buf中，根据对应的同步策略，将buf中的数据分别写入旧AOF文件以及临时AOF文件中；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（4）重写完成之后，临时AOF文件将替换原有的老的AOF文件，从而完成整个AOF重写。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5211835911230666&quot; data-type=&quot;png&quot; data-w=&quot;1487&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGmzT5C7h2uREw6zI4UjjztKY2UnB85joFtBZuepAjVdm43fbYibgVxy1iabRjKfQkrADOTn3GsXPMVg/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;AOF模式优点&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;1、AOF的持久化策略更加丰富些，可以根据实际业务需要进行配置，因此相对来说在数据可靠性方面要更加有优势一点。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;2、AOF文件内容比较好理解，更加方便理解业务缓存数据。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;AOF模式缺点&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;1、通常情况下，同样的缓存数据，AOF文件比RDB文件大小要大一些。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;2、在文件恢复场景下，AOF要比DRB恢复数据慢一些。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin-top: 2.2em; margin-bottom: 35px; outline: 0px; font-weight: bold; font-size: 22px; max-width: 100%; background-color: rgb(255, 255, 255); color: black; white-space: normal; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; line-height: 1.5em; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(255, 177, 27)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 177, 27)&quot; data-darkmode-color-16661378184925=&quot;rgb(81, 81, 81)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot;&gt;RDB持久化&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;RDB（Redis Data Base），所谓的Redis内存数据快照就是某一时刻Redis存于内存中的所有缓存数据，这就好比用手机相机拍照，记录当时的美好画面。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;Redis可以实现在固定时间间隔后将内存中的缓存数据持久化保存起来。这样即便是服务器宕机或者重启了，只要RDB快照文件还存在，快照文件中对应的缓存数据就不会丢失，Redis重新启动后会重新加载RDB文件到内存中，快速恢复缓存数据，通过这样的方式保障了缓存数据的可靠性。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin: 10px 0px 5px; padding: 10px 0px 0px; font-weight: bold; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; outline: 0px; max-width: 100%; color: black; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; background-color: rgb(255, 255, 255); line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(149, 149, 149)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot; data-style=&quot;margin: 0px; padding: 0px 0px 0px 20px; outline: 0px; max-width: 100%; color: rgb(81, 81, 81); font-weight: 700; font-size: 1em; border-left: 3px solid rgb(249, 191, 69); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;RDB文件生成过程&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;我们以bgsave为例子来看下Redis生成RDB文件的大致过程是怎样的。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;int&lt;/span&gt; &lt;span&gt;rdbSaveBackground&lt;/span&gt;&lt;span&gt;(&lt;span&gt;char&lt;/span&gt; *filename, rdbSaveInfo *rsi)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;pid_t&lt;/span&gt; childpid;&lt;br/&gt;    &lt;span&gt;long&lt;/span&gt; &lt;span&gt;long&lt;/span&gt; start;&lt;br/&gt;&lt;br/&gt; &lt;span&gt;// 如果已经存在aof重写子进程以及rdb生成子进程则直接返回错误&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;if&lt;/span&gt; (server.aof_child_pid != &lt;span&gt;-1&lt;/span&gt; || server.rdb_child_pid != &lt;span&gt;-1&lt;/span&gt;) &lt;span&gt;return&lt;/span&gt; C_ERR;&lt;br/&gt;    ...&lt;br/&gt;    &lt;span&gt;// fork子进程进行RDB文件生成&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;if&lt;/span&gt; ((childpid = fork()) == &lt;span&gt;0&lt;/span&gt;) {&lt;br/&gt;        ...&lt;br/&gt;        &lt;span&gt;// 生成RDB文件&lt;/span&gt;&lt;br/&gt;        retval = rdbSave(filename,rsi);&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (retval == C_OK) {&lt;br/&gt;            &lt;span&gt;size_t&lt;/span&gt; private_dirty = zmalloc_get_private_dirty(&lt;span&gt;-1&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (private_dirty) {&lt;br/&gt;                serverLog(LL_NOTICE,&lt;br/&gt;                    &lt;span&gt;&quot;RDB: %zu MB of memory used by copy-on-write&quot;&lt;/span&gt;,&lt;br/&gt;                    private_dirty/(&lt;span&gt;1024&lt;/span&gt;*&lt;span&gt;1024&lt;/span&gt;));&lt;br/&gt;            }&lt;br/&gt;&lt;br/&gt;            server.child_info_data.cow_size = private_dirty;&lt;br/&gt;            &lt;span&gt;// 通知父进程RDB文件生成完毕&lt;/span&gt;&lt;br/&gt;            sendChildInfo(CHILD_INFO_TYPE_RDB);&lt;br/&gt;        }&lt;br/&gt;        &lt;span&gt;//子进程退出&lt;/span&gt;&lt;br/&gt;        exitFromChild((retval == C_OK) ? &lt;span&gt;0&lt;/span&gt; : &lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;    } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;       &lt;span&gt;//父进程业务逻辑&lt;/span&gt;&lt;br/&gt;        ...&lt;br/&gt;    }&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; C_OK; &lt;br/&gt;}&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（1）Redis主进程首先判断当前是否存在已经在执行的aof重写子进程以及rdb文件生成子进程，如果存在的话则直接进行返回。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;为什么要进行这样的判断呢？主要还是从服务器性能方面进行考量，如果服务器有多个子线程在进行RDB持久化操作，那么必定会对磁盘造成比较大的IO压力，如果服务器中还部署了其他服务甚至会影响其他服务的正常运行。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（2）Redis主进程fork子进程进行RDB文件生成操作，在fork的过程中，此时的Redis主进程是阻塞的，不能响应客户端请求，子进程fork完成之后可以继续响应客户端请求。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（3）fork出来的子进程遍历内存数据进行RDB文件生成操作。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（4）如果此时客户端的请求需要修改缓存数据，那么如上面fork子进程的原理，通过COW机制，操作系统会开辟新的内存空间给Redis主进程进行新的缓存数据写入。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;（5）子进程快照数据生成完成之后，替换原来老的RDB文件。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5388760585065435&quot; data-type=&quot;png&quot; data-w=&quot;1299&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnsBMHvWibvy7pbfiaYCFUOt3iaVrlTibo3Z5ttuLxl0YIrHRMCJmNvBVczVwz6DF6eS8goaoJ50WACOw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin: 10px 0px 5px; padding: 10px 0px 0px; font-weight: bold; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; outline: 0px; max-width: 100%; color: black; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; background-color: rgb(255, 255, 255); line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(149, 149, 149)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot; data-style=&quot;margin: 0px; padding: 0px 0px 0px 20px; outline: 0px; max-width: 100%; color: rgb(81, 81, 81); font-weight: 700; font-size: 1em; border-left: 3px solid rgb(249, 191, 69); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;RDB触发时机&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;Redis主要支持两种持久化操作来生成RDB文件，分别是save、bsave命令方式手动生成以及在配置文件中配置时间间隔自动进行RDB文件生成。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;手动命令触发&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;客户端连接到redis之后我们可以通过save以及bsave命令进行RDB文件的立即创建，两者的区别如下：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;save：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;通过主线程触发，会阻塞Redis业务，如果内存数据比较多的话，会导致长时间不能响应外部请求；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;bsave：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;客户端执行bsave命令进行RDB持久化，Redis主线程会fork子线程出来进行RDB文件持久化操作，这样避免了主线程的阻塞即便正在持久化操作依然可以响应外部数据缓存请求。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;不过这里值得注意的是，虽然fork子进程之后不会阻塞主进程，但是在fork的过程中会阻塞主进程，尤其是在内存数据比较大的时候，阻塞主进程的时间会更长。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;配置自动触发&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;另外在Redis的配置文件redis.conf中，我们可以配置按照一定的时间间隔来进行RDB持久&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;化操作。如下配置：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;save 900 1&lt;br/&gt;save 300 10&lt;br/&gt;save 60 10000&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;其他的触发RDB文件生成的操作这里不再赘述了，像从节点执行全量数据同步的时候，也会触发主节点生成RDB文件发送给从节点。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;br/&gt;&lt;/section&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin: 10px 0px 5px; padding: 10px 0px 0px; font-weight: bold; font-size: 20px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; outline: 0px; max-width: 100%; color: black; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; background-color: rgb(255, 255, 255); line-height: 1.4; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(149, 149, 149)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot; data-style=&quot;margin: 0px; padding: 0px 0px 0px 20px; outline: 0px; max-width: 100%; color: rgb(81, 81, 81); font-weight: 700; font-size: 1em; border-left: 3px solid rgb(249, 191, 69); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;RDB有没有丢数据的风险？&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;大家不妨思考下通过RDB文件进行缓存数据持久化会有什么问题？存不存在丢失缓存数据的风险？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;这种方式看上去是个还不错的持久化解决方案，但是实际上隐藏着一些丢失缓存数据的风险。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;为什么这么说呢？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;通过分析RDB文件生成的机制我们可以发现有两个地方存在缓存数据丢失的可能性。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;场景1：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;由于Redis保存RDB快照文件的策略是按照配置的时间间隔进行持久化保存，也就是每隔一个时间间隔Redis就会保存一个RDB文件。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;因此在内存数据有更新但是RDB保存时间尚未到来的这段时间如果存在服务器宕机或者服务器重启的情况，此时内存的数据就会存在丢失的风险，因为Redis还没来得及将数据持久化到RDB文件中。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;场景1中最大的问题就RDB文件持久化存在时间间隔，而这个时间间隔导致了新增的缓存数据&lt;/span&gt;存&lt;span&gt;在丢失的风险。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span/&gt;&lt;span&gt;那么是不是将时间间隔降低到最小就可以了，比如一秒钟，即使在这一秒钟期间出现异常情况，那缓存数据也只是丢掉这一秒钟的缓存数据，相对来说数据丢失的情况可控一点。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span/&gt;&lt;span&gt;但是问题是如果真的每隔1s就保存一个RDB文件到服务器磁盘中，那不论是对Redis本身还是Redis所在的服务器磁盘IO都是一种负担。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.7924203273040482&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;1161&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGmzT5C7h2uREw6zI4UjjztKaibgRFYq1DDRV98j6DZfyEJZup1UOBBicRic3QWhDwib9aodTXBfFiciaKKw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;场景2：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;随着业务的不断发展，内存中的数据必定会越来越大，因此在fork子进程来生成RDB文件的过程中，需要复制的数据会同样越来越多，耗费的时间也会越来越多，进而阻塞主进程的时间也会越来越多。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span/&gt;&lt;span&gt;如果出现&lt;/span&gt;长&lt;span&gt;时间阻塞主进程的情况，那么Redis实例必定无法响应客户端的数据操作请求，最终导致内存数据没有进行及时更新，从而出现丢失缓存数据的风险。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;RDB模式优点&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;1、相比AOF在恢复数据的时候需要一条条回放操作命令，通过RDB文件恢复数据效率更高；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;2、适合全量备份内存数据场景。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;3、同样规模的内存数据，RDB文件数据更加紧凑，磁盘空间占用更小。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;4、可以根据不同的时间间隔保存RDB文件，在恢复数据的时候可以更加灵活地选择对应版本数据进行恢复。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;RDB模式缺点&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;1、由于RDB数据保存存在一定的时间间隔，因此存在丢失缓存数据的风险；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;2、fork子进程进行RDB文件生成，由于是一次性生成一个内存快照文件，对于服务器磁盘IO以及Redis本身来说都属于重操作，可能会对服务器的磁盘IO造成压力。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/section&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin-top: 2.2em; margin-bottom: 35px; outline: 0px; font-weight: bold; font-size: 22px; max-width: 100%; background-color: rgb(255, 255, 255); color: black; white-space: normal; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; line-height: 1.5em; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(255, 177, 27)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 177, 27)&quot; data-darkmode-color-16661378184925=&quot;rgb(81, 81, 81)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot;&gt;混合持久化&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;既然AOF以及RDB持久化都有这样或者那样的不足，那么有没有一种持久化方案可以兼顾二者的优点来扬长避短呢？&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;从4.0版本开始，Redis支持混合持久化的方式来兼顾效率以及数据可靠性。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;在Redis配置文件redis.conf中配置混合持久化：&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;aof‐use‐rdb‐preamble yes&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;如果配置了混合持久化，那么Redis主进程在fork子进程进行持久化操作的时候，原先的将内存数据转换为操作命令的过程将替换为使用进行AOF重写时对应的RDB文件内容直接放入到重写后的临时文件中，后面再有新的操作命令，都追加到临时aof文件中，重写完成后使用临时aof文件替换旧的文件。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.470703125&quot; data-type=&quot;png&quot; data-w=&quot;1024&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/NwjSqraNTGnsBMHvWibvy7pbfiaYCFUOt3u1RVRk16gOwhnGzhYDegYy336ZRkkXwcET0hYlqrG0ZKQpDcjj7kIw/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;混合持久化模式优点&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;&lt;span&gt;1、同时拥有RDB以及AOF机制的&lt;/span&gt;优&lt;span&gt;点，在数据可靠性以及数据恢复效率上面达到了很好的平衡。&lt;/span&gt;&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;/&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;混合持久化模式缺点&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;1、由于Redis从4.0版本才开始支持混合持久化，如果当前平台中的Redis版本低于4.0，那么就无法使用这个持久化机制，因此兼容性不够友好；&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)&quot; data-style=&quot;margin-top: 2.2em; margin-bottom: 35px; outline: 0px; font-weight: bold; font-size: 22px; max-width: 100%; background-color: rgb(255, 255, 255); color: black; white-space: normal; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; text-align: left; line-height: 1.5em; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(255, 177, 27)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 177, 27)&quot; data-darkmode-color-16661378184925=&quot;rgb(81, 81, 81)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0,0,0)|rgb(81, 81, 81)&quot;&gt;总结&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;本文主要分析了Redis AOF、RDB以及混合持久化的内存数据持久化的机制原理，同时分析了两种持久化方式的优点以及缺点。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;我想只有理解了中间件的特性机制原理，知道了特性的长处以及不足我们才能设计适合我们平台的缓存数据持久化策略，从而提升平台的稳定性。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;p&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; white-space: normal; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); letter-spacing: 0.544px; font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;em data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; letter-spacing: 0.544px; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 16px; visibility: visible; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(0, 0, 0)&quot;&gt;另外在一些优秀中间件的学习和使用过程中，我们不能仅仅停留在会用的层面，更应该深入底层领会其架构和实现机制的设计思路，只有搞明白设计思路，时刻站在设计者的角度来看待遇到的问题，那么在我们的实际工作中，如果遇到类似的问题我们可以借鉴这些优秀中间件的解决思路来进行问题分析。&lt;/span&gt;&lt;/em&gt;&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)&quot; data-style=&quot;outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)&quot; data-style=&quot;margin-bottom: 24px; outline: 0px; max-width: 100%; color: rgb(34, 34, 34); font-family: system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;section data-width=&quot;100%&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot; data-style=&quot;margin: 0px 0px 0em; padding: 0px; outline: 0px; max-width: 100%; color: rgb(34, 34, 34); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial; caret-color: rgba(0, 0, 0, 0); font-size: 16px; font-family: -apple-system, system-ui, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; background-color: rgb(255, 255, 255); box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;section data-width=&quot;100%&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot; data-mid=&quot;&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot; data-mid=&quot;&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(68, 68, 68)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(68, 68, 68)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot; data-style=&quot;margin: 0px; padding: 0px; outline: 0px; max-width: 100%; background-color: rgb(68, 68, 68); height: 1px; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(68, 68, 68)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(68, 68, 68)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewbox=&quot;0 0 1 1&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(68, 68, 68)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(68, 68, 68)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(162, 162, 162)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)|rgb(68, 68, 68)&quot; data-style=&quot;outline: 0px; max-width: 100%; color: rgb(68, 68, 68); font-size: 12px; text-align: center; line-height: 1; letter-spacing: 0px; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;p data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(162, 162, 162)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)|rgb(68, 68, 68)&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(68, 68, 68)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(68, 68, 68)&quot; data-darkmode-color-16661378184925=&quot;rgb(255, 255, 255)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)|rgb(68, 68, 68)|rgb(255, 255, 255)&quot;&gt;&lt;strong data-darkmode-bgcolor-16661378184925=&quot;rgb(68, 68, 68)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(68, 68, 68)&quot; data-darkmode-color-16661378184925=&quot;rgb(255, 255, 255)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)|rgb(68, 68, 68)|rgb(255, 255, 255)&quot;&gt;  END  &lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot; data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot;&gt;&lt;section data-darkmode-bgcolor-16661378184925=&quot;rgb(68, 68, 68)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(255, 255, 255)|rgb(68, 68, 68)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(51, 51, 51)|rgb(34, 34, 34)|rgb(34, 34, 34)&quot; data-style=&quot;margin: 0px; padding: 0px; outline: 0px; max-width: 100%; background-color: rgb(68, 68, 68); height: 1px; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(34, 34, 34)&quot; data-style=&quot;margin-bottom: 0px; outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(34, 34, 34); font-family: system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(34, 34, 34)|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; color: rgb(0, 0, 0); font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; font-size: 14px; letter-spacing: 0.544px; text-align: left; white-space: pre-wrap; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;关注公众号：码哥字节，回复【redis】领取码哥《原创 Redis 高手心法》，也可以和我沟通、简历优化、技术面试。&lt;/span&gt;&lt;/p&gt;&lt;p data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(34, 34, 34)&quot; data-style=&quot;margin-bottom: 0px; outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); color: rgb(34, 34, 34); font-family: system-ui, -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; letter-spacing: 0.544px; white-space: normal; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;span data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(34, 34, 34)|rgb(0, 0, 0)&quot; data-style=&quot;outline: 0px; max-width: 100%; color: rgb(0, 0, 0); font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; font-size: 14px; letter-spacing: 0.544px; text-align: left; white-space: pre-wrap; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;mp-common-profile class=&quot;custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-weuitheme=&quot;light&quot; data-id=&quot;MzkzMDI1NjcyOQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/EoJib2tNvVtf7icAmS0BQH6oDVG37Q8NzcfdguS5qAqOhfxvZyIKqmuX5BbnDjynrBbZzktp1EiaeFLzapp1nHysw/0?wx_fmt=png&quot; data-nickname=&quot;码哥字节&quot; data-alias=&quot;MageByte&quot; data-signature=&quot;拥抱硬核技术和对象，面向人民币编程。&quot; data-from=&quot;0&quot; data-weui-theme=&quot;light&quot;/&gt;&lt;/section&gt;&lt;p data-darkmode-bgcolor-16661378184925=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16661378184925=&quot;#fff|rgb(255, 255, 255)&quot; data-darkmode-color-16661378184925=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16661378184925=&quot;#fff|rgb(34, 34, 34)&quot; data-style=&quot;text-align: left; margin-bottom: 0px; outline: 0px; max-width: 100%; background-color: rgb(255, 255, 255); letter-spacing: 0.544px; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;&lt;strong&gt;&lt;span data-style=&quot;color: rgb(0, 0, 0); font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif;&quot;&gt;&lt;span data-style=&quot;color: rgb(0, 0, 0); font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; font-size: 14px;&quot;&gt;&lt;span&gt;如果&lt;/span&gt;&lt;span&gt;觉得文章还不错的话，麻烦分享+点赞+收藏+在看交流哦。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>3e06da7ec0bee446daea33c6a085b5e0</guid>
<title>将云原生进行到底：腾讯百万级别容器云平台实践揭秘</title>
<link>https://toutiao.io/k/o9azdvg</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;span/&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.1008174386920981&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/VY8SELNGe95czZhnamWia6rvd1aenicicPiasMmUOHHu1wyeNicNJsWGa4syzF2PoOAePZEYtZX8jicbEDRPW3KsUlOw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;1468&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;导读｜&lt;/span&gt;&lt;span&gt;基于 K8s 的云原生容器化已经在腾讯内部海量业务中大范围落地实践。业务从传统的虚拟机部署形态无缝切换到容器部署形态，运行在 K8s 上的应用从无状态服务扩展到有状态服务，这个过程经历了哪些改造？同时，K8s 如何经受住业务形态复杂多样、模块数量庞大的考验？遇到哪些新的挑战？如何优化？效果怎么样？腾讯云高级工程师林沐将为你解答。&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9FiaZYIGick0nWJJXC1lSLI8zy2asbcicfNgvgJXexvB9rOnicPxbKFdEibPg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;在线业务资源容器化部署的问题与优化方案&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;腾讯平台的业务基本都属于在线业务。这些业务以前在虚拟机部署时，是通过物理机操办的方式生产出很多&lt;/span&gt;&lt;span&gt;虚拟机，对于业务来说是不感知的。当业务发现虚拟机负载较低时，可将多个在线业务混部来提高资源利用率。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-croporisrc=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe95czZhnamWia6rvd1aenicicPiaHoKRVtKeJfjVOutUP2LuKUx4fug4QxxIpickib2wafbbCicaMku3iatx0A/640?wx_fmt=png&quot; data-cropx1=&quot;0&quot; data-cropx2=&quot;1080&quot; data-cropy1=&quot;0&quot; data-cropy2=&quot;541.8685121107267&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.5018518518518519&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe95czZhnamWia6rvd1aenicicPia1YdXV0S1iaMWKhxNibJ7ofrWu8ibNW2icricrffyGC05PAcsEX81F9mhPLQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这种资源管理方式到容器化部署时发生了一些变化，主要有四方面的内容。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;容器交付&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。每个 Pod 在交付的同时需要声明规格大小，规格大小要改变时 Pod 必须销毁重建，无法通过&lt;/span&gt;&lt;span&gt;混部来新增业务。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;节点均衡&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。K8s 每个节点上部署多个 Pod，每个节点上的 Pod 类型、数量也都不相同，要保证节点均衡&lt;/span&gt;&lt;span&gt;是一个挑战。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;K8s 的云原生特性&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，也就是弹性，是否能够符合在线业务在生产环境中的需求？&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;集群池化&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。K8s 是按集群维度管理，而平台有上万个业务，这么多业务如何映射到不同的集群实现条带化&lt;/span&gt;&lt;span&gt;管理？&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;针对上述问题，腾讯采取的优化手段是：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第一，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;资源利用率提升——动态压缩和超卖&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。我们面临一个痛点是用户配置的容器规模不合理，普遍偏大，这样节点装箱率和负载比较低。所以第一个优化方式就是 Pod 资源动态压缩，Pod 请求双核处理器 4G 内存，在调度时压缩成单核 4G 内存。因为 CPU 属于可压缩资源，内存属于不可压缩资源。这里修改的只是 Request 大小，并不修改 Limit，所以不影响容器实际能使用的上限值。这样能提高节点的装箱率。接&lt;/span&gt;&lt;span&gt;下来是 Node 资源动态超卖，根据负载情况超卖更多 CPU 核心。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第二，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;节点负载均衡——动态调度和重调度&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。资源压缩超卖能提高节点的装箱率和负载使用率，但 Pod 是共享&lt;/span&gt;&lt;span&gt;Node 的，压缩和超卖会加剧它们之间的干扰。于是我们开发了动态调度器，当每一个 Pod 调度时，能够感知存量 Node 当前的实时负载情况，从而对增量 Pod 在 Node 当中均衡处理，掉到一个低负载的节点上。存量 Pod 在节点上也有可能发生高负载，这时我们在节点上部署 Pod-Problem-Detecor、NodeProblem-Detecor，检测出哪个 Pod 会导致节点高负载，哪些 Pod 属于敏感 Pod，通过事件上报告诉API Server，让调度器将异常 Pod、敏感 Pod 重新调度到空闲节点。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第三，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;K8s 业务弹性伸缩——协同弹性&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。在线业务最关心业务稳定性。有时业务负载超出预期时，因为最大负&lt;/span&gt;&lt;span&gt;载数配置过低，导致业务雪崩。所以我们对 HPA 进行优化，加入 HPAPlus-Controller，除了支持弹性最大副本策略之外，还能够支持业务自定义配置进行伸缩。第二个是 VPAPlus-Controller，可以 Pod 突发高负载进行快速扩容，对有状态的服务也可以进行无感知扩缩容。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第四，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;集群资源管理——动态配额和资源腾挪&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。从平台的角度，K8s 集群也是一个重要的维护对象。平台通过&lt;/span&gt;&lt;span&gt;动态 Operator 的方式控制业务对集群的可见性以及配额大小，使得各个集群的业务是分布均匀的。集群本身也有规模大小，有节点伸缩，叫做 HNA。HNA 能够根据集群负载情况自动补充资源或释放资源。生产环境中一种情况是，有时候突发活动，在公共资源池里没有特定资源，需要从其他系统里腾挪资源。所以我们开发了弹性资源计划 Operator，它会给每个节点、每个集群下发任务，要求每个集群释放一些Node 出来。这批节点的数量要尽可能符合业务的数量要求，同时要对存量业务的负载质量不产生影响。我们的方式是通过动态规划的方式解决问题，从而在业务做活动，或者紧急情况下，能够使集群之间的资源也能够流转。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9F812pnpTVKsrLmlcKHlIuuBvuwqeIqmOLOsD9nTpkow7FlAh45LKRLA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;容器化对动态路由同步的挑战与解决方案&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;每一个 Pod 在销毁重建的时候会动态添加或提取路由。一般来说，生产环节中的路由是第三方系统负责，&lt;/span&gt;&lt;span&gt;当 Pod 正常的时候系统给它转发流量，或者做名词解析，当它摘除时就从名词服务里剔除。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-croporisrc=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe95czZhnamWia6rvd1aenicicPiaZKwTCQ4ePj6JW22sr3CTXeiaOUy3IUGkEvBghVnzhhdAicYjes8kXC0g/640?wx_fmt=png&quot; data-cropx1=&quot;18.685121107266436&quot; data-cropx2=&quot;1080&quot; data-cropy1=&quot;0&quot; data-cropy2=&quot;551.2110726643598&quot; data-ratio=&quot;0.5178907721280602&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe95czZhnamWia6rvd1aenicicPiaib22QIxpIh3JVvcQiaEEt4Ejt7Mr17jSVXnicTqShsoWqYaLdazViblW2Q/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1062&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;但我们的平台在生产环节中会遇到一些特殊情况。第一个情况就是容器化之后容器的变更更加频繁。第二个&lt;/span&gt;&lt;span&gt;变化在于业务规模非常庞大，单个负载的 Pod 可能成千上万。第三是业务层面的变化，云原生的方式是一个集群对一个路由入口，但在生产环节又是第三方路由系统，允许云上云下混合部署，跨集群多路由服务共享路由。动态路由是容器化的关键路径，是要解决的核心问题。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;在微观层面，业务对容器运行阶段有特殊需求，包括容器分级、路由和进程的运行状态一致、大批量探针失&lt;/span&gt;&lt;span&gt;败时要实现路由熔断。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;生产环节中路由系统是非常多的，每个路由系统会对应一种控制组件。所以我们需要路由同步 Controller&lt;/span&gt;&lt;span&gt;的统一框架。这个框架理论上是一个旁路 Controller，因此存在不可靠的问题。例如在 Pod 下线前，销毁的时候不保证已经剔除路由；又比如在滚动更新时，可能上一批还没有添加路由，下一批就开始销毁重建。由于有些业务又比较敏感，必须要求绝对保证线下和滚动的时候路由的正确性，于是我们利用了 K8s 云原生的删除保护、滚动更新机制来实现这一需求。当业务在销毁之前先剔除路由，业务在滚动更新的时候先保&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;证上一批添加。通过这种方式将路由融入到 Pod 生命周期里，来实现业务的可靠性。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;对于运行阶段，例如容器异常自动重启，或者 Pod 其中一个容器通过原地生成的方式启动，这些场景就会&lt;/span&gt;&lt;span&gt;绕过前面提到的滚动更新和删除保护。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;所以还要在运行阶段保证业务之间的快速同步。业务大批量变更又会产生大量事件，导致 Controller 积压问题。&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;对此我们第一个优化方式是使用 Service 粒度事件合并，将事件数量成数量级减少来提高速度。第二个是双&lt;/span&gt;&lt;span&gt;队列模型。K8s 的 Controller 里有定时历史对账机制，会将所有的 Pod 对象全部入队列。我们需要将实时和定时的事件分开，这样既能够解决定时对账，又能解决实时处理需求。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;这里面有一个细节问题，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;两个不同队列可能在同一个时刻会有同一个事件要处理，这就需要相互感知的能力&lt;/span&gt;&lt;span&gt;避免这种情况发生。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;下一个 Controller 框架的核心点在于支持共享路由。但云原生的 K8s 机制里是一个集群对应一个路由入口，&lt;/span&gt;&lt;span&gt;所以我们在 Controller 框架里增加一个路由同步记录，也是按照 Service 的粒度去记录的。如果业务系统产生脏数据，例如触发一个剔除操作，但是路由系统返回成功了，实际上没有剔除，那么下一次它去同步处理这个事件的时候发现它没有被剔除，那么还是会再重新剔除一遍。也就是说路由操作等于期望值去 Diff当前值，而它的期望值就等于 Endpoint 和 Pod 生命周期的交集，当前值就是路由系统里面的情况加上路由记录，二者再取差积就是要做的路由操作。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;旁路 Controller 作为一个组件会有异常的时候，虽然 K8s 提供 Leader 机制，但这个机制被 Controller&lt;/span&gt;&lt;span&gt;拉起时需要预加载存量 service 数据，如果数据量非常大需要很久时间。我们的解决方式是，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;每一个Controller 运行的时候属于主备模式，这样当主容器挂掉的时候，备容器获得锁，之间的间隔就是整个Controller 同步中断的最长时间，之后备容器就可以快速接管路由通路服务。&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;中断期间可能发生事件丢失问题，我们通过定时历史对账机制解决这个问题。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;我们还有特殊需求，是业务为了兼容虚拟机部署的一种管理方式，主要针对容器的运行阶段以及特殊处理。&lt;/span&gt;&lt;span&gt;这里的需求包括容器分级、流量平衡、路由熔断。这些需求对传统的 Endpoint Controller 而言是不感知的，原来只维护 Ready 和 Not Ready 的状态，没有感知更细分的状态去维护容器的角色和状态。如果这是由路由 Controller 来实现，那么对这些特殊场景来说是牵一发而动全身的，每一个组件都得同时开发，修改一遍，维护成本是很高的。所以我们提供了一种解决方案——Endpoint-Plus Controller。它将维护容器角色和状态的能力下沉到 Endpoint 来实现。它与 Endpoint 和路由同步 Controller 之间建立一种交互协议，就是 Endpoint Ready 时添加路由，Not Ready 时禁用路由，不在 Endpoint 里删除路由。这样所有组件都是统一的，而且每次业务的新需求只要修改 Endpoint 就对全部生效，这样实现了动态路由同步的桥梁作用。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.08148148148148149&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/VY8SELNGe94QeANounecCYXmibLibjDT9Fl62j5eylelCcZwNOEv5HRg9xicSj2KIwvdQMPbwiau3eqyIUpKbjQ6nA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;一种全新的容器销毁失败自愈机制探索&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;最后一个话题是关于容器销毁失败自愈的。前面提到了动态调度、弹性伸缩、容灾迁移、流水线发布，这些&lt;/span&gt;&lt;span&gt;操作都有一个前提，就是容器销毁重建时老的容器要销毁，新的容器能创建出来。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;但实际上在生产环境中这并不是 100% 能保证的。因为容器是共享的，多个容器在同一个节点上，卡住的时候会涉及到很多原因：&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;调用链很长，只要其中任何软件出现 BUG 都会卡住；&lt;/span&gt;&lt;span&gt;管理容器对业务容器有侵入，造成卡顿；&lt;/span&gt;&lt;span&gt;业务容器之间互相干扰；&lt;/span&gt;&lt;span&gt;共享内核、Cgroup、Namespace，并不保证所有资源绝对完全隔离；&lt;/span&gt;&lt;span&gt;共享节点资源，当 CPU、磁盘 IO 高负载时会影响整个节点上的所有 Pod。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;K8s 发展到现在已经有了一套很完善的自愈机制。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;对容器异常来说，云原生 K8s 提供一个暴力解决方案就&lt;/span&gt;&lt;span&gt;是强删机制。该机制只是删除这个数据对象的数据，并不是销毁这个容器。这样导致一个问题，如果进行强制销毁，可能老容器会残留，新容器又起来了，这时老的容器会影响节点。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;所以容器销毁阶段卡住会影响容器销毁重建这个基本需求，而且它的原因是复杂多样的，在大规模系统环境中更容易出现，而已有的自愈机制是没有涵盖这种场景的，所以我们就需要提供一种全新的自愈机制。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;传统的解决方案是通过脚本扫描到它，对于定位到的问题，没有解决方案的需要临时隔离，已有解决方案的就要明确修复。但这并不是一个闭环方案，因为还有很多未知问题，对未知问题来说业务关心的是尽可能恢复，而对平台来说为了保证稳定性，需要尽可能知道这些根因，去收敛这类问题。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;所以我们兼顾这两个需求，要缩小定位范围、缩短定位周期，提高定位效率。对定位到根因的我们要去评估它的影响面，防止增量发生。而已经有解决方案的，我们需要有全网修复能力，出现异常的时候要告警，从而实现闭环解决方案。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;我们想到了是智能运维的方法，它依靠大规模训练样本，关注相关性。而故障处理一般是小样本量，强调专&lt;/span&gt;&lt;span&gt;业和因果性，所以它并不很适合这种场景。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;但在智能运维的决策树模型里有些概念可以拿来参考，譬如基尼系数、信息熵、剪枝等。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.49765990639625585&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe95czZhnamWia6rvd1aenicicPiakWoBbBqsc9yI7rUWXYauKCib2cPbU9Wmfibtv6TAicWzWDo5e6N3CbqAQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2564&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;最后简单介绍一下&lt;/span&gt;&lt;span&gt;&lt;strong&gt;决策树模型&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;的实现。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第一步需要&lt;/span&gt;&lt;span&gt;&lt;strong&gt;建立模型，是关于信息熵的权衡，要平衡自愈机制和定位效率&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;。我们在选择信息熵的时候是自顶&lt;/span&gt;&lt;span&gt;向下的推导路径，从节点异常再到容器调用链异常，再到具体系统日志。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第二步是&lt;/span&gt;&lt;span&gt;&lt;strong&gt;特征选取&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，基尼系数越小特征越明确，所以我们选择共同特征作为一个特征值。同时选择一些已知&lt;/span&gt;&lt;span&gt;问题或者根因比较明确的作为叶子节点。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;最后一步是&lt;/span&gt;&lt;span&gt;&lt;strong&gt;模型优化&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，例如剪枝优化，通过后剪枝的方式解决过拟合现象。同时简化模型。通过这种方式，&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;当容器发生销毁失败时，能够触发自愈路径。同时，对于新增问题，我们可以缩短问题范围，提高定位效率。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;通过以上三步，最终我们探索出了这样一种全新的容器销毁失败自愈机制。期望本文思路对你有帮助～&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;⛳️公众号粉丝专享：点击文末“&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;阅读原文&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;”&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt;，参与调研抽BANQ防水U盘&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span data-style=&quot;outline: 0px; max-width: 100%; color: rgb(0, 82, 255); font-family: -apple-system, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 15px; letter-spacing: 2px; box-sizing: border-box !important; overflow-wrap: break-word !important;&quot;&gt;腾讯工程师技术干货直达：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2NDU4OTExOQ==&amp;amp;mid=2247567393&amp;amp;idx=1&amp;amp;sn=d22b3cf3fb63bad935d2ab5d127c0611&amp;amp;chksm=eaa9d271ddde5b67b88d532dcd02ece7df95457ead8059a8dbcc85163625679a2ec1ed02106b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;1、一文读懂Go函数调用&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;1、&lt;/span&gt;&lt;/a&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2NDU4OTExOQ==&amp;amp;mid=2247567497&amp;amp;idx=1&amp;amp;sn=518fd9dcf8d77211edbd95772d2a5983&amp;amp;chksm=eaa9d2d9ddde5bcf31fd5eeb48cb60cfba6ea008ff118817e2cda9130eadfd163eaeffd778e0&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;手把手教你搭建Hexo博客&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;手把手教你搭建Hexo博客&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2、&lt;/span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2NDU4OTExOQ==&amp;amp;mid=2247567492&amp;amp;idx=1&amp;amp;sn=7967ef5a9b898063e7a5e22232245aca&amp;amp;chksm=eaa9d2d4ddde5bc21da8e4155151865541a6f71759aa726ae8817ba2bb6764ebae5adeb5da86&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;如何不改一行代码，让Hippy启动速度提升50%？&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;如何不改一行代码，让Hippy启动速度提升50%？&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2NDU4OTExOQ==&amp;amp;mid=2247566391&amp;amp;idx=1&amp;amp;sn=38f3cc7eeeeccde55a7e1222aa65e22a&amp;amp;chksm=eaa9de67ddde57715a0113e86d42f4fea42010c763769a26ecfd94b124893a13e5905d41c137&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;3、H5开屏从龟速到闪电，企微是如何做到的&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;3、&lt;/span&gt;&lt;/a&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2NDU4OTExOQ==&amp;amp;mid=2247567442&amp;amp;idx=1&amp;amp;sn=e920acd5ce45e296c861fcf483c5caa0&amp;amp;chksm=eaa9d202ddde5b14d3c11615341c579f0164894bba29183e344d6b0ccf27c0ae0bd0bed2471f&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;内存泄露？腾讯工程师2个压箱底的方法和工具&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;内存泄露？腾讯工程师2个压箱底的方法和工具&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;4、&lt;/span&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI2NDU4OTExOQ==&amp;amp;mid=2247567393&amp;amp;idx=1&amp;amp;sn=d22b3cf3fb63bad935d2ab5d127c0611&amp;amp;chksm=eaa9d271ddde5b67b88d532dcd02ece7df95457ead8059a8dbcc85163625679a2ec1ed02106b&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;一文读懂Go函数调用&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;一文读懂Go函数调用&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;mp-common-profile class=&quot;js_uneditable js_wx_tap_highlight&quot; data-pluginname=&quot;mpprofile&quot; data-weui-theme=&quot;light&quot; data-id=&quot;MzI2NDU4OTExOQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe97ibOIthe2pvwt1H0HqX0HVJVFK9WPNQKNsibXynR5yT5S7b45uIpzN7xeZdeJIfOibPjOflZ35rKZyw/0?wx_fmt=png&quot; data-nickname=&quot;腾讯云开发者&quot; data-alias=&quot;QcloudCommunity&quot; data-signature=&quot;腾讯云官方社区公众号，汇聚技术开发者群体，分享技术干货，打造技术影响力交流社区。&quot; data-from=&quot;2&quot; data-is_biz_ban=&quot;0&quot; data-index=&quot;0&quot; data-origin_num=&quot;649&quot; data-isban=&quot;0&quot;/&gt;       &lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.06756756756756757&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/VY8SELNGe94dCicRXdicib4XCVQRkPw1rY24tSDDNzqYuz3iaWozsahelG1E7ticNhNibY84zVCpss3u8FT7LpicwB0Yw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;740&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Vk4DDhl9V9uzUVFsgQia96gFUp0NkgvzS6qeSoddZRefiaJBA5Oa66v999Zqicq9vuQKnuVd1icakoFszTlVl1tjkg/640?wx_fmt=png&quot; data-w=&quot;36&quot; class=&quot;rich_pages wxw-img&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;点个 &lt;/span&gt;&lt;nobr data-mid=&quot;&quot;/&gt;&lt;span&gt;在看&lt;/span&gt;&lt;nobr data-mid=&quot;&quot;/&gt;&lt;span&gt;展示你的技术态度&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>