<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>7c3fbcf1ca8b2948c3505bb2e307f919</guid>
<title>我说 MySQL 单表超过 2000w 就要分库分表，面试官让我回去等通知？</title>
<link>https://toutiao.io/k/135oq4d</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;「 &lt;/strong&gt;关注&lt;/span&gt;&lt;span&gt;&lt;strong&gt;“石杉的架构笔记”&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;，大厂架构经验&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;倾囊相授&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; &lt;strong&gt;」&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/figure&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1.7777777777777777&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLa94uAA1BSamh6pwGZ3nHgOzf3Io5qH4xez8PsPPbHoicOqBD5h3CjS0k9YNHw5yTJ6BrH2kJUuTzw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;720&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;文章来源：【公众号：&lt;/span&gt;&lt;span&gt;程序员小富&lt;/span&gt;&lt;span&gt;】&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/3GHDOauYyUGbiaHXGx1ib5UxkKzSNtpMzY5tbbGdibG7icBSxlH783x1YTF0icAv8MWrmanB4u5qjyKfmYo1dDf7YbA/640?wx_fmt=gif&quot; data-w=&quot;100&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;前言&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;strong/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;不急于上手实战ShardingSphere框架，先来复习下分库分表的基础概念，技术名词大多晦涩难懂，不要死记硬背理解最重要，当你捅破那层窗户纸，发现其实它也就那么回事。&lt;/figure&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;/&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;什么是分库分表&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表是在海量数据下，由于单库、表数据量过大，导致数据库性能持续下降的问题，演变出的技术方案。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表是由&lt;code&gt;分库&lt;/code&gt;和&lt;code&gt;分表&lt;/code&gt;这两个独立概念组成的，只不过通常分库与分表的操作会同时进行，以至于我们习惯性的将它们合在一起叫做分库分表。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.41421143847487&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInaRibtuhkoWXCSibia28DS90txOibrv7C4TIdKYnppibSXHD2z4lZguZorjw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1154&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过一定的规则，将原本数据量大的数据库拆分成多个单独的数据库，将原本数据量大的表拆分成若干个数据表，使得单一的库、表性能达到最优的效果（响应速度快），以此提升整体数据库性能。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;为什么分库分表&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;单机数据库的存储能力、连接数是有限的，它自身就很容易会成为系统的瓶颈。当单表数据量在百万以里时，我们还可以通过添加从库、优化索引提升性能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;一旦数据量朝着千万以上趋势增长，再怎么优化数据库，很多操作性能仍下降严重。为了减少数据库的负担，提升数据库响应速度，缩短查询时间，这时候就需要进行分库分表。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;为什么需要分库？&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;容量&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们给数据库实例分配的磁盘容量是固定的，数据量持续的大幅增长，用不了多久单机的容量就会承载不了这么多数据，解决办法简单粗暴，加容量！&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;连接数&lt;/span&gt;&lt;/strong&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;单机的容量可以随意扩展，但数据库的连接数却是有限的，在高并发场景下多个业务同时对一个数据库操作，很容易将连接数耗尽导致&lt;code&gt;too many connections&lt;/code&gt;报错，导致后续数据库无法正常访问。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以通过&lt;code&gt;max_connections&lt;/code&gt;查看MySQL最大连接数。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;show&lt;/span&gt; &lt;span&gt;variables&lt;/span&gt; &lt;span&gt;like&lt;/span&gt; &lt;span&gt;&#x27;%max_connections%&#x27;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.173015873015873&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInBUKBzcmPxvvjGbdGtueIYFoEqsN9nlauykBxqBa0gENlsZDaaiaeoOQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1260&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;将原本单数据库按不同业务拆分成订单库、物流库、积分库等不仅可以有效分摊数据库读写压力，也提高了系统容错性。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;为什么需要分表？&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;做过报表业务的同学应该都体验过，一条SQL执行时间超过几十秒的场景。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;导致数据库查询慢的原因有很多，SQL没命中索引、like扫全表、用了函数计算，这些都可以通过优化手段解决，可唯独数据量大是MySQL无法通过自身优化解决的。慢的根本原因是&lt;code&gt;InnoDB&lt;/code&gt;存储引擎，聚簇索引结构的 B+tree 层级变高，磁盘IO变多查询性能变慢，详细原理自行查找一下，这里不用过多篇幅说明。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;阿里的开发手册中有条建议，单表行数超500万行或者单表容量超过2GB，就推荐分库分表，然而理想和实现总是有差距的，阿里这种体量的公司不差钱当然可以这么用，实际上很多公司单表数据几千万、亿级别仍然不选择分库分表。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.11318242343541944&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInkGJy6VW8WKq5qgKMlj35Gr8gImkTibcFpugZF6pR0QM1sHg6eMSvojQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1502&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;什么时候分库分表&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;经常会有小伙伴问，到底什么情况下会用分库分表呢？&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表要解决的是&lt;code&gt;现存海量数据&lt;/code&gt;访问的性能瓶颈，对&lt;code&gt;持续激增&lt;/code&gt;的数据量所做出的架构预见性。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;是否分库分表的关键指标是数据量&lt;/strong&gt;，我们以&lt;code&gt;fire100.top&lt;/code&gt;这个网站的资源表 &lt;code&gt;t_resource&lt;/code&gt;为例，系统在运行初始的时候，每天只有可怜的几十个资源上传，这时使用单库、单表的方式足以支持系统的存储，数据量小几乎没什么数据库性能瓶颈。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但某天开始一股神秘的流量进入，系统每日产生的资源数据量暴增至十万甚至上百万级别，这时资源表数据量到达千万级，查询响应变得缓慢，数据库的性能瓶颈逐渐显现。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以MySQL数据库为例，单表的数据量在达到亿条级别，通过加索引、SQL调优等传统优化策略，性能提升依旧微乎其微时，就可以考虑做分库分表了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;既然MySQL存储海量数据时会出现性能瓶颈，那么我们是不是可以考虑用其他方案替代它？比如高性能的非关系型数据库&lt;code&gt;MongoDB&lt;/code&gt;？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以，但要看存储的数据类型！&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;现在互联网上大部分公司的核心数据几乎是存储在关系型数据库（MySQL、Oracle等），因为它们有着&lt;code&gt;NoSQL&lt;/code&gt;如法比拟的稳定性和可靠性，产品成熟生态系统完善，还有核心的事务功能特性，也是其他存储工具不具备的，而评论、点赞这些非核心数据还是可以考虑用&lt;code&gt;MongoDB&lt;/code&gt;的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;如何分库分表&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;分库分表的核心就是对数据的分片（&lt;code&gt;Sharding&lt;/code&gt;）并相对均匀的路由在不同的库、表中，以及分片后对数据的快速定位与检索结果的整合。&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库与分表可以从：垂直（纵向）和 水平（横向）两种纬度进行拆分。下边我们以经典的订单业务举例，看看如何拆分。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInvcZoP6NdMzl9wr7icXnqYu0VOAD8XKvNJyic36OEC9DfsNgfJkLS5K3w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1552&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h3&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;垂直拆分&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;（1）垂直分库&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;垂直分库一般来说按照业务和功能的维度进行拆分，将不同业务数据分别放到不同的数据库中，核心理念 &lt;code&gt;专库专用&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;按业务类型对数据分离，剥离为多个数据库，像订单、支付、会员、积分相关等表放在对应的订单库、支付库、会员库、积分库。不同业务禁止跨库直连，获取对方业务数据一律通过&lt;code&gt;API&lt;/code&gt;接口交互，这也是微服务拆分的一个重要依据。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.40665701881331406&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInG73MELGmbElnUcz4Xll9Z1vibGQC0V5ia0SznS4OINWf09L5DQpNRwkw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1382&quot;/&gt;&lt;figcaption&gt;垂直分库&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;垂直分库很大程度上取决于业务的划分，但有时候业务间的划分并不是那么清晰，比如：电商中订单数据的拆分，其他很多业务都依赖于订单数据，有时候界线不是很好划分。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;垂直分库把一个库的压力分摊到多个库，提升了一些数据库性能，但并没有解决由于单表数据量过大导致的性能问题，所以就需要配合后边的分表来解决。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（2）垂直分表&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;垂直分表针对业务上字段比较多的大表进行的，一般是把业务宽表中比较独立的字段，或者不常用的字段拆分到单独的数据表中，是一种大表拆小表的模式。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;例如：一张&lt;code&gt;t_order&lt;/code&gt;订单表上有几十个字段，其中订单金额相关字段计算频繁，为了不影响订单表&lt;code&gt;t_order&lt;/code&gt;的性能，就可以把订单金额相关字段拆出来单独维护一个&lt;code&gt;t_order_price_expansion&lt;/code&gt;扩展表，这样每张表只存储原表的一部分字段，通过订单号&lt;code&gt;order_no&lt;/code&gt;做关联，再将拆分出来的表路由到不同的库中。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5129449838187702&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInqPGcugSXaKAVAMJL3xIBJMCQIJj5DoIxoL1EK9ic5ZWXH5n9mzib0LGg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1236&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;数据库它是以行为单位将数据加载到内存中，这样拆分以后核心表大多是访问频率较高的字段，而且字段长度也都较短，因而可以加载更多数据到内存中，减少磁盘IO，增加索引查询的命中率，进一步提升数据库性能。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;水平拆分&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;上边垂直分库、垂直分表后还是会存在单库、表数据量过大的问题，当我们的应用已经无法在细粒度的垂直切分时，依旧存在单库读写、存储性能瓶颈，这时就要配合水平分库、水平分表一起了。&lt;/span&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（1）水平分库&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;水平分库是把同一个表按一定规则拆分到不同的数据库中，每个库可以位于不同的服务器上，以此实现水平扩展，是一种常见的提升数据库性能的方式。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4723618090452261&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInTG3j8xBLV5zibIVkB0RhFT6XA6ib4yiasITIDDJ9I5ARYU04EQMqkVSNA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1194&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;例如：&lt;code&gt;db_orde_1&lt;/code&gt;、&lt;code&gt;db_order_2&lt;/code&gt;两个数据库内有完全相同的&lt;code&gt;t_order&lt;/code&gt;表，我们在访问某一笔订单时可以通过对订单的订单编号取模的方式 &lt;code&gt;订单编号 mod 2 （数据库实例数）&lt;/code&gt; ，指定该订单应该在哪个数据库中操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这种方案往往能解决单库存储量及性能瓶颈问题，但由于同一个表被分配在不同的数据库中，数据的访问需要额外的路由工作，因此系统的复杂度也被提升了。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（2）水平分表&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;水平分表是在&lt;strong&gt;同一个数据库内&lt;/strong&gt;，把一张大数据量的表按一定规则，切分成多个结构完全相同表，而每个表只存原表的一部分数据。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;例如：一张&lt;code&gt;t_order&lt;/code&gt;订单表有900万数据，经过水平拆分出来三个表，&lt;code&gt;t_order_1&lt;/code&gt;、&lt;code&gt;t_order_2&lt;/code&gt;、&lt;code&gt;t_order_3&lt;/code&gt;，每张表存有数据300万，以此类推。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6375545851528385&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInQKQHMMTrzaQJ9gtOBkXpzV0geic2PC2NDlibOo3ClAibUsQ0R8FEX6kjA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1374&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;水平分表尽管拆分了表，但子表都还是在同一个数据库实例中，只是解决了单一表数据量过大的问题，并没有将拆分后的表分散到不同的机器上，还在竞争同一个物理机的CPU、内存、网络IO等。要想进一步提升性能，就需要将拆分后的表分散到不同的数据库中，达到分布式的效果。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5764705882352941&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInUm6sQ78O1p1K0wMDYnv8wLsOucdiaiaTicQic7HK9cp5ZF0ehUKXfYqibzw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1530&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;数据存在哪个库的表&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表以后会出现一个问题，一张表会出现在多个数据库里，到底该往哪个库的哪个表里存呢？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上边我们多次提到过&lt;code&gt;一定规则&lt;/code&gt; ，其实这个规则它是一种路由算法，决定了一条数据具体应该存在哪个数据库的哪张表里。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;常见的有 &lt;code&gt;取模算法&lt;/code&gt; 、&lt;code&gt;范围限定算法&lt;/code&gt;、&lt;code&gt;范围+取模算法&lt;/code&gt; 、&lt;code&gt;预定义算法&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;1、取模算法&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;关键字段取模（对hash结果取余数 hash(XXX) mod N)，N为数据库实例数或子表数量）是最为常见的一种路由方式。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以&lt;code&gt;t_order&lt;/code&gt;订单表为例，先给数据库从 0 到 N-1进行编号，对 &lt;code&gt;t_order&lt;/code&gt;订单表中&lt;code&gt;order_no&lt;/code&gt;订单编号字段进行取模&lt;code&gt;hash(order_no) mod N&lt;/code&gt;，得到余数&lt;code&gt;i&lt;/code&gt;。&lt;code&gt;i=0&lt;/code&gt;存第一个库，&lt;code&gt;i=1&lt;/code&gt;存第二个库，&lt;code&gt;i=2&lt;/code&gt;存第三个库，以此类推。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5263157894736842&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInnapqp3zGVlFT0VNTiaJkZhxljnJlBJT5m5zRy4nLZ55pqUL42T7weQA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1254&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;同一笔订单数据会落在同一个库、表里，查询时用相同的规则，用&lt;code&gt;t_order&lt;/code&gt;订单编号作为查询条件，就能快速的定位到数据。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;优点&lt;/span&gt;&lt;/strong&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实现简单，数据分布相对比较均匀，不易出现请求都打到一个库上的情况。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;缺点&lt;/span&gt;&lt;/strong&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;取模算法对集群的伸缩支持不太友好，集群中有N个数据库实&lt;code&gt;·hash(user_id) mod N&lt;/code&gt;，当某一台机器宕机，本应该落在该数据库的请求就无法得到处理，这时宕掉的实例会被踢出集群。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此时机器数减少算法发生变化&lt;code&gt;hash(user_id) mod N-1&lt;/code&gt;，同一用户数据落在了在不同数据库中，等这台机器恢复，用&lt;code&gt;user_id&lt;/code&gt;作为条件查询用户数据就会少一部分。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;2、范围限定算法&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;范围限定算法以某些范围字段，如&lt;/span&gt;&lt;code&gt;时间&lt;/code&gt;&lt;span&gt;或&lt;/span&gt;&lt;code&gt;ID区&lt;/code&gt;&lt;span&gt;拆分。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用户表&lt;code&gt;t_user&lt;/code&gt;被拆分成&lt;code&gt;t_user_1&lt;/code&gt;、&lt;code&gt;t_user_2&lt;/code&gt;、&lt;code&gt;t_user_3&lt;/code&gt;三张表，后续将&lt;code&gt;user_id&lt;/code&gt;范围为1 ~ 1000w的用户数据放入&lt;code&gt;t_user_1&lt;/code&gt;，1000~ 2000w放入&lt;code&gt;t_user_2&lt;/code&gt;，2000~3000w放入&lt;code&gt;t_user_3&lt;/code&gt;，以此类推。按日期范围划分同理。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4913112164296998&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInfk4pwUYkzFEPcUEmap3ogOSIK6X5aPEZ0oYrPlStwMR5iaXqpOqWnGw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1266&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;优点&lt;/span&gt;&lt;/h4&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;单表数据量是可控的&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;水平扩展简单只需增加节点即可，无需对其他分片的数据进行迁移&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;缺点&lt;/span&gt;&lt;/h4&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;由于连续分片可能存在&lt;code&gt;数据热点&lt;/code&gt;，比如按时间字段分片时，如果某一段时间（双11等大促）订单骤增，存11月数据的表可能会被频繁的读写，其他分片表存储的历史数据则很少被查询，导致数据倾斜，数据库压力分摊不均匀。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;3、范围 + 取模算法&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;为了避免热点数据的问题，我们可以对上范围算法优化一下&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这次我们先通过范围算法定义每个库的用户表&lt;code&gt;t_user&lt;/code&gt;只存1000w数据，第一个&lt;code&gt;db_order_1&lt;/code&gt;库存放&lt;code&gt;userId&lt;/code&gt;从1 ~ 1000w，第二个库1000~2000w，第三个库2000~3000w，以此类推。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6112565445026178&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseIn47gFXYHsvZd1ic5pspMuztPsMvr0dr22uV5cGD9Ap1ZWwNUTrTEq6cg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1528&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;每个库里再把用户表&lt;code&gt;t_user&lt;/code&gt;拆分成&lt;code&gt;t_user_1&lt;/code&gt;、&lt;code&gt;t_user_2&lt;/code&gt;、&lt;code&gt;t_user_3&lt;/code&gt;等，对&lt;code&gt;userd&lt;/code&gt;进行取模路由到对应的表中。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有效的避免数据分布不均匀的问题，数据库水平扩展也简单，直接添加实例无需迁移历史数据。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;4、地理位置分片&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;地理位置分片其实是一个更大的范围，按城市或者地域划分，比如华东、华北数据放在不同的分片库、表。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;5、预定义算法&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;预定义算法是事先已经明确知道分库和分表的数量，可以直接将某类数据路由到指定库或表中，查询的时候亦是如此。&lt;/span&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;分库分表出来的问题&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;了解了上边分库分表的拆分方式不难发现，相比于拆分前的单库单表，系统的数据存储架构演变到现在已经变得非常复杂。看几个具有代表性的问题，比如：&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;分页、排序、跨节点联合查询&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分页、排序、联合查询，这些看似普通，开发中使用频率较高的操作，在分库分表后却是让人非常头疼的问题。把分散在不同库中表的数据查询出来，再将所有结果进行汇总合并整理后提供给用户。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如：我们要查询11、12月的订单数据，如果两个月的数据是分散到了不同的数据库实例，则要查询两个数据库相关的数据，在对数据合并排序、分页，过程繁琐复杂。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5364238410596026&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInA5QAJeiaTCypxqTSqy2Iqsqib0GfBBDtafkyLaPLbhicWDVd34qJxDAicw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1510&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;事务一致性&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表后由于表分布在不同库中，不可避免会带来跨库事务问题。后续会分别以阿里的&lt;code&gt;Seata&lt;/code&gt;和MySQL的&lt;code&gt;XA&lt;/code&gt;协议实现分布式事务，用来比较各自的优势与不足。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;全局唯一的主键&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表后数据库表的主键ID业务意义就不大了，因为无法在标识唯一一条记录，例如：多张表&lt;code&gt;t_order_1&lt;/code&gt;、&lt;code&gt;t_order_2&lt;/code&gt;的主键ID全部从1开始会重复，此时我们需要主动为一条记录分配一个ID，这个全局唯一的ID就叫&lt;code&gt;分布式ID&lt;/code&gt;，发放这个ID的系统通常被叫发号器。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;多数据库高效治理&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对多个数据库以及库内大量分片表的高效治理，是非常有必要，因为像某宝这种大厂一次大促下来，订单表可能会被拆分成成千上万个&lt;code&gt;t_order_n&lt;/code&gt;表，如果没有高效的管理方案，手动建表、排查问题是一件很恐怖的事。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;历史数据迁移&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表架构落地以后，首要的问题就是如何平滑的迁移历史数据，增量数据和全量数据迁移，这又是一个比较麻烦的事情，后边详细讲。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;blockquote mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;&lt;span mpa-is-content=&quot;t&quot;&gt;分库分表架构模式&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/section&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;p&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;分库分表架构主要有两种模式：&lt;code&gt;client&lt;/code&gt;客户端模式和&lt;code&gt;proxy&lt;/code&gt;代理模式&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;客户模式&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;client&lt;/code&gt;模式指分库分表的逻辑都在你的系统应用内部进行控制，应用会将拆分后的SQL直连多个数据库进行操作，然后本地进行数据的合并汇总等操作。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.48293515358361777&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseIn5NLhexuwavJEkxficshFgNu9LAmHXXyH6yql1rVqmlsFtQnibY8UHr8Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1172&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;代理模式&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;proxy&lt;/code&gt;代理模式将应用程序与MySQL数据库隔离，业务方的应用不在需要直连数据库，而是连接proxy代理服务，代理服务实现了MySQL的协议，对业务方来说代理服务就是数据库，它会将SQL分发到具体的数据库进行执行，并返回结果。该服务内有分库分表的配置，根据配置自动创建分片表。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5072697899838449&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/0OzaL5uW2aMzBtytGgvE1derMNyqseInzAdRSXqQoYic9mqKibcGgoibrtsdVKAv0gj2nM1Q7PaGhVnoPOjRsTKSQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1238&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;如何抉择&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如何选择&lt;code&gt;client&lt;/code&gt;模式和&lt;code&gt;proxy&lt;/code&gt;模式，我们可以从以下几个方面来简单做下比较。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（1）性能&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;性能方面&lt;code&gt;client&lt;/code&gt;模式表现的稍好一些，它是直接连接MySQL执行命令；&lt;code&gt;proxy&lt;/code&gt;代理服务则将整个执行链路延长了，应用-&amp;gt;代理服务-&amp;gt;MySQL，可能导致性能有一些损耗，但两者差距并不是非常大。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（2）复杂度&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;client&lt;/code&gt;模式在开发使用通常引入一个jar可以；&lt;code&gt;proxy&lt;/code&gt;代理模式则需要搭建单独的服务，有一定的维护成本，既然是服务那么就要考虑高可用，毕竟应用的所有SQL都要通过它转发至MySQL。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（3）升级&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;client&lt;/code&gt;模式分库分表一般是依赖基础架构团队的Jar包，一旦有版本升级或者Bug修改，所有应用到的项目都要跟着升级。小规模的团队服务少升级问题不大，如果是大公司服务规模大，且涉及到跨多部门，那么升级一次成本就比较高；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;proxy&lt;/code&gt;模式在升级方面优势很明显，发布新功能或者修复Bug，只要重新部署代理服务集群即可，业务方是无感知的，但要保证发布过程中服务的可用性。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;（4）治理、监控&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;client&lt;/code&gt;模式由于是内嵌在应用内，应用集群部署不太方便统一处理；&lt;code&gt;proxy&lt;/code&gt;模式在对SQL限流、读写权限控制、监控、告警等服务治理方面更优雅一些。&lt;/p&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.21428571428571427&quot; data-w=&quot;336&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_png/84QSpkgaj14GBzMnf1ibXkydLwCmhrWBooDwrdnlqYlsyB5PetG1T1oXxJ63G8TK58dqkDo7uzR7bKic50DxbTQQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6538461538461539&quot; data-w=&quot;52&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/BXOuoE8lPAIR47zmQ1XOqSQszO2PjLgkgakpDZQSsUkLLnGszEu0eyGjvHNRqu6picb2kicC4lo95WZGiaxqibqW4A/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot; mpa-is-content=&quot;t&quot;&gt;&lt;span&gt;欢迎扫码加入儒猿技术交流群，每天晚上20:00都有Java面试、Redis、MySQL、RocketMQ、SpringCloudAlibaba、Java架构等技术答疑分享，更能跟小伙伴们一起交流技术&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;267&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;267&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLbPrUTW4zORxkXJU3pH9mPiawH9oZtZGKTkHyVL2wemkqNmPoJKDZlAt5ibgr2CibGkffw2ozqicds4gw/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;396&quot;/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;41056&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;41056&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;94152&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-autoskip=&quot;1&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;span&gt;&lt;strong&gt;另外推荐儒猿课堂的1元系列课程给您，欢迎加入一起学习~&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p mpa-is-content=&quot;t&quot;&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;互联网Java工程师面试突击课&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295hjkFx86RFTZFibdBopicpMl5Scptaibp0pQAe5jUBMtXym9w4CncFBHsQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;SpringCloudAlibaba零基础入门到项目实战&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295NSLHaU5cHQTtyG2K5uK4iaA70v1g50BoQIRUVz4FBN1iahXdqc1M99Ww/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;亿级流量下的电商详情页系统实战项目&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295I9n8XXUWoEeuogklrbj2QN4JZ6cdgYeRys5CCsml2tkFfibLXdeqoFA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;Kafka消息中间件内核源码精讲&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295yiaEcp1k5HBVycE8BGD0lGz5NZmKWmKXUtSBS7Jnm4FkTY8R5XFZkPw/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;12个实战案例带你玩转Java并发编程&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295WWU9o0Pj51xAIa2qCs9xD2rdDIRLriaibePNSrWJVCknYn6b5lrF3CQQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;Elasticsearch零基础入门到精通&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295QdxHC6HadPfaakPOo7DxxQpLH19lMZH0yAwRI3iajVXblNnwfMxBk9A/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;基于Java手写分布式中间件系统实战&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;160&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295r0mR5hhVpAlXTAZzlVvSg1dxegAaZrIZ9ftePV5QQQg2ibIZbiaA6CCg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;基于ShardingSphere的分库分表实战课&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;（1元专享）&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1J6IbIcPCLZn0ZLz1APC2Hxj148icL295hicEliaIKPfLpHqQAo4CdAorqyxd9HvqD8sADicO7wFHGJxNtRus6LlBA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;160&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>59716a025de684966faacc9d601de904</guid>
<title>35岁失业？我们如何拓宽财富渠道？</title>
<link>https://toutiao.io/k/jbfirzk</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-role=&quot;outer&quot; label=&quot;edit by 135editor&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p&gt;&lt;span&gt;👆&lt;/span&gt;&lt;span&gt;点击“&lt;/span&gt;&lt;span&gt;博文视点Broadview&lt;/span&gt;&lt;span&gt;”，获取更多书讯&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.05669291338582677&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3nr1VNxfeqxVOw2nPJHVH4xeZibzPY5F4ibOuOZLMsUMrzIibGB6KMw7EurSKv6DkrtLzuhYdBa30A9Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;635&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2021年，随着各大互联网公司陆续裁员，“35岁危机”成了大家经常提起的话题。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;由于互联网公司的加班强度确实非常大，人近中年，因各种家庭原因无法承受高强度加班的现象非常普遍，中年危机的问题在这个行业中更加突出。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;但其实各行业的中年从业者们，都背负着来自各方面的生活压力。金融圈的基金经理们由于不堪业绩下滑压力，崩溃自杀的案例时有发生。即使国企的从业者有时也面临着人员优化、竞争上岗的压力。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;那么作为一个普通人，面对行业变换的大潮，就真的只能随波逐流，毫无应对之法吗？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我的答案是否定的。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在人生的30岁至40岁，我们所有人都面临着一次职业生涯甚至是整个人生的转型，那就是&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;实现从“个人能力”到“个人财富”的转型。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;转型成功，我们会迈向人生新的高度；转型失败，就有可能一直从事低价值的重复性劳动。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;那么，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;作为一名“理工男”，我们应该如何成功完成这次转型呢？在“人到中年”这个十字路口，怎样才能让自己的个人价值不降低，个人财富不缩水呢？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;希望本文能对你有所帮助。&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot;&gt;1&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;实现从“能力”到“财富”的转换&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;坦率地讲，如果我们在35岁时由于失业而出现了财富危机，那么这个危机的种子肯定早在25岁时就种下了。因为25岁到35岁这段时间，大部分人不会思考一个关键性的问题：&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;如何实现从“能力”到“财富”的转换？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;希望你读完本文，能成为那“一小部分人”。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;具体来讲，这里的“财富”指什么，又包括哪些方面呢？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;其&lt;/span&gt;&lt;span&gt;实《理工男谈理财：构建受益一生的财富体系》一书的第1节已经介绍了我&lt;/span&gt;&lt;span&gt;们最相关的财富项。这里我用一张典型的技术人员的发展路径图（如图1所示），帮助你更深入地理解这个概念。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7884097035040432&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbQOCMjA3ROEo5QbtIfu8liadicQNP4Ye0VM3mmf7d5hv1vfPxd1JZYfpQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;742&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图1  科技行业从业者的不同发展路径&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;从图1中的左半部分可以看到，只要你不是富二代，靠能力完成自己的原始财富积累就是一个必须经历的过程。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;在财富积累的过程中，可能会出现这种情况：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;有些人因为频繁平级跳槽，甚至频繁更换职业方向，始终冲不破“用能力赚钱”这一圈层，因此终其一生，都只能在财富的初级赛道上打转。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;但是我们看到，完成财富积累的人，从四个方向突破到了“靠财富赚钱”的圈层。他们或是凭技术财富，或是依靠人脉、管理财富，或是拥有创业财富，或是依赖金融房产财富，完成了从“打工人”到“财富管理者”的转变。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;当然，让自己从多个方向突破到“靠财富赚钱”的圈层是更健康的方式。我想这样的从业者，无论如何都不会遭遇“35岁危机”。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;这时你可能会说：从这四个方向突破都好难，感觉能做到的都是大咖，我们普通人真的能做到吗？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;接下来，我先举两个例子，看看和我们一样的普通人是怎么在“35岁危机”前“突围”的。&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot; data-num=&quot;2&quot;&gt;2&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;程序员小H的例子：从能力到财富的四个阶段&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;首先，我想介绍的是程序员小H的例子。听完这个故事，你可以了解从能力到财富的积累路径。顺便说一句，因为我跟小H有一些交集，所以我可以保证这个故事的真实性。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;五年前，小H 30岁，他和我们大多数人一样，在某互联网公司重复着“996”的生活。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;从那时起，他就开始思考这几个问题：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;自己未来的路到底在哪儿？目前的生活是不是自己想要的？自己35岁时，会不会像大家说的那样，遭遇职业生涯的危机？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;到了2022年，小H的状态是怎样的呢？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;他有一个40万粉丝的微信公众号，是IT领域的头部大号；他出版的图书成了畅销书，一年卖出5万册。而早在2019年，小H就已经辞职，因为凭借他在行业内的影响力，通过广告、版权、技术社区带来的收入已经远远超过他作为程序员的收入。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们前面提到，要想度过“35岁危机”，就一定要实现从能力到财富的积累。对比小H五年前和现在的状态，我们可以看到，五年前的小H只能通过“996”的付出来谋生，而五年后的小H已经有了三个非常有价值的、能够长期产生收益的财富项。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;这三大财富项分别是：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;list&quot;&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;媒体财富：IT类头部公众号。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;版权财富：畅销书。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;人脉财富：技术社区。&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;那么这五年间，小H是如何实现从能力到财富的积累的呢？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我想大致分为如图2所示的几个阶段：探索阶段、积累阶段、收益阶段和正反馈阶段。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.11296296296296296&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbtKHLGkEtn5RtFLxwquy1Ojse4tPjG609icKybqoLX8ubIzSSaQA01jA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图2  从能力到财富的积累路径&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;最初的探索阶段，小H在工作之余，尝试了多种可能产生收入的方向，比如利用自己的主业技能开发独立小游戏，利用自己的业余爱好投稿网文等，但都没有收到很好的效果。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;从2016年开始，小H想到了一种写公众号的特别方式：利用自己的专业优势为程序员讲解算法，并且采用新颖易懂的漫画形式。小H非常辛苦地坚持了一年，粉丝缓慢增长到1万人。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;第一个阶段往往是最艰难的，之后希望就来了，小H进入了积累阶段。&lt;/span&gt;&lt;span&gt;先是开始有收入了：公众号文章的阅读量与广告费成正比，一个1万粉丝的垂直领域公众号，大概会有1000~3000的阅读量，于是小H第一次获得了600元的广告收入。这之后，由于看到了成功的可能，小H投入了更多的精力，积累了更多公众号的写作和运营技巧，结识了更多圈内的人脉资源，一年之内让粉丝从1万迅速增长到10万。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;可以说，到这里，小H已经成功完成了媒体财富的积累，后面的路就越走越顺了。凭借每个月稳定的广告收入，小H正式进入了依靠财富创收的收益阶段。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;这时，小H面临着一个选择：&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;他可以用副业时间维持这个公众号，把它当作自己的一个收入来源；也可以进一步加大投入，基于这个公众号的资源“开枝散叶”，创造更多财富。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;最终，小H选择了全职投入内容创作的事业中，正式进入了正反馈阶段。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;在这个阶段，成功与否的关键点就在于&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;能不能建立起“由财富产生现金流，再通过现金流积攒更多财富”的正反馈（如图3所示）。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6147443519619501&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbXAQiaS4qqToR1MiatSbjgCa4EhfqibHck7QPjJniavvibP7Y10w7g2wh8Vg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;841&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图3  “创造财富-产生现金流-积累更多财富”的正反馈&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;让我们看看，小H是怎么建立起这个正反馈的。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;因为小H在公众号上持续进行高质量的内容输出，所以出版社的编辑主动联系他出书。因为已经有了公众号提供的稳定现金流，所以小H可以全职投入内容创作。这样，他就有更多的时间把优质内容编写成书，并经过进一步的拔高提炼，形成深入浅出的高质量算法书。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;然后，由于小H在之前的几个阶段已经积累了大量粉丝，这本书一上市就自带热度，迅速畅销。这也进一步扩大了小H的影响力，扩充了他的收入来源。再之后，建立相应的知识社区、付费社群，产生了更大的现金流，技术社区中的讨论也丰富了小H的创作素材，便于进行更多的内容输出。这些都使小H在技术圈的影响力不断扩大，又反过来推动了公众号的扩张。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;你可以看到，这一切终于形成了一个正反馈系统，小H的公众号、技术书、知识社区都是这个系统上能够互相助推的节点。如果你构建的体系发展到这一步，事情已经不用你来推动了，它会自己转起来。那么毫无疑问，这时你已经拥有了一座“金矿”，还用担心35岁时的事业危机吗？&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot; data-num=&quot;3&quot;&gt;3&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;我的创业故事：创业资源向财富资源的转换&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;第二个例子，是我的创业故事。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;很多熟悉我的读者知道，其实我的经历跟小H的有很多相似的地方：我也有自己的公众号，出版过不止一本技术畅销书，还在某线上教育平台有口碑不错的课程。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;但有一点，我跟小H不同：&lt;/span&gt;&lt;span&gt;我的所有副业都是为巩固主业服务的，并不是为了找寻一个能够替代主业的出路。但如果我愿意的话，也完全可以走上小H的道路。有了这样的选择，当然不担心失业之后一无所有。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;不过，你一定要清楚，讲小H的故事也不是想落入倡导大家都去写公众号文章的俗套。我只是希望，你能从这些例子中得到一些启发，理解从能力到财富转换的种种方式。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;下面我想跟你聊的，是我读研究生时的一段创业历程，也希望能给你一些启发。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我是2006年进入清华大学计算机系读本科的，而我的创业经历从大学三年级，也就是2009年年初开始，贯穿了整个研究生阶段，一直到我开始第一份工作。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你是一名“80后”“95前”，那你一定知道2008到2010年，移动互联网的概念有多火。那几年创业的团队不胜枚举，我跟几位同学，以及校外的一些创业朋友，合伙创办了我们的移动互联网工作室“五点工作室”。&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;这个工作室的业务方向主要有以下三个。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（1）承接一些外包项目，产生切实的收益。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（2）探索能够产生现金流的网赚项目。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（3）业余时间孵化我们的创业项目。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;最终，这三条业务线都为我的人生积累了宝贵的财富。具体来讲，主要有以下几个非常切实的收益。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在研究生毕业前，我通过接外包项目积累了40万元的存款，后来我用这些存款作为一部分首付款买了人生中的第一套商品房，帮助我及时赶上了房地产这趟车。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们利用机器学习和网络爬虫技术，搭建了一些垂直行业内容站，通过广告收入获得了稳定的现金流。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我们的创业项目被并购，让我持有了少量某上市公司的股票。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;除此之外，这段经历不仅为我增加了很多技术实践的经验，还让我积累了大量产品、运营方面的知识，这些至今都对我的职业生涯有积极的影响。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;从我的故事中，你可以分析出哪些从能力到财富的转换呢？&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;我觉得至少有以下三点。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（1）把通过技术产生收入的能力转换成房地产这个优质财富项。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（2）把机器学习的专业能力转换成优质的能产生现金流的网站或App财富。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（3）把创业的综合能力转换成已上市公司的股权财富。&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot; data-num=&quot;4&quot;&gt;4&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;主动思考才能把握住财富机会&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;我已经讲完了小H和我的故事，这时你可能想说：小H和你的成功都不具备代表性，因为这都是“时势造英雄”。一旦过了那个时间点，红利就消失了，不管创业还是公众号，都不容易成功了。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;事实果真如此吗？当然不是。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;机会每时每刻都在出现，只要主动思考自身的优势，每个普通人都能找到适合自己的成功机会。把“锅”甩给“时代”，每天抱怨“内卷”和“生不逢时”，那是庸人才会做的事情，不是一个追求更好生活的普通人应该做的事情。当然，这个时代肯定存在着它的问题，但相比于改造这个时代，进行主动思考，改变自己，抓住身边的机会更务实一些。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;回到正题，下面我再举几个用能力换财富的例子，希望给你一些行动方向上的启发。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;前面提到的小H，和我一样是一名理工男，是做算法题类的公众号成功的。其实只要结合自己的专业优势，懂得静下心来总结经验，在任何一个方向上都可以复制小H的成功。比如我的一位从事财务工作的朋友，一直在会计师事务所工作，他靠着熟练的Excel技巧出书、开课，照样获得了不菲的副业收入。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;上面说的都是利用专业能力积累财富，下面再举个不一样的例子：我一位前同事，他利用的不是专业技能，而是自己的兴趣爱好。这位同事喜欢摄影，他一开始通过摄影作品赚了些小钱，后来就在节假日接一些婚庆摄影的单子，逐渐转型成了职业的婚庆摄影。现在，他不仅脱离了之前不喜欢的程序员行业，而且做婚庆摄影的收入居然超过了工程师的工资收入。这是一个典型的兴趣导向创业成功的例子。因为热爱这个行业，就有源源不断的动力支持他在这个领域做精、做深。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;聚焦某个方向的小众市场进行投入，真的需要时运吗？我认为并不需要，需要的仅仅是你在一个方向上持续、深入钻研的能力。&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot; data-num=&quot;5&quot;&gt;5&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;“榕树关系”：主业的健壮是一切副业的基础&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;讲了这么多发展副业的例子，你可能想说：“我们平常上班已经够累了，还会有精力培养副业吗？”这其实是个非常实际的问题。要回答这个问题，我们要先厘清主业和副业的关系。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;对我来说，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;主业和副业最好的关系模式是“主业滋养副业，副业反馈主业”的“榕树关系”。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;在这个关系模式里，我们把主业比作榕树的主干，把副业比作由主干生发出的根。在开始的阶段，副业最好能够依附于你强壮的主业，从主业那里吸收营养，茁壮成长，成为你的“专业延伸财富”；而当副业长大后，它就能落地生根，反馈主业，让主业更健壮；再进一步，副业发展得好，还能像图4中的榕树一样，发展成一片榕树林，成为你新的财富增长点。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6655555555555556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbmHqfjUmyGPPRicCzH5dALBSf6lRRHtEQ65SWR4qLI37mesicE0mMw2ibA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图4  独木成林的榕树&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;接下来，我们再具体讲讲这里说的“榕树关系”。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;首先，如果你的主业不够健壮，在一开始的探索阶段，副业就不可能有一个较高的起点，你就很难在众多竞争者中脱颖而出。举个例子，如果小H没有把几百道算法题吃透，他怎么可能由此构建自己的知识体系，继而输出高质量的内容呢？我也是一样，如果上大学时，没有积累扎实的机器学习和编程功底，怎么能够靠它来创业和盈利呢？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;反过来讲，在探索阶段，副业其实也会支持、促进主业的发展。比如，算法题的精进肯定有助于小H的面试、跳槽，帮他拿到更好的Offer。而我对副业的投入，更是增加了我算法模型落地的能力，让我在研究生阶段就具备了大量的实践经验，这一点让我受益至今。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;总的来说，由于小H和我的副业选择都和主业强相关，所以我们在副业上的时间投入，起到了类似于游戏中“双倍经验卡”的作用。&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;list&quot;/&gt;&lt;p&gt;&lt;span&gt;对时间的高效利用，是你在没有实际收益的探索阶段把副业坚持下来的基础。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;所以，&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;我强烈建议你在开始一份副业之前，问自己下面这三个问题。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（1）这个副业是不是建立在我已有的技术或知识，或者坚持多年的兴趣爱好高点上的？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（2）这个副业能不能让我的主业也获益？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（3）我有没有可能坚持这个副业十年以上？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;如果你都回答“是”，那就毫不犹豫地开启你的副业探索之旅吧。&lt;/span&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot; data-num=&quot;6&quot;&gt;6&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h3&gt;&lt;strong&gt;&lt;span&gt;小结&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;本文讨论了如何拓展财富渠道的问题。关于这个问题，我们可以用“五个要点，一片榕树林”来总结。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;首先来看五个要点。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（1）要想35岁时没有失业危机，就要在25岁时开始思考从“能力”到“财富”转换的问题。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（2）创立成功的副业要经历“探索-积累-收益-正反馈”四个典型阶段。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（3）自己的副业一定要建立在主业的知识或技能高点，或者积累多年的爱好或特长上，否则没有竞争力。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（4）探索阶段是最难的，在这个阶段寻找能够让主业也受益的副业方向，是平衡时间投入最有效的手段。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;（5）坚持，坚持，坚持。最重要的事情说三遍，否则前面所有的分析都毫无意义。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;最后是“主业-副业的这片榕树林”。&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;主业和副业最好的关系模式是“主业滋养副业，副业反馈主业”的“榕树关系”，如图5所示。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7248062015503876&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbSaBtc82GMSAkgoy8eib7bttcvePyb4FhmbibmVSIOZqaib7nXap4foe8Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;774&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7706666666666667&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbcyicVuhASfBkQgKt7dic7qwicZHuHwCRmAAGvLuFMWc818r9KszXETSzQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;750&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;图5  主业-副业和投资理财两片“榕树林”&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;其实，财富的“榕树林”又何止一片？在我们的财富双塔中，本章内容帮助你把个人发展的“榕树林”发展得枝繁叶茂，教给你的关于投资理财的各种技能也能组成另一片“榕树林”。关于如何发展投资理财这片“榕树林”，&lt;/span&gt;&lt;span&gt;在《理工男谈理财：构建受益一生的财富体系》一书的第3章会为大家&lt;/span&gt;&lt;span&gt;讲解。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-role=&quot;title&quot; data-tools=&quot;135编辑器&quot; data-id=&quot;107294&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/JaFvPvvA2J1Clvz4XjNkCCVBtkQpCltfeUCXf9ZIy5iabeyU9OpE347LBN0rHfLxDmwibicgY4DKcwdFhQYbJkicNQ/640?wx_fmt=png&quot; data-w=&quot;59&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;0&lt;/strong&gt;&lt;strong data-original-title=&quot;&quot; title=&quot;&quot; data-num=&quot;7&quot;&gt;7&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;思考题&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;我想和你讨论两个比较有意思的现象。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;第一个现象：在娱乐圈，明星“火”了之后，相比于只是接戏、拍戏，他们更热衷于开自己的工作室、影视公司，为什么？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;第二个现象：很多真正有实力的互联网高管，即使年入千万，也还是要找机会离职创业，开办自己的公司，这又是为什么？&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;你能用本节能力换财富的思路，分析这两个现象背后的原因吗？&lt;/span&gt;&lt;/p&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;7&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p data-autoskip=&quot;1&quot;&gt;本文节选自《理工男谈理财：构建受益一生的财富体系》一书，欢迎阅读本书了解更多相关内容！&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;6.621897810218978&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbiaiaPkG27ACVe6XTGsPxElHSZj2ZQ9wyo6EcTF6DzqMPct5aHmHBiaia7Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;685&quot;/&gt;&lt;/p&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;5.883280757097792&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbneCJ2XSibyEHeTicOp3dPwAcDzVvQH3lgd2FmXAMgQ0kxanmul4QxwtQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;634&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;131&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;131&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3lvtTPFnuXVWCLJkfzsPTXbYWhFm1P232kSRcRFIV484ZextOsX8AzzxlJSLnU9bf4sLKicp78m9OQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;300&quot; data-width=&quot;131px&quot; title=&quot;理工男二维码.png&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;扫码查看本书详情！&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p draggable=&quot;true&quot;&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;发布：刘恩惠&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;审核：陈歆懿&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-croporisrc=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3ntPMYAJur3UuYzhSDgO7Puv74VHDtgNjyJbpQvt1gicgSpjrlpDy6BheYoAmtjiaF7cdIuPkuUlFkw/0?wx_fmt=png&quot; data-cropx1=&quot;0&quot; data-cropx2=&quot;1920&quot; data-cropy1=&quot;0&quot; data-cropy2=&quot;29.8961937716263&quot; data-ratio=&quot;0.01574074074074074&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/PW0wIHxgg3ntPMYAJur3UuYzhSDgO7Pu8DQL5f0FQIuDZC87yrAuNLy4frEdlMeWkthrlzczb0RbMOBQCAwDrA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;section&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;section&gt;&lt;span&gt;如果喜欢本文&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;欢迎&lt;/span&gt; &lt;span&gt;&lt;strong&gt;在看&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;丨&lt;/span&gt;&lt;span&gt;&lt;strong&gt;留言&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;丨&lt;/span&gt;&lt;span&gt;&lt;strong&gt;分享至朋友圈&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; 三连&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-id=&quot;92644&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-width=&quot;100%&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;span&gt; &lt;strong&gt;热文推荐 &lt;/strong&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-role=&quot;paragraph&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;hr/&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;574&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;244&quot; data-ratio=&quot;0.4255555555555556&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/PW0wIHxgg3m3jibtjia3lCrCvUY6N19QMZ3FjCcpuHouXkdLicQVUiaLicgR8cgSbk7RA8G427GKowhbEvVefuJp53g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;span&gt;▼点击阅读原文，了解本书详情~&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>800cb8922bfcf05d9e9fb79eef12bfca</guid>
<title>快速绘制流程图「GitHub 热点速览 v.22.47」</title>
<link>https://toutiao.io/k/1kjjzsg</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6666666666666666&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX0gD3bPY8kBVofSfy0oEgiaAA29ib1nFgwEm1e0z8Klh4gTmKzQic23GnmQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;5568&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;作者：HelloGitHub-小鱼干&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;画流程图一直是研发的一个难题，如何画得通俗易懂已经够让人头疼了，还要美观大方。用 d2 的语法描述下流程，d2 会自动帮你生成一张配色极佳的流程图。说到研发的选择，本周特推的 choiceof.dev 罗列了众多开发过程中会遇到的选项，你可以自测下你同主流研发的契合度。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;本周周榜呢，有监控网络流量的 sniffnet，监控 API 流量的 kubeshark，还有以便不时之需的开发小抄 cheat.sh，记录日常事项的备忘录 memos 和音频转文字工具 buzz。&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;以下内容摘录自微博@HelloGitHub 的 GitHub Trending 及 Hacker News 热帖（简称 HN 热帖），选项标准：&lt;/span&gt;&lt;code&gt;&lt;span&gt;新发布&lt;/span&gt;&lt;/code&gt;&lt;span&gt; | &lt;/span&gt;&lt;code&gt;&lt;span&gt;实用&lt;/span&gt;&lt;/code&gt;&lt;span&gt; | &lt;/span&gt;&lt;code&gt;&lt;span&gt;有趣&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，根据项目 release 时间分类，发布时间不超过 14 day 的项目会标注 &lt;/span&gt;&lt;code&gt;&lt;span&gt;New&lt;/span&gt;&lt;/code&gt;&lt;span&gt;，无该标志则说明项目 release 超过半月。由于本文篇幅有限，还有部分项目未能在本文展示，望周知 🌝&lt;/span&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6574923547400612&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX04Ly2OobE4agPwJ6Ta9wbfxM9zvuxRMXljAH7QXE9Uyu18cdz67dk9w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1308&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;1. 本周特推&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;1.1 文本变图表：d2&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;主语言：Go&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;New&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 本周刚开源并突破 5k star 关卡的“爆款”项目，只要用文本就可以生成对应的图表。比如下面这段语法讲得到一个流程图。&lt;/span&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;# Actors&lt;/span&gt;&lt;br/&gt;hans: Hans Niemann&lt;br/&gt;&lt;br/&gt;defendants: {&lt;br/&gt;  mc: Magnus Carlsen&lt;br/&gt;  playmagnus: Play Magnus Group&lt;br/&gt;  chesscom: Chess.com&lt;br/&gt;  naka: Hikaru Nakamura&lt;br/&gt;&lt;br/&gt;  mc -&amp;gt; playmagnus: Owns majority&lt;br/&gt;  playmagnus &amp;lt;-&amp;gt; chesscom: Merger talks&lt;br/&gt;  chesscom -&amp;gt; naka: Sponsoring&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# Accusations&lt;/span&gt;&lt;br/&gt;hans -&amp;gt; defendants: &lt;span&gt;&#x27;sueing for $100M&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;# Offense&lt;/span&gt;&lt;br/&gt;defendants.naka -&amp;gt; hans: Accused of cheating on his stream&lt;br/&gt;defendants.mc -&amp;gt; hans: Lost &lt;span&gt;then&lt;/span&gt; withdrew with accusations&lt;br/&gt;defendants.chesscom -&amp;gt; hans: 72 page report of cheating&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.2746331236897275&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX0JclcROZ7n3oOgKWCUGddRBZJafGCLSrF6TJogb4MotwSribHd7iaCf6Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;954&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/terrastruct/d2&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;1.2 艰难选择：choiceof.dev&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;主语言：TypeScript&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;New&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 开发人员日常面对着非常艰难的选择，可能就是技术选型，当然也可能是简单的如何提交代码。choiceof.dev 给出了形形色色同开发相关的选项，有复杂的也有简单的。比如，下图如何提交代码，强制提交的占了 64%。&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/bdebon/choiceof.dev&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4864652805021577&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX0jb8Aa0TpLF462c2yyAibJvChibTUuPPhicGnjHQebqAxo8ibDTGGNxRIMA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2549&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;2. GitHub Trending 周榜&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.1 轻松监控网络流量：sniffnet&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本周 star 增长数：900+&lt;strong&gt;，&lt;/strong&gt;主语言：Rust&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;New&lt;/span&gt;&lt;/code&gt;&lt;span&gt; 一个跨平台的网络流量监控工具，可快速、直观查看流量变化。&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/GyulyVGC/sniffnet&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX0R3NPFvBzkM9BDBba8dsCLMYWFaLWjJCDrsic6MyQ5GAgxzbyKy5xyyQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;800&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.2 音频转文本：buzz&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本周 star 增长数：550+&lt;strong&gt;，&lt;/strong&gt;主语言：Python&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;转换音频为文本的工具，支持麦克风实时录入转文字，也支持导入已有音频文件。文本可以导出为 TXT、SRT、VTT 格式。&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/chidiwilliams/buzz&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.525&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX01r0gphzbuibN12E0eMHrU1Vjy3YcvVHKzwBycNISoOKlUau0WvZ8NQQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;2400&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.3 高颜值备忘录：memos&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本周 star 增长数：1,850+&lt;strong&gt;，&lt;/strong&gt;主语言：TypeScript&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;具备知识管理能力的备忘中心，可多人协作。特性：&lt;/span&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;支持自托管，秒拉起来一个 Docker 应用；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;支持 Markdown 语法；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;同组内成员协作；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;自服务的 RESTful API；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/usememos/memos&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7193426042983565&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX0gP2AZUIKUgYjvkhzry8XYvMpCONvJKDQHuBSEgStrtibpBARXkEr0pw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1582&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.4 研发小抄：cheat.sh&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本周 star 增长数：1,350+&lt;strong&gt;，&lt;/strong&gt;主语言：Python&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;非必要不小抄，cheat.sh 具有理想小抄的一切特性：简洁、快速、全面、低调、可辅助学习。它能在 100ms 内搜刮完 Stack Overflow 等网站，并返回你所需要的答案。支持 curl / 浏览器 / 编辑器交互。&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/chubin/cheat.sh&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.7796875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX0SzlbyMWV49HOufA5mXiaEdewjdHb5eDO6kuhEIibejCLOy3iaFQlRhMxw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;640&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;2.5 API 流量查看器：kubeshark&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;本周 star 增长数：900+&lt;strong&gt;，&lt;/strong&gt;主语言：Golang&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;作为 K8s 的 API 流量查看器，kubeshark 支持对 K8s 所有集群的 API 流量和负载进行监控。&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;GitHub 地址→https://github.com/kubeshark/kubeshark&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6221739130434782&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/xBgIbW1vdNMhKibftPWrpRyZkzicQysMX07qKN20aIyMku1OwBWMb1T50ZCD25AOqSx280nF2kwiayXMibWqDDvbMg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2300&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;3. 往期回顾&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;往期回顾：&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;以上为 2022 年第 47 个工作周的 GitHub Trending 🎉如果你 Pick 其他好玩、实用的 GitHub 项目，记得来 HelloGitHub issue 区和我们分享下哟 🌝&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;最后，记得你在本文留言区留下你想看的主题 Repo（限公众号），例如：AI 换头。👀 和之前的送书活动类似，留言点赞 Top3 的小伙伴(&lt;span&gt;棒&lt;/span&gt;），小鱼干会努力去找 Repo 的^^&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;HelloGitHub 交流群现已全面开放，添加微信号：HelloGitHub001 为好友入群，可同前端、Java、Go 等各界大佬谈笑风生、切磋技术~&lt;/p&gt;&lt;/blockquote&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>8ad4c93f14cdf5cdd0a0bcad63c30430</guid>
<title>10 分钟了解 Pulsar：针对 Kafka 用户的指南</title>
<link>https://toutiao.io/k/nl3fjja</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;blockquote&gt;&lt;p&gt;本文翻译自 StreamNative 博客《Understanding Pulsar in 10 Minutes: A Guide for Kafka Users》，作者 Elliot West，StreamNative 软件工程师。本文由 StreamNative 组织翻译。&lt;/p&gt;&lt;h1&gt;译者简介&lt;/h1&gt;&lt;p&gt;王中兴，社区昵称 AlphaWang，就职于 eBay 消息中间件。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;本文将结合你现有的 Apache Kafka 知识来带你入门 &lt;span&gt;Apache Pulsar&lt;sup&gt;[1]&lt;/sup&gt;&lt;/span&gt;。我们将展示 Apache Kafka 的基本概念是如何映射到 Apache Pulsar 中的，这样你就能够通过已有的 Kafka 知识快速上手 Pulsar 中类似的使用场景。&lt;/p&gt;&lt;p&gt;Apache Pulsar 为成熟的 &lt;span&gt;Apache Kafka&lt;sup&gt;[2]&lt;/sup&gt;&lt;/span&gt; 生态提供了一个非常有吸引力的替代选择。Pulsar 中的差异化功能及架构可以克服 Kafka 中的种种限制。虽然 Kafka 和 Pulsar 都是高度可扩展以及持久化的分布式事件流平台，但是它们又有许多不同之处。例如，Pulsar 可以提供灵活的订阅、统一的流和消息、以及分离存储等等。&lt;/p&gt;&lt;p&gt;我有幸使用过 Apache Kafka 许多年，将其作为企业级平台提供给数据科学家、工程师和分析师使用。因此，我遇见过多种多样的 Kafka 使用场景，并接触过 Kafka 生态系统的多个方面。当我加入 &lt;span&gt;StreamNative&lt;sup&gt;[3]&lt;/sup&gt;&lt;/span&gt; 团队并使用 Pulsar 时，我想看看我的 Kafka 经验在 Pulsar 环境下会是什么样子。本文的阅读前提是你对 Kafka 已经有一定的理解，因为我不会从头开始讲解诸如主题等基本概念。本文不会对比平台的功能，而是专注于从生产者和消费者的角度讲解 Pulsar 如何实现与 Kafka 类似的功能。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;注：本文不会讨论 Pulsar 的 Kafka 插件协议（&lt;span&gt;KoP&lt;sup&gt;[4]&lt;/sup&gt;&lt;/span&gt;），KoP 将 Pulsar 封装起来，直接使用 Broker 的资源使现有的 Kafka 客户端和 Pulsar 进行交互，使得客户端就好像是在和 Kafka Broker 交互一样。&lt;/p&gt;&lt;/blockquote&gt;&lt;h1&gt;主题&lt;/h1&gt;&lt;p&gt;让我们先从主题开始，因为主题是 Kafka 和 Pulsar 中最基本的概念。你可以把 Pulsar 主题看作是单个 Kafka 主题分区。这里你可能会对性能有疑问，因为多分区是 Kafka 横向扩展能力的原因所在。不过不用担心，Pulsar 在主题的基础上提供了一个类似的概念，即“&lt;span&gt;分区主题&lt;sup&gt;[5]&lt;/sup&gt;&lt;/span&gt;”。在分区主题中，一组 Pulsar 主题在逻辑上被分成一组，实现与 Kafka 分区主题类似的功能。之所以存在这种区别，是因为 Pulsar 除了支持 Kafka 所针对的流式处理场景之外，还支持传统消息架构，而非分区主题是传统消息架构中的基本组件。由于我们关注的是 Kafka 使用场景，因此在下文中我们假设主题一词表示 Pulsar 分区主题，或者说 Kafka 主题。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;PulsarAdmin admin = ...;&lt;br/&gt;admin.topics().createPartitionedTopic(topic, partitions);&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;主题保留策略&lt;/h2&gt;&lt;p&gt;与 Kafka 相比，Pulsar 在消息生命周期方面拥有更大的灵活性。默认情况下，Pulsar 会永远保留所有未确认消息，并立即删除已确认消息。当然，&lt;span&gt;这两个行为&lt;sup&gt;[6]&lt;/sup&gt;&lt;/span&gt;均可调整，可以通过设置消息保留时间来保留已确认消息，通过设置消息过期时间来清除未确认消息。&lt;/p&gt;&lt;p&gt;而 Kafka 的保留策略则不关心消费者活动，消息是被持久化还是被清除完全与消费者是否消费过无关。用户也许不希望在 Pulsar 中复制 Kafka 的这种行为，因为这样一来消息保留策略的灵活性就更小了。不过为了学习的目的，我们还是来看看如何实现这一点。首先，我们来针对被所有消费者都确认过的消息设置保留策略。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;PulsarAdmin admin = ...;&lt;br/&gt;admin.topicPolicies().setRetention(&lt;br/&gt;        “topic-name”,&lt;br/&gt;        new RetentionPolicies(sizeInMins, sizeInMB)&lt;br/&gt;);&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后设置未确认消息的过期时间：&lt;/p&gt;&lt;pre&gt;&lt;code&gt;admin.topicPolicies().setMessageTTL(&lt;br/&gt;        “topic-name”,&lt;br/&gt;        messageTTLInSeconds&lt;br/&gt;);&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;主题压实&lt;/h2&gt;&lt;p&gt;与 Kafka 一样，Pulsar 也支持对主题进行压实（Compaction）。然而其内部实现略有不同，Pulsar 同时维护着未压实和已压实的数据。在压实过程中会产生一个新的已压实 Ledger，而原有的已压实 Ledger 会被丢弃。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;167&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.288135593220339&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4ibRRsibIGr0b63nbSiajjXbmeKHzhC0jfsYiaRbZa6Tcn4qZHSLEazoIR1d7QicjItyicp48dwFj5XdjPH2pUY0Ajzw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;708&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Pulsar 压实主题包含两个 Ledger&lt;/span&gt;&lt;/p&gt;&lt;p&gt;正因为同时存储了未压实和已压实数据，消费者可以根据使用场景决定消费任何一种数据，只需简单的配置即可。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;212&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.36666666666666664&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4ibRRsibIGr0b63nbSiajjXbmeKHzhC0jfs2HiaySUBW24AkA8J0YotuQ5PaFictfp3O8QrpibpYLpUVRWDtEFMPjA8g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;消费者可以选择消费已压实或未压实数据&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code&gt;Consumer&amp;lt;byte[]&amp;gt; compactedTopicConsumer = client.newConsumer()&lt;br/&gt;       .topic(&quot;some-compacted-topic&quot;)&lt;br/&gt;       ...&lt;br/&gt;       .readCompacted(true)&lt;br/&gt;       .subscribe();&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;Pulsar 也有类似于 Kafka 的消息删除语义。只需发布一个带有空值的墓碑消息，在下一个压实周期中就会删除对应的 key 值消息。除了基于 key 的删除，Kafka 还支持针对压实主题指定保留时间。例如，你可以指定无期限保留，始终保持所有 key 的最新消息，提供类似于键值存储的存储语义。或者，你也可以指定一个保留期，这样消息就会以 TTL 的方式过期。&lt;/p&gt;&lt;p&gt;Pulsar 在这方面的灵活性则稍差一些。要想从已压实 Ledger 中删除消息，就只能通过显式的基于 key 的删除，否则 Pulsar 默认保留所有 key 的最新消息。Pulsar 的压实主题也可以设置保留策略，但这只适用于未压实 Ledger，即未压实的消息。鉴于这一限制，在考虑 key 基数时必须格外小心。如果需要指定已压实 Ledger 的消息 TTL，那么就有必要通过手动流程来标记和删除消息。&lt;/p&gt;&lt;h2&gt;Schema&lt;/h2&gt;&lt;p&gt;在 Kafka 生态中，可以通过 Confluent Schema 注册表以及生产者/消费者 SerDes 来实现对消息的 Schema 验证。应用程序开发人员可以对客户端进行配置，让客户端与注册表服务集成并能够发现和发布其 Schema。通过适当的配置，客户端可以对发布的消息进行验证。&lt;/p&gt;&lt;p&gt;Pulsar 也有类似的功能，即&lt;span&gt;服务器端 Schema 策略&lt;sup&gt;[7]&lt;/sup&gt;&lt;/span&gt;。但请注意，“服务器端”这个提法意味着 Schema 注册表功能是与 Pulsar Broker 集成的，而不是解耦的第三方服务。如此一来，这种集成会直接体现在 Pulsar 客户端 API 中，因此不需要额外配置 Schema 注册表端点（Endpoint）、SerDes 以及主题命名策略（Subject Name Strategy）。Pulsar 支持与 Kafka 相同的 Schema 类型（Avro、Protobuf 等）以及演化保证。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;Producer&amp;lt;User&amp;gt; producer = client.newProducer(JSONSchema.of(User.class))&lt;br/&gt;       .topic(topic)&lt;br/&gt;       .create();&lt;br/&gt;User user = new User(&quot;Tom&quot;, 28);&lt;br/&gt;producer.send(user);&lt;/code&gt;&lt;/pre&gt;&lt;h1&gt;生产者&lt;/h1&gt;&lt;p&gt;多个生产者可以同时连接到 Kafka 主题并向其发送消息。Pulsar 也提供这种主题访问语义，使用默认的 &lt;code&gt;Shared&lt;/code&gt; 生产者&lt;span&gt;访问模式&lt;sup&gt;[8]&lt;/sup&gt;&lt;/span&gt;即可。因此，可以预期对于大多数使用场景，我们不需要额外的操作即可达到同样的效果。请注意，虽然单个 Kafka 生产者实例可以写入多个主题，但 Pulsar 的习惯做法是每个主题一个生产者实例。&lt;/p&gt;&lt;h2&gt;分区&lt;/h2&gt;&lt;p&gt;分区是生产者在主题的各个分区之间分发消息的过程。在 Kafka 中，我们可以通过在每个消息上设置一个 key 并为生产客户端提供一个&lt;span&gt;分区器&lt;sup&gt;[9]&lt;/sup&gt;&lt;/span&gt;来控制消息分发。Pulsar 采用了非常类似的方法，但其术语略有不同。在 Pulsar 中，我们也可以通过设置消息的 key 来指导分区，不过 Pulsar 的消息 key 必须是字符串类型，而 Kafka 则支持 &lt;code&gt;byte[]&lt;/code&gt; 类型。另外，可以通过配置 Producer 客户端的 &lt;span&gt;MessageRoutingMode&lt;sup&gt;[10]&lt;/sup&gt;&lt;/span&gt; 来进一步控制分区。Pulsar 的默认路由模式是 &lt;code&gt;RoundRobinPartition&lt;/code&gt;，使用消息 key 的哈希值来将消息分配到分区，而 round-robin 模式可以分配没有 key 的消息。比较方便的一点是，这些分区语义与 Kafka 的默认分区器相同，因此可以预期对于大多数使用场景，我们不需要额外的操作即可达到同样的效果。此外，对于自定义行为，Pulsar 的路由模式提供了与 Kafka 分区器相同的灵活性。&lt;/p&gt;&lt;h2&gt;副本&lt;/h2&gt;&lt;p&gt;与 Kafka 一样，Apache Pulsar 可以为接收到的消息保存多个副本，实际上 Pulsar 在这方面还提供了一些有趣的灵活性。与 Kafka 不同的是，Pulsar 的消息存储与 Broker 分离，即不受存储位置的限制。在实践中这意味着我们可以独立地设置消息副本的数量和存储节点的数量。Kafka 分区副本的消息只能写入特定的节点，而 Pulsar 的消息则分布在一组 Bookie（又称“Ensemble”）上。Jack Vanlightly 在他的&lt;span&gt;博客&lt;sup&gt;[11]&lt;/sup&gt;&lt;/span&gt;中生动地描述了这一点：“Kafka 主题就像一根根 Toblerone 巧克力棒……而 Pulsar 主题就像气体，可以自由膨胀充满可用的空间”。请看下面的例子，在 5 个节点的 Pulsar 和 Kafka 集群中保存消息 &lt;code&gt;M1-M3&lt;/code&gt;，副本数量为 3。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;381&quot; data-backw=&quot;502&quot; data-ratio=&quot;0.7589641434262948&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4ibRRsibIGr0b63nbSiajjXbmeKHzhC0jfsiaic9LOG4tx9GibHz8Oy4ERZbj7qrsv2HUJV6yPpMZzswZ8a51YZKu61A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;502&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;本地消息持久化与分离消息持久化&lt;/span&gt;&lt;/p&gt;&lt;p&gt;讲到副本，就不得不提副本故障，这是 Kafka 的痛点之一。你可能会想如果失去一个 Bookie 会怎么样？对集群有什么影响？可以确定的是，这种情况下集群需要拷贝副本不足的数据，但与 Kafka 不同，Pulsar 的影响后果更小。重要的是我们可以继续写入新数据，并保持所需的持久性；这是因为 Pulsar 的分区存储是高度分布式的，而 Kafka 则需要完整地同步分区数据才行。&lt;/p&gt;&lt;h2&gt;消息确认&lt;/h2&gt;&lt;p&gt;Kafka 生产者发送消息时可能会被阻塞，直到收到最低数量的 ACK，这样可以确信所生产的消息已被成功持久化到一定数量的副本中。Pulsar 也是如此，但也有一些差异。在 Kafka 中，生产者需要告诉 Broker 它需要多少个 ACK。因此，同一主题的不同生产者可能会向 Broker 请求不同数量的 ACK。在 Pulsar 中，ACK 由负责持久化消息的 Bookie 请求，而不是 Broker。此外，ACK 的数量也不由生产者指定。相反，它在主题级别上指定，直到达到所需的 ACK 数量前，任何同步生产者都会被阻塞。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;PulsarAdmin admin = ...;&lt;br/&gt;admin.topicPolicies().setPersistence(topic, new PersistencePolicies(&lt;br/&gt;        nodes,&lt;br/&gt;        replicas,&lt;br/&gt;        acks,&lt;br/&gt;        0.0&lt;br/&gt;));&lt;/code&gt;&lt;/pre&gt;&lt;h2&gt;最小 ISR（In-Sync Replica）&lt;/h2&gt;&lt;p&gt;在 Pulsar 中要想设置与 Kafka 等价的 ACK 值比较复杂，因为 Kafka 的 &lt;code&gt;all&lt;/code&gt; ACK 设置、集群范围内的 &lt;code&gt;min.insync.replicas&lt;/code&gt; 设置、以及 Kafka 主题的副本数量会相互影响。生产者的 &lt;code&gt;all ACKs&lt;/code&gt; 设置引入了不确定性；实际的 ACK 数量取决于当时的 ISR 数量。Kafka 生产者实际得到的 ACK 数量将介于 &lt;code&gt;min.insync.replicas&lt;/code&gt; 的值和请求的 ACK 数量之间。&lt;/p&gt;&lt;h1&gt;消费者&lt;/h1&gt;&lt;p&gt;订阅类型决定着主题消费者的行为。订阅独立于主题，多个消费者可同时应用不同的消费语义。Pulsar 消息可以被单条确认，也可以不按顺序确认，以支持不同的消息场景。&lt;/p&gt;&lt;h2&gt;消费者组&lt;/h2&gt;&lt;p&gt;我们可以通过使用特定的 Pulsar 订阅类型来实现类似 Kafka 消费者组的功能。具体来说，我们可以创建订阅类型为&lt;span&gt;灾备（Failover）&lt;sup&gt;[12]&lt;/sup&gt;&lt;/span&gt;的&lt;span&gt;持久化（Durable）&lt;sup&gt;[13]&lt;/sup&gt;&lt;/span&gt;订阅。持久性可以确保确认被持久化（很像 Kafka 的偏移量管理）；Pulsar 中的订阅默认是持久化的。灾备订阅类型确保只有一个消费者实例可以从分区中读取数据，消费者发生故障时，分区将会分配给另一个消费者实例。Pulsar 的默认订阅类型并不是灾备，因此必须明确指定。订阅一旦被创建，就必须由逻辑组中的所有消费者实例共享，分区将在这些实例之间进行分配。&lt;/p&gt;&lt;h2&gt;消费顺序&lt;/h2&gt;&lt;p&gt;在 Pulsar 中，&lt;span&gt;灾备&lt;sup&gt;[14]&lt;/sup&gt;&lt;/span&gt;订阅类型确保任何时间都只有一个消费者可以从分区中读取数据，因此可以在分区范围内保证有序，这一点与 Kafka 一样。&lt;/p&gt;&lt;h2&gt;偏移量与提交&lt;/h2&gt;&lt;p&gt;我将重点介绍 Kafka 中基于 Broker 的偏移量管理，因为这是最常见的使用场景。然而，Pulsar 消费者与 Kafka 一样也可以根据需要选择手动管理偏移量。一个关键区别是 Pulsar 还支持单条的、无序的消费者消息确认，这一点与传统消息队列一样。这与 Kafka 的偏移量形成鲜明对比，Kafka 只标记被消费的最后一条消息，这表示之前的所有消息都已被消费，也就是累积消息确认。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.4806201550387597&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/4ibRRsibIGr0b63nbSiajjXbmeKHzhC0jfs98z0IanwMAhSHLesXJGMShic6wkjvqJWjpaibqVxs6aWjlpicKLDpDdpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;387&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Pulsar 的单条消息确认与累积消息确认&lt;/span&gt;&lt;/p&gt;&lt;p&gt;幸运的是，Pulsar 的消费者 API 中包含了与 Kafka 等价的操作，也支持&lt;span&gt;累积确认&lt;sup&gt;[15]&lt;/sup&gt;&lt;/span&gt;当前消息及其之前的所有消息，而且你可以选择同步或异步地执行此操作。最终，其语义等同于 Kafka 的自动提交，因为 Pulsar 的 ACK 会定期刷新到 Broker 并被持久化。&lt;/p&gt;&lt;pre&gt;&lt;code&gt;try (PulsarClient client = PulsarClient.builder()&lt;br/&gt;      .serviceUrl(&quot;pulsar://localhost:6650&quot;)&lt;br/&gt;      .build());&lt;br/&gt;   Consumer&amp;lt;DomainObject&amp;gt; consumer = client.newConsumer(schema)&lt;br/&gt;           .subscriptionName(&quot;subscription&quot;)&lt;br/&gt;           .subscriptionType(SubscriptionType.Failover)&lt;br/&gt;           .topic(topic)&lt;br/&gt;           .subscribe()) {&lt;br/&gt;&lt;br/&gt;  while(true) {&lt;br/&gt;      Message&amp;lt;DomainObject&amp;gt; message = consumer.receive();&lt;br/&gt;      // Process message&lt;br/&gt;      consumer.acknowledgeCumulative(message);&lt;br/&gt;  }&lt;br/&gt;}&lt;/code&gt;&lt;/pre&gt;&lt;h1&gt;总结&lt;/h1&gt;&lt;p&gt;在结束本文之前，让我们总结一下上文所讲的 Pulsar 和 Kafka 概念之间的映射关系。请注意，每个 Kafka 概念通常都会转化为 Pulsar 概念里的一个特定配置。出现这种情况是因为 Pulsar 提供了高度灵活的原语，可以据此创建更广泛的消息架构，而不局限于 Kafka 所提供的流式使用场景。重要的是，Pulsar 可以根据需要复制 Kafka 的行为，这一点不足为奇，因为 Pulsar 甚至支持&lt;span&gt;与 Kafka 兼容的协议处理器&lt;sup&gt;[16]&lt;/sup&gt;&lt;/span&gt;。&lt;/p&gt;&lt;section&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;td&gt;Kafka&lt;/td&gt;&lt;td&gt;Pulsar&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;主题&lt;/td&gt;&lt;td&gt;&lt;span&gt;分区主题&lt;sup&gt;[17]&lt;/sup&gt;&lt;/span&gt;（持久化）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;主题分区&lt;/td&gt;&lt;td&gt;&lt;span&gt;主题&lt;sup&gt;[18]&lt;/sup&gt;&lt;/span&gt;（持久化）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;主题保留策略&lt;/td&gt;&lt;td&gt;&lt;span&gt;主题保留策略 + 消息过期策略&lt;sup&gt;[19]&lt;/sup&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;分区副本&lt;/td&gt;&lt;td&gt;主题持久化策略：&lt;span&gt;副本&lt;sup&gt;[20]&lt;/sup&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;压实主题&lt;/td&gt;&lt;td&gt;&lt;span&gt;主题压实&lt;sup&gt;[21]&lt;/sup&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;生产者&lt;/td&gt;&lt;td&gt;生产者（&lt;span&gt;accessMode = Shared&lt;sup&gt;[22]&lt;/sup&gt;&lt;/span&gt;）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;生产者 ACK&lt;/td&gt;&lt;td&gt;主题持久化策略：&lt;span&gt;ACK&lt;sup&gt;[23]&lt;/sup&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;消费者组&lt;/td&gt;&lt;td&gt;&lt;span&gt;订阅&lt;sup&gt;[24]&lt;/sup&gt;&lt;/span&gt;（&lt;span&gt;灾备&lt;sup&gt;[25]&lt;/sup&gt;&lt;/span&gt;类型的&lt;span&gt;持久化&lt;sup&gt;[26]&lt;/sup&gt;&lt;/span&gt;订阅）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;提交&lt;/td&gt;&lt;td&gt;&lt;span&gt;累积消息确认&lt;sup&gt;[27]&lt;/sup&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Schema 注册表&lt;/td&gt;&lt;td&gt;&lt;span&gt;服务器端 Schema 策略&lt;sup&gt;[28]&lt;/sup&gt;&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;h1&gt;推荐阅读&lt;/h1&gt;&lt;h4&gt;引用链接&lt;/h4&gt;&lt;p&gt;&lt;code&gt;[1]&lt;/code&gt; Apache Pulsar: &lt;em&gt;https://pulsar.apache.org/&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[2]&lt;/code&gt; Apache Kafka: &lt;em&gt;https://kafka.apache.org/&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[3]&lt;/code&gt; StreamNative: &lt;em&gt;https://streamnative.io/&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[4]&lt;/code&gt; KoP: &lt;em&gt;https://docs.streamnative.io/platform/v1.0.0/concepts/kop-concepts&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[5]&lt;/code&gt; 分区主题: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging/#partitioned-topics&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[6]&lt;/code&gt; 这两个行为: &lt;em&gt;https://pulsar.apache.org/docs/cookbooks-retention-expiry/&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[7]&lt;/code&gt; 服务器端 Schema 策略: &lt;em&gt;https://pulsar.apache.org/docs/next/schema-get-started#server-side-approach&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[8]&lt;/code&gt; 访问模式: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging/#access-mode&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[9]&lt;/code&gt; 分区器: &lt;em&gt;https://kafka.apache.org/24/javadoc/?org/apache/kafka/clients/producer/Partitioner.html&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[10]&lt;/code&gt; MessageRoutingMode: &lt;em&gt;https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/MessageRoutingMode&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[11]&lt;/code&gt; 博客: &lt;em&gt;https://jack-vanlightly.com/blog/2018/10/2/understanding-how-apache-pulsar-works&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[12]&lt;/code&gt; 灾备（Failover）: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging#failover&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[13]&lt;/code&gt; 持久化（Durable）: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging#what-is-a-subscription-mode&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[14]&lt;/code&gt; 灾备: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging#failover&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[15]&lt;/code&gt; 累积确认: &lt;em&gt;https://pulsar.incubator.apache.org/api/client/org/apache/pulsar/client/api/Consumer.html#acknowledgeCumulative-org.apache.pulsar.client.api.MessageId-&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[16]&lt;/code&gt; 与 Kafka 兼容的协议处理器: &lt;em&gt;https://docs.streamnative.io/platform/v1.0.0/concepts/kop-concepts&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[17]&lt;/code&gt; 分区主题: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging/#partitioned-topics&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[18]&lt;/code&gt; 主题: &lt;em&gt;https://pulsar.apache.org/docs/concepts-messaging#topics&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[19]&lt;/code&gt; 主题保留策略 + 消息过期策略: &lt;em&gt;https://pulsar.apache.org/docs/concepts-messaging#message-retention-and-expiry&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[20]&lt;/code&gt; 副本: &lt;em&gt;https://pulsar.apache.org/api/admin/org/apache/pulsar/common/policies/data/PersistencePolicies.html#getBookkeeperWriteQuorum--&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[21]&lt;/code&gt; 主题压实: &lt;em&gt;https://pulsar.apache.org/docs/cookbooks-compaction&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[22]&lt;/code&gt; accessMode = Shared: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging/#access-mode&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[23]&lt;/code&gt; ACK: &lt;em&gt;https://pulsar.apache.org/api/admin/org/apache/pulsar/common/policies/data/PersistencePolicies.html#getBookkeeperAckQuorum--&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[24]&lt;/code&gt; 订阅: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging#subscriptions&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[25]&lt;/code&gt; 灾备: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging#failover&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[26]&lt;/code&gt; 持久化: &lt;em&gt;https://pulsar.apache.org/docs/next/concepts-messaging#what-is-a-subscription-mode&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[27]&lt;/code&gt; 累积消息确认: &lt;em&gt;https://pulsar.incubator.apache.org/api/client/org/apache/pulsar/client/api/Consumer.html#acknowledgeCumulative-org.apache.pulsar.client.api.MessageId-&lt;/em&gt;&lt;br/&gt;&lt;code&gt;[28]&lt;/code&gt; 服务器端 Schema 策略: &lt;em&gt;https://pulsar.apache.org/docs/next/schema-get-started#server-side-approach&lt;/em&gt;&lt;/p&gt;&lt;hr/&gt;&lt;p&gt;&lt;span&gt;▼ &lt;/span&gt;&lt;span&gt;&lt;strong&gt;关注「&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;Apache Pulsar&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;」，获取干货与动态&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ▼&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-weui-theme=&quot;light&quot; data-id=&quot;MzUyMjkzMjA1Ng==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/4ibRRsibIGr0Y7icPiahxgXFRw8a0xAIxOhPqYtRDr0IRNpGRl2oSfGHuvkG9VtahW9thH3btBGXJu9y2dZgb3oOuQ/0?wx_fmt=png&quot; data-nickname=&quot;ApachePulsar&quot; data-alias=&quot;ApachePulsar&quot; data-signature=&quot;Apache 软件基金会顶级项目，下一代云原生分布式消息流平台，集消息、存储、轻量化函数式计算为一体，采用计算与存储分离架构设计，支持多租户、持久化存储、多机房跨区域数据复制，具有强一致性、高吞吐、低延时及高可扩展性等流数据存储特性。&quot; data-from=&quot;0&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;👇🏻 &lt;/span&gt;&lt;span&gt;&lt;strong&gt;加入 &lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;Apache Pulsar &lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;中文交流群&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/span&gt;&lt;span&gt;👇🏻&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-fileid=&quot;100006031&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/4ibRRsibIGr0ZSe03QyMcdYDoPThku7hjSJibg8nI1vtB8bde5jr1XSdz5iaPJDp7y1aOHupWAIQT1Qr3c1iafE5HXw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;430&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;点击「阅读原文」，查看 Apache Pulsar 资料精选&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>a11e38f0c722c5cf5047bb7820690467</guid>
<title>数据湖架构落地实战</title>
<link>https://toutiao.io/k/79hj8q6</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content js_underline_content             autoTypeSetting24psection&amp;#10;            &quot; id=&quot;js_content&quot;&gt;&lt;section data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzUyMDA4OTY3MQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/TwK74MzofXdtvHKjv7OHYYSTQ2QOVuyAia3LaU56kibxKLlX5Lo9bgeUfz1R4JDmdW7ZGYSLqsiaBl3nTOwOmFOFQ/0?wx_fmt=png&quot; data-nickname=&quot;浪尖聊大数据&quot; data-alias=&quot;bigdatatip&quot; data-signature=&quot;主要分享大数据框架，如spark，flink，kafka，hbase原理源码，同时会分享数据仓库，图计算等浪尖擅长领域。&quot; data-from=&quot;0&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;与传统的数据架构要求整合、面向主题、固定分层等特点不同，数据湖为企业全员独立参与数据运营和应用创新提供了极大的灵活性，并可优先确保数据的低时延、高质量和高可用，给运营商数据架构优化提供了很好的参考思路。&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;运营商数据架构的现状及挑战&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;从数据的系统归属上看，运营商数据可分为MSS（管理支撑系统）的面向人、财、物管理类数据，BSS（业务支撑系统）的面向客户和产品的营销及客户服务数据，OSS（运营支撑系统）的面向产品和网络的功能及运营服务数据，三者之间既相对松耦合，又有着紧密的协作关系，BSS和OSS的衔接点主要在产品及开通、排障服务，MSS和BSS、OSS的衔接点主要在参与人和资源。从数据分类来看，运营商的数据可分为作为企业核心的功能类实体数据、表示企业所有运营过程的活动类数据、体现内外部客户感知并围绕两大主线所产生的感知类指标数据以及与管理相关的人、财、物及流程数据。电信运营商数据范围示例如图1所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4563265306122449&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z41OKKvYQO6RknHBeVQUfqMpVVkpfibJibkmusWhLoazAY28RlCjJqsYuMWibgicQ4rO0k5TENVXasTcZlcgYmQnQg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1225&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;由于国内运营商以两级经营模式为主体，系统的集约化建设程度相对较低，以分域（M/B/O）、分省建设为主，即便是同类系统的数据，因为分31个省市建设，各省市的业务管理模式、数据模型标准、主数据等千差万别，跨省、跨域、跨系统的模型标准统一非常困难，即便通过数据副本的模式进行整合汇聚，也存在转换不专业和数据失真等问题。同时，域与域之间虽是松耦合的，但因为使用者和建设者的不同，相互之间会冗余存储对方数据，而建模和主数据又不同，跨域之间数据的关联整合非常复杂，跨域、跨省的端到端应用困难。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;运营商的数据还有一个显著的特点，就是与网络密切相关，网络运行数据和网络拓扑数据需要与网络保持实时一致，且数据量比较大，网络智能化后的实时数据应用需求也越来越多。通信网络是一张大网，即便引入云计算、虚拟化技术，依然有大量网络节点遍布31个省市，海量网络数据的实时采集、处理及应用也是运营商数据架构需要考虑的一个重要因素。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;国内运营商目前都不同程度地建立了自己的企业级大数据平台，有的分总部/省两级部署，支撑两级数据分析，统一全网的架构、来源、算法、规则，总部数据轻度汇总，按需采集汇聚高价值详单数据；有的采用1+N模式，建设总部和省互补协作平台，总部提供跨域数据和特定的大数据能力，作为N的省向总部提供本地化数据能力与自定义算法。电信运营商数据平台架构示例如图2所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.5306704707560628&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z41OKKvYQO6RknHBeVQUfqMpVVkpfibJibdI0gzt9Bq2ZMTjAVJOabiadlj2FIMctgoibkfPUGAkcMZREQCGE8pia1g/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1402&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;不管采用哪种模式，都不同程度地存在其下属各专业公司、各部门根据各自需要，或在生产系统内构建含大数据技术的混搭数据架构，或建设域内自用的大数据平台，因此有很多数据未进入企业级大数据平台，或数据平台的应用未达到预期。其原因可归结为如下几点&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;平台数据质量不高&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;平台数据来自于M/B/O的生产系统，而运营商分两级31省市建设的生产系统，不但数据模型、主数据标准不统一，业务管理模式的差异也很大。数据经过多次模型转换，存在严重失真的问题，且很难对数据质量问题追踪溯源。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;平台数据不够实时&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据经过多级采集汇聚，处理环节多，采集周期长。网络相关海量数据跨省传输，占用大量带宽，数据时延较大。数据平台目前只能以支撑离线的决策分析为主，难以满足SDN/NFV/云网络及物联网等实时/准实时数据应用需求。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;平台的灵活性不足&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据平台的建设以存储计算一体化架构为主，平台与应用紧耦合，多基于公共数据平台和整合后的数据支撑应用创新。对于新的数据整合、数据计算分析技术引入、平台扩容支撑等需求响应不灵活，导致数据平台应用不足。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;平台和应用互锁，形成恶性循环&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;企业级数据平台难以满足生产系统数据应用需求，生产系统就没有动力将自身数据和应用迁入数据平台，进而数据平台的数据质量和可用性越来越差。同时，还导致生产系统和各个大数据平台的数据重复采集、重复存储，且相互之间数据访问技术和管理壁垒严重，建设和维护成本大幅提高。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;数据湖方案的价值及可行性分析&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖推崇存储原生数据，对不同结构的数据统一存储，使不同数据有一致的存储方式，在使用时方便连接，真正解决数据集成问题。数据湖的本质是一种数据管理的思路，利用低成本技术来捕捉、提炼和探索大规模、长期的原始数据存储的方法与技术。数据湖可存储任何种类的数据，高质量、高效率地存储数据，更快速、更廉价地处理数据，将建模应用问题丢给最终开发者[9]。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖的方案应用可以带来如下几个显著的好处&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;规模大、成本低&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;全企业海量数据统一存储，采用开源技术，基于低成本硬件资源，建立和维护成本相比数据仓库低一个数量级。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;数据“原汁原味”&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖以原始形式保存数据，并在整个数据生命周期捕获对数据和上下文语义的更改，尤其便于进行合规性和内部审计。如果数据经历了转换、聚合和更新，将很难在需求出现时将数据拼凑在一起，而且几乎没有希望确定清晰出处。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;数据方便易用&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;结构化、非结构化、半结构化的数据都是原样加载和存储，以后再进行转换，开发和保存成本低，产生和使用之间时延小。客户、供应商和数据运营者不需要数据拥有者提供太多帮助即可整合数据，消除了数据共享的内部政治或技术障碍。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;应用按需建模&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖提供数据给灵活的、面向任务的结构化应用，详细的业务需求和艰苦的数据建模都不是数据湖的先决条件。数据湖给予最终用户最大的灵活度来处理数据，对于同一份原始数据，不同的用户可能有不同的理解。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;目前，大部分运营商采用传统的以数据为中心的处理架构（存储计算一体化，如主流MPP、Hive和分布式计算厂商产品），好处是计算效率高、技术成熟，缺点也很明显，如灵活性不足，使得数据应用适用于少数人，这也制约了原生数据提供者向平台提供的积极性，进而导致数据的质量、数据的全面性都得不到很好的保障。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;引入数据湖概念的一个显著特点就是存储和计算松耦合，可采用以计算为中心的处理模式（存储与计算分离，如Spark技术及AWS、阿里云等云服务提供商产品），使得运营商可以更加专注于数据的存储和管理，存储和计算不用相互制约，从而优先确保数据的高质量、低时延、高可用，并为数据应用的快速构建提供了极大的灵活性。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖按照成熟度可划分为4个阶段：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第一个阶段，应用程序独立建设，部分应用将数据提供给数据仓库，基于数据仓库构建分析应用；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第二个阶段，数据湖和数据仓库并存，应用程序向数据湖提供副本数据，基于数据湖开发分析型应用，数据仓库和应用也可从数据湖提取数据；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第三个阶段，新系统以数据湖为中心构建，应用通过数据湖交互彼此数据，数据湖成为数据架构的核心，数据仓库基于数据湖提供特定的应用需求，数据治理变得重要；&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;第四个阶段，所有新的应用均基于数据湖构建，数据湖成为弹性的分布式平台，数据的治理和安全需持续加强，支撑企业的数据运营和分析能力。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;电信运营商目前普遍处于第二个阶段向第三个阶段演进的过程中，在构建数据技术方案方面具备较好的基础条件。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;电信运营商数据湖建设思路及实施要点&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;调整现有分析型数据平台建设思路，将其数据与应用解耦，引入数据湖概念，强调原生数据入湖，并与全网生产系统模型和主数据标准化协同推进，兼顾层次化的传统数据架构和扁平化的数据湖架构的优点，SchemaonRead和SchemaonWrite并存，统一支撑企业实时、准实时和离线数据应用快速创新，是电信运营商实现以数据为中心IT架构转型的有效途径。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖作为运营商数据存储和访问的唯一出口，成为所有IT系统共享的基础设施，统一存储全企业IT和网络数据，通过开放架构支撑智慧运营，并可作为IT系统集约化演进的纽带。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;数据统一存储&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;统一存储MSS、BSS、OSS及网元平台的实时、历史、在线、离线数据，全网的原生数据只存储一份在逻辑统一的分布式数据湖内，原生数据与生产系统数据模型标准和主数据一致，新IT系统/网元平台的生产数据直接使用数据湖存储。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;数据统一管理&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;所有入湖数据的目录、元数据、数据应用及数据质量、数据标准、数据安全必须统一管理。数据模型标准和主数据动态维护，数据质量集中治理，原生系统的数据问题溯源处理，生产系统建设者全程参与数据管理，责任权利保持一致。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;数据统一标准&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;生产系统管理部门负责31省市系统模型和主数据的标准化；数据湖统一管理生产系统的数据模型及主数据；暂未进行标准化的生产系统数据模型，由对应系统的管理部门负责数据模型的转换和运营，协调推进生产系统数据标准进程。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;数据近源采集&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;提供数据统一采集、实时订阅分发框架，支撑实时/准实时数据、离线数据的采集。各网元/平台数据采集能力以组件方式纳入数据湖，分专业采集、预处理加工，海量实时数可靠近网络近源部署前置采集模块。非网络类数据（如BSS、MSS、OSS流程等），初期以副本采集方式汇聚入湖，远期直接以服务交互方式入湖。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;数据与应用分离&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据应用环境与数据存储环境分离，按应用计算的网络带宽需要就近部署。提供统一的服务化访问、小批量数据订阅、数据分析计算云平台环境。基于云平台环境，应用开发者可自行整合数据、构建应用，数据存储、数据整合、平台组件、数据应用间相互解耦，建设的进程不会相互制约。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;同时，建立全生命周期数据目录，统一标识各项数据，完善数据治理机制，管理数据湖数据的生产加工流程，对各项数据生成和使用过程进行跟踪记录，支撑数据的应用和溯源，是数据湖方案顺利实施的关键要素。并且还需要加强数据标准的全生命周期流程以及数据标准的元数据及数据质量问题收集、自动稽核、问题溯源、影响分析及跟踪处理等数据管理能力。可以采用爬虫的方式生成数据目录，在不影响数据所有者或用户的情况下自动生成，&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.6115214180206795&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z41OKKvYQO6RknHBeVQUfqMpVVkpfibJibWWHtDzZMulgFjPcgqgveGkiaic6ouxKFXZxqTdVMvazicpjePicqom7VqA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1354&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;决定数据湖能否顺利实施的因素有很多，包括数据湖涵盖哪些数据及如何分区存储、数据湖如何分布式部署、纷繁复杂的现有IT系统数据如何入湖、数据和应用能否分离、数据湖与现有各类数据平台的演进关系等。当然，更重要的是数据管理思维的转变，这是一切的基础。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;针对运营商数据湖的实施，提出如下4个方面的关键要点及建议。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;要点1：数据湖分区&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖逻辑上可划分为&lt;strong&gt;生产数据区、原生数据区、整合数据区、汇总数据区&lt;/strong&gt;4个大的存储区域。数据湖的应用可基于PaaS平台按需使用各个区的数据，4个区的数据目录、元数据、数据加工处理流程及数据应用需要统一管理、维护和治理。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;生产数据区&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;M/B/O系统生产数据的存储区域，涵盖实时交易型数据、实时/准实时网络采集数据等，可以是关系型和非关系型混搭的存储结构，各生产系统需要进行架构优化，数据与应用分层解耦，将数据存入生产数据区。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;原生数据区&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;将各系统的生产数据直接写入数据湖原生数据区，以非关系型数据格式存储生产系统数据，方便各数据应用使用，生产数据和原生数据模型标准、主数据一致。原生数据区涵盖企业的任何内容，无限接近企业各系统、部门的敏感信息。供数据湖科学家和技术人员访问使用。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;整合数据区&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;存储按照数据分析需求建模加工后的公用数据。模型从生产/原生数据模型派生而来，被业务和IT部门熟知，可供企业各种应用程序使用。原生数据区中依然有很多数据或属性没有被真正理解，并未完全包含在这个数据区的模型中。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;汇总数据区&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;存储按需求分析汇总的结果数据，一般可存储在关系型数据存储内，便于数据服务的快速加载呈现。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖生产数据区和原生数据区作为最重要的数据分区，是数据湖内数据整合和汇总的源头数据，数据质量必须得到保障。另外，数据湖虽不鼓励应用特定模型，但也可划分特定数据区给私有应用使用，提供快速构建数据应用的途径，这些应用获取数据湖数据且具有数据处理能力，数据湖构建初期，可将已有业务应用数据导入数据湖特定数据区中。电信运营商数据湖数据分区示例如图4所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.5089820359281437&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z41OKKvYQO6RknHBeVQUfqMpVVkpfibJibfaQAnRAiaLZRp4vkB8XLt2vK5qCXicedRmLbG9PE7NlpHicLDJkbJ1epg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1336&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;要点2：数据湖部署&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖部署方案的设计需要考虑如下要素：&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;现有BSS/OSS系统分省/总部两级建设和维护，源系统模型属地管理；网络/平台数据量大，且贴近网络建设归属地，属地应用占比大；&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;M/B/O及网络/平台之间数据松耦合，主要通过企业主数据进行衔接。数据湖原生数据区和生产数据区与数据源系统就近分布式部署（总部1+省市31模式）。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;生产数据云节点由生产系统按需分区、分片部署，即支撑生产应用交易处理，也支撑实时网络数据采集和应用。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;原生数据云节点与生产数据云节点就近、集中部署，靠近数据归属地，数据实时从生产数据云节点写入原生数据云节点。原生数据云节点可再细分为核心数据区（如客户、销售品、产品、服务、资源、组织、人员等）、BSS数据区、OSS数据区、MSS数据区、网络/平台数据区。&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;span&gt;数据湖整合、汇总数据云节点采用1+N模式部署，统一管理、控制和调度节点环境，兼顾全网统一和个性化应用需求，数据科学家逐步探索和建模数据，开放数据应用。1+N模式中的“1”支撑全网应用，“N”支撑省内应用，并作为创新基地，有条件、数据量大、应用丰富的省可选择建设N分区。分区节点内可按照应用范围（全局需求、特定需求）、地域归属（集团、省）、数据层次（整合、汇总）、数据分级（普通、密级）等进一步分区存储。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;电信运营商数据湖部署方案示例如图5所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.44459738472126636&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z41OKKvYQO6RknHBeVQUfqMpVVkpfibJibfaAz64aP1AsRg8wWwj3jDib3EJ79nhneIEoAJqjgQCzoOKCjkeiarcFg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1453&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;要点3：IT系统数据入湖&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖的建设不可能一蹴而就，需要根据运营商IT系统建设情况分别采用不同策略进行数据入湖演进。电信运营商IT系统入湖方案示例如图6所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.41064388961892245&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z41OKKvYQO6RknHBeVQUfqMpVVkpfibJibP5SxuEUkjnkqPanS1icxDgP6Mtlnp0Zb6o9ichiaxqnT88olw3RsfEJYQ/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1522&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;方式一：数据同步方式。适合交易型系统已存在、数据模型和主数据已全网统一的场景，生产数据直接同步写入原生数据区，如BSS、MSS、传统OSS。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;方式二：数据同步/转换方式。适合交易型系统已存在、数据模型和主数据并未全网统一的场景，如BSS、MSS、传统OSS。将非标准生产数据写入原生数据区，支撑省内整合汇总应用及集团标准的宽表需求；将非标准生产数据按全网统一标准转换，提供给全网数据整合汇总及数据治理使用。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;方式三：数据正本方式。适合交易型系统新建模式，如新一代OSS资源、编排、告警等。正本数据写入生产数据区，统一模型和主数据标准，基于交易型PaaS平台完成应用；生产数据区数据直接写入原生数据区。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;方式四：采集入库方式。适合网络监控分析型系统新建模式，如新一代OSS的网络采集数据、资源拓扑、深度分组检测（DPI）数据等。数据采集文件、流数据等暂存在生产数据区；写入原生数据区后，生产数据区不再保留；统一原生数据模型和主数据标准，基于实时和非实时PaaS平台完成分析型应用。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;要&lt;/span&gt;点4：数据湖数据与应用分离&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖通过数据服务平台、数据共享平台及统一数据应用环境按需支持交易类、实时监控类、分析类应用。数据增、删、改、查服务统一部署在数据服务平台上，供交易类应用访问调用；通过订阅需要监控的数据，由数据共享平台将数据实时分发给监控类应用使用；数据的加工整合、分析应用、海量搜索、人工智能等应用均可部署在应用环境内，按需动态加载并临时存储数据，结果写回到数据湖存储环境，以服务方式启动任务和查询结果数据。其中，应用环境公共组件随着技术的更新不断叠加，逐渐平台化共享，暂时无法满足应用需求的可由应用在统一环境内部署组件及加载数据。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖应用加载数据的方式可分为实时增量加载、准实时增量/全量加载、离线批量加载等，数据可按需全量或增量短期加载。对于应用和数据无法解耦的组件（如Hive、MPP等），按需复制数据，以空间换数据管理和应用的灵活性；对于应用和数据可以有效解耦的组件（如Spark等），可以按需动态、实时加载数据。应用组件逐渐由与数据紧耦合的组件向与数据松耦合的组件演进。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖采用读写分离、应用计算与数据存储分离、关系数据与非关系数据存储并存的模式，并提供数据存储节点分布式部署、服务化访问及统一数据加载、共享及分发能力，降低数据湖数据存储访问负载，提升数据的可用性及数据访问效率。由数据湖提供数据的统一迁移，包括主从库的复制、关系库到非关系库的数据转换等；提供统一的关系和非关系库数据访问及分布式数据路由以及数据共享开放和订阅分发管理框架，实现高效的数据访问；提供统一的数据应用环境管理，包括配额管理、数据访问权限管理、数据回写节点分配管理等，独立部署分析计算类应用，分析计算节点与数据湖数据存储节点分离；提供统一的分布式服务运行框架，基于服务调用实现交易类增、删、改、查应用的数据访问，避免直接操作数据。电信运营商数据湖应用方案示例如图7所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;578&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;225&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.3888888888888889&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/DMP9YVibia1dS9ziaSloOhVib5cevyIJWPDKffbPbdXccibSDq8XONvZKHwhcDlt7LCcaHawX0Mn5sGeb8mqw0otoyA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;要点5：数据湖数据统一管理&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;数据湖的实施，需要实现模型和主数据标准的动态维护以及数据的集中治理，避免数据湖成为数据墓地。而数据来源众多，数据管理需要依赖于多方的密切合作以及数据标准管理、目录/元数据管理、应用/服务管理、质量等管理及海量数据探索分析等高效的管理工具。电信运营商数据湖管理体系示例如图8所示。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;578&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;278&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.48&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/DMP9YVibia1dS9ziaSloOhVib5cevyIJWPDKC9P8D7SPhBtLQhGXoksqdlcoK1jhXJ3hwqTSPl5icEltbcBVumQ4jSw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;电信运营商数据涉及系统众多、关系复杂，没有任何一个独立的团队能够通晓所有的数据模型和关联关系，因此需要企业数据管理团队与专业数据管理团队分工合作，共同完成数据模型标准/主数据的管理及数据集中治理。建立横纵向一体化的数据管理体系，明确企业数据管理和原生数据部门职责分工，固化数据管理流程制度。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;企业数据管理团队负责统筹标准和主数据管理及数据治理工作，负责数据建模挖掘和跨专业数据治理协作，负责为业务部门和应用开发者提供数据建模和平台技术支持；专业数据管理团队负责建立专业数据的模型标准和管理主数据，识别数据问题及跟踪处理；数据湖应用开发者负责提出数据需求，按需整合和构建应用，反馈数据问题，评估数据变更影响。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;另外，作为企业最核心的数据资产，其全生命周期的安全管理非常重要。需要针对数据采集、数据存储（生产数据、原生数据、整合数据、汇总数据）、数据应用、数据服务、数据分发共享等环节构建端到端的安全管控体系。对涉及用户行为特征及关键信息的敏感数据进行统一处理，脱敏后提供给应用使用；不管是敏感数据还是非敏感数据，所有数据的直接访问均在数据湖的管理范围内进行，具体措施包括数据应用环境、服务访问环境、共享分发环境、数据存储环境统一管控，需要经过统一的对象和属性等的鉴权才能访问数据，数据不出数据湖（即数据访问不出台），只能使用服务化方式或经过鉴权认证的数据共享分发方式进行数据访问。同时需要对大数据安全事件具备闭环管控能力，增强数据安全事件快速分析能力，提升安全事件发&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;生后的应对处置效率。&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.6764091858037579&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/TwK74MzofXd78W49nBaME6TkGc8gv8DBzMJvytIYy9Dibfsl7qq5ibATfYh9BN1xQO5qU1OejK3Gic6dfl8iafXwGg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;958&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;mp-style-type data-value=&quot;3&quot;/&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>