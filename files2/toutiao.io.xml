<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>4fc9361213d8ba43b7310754695bd4c9</guid>
<title>[æ¨è] é«˜æ€§èƒ½ç½‘å…³è®¾è®¡å®è·µ</title>
<link>https://toutiao.io/k/7579qvt</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;å‰è¨€&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¹‹å‰çš„&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzI5MTU1MzM3MQ==&amp;amp;mid=2247483977&amp;amp;idx=1&amp;amp;sn=9f932e774b680d06d105f495b96bb933&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;é«˜æ€§èƒ½çŸ­é“¾è®¾è®¡&lt;/a&gt;ä¸€æ–‡é¢‡å—å¤§å®¶å¥½è¯„ï¼Œå…±è¢«è½¬è½½ &lt;strong&gt;ã€Œ47ã€&lt;/strong&gt; æ¬¡ï¼Œå—å® è‹¥æƒŠï¼Œåœ¨æ­¤æ„Ÿè°¢å¤§å®¶çš„è®¤å¯ï¼åœ¨æ–‡æœ«ç®€å•æäº†ä¸€ä¸‹ OpenRestyï¼Œä¸€äº›è¯»è€…æ¯”è¾ƒæ„Ÿå…´è¶£ï¼Œåˆšå¥½æˆ‘ä»¬æ¥å…¥å±‚ç½‘å…³ä¹Ÿæ˜¯ç”¨çš„ OpenRestyï¼Œæ‰€ä»¥å¸Œæœ›é€šè¿‡å¯¹ç½‘å…³è®¾è®¡çš„ä»‹ç»æ¥ç®€å•æ€»ç»“ä¸€ä¸‹ OpenResty çš„ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œäº‰å–è®©å¤§å®¶å¯¹ OpenResty è¿™ç§é«˜æ€§èƒ½ Web å¹³å°æœ‰ä¸€ä¸ªæ¯”è¾ƒå…¨é¢çš„äº†è§£ã€‚æœ¬æ–‡ä¼šä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢æ¥è®²è§£ã€‚&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;ç½‘å…³çš„ä½œç”¨&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ¥å…¥å±‚ç½‘å…³æ¶æ„è®¾è®¡ä¸å®ç°&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æŠ€æœ¯é€‰å‹&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;OpenResty åŸç†å‰–æ&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;ç½‘å…³çš„ä½œç”¨&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç½‘å…³ä½œä¸ºæ‰€æœ‰è¯·æ±‚çš„æµé‡å…¥å£ï¼Œä¸»è¦æ‰¿æ‹…ç€å®‰å…¨ï¼Œé™æµï¼Œç†”æ–­é™çº§ï¼Œç›‘æ§ï¼Œæ—¥å¿—ï¼Œé£æ§ï¼Œé‰´æƒç­‰åŠŸèƒ½ï¼Œç½‘å…³ä¸»è¦æœ‰ä¸¤ç§ç±»å‹&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;ä¸€ç§æ˜¯æ¥å…¥å±‚ç½‘å…³ï¼ˆaccess gatewayï¼‰ï¼Œä¸»è¦è´Ÿè´£è·¯ç”±ï¼ŒWAFï¼ˆé˜²æ­¢SQL Injection, XSS, è·¯å¾„éå†, çªƒå–æ•æ„Ÿæ•°æ®,CCæ”»å‡»ç­‰ï¼‰ï¼Œé™æµï¼Œæ—¥å¿—ï¼Œç¼“å­˜ç­‰ï¼Œè¿™ä¸€å±‚çš„ç½‘å…³ä¸»è¦æ‰¿è½½ç€å°†è¯·æ±‚è·¯ç”±åˆ°å„ä¸ªåº”ç”¨å±‚ç½‘å…³çš„åŠŸèƒ½&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;å¦ä¸€ç§æ˜¯åº”ç”¨å±‚ç½‘å…³ï¼Œæ¯”å¦‚ç°åœ¨æµè¡Œçš„å¾®æœåŠ¡ï¼Œå„ä¸ªæœåŠ¡å¯èƒ½æ˜¯ç”¨ä¸åŒçš„è¯­è¨€å†™çš„ï¼Œå¦‚ PHPï¼ŒJava ç­‰ï¼Œé‚£ä¹ˆæ¥å…¥å±‚å°±è¦å°†è¯·æ±‚è·¯ç”±åˆ°ç›¸åº”çš„åº”ç”¨å±‚é›†ç¾¤ï¼Œå†ç”±ç›¸åº”çš„åº”ç”¨å±‚ç½‘å…³è¿›è¡Œé‰´æƒç­‰å¤„ç†ï¼Œå¤„ç†å®Œä¹‹åå†è°ƒç”¨ç›¸åº”çš„å¾®æœåŠ¡è¿›è¡Œå¤„ç†ï¼Œåº”ç”¨å±‚ç½‘å…³ä¹Ÿèµ·ç€è·¯ç”±ï¼Œè¶…æ—¶ï¼Œé‡è¯•ï¼Œç†”æ–­ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç›®å‰å¸‚é¢ä¸Šæ¯”è¾ƒæµè¡Œçš„ç³»ç»Ÿæ¶æ„å¦‚ä¸‹&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.3899905571293673&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYR6XbHeLXs3z9UAOfdicwIMEvyI9uiakDWraUSILW291G6cZjO9LW5RPFQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1059&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥çœ‹åˆ°æ¥å…¥å±‚ç½‘å…³æ‰¿è½½ç€å…¬å¸çš„æ‰€æœ‰æµé‡ï¼Œå¯¹æ€§èƒ½æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œå®ƒçš„è®¾è®¡å†³å®šç€æ•´ä¸ªç³»ç»Ÿçš„ä¸Šé™ã€‚æ‰€ä»¥æˆ‘ä»¬ä»Šå¤©ä¸»è¦è°ˆè°ˆæ¥å…¥å±‚ç½‘å…³çš„è®¾è®¡ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æ¥å…¥å±‚ç½‘å…³æ¶æ„è®¾è®¡ä¸å®ç°&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é¦–å…ˆæˆ‘ä»¬è¦æ˜ç™½æ¥å…¥å±‚ç½‘å…³çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼š&lt;strong&gt;ã€Œæ ¹æ®è·¯ç”±è§„åˆ™å°†è¯·æ±‚åˆ†å‘åˆ°å¯¹åº”çš„åç«¯é›†ç¾¤ã€&lt;/strong&gt;ï¼Œæ‰€ä»¥è¦å®ç°å¦‚ä¸‹å‡ ä¸ªåŠŸèƒ½æ¨¡å‹ ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;1ã€ è·¯ç”±ï¼šæ ¹æ®è¯·æ±‚çš„ host, url ç­‰è§„åˆ™è½¬å‘åˆ°æŒ‡å®šçš„ä¸Šæ¸¸ï¼ˆç›¸åº”çš„åç«¯é›†ç¾¤ï¼‰
2ã€ è·¯ç”±ç­–ç•¥æ’ä»¶åŒ–ï¼šè¿™æ˜¯ç½‘å…³çš„&lt;strong&gt;ã€Œçµé­‚æ‰€åœ¨ã€&lt;/strong&gt;ï¼Œè·¯ç”±ä¸­ä¼šæœ‰èº«ä»½è®¤è¯ï¼Œé™æµé™é€Ÿï¼Œå®‰å…¨é˜²æŠ¤ï¼ˆå¦‚ IP é»‘åå•ï¼Œreferå¼‚å¸¸ï¼ŒUAå¼‚å¸¸ï¼Œéœ€ç¬¬ä¸€æ—¶é—´æ‹’ç»ï¼‰ç­‰è§„åˆ™ï¼Œè¿™äº›è§„åˆ™ä»¥æ’ä»¶çš„å½¢å¼äº’ç›¸ç»„åˆèµ·æ¥ä»¥ä¾¿åªå¯¹æŸä¸€ç±»çš„è¯·æ±‚ç”Ÿæ•ˆï¼Œæ¯ä¸ªæ’ä»¶éƒ½å³æ’å³ç”¨ï¼Œäº’ä¸å½±å“ï¼Œè¿™äº›æ’ä»¶åº”è¯¥æ˜¯&lt;strong&gt;ã€ŒåŠ¨æ€å¯é…ç½®ã€&lt;/strong&gt;çš„ï¼ŒåŠ¨æ€ç”Ÿæ•ˆçš„ï¼ˆæ— é¡»é‡å¯æœåŠ¡ï¼‰ï¼Œä¸ºå•¥è¦å¯åŠ¨æ€å¯é…ç½®å‘¢ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚å¯¹åº”çš„è·¯ç”±é€»è¾‘ï¼Œé™æµè§„åˆ™ï¼Œæœ€ç»ˆè¯·æ±‚çš„åç«¯é›†ç¾¤ç­‰è§„åˆ™æ˜¯ä¸ä¸€æ ·çš„&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;1.0770465489566614&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRlVRYaicH8DvefIeNYALbJYpiaaLTm6NBh5AicXaeozGHThVGh8P8PKBQg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;623&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚å›¾ç¤ºï¼Œä¸¤ä¸ªè¯·æ±‚å¯¹åº”çš„è·¯ç”±è§„åˆ™æ˜¯ä¸ä¸€æ ·çš„ï¼Œå®ƒä»¬å¯¹åº”çš„è·¯ç”±è§„åˆ™ï¼ˆé™æµï¼Œrewriteï¼‰ç­‰é€šè¿‡å„ä¸ªè§„åˆ™æ’ä»¶ç»„åˆåœ¨ä¸€èµ·ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå…‰ä¸¤ä¸ªè¯·æ±‚ url çš„è·¯ç”±è§„åˆ™å°±æœ‰æŒºå¤šçš„ï¼Œå¦‚æœä¸€ä¸ªç³»ç»Ÿå¤§åˆ°ä¸€å®šç¨‹åº¦ï¼Œurl ä¼šæœ‰ä¸å°‘ï¼Œå°±ä¼šæœ‰ä¸å°‘è§„åˆ™ï¼Œè¿™æ ·æ¯ä¸ªè¯·æ±‚çš„è§„åˆ™å°±å¿…é¡»&lt;strong&gt;ã€Œå¯é…ç½®åŒ–ã€&lt;/strong&gt;ï¼Œ&lt;strong&gt;ã€ŒåŠ¨æ€åŒ–ã€&lt;/strong&gt;ï¼Œæœ€å¥½èƒ½åœ¨ç®¡ç†ç«¯é›†ä¸­æ§åˆ¶ï¼Œç»Ÿä¸€ä¸‹å‘ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;3ã€åç«¯é›†ç¾¤çš„åŠ¨æ€å˜æ›´&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è·¯ç”±è§„åˆ™çš„åº”ç”¨æ˜¯ä¸ºäº†ç¡®å®šæŸä¸€ç±»è¯·æ±‚ç»è¿‡è¿™äº›è§„åˆ™åæœ€ç»ˆåˆ°è¾¾å“ªä¸€ä¸ªé›†ç¾¤ï¼Œè€Œæˆ‘ä»¬çŸ¥é“è¯·æ±‚è‚¯å®šæ˜¯è¦æ‰“åˆ°æŸä¸€å°é›†ç¾¤çš„ ip ä¸Šçš„ï¼Œè€Œæœºå™¨çš„æ‰©ç¼©å®¹å…¶å®æ˜¯æ¯”è¾ƒå¸¸è§çš„ï¼Œæ‰€ä»¥å¿…é¡»æ”¯æŒåŠ¨æ€å˜æ›´ï¼Œæ€»ä¸èƒ½æˆ‘æ¯æ¬¡ä¸Šä¸‹çº¿æœºå™¨çš„æ—¶å€™éƒ½è¦é‡å¯ç³»ç»Ÿè®©å®ƒç”Ÿæ•ˆå§ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;4ã€ç›‘æ§ç»Ÿè®¡ï¼Œè¯·æ±‚é‡ã€é”™è¯¯ç‡ç»Ÿè®¡ç­‰ç­‰&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªæ¯”è¾ƒå¥½ç†è§£ï¼Œåœ¨æ¥å…¥å±‚ä½œæ‰€æœ‰æµé‡çš„è¯·æ±‚ï¼Œé”™è¯¯ç»Ÿè®¡ï¼Œä¾¿äºæ‰“ç‚¹ï¼Œå‘Šè­¦ï¼Œåˆ†æã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¦å®ç°è¿™äº›éœ€æ±‚å°±å¿…é¡»å¯¹æˆ‘ä»¬é‡‡ç”¨çš„æŠ€æœ¯ï¼šOpenResty æœ‰æ¯”è¾ƒè¯¦ç»†çš„äº†è§£ï¼Œæ‰€ä»¥ä¸‹æ–‡ä¼šç®€å•ä»‹ç»ä¸€ä¸‹ OpenResty çš„çŸ¥è¯†ç‚¹ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æŠ€æœ¯é€‰å‹&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ‰äººå¯èƒ½ç¬¬ä¸€çœ¼æƒ³åˆ°ç”¨ Nginx,æ²¡é”™ï¼Œç”±äº Nginx é‡‡ç”¨äº† epoll æ¨¡å‹ï¼ˆéé˜»å¡ IO æ¨¡å‹ï¼‰ï¼Œç¡®å®èƒ½æ»¡è¶³å¤§å¤šæ•°åœºæ™¯çš„éœ€æ±‚ï¼ˆç»è¿‡ä¼˜åŒ– 100 w + çš„å¹¶å‘æ•°ä¸æ˜¯é—®é¢˜ï¼‰ï¼Œä½†æ˜¯ Nginx æ›´é€‚åˆä½œä¸ºé™æ€çš„ Web æœåŠ¡å™¨ï¼Œå› ä¸ºå¯¹äº Nginx æ¥è¯´ï¼Œå¦‚æœå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œéƒ½éœ€è¦ä¿®æ”¹ç£ç›˜ä¸Šçš„é…ç½®ï¼Œç„¶åé‡æ–°åŠ è½½æ‰èƒ½ç”Ÿæ•ˆï¼Œå®ƒå¹¶æ²¡æœ‰æä¾› API æ¥æ§åˆ¶è¿è¡Œæ—¶çš„è¡Œä¸ºï¼Œè€Œå¦‚ä¸Šæ–‡æ‰€è¿°ï¼ŒåŠ¨æ€åŒ–æ˜¯æ¥å…¥å±‚ç½‘å…³éå¸¸é‡è¦çš„ä¸€ä¸ªåŠŸèƒ½ã€‚æ‰€ä»¥ç»è¿‡ä¸€ç•ªè°ƒç ”ï¼Œæˆ‘ä»¬é€‰æ‹©äº† OpenRestyï¼Œå•¥æ˜¯ OpenResty å‘¢ï¼Œæ¥çœ‹ä¸‹å®˜ç½‘çš„å®šä¹‰ï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â&lt;/span&gt;&lt;p&gt;OpenRestyÂ® æ˜¯ä¸€ä¸ªåŸºäº Nginx ä¸ Lua çš„é«˜æ€§èƒ½ Web å¹³å°ï¼Œå…¶å†…éƒ¨é›†æˆäº†å¤§é‡ç²¾è‰¯çš„ Lua åº“ã€ç¬¬ä¸‰æ–¹æ¨¡å—ä»¥åŠå¤§å¤šæ•°çš„ä¾èµ–é¡¹ã€‚ç”¨äºæ–¹ä¾¿åœ°æ­å»ºèƒ½å¤Ÿå¤„ç†è¶…é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€ Web åº”ç”¨ã€Web æœåŠ¡å’ŒåŠ¨æ€ç½‘å…³ã€‚OpenRestyÂ® çš„ç›®æ ‡æ˜¯è®©ä½ çš„WebæœåŠ¡ç›´æ¥è·‘åœ¨ Nginx æœåŠ¡å†…éƒ¨ï¼Œå……åˆ†åˆ©ç”¨ Nginx çš„éé˜»å¡ I/O æ¨¡å‹ï¼Œä¸ä»…ä»…å¯¹ HTTP å®¢æˆ·ç«¯è¯·æ±‚,ç”šè‡³äºå¯¹è¿œç¨‹åç«¯è¯¸å¦‚ MySQLã€PostgreSQLã€Memcached ä»¥åŠ Redis ç­‰éƒ½è¿›è¡Œä¸€è‡´çš„é«˜æ€§èƒ½å“åº”ã€‚&lt;/p&gt;&lt;span&gt;â&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥ç®€å•ç†è§£ä¸ºï¼ŒOpenResty = Nginx + Lua, é€šè¿‡ Lua æ‰©å±• Nginx å®ç°çš„å¯ä¼¸ç¼©çš„ Web å¹³å°
ã€‚å®ƒåˆ©ç”¨äº† Nginx çš„é«˜æ€§èƒ½ï¼Œåˆåœ¨å…¶åŸºç¡€ä¸Šæ·»åŠ äº† Lua çš„è„šæœ¬è¯­è¨€æ¥è®© Nginx ä¹Ÿå…·æœ‰äº†åŠ¨æ€çš„ç‰¹æ€§ã€‚é€šè¿‡ OpenResty ä¸­ lua-Nginx-module æ¨¡å—ä¸­æä¾›çš„ Lua APIï¼Œæˆ‘ä»¬å¯ä»¥åŠ¨æ€åœ°æ§åˆ¶è·¯ç”±ã€ä¸Šæ¸¸ã€SSL è¯ä¹¦ã€è¯·æ±‚ã€å“åº”ç­‰ã€‚ç”šè‡³å¯ä»¥åœ¨ä¸é‡å¯ OpenResty çš„å‰æä¸‹ï¼Œä¿®æ”¹ä¸šåŠ¡çš„å¤„ç†é€»è¾‘ï¼Œå¹¶ä¸å±€é™äº OpenResty æä¾›çš„ Lua APIã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…³äºé™æ€å’ŒåŠ¨æ€æœ‰ä¸€ä¸ªå¾ˆåˆé€‚çš„ç±»æ¯”ï¼šå¦‚æœæŠŠ Web æœåŠ¡å™¨å½“åšæ˜¯ä¸€ä¸ªæ­£åœ¨é«˜é€Ÿå…¬è·¯ä¸Šé£é©°çš„æ±½è½¦ï¼ŒNginx éœ€è¦åœè½¦æ‰èƒ½æ›´æ¢è½®èƒï¼Œæ›´æ¢è½¦æ¼†é¢œè‰²ï¼Œè€Œ OpenResty ä¸­å¯ä»¥è¾¹è·‘è¾¹æ¢è½®èƒï¼Œæ›´æ¢è½¦æ¼†ï¼Œç”šè‡³æ›´æ¢å‘åŠ¨æœºï¼Œç›´æ¥è®©æ™®é€šçš„æ±½è½¦å˜æˆè¶…è·‘ï¼&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é™¤äº†ä»¥ä¸Šçš„åŠ¨æ€æ€§ï¼Œè¿˜æœ‰ä¸¤ä¸ªç‰¹æ€§è®© OpenResty ç‹¬å‡ºä¸€æ ¼ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œ1.è¯¦å°½çš„æ–‡æ¡£å’Œæµ‹è¯•ç”¨ä¾‹ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½œä¸ºå¼€æºé¡¹ç›®ï¼Œæ–‡æ¡£å’Œæµ‹è¯•æ¯«æ— ç–‘é—®æ˜¯å…¶æ˜¯å¦é è°±çš„å…³é”®ï¼Œå®ƒçš„æ–‡æ¡£éå¸¸è¯¦ç»†ï¼Œä½œè€…æŠŠæ¯ä¸ªæ³¨æ„çš„ç‚¹éƒ½å†™åœ¨æ–‡æ¡£ä¸Šäº†ï¼Œå¤šæ•°æ—¶å€™åªè¦çœ‹æ–‡æ¡£å³å¯ï¼Œæ¯ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹éƒ½åŒ…å«å®Œæ•´çš„ Nginx é…ç½®å’Œ lua ä»£ç ã€‚ä»¥åŠæµ‹è¯•çš„è¾“å…¥æ•°æ®å’Œé¢„æœŸçš„è¾“å‡ºæ•°æ®ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œ2.åŒæ­¥éé˜»å¡ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;OpenResty åœ¨è¯ç”Ÿä¹‹åˆå°±æ”¯æŒäº†åç¨‹ï¼Œå¹¶ä¸”åŸºäºæ­¤å®ç°äº†åŒæ­¥éé˜»å¡çš„ç¼–ç¨‹æ¨¡å‹ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œç”»å¤–éŸ³ï¼šåç¨‹ï¼ˆcoroutineï¼‰æˆ‘ä»¬å¯ä»¥å°†å®ƒçœ‹æˆä¸€ä¸ªç”¨æˆ·æ€çš„çº¿ç¨‹ï¼Œåªä¸è¿‡è¿™ä¸ªçº¿ç¨‹æ˜¯æˆ‘ä»¬è‡ªå·±è°ƒåº¦çš„ï¼Œè€Œä¸”ä¸åŒåç¨‹çš„åˆ‡æ¢ä¸éœ€è¦é™·å…¥å†…æ ¸æ€ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜ã€‚ï¼ˆä¸€èˆ¬æˆ‘ä»¬è¯´çš„çº¿ç¨‹æ˜¯è¦æŒ‡å†…æ ¸æ€çº¿ç¨‹ï¼Œç”±å†…æ ¸è°ƒåº¦ï¼Œéœ€è¦ä»ç”¨æˆ·ç©ºé—´é™·å…¥å†…æ ¸ç©ºé—´ï¼Œç›¸æ¯”åç¨‹ï¼Œå¯¹æ€§èƒ½ä¼šæœ‰ä¸å°çš„å½±å“ï¼‰ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å•¥æ˜¯åŒæ­¥éé˜»å¡å‘¢ã€‚å‡è®¾æœ‰ä»¥ä¸‹ä¸¤ä¸ªä¸¤è¡Œä»£ç ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;&lt;span&gt;local&lt;/span&gt;Â res,Â errÂ Â =Â query-mysql(sql)&lt;br/&gt;&lt;span&gt;local&lt;/span&gt;Â value,Â errÂ =Â query-redis(key)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€ŒåŒæ­¥ã€&lt;/strong&gt;ï¼šå¿…é¡»æ‰§è¡Œå®ŒæŸ¥è¯¢ mysqlï¼Œæ‰èƒ½æ‰§è¡Œä¸‹é¢çš„ redis æŸ¥è¯¢ï¼Œå¦‚æœä¸ç­‰ mysql æ‰§è¡Œå®Œæˆå°±èƒ½æ‰§è¡Œ redis åˆ™æ˜¯å¼‚æ­¥ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œé˜»å¡ã€&lt;/strong&gt;ï¼šå‡è®¾æ‰§è¡Œ sql è¯­å¥éœ€è¦ 1sï¼Œå¦‚æœåœ¨è¿™ 1s å†…ï¼ŒCPU åªèƒ½å¹²ç­‰ç€ä¸èƒ½åšå…¶å®ƒä»»ä½•äº‹ï¼Œé‚£å°±æ˜¯é˜»å¡ï¼Œå¦‚æœåœ¨ sql æ‰§è¡ŒæœŸé—´å¯ä»¥åšå…¶ä»–äº‹ï¼ˆæ³¨æ„ç”±äºæ˜¯åŒæ­¥çš„ï¼Œæ‰€ä»¥ä¸èƒ½æ‰§è¡Œä»¥ä¸‹çš„ redis æŸ¥è¯¢ï¼‰ï¼Œåˆ™æ˜¯éé˜»å¡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŒæ­¥å…³æ³¨çš„æ˜¯è¯­å¥çš„å…ˆåæ‰§è¡Œé¡ºåºï¼Œå¦‚æœä¸Šä¸€ä¸ªè¯­å¥å¿…é¡»æ‰§è¡Œå®Œæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªè¯­å¥å°±æ˜¯åŒæ­¥ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±æ˜¯å¼‚æ­¥ï¼Œé˜»å¡å…³æ³¨çš„æ˜¯çº¿ç¨‹æ˜¯ CPU æ˜¯å¦éœ€è¦åœ¨ IO æœŸé—´å¹²ç­‰ç€ï¼Œå¦‚æœåœ¨ IOï¼ˆæˆ–å…¶ä»–è€—æ—¶æ“ä½œæœŸé—´ï¼‰æœŸé—´å¯ä»¥åšå…¶ä»–äº‹ï¼Œé‚£å°±æ˜¯éé˜»å¡ï¼Œä¸èƒ½åŠ¨ï¼Œåˆ™æ˜¯é˜»å¡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‚£ä¹ˆ OpenResty çš„å·¥ä½œåŸç†æ˜¯æ€æ ·çš„å‘¢ï¼Œåˆæ˜¯å¦‚ä½•å®ç°åŒæ­¥éé˜»å¡çš„å‘¢ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;OpenResty åŸç†å‰–æ&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;å·¥ä½œåŸç†å‰–æ&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç”±äº OpenResty åŸºäº Nginx å®ç°çš„ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ Nginx çš„å·¥ä½œåŸç†&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.7869415807560137&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYR56Uv0OeVibs6qu7pMyrD2WwODOeU24WYfmckf3cdp01exEia15ygz1pw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1164&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Nginx å¯åŠ¨åï¼Œä¼šæœ‰ä¸€ä¸ª master è¿›ç¨‹å’Œå¤šä¸ª worker è¿›ç¨‹ ï¼Œ master è¿›ç¨‹æ¥å—ç®¡ç†å‘˜çš„ä¿¡å·é‡ï¼ˆå¦‚ Nginx -s reload, -s stopï¼‰æ¥ç®¡ç† worker è¿›ç¨‹ï¼Œmaster æœ¬èº«å¹¶ä¸æ¥æ”¶ client çš„è¯·æ±‚ï¼Œä¸»è¦ç”± worker è¿›ç¨‹æ¥æ¥æ”¶è¯·æ±‚ï¼Œä¸åŒäº apache çš„æ¯ä¸ªè¯·æ±‚ä¼šå ç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸”æ˜¯åŒæ­¥IOï¼ŒNginx æ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œæ¯ä¸ª worker å¯ä»¥åŒæ—¶å¤„ç†çš„è¯·æ±‚æ•°åªå—é™äºå†…å­˜å¤§å°ï¼Œè¿™é‡Œå°±è¦ç®€å•åœ°äº†è§£ä¸€ä¸‹ nginx é‡‡ç”¨çš„ epoll æ¨¡å‹ï¼š&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;epoll é‡‡ç”¨å¤šè·¯å¤ç”¨æ¨¡å‹ï¼Œå³åŒä¸€æ—¶é—´è™½ç„¶å¯èƒ½ä¼šæœ‰å¤šä¸ªè¯·æ±‚è¿›æ¥ï¼Œ ä½†åªä¼šç”¨ä¸€ä¸ªçº¿ç¨‹å»ç›‘è§†ï¼Œç„¶åå“ªä¸ªè¯·æ±‚æ•°æ®å‡†å¤‡å¥½äº†ï¼Œå°±è°ƒç”¨ç›¸åº”çš„çº¿ç¨‹å»å¤„ç†ï¼Œå°±åƒå›¾ä¸­æ‰€ç¤ºï¼Œå¦‚åŒæ‹¨å¼€å…³ä¸€æ ·ï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å¤„ç†ï¼Œ Nginx åº•å±‚å°±æ˜¯ç”¨çš„ epoll ï¼ŒåŸºäºäº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œæ¯ä¸ªè¯·æ±‚è¿›æ¥æ³¨å†Œäº‹ä»¶å¹¶æ³¨å†Œ callback å›è°ƒå‡½æ•°ï¼Œç­‰æ•°æ®å‡†å…¥å¥½äº†ï¼Œå°±è°ƒç”¨å›è°ƒå‡½æ•°è¿›è¡Œå¤„ç†ï¼Œå®ƒæ˜¯å¼‚æ­¥éé˜»å¡çš„ï¼Œæ‰€ä»¥æ€§èƒ½å¾ˆé«˜ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.2975&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRYbNPicgOHBWWvhjicriaIDayYvicuVJAicicdsm0fXyZAnAt95cCnBlO7Rsw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;400&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰“ä¸ªç®€å•çš„æ¯”æ–¹ï¼Œæˆ‘ä»¬éƒ½æœ‰è®¢ç¥¨çš„ç»éªŒï¼Œå½“æˆ‘ä»¬å§”æ‰˜é…’åº—è®¢ç¥¨æ—¶ï¼Œæ¥å¾…å‘˜ä¼šå…ˆæŠŠæˆ‘ä»¬çš„ç”µè¯å·ç å’Œç›¸å…³ä¿¡æ¯ç­‰è®°ä¸‹æ¥ï¼ˆæ³¨å†Œäº‹ä»¶ï¼‰ï¼ŒæŒ‚æ–­ç”µè¯åæ¥å¾…å‘˜åœ¨æ“ä½œæœŸé—´æˆ‘ä»¬å°±å¯ä»¥å»åšå…¶ä»–äº‹äº†ï¼ˆéé˜»å¡ï¼‰ï¼Œå½“æ¥å¾…å‘˜æŠŠæ‰‹ç»­æå¥½åä¼šä¸»åŠ¨æ‰“ç”µè¯ç»™æˆ‘ä»¬é€šçŸ¥æˆ‘ä»¬ç¥¨è®¢å¥½äº†ï¼ˆå›è°ƒï¼‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;worker è¿›ç¨‹æ˜¯ä» Â master fork Â å‡ºæ¥çš„ï¼Œè¿™æ„å‘³ç€ worker è¿›ç¨‹ä¹‹é—´æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œè¿™æ ·ä¸åŒ worker è¿›ç¨‹ä¹‹é—´å¤„ç†å¹¶å‘è¯·æ±‚å‡ ä¹æ²¡æœ‰åŒæ­¥é”çš„é™åˆ¶ï¼Œå¥½å¤„å°±æ˜¯ä¸€ä¸ª worker è¿›ç¨‹æŒ‚äº†ï¼Œä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹ï¼Œæˆ‘ä»¬ä¸€èˆ¬æŠŠ worker æ•°é‡è®¾ç½®æˆå’Œ CPU çš„ä¸ªæ•°ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ä¸å¿…è¦çš„ CPU åˆ‡æ¢ï¼Œæå‡æ€§èƒ½ï¼Œæ¯ä¸ª worker éƒ½æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ã€‚é‚£ä¹ˆ LuaJIT åœ¨ OpenResty æ¶æ„ä¸­çš„ä½ç½®æ˜¯æ€æ ·çš„å‘¢ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.7406779661016949&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRWJM9Yicib5gTYnO2q3oiajc3bxIFQRaYtue0lLmC0aCq2iavlCPmyiccAwA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1180&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é¦–å…ˆå¯åŠ¨çš„ master è¿›ç¨‹å¸¦æœ‰ LuaJIT çš„æœºè™šæ‹Ÿï¼Œè€Œ worker è¿›ç¨‹æ˜¯ä» master è¿›ç¨‹ fork å‡ºæ¥çš„ï¼Œåœ¨ worker å†…è¿›ç¨‹çš„å·¥ä½œä¸»è¦ç”± Lua åç¨‹æ¥å®Œæˆï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åŒä¸€ä¸ª worker å†…çš„æ‰€æœ‰åç¨‹ï¼Œéƒ½ä¼šå…±äº«è¿™ä¸ª LuaJIT è™šæ‹Ÿæœºï¼Œæ¯ä¸ª worker è¿›ç¨‹é‡Œ lua çš„æ‰§è¡Œä¹Ÿæ˜¯åœ¨è¿™ä¸ªè™šæ‹Ÿæœºä¸­å®Œæˆçš„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œworker è¿›ç¨‹åªèƒ½å¤„ç†ä¸€ä¸ªç”¨æˆ·è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰ä¸€ä¸ª lua åç¨‹åœ¨è¿è¡Œï¼Œé‚£ä¸ºå•¥ OpenResty èƒ½æ”¯æŒç™¾ä¸‡å¹¶å‘è¯·æ±‚å‘¢ï¼Œè¿™å°±éœ€è¦äº†è§£ Lua åç¨‹ä¸ Nginx äº‹ä»¶æœºåˆ¶æ˜¯å¦‚ä½•é…åˆçš„äº†ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.44212962962962965&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRf6iaxtA6nYxicoibbYDqvVJaXcMeBInzNSK1OnkHsmGX8xOxQAOrjp5oQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1728&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚å›¾ç¤ºï¼Œå½“ç”¨ Lua è°ƒç”¨æŸ¥è¯¢ MySQL æˆ– ç½‘ç»œ IO æ—¶ï¼Œè™šæ‹Ÿæœºä¼šè°ƒç”¨ Lua åç¨‹çš„ yield æŠŠè‡ªå·±æŒ‚èµ·ï¼Œåœ¨ Nginx ä¸­æ³¨å†Œå›è°ƒï¼Œæ­¤æ—¶ worker å°±å¯ä»¥å¤„ç†å¦å¤–çš„è¯·æ±‚äº†ï¼ˆéé˜»å¡ï¼‰ï¼Œç­‰åˆ° IO äº‹ä»¶å¤„ç†å®Œäº†ï¼Œ Nginx å°±ä¼šè°ƒç”¨ resume æ¥å”¤é†’ lua åç¨‹ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;äº‹å®ä¸Šï¼Œç”± OpenResty æä¾›çš„æ‰€æœ‰ APIï¼Œéƒ½æ˜¯éé˜»å¡çš„ï¼Œä¸‹æ–‡æåˆ°çš„ä¸ MySQLï¼ŒRedis ç­‰äº¤äº’ï¼Œéƒ½æ˜¯éé˜»å¡çš„ï¼Œæ‰€ä»¥æ€§èƒ½å¾ˆé«˜ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;OpenResty è¯·æ±‚ç”Ÿå‘½å‘¨æœŸ&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Nginx çš„æ¯ä¸ªè¯·æ±‚æœ‰ 11 ä¸ªé˜¶æ®µï¼ŒOpenResty ä¹Ÿæœ‰11 ä¸ª *_by_lua çš„æŒ‡ä»¤ï¼Œå¦‚ä¸‹å›¾ç¤º:&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.9054726368159204&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRhPmBh7drKKhs7EzBFo749o0vRKVtBmNvv7QSlGZic6qAFR6GGEGicOlw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1005&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å„ä¸ªé˜¶æ®µ *_by_lua çš„è§£é‡Šå¦‚ä¸‹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;set_by_luaï¼šè®¾ç½®å˜é‡ï¼›&lt;br/&gt;rewrite_by_luaï¼šè½¬å‘ã€é‡å®šå‘ç­‰ï¼›&lt;br/&gt;access_by_luaï¼šå‡†å…¥ã€æƒé™ç­‰ï¼›&lt;br/&gt;content_by_luaï¼šç”Ÿæˆè¿”å›å†…å®¹ï¼›&lt;br/&gt;header_filter_by_luaï¼šåº”ç­”å¤´è¿‡æ»¤å¤„ç†ï¼›&lt;br/&gt;body_filter_by_luaï¼šåº”ç­”ä½“è¿‡æ»¤å¤„ç†ï¼›&lt;br/&gt;log_by_luaï¼šæ—¥å¿—è®°å½•ã€‚&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™æ ·åˆ†é˜¶æ®µæœ‰å•¥å¥½å¤„å‘¢ï¼Œå‡è®¾ä½ åŸæ¥çš„ API è¯·æ±‚éƒ½æ˜¯æ˜æ–‡çš„&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;&lt;br/&gt;# æ˜æ–‡åè®®ç‰ˆæœ¬&lt;br/&gt;location /request {&lt;br/&gt;    content_by_lua &#x27;...&#x27;;       # å¤„ç†è¯·æ±‚&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç°åœ¨éœ€è¦å¯¹å…¶åŠ ä¸ŠåŠ å¯†å’Œè§£å¯†çš„æœºåˆ¶ï¼Œåªéœ€è¦åœ¨ access é˜¶æ®µè§£å¯†ï¼Œ åœ¨ body filter é˜¶æ®µåŠ å¯†å³å¯ï¼ŒåŸæ¥ content çš„é€»è¾‘æ— éœ€åšä»»åŠ¡æ”¹åŠ¨ï¼Œæœ‰æ•ˆå®ç°äº†ä»£ç çš„è§£è—•ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;# åŠ å¯†åè®®ç‰ˆæœ¬&lt;br/&gt;location /request {&lt;br/&gt;    access_by_lua &#x27;...&#x27;;        # è¯·æ±‚ä½“è§£å¯†&lt;br/&gt;    content_by_lua &#x27;...&#x27;;       # å¤„ç†è¯·æ±‚ï¼Œä¸éœ€è¦å…³å¿ƒé€šä¿¡åè®®&lt;br/&gt;    body_filter_by_lua &#x27;...&#x27;;   # åº”ç­”ä½“åŠ å¯†&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å†æ¯”å¦‚æˆ‘ä»¬ä¸æ˜¯è¦è¦ä¸Šæ–‡æåˆ°ç½‘å…³çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ä¸æ˜¯è¦ç›‘æ§æ—¥å¿—å—ï¼Œå°±å¯ä»¥ç»Ÿä¸€åœ¨ log_by_lua ä¸ŠæŠ¥æ—¥å¿—ï¼Œä¸å½±å“å…¶ä»–é˜¶æ®µçš„é€»è¾‘ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;worker é—´å…±äº«æ•°æ®åˆ©å™¨: shared dict&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;worker æ—¢ç„¶æ˜¯äº’ç›¸ç‹¬ç«‹çš„è¿›ç¨‹ï¼Œå°±éœ€è¦è€ƒè™‘å…¶å…±äº«æ•°æ®çš„é—®é¢˜ï¼Œ OpenResty æä¾›äº†ä¸€ç§é«˜æ•ˆçš„æ•°æ®ç»“æ„: shared dict ,å¯ä»¥å®ç°åœ¨ worker é—´å…±äº«æ•°æ®ï¼Œshared dict å¯¹å¤–æä¾›äº† 20 å¤šä¸ª Lua APIï¼Œéƒ½æ˜¯åŸå­æ“ä½œçš„ï¼Œé¿å…äº†é«˜å¹¶å‘ä¸‹çš„ç«äº‰é—®é¢˜ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;è·¯ç”±ç­–ç•¥æ’ä»¶åŒ–å®ç°&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ‰äº†ä»¥ä¸Š OpenResty ç‚¹çš„é“ºå«ï¼Œæ¥çœ‹çœ‹ä¸Šæ–‡æçš„ç½‘å…³æ ¸å¿ƒåŠŸèƒ½ ã€Œè·¯ç”±ç­–ç•¥æ’ä»¶åŒ–ã€,ã€Œåç«¯é›†ç¾¤çš„åŠ¨æ€å˜æ›´ã€å¦‚ä½•å®ç°&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é¦–å…ˆé’ˆå¯¹æŸä¸ªè¯·æ±‚çš„è·¯ç”±ç­–ç•¥å¤§æ¦‚æ˜¯è¿™æ ·çš„&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.5445026178010471&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYR15ic2oCkicU4fQrG83TMVVbjG4GmbrHk0Z4iaias7fuXMvUvE9FyK7zzCA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;764&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ•´ä¸ªæ’ä»¶åŒ–çš„æ­¥éª¤å¤§è‡´å¦‚ä¸‹&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;1ã€æ¯æ¡ç­–ç•¥ç”± url ,action, cluster ç­‰ç»„æˆï¼Œä»£è¡¨è¯·æ±‚ url åœ¨æ‰“åˆ°åç«¯é›†ç¾¤è¿‡ç¨‹ä¸­æœ€ç»ˆç»å†äº†å“ªäº›è·¯ç”±è§„åˆ™ï¼Œè¿™äº›è§„åˆ™ç»Ÿä¸€åœ¨æˆ‘ä»¬çš„è·¯ç”±ç®¡ç†å¹³å°é…ç½®ï¼Œå­˜åœ¨ db é‡Œã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;2ã€OpenResty å¯åŠ¨æ—¶ï¼Œåœ¨è¯·æ±‚çš„ init é˜¶æ®µ worker è¿›ç¨‹ä¼šå»æ‹‰å–è¿™äº›è§„åˆ™ï¼Œå°†è¿™äº›è§„åˆ™ç¼–è¯‘æˆä¸€ä¸ªä¸ªå¯æ‰§è¡Œçš„ lua å‡½æ•°ï¼Œè¿™ä¸€ä¸ªä¸ªå‡½æ•°å°±å¯¹åº”äº†ä¸€æ¡æ¡çš„è§„åˆ™ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.2373134328358209&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRwSL7sMjA8Viaia5OtEKUgtHbwibJY1bEo9dOnpH4KGeW4NLR1pnIB5Drg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;670&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;éœ€è¦æ³¨æ„çš„æ˜¯ä¸ºäº†é¿å…é‡å¤å» MySQL ä¸­æ‹‰å–æ•°æ®ï¼ŒæŸä¸ª worker ä» MySQL æ‹‰å–å®Œè§„åˆ™ï¼ˆæ­¤æ­¥éœ€è¦åŠ é”ï¼Œé¿å…æ‰€æœ‰ worker éƒ½å»æ‹‰å–ï¼‰æˆ–è€…åç«¯é›†ç¾¤ç­‰é…ç½®ä¿¡æ¯åè¦å°†å…¶ä¿å­˜åœ¨ shared dict ä¸­ï¼Œè¿™æ ·ä¹‹åæ‰€æœ‰çš„ worker è¯·æ±‚åªè¦ä» shared dict ä¸­è·å–è¿™äº›è§„åˆ™ï¼Œç„¶åå°†å…¶æ˜ å°„æˆå¯¹åº”æ¨¡å—çš„å‡½æ•°å³å¯ï¼Œå¦‚æœé…ç½®è§„åˆ™æœ‰å˜åŠ¨å‘¢ï¼Œé…ç½®åå°é€šè¿‡æ¥å£é€šçŸ¥ OpenResty é‡æ–°åŠ è½½ä¸€ä¸‹å³å¯&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.7426160337552743&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRE1y6rRic4kf21nnBO6GaG3kRRic3aHDJaKQIZpLu1HdOWUk3L3AA3icCA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;474&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»è¿‡è·¯ç”±è§„åˆ™ç¡®å®šå¥½æ¯ä¸ªè¯·æ±‚å¯¹åº”è¦æ‰“çš„åç«¯é›†ç¾¤åï¼Œå°±éœ€è¦æ ¹æ® upstream æ¥ç¡®å®šæœ€ç»ˆæ‰“åˆ°å“ªä¸ªé›†ç¾¤çš„å“ªå°æœºå™¨ä¸Šï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åŠ¨æ€ç®¡ç†é›†ç¾¤ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;åç«¯é›†ç¾¤çš„åŠ¨æ€é…ç½®&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨ Nginx ä¸­é…ç½® upstream çš„æ ¼å¼å¦‚ä¸‹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;upstreamÂ backendÂ {&lt;br/&gt;Â Â Â Â serverÂ backend1.example.comÂ weight=&lt;span&gt;5&lt;/span&gt;;&lt;br/&gt;Â Â Â Â serverÂ backend2.example.com;&lt;br/&gt;Â Â Â Â serverÂ &lt;span&gt;192.0&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;.1&lt;/span&gt;Â backup;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥ä¸Šè¿™ä¸ªç¤ºä¾‹æ˜¯æŒ‰ç…§æƒé‡ï¼ˆweightï¼‰æ¥åˆ’åˆ†çš„ï¼Œ6 ä¸ªè¯·æ±‚è¿›æ¥ï¼Œ5ä¸ªè¯·æ±‚æ‰“åˆ° backend1.example.com, 1 ä¸ªè¯·æ±‚æ‰“åˆ° backend2.example.com,å¦‚æœè¿™ä¸¤å°æœºå™¨éƒ½ä¸å¯ç”¨ï¼Œå°±æ‰“åˆ° 192.0.0.1ï¼Œè¿™ç§é™æ€é…ç½®çš„æ–¹å¼ upstream çš„æ–¹å¼ç¡®å®å¯è¡Œï¼Œä½†æˆ‘ä»¬çŸ¥é“æœºå™¨çš„æ‰©ç¼©å®¹æœ‰æ—¶å€™æ¯”è¾ƒé¢‘ç¹ï¼Œå¦‚æœæ¯æ¬¡æœºå™¨ä¸Šä¸‹çº¿éƒ½è¦æ‰‹åŠ¨å»æ”¹ï¼Œå¹¶ä¸”æ”¹å®Œä¹‹åè¿˜è¦é‡æ–°å» reload æ— ç–‘æ˜¯ä¸å¯è¡Œçš„ï¼Œå‡ºé”™çš„æ¦‚ç‡å¾ˆå¤§ï¼Œè€Œä¸”æ¯æ¬¡é…ç½®éƒ½è¦ reload å¯¹æ€§èƒ½çš„æŸè€—ä¹Ÿæ˜¯æŒºå¤§çš„ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒOpenResty æä¾›äº†ä¸€ä¸ª dyups çš„æ¨¡å—æ¥è§£å†³æ­¤é—®é¢˜ï¼Œ å®ƒæä¾›äº†ä¸€ä¸ª dyups api,å¯ä»¥åŠ¨æ€å¢ï¼Œåˆ ï¼Œåˆ›å»º upsteamï¼Œæ‰€ä»¥åœ¨ init é˜¶æ®µæˆ‘ä»¬ä¼šå…ˆå»æ‹‰å–é›†ç¾¤ä¿¡æ¯ï¼Œæ„å»º upstreamï¼Œä¹‹åå¦‚æœé›†ç¾¤ä¿¡æ¯æœ‰å˜åŠ¨ï¼Œä¼šé€šè¿‡å¦‚ä¸‹å½¢å¼è°ƒç”¨ dyups api æ¥æ›´æ–° upstream&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;--Â åŠ¨æ€é…ç½®Â upstreamÂ æ¥å£ç«™ç‚¹&lt;/span&gt;&lt;br/&gt;serverÂ {&lt;br/&gt;Â Â Â Â Â listenÂ &lt;span&gt;127.0&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;.1&lt;/span&gt;:&lt;span&gt;81&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â locationÂ /Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â dyups_interface;&lt;br/&gt;Â Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;--Â å¢åŠ Â upstream:user_backend&lt;/span&gt;&lt;br/&gt;curlÂ -dÂ &lt;span&gt;&quot;serverÂ 10.53.10.191;&quot;&lt;/span&gt;Â &lt;span&gt;127.0&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;.1&lt;/span&gt;:&lt;span&gt;81&lt;/span&gt;/upstream/user_backend&lt;br/&gt;&lt;br/&gt;&lt;span&gt;--Â åˆ é™¤Â upstream:user_backend&lt;/span&gt;&lt;br/&gt;curlÂ -iÂ -XÂ DELETEÂ &lt;span&gt;127.0&lt;/span&gt;&lt;span&gt;.0&lt;/span&gt;&lt;span&gt;.1&lt;/span&gt;:&lt;span&gt;81&lt;/span&gt;/upstream/user_backend&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½¿ç”¨ dyups å°±è§£å†³äº†åŠ¨æ€é…ç½® upstream çš„é—®é¢˜&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;ç½‘å…³æœ€ç»ˆæ¶æ„è®¾è®¡å›¾&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.5574412532637075&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRU7OUERPAjCUs66XkNwg1hIC18MIwUrn3VFkqRWl2RFFnzaSaEVO4CA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;766&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é€šè¿‡è¿™æ ·çš„è®¾è®¡ï¼Œæœ€ç»ˆå®ç°äº†ç½‘å…³çš„é…ç½®åŒ–ï¼ŒåŠ¨æ€åŒ–ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç½‘å…³ä½œä¸ºæ‰¿è½½å…¬å¸æ‰€æœ‰æµé‡çš„å…¥å£ï¼Œå¯¹æ€§èƒ½æœ‰ç€æé«˜çš„è¦æ±‚ï¼Œæ‰€ä»¥æŠ€æœ¯é€‰å‹ä¸Šè¿˜æ˜¯è¦æ…é‡ï¼Œä¹‹æ‰€ä»¥é€‰æ‹© OpenRestyï¼Œä¸€æ˜¯å› ä¸ºå®ƒé«˜æ€§èƒ½ï¼ŒäºŒæ˜¯ç›®å‰ä¹Ÿæœ‰å°ç±³ï¼Œé˜¿é‡Œï¼Œè…¾è®¯ç­‰å¤§å…¬å¸åœ¨ç”¨ï¼Œæ˜¯ä¹…ç»è¿‡å¸‚åœºè€ƒéªŒçš„ï¼Œæœ¬æ–‡é€šè¿‡å¯¹ç½‘å…³çš„æ€»ç»“ç®€è¦ä»‹ç»äº† OpenResty çš„ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œç›¸ä¿¡å¤§å®¶å¯¹å…¶ä¸»è¦åŠŸèƒ½ç‚¹åº”è¯¥æœ‰æ‰€äº†è§£äº†ï¼Œä¸è¿‡ OpenResty çš„çŸ¥è¯†ç‚¹è¿œä¸æ­¢ä»¥ä¸Šè¿™äº›ï¼Œå¤§å®¶å¦‚æœ‰å…´è¶£ï¼Œå¯ä»¥å‚è€ƒæ–‡æœ«çš„å­¦ä¹ æ•™ç¨‹æ·±å…¥å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶ä¼šæœ‰ä¸å°‘å¯å‘çš„ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;é¢˜å¤–è¯&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ã€Œç æµ·ã€å†å²ç²¾å“æ–‡ç« å·²ç»åšæˆç”µå­ä¹¦äº†ï¼Œå¦‚æœ‰éœ€è¦æ¬¢è¿æ·»åŠ æˆ‘çš„ä¸ªäººå¾®ä¿¡ï¼Œé™¤äº†å‘ä½ ç”µå­ä¹¦å¤–ï¼Œä¹Ÿå¯ä»¥åŠ å…¥æˆ‘çš„è¯»è€…ç¾¤ï¼Œä¸€èµ·æ¢è®¨é—®é¢˜ï¼Œå…±åŒè¿›æ­¥ï¼é‡Œé¢æœ‰ä¸å°‘æŠ€æœ¯æ€»ç›‘ç­‰å¤§å’–ï¼Œç›¸ä¿¡ä¸ç®¡æ˜¯èŒåœºè¿›é˜¶ä¹Ÿå¥½ï¼Œä¸ªäººå›°æƒ‘ä¹Ÿå¥½ï¼Œéƒ½èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©å“¦&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;1.0225225225225225&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/OyweysCSeLUMiaGVniaicPvJeN6G8SXFPYRKknvTeoScgA19PpnyRFhoMFotpa4KBWp6471bvUH5F8aibmVRNQibaXw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;222&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å·¨äººçš„è‚©è†€&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;è°ˆè°ˆå¾®æœåŠ¡ä¸­çš„ API ç½‘å…³ https://www.cnblogs.com/savorboard/p/api-gateway.html&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;OpenrestyåŠ¨æ€æ›´æ–°(æ— reload)TCP Upstreamçš„åŸç†å’Œå®ç° https://developer.aliyun.com/article/745757&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;http://www.ttlsa.com/Nginx/Nginx-modules-ngx_http_dyups_module/&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æå®¢æ—¶é—´ OpenResty ä»å…¥é—¨åˆ°å®æˆ˜&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>4e520a517ae609b77d044b93be8e8ca6</guid>
<title>[æ¨è] å¸¸è§é¢è¯•é¢˜ä¹‹ç¼“å­˜é›ªå´©ã€ç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿</title>
<link>https://toutiao.io/k/o904vp0</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;å‰è¨€&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â&lt;/span&gt;&lt;p&gt;Helloï¼Œeverybodyï¼Œæˆ‘æ˜¯asongï¼Œä»Šå¤©ä¸å¤§å®¶ä¸€èµ·æ¥èŠä¸€èŠé¢è¯•ä¸­å‡ ä¸ªå¸¸è§çš„ç¼“å­˜é—®é¢˜ã€‚ä¸ºä»€ä¹ˆä¼šçªç„¶æƒ³åšä¸€ç¯‡è¿™ä¸ªæ–‡ç« å‘¢ï¼Œä»Šå¤©ç¿»äº†ä¸€ä¸‹æˆ‘å½“åˆå‡†å¤‡é¢è¯•æ—¶æ•´ç†çš„ä¸€äº›èµ„æ–™ï¼Œå‘ç°ç¼“å­˜åœ¨é¢è¯•ä¸­å æ¯”è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œå½“åˆä¸ºäº†é¢è¯•ä¹Ÿæ˜¯èƒŒäº†å¥½ä¹…çš„ï¼Œä¸è¿‡å› ä¸ºéƒ½æ˜¯èƒŒçš„ï¼Œç°åœ¨ä¹Ÿæœ‰ç‚¹å¿˜äº†ï¼Œä»Šå¤©å°±æƒ³ç€å¥½å¥½æ•´ç†ä¸€ä¸‹è¿™ä¸€éƒ¨åˆ†ï¼Œå¥½å¥½è®°å½•ä¸€ä¸‹ã€‚å› ä¸ºè‡ªå·±èƒ½åŠ›æœ‰é™ï¼Œè¿™ä¸€ç¯‡ä¸»è®²é€šä¿—æ˜“æ‡‚ï¼Œä¸æ¶‰åŠå¤ªéš¾çš„ç¼“å­˜ä½¿ç”¨åœºæ™¯ã€‚å¥½å•¦ï¼Œæˆ‘ä»¬å¼€å§‹å§ã€‚&lt;/p&gt;&lt;span&gt;â&lt;/span&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;ç¼“å­˜åº”ç”¨&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¼“å­˜åœ¨æˆ‘ä»¬å¹³å¸¸çš„é¡¹ç›®ä¸­å¤šå¤šå°‘å°‘éƒ½ä¼šä½¿ç”¨åˆ°ï¼Œç¼“å­˜ä½¿ç”¨çš„ä½¿ç”¨åœºæ™¯è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼Œç¼“å­˜æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„é‡è¦ç»„ä»¶ï¼Œä¸»è¦è§£å†³é«˜å¹¶å‘ã€å¤§æ•°æ®åœºæ™¯ä¸‹ï¼Œçƒ­ç‚¹æ•°æ®è®¿é—®çš„æ€§èƒ½é—®é¢˜ã€‚æé«˜æ€§èƒ½çš„æ•°æ®å¿«é€Ÿè®¿é—®ã€‚ä¸€æåˆ°ç¼“å­˜ï¼Œè¿™äº›æ˜¯æˆ‘ä»¬éƒ½èƒ½æƒ³åˆ°çš„ä¸€äº›ç¼“å­˜åº”ç”¨åœºæ™¯ï¼Œä½†æ˜¯æˆ‘ä»¬æ˜¯ä¸å¤ªæ¸…æ¥šç¼“å­˜çš„æœ¬è´¨æ€æƒ³æ˜¯ä»€ä¹ˆçš„ã€‚ç¼“å­˜çš„åŸºæœ¬æ€æƒ³å°±æ˜¯æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰çš„ç©ºé—´æ¢æ—¶é—´ã€‚ç¼“å­˜ä¹Ÿå¹¶ä¸æ˜¯é‚£ä¹ˆçš„é«˜å¤§ä¸Šï¼Œè™½ç„¶ä»–å¯ä»¥ä¸ºç³»ç»Ÿçš„æ€§èƒ½è¿›è¡Œæå‡ã€‚ç¼“å­˜çš„æ€æƒ³å®é™…åœ¨æ“ä½œç³»ç»Ÿæˆ–è€…å…¶ä»–åœ°æ–¹éƒ½è¢«å¤§é‡ç”¨åˆ°ã€‚æ¯”å¦‚ &lt;strong&gt;ã€ŒCPU Cache ç¼“å­˜çš„æ˜¯å†…å­˜æ•°æ®ç”¨äºè§£å†³ CPU å¤„ç†é€Ÿåº¦å’Œå†…å­˜ä¸åŒ¹é…çš„é—®é¢˜ï¼Œå†…å­˜ç¼“å­˜çš„æ˜¯ç¡¬ç›˜æ•°æ®ç”¨äºè§£å†³ç¡¬ç›˜è®¿é—®é€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚ã€&lt;/strong&gt; &lt;strong&gt;ã€Œå†æ¯”å¦‚æ“ä½œç³»ç»Ÿåœ¨ é¡µè¡¨æ–¹æ¡ˆ åŸºç¡€ä¹‹ä¸Šå¼•å…¥äº† å¿«è¡¨ æ¥åŠ é€Ÿè™šæ‹Ÿåœ°å€åˆ°ç‰©ç†åœ°å€çš„è½¬æ¢ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå¿«è¡¨ç†è§£ä¸ºä¸€ç§ç‰¹æ®Šçš„é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨ï¼ˆCacheï¼‰ã€‚ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸Šé¢ç®€å•ä»‹ç»äº†ç¼“å­˜çš„åŸºæœ¬æ€æƒ³ï¼Œç°åœ¨å›åˆ°ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼š**æˆ‘ä»¬ä¸ºäº†é¿å…ç”¨æˆ·åœ¨è¯·æ±‚æ•°æ®çš„æ—¶å€™è·å–é€Ÿåº¦è¿‡äºç¼“æ…¢ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ•°æ®åº“ä¹‹ä¸Šå¢åŠ äº†ç¼“å­˜è¿™ä¸€å±‚æ¥å¼¥è¡¥ã€‚**ç”»ä¸ªå›¾èƒ½æ›´åŠ æ–¹ä¾¿å¤§å®¶çš„ç†è§£ï¼š&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/k5430ljpYPNic3ic6iaK8z8O1MpctWOYFLE91dVboLNzdrO8eSNBiaEgp1IaDptSTdPgiaWnj8lpMY6FwoArcxWHNFQ/640?wx_fmt=png&quot; data-type=&quot;png&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç®€å•ç‚¹è¯´å½“æˆ‘ä»¬æŸ¥è¯¢ä¸€æ¡æ•°æ®æ—¶ï¼Œå…ˆå»æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜æœ‰å°±ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰å°±å»æŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åè¿”å›ã€‚è¿™ç§æƒ…å†µä¸‹å°±å¯èƒ½ä¼šå‡ºç°ä¸€äº›ç°è±¡ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;1. ç¼“å­˜é›ªå´©&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;1.1 ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­è¿›è¡Œåˆ†æã€‚æ¯”å¦‚é©¬è€å¸ˆçš„æŸå®ï¼Œæˆ‘ä»¬æ‰“å¼€æŸå®çš„é¦–é¡µæ—¶ï¼Œçœ‹åˆ°ä¸€äº›å›¾ç‰‡å‘€ã€æ¨èåº—é“ºä¿¡æ¯å‘€ç­‰ç­‰ï¼Œè¿™äº›éƒ½å±äºçƒ­ç‚¹æ•°æ®ï¼Œä¸ºä»€ä¹ˆä»–ä»¬ä¼šåŠ è½½çš„é‚£ä¹ˆå¿«å‘¢ï¼Ÿå› ä¸ºä½¿ç”¨åˆ°äº†ç¼“å­˜å‘—ã€‚è¿™äº›çƒ­ç‚¹æ•°æ®éƒ½åšäº†ç¼“å­˜ï¼Œå‡è®¾ç°åœ¨æŠŠè¿™äº›çƒ­ç‚¹æ•°æ®çš„ç¼“å­˜å¤±æ•ˆæ—¶é—´ä¸ºä¸€æ ·ï¼Œç°åœ¨æˆ‘ä»¬é©¬è€å¸ˆè¦åšä¸€ä¸ªç§’æ€æ´»åŠ¨ï¼Œå‡è®¾åœ¨ç§’æ€æ´»åŠ¨æ—¶æ¯ç§’æœ‰8000ä¸ªè¯·æ±‚ï¼Œæœ¬æ¥æœ‰ç¼“å­˜æˆ‘ä»¬æ˜¯å¯ä»¥æ‰›ä½æ¯ç§’ 6000 ä¸ªè¯·æ±‚ï¼Œä½†æ˜¯ç¼“å­˜å½“æ—¶æ‰€æœ‰çš„Keyéƒ½å¤±æ•ˆäº†ã€‚æ­¤æ—¶ 1 ç§’ 8000 ä¸ªè¯·æ±‚å…¨éƒ¨è½æ•°æ®åº“ï¼Œæ•°æ®åº“å¿…ç„¶æ‰›ä¸ä½ï¼Œå®ƒä¼šæŠ¥ä¸€ä¸‹è­¦ï¼ŒçœŸå®æƒ…å†µå¯èƒ½DBAéƒ½æ²¡ååº”è¿‡æ¥å°±ç›´æ¥æŒ‚äº†ã€‚æ­¤æ—¶ï¼Œå¦‚æœæ²¡ç”¨ä»€ä¹ˆç‰¹åˆ«çš„æ–¹æ¡ˆæ¥å¤„ç†è¿™ä¸ªæ•…éšœï¼ŒDBA å¾ˆç€æ€¥ï¼Œé‡å¯æ•°æ®åº“ï¼Œä½†æ˜¯æ•°æ®åº“ç«‹é©¬åˆè¢«æ–°çš„æµé‡ç»™æ‰“æ­»äº†ã€‚ä¸Šé¢é€ æˆç¼“å­˜é›ªå´©çš„åŸå› æ˜¯å› ä¸ºå¤±æ•ˆæ—¶é—´é€ æˆï¼Œè¿˜æœ‰ä¸€ç§å¯èƒ½æ˜¯å› ä¸ºç¼“å­˜æœåŠ¡å®•æœºã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.213740458015267&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/k5430ljpYPNic3ic6iaK8z8O1MpctWOYFLEGcGRberfhhicw8BbeA1DIAyhhl3wNTz9VTVEHBvHFbMuL9Mt4jYfWBA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;786&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;1.2 è§£å†³åŠæ³•&lt;/span&gt;&lt;span/&gt;&lt;br/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œåˆ†ä¸‰ä¸ªæ—¶é—´æ®µè¿›è¡Œè¿›è¡Œåˆ†æ&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1.2.1 äº‹å‰&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœç¼“å­˜é›ªå´©é€ æˆçš„åŸå› æ˜¯å› ä¸ºç¼“å­˜æœåŠ¡å®•æœºé€ æˆçš„ï¼Œå¯ä»¥å°†&lt;code&gt;redis&lt;/code&gt;é‡‡ç”¨é›†ç¾¤éƒ¨ç½²ï¼Œå¯ä»¥ä½¿ç”¨ ä¸»ä»+å“¨å…µ ï¼ŒRedis Cluster æ¥é¿å… Redis å…¨ç›˜å´©æºƒçš„æƒ…å†µã€‚è‹¥ç¼“å­˜é›ªå´©æ˜¯å› ä¸ºå¤§é‡ç¼“å­˜å› ä¸ºå¤±æ•ˆæ—¶é—´è€Œé€ æˆçš„ï¼Œæˆ‘ä»¬åœ¨æ‰¹é‡å¾€&lt;code&gt;redis&lt;/code&gt;å­˜æ•°æ®çš„æ—¶å€™ï¼ŒæŠŠæ¯ä¸ªKeyçš„å¤±æ•ˆæ—¶é—´éƒ½åŠ ä¸ªéšæœºå€¼å°±å¥½äº†ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æ•°æ®ä¸ä¼šåœ¨åŒä¸€æ—¶é—´å¤§é¢ç§¯å¤±æ•ˆï¼Œæˆ–è€…è®¾ç½®çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸï¼Œæœ‰æ›´æ–°æ“ä½œå°±æ›´æ–°ç¼“å­˜å°±å¯ä»¥äº†ã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1.2.2 äº‹ä¸­&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœæˆ‘ä»¬ä¹‹å‰æ²¡æœ‰è€ƒè™‘ç¼“å­˜é›ªå´©çš„é—®é¢˜ï¼Œé‚£ä¹ˆåœ¨å®é™…ä½¿ç”¨ä¸­çœŸçš„å‘ç”Ÿç¼“å­˜é›ªå´©äº†ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™æ—¶æˆ‘ä»¬å°±è¦è€ƒè™‘ä½¿ç”¨å…¶ä»–æ–¹æ³•é¿å…å‡ºç°è¿™ç§æƒ…å†µäº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ehcache æœ¬åœ°ç¼“å­˜ + Hystrix é™æµ&amp;amp;é™çº§ ,é¿å… MySQL è¢«æ‰“æ­»çš„æƒ…å†µå‘ç”Ÿã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œä½¿ç”¨&lt;code&gt;echache&lt;/code&gt;æœ¬åœ°ç¼“å­˜çš„ç›®çš„å°±æ˜¯è€ƒè™‘åœ¨ Redis Cluster å®Œå…¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œehcache æœ¬åœ°ç¼“å­˜è¿˜èƒ½å¤Ÿæ”¯æ’‘ä¸€é˜µã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½¿ç”¨ Hystrix è¿›è¡Œ é™æµ &amp;amp; é™çº§ ï¼Œæ¯”å¦‚ä¸€ç§’æ¥äº†5000ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å‡è®¾åªèƒ½æœ‰ä¸€ç§’ 2000 ä¸ªè¯·æ±‚èƒ½é€šè¿‡è¿™ä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆå…¶ä»–å‰©ä½™çš„ 3000 è¯·æ±‚å°±ä¼šèµ°é™æµé€»è¾‘ï¼Œç„¶åå»è°ƒç”¨æˆ‘ä»¬è‡ªå·±å¼€å‘çš„é™çº§ç»„ä»¶ï¼ˆé™çº§ï¼‰ã€‚æ¯”å¦‚è®¾ç½®çš„ä¸€äº›é»˜è®¤å€¼å‘€ä¹‹ç±»çš„ã€‚ä»¥æ­¤æ¥ä¿æŠ¤æœ€åçš„ MySQL ä¸ä¼šè¢«å¤§é‡çš„è¯·æ±‚ç»™æ‰“æ­»ã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1.2.3 äº‹å&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœç¼“å­˜æœåŠ¡å®•æœºäº†ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å¼€å¯&lt;strong&gt;ã€ŒRedisã€&lt;/strong&gt; æŒä¹…åŒ– &lt;strong&gt;ã€ŒRDBã€&lt;/strong&gt;+&lt;strong&gt;ã€ŒAOFã€&lt;/strong&gt;ï¼Œä¸€æ—¦é‡å¯ï¼Œè‡ªåŠ¨ä»ç£ç›˜ä¸ŠåŠ è½½æ•°æ®ï¼Œå¿«é€Ÿæ¢å¤ç¼“å­˜æ•°æ®ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œå¯ç”»å‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.49296875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/k5430ljpYPNic3ic6iaK8z8O1MpctWOYFLEm3nLmcLGxT5M3SVOoKn842IJWazutbibkpaxr7ia8hv1ic4PmqypiaI7xQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;2. ç¼“å­˜ç©¿é€&lt;/span&gt;&lt;span/&gt;&lt;br/&gt;&lt;/h3&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;2.1 ä»€ä¹ˆæ˜¯ç¼“å­˜ç©¿é€&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨æ­£å¸¸çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·æŸ¥è¯¢æ•°æ®éƒ½æ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œç¼“å­˜ä¸æ•°æ®éƒ½æ²¡æœ‰æ•°æ®ï¼Œä½†æ˜¯ç”¨æˆ·ä¸æ–­å‘èµ·è¯·æ±‚ï¼Œè¿™æ ·æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæ‰“åˆ°æ•°æ®åº“ä¸Šé¢å»ï¼Œè¿™æ—¶çš„ç”¨æˆ·å¾ˆå¯èƒ½æ˜¯æ”»å‡»è€…ï¼Œæ”»å‡»ä¼šå¯¼è‡´æ•°æ®åº“å‹åŠ›è¿‡å¤§ï¼Œä¸¥é‡ä¼šå‡»å®æ•°æ®åº“ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.892925430210325&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/k5430ljpYPNic3ic6iaK8z8O1MpctWOYFLEiaZYfU1jKH8hJta1eXqzicJIYn0vfJObMF44txuXd1G3iaQ7306bM83iaA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;523&quot;/&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;2.2 è§£å†³åŠæ³•&lt;/span&gt;&lt;span/&gt;&lt;br/&gt;&lt;/h4&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2.2.1 æ·»åŠ å‚æ•°æ ¡éªŒ&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘åˆšå…¥èŒçš„æ—¶å€™ï¼Œæˆ‘çš„è€å¤§å°±è·Ÿæˆ‘è¯´è¿‡ï¼Œä½œä¸ºä¸€ååç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œä¸è¦ç›¸ä¿¡å‰ç«¯ä¼ æ¥çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æ•°æ®ä¸€å®šè¦åœ¨åç«¯è¿›è¡Œæ ¡éªŒã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ¥å£å±‚æ·»åŠ æ ¡éªŒï¼Œä¸åˆæ³•çš„ç›´æ¥è¿”å›å³å¯ï¼Œæ²¡å¿…è¦åšåç»­çš„æ“ä½œã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2.2.2 ç¼“å­˜ç©ºå€¼&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸Šé¢æˆ‘ä»¬ä¹Ÿä»‹ç»äº†ï¼Œä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿç©¿é€ï¼Œå°±æ˜¯å› ä¸ºç¼“å­˜ä¸­æ²¡æœ‰å­˜å‚¨è¿™äº›ç©ºæ•°æ®çš„keyã€‚ä»è€Œå¯¼è‡´æ¯æ¬¡æŸ¥è¯¢éƒ½åˆ°æ•°æ®åº“å»äº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¸ºè¿™äº›key è®¾ç½®çš„å€¼è®¾ç½®ä¸ºnull ä¸¢åˆ°ç¼“å­˜é‡Œé¢å»ã€‚åé¢å†å‡ºç°æŸ¥è¯¢è¿™ä¸ªkey çš„è¯·æ±‚çš„æ—¶å€™ï¼Œç›´æ¥è¿”å›null ,å°±ä¸ç”¨åœ¨åˆ° æ•°æ®åº“ä¸­å»èµ°ä¸€åœˆäº†ã€‚ä½†æ˜¯åˆ«å¿˜äº†è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2.2.3 å¸ƒéš†è¿‡æ»¤å™¨&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;redis&lt;/code&gt;çš„ä¸€ä¸ªé«˜çº§ç”¨æ³•å°±æ˜¯ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom Filterï¼‰ï¼ŒBloomFilter ç±»ä¼¼äºä¸€ä¸ªhase set ç”¨æ¥åˆ¤æ–­æŸä¸ªå…ƒç´ ï¼ˆkeyï¼‰æ˜¯å¦å­˜åœ¨äºæŸä¸ªé›†åˆä¸­ã€‚è¿™ä¸ªä¹Ÿèƒ½å¾ˆå¥½çš„é˜²æ­¢ç¼“å­˜ç©¿é€çš„å‘ç”Ÿï¼Œä»–çš„åŸç†ä¹Ÿå¾ˆç®€å•å°±æ˜¯åˆ©ç”¨é«˜æ•ˆçš„æ•°æ®ç»“æ„å’Œç®—æ³•å¿«é€Ÿåˆ¤æ–­å‡ºä½ è¿™ä¸ªKeyæ˜¯å¦åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ï¼Œä¸å­˜åœ¨ä½ returnå°±å¥½äº†ï¼Œå­˜åœ¨ä½ å°±å»æŸ¥äº†DBåˆ·æ–°KVå†returnã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;2.2065009560229445&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/k5430ljpYPNic3ic6iaK8z8O1MpctWOYFLEqgMKiabiaQXNcZWKdID7A9xAG93kjbyOvTfaXcVibce7tC3fI1oRj4IoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;523&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸Šé¢ä»‹ç»äº†ä¸‰ç§æ–¹æ³•ï¼Œç”¨å“ªç§æ–¹æ³•æœ€å¥½å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼š&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¬¬ä¸€ç§æ–¹æ³•ï¼Œæ·»åŠ å‚æ•°æ ¡éªŒï¼Œè¿™é‡Œæ˜¯å¿…é¡»è¦æ·»åŠ ï¼Œä¸è¿‡åªèƒ½è¿‡æ»¤æ‰ä¸€äº›ç‰¹æ®Šå€¼ï¼Œæ¯”å¦‚ä¼ çš„&lt;code&gt;id&lt;/code&gt;ä¸ºè´Ÿæ•°ï¼Œå¦‚æœä¼ çš„æ­£å¸¸&lt;code&gt;id&lt;/code&gt;ï¼Œè¿™é‡Œå‚æ•°æ ¡éªŒå°±ä¸èµ·ä½œç”¨äº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¬¬äºŒç§æ–¹æ³•ï¼Œå¦‚æœæœ‰ä¸€äº›æ¶æ„æ”»å‡»ï¼Œæ”»å‡»ä¼šå¸¦æ¥å¤§é‡çš„ke yæ˜¯ä¸å­˜åœ¨çš„ï¼Œè¿™æ ·é‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•å°±ä¸åˆé€‚äº†ã€‚æ‰€ä»¥é’ˆå¯¹è¿™ç§key å¼‚å¸¸å¤šï¼Œè¯·æ±‚é‡å¤ç‡æ¯”è¾ƒä½çš„æ•°æ®ï¼Œæˆ‘ä»¬å°±æ²¡æœ‰å¿…è¦è¿›è¡Œç¼“å­˜ï¼Œä½¿ç”¨ç¬¬ä¸‰ç§æ–¹æ¡ˆç›´æ¥è¿‡æ»¤æ‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœå¯¹äºç©ºæ•°æ®keyæœ‰é™çš„ï¼Œé‡å¤ç‡æ¯”è¾ƒé«˜çš„ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼è¿›è¡Œç¼“å­˜ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;3. ç¼“å­˜å‡»ç©¿&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;3.1 ä»€ä¹ˆæ˜¯ç¼“å­˜å‡»ç©¿&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬åœ¨å¹³å¸¸é«˜å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œå¤§é‡çš„è¯·æ±‚åŒæ—¶æŸ¥è¯¢ä¸€ä¸ªkeyæ—¶ï¼Œå‡è®¾æ­¤æ—¶ï¼Œè¿™ä¸ªkeyæ­£å¥½å¤±æ•ˆäº†ï¼Œå°±ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚éƒ½æ‰“åˆ°æ•°æ®åº“ä¸Šé¢å»ï¼Œè¿™ç§ç°è±¡æˆ‘ä»¬ç§°ä¸ºå‡»ç©¿ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¹ˆçœ‹ç¼“å­˜å‡»ç©¿å’Œç¼“å­˜é›ªå´©æœ‰ç‚¹åƒï¼Œä½†æ˜¯åˆæœ‰ä¸€ç‚¹ä¸ä¸€æ ·ï¼Œç¼“å­˜é›ªå´©æ˜¯å› ä¸ºå¤§é¢ç§¯çš„ç¼“å­˜å¤±æ•ˆï¼Œæ‰“å´©äº†DBï¼Œè€Œç¼“å­˜å‡»ç©¿ä¸åŒçš„æ˜¯&lt;strong&gt;ã€Œç¼“å­˜å‡»ç©¿ã€&lt;/strong&gt;æ˜¯æŒ‡ä¸€ä¸ªKeyéå¸¸çƒ­ç‚¹ï¼Œåœ¨ä¸åœçš„æ‰›ç€å¤§å¹¶å‘ï¼Œå¤§å¹¶å‘é›†ä¸­å¯¹è¿™ä¸€ä¸ªç‚¹è¿›è¡Œè®¿é—®ï¼Œå½“è¿™ä¸ªKeyåœ¨å¤±æ•ˆçš„ç¬é—´ï¼ŒæŒç»­çš„å¤§å¹¶å‘å°±ç©¿ç ´ç¼“å­˜ï¼Œç›´æ¥è¯·æ±‚æ•°æ®åº“ï¼Œå°±åƒåœ¨ä¸€ä¸ªå®Œå¥½æ— æŸçš„æ¡¶ä¸Šå‡¿å¼€äº†ä¸€ä¸ªæ´ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¼“å­˜å‡»ç©¿å¸¦æ¥çš„é—®é¢˜å°±æ˜¯ä¼šé€ æˆæŸä¸€æ—¶åˆ»æ•°æ®åº“è¯·æ±‚é‡è¿‡å¤§ï¼Œå‹åŠ›å‰§å¢ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;span/&gt;3.2 è§£å†³åŠæ³•&lt;/span&gt;&lt;span/&gt;&lt;/h4&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;3.2.1 ä¸è¿‡æœŸ&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬ç®€å•ç²—æš´ç‚¹ï¼Œç›´æ¥è®©çƒ­ç‚¹æ•°æ®æ°¸è¿œä¸è¿‡æœŸï¼Œå®šæ—¶ä»»åŠ¡å®šæœŸå»åˆ·æ–°æ•°æ®å°±å¯ä»¥äº†ã€‚ä¸è¿‡è¿™æ ·è®¾ç½®éœ€è¦åŒºåˆ†åœºæ™¯ï¼Œæ¯”å¦‚æŸå®é¦–é¡µå¯ä»¥è¿™ä¹ˆåšã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;3.2.2 äº’æ–¥é”&lt;/span&gt;&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†é¿å…å‡ºç°ç¼“å­˜å‡»ç©¿çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚å»æŸ¥è¯¢æ•°æ®åº“çš„æ—¶å€™å¯¹ä»–åŠ ä¸€ä¸ªäº’æ–¥é”ï¼Œå…¶ä½™çš„æŸ¥è¯¢è¯·æ±‚éƒ½ä¼šè¢«é˜»å¡ä½ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾ï¼Œåé¢çš„çº¿ç¨‹è¿›æ¥å‘ç°å·²ç»æœ‰ç¼“å­˜äº†ï¼Œå°±ç›´æ¥èµ°ç¼“å­˜ï¼Œä»è€Œä¿æŠ¤æ•°æ®åº“ã€‚ä½†æ˜¯ä¹Ÿæ˜¯ç”±äºå®ƒä¼šé˜»å¡å…¶ä»–çš„çº¿ç¨‹ï¼Œæ­¤æ—¶ç³»ç»Ÿååé‡ä¼šä¸‹é™ã€‚éœ€è¦ç»“åˆå®é™…çš„ä¸šåŠ¡å»è€ƒè™‘æ˜¯å¦è¦è¿™ä¹ˆåšã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;span/&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¥½å•¦ï¼Œåˆ†æåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œè¿™ä¸€ğŸ’‹ç®€å•ä»‹ç»äº†&lt;strong&gt;ã€ŒRedisã€&lt;/strong&gt;çš„&lt;strong&gt;ã€Œé›ªå´©ã€&lt;/strong&gt;ï¼Œ&lt;strong&gt;ã€Œå‡»ç©¿ã€&lt;/strong&gt;ï¼Œ&lt;strong&gt;ã€Œç©¿é€ã€&lt;/strong&gt;ï¼Œä¸‰è€…å…¶å®éƒ½å·®ä¸å¤šï¼Œä½†æ˜¯åˆæœ‰ä¸€äº›åŒºåˆ«ï¼Œåœ¨é¢è¯•ä¸­å…¶å®è¿™æ˜¯é—®åˆ°ç¼“å­˜å¿…é—®çš„ï¼Œå¤§å®¶ä¸è¦æŠŠä¸‰è€…ææ··äº†ï¼Œå› ä¸ºç¼“å­˜é›ªå´©ã€ç©¿é€å’Œå‡»ç©¿ï¼Œæ˜¯ç¼“å­˜æœ€å¤§çš„é—®é¢˜ï¼Œè¦ä¹ˆä¸å‡ºç°ï¼Œä¸€æ—¦å‡ºç°å°±æ˜¯è‡´å‘½æ€§çš„é—®é¢˜ï¼Œ&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å†æ¬¡å¼ºè°ƒä¸€ä¸‹ï¼Œä¸Šé¢è¿™ä¸‰ä¸ªçŸ¥è¯†ç‚¹çœŸçš„å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨é¡¹ç›®è®¾è®¡æ—¶ï¼Œè¿™äº›éƒ½æ˜¯è¦è€ƒè™‘çš„ï¼Œæ‰€ä»¥ä¸€å®šçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€åæ‰“ä¸€æ³¢é¢„å‘Šå§ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« å†…å®¹ï¼šã€Šç¼“å­˜æ›´æ–°çš„å¥—è·¯ã€‹ï¼›æ•¬è¯·æœŸå¾…ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œç»“å°¾ç»™å¤§å®¶å‘ä¸€ä¸ªå°ç¦åˆ©å§ï¼Œæœ€è¿‘æˆ‘åœ¨çœ‹[å¾®æœåŠ¡æ¶æ„è®¾è®¡æ¨¡å¼]è¿™ä¸€æœ¬ä¹¦ï¼Œè®²çš„å¾ˆå¥½ï¼Œè‡ªå·±ä¹Ÿæ”¶é›†äº†ä¸€æœ¬PDFï¼Œæœ‰éœ€è¦çš„å°ä¼™å¯ä»¥åˆ°è‡ªè¡Œä¸‹è½½ã€‚è·å–æ–¹å¼ï¼šå…³æ³¨å…¬ä¼—å·ï¼š[Golangæ¢¦å·¥å‚]ï¼Œåå°å›å¤ï¼š[å¾®æœåŠ¡]ï¼Œå³å¯è·å–ã€‚ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œæˆ‘ç¿»è¯‘äº†ä¸€ä»½GINä¸­æ–‡æ–‡æ¡£ï¼Œä¼šå®šæœŸè¿›è¡Œç»´æŠ¤ï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´åå°å›å¤[gin]å³å¯ä¸‹è½½ã€‚ã€&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ã€Œæˆ‘æ˜¯asongï¼Œä¸€åæ™®æ™®é€šé€šçš„ç¨‹åºçŒ¿ï¼Œè®©æˆ‘ä¸€èµ·æ…¢æ…¢å˜å¼ºå§ã€‚æˆ‘è‡ªå·±å»ºäº†ä¸€ä¸ª&lt;code&gt;golang&lt;/code&gt;äº¤æµç¾¤ï¼Œæœ‰éœ€è¦çš„å°ä¼™ä¼´åŠ æˆ‘&lt;code&gt;vx&lt;/code&gt;,æˆ‘æ‹‰ä½ å…¥ç¾¤ã€‚æ¬¢è¿å„ä½çš„å…³æ³¨ï¼Œæˆ‘ä»¬ä¸‹æœŸè§~~~ã€&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/k5430ljpYPNic3ic6iaK8z8O1MpctWOYFLESN5Cj4H6rld3vVlTVvN84Q98Fn4JDzVm9Eo0nMhyZpflfbeLEBS3BQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¨èå¾€æœŸæ–‡ç« ï¼š&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>d57371e4e1fb4835ce1dec4639db21b1</guid>
<title>[æ¨è] é¢è¯•å®˜ï¼šå¦‚ä½•å†™å‡ºè®© CPU è·‘å¾—æ›´å¿«çš„ä»£ç ï¼Ÿ</title>
<link>https://toutiao.io/k/l6chi61</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.6356877323420075&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DU5g3I7vpskPKGc2AVN5icSasGiaxoa1NIJWILJqTibPeibIZv2jkj6ianZSw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1076&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;hr/&gt;&lt;h2&gt;&lt;span&gt;å‰è¨€&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;ä»£ç éƒ½æ˜¯ç”± CPU è·‘èµ·æ¥çš„ï¼Œæˆ‘ä»¬ä»£ç å†™çš„å¥½ä¸åå°±å†³å®šäº† CPU çš„æ‰§è¡Œæ•ˆç‡ï¼Œç‰¹åˆ«æ˜¯åœ¨ç¼–å†™è®¡ç®—å¯†é›†å‹çš„ç¨‹åºï¼Œæ›´è¦æ³¨é‡ CPU çš„æ‰§è¡Œæ•ˆç‡ï¼Œå¦åˆ™å°†ä¼šå¤§å¤§å½±å“ç³»ç»Ÿæ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;CPU å†…éƒ¨åµŒå…¥äº† CPU Cacheï¼ˆé«˜é€Ÿç¼“å­˜ï¼‰ï¼Œå®ƒçš„å­˜å‚¨å®¹é‡å¾ˆå°ï¼Œä½†æ˜¯ç¦» CPU æ ¸å¿ƒå¾ˆè¿‘ï¼Œæ‰€ä»¥ç¼“å­˜çš„è¯»å†™é€Ÿåº¦æ˜¯æå¿«çš„ï¼Œé‚£ä¹ˆå¦‚æœ CPU è¿ç®—æ—¶ï¼Œç›´æ¥ä» CPU Cache è¯»å–æ•°æ®ï¼Œè€Œä¸æ˜¯ä»å†…å­˜çš„è¯ï¼Œè¿ç®—é€Ÿåº¦å°±ä¼šå¾ˆå¿«ã€‚&lt;/p&gt;&lt;p&gt;ä½†æ˜¯ï¼Œå¤§å¤šæ•°äººä¸çŸ¥é“ CPU Cache çš„è¿è¡Œæœºåˆ¶ï¼Œä»¥è‡³äºä¸çŸ¥é“å¦‚ä½•æ‰èƒ½å¤Ÿå†™å‡ºèƒ½å¤Ÿé…åˆ CPU Cache å·¥ä½œæœºåˆ¶çš„ä»£ç ï¼Œä¸€æ—¦ä½ æŒæ¡äº†å®ƒï¼Œä½ å†™ä»£ç çš„æ—¶å€™ï¼Œå°±æœ‰æ–°çš„ä¼˜åŒ–æ€è·¯äº†ã€‚&lt;/p&gt;&lt;p&gt;é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼ŒCPU Cache åˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Œåˆè¯¥å†™å‡ºè®© CPU æ‰§è¡Œæ›´å¿«çš„ä»£ç å‘¢ï¼Ÿ&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.34772462077012833&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUqltTazYGAUDNlrTfuPx6rgBxLw3ynWVJIQSGAVlM7bc73W4znSPoZg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1714&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;hr/&gt;&lt;h2&gt;&lt;span&gt;æ­£æ–‡&lt;/span&gt;&lt;/h2&gt;&lt;h3&gt;&lt;span&gt;CPU Cache æœ‰å¤šå¿«ï¼Ÿ&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h3&gt;&lt;p&gt;ä½ å¯èƒ½ä¼šå¥½å¥‡ä¸ºä»€ä¹ˆæœ‰äº†å†…å­˜ï¼Œè¿˜éœ€è¦ CPU Cacheï¼Ÿæ ¹æ®æ‘©å°”å®šå¾‹ï¼ŒCPU çš„è®¿é—®é€Ÿåº¦æ¯ 18 ä¸ªæœˆå°±ä¼šç¿»å€ï¼Œç›¸å½“äºæ¯å¹´å¢é•¿ 60% å·¦å³ï¼Œå†…å­˜çš„é€Ÿåº¦å½“ç„¶ä¹Ÿä¼šä¸æ–­å¢é•¿ï¼Œä½†æ˜¯å¢é•¿çš„é€Ÿåº¦è¿œå°äº CPUï¼Œå¹³å‡æ¯å¹´åªå¢é•¿ 7% å·¦å³ã€‚äºæ˜¯ï¼ŒCPU ä¸å†…å­˜çš„è®¿é—®æ€§èƒ½çš„å·®è·ä¸æ–­æ‹‰å¤§ã€‚&lt;/p&gt;&lt;p&gt;åˆ°ç°åœ¨ï¼Œä¸€æ¬¡å†…å­˜è®¿é—®æ‰€éœ€æ—¶é—´æ˜¯ &lt;code&gt;200~300&lt;/code&gt; å¤šä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè¿™æ„å‘³ç€ CPU å’Œå†…å­˜çš„è®¿é—®é€Ÿåº¦å·²ç»ç›¸å·® &lt;code&gt;200~300&lt;/code&gt; å¤šå€äº†ã€‚&lt;/p&gt;&lt;p&gt;ä¸ºäº†å¼¥è¡¥ CPU ä¸å†…å­˜ä¸¤è€…ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œå°±åœ¨ CPU å†…éƒ¨å¼•å…¥äº† Â CPU Cacheï¼Œä¹Ÿç§°é«˜é€Ÿç¼“å­˜ã€‚&lt;/p&gt;&lt;p&gt;CPU Cache é€šå¸¸åˆ†ä¸ºå¤§å°ä¸ç­‰çš„ä¸‰çº§ç¼“å­˜ï¼Œåˆ†åˆ«æ˜¯ &lt;strong&gt;L1 Cacheã€L2 Cache å’Œ L3 Cache&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;ç”±äº CPU Cache æ‰€ä½¿ç”¨çš„ææ–™æ˜¯ SRAMï¼Œä»·æ ¼æ¯”å†…å­˜ä½¿ç”¨çš„ DRAM é«˜å‡ºå¾ˆå¤šï¼Œåœ¨å½“ä»Šæ¯ç”Ÿäº§ 1 MB å¤§å°çš„ CPU Cache éœ€è¦ 7 ç¾é‡‘çš„æˆæœ¬ï¼Œè€Œå†…å­˜åªéœ€è¦ 0.015 ç¾é‡‘çš„æˆæœ¬ï¼Œæˆæœ¬æ–¹é¢ç›¸å·®äº† 466 å€ï¼Œæ‰€ä»¥ CPU Cache ä¸åƒå†…å­˜é‚£æ ·åŠ¨è¾„ä»¥ GB è®¡ç®—ï¼Œå®ƒçš„å¤§å°æ˜¯ä»¥ KB æˆ– MB æ¥è®¡ç®—çš„ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹å›¾çš„æ–¹å¼æ¥æŸ¥çœ‹å„çº§ CPU Cache çš„å¤§å°ï¼Œæ¯”å¦‚æˆ‘è¿™æ‰‹ä¸Šè¿™å°æœåŠ¡å™¨ï¼Œç¦» CPU æ ¸å¿ƒæœ€è¿‘çš„ L1 Cache æ˜¯ 32KBï¼Œå…¶æ¬¡æ˜¯ L2 Cache æ˜¯ 256KBï¼Œæœ€å¤§çš„ L3 Cache åˆ™æ˜¯ 3MBã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.7211740041928721&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUiaYtfLibicW11HOurkPCxZ6WcY0JHr1oGpcRvyNKsozexRSR3iaUzpulVg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;954&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å…¶ä¸­ï¼Œ&lt;strong&gt;L1 Cache é€šå¸¸ä¼šåˆ†ä¸ºã€Œæ•°æ®ç¼“å­˜ã€å’Œã€ŒæŒ‡ä»¤ç¼“å­˜ã€&lt;/strong&gt;ï¼Œè¿™æ„å‘³ç€æ•°æ®å’ŒæŒ‡ä»¤åœ¨ L1 Cache è¿™ä¸€å±‚æ˜¯åˆ†å¼€ç¼“å­˜çš„ï¼Œä¸Šå›¾ä¸­çš„ &lt;code&gt;index0&lt;/code&gt; ä¹Ÿå°±æ˜¯æ•°æ®ç¼“å­˜ï¼Œè€Œ &lt;code&gt;index1&lt;/code&gt; åˆ™æ˜¯æŒ‡ä»¤ç¼“å­˜ï¼Œå®ƒä¸¤çš„å¤§å°é€šå¸¸æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œä½ ä¹Ÿä¼šæ³¨æ„åˆ°ï¼ŒL3 Cache æ¯” L1 Cache å’Œ L2 Cache å¤§å¾ˆå¤šï¼Œè¿™æ˜¯å› ä¸º &lt;strong&gt;L1 Cache å’Œ L2 Cache éƒ½æ˜¯æ¯ä¸ª CPU æ ¸å¿ƒç‹¬æœ‰çš„ï¼Œè€Œ L3 Cache æ˜¯å¤šä¸ª CPU æ ¸å¿ƒå…±äº«çš„ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;ç¨‹åºæ‰§è¡Œæ—¶ï¼Œä¼šå…ˆå°†å†…å­˜ä¸­çš„æ•°æ®åŠ è½½åˆ°å…±äº«çš„ L3 Cache ä¸­ï¼Œå†åŠ è½½åˆ°æ¯ä¸ªæ ¸å¿ƒç‹¬æœ‰çš„ L2 Cacheï¼Œæœ€åè¿›å…¥åˆ°æœ€å¿«çš„ L1 Cacheï¼Œä¹‹åæ‰ä¼šè¢« CPU è¯»å–ã€‚å®ƒä»¬ä¹‹é—´çš„å±‚çº§å…³ç³»ï¼Œå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.6649056603773585&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUZic96QWC2PPxCPP9HeOPgzcmfSj9I80u1W15JpyIUib3LbibMpjFTh0Rw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1325&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¶Šé è¿‘ CPU æ ¸å¿ƒçš„ç¼“å­˜å…¶è®¿é—®é€Ÿåº¦è¶Šå¿«ï¼ŒCPU è®¿é—® L1 Cache åªéœ€è¦ &lt;code&gt;2~4&lt;/code&gt; ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè®¿é—® L2 Cache å¤§çº¦ &lt;code&gt;10~20&lt;/code&gt; ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè®¿é—® L3 Cache å¤§çº¦ &lt;code&gt;20~60&lt;/code&gt; ä¸ªæ—¶é’Ÿå‘¨æœŸï¼Œè€Œè®¿é—®å†…å­˜é€Ÿåº¦å¤§æ¦‚åœ¨ &lt;code&gt;200~300&lt;/code&gt; ä¸ª æ—¶é’Ÿå‘¨æœŸä¹‹é—´ã€‚å¦‚ä¸‹è¡¨æ ¼ï¼š&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.5965189873417721&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUwhcPrwJ0d1niaQBKwCcsIvXC5Bm5MibIsgRum9riaEg7z2WibopJGaQQug/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;632&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;strong&gt;æ‰€ä»¥ï¼ŒCPU ä» L1 Cache è¯»å–æ•°æ®çš„é€Ÿåº¦ï¼Œç›¸æ¯”ä»å†…å­˜è¯»å–çš„é€Ÿåº¦ï¼Œä¼šå¿« &lt;code&gt;100&lt;/code&gt; å¤šå€ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;hr/&gt;&lt;h3&gt;&lt;span&gt;CPU Cache çš„æ•°æ®ç»“æ„å’Œè¯»å–è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h3&gt;&lt;p&gt;CPU Cache çš„æ•°æ®æ˜¯ä»å†…å­˜ä¸­è¯»å–è¿‡æ¥çš„ï¼Œå®ƒæ˜¯ä»¥ä¸€å°å—ä¸€å°å—è¯»å–æ•°æ®çš„ï¼Œè€Œä¸æ˜¯æŒ‰ç…§å•ä¸ªæ•°ç»„å…ƒç´ æ¥è¯»å–æ•°æ®çš„ï¼Œåœ¨ CPU Cache ä¸­çš„ï¼Œè¿™æ ·ä¸€å°å—ä¸€å°å—çš„æ•°æ®ï¼Œç§°ä¸º &lt;strong&gt;Cache Lineï¼ˆç¼“å­˜å—ï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;ä½ å¯ä»¥åœ¨ä½ çš„ Linux ç³»ç»Ÿï¼Œç”¨ä¸‹é¢è¿™ç§æ–¹å¼æ¥æŸ¥çœ‹ CPU çš„ Cache Lineï¼Œä½ å¯ä»¥çœ‹æˆ‘æœåŠ¡å™¨çš„ L1 Cache Line å¤§å°æ˜¯ 64 å­—èŠ‚ï¼Œä¹Ÿå°±æ„å‘³ç€ &lt;strong&gt;L1 Cache ä¸€æ¬¡è½½å…¥æ•°æ®çš„å¤§å°æ˜¯ 64 å­—èŠ‚&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.20949263502454993&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUpgXIYYgic3eJ5SHJNKFVRnLPwCd2qNnEGEichslHoZLWt8GsyEu49Nqg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1222&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ª &lt;code&gt;int array[100]&lt;/code&gt; çš„æ•°ç»„ï¼Œå½“è½½å…¥ &lt;code&gt;array[0]&lt;/code&gt; æ—¶ï¼Œç”±äºè¿™ä¸ªæ•°ç»„å…ƒç´ çš„å¤§å°åœ¨å†…å­˜åªå  4 å­—èŠ‚ï¼Œä¸è¶³ 64 å­—èŠ‚ï¼ŒCPU å°±ä¼š&lt;strong&gt;é¡ºåºåŠ è½½&lt;/strong&gt;æ•°ç»„å…ƒç´ åˆ° &lt;code&gt;array[15]&lt;/code&gt;ï¼Œæ„å‘³ç€ &lt;code&gt;array[0]~array[15]&lt;/code&gt; æ•°ç»„å…ƒç´ éƒ½ä¼šè¢«ç¼“å­˜åœ¨ CPU Cache ä¸­äº†ï¼Œå› æ­¤å½“ä¸‹æ¬¡è®¿é—®è¿™äº›æ•°ç»„å…ƒç´ æ—¶ï¼Œä¼šç›´æ¥ä» CPU Cache è¯»å–ï¼Œè€Œä¸ç”¨å†ä»å†…å­˜ä¸­è¯»å–ï¼Œå¤§å¤§æé«˜äº† CPU è¯»å–æ•°æ®çš„æ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;äº‹å®ä¸Šï¼ŒCPU è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œæ— è®ºæ•°æ®æ˜¯å¦å­˜æ”¾åˆ° Cache ä¸­ï¼ŒCPU éƒ½æ˜¯å…ˆè®¿é—® Cacheï¼Œåªæœ‰å½“ Cache ä¸­æ‰¾ä¸åˆ°æ•°æ®æ—¶ï¼Œæ‰ä¼šå»è®¿é—®å†…å­˜ï¼Œå¹¶æŠŠå†…å­˜ä¸­çš„æ•°æ®è¯»å…¥åˆ° Cache ä¸­ï¼ŒCPU å†ä» CPU Cache è¯»å–æ•°æ®ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.5844875346260388&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUfV2liaq9Sm18DGvnOFhxAHpGX1U3GqBwNlyj3W2biaRLeWTsv6NBrdvA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;722&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;è¿™æ ·çš„è®¿é—®æœºåˆ¶ï¼Œè·Ÿæˆ‘ä»¬ä½¿ç”¨ã€Œå†…å­˜ä½œä¸ºç¡¬ç›˜çš„ç¼“å­˜ã€çš„é€»è¾‘æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœå†…å­˜æœ‰ç¼“å­˜çš„æ•°æ®ï¼Œåˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™è¦è®¿é—®é¾Ÿé€Ÿä¸€èˆ¬çš„ç¡¬ç›˜ã€‚&lt;/p&gt;&lt;p&gt;é‚£ CPU æ€ä¹ˆçŸ¥é“è¦è®¿é—®çš„å†…å­˜æ•°æ®ï¼Œæ˜¯å¦åœ¨ Cache é‡Œï¼Ÿå¦‚æœåœ¨çš„è¯ï¼Œå¦‚ä½•æ‰¾åˆ° Cache å¯¹åº”çš„æ•°æ®å‘¢ï¼Ÿæˆ‘ä»¬ä»æœ€ç®€å•ã€åŸºç¡€çš„&lt;strong&gt;ç›´æ¥æ˜ å°„ Cacheï¼ˆ&lt;em&gt;Direct Mapped Cache&lt;/em&gt;ï¼‰&lt;/strong&gt; è¯´èµ·ï¼Œæ¥çœ‹çœ‹æ•´ä¸ª CPU Cache çš„æ•°æ®ç»“æ„å’Œè®¿é—®é€»è¾‘ã€‚&lt;/p&gt;&lt;p&gt;å‰é¢ï¼Œæˆ‘ä»¬æåˆ° CPU è®¿é—®å†…å­˜æ•°æ®æ—¶ï¼Œæ˜¯ä¸€å°å—ä¸€å°å—æ•°æ®è¯»å–çš„ï¼Œå…·ä½“è¿™ä¸€å°å—æ•°æ®çš„å¤§å°ï¼Œå–å†³äº &lt;code&gt;coherency_line_size&lt;/code&gt; çš„å€¼ï¼Œä¸€èˆ¬ 64 å­—èŠ‚ã€‚åœ¨å†…å­˜ä¸­ï¼Œè¿™ä¸€å—çš„æ•°æ®æˆ‘ä»¬ç§°ä¸º&lt;strong&gt;å†…å­˜å—ï¼ˆ&lt;em&gt;Bock&lt;/em&gt;ï¼‰&lt;/strong&gt;ï¼Œè¯»å–çš„æ—¶å€™æˆ‘ä»¬è¦æ‹¿åˆ°æ•°æ®æ‰€åœ¨å†…å­˜å—çš„åœ°å€ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºç›´æ¥æ˜ å°„ Cache é‡‡ç”¨çš„ç­–ç•¥ï¼Œå°±æ˜¯æŠŠå†…å­˜å—çš„åœ°å€å§‹ç»ˆã€Œæ˜ å°„ã€åœ¨ä¸€ä¸ª CPU Lineï¼ˆç¼“å­˜å—ï¼‰ çš„åœ°å€ï¼Œè‡³äºæ˜ å°„å…³ç³»å®ç°æ–¹å¼ï¼Œåˆ™æ˜¯ä½¿ç”¨ã€Œå–æ¨¡è¿ç®—ã€ï¼Œå–æ¨¡è¿ç®—çš„ç»“æœå°±æ˜¯å†…å­˜å—åœ°å€å¯¹åº”çš„ CPU Lineï¼ˆç¼“å­˜å—ï¼‰ çš„åœ°å€ã€‚&lt;/p&gt;&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå†…å­˜å…±è¢«åˆ’åˆ†ä¸º 32 ä¸ªå†…å­˜å—ï¼ŒCPU Cache å…±æœ‰ 8 ä¸ª CPU Lineï¼Œå‡è®¾ CPU æƒ³è¦è®¿é—®ç¬¬ 15 å·å†…å­˜å—ï¼Œå¦‚æœ 15 å·å†…å­˜å—ä¸­çš„æ•°æ®å·²ç»ç¼“å­˜åœ¨ CPU Line ä¸­çš„è¯ï¼Œåˆ™æ˜¯ä¸€å®šæ˜ å°„åœ¨ 7 å· CPU Line ä¸­ï¼Œå› ä¸º &lt;code&gt;15 % 8&lt;/code&gt; çš„å€¼æ˜¯ 7ã€‚&lt;/p&gt;&lt;p&gt;æœºæ™ºçš„ä½ è‚¯å®šå‘ç°äº†ï¼Œä½¿ç”¨å–æ¨¡æ–¹å¼æ˜ å°„çš„è¯ï¼Œå°±ä¼šå‡ºç°å¤šä¸ªå†…å­˜å—å¯¹åº”åŒä¸€ä¸ª CPU Lineï¼Œæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œé™¤äº† 15 å·å†…å­˜å—æ˜¯æ˜ å°„åœ¨ 7 å· CPU Line ä¸­ï¼Œè¿˜æœ‰ 7 å·ã€23 å·ã€31 å·å†…å­˜å—éƒ½æ˜¯æ˜ å°„åˆ° 7 å· CPU Line ä¸­ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;1.0351390922401171&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUwLEOS9ugA1Km1PvBQf6zJ9ffp8HzIFBo5AdqI87aUqO25SUUExafHQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;683&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å› æ­¤ï¼Œä¸ºäº†åŒºåˆ«ä¸åŒçš„å†…å­˜å—ï¼Œåœ¨å¯¹åº”çš„ CPU Line ä¸­æˆ‘ä»¬è¿˜ä¼šå­˜å‚¨ä¸€ä¸ª&lt;strong&gt;ç»„æ ‡è®°ï¼ˆTagï¼‰&lt;/strong&gt;ã€‚è¿™ä¸ªç»„æ ‡è®°ä¼šè®°å½•å½“å‰ CPU Line ä¸­å­˜å‚¨çš„æ•°æ®å¯¹åº”çš„å†…å­˜å—ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç»„æ ‡è®°æ¥åŒºåˆ†ä¸åŒçš„å†…å­˜å—ã€‚&lt;/p&gt;&lt;p&gt;é™¤äº†ç»„æ ‡è®°ä¿¡æ¯å¤–ï¼ŒCPU Line è¿˜æœ‰ä¸¤ä¸ªä¿¡æ¯ï¼š&lt;/p&gt;&lt;p&gt;CPU åœ¨ä» CPU Cache è¯»å–æ•°æ®çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯è¯»å– CPU Line ä¸­çš„æ•´ä¸ªæ•°æ®å—ï¼Œè€Œæ˜¯è¯»å– CPU æ‰€éœ€è¦çš„ä¸€ä¸ªæ•°æ®ç‰‡æ®µï¼Œè¿™æ ·çš„æ•°æ®ç»Ÿç§°ä¸ºä¸€ä¸ª&lt;strong&gt;å­—ï¼ˆ&lt;em&gt;Word&lt;/em&gt;ï¼‰&lt;/strong&gt;ã€‚é‚£æ€ä¹ˆåœ¨å¯¹åº”çš„ CPU Line ä¸­æ•°æ®å—ä¸­æ‰¾åˆ°æ‰€éœ€çš„å­—å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œéœ€è¦ä¸€ä¸ª&lt;strong&gt;åç§»é‡ï¼ˆOffsetï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œä¸€ä¸ªå†…å­˜çš„è®¿é—®åœ°å€ï¼ŒåŒ…æ‹¬&lt;strong&gt;ç»„æ ‡è®°ã€CPU Line ç´¢å¼•ã€åç§»é‡&lt;/strong&gt;è¿™ä¸‰ç§ä¿¡æ¯ï¼Œäºæ˜¯ CPU å°±èƒ½é€šè¿‡è¿™äº›ä¿¡æ¯ï¼Œåœ¨ CPU Cache ä¸­æ‰¾åˆ°ç¼“å­˜çš„æ•°æ®ã€‚è€Œå¯¹äº CPU Cache é‡Œçš„æ•°æ®ç»“æ„ï¼Œåˆ™æ˜¯ç”±&lt;strong&gt;ç´¢å¼• + æœ‰æ•ˆä½ + ç»„æ ‡è®° + æ•°æ®å—&lt;/strong&gt;ç»„æˆã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.6840363937138131&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUGmFpHBHryZfZCrS1CcXAAXwZq4la5afWIFtIfATQJpGGGBQkicIMcHQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1209&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å¦‚æœå†…å­˜ä¸­çš„æ•°æ®å·²ç»åœ¨ CPU Cahe ä¸­äº†ï¼Œé‚£ CPU è®¿é—®ä¸€ä¸ªå†…å­˜åœ°å€çš„æ—¶å€™ï¼Œä¼šç»å†è¿™ 4 ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ ¹æ®å†…å­˜åœ°å€ä¸­ç´¢å¼•ä¿¡æ¯ï¼Œè®¡ç®—åœ¨ CPU Cahe ä¸­çš„ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯æ‰¾å‡ºå¯¹åº”çš„ CPU Line çš„åœ°å€ï¼›&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ‰¾åˆ°å¯¹åº” CPU Line åï¼Œåˆ¤æ–­ CPU Line ä¸­çš„æœ‰æ•ˆä½ï¼Œç¡®è®¤ CPU Line ä¸­æ•°æ®æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ï¼Œå¦‚æœæ˜¯æ— æ•ˆçš„ï¼ŒCPU å°±ä¼šç›´æ¥è®¿é—®å†…å­˜ï¼Œå¹¶é‡æ–°åŠ è½½æ•°æ®ï¼Œå¦‚æœæ•°æ®æœ‰æ•ˆï¼Œåˆ™å¾€ä¸‹æ‰§è¡Œï¼›&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¯¹æ¯”å†…å­˜åœ°å€ä¸­ç»„æ ‡è®°å’Œ CPU Line ä¸­çš„ç»„æ ‡è®°ï¼Œç¡®è®¤ CPU Line ä¸­çš„æ•°æ®æ˜¯æˆ‘ä»¬è¦è®¿é—®çš„å†…å­˜æ•°æ®ï¼Œå¦‚æœä¸æ˜¯çš„è¯ï¼ŒCPU å°±ä¼šç›´æ¥è®¿é—®å†…å­˜ï¼Œå¹¶é‡æ–°åŠ è½½æ•°æ®ï¼Œå¦‚æœæ˜¯çš„è¯ï¼Œåˆ™å¾€ä¸‹æ‰§è¡Œï¼›&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ ¹æ®å†…å­˜åœ°å€ä¸­åç§»é‡ä¿¡æ¯ï¼Œä» CPU Line çš„æ•°æ®å—ä¸­ï¼Œè¯»å–å¯¹åº”çš„å­—ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ å¯¹ç›´æ¥æ˜ å°„ Cache æœ‰äº†ä¸€å®šè®¤è¯†ï¼Œä½†å…¶å®é™¤äº†ç›´æ¥æ˜ å°„ Cache ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–é€šè¿‡å†…å­˜åœ°å€æ‰¾åˆ° CPU Cache ä¸­çš„æ•°æ®çš„ç­–ç•¥ï¼Œæ¯”å¦‚å…¨ç›¸è¿ Cache ï¼ˆ&lt;em&gt;Fully Associative Cache&lt;/em&gt;ï¼‰ã€ç»„ç›¸è¿ Cache ï¼ˆ&lt;em&gt;Set Associative Cache&lt;/em&gt;ï¼‰ç­‰ï¼Œè¿™å‡ ç§ç­–ç­–ç•¥çš„æ•°æ®ç»“æ„éƒ½æ¯”è¾ƒç›¸ä¼¼ï¼Œæˆ‘ä»¬ç†è§£æµç›´æ¥æ˜ å°„ Cache çš„å·¥ä½œæ–¹å¼ï¼Œå…¶ä»–çš„ç­–ç•¥å¦‚æœä½ æœ‰å…´è¶£å»çœ‹ï¼Œç›¸ä¿¡å¾ˆå¿«å°±èƒ½ç†è§£çš„äº†ã€‚&lt;/p&gt;&lt;hr/&gt;&lt;h3&gt;&lt;span&gt;å¦‚ä½•å†™å‡ºè®© CPU è·‘å¾—æ›´å¿«çš„ä»£ç ï¼Ÿ&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h3&gt;&lt;p&gt;æˆ‘ä»¬çŸ¥é“ CPU è®¿é—®å†…å­˜çš„é€Ÿåº¦ï¼Œæ¯”è®¿é—® CPU Cache çš„é€Ÿåº¦æ…¢äº† 100 å¤šå€ï¼Œæ‰€ä»¥å¦‚æœ CPU æ‰€è¦æ“ä½œçš„æ•°æ®åœ¨ CPU Cache ä¸­çš„è¯ï¼Œè¿™æ ·å°†ä¼šå¸¦æ¥å¾ˆå¤§çš„æ€§èƒ½æå‡ã€‚è®¿é—®çš„æ•°æ®åœ¨ CPU Cache ä¸­çš„è¯ï¼Œæ„å‘³ç€&lt;strong&gt;ç¼“å­˜å‘½ä¸­&lt;/strong&gt;ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šé«˜çš„è¯ï¼Œä»£ç çš„æ€§èƒ½å°±ä¼šè¶Šå¥½ï¼ŒCPU ä¹Ÿå°±è·‘çš„è¶Šå¿«ã€‚&lt;/p&gt;&lt;p&gt;äºæ˜¯ï¼Œã€Œå¦‚ä½•å†™å‡ºè®© CPU è·‘å¾—æ›´å¿«çš„ä»£ç ï¼Ÿã€è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æ”¹æˆã€Œå¦‚ä½•å†™å‡º CPU ç¼“å­˜å‘½ä¸­ç‡é«˜çš„ä»£ç ï¼Ÿã€ã€‚&lt;/p&gt;&lt;p&gt;åœ¨å‰é¢æˆ‘ä¹Ÿæåˆ°ï¼Œ L1 Cache é€šå¸¸åˆ†ä¸ºã€Œæ•°æ®ç¼“å­˜ã€å’Œã€ŒæŒ‡ä»¤ç¼“å­˜ã€ï¼Œè¿™æ˜¯å› ä¸º CPU ä¼šåˆ«å¤„ç†æ•°æ®å’ŒæŒ‡ä»¤ï¼Œæ¯”å¦‚ &lt;code&gt;1+1=2&lt;/code&gt; è¿™ä¸ªè¿ç®—ï¼Œ&lt;code&gt;+&lt;/code&gt; å°±æ˜¯æŒ‡ä»¤ï¼Œä¼šè¢«æ”¾åœ¨ã€ŒæŒ‡ä»¤ç¼“å­˜ã€ä¸­ï¼Œè€Œè¾“å…¥æ•°å­— &lt;code&gt;1&lt;/code&gt; åˆ™ä¼šè¢«æ”¾åœ¨ã€Œæ•°æ®ç¼“å­˜ã€é‡Œã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œ&lt;strong&gt;æˆ‘ä»¬è¦åˆ†å¼€æ¥çœ‹ã€Œæ•°æ®ç¼“å­˜ã€å’Œã€ŒæŒ‡ä»¤ç¼“å­˜ã€çš„ç¼“å­˜å‘½ä¸­ç‡&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;h4&gt;&lt;span&gt;å¦‚ä½•æå‡æ•°æ®ç¼“å­˜çš„å‘½ä¸­ç‡ï¼Ÿ&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;å‡è®¾è¦éå†äºŒç»´æ•°ç»„ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å½¢å¼ï¼Œè™½ç„¶ä»£ç æ‰§è¡Œç»“æœæ˜¯ä¸€æ ·ï¼Œä½†ä½ è§‰å¾—å“ªç§å½¢å¼æ•ˆç‡æœ€é«˜å‘¢ï¼Ÿä¸ºä»€ä¹ˆé«˜å‘¢ï¼Ÿ&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;1.3868613138686132&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUaWq5KdzLgGiaTeUj6icIrEgVHbzteS2cMUQlbkEfiawYibpunTLQO08DBw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;548&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ç»è¿‡æµ‹è¯•ï¼Œå½¢å¼ä¸€ &lt;code&gt;array[i][j]&lt;/code&gt; Â æ‰§è¡Œæ—¶é—´æ¯”å½¢å¼äºŒ &lt;code&gt;array[j][i]&lt;/code&gt; å¿«å¥½å‡ å€ã€‚&lt;/p&gt;&lt;p&gt;ä¹‹æ‰€ä»¥æœ‰è¿™ä¹ˆå¤§çš„å·®è·ï¼Œæ˜¯å› ä¸ºäºŒç»´æ•°ç»„ &lt;code&gt;array&lt;/code&gt; æ‰€å ç”¨çš„å†…å­˜æ˜¯è¿ç»­çš„ï¼Œæ¯”å¦‚é•¿åº¦ &lt;code&gt;N&lt;/code&gt; çš„æŒ‡æ˜¯ &lt;code&gt;2&lt;/code&gt; çš„è¯ï¼Œé‚£ä¹ˆå†…å­˜ä¸­çš„æ•°ç»„å…ƒç´ çš„å¸ƒå±€é¡ºåºæ˜¯è¿™æ ·çš„ï¼š&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.2391304347826087&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DU1V6Raia4HWY3ZAUReO3jbvGHRib59hCUbpRZ612thav03UbGoujvSuSQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;920&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å½¢å¼ä¸€ç”¨ &lt;code&gt;array[i][j]&lt;/code&gt; Â è®¿é—®æ•°ç»„å…ƒç´ çš„é¡ºåºï¼Œæ­£æ˜¯å’Œå†…å­˜ä¸­æ•°ç»„å…ƒç´ å­˜æ”¾çš„é¡ºåºä¸€è‡´ã€‚å½“ CPU è®¿é—® &lt;code&gt;array[0][0]&lt;/code&gt; æ—¶ï¼Œç”±äºè¯¥æ•°æ®ä¸åœ¨ Cache ä¸­ï¼Œäºæ˜¯ä¼šã€Œé¡ºåºã€æŠŠè·Ÿéšå…¶åçš„ 3 ä¸ªå…ƒç´ ä»å†…å­˜ä¸­åŠ è½½åˆ° CPU Cacheï¼Œè¿™æ ·å½“ CPU è®¿é—®åé¢çš„ 3 ä¸ªæ•°ç»„å…ƒç´ æ—¶ï¼Œå°±èƒ½åœ¨ CPU Cache ä¸­æˆåŠŸåœ°æ‰¾åˆ°æ•°æ®ï¼Œè¿™æ„å‘³ç€ç¼“å­˜å‘½ä¸­ç‡å¾ˆé«˜ï¼Œç¼“å­˜å‘½ä¸­çš„æ•°æ®ä¸éœ€è¦è®¿é—®å†…å­˜ï¼Œè¿™ä¾¿å¤§å¤§æé«˜äº†ä»£ç çš„æ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;è€Œå¦‚æœç”¨å½¢å¼äºŒçš„ &lt;code&gt;array[j][i]&lt;/code&gt; æ¥è®¿é—®ï¼Œåˆ™è®¿é—®çš„é¡ºåºå°±æ˜¯ï¼š&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.2391304347826087&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DULaIspIibUC6T3XxxOlc0YRmlI6Wa8nHf1qviaDzxBLoAEdk61tmW4jNg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;920&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä½ å¯ä»¥çœ‹åˆ°ï¼Œè®¿é—®çš„æ–¹å¼è·³è·ƒå¼çš„ï¼Œè€Œä¸æ˜¯é¡ºåºçš„ï¼Œé‚£ä¹ˆå¦‚æœ N çš„æ•°å€¼å¾ˆå¤§ï¼Œé‚£ä¹ˆæ“ä½œ &lt;code&gt;array[j][i]&lt;/code&gt; æ—¶ï¼Œæ˜¯æ²¡åŠæ³•æŠŠ &lt;code&gt;array[j+1][i]&lt;/code&gt; ä¹Ÿè¯»å…¥åˆ° CPU Cache ä¸­çš„ï¼Œæ—¢ç„¶ &lt;code&gt;array[j+1][i]&lt;/code&gt; æ²¡æœ‰è¯»å–åˆ° CPU Cacheï¼Œé‚£ä¹ˆå°±éœ€è¦ä»å†…å­˜è¯»å–è¯¥æ•°æ®å…ƒç´ äº†ã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™ç§ä¸è¿ç»­æ€§ã€è·³è·ƒå¼è®¿é—®æ•°æ®å…ƒç´ çš„æ–¹å¼ï¼Œå¯èƒ½ä¸èƒ½å……åˆ†åˆ©ç”¨åˆ°äº† CPU Cache çš„ç‰¹æ€§ï¼Œä»è€Œä»£ç çš„æ€§èƒ½ä¸é«˜ã€‚&lt;/p&gt;&lt;p&gt;é‚£è®¿é—® &lt;code&gt;array[0][0]&lt;/code&gt; å…ƒç´ æ—¶ï¼ŒCPU å…·ä½“ä¼šä¸€æ¬¡ä»å†…å­˜ä¸­åŠ è½½å¤šå°‘å…ƒç´ åˆ° CPU Cache å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜ï¼Œåœ¨å‰é¢æˆ‘ä»¬ä¹Ÿæåˆ°è¿‡ï¼Œè¿™è·Ÿ CPU Cache Line æœ‰å…³ï¼Œå®ƒè¡¨ç¤º &lt;strong&gt;CPU Cache ä¸€æ¬¡æ€§èƒ½åŠ è½½æ•°æ®çš„å¤§å°&lt;/strong&gt;ï¼Œå¯ä»¥åœ¨ Linux é‡Œé€šè¿‡ &lt;code&gt;coherency_line_size&lt;/code&gt; é…ç½®æŸ¥çœ‹ å®ƒçš„å¤§å°ï¼Œé€šå¸¸æ˜¯ 64 ä¸ªå­—èŠ‚ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.20949263502454993&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUpgXIYYgic3eJ5SHJNKFVRnLPwCd2qNnEGEichslHoZLWt8GsyEu49Nqg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1222&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ CPU è®¿é—®å†…å­˜æ•°æ®æ—¶ï¼Œå¦‚æœæ•°æ®ä¸åœ¨ CPU Cache ä¸­ï¼Œåˆ™ä¼šä¸€æ¬¡æ€§ä¼šè¿ç»­åŠ è½½ 64 å­—èŠ‚å¤§å°çš„æ•°æ®åˆ° CPU Cacheï¼Œé‚£ä¹ˆå½“è®¿é—® &lt;code&gt;array[0][0]&lt;/code&gt; æ—¶ï¼Œç”±äºè¯¥å…ƒç´ ä¸è¶³ 64 å­—èŠ‚ï¼Œäºæ˜¯å°±ä¼šå¾€å&lt;strong&gt;é¡ºåº&lt;/strong&gt;è¯»å– &lt;code&gt;array[0][0]~array[0][15]&lt;/code&gt; åˆ° CPU Cache ä¸­ã€‚é¡ºåºè®¿é—®çš„ &lt;code&gt;array[i][j]&lt;/code&gt; å› ä¸ºåˆ©ç”¨äº†è¿™ä¸€ç‰¹ç‚¹ï¼Œæ‰€ä»¥å°±ä¼šæ¯”è·³è·ƒå¼è®¿é—®çš„ &lt;code&gt;array[j][i]&lt;/code&gt; è¦å¿«ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;å› æ­¤ï¼Œé‡åˆ°è¿™ç§éå†æ•°ç»„çš„æƒ…å†µæ—¶ï¼ŒæŒ‰ç…§å†…å­˜å¸ƒå±€é¡ºåºè®¿é—®ï¼Œå°†å¯ä»¥æœ‰æ•ˆçš„åˆ©ç”¨ CPU Cache å¸¦æ¥çš„å¥½å¤„ï¼Œè¿™æ ·æˆ‘ä»¬ä»£ç çš„æ€§èƒ½å°±ä¼šå¾—åˆ°å¾ˆå¤§çš„æå‡ï¼Œ&lt;/strong&gt;&lt;/p&gt;&lt;h4&gt;&lt;span&gt;å¦‚ä½•æå‡æŒ‡ä»¤ç¼“å­˜çš„å‘½ä¸­ç‡ï¼Ÿ&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;æå‡æ•°æ®çš„ç¼“å­˜å‘½ä¸­ç‡çš„æ–¹å¼ï¼Œæ˜¯æŒ‰ç…§å†…å­˜å¸ƒå±€é¡ºåºè®¿é—®ï¼Œé‚£é’ˆå¯¹æŒ‡ä»¤çš„ç¼“å­˜è¯¥å¦‚ä½•æå‡å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;æˆ‘ä»¬ä»¥ä¸€ä¸ªä¾‹å­æ¥çœ‹çœ‹ï¼Œæœ‰ä¸€ä¸ªå…ƒç´ ä¸º 0 åˆ° 100 ä¹‹é—´éšæœºæ•°å­—ç»„æˆçš„ä¸€ç»´æ•°ç»„ï¼š&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.5985401459854015&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DU9LLoj74jOfcObSSxeWI3Rc3mgkbJ51n7jAKiajAjxTfSPJB4XrAJ5rg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;548&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œå¯¹è¿™ä¸ªæ•°ç»„åšä¸¤ä¸ªæ“ä½œï¼š&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.927007299270073&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DULmPvhCfBh9RvNIa8TRCZasTczRGWsTVk75zwo76mAWeGwkaEndYn2A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;548&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;figure&gt;&lt;br/&gt;&lt;/figure&gt;&lt;p&gt;é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä½ è§‰å¾—å…ˆéå†å†æ’åºé€Ÿåº¦å¿«ï¼Œè¿˜æ˜¯å…ˆæ’åºå†éå†é€Ÿåº¦å¿«å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;åœ¨å›ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ CPU çš„&lt;strong&gt;åˆ†æ”¯é¢„æµ‹å™¨&lt;/strong&gt;ã€‚å¯¹äº if æ¡ä»¶è¯­å¥ï¼Œæ„å‘³ç€æ­¤æ—¶è‡³å°‘å¯ä»¥é€‰æ‹©è·³è½¬åˆ°ä¸¤æ®µä¸åŒçš„æŒ‡ä»¤æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯ if è¿˜æ˜¯ else ä¸­çš„æŒ‡ä»¤ã€‚é‚£ä¹ˆï¼Œ&lt;strong&gt;å¦‚æœåˆ†æ”¯é¢„æµ‹å¯ä»¥é¢„æµ‹åˆ°æ¥ä¸‹æ¥è¦æ‰§è¡Œ if é‡Œçš„æŒ‡ä»¤ï¼Œè¿˜æ˜¯ else æŒ‡ä»¤çš„è¯ï¼Œå°±å¯ä»¥ã€Œæå‰ã€æŠŠè¿™äº›æŒ‡ä»¤æ”¾åœ¨æŒ‡ä»¤ç¼“å­˜ä¸­ï¼Œè¿™æ · CPU å¯ä»¥ç›´æ¥ä» Cache è¯»å–åˆ°æŒ‡ä»¤ï¼Œäºæ˜¯æ‰§è¡Œé€Ÿåº¦å°±ä¼šå¾ˆå¿«&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;å½“æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯éšæœºçš„ï¼Œåˆ†æ”¯é¢„æµ‹å°±æ— æ³•æœ‰æ•ˆå·¥ä½œï¼Œè€Œå½“æ•°ç»„å…ƒç´ éƒ½æ˜¯é¡ºåºçš„ï¼Œåˆ†æ”¯é¢„æµ‹å™¨ä¼šåŠ¨æ€åœ°æ ¹æ®å†å²å‘½ä¸­æ•°æ®å¯¹æœªæ¥è¿›è¡Œé¢„æµ‹ï¼Œè¿™æ ·å‘½ä¸­ç‡å°±ä¼šå¾ˆé«˜ã€‚&lt;/p&gt;&lt;p&gt;å› æ­¤ï¼Œå…ˆæ’åºå†éå†é€Ÿåº¦ä¼šæ›´å¿«ï¼Œè¿™æ˜¯å› ä¸ºæ’åºä¹‹åï¼Œæ•°å­—æ˜¯ä»å°åˆ°å¤§çš„ï¼Œé‚£ä¹ˆå‰å‡ æ¬¡å¾ªç¯å‘½ä¸­ &lt;code&gt;if &amp;lt; 50&lt;/code&gt; çš„æ¬¡æ•°ä¼šæ¯”è¾ƒå¤šï¼Œäºæ˜¯åˆ†æ”¯é¢„æµ‹å°±ä¼šç¼“å­˜ &lt;code&gt;if&lt;/code&gt; é‡Œçš„ &lt;code&gt;array[i] = 0&lt;/code&gt; æŒ‡ä»¤åˆ° Cache ä¸­ï¼Œåç»­ CPU æ‰§è¡Œè¯¥æŒ‡ä»¤å°±åªéœ€è¦ä» Cache è¯»å–å°±å¥½äº†ã€‚&lt;/p&gt;&lt;p&gt;å¦‚æœä½ è‚¯å®šä»£ç ä¸­çš„ &lt;code&gt;if&lt;/code&gt; ä¸­çš„è¡¨è¾¾å¼åˆ¤æ–­ä¸º &lt;code&gt;true&lt;/code&gt; çš„æ¦‚ç‡æ¯”è¾ƒé«˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ˜¾ç¤ºåˆ†æ”¯é¢„æµ‹å·¥å…·ï¼Œæ¯”å¦‚åœ¨ C/C++ è¯­è¨€ä¸­ç¼–è¯‘å™¨æä¾›äº† &lt;code&gt;likely&lt;/code&gt; å’Œ &lt;code&gt;unlikely&lt;/code&gt; è¿™ä¸¤ç§å®ï¼Œå¦‚æœ &lt;code&gt;if&lt;/code&gt; æ¡ä»¶ä¸º &lt;code&gt;ture&lt;/code&gt; çš„æ¦‚ç‡å¤§ï¼Œåˆ™å¯ä»¥ç”¨ &lt;code&gt;likely&lt;/code&gt; å®æŠŠ &lt;code&gt;if&lt;/code&gt; é‡Œçš„è¡¨è¾¾å¼åŒ…è£¹èµ·æ¥ï¼Œåä¹‹ç”¨ &lt;code&gt;unlikely&lt;/code&gt; å®ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.5539906103286385&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUzOCKyzJmM68G89T8hSbibBuEch9QQQF0IY59uUtfibN3Fn2rTt5whcJg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;852&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;å®é™…ä¸Šï¼ŒCPU è‡ªèº«çš„åŠ¨æ€åˆ†æ”¯é¢„æµ‹å·²ç»æ˜¯æ¯”è¾ƒå‡†çš„äº†ï¼Œæ‰€ä»¥åªæœ‰å½“éå¸¸ç¡®ä¿¡ CPU é¢„æµ‹çš„ä¸å‡†ï¼Œä¸”èƒ½å¤ŸçŸ¥é“å®é™…çš„æ¦‚ç‡æƒ…å†µæ—¶ï¼Œæ‰å»ºè®®ä½¿ç”¨è¿™ä¸¤ç§å®ã€‚&lt;/p&gt;&lt;h4&gt;&lt;span&gt;å¦‚æœæå‡å¤šæ ¸ CPU çš„ç¼“å­˜å‘½ä¸­ç‡ï¼Ÿ&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;åœ¨å•æ ¸ CPUï¼Œè™½ç„¶åªèƒ½æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œä½†æ˜¯æ“ä½œç³»ç»Ÿç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…äº†ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œæ—¶é—´ç‰‡ç”¨å®Œäº†ï¼Œå°±è°ƒåº¦ä¸‹ä¸€ä¸ªè¿›ç¨‹ï¼Œäºæ˜¯å„ä¸ªè¿›ç¨‹å°±æŒ‰æ—¶é—´ç‰‡äº¤æ›¿åœ°å ç”¨ CPUï¼Œä»å®è§‚ä¸Šçœ‹èµ·æ¥å„ä¸ªè¿›ç¨‹åŒæ—¶åœ¨æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;è€Œç°ä»£ CPU éƒ½æ˜¯å¤šæ ¸å¿ƒçš„ï¼Œè¿›ç¨‹å¯èƒ½åœ¨ä¸åŒ CPU æ ¸å¿ƒæ¥å›åˆ‡æ¢æ‰§è¡Œï¼Œè¿™å¯¹ CPU Cache ä¸æ˜¯æœ‰åˆ©çš„ï¼Œè™½ç„¶ L3 Cache æ˜¯å¤šæ ¸å¿ƒä¹‹é—´å…±äº«çš„ï¼Œä½†æ˜¯ L1 å’Œ L2 Cache éƒ½æ˜¯æ¯ä¸ªæ ¸å¿ƒç‹¬æœ‰çš„ï¼Œ&lt;strong&gt;å¦‚æœä¸€ä¸ªè¿›ç¨‹åœ¨ä¸åŒæ ¸å¿ƒæ¥å›åˆ‡æ¢ï¼Œå„ä¸ªæ ¸å¿ƒçš„ç¼“å­˜å‘½ä¸­ç‡å°±ä¼šå—åˆ°å½±å“&lt;/strong&gt;ï¼Œç›¸åå¦‚æœè¿›ç¨‹éƒ½åœ¨åŒä¸€ä¸ªæ ¸å¿ƒä¸Šæ‰§è¡Œï¼Œé‚£ä¹ˆå…¶æ•°æ®çš„ L1 å’Œ L2 Cache çš„ç¼“å­˜å‘½ä¸­ç‡å¯ä»¥å¾—åˆ°æœ‰æ•ˆæé«˜ï¼Œç¼“å­˜å‘½ä¸­ç‡é«˜å°±æ„å‘³ç€ CPU å¯ä»¥å‡å°‘è®¿é—® å†…å­˜çš„é¢‘ç‡ã€‚&lt;/p&gt;&lt;p&gt;å½“æœ‰å¤šä¸ªåŒæ—¶æ‰§è¡Œã€Œè®¡ç®—å¯†é›†å‹ã€çš„çº¿ç¨‹ï¼Œä¸ºäº†é˜²æ­¢å› ä¸ºåˆ‡æ¢åˆ°ä¸åŒçš„æ ¸å¿ƒï¼Œè€Œå¯¼è‡´ç¼“å­˜å‘½ä¸­ç‡ä¸‹é™çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ&lt;strong&gt;çº¿ç¨‹ç»‘å®šåœ¨æŸä¸€ä¸ª CPU æ ¸å¿ƒä¸Š&lt;/strong&gt;ï¼Œè¿™æ ·æ€§èƒ½å¯ä»¥å¾—åˆ°éå¸¸å¯è§‚çš„æå‡ã€‚&lt;/p&gt;&lt;p&gt;åœ¨ Linux ä¸Šæä¾›äº† &lt;code&gt;sched_setaffinity&lt;/code&gt; æ–¹æ³•ï¼Œæ¥å®ç°å°†çº¿ç¨‹ç»‘å®šåˆ°æŸä¸ª CPU æ ¸å¿ƒè¿™ä¸€åŠŸèƒ½ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.23548387096774193&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUvZ5zh4RImou6azJ9KMevyTDPcTHLffjYgxyckdaggftIY6hJgiarkYg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1240&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;hr/&gt;&lt;h3&gt;&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/h3&gt;&lt;p&gt;ç”±äºéšç€è®¡ç®—æœºæŠ€æœ¯çš„å‘å±•ï¼ŒCPU ä¸ å†…å­˜çš„è®¿é—®é€Ÿåº¦ç›¸å·®è¶Šæ¥è¶Šå¤šï¼Œå¦‚ä»Šå·®è·å·²ç»é«˜è¾¾å¥½å‡ ç™¾å€äº†ï¼Œæ‰€ä»¥ CPU å†…éƒ¨åµŒå…¥äº† CPU Cache ç»„ä»¶ï¼Œä½œä¸ºå†…å­˜ä¸ CPU ä¹‹é—´çš„ç¼“å­˜å±‚ï¼ŒCPU Cache ç”±äºç¦» CPU æ ¸å¿ƒå¾ˆè¿‘ï¼Œæ‰€ä»¥è®¿é—®é€Ÿåº¦ä¹Ÿæ˜¯éå¸¸å¿«çš„ï¼Œä½†ç”±äºæ‰€éœ€ææ–™æˆæœ¬æ¯”è¾ƒé«˜ï¼Œå®ƒä¸åƒå†…å­˜åŠ¨è¾„å‡ ä¸ª GB å¤§å°ï¼Œè€Œæ˜¯ä»…æœ‰å‡ å KB åˆ° MB å¤§å°ã€‚&lt;/p&gt;&lt;p&gt;å½“ CPU è®¿é—®æ•°æ®çš„æ—¶å€™ï¼Œå…ˆæ˜¯è®¿é—® CPU Cacheï¼Œå¦‚æœç¼“å­˜å‘½ä¸­çš„è¯ï¼Œåˆ™ç›´æ¥è¿”å›æ•°æ®ï¼Œå°±ä¸ç”¨æ¯æ¬¡éƒ½ä»å†…å­˜è¯»å–é€Ÿåº¦äº†ã€‚å› æ­¤ï¼Œç¼“å­˜å‘½ä¸­ç‡è¶Šé«˜ï¼Œä»£ç çš„æ€§èƒ½è¶Šå¥½ã€‚&lt;/p&gt;&lt;p&gt;ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ CPU è®¿é—®æ•°æ®æ—¶ï¼Œå¦‚æœ CPU Cache æ²¡æœ‰ç¼“å­˜è¯¥æ•°æ®ï¼Œåˆ™ä¼šä»å†…å­˜è¯»å–æ•°æ®ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯åªè¯»ä¸€ä¸ªæ•°æ®ï¼Œè€Œæ˜¯ä¸€æ¬¡æ€§è¯»å–ä¸€å—ä¸€å—çš„æ•°æ®å­˜æ”¾åˆ° CPU Cache ä¸­ï¼Œä¹‹åæ‰ä¼šè¢« CPU è¯»å–ã€‚&lt;/p&gt;&lt;p&gt;å†…å­˜åœ°å€æ˜ å°„åˆ° CPU Cache åœ°å€é‡Œçš„ç­–ç•¥æœ‰å¾ˆå¤šç§ï¼Œå…¶ä¸­æ¯”è¾ƒç®€å•æ˜¯ç›´æ¥æ˜ å°„ Cacheï¼Œå®ƒå·§å¦™çš„æŠŠå†…å­˜åœ°å€æ‹†åˆ†æˆã€Œç´¢å¼• + ç»„æ ‡è®° + åç§»é‡ã€çš„æ–¹å¼ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†å¾ˆå¤§çš„å†…å­˜åœ°å€ï¼Œæ˜ å°„åˆ°å¾ˆå°çš„ CPU Cache åœ°å€é‡Œã€‚&lt;/p&gt;&lt;p&gt;è¦æƒ³å†™å‡ºè®© CPU è·‘å¾—æ›´å¿«çš„ä»£ç ï¼Œå°±éœ€è¦å†™å‡ºç¼“å­˜å‘½ä¸­ç‡é«˜çš„ä»£ç ï¼ŒCPU L1 Cache åˆ†ä¸ºæ•°æ®ç¼“å­˜å’ŒæŒ‡ä»¤ç¼“å­˜ï¼Œå› è€Œéœ€è¦åˆ†åˆ«æé«˜å®ƒä»¬çš„ç¼“å­˜å‘½ä¸­ç‡ï¼š&lt;/p&gt;&lt;p&gt;å¦å¤–ï¼Œå¯¹äºå¤šæ ¸ CPU ç³»ç»Ÿï¼Œçº¿ç¨‹å¯èƒ½åœ¨ä¸åŒ CPU æ ¸å¿ƒæ¥å›åˆ‡æ¢ï¼Œè¿™æ ·å„ä¸ªæ ¸å¿ƒçš„ç¼“å­˜å‘½ä¸­ç‡å°±ä¼šå—åˆ°å½±å“ï¼Œäºæ˜¯è¦æƒ³æé«˜è¿›ç¨‹çš„ç¼“å­˜å‘½ä¸­ç‡ï¼Œå¯ä»¥è€ƒè™‘æŠŠçº¿ç¨‹ç»‘å®š CPU åˆ°æŸä¸€ä¸ª CPU æ ¸å¿ƒã€‚&lt;/p&gt;&lt;hr/&gt;&lt;h2&gt;&lt;span&gt;çµ®å¨&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;åˆ†äº«ä¸ªå–œäº‹ï¼Œå°æ—å¹³æ—¥é‡Œå¿™ç€è¾“å‡ºæ–‡ç« ï¼Œä»Šå¤©æ”¶åˆ°ä¸€ä»½ç‰¹åˆ«çš„å¿«é€’ï¼Œæ˜¯ CSDN å¯„æ¥çš„å¥–çŠ¶ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.6587360594795539&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/J0g14CUwaZcKapyUj66hkhTng5Zof8DUZ0IFb8hhbujk32TmfGFhf050tBp0Y99Z45Ee6v0PwhnjVq73FsDEVA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1345&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;éª„å‚²çš„è¯´ï¼Œä½ ä»¬å…³æ³¨çš„æ˜¯ CSDN é¦–å±ŠæŠ€æœ¯åŸåˆ›ç¬¬ä¸€åçš„åšä¸»ï¼Œä»¥åç®€å†åˆå¯ä»¥å¹ç‰›é€¼äº†&lt;/p&gt;&lt;p&gt;æ²¡æœ‰å•¦ï¼Œå…¶å®ä¸»è¦è¿˜æ˜¯&lt;strong&gt;è°¢è°¢ä½ ä»¬ä¸ç¦»ä¸å¼ƒçš„æ”¯æŒ&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img data-ratio=&quot;0.5902612826603325&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/J0g14CUwaZcKapyUj66hkhTng5Zof8DUVwlCFh1n6JlGk9YqHE2t6sNc4UfFw0Za60dcwsambuF9A16w06086A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;842&quot; title=&quot;&quot;/&gt;&lt;/figure&gt;&lt;p&gt;&lt;em&gt;å“ˆå–½ï¼Œæˆ‘æ˜¯å°æ—ï¼Œå°±çˆ±å›¾è§£è®¡ç®—æœºåŸºç¡€ï¼Œå¦‚æœè§‰å¾—æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿åˆ†äº«ç»™ä½ çš„æœ‹å‹ï¼Œä¹Ÿç»™å°æ—ç‚¹ä¸ªã€Œåœ¨çœ‹ã€ï¼Œè¿™å¯¹å°æ—éå¸¸é‡è¦ï¼Œè°¢è°¢ä½ ä»¬ï¼Œç»™å„ä½å°å§å§å°å“¥å“¥ä»¬æŠ±æ‹³äº†ï¼Œæˆ‘ä»¬ä¸‹æ¬¡è§ï¼&lt;/em&gt;&lt;/p&gt;&lt;hr/&gt;&lt;h5&gt;&lt;span&gt;æ¨èé˜…è¯»&lt;/span&gt;&lt;/h5&gt;&lt;p&gt;è¿™ä¸ªæ˜ŸæœŸä¸çŸ¥ä¸è§‰è¾“å‡ºäº† 3 ç¯‡æ–‡ç« äº†ï¼Œå‰é¢çš„ 2 ç¯‡è¿˜æ²¡çœ‹è¿‡çš„åŒå­¦ï¼Œèµ¶ç´§å»çœ‹çœ‹å‘€ï¼&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUxODAzNDg4NQ==&amp;amp;mid=2247485960&amp;amp;idx=1&amp;amp;sn=476d40b3e272149ba6c7370340e9768f&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;&lt;strong&gt;å¤©å•¦å™œï¼çŸ¥é“ç¡¬ç›˜å¾ˆæ…¢ï¼Œä½†æ²¡æƒ³åˆ°æ¯” CPU Cache æ…¢ 10000000 å€&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s?__biz=MzUxODAzNDg4NQ==&amp;amp;mid=2247485918&amp;amp;idx=1&amp;amp;sn=f7fa3aa2a7cc362eeebad09d4d6fa03a&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot;&gt;&lt;strong&gt;CPU æ‰§è¡Œç¨‹åºçš„ç§˜å¯†ï¼Œè—åœ¨äº†è¿™ 15 å¼ å›¾é‡Œ&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>0623720fbc535d26e68350dc6389efd6</guid>
<title>[æ¨è] æ—¶é—´è½®åœ¨ Kafka çš„å®è·µ</title>
<link>https://toutiao.io/k/441cqn5</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;562&quot; data-backw=&quot;562&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;562&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzF6ARFqaicYjickTxiaPM701eKEspL7tj7A4xonqVVkpDfA12KVmDDPE8icg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1000&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-darkmode-bgcolor-15906711670635=&quot;rgb(52, 52, 52)&quot; data-darkmode-original-bgcolor-15906711670635=&quot;rgb(239, 239, 239)&quot; data-style=&quot;padding: 10px; display: inline-block; width: 558px; border-width: 1px; border-style: solid; border-color: transparent; background-color: rgb(239, 239, 239); border-radius: 0px;&quot; class=&quot;js_darkmode__0&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot; data-darkmode-bgcolor-15906711670635=&quot;rgb(52, 52, 52)&quot; data-darkmode-original-bgcolor-15906711670635=&quot;rgb(239, 239, 239)&quot;&gt;&lt;section data-darkmode-bgcolor-15906711670635=&quot;rgb(52, 52, 52)&quot; data-darkmode-original-bgcolor-15906711670635=&quot;rgb(239, 239, 239)&quot;&gt;&lt;p data-darkmode-bgcolor-15906711670635=&quot;rgb(52, 52, 52)&quot; data-darkmode-original-bgcolor-15906711670635=&quot;rgb(239, 239, 239)&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;æ¡”å¦¹å¯¼è¯»ï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;æ—¶é—´è½®æ˜¯ä¸€ä¸ªåº”ç”¨åœºæ™¯å¾ˆå¹¿çš„ç»„ä»¶ï¼Œåœ¨å¾ˆå¤šé«˜æ€§èƒ½ä¸­é—´ä»¶ä¸­éƒ½æœ‰å®ƒçš„èº«å½±ï¼Œå¦‚Nettyã€Quartzã€Akkaï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬Kafkaï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»æ—¶é—´è½®åœ¨kafkaçš„åº”ç”¨å’Œå®æˆ˜ï¼Œä»æ ¸å¿ƒæºç å’Œè®¾è®¡çš„è§’åº¦å¯¹æ—¶é—´è½®è¿›è¡Œæ·±å…¥çš„è®²è§£ ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;1.Â &lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;å¼•å­&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.0734375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/jE5bOw22iaBtFvdK9icOj3ibAXa8W3tqZ2lQDEaA5XcCDJ5cVIic2221PzXcw0oo69kvia8ojgPZnEV4jPxZURBln4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot; data-backw=&quot;562&quot; data-backh=&quot;41&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä»2ä¸ªé¢è¯•é¢˜è¯´èµ·ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜ï¼š&lt;strong&gt;å¦‚æœä¸€å°æœºå™¨ä¸Šæœ‰10wä¸ªå®šæ—¶ä»»åŠ¡ï¼Œå¦‚ä½•åšåˆ°é«˜æ•ˆè§¦å‘ï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å…·ä½“åœºæ™¯æ˜¯ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æœ‰ä¸€ä¸ªAPPå®æ—¶æ¶ˆæ¯é€šé“ç³»ç»Ÿï¼Œå¯¹æ¯ä¸ªç”¨æˆ·ä¼šç»´æŠ¤ä¸€ä¸ªAPPåˆ°æœåŠ¡å™¨çš„TCPè¿æ¥ï¼Œç”¨æ¥å®æ—¶æ”¶å‘æ¶ˆæ¯ï¼Œå¯¹è¿™ä¸ªTCPè¿æ¥ï¼Œæœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šâ€œå¦‚æœè¿ç»­30sæ²¡æœ‰è¯·æ±‚åŒ…ï¼ˆä¾‹å¦‚ç™»å½•ï¼Œæ¶ˆæ¯ï¼ŒkeepaliveåŒ…ï¼‰ï¼ŒæœåŠ¡ç«¯å°±è¦å°†è¿™ä¸ªç”¨æˆ·çš„çŠ¶æ€ç½®ä¸ºç¦»çº¿â€ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Â å…¶ä¸­ï¼Œå•æœºTCPåŒæ—¶åœ¨çº¿é‡çº¦åœ¨10wçº§åˆ«ï¼Œkeepaliveè¯·æ±‚åŒ…è¾ƒåˆ†æ•£å¤§æ¦‚30sä¸€æ¬¡ï¼Œååé‡çº¦åœ¨3000qpsã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;æ€ä¹ˆåšï¼Ÿ&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¸¸ç”¨æ–¹æ¡ˆä½¿ç”¨timeå®šæ—¶ä»»åŠ¡ï¼Œæ¯ç§’æ‰«æä¸€æ¬¡æ‰€æœ‰è¿æ¥çš„é›†åˆMap&amp;lt;uid, last_packet_time&amp;gt;ï¼ŒæŠŠè¿æ¥æ—¶é—´ï¼ˆæ¯æ¬¡æœ‰æ–°çš„è¯·æ±‚æ›´æ–°å¯¹åº”è¿æ¥çš„è¿æ¥æ—¶é—´ï¼‰æ¯”å½“å‰æ—¶é—´çš„å·®å€¼å¤§30sçš„è¿æ¥æ‰¾å‡ºæ¥å¤„ç†ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¦ä¸€ç§æ–¹æ¡ˆï¼Œä½¿ç”¨ç¯å½¢é˜Ÿåˆ—æ³•ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;382&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.6606498194945848&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzFyHiaiaWIPMkRLgqmsN5VzQsHuYdCHiadPl2dunDHicSlewT7ma4pWBNJBQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1108&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸‰ä¸ªé‡è¦çš„æ•°æ®ç»“æ„ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;ol class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;30sè¶…æ—¶ï¼Œå°±åˆ›å»ºä¸€ä¸ªindexä»0åˆ°30çš„ç¯å½¢é˜Ÿåˆ—ï¼ˆæœ¬è´¨æ˜¯ä¸ªæ•°ç»„ï¼‰&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;ç¯ä¸Šæ¯ä¸€ä¸ªslotæ˜¯ä¸€ä¸ªSet&amp;lt;uid&amp;gt;ï¼Œä»»åŠ¡é›†åˆ&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;åŒæ—¶è¿˜æœ‰ä¸€ä¸ªMap&amp;lt;uid, index&amp;gt;ï¼Œè®°å½•uidè½åœ¨ç¯ä¸Šçš„å“ªä¸ªsloté‡Œ&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;è¿™æ ·å½“æœ‰æŸç”¨æˆ·uidæœ‰è¯·æ±‚åŒ…åˆ°è¾¾æ—¶ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;ol class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;ä»Mapç»“æ„ä¸­ï¼ŒæŸ¥æ‰¾å‡ºè¿™ä¸ªuidå­˜å‚¨åœ¨å“ªä¸€ä¸ªsloté‡Œ&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;ä»è¿™ä¸ªslotçš„Setç»“æ„ä¸­ï¼Œåˆ é™¤è¿™ä¸ªuid&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;å°†uidé‡æ–°åŠ å…¥åˆ°æ–°çš„slotä¸­ï¼Œå…·ä½“æ˜¯å“ªä¸€ä¸ªslotå‘¢Â =&amp;gt;Â Current IndexæŒ‡é’ˆæ‰€æŒ‡å‘çš„&lt;/span&gt;&lt;span&gt;ä¸Šä¸€ä¸ª&lt;/span&gt;&lt;span&gt;slotï¼Œå› ä¸ºè¿™ä¸ªslotï¼Œä¼šè¢«timeråœ¨30sä¹‹åæ‰«æåˆ°&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;æ›´æ–°Mapï¼Œè¿™ä¸ªuidå¯¹åº”slotçš„indexå€¼&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å“ªäº›å…ƒç´ ä¼šè¢«è¶…æ—¶æ‰å‘¢ï¼Ÿ&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Current Indexæ¯ç§’ç§ç§»åŠ¨ä¸€ä¸ªslotï¼Œè¿™ä¸ªslotå¯¹åº”çš„Set&amp;lt;uid&amp;gt;ä¸­æ‰€æœ‰uidéƒ½åº”è¯¥è¢«é›†ä½“è¶…æ—¶ï¼å¦‚æœæœ€è¿‘30sæœ‰è¯·æ±‚åŒ…æ¥åˆ°ï¼Œä¸€å®šè¢«æ”¾åˆ°Current Indexçš„å‰ä¸€ä¸ªslotäº†ï¼ŒCurrent Indexæ‰€åœ¨çš„slotå¯¹åº”Setä¸­æ‰€æœ‰å…ƒç´ ï¼Œéƒ½æ˜¯æœ€è¿‘30sæ²¡æœ‰è¯·æ±‚åŒ…æ¥åˆ°çš„ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ‰€ä»¥ï¼Œå½“æ²¡æœ‰è¶…æ—¶æ—¶ï¼ŒCurrent Indexæ‰«åˆ°çš„æ¯ä¸€ä¸ªslotçš„Setä¸­åº”è¯¥éƒ½æ²¡æœ‰å…ƒç´ ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ–¹æ¡ˆä¸€æ¯æ¬¡éƒ½è¦è½®è¯¢æ‰€æœ‰æ•°æ®ï¼Œè€Œæ–¹æ¡ˆäºŒä½¿ç”¨ç¯å½¢é˜Ÿåˆ—åªéœ€è¦è½®è¯¢è¿™ä¸€åˆ»éœ€è¦è¿‡æœŸçš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ•°æ®è¿‡æœŸåˆ™æ²¡æœ‰æ•°æ®è¦å¤„ç†ï¼Œå¹¶ä¸”æ˜¯æ‰¹é‡è¶…æ—¶ï¼Œå¹¶ä¸”ç”±äºæ˜¯ç¯å½¢ç»“æ„æ›´åŠ èŠ‚çº¦ç©ºé—´ï¼Œè¿™å¾ˆé€‚åˆé«˜æ€§èƒ½åœºæ™¯ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ç¬¬äºŒä¸ªé—®é¢˜ï¼š&lt;strong&gt;åœ¨å¼€å‘è¿‡ç¨‹ä¸­æœ‰å»¶è¿Ÿä¸€å®šæ—¶é—´çš„ä»»åŠ¡è¦æ‰§è¡Œï¼Œæ€ä¹ˆåšï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¦‚æœä¸é‡å¤é€ è½®å­çš„è¯ï¼Œæˆ‘ä»¬çš„é€‰æ‹©å½“ç„¶æ˜¯å»¶è¿Ÿé˜Ÿåˆ—æˆ–è€…Timerã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å»¶è¿Ÿé˜Ÿåˆ—å’Œåœ¨Timerä¸­å¢ åŠ å»¶æ—¶ä»»åŠ¡é‡‡ç”¨æ•°ç»„è¡¨ç¤ºçš„æœ€å°å †çš„æ•°æ®ç»“æ„å®ç°ï¼Œæ¯æ¬¡æ”¾å…¥æ–°å…ƒç´ å’Œç§»é™¤é˜Ÿé¦–å…ƒç´ æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog(n))ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;2.Â &lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;æ—¶é—´è½®&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.0734375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/jE5bOw22iaBtFvdK9icOj3ibAXa8W3tqZ2lQDEaA5XcCDJ5cVIic2221PzXcw0oo69kvia8ojgPZnEV4jPxZURBln4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot; data-backw=&quot;562&quot; data-backh=&quot;41&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ–¹æ¡ˆäºŒæ‰€é‡‡ç”¨çš„ç¯å½¢é˜Ÿåˆ—ï¼Œå°±æ˜¯æ—¶é—´è½®çš„åº•å±‚æ•°æ®ç»“æ„ï¼Œå®ƒèƒ½å¤Ÿè®©éœ€è¦å¤„ç†çš„æ•°æ®ï¼ˆä»»åŠ¡çš„æŠ½è±¡ï¼‰é›†ä¸­ï¼Œåœ¨Kafkaä¸­å­˜åœ¨å¤§é‡çš„å»¶è¿Ÿæ“ä½œï¼Œæ¯”å¦‚å»¶è¿Ÿç”Ÿäº§ã€å»¶è¿Ÿæ‹‰å–ä»¥åŠå»¶è¿Ÿåˆ é™¤ç­‰ã€‚Kafkaå¹¶æ²¡æœ‰ä½¿ç”¨JDKè‡ªå¸¦çš„Timeræˆ–è€…DelayQueueæ¥å®ç°å»¶è¿Ÿçš„åŠŸèƒ½ï¼Œè€Œæ˜¯åŸºäºæ—¶é—´è½®è‡ªå®šä¹‰äº†ä¸€ä¸ªç”¨äºå®ç°å»¶è¿ŸåŠŸèƒ½çš„å®šæ—¶å™¨ï¼ˆSystemTimerï¼‰ã€‚JDKçš„Timerå’ŒDelayQueueæ’å…¥å’Œåˆ é™¤æ“ä½œçš„å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog(n))ï¼Œå¹¶ä¸èƒ½æ»¡è¶³Kafkaçš„é«˜æ€§èƒ½è¦æ±‚ï¼Œè€ŒåŸºäºæ—¶é—´è½®å¯ä»¥å°†æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½é™ä¸ºO(1)ã€‚æ—¶é—´è½®çš„åº”ç”¨å¹¶éKafkaç‹¬æœ‰ï¼Œå…¶åº”ç”¨åœºæ™¯è¿˜æœ‰å¾ˆå¤šï¼Œåœ¨Nettyã€Akkaã€Quartzã€Zookeeperç­‰ç»„ä»¶ä¸­éƒ½å­˜åœ¨æ—¶é—´è½®çš„è¸ªå½±ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;â–&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt;2.1 æ—¶é—´è½®çš„æ•°æ®ç»“æ„&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å‚è€ƒä¸‹å›¾ï¼ŒKafkaä¸­çš„æ—¶é—´è½®ï¼ˆTimingWheelï¼‰æ˜¯ä¸€ä¸ªå­˜å‚¨å®šæ—¶ä»»åŠ¡çš„ç¯å½¢é˜Ÿåˆ—ï¼Œåº•å±‚é‡‡ç”¨æ•°ç»„å®ç°ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å¯ä»¥å­˜æ”¾ä¸€ä¸ªå®šæ—¶ä»»åŠ¡åˆ—è¡¨ï¼ˆTimerTaskListï¼‰ã€‚TimerTaskListæ˜¯ä¸€ä¸ªç¯å½¢çš„åŒå‘é“¾è¡¨ï¼Œé“¾è¡¨ä¸­çš„æ¯ä¸€é¡¹è¡¨ç¤ºçš„éƒ½æ˜¯å®šæ—¶ä»»åŠ¡é¡¹ï¼ˆTimerTaskEntryï¼‰ï¼Œå…¶ä¸­å°è£…äº†çœŸæ­£çš„å®šæ—¶ä»»åŠ¡TimerTaskã€‚åœ¨Kafkaæºç ä¸­å¯¹è¿™ä¸ªTimeTaskListæ˜¯ç”¨ä¸€ä¸ªåç§°ä¸ºbucketsçš„æ•°ç»„è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥åé¢ä»‹ç»ä¸­å¯èƒ½TimerTaskListä¹Ÿä¼šè¢«ç§°ä¸ºbucketã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;312&quot; data-backw=&quot;578&quot; data-ratio=&quot;0.54&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzFpdDDKO9Iib8RQIRQ3JMaZoqNfC7VDYJZTtUy2UOaXVFtDicNGsC0Btqw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1600&quot;/&gt;&lt;span&gt;å›¾äºŒ&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;é’ˆå¯¹ä¸Šå›¾çš„å‡ ä¸ªåè¯ç®€å•è§£é‡Šä¸‹ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;tickMsï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;æ—¶é—´è½®ç”±å¤šä¸ªæ—¶é—´æ ¼ç»„æˆï¼Œæ¯ä¸ªæ—¶é—´æ ¼å°±æ˜¯tickMsï¼Œå®ƒä»£è¡¨å½“å‰æ—¶é—´è½®çš„åŸºæœ¬æ—¶é—´è·¨åº¦ã€‚&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;wheelSizeï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;ä»£è¡¨æ¯ä¸€å±‚æ—¶é—´è½®çš„æ ¼æ•°&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;intervalï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;å½“å‰æ—¶é—´è½®çš„æ€»ä½“æ—¶é—´è·¨åº¦ï¼Œinterval=tickMs Ã— wheelSize&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;startMsï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;æ„é€ å½“å±‚æ—¶é—´è½®æ—¶å€™çš„å½“å‰æ—¶é—´ï¼Œç¬¬ä¸€å±‚çš„æ—¶é—´è½®çš„startMsæ˜¯TimeUnit.NANOSECONDS.toMillis(nanoseconds()),ä¸Šå±‚æ—¶é—´è½®çš„startMsä¸ºä¸‹å±‚æ—¶é—´è½®çš„currentTimeã€‚&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;currentTimeï¼š&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;è¡¨ç¤ºæ—¶é—´è½®å½“å‰æ‰€å¤„çš„æ—¶é—´ï¼ŒcurrentTimeæ˜¯tickMsçš„æ•´æ•°å€ï¼ˆé€šè¿‡currentTime=startMs - (startMs % tickMsæ¥ä¿æ­£currentTimeä¸€å®šæ˜¯tickMsçš„æ•´æ•°å€ï¼‰ï¼Œè¿™ä¸ªè¿ç®—ç±»æ¯”é’Ÿè¡¨ä¸­åˆ†é’Ÿé‡Œ65ç§’åˆ†é’ŸæŒ‡é’ˆæŒ‡å‘çš„è¿˜æ˜¯1åˆ†é’Ÿï¼‰ã€‚currentTimeå¯ä»¥å°†æ•´ä¸ªæ—¶é—´è½®åˆ’åˆ†ä¸ºåˆ°æœŸéƒ¨åˆ†å’Œæœªåˆ°æœŸéƒ¨åˆ†ï¼ŒcurrentTimeå½“å‰æŒ‡å‘çš„æ—¶é—´æ ¼ä¹Ÿå±äºåˆ°æœŸéƒ¨åˆ†ï¼Œè¡¨ç¤ºåˆšå¥½åˆ°æœŸï¼Œéœ€è¦å¤„ç†æ­¤æ—¶é—´æ ¼æ‰€å¯¹åº”çš„TimerTaskListçš„æ‰€æœ‰ä»»åŠ¡ã€‚&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;â–&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt;2.2 æ—¶é—´è½®ä¸­çš„ä»»åŠ¡å­˜æ”¾&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;è‹¥æ—¶é—´è½®çš„tickMs=1msï¼ŒwheelSize=20ï¼Œé‚£ä¹ˆå¯ä»¥è®¡ç®—å¾—å‡ºintervalä¸º20msã€‚åˆå§‹æƒ…å†µä¸‹è¡¨ç›˜æŒ‡é’ˆcurrentTimeæŒ‡å‘æ—¶é—´æ ¼0ï¼Œæ­¤æ—¶æœ‰ä¸€ä¸ªå®šæ—¶ä¸º2msçš„ä»»åŠ¡æ’å…¥è¿›æ¥ä¼šå­˜æ”¾åˆ°æ—¶é—´æ ¼ä¸º2çš„TimerTaskListä¸­ã€‚éšç€æ—¶é—´çš„ä¸æ–­æ¨ç§»ï¼ŒæŒ‡é’ˆcurrentTimeä¸æ–­å‘å‰æ¨è¿›ï¼Œè¿‡äº†2msä¹‹åï¼Œå½“åˆ°è¾¾æ—¶é—´æ ¼2æ—¶ï¼Œå°±éœ€è¦å°†æ—¶é—´æ ¼2æ‰€å¯¹åº”çš„TimeTaskListä¸­çš„ä»»åŠ¡åšç›¸åº”çš„åˆ°æœŸæ“ä½œã€‚æ­¤æ—¶è‹¥åˆæœ‰ä¸€ä¸ªå®šæ—¶ä¸º8msçš„ä»»åŠ¡æ’å…¥è¿›æ¥ï¼Œåˆ™ä¼šå­˜æ”¾åˆ°æ—¶é—´æ ¼10ä¸­ï¼ŒcurrentTimeå†è¿‡8msåä¼šæŒ‡å‘æ—¶é—´æ ¼10ã€‚å¦‚æœåŒæ—¶æœ‰ä¸€ä¸ªå®šæ—¶ä¸º19msçš„ä»»åŠ¡æ’å…¥è¿›æ¥æ€ä¹ˆåŠï¼Ÿæ–°æ¥çš„TimerTaskEntryä¼šå¤ç”¨åŸæ¥çš„TimerTaskListï¼Œæ‰€ä»¥å®ƒä¼šæ’å…¥åˆ°åŸæœ¬å·²ç»åˆ°æœŸçš„æ—¶é—´æ ¼1ä¸­ã€‚æ€»ä¹‹ï¼Œæ•´ä¸ªæ—¶é—´è½®çš„æ€»ä½“è·¨åº¦æ˜¯ä¸å˜çš„ï¼Œéšç€æŒ‡é’ˆcurrentTimeçš„ä¸æ–­æ¨è¿›ï¼Œå½“å‰æ—¶é—´è½®æ‰€èƒ½å¤„ç†çš„æ—¶é—´æ®µä¹Ÿåœ¨ä¸æ–­åç§»ï¼Œæ€»ä½“æ—¶é—´èŒƒå›´åœ¨currentTimeå’ŒcurrentTime+intervalä¹‹é—´ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;â–&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt;2.3 æ—¶é—´è½®çš„å‡é™çº§&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¦‚æœæ­¤æ—¶æœ‰ä¸ªå®šæ—¶ä¸º350msçš„ä»»åŠ¡è¯¥å¦‚ä½•å¤„ç†ï¼Ÿç›´æ¥æ‰©å……wheelSizeçš„å¤§å°ä¹ˆï¼ŸKafkaä¸­ä¸ä¹å‡ ä¸‡ç”šè‡³å‡ åä¸‡æ¯«ç§’çš„å®šæ—¶ä»»åŠ¡ï¼Œè¿™ä¸ªwheelSizeçš„æ‰©å……æ²¡æœ‰åº•çº¿ï¼Œå°±ç®—å°†æ‰€æœ‰çš„å®šæ—¶ä»»åŠ¡çš„åˆ°æœŸæ—¶é—´éƒ½è®¾å®šä¸€ä¸ªä¸Šé™ï¼Œæ¯”å¦‚100ä¸‡æ¯«ç§’ï¼Œé‚£ä¹ˆè¿™ä¸ªwheelSizeä¸º100ä¸‡æ¯«ç§’çš„æ—¶é—´è½®ä¸ä»…å ç”¨å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸”æ•ˆç‡ä¹Ÿä¼šæ‹‰ä½ã€‚Kafkaä¸ºæ­¤å¼•å…¥äº†å±‚çº§æ—¶é—´è½®çš„æ¦‚å¿µï¼Œå½“ä»»åŠ¡çš„åˆ°æœŸæ—¶é—´è¶…è¿‡äº†å½“å‰æ—¶é—´è½®æ‰€è¡¨ç¤ºçš„æ—¶é—´èŒƒå›´æ—¶ï¼Œå°±ä¼šå°è¯•æ·»åŠ åˆ°ä¸Šå±‚æ—¶é—´è½®ä¸­ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;513&quot; data-backw=&quot;562&quot; data-ratio=&quot;0.9129332206255283&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzFXzdeg3QUgdoJ26RtYQpibFsFK0IXhico9xicPsZDvRnYcicqul57P0tP0g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1183&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span/&gt;&lt;span&gt;å›¾ä¸‰&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å‚è€ƒä¸Šå›¾ï¼Œå¤ç”¨ä¹‹å‰çš„æ¡ˆä¾‹ï¼Œç¬¬ä¸€å±‚çš„æ—¶é—´è½®tickMs=1ms, wheelSize=20, interval=20msã€‚ç¬¬äºŒå±‚çš„æ—¶é—´è½®çš„tickMsä¸ºç¬¬ä¸€å±‚æ—¶é—´è½®çš„intervalï¼Œå³ä¸º20msã€‚æ¯ä¸€å±‚æ—¶é—´è½®çš„wheelSizeæ˜¯å›ºå®šçš„ï¼Œéƒ½æ˜¯20ï¼Œé‚£ä¹ˆç¬¬äºŒå±‚çš„æ—¶é—´è½®çš„æ€»ä½“æ—¶é—´è·¨åº¦intervalä¸º400msã€‚ä»¥æ­¤ç±»æ¨ï¼Œè¿™ä¸ª400msä¹Ÿæ˜¯ç¬¬ä¸‰å±‚çš„tickMsçš„å¤§å°ï¼Œç¬¬ä¸‰å±‚çš„æ—¶é—´è½®çš„æ€»ä½“æ—¶é—´è·¨åº¦ä¸º8000msã€‚&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;åˆšæ‰æåˆ°çš„350msçš„ä»»åŠ¡ï¼Œä¸ä¼šæ’å…¥åˆ°ç¬¬ä¸€å±‚æ—¶é—´è½®ï¼Œä¼šæ’å…¥åˆ°interval=20*20çš„ç¬¬äºŒå±‚æ—¶é—´è½®ä¸­ï¼Œå…·ä½“æ’å…¥åˆ°æ—¶é—´è½®çš„å“ªä¸ªbucketå‘¢ï¼Ÿå…ˆç”¨350/tickMs(20)=virtualId(17)ï¼Œç„¶åvirtualId(17) %wheelSize (20) = 17ï¼Œæ‰€ä»¥350ä¼šæ”¾åœ¨ç¬¬17ä¸ªbucketã€‚å¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ª450msåæ‰§è¡Œçš„ä»»åŠ¡ï¼Œé‚£ä¹ˆä¼šæ”¾åœ¨ç¬¬ä¸‰å±‚æ—¶é—´è½®ä¸­ï¼ŒæŒ‰ç…§åˆšæ‰çš„è®¡ç®—å…¬å¼ï¼Œä¼šæ”¾åœ¨ç¬¬0ä¸ªbucketã€‚ç¬¬0ä¸ªbucketé‡Œä¼šåŒ…å«&lt;/span&gt;&lt;span&gt;[400,800)ms&lt;/span&gt;&lt;span&gt;çš„ä»»åŠ¡ã€‚&lt;/span&gt;&lt;span&gt;éšç€æ—¶é—´æµé€ï¼Œå½“æ—¶é—´è¿‡å»äº†400msï¼Œé‚£ä¹ˆ450msåå°±è¦æ‰§è¡Œçš„ä»»åŠ¡è¿˜å‰©ä¸‹50msçš„æ—¶é—´æ‰èƒ½æ‰§è¡Œï¼Œæ­¤æ—¶æœ‰ä¸€ä¸ªæ—¶é—´è½®é™çº§çš„æ“ä½œï¼Œå°†50msä»»åŠ¡é‡æ–°æäº¤åˆ°å±‚çº§æ—¶é—´è½®ä¸­ï¼Œé‚£ä¹ˆæ­¤æ—¶50msçš„ä»»åŠ¡æ ¹æ®å…¬å¼ä¼šæ”¾å…¥ç¬¬äºŒä¸ªæ—¶é—´è½®çš„ç¬¬2ä¸ªbucketä¸­ï¼Œæ­¤bucketçš„æ—¶é—´èŒƒå›´ä¸º[40,60)msï¼Œç„¶åå†ç»è¿‡40msï¼Œè¿™ä¸ª50msçš„ä»»åŠ¡åˆä¼šè¢«ç›‘æ§åˆ°ï¼Œæ­¤æ—¶è·ç¦»ä»»åŠ¡æ‰§è¡Œè¿˜æœ‰10msï¼ŒåŒæ ·å°†10msçš„ä»»åŠ¡æäº¤åˆ°å±‚çº§æ—¶é—´è½®ï¼Œæ­¤æ—¶ä¼šåŠ å…¥åˆ°ç¬¬ä¸€å±‚æ—¶é—´è½®çš„ç¬¬10ä¸ªbucketï¼Œæ‰€ä»¥å†ç»è¿‡10msåï¼Œæ­¤ä»»åŠ¡åˆ°æœŸï¼Œæœ€ç»ˆæ‰§è¡Œã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ•´ä¸ªæ—¶é—´è½®çš„å‡çº§é™çº§æ“ä½œæ˜¯ä¸æ˜¯å¾ˆç±»ä¼¼äºæˆ‘ä»¬çš„æ—¶é’Ÿï¼ŸÂ ç¬¬ä¸€å±‚æ—¶é—´è½®tickMs=1s, wheelSize=60ï¼Œinterval=1minï¼Œæ­¤ä¸ºç§’é’Ÿï¼›ç¬¬äºŒå±‚tickMs=1minï¼ŒwheelSize=60ï¼Œinterval=1hourï¼Œæ­¤ä¸ºåˆ†é’Ÿï¼›ç¬¬ä¸‰å±‚tickMs=1hourï¼ŒwheelSizeä¸º12ï¼Œintervalä¸º12hoursï¼Œæ­¤ä¸ºæ—¶é’Ÿã€‚è€Œé’Ÿè¡¨çš„æŒ‡é’ˆå°±å¯¹åº”ç¨‹åºä¸­çš„currentTimeï¼Œè¿™ä¸ªåé¢åˆ†æä»£ç æ—¶å€™ä¼šè®²åˆ°ï¼ˆå¯¹è¿™ä¸ªçš„ç†è§£ä¹Ÿæ˜¯æ—¶é—´è½®ç†è§£çš„é‡ç‚¹å’Œéš¾ç‚¹ï¼‰ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;â–&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;&lt;span&gt;2.4Â &lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;ä»»åŠ¡æ·»åŠ å’Œé©±åŠ¨æ—¶é—´è½®æ»šåŠ¨æ ¸å¿ƒæµç¨‹å›¾&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;br/&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;322&quot; data-backw=&quot;562&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;409&quot; data-ratio=&quot;0.5736994219653179&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzFeEWic4vjFkWp5Sng55EQSXoSZIIA9yIlKezQgWkiaT7bRuAHrNWq1J6A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1384&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å›¾å››&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;â–&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong&gt;2.5Â é‡ç‚¹ä»£ç ä»‹ç»&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;è¿™æ˜¯å¾€SystenTimerä¸­æ·»åŠ ä¸€ä¸ªä»»åŠ¡ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cs&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt; def &lt;span class=&quot;code-snippet__title&quot;&gt;addTimerTaskEntry&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;timerTaskEntry: TimerTaskEntry&lt;/span&gt;): Unit&lt;/span&gt; = {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (!timingWheel.&lt;span class=&quot;code-snippet__keyword&quot;&gt;add&lt;/span&gt;(timerTaskEntry)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (!timerTaskEntry.cancelled)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      taskExecutor.submit(timerTaskEntry.timerTask)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;timingWheelæ·»åŠ ä»»åŠ¡ï¼Œé€’å½’æ·»åŠ ç›´åˆ°æ·»åŠ è¯¥ä»»åŠ¡è¿›åˆé€‚çš„æ—¶é—´è½®çš„bucketä¸­&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;def &lt;span class=&quot;code-snippet__title&quot;&gt;add&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;timerTaskEntry: TimerTaskEntry&lt;/span&gt;): Boolean&lt;/span&gt; = {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  val expiration = timerTaskEntry.expirationMs&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (timerTaskEntry.cancelled) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (expiration &amp;lt; currentTime + tickMs) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (expiration &amp;lt; currentTime + interval) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    val virtualId = expiration / tickMs&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    val bucket = buckets((virtualId % wheelSize.toLong).toInt)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    bucket.&lt;span class=&quot;code-snippet__keyword&quot;&gt;add&lt;/span&gt;(timerTaskEntry)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (bucket.setExpiration(virtualId * tickMs)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;     &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      queue.offer(bucket)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (overflowWheel == &lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) addOverflowWheel()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    overflowWheel.&lt;span class=&quot;code-snippet__keyword&quot;&gt;add&lt;/span&gt;(timerTaskEntry)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;åœ¨æœ¬å±‚çº§æ—¶é—´è½®é‡Œæ·»åŠ ä¸Šä¸€å±‚æ—¶é—´è½®é‡Œçš„è¿‡ç¨‹ï¼Œæ³¨æ„çš„æ˜¯åœ¨ä¸‹ä¸€å±‚æ—¶é—´è½®çš„intervalä¸ºä¸Šä¸€å±‚æ—¶é—´è½®çš„tickMsã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;java&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt;[&lt;span class=&quot;code-snippet__keyword&quot;&gt;this&lt;/span&gt;] &lt;span class=&quot;code-snippet__function&quot;&gt;def &lt;span class=&quot;code-snippet__title&quot;&gt;addOverflowWheel&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;: Unit &lt;/span&gt;= {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;synchronized&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (overflowWheel == &lt;span class=&quot;code-snippet__keyword&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      overflowWheel = &lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; TimingWheel(&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        tickMs = interval,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        wheelSize = wheelSize,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        startMs = currentTime,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        taskCounter = taskCounter,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        queue&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      )&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;é©±åŠ¨æ—¶é—´è½®æ»šåŠ¨è¿‡ç¨‹ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ³¨æ„è¿™é‡Œä¼šå­˜åœ¨ä¸€ä¸ªé€’å½’ï¼Œä¸€ç›´é©±åŠ¨æ—¶é—´è½®çš„æŒ‡é’ˆæ»šåŠ¨ç›´åˆ°æ—¶é—´ä¸è¶³äºé©±åŠ¨ä¸Šå±‚çš„æ—¶é—´è½®æ»šåŠ¨ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;def advanceClock(timeMs: &lt;span class=&quot;code-snippet__built_in&quot;&gt;Long&lt;/span&gt;): &lt;span class=&quot;code-snippet__built_in&quot;&gt;Unit&lt;/span&gt; = {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (timeMs &amp;gt;= currentTime + tickMs) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    currentTime = timeMs - (timeMs % tickMs)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (overflowWheel != &lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) overflowWheel.advanceClock(currentTime)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;é©±åŠ¨æºï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;kotlin&quot;&gt;&lt;section&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;private&lt;/span&gt;[&lt;span class=&quot;code-snippet__keyword&quot;&gt;this&lt;/span&gt;] &lt;span class=&quot;code-snippet__keyword&quot;&gt;val&lt;/span&gt; reinsert = (timerTaskEntry: TimerTaskEntry) =&amp;gt; addTimerTaskEntry(timerTaskEntry)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt; &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;def advanceClock(timeoutMs: &lt;span class=&quot;code-snippet__built_in&quot;&gt;Long&lt;/span&gt;): &lt;span class=&quot;code-snippet__built_in&quot;&gt;Boolean&lt;/span&gt; = {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;var&lt;/span&gt; bucket = delayQueue.poll(timeoutMs, TimeUnit.MILLISECONDS)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (bucket != &lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    writeLock.lock()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;try&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      &lt;span class=&quot;code-snippet__keyword&quot;&gt;while&lt;/span&gt; (bucket != &lt;span class=&quot;code-snippet__literal&quot;&gt;null&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        timingWheel.advanceClock(bucket.getExpiration())&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        bucket.flush(reinsert)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        bucket = delayQueue.poll()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    } &lt;span class=&quot;code-snippet__keyword&quot;&gt;finally&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      writeLock.unlock()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;3.Â &lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;strong/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.0734375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/jE5bOw22iaBtFvdK9icOj3ibAXa8W3tqZ2lQDEaA5XcCDJ5cVIic2221PzXcw0oo69kvia8ojgPZnEV4jPxZURBln4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot; data-backw=&quot;562&quot; data-backh=&quot;41&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;é€šè¿‡ä»¥ä¸Šå·¥ä½œï¼Œæ»´æ»´Prestoé€æ¸æ¥å…¥å…¬å¸å„å¤§æ•°æ®å¹³å°ï¼Œå¹¶æˆä¸ºäº†å…¬å¸é¦–é€‰Ad-HocæŸ¥è¯¢å¼•æ“åŠHive SQLåŠ é€Ÿå¼•æ“ï¼Œä¸‹å›¾å¯ä»¥çœ‹åˆ°æŸäº§å“æ¥å…¥åçš„æ€§èƒ½æå‡ï¼š\n&amp;quot;]]&quot;&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;ä½†æ˜¯å¦‚æœçœ‹æœ€è¿‘ä¸€ä¸ªæœˆçš„CPUä½¿ç”¨ç‡ä¼šå‘ç°ï¼Œå¹³å‡CPUä½¿ç”¨ç‡æ¯”è¾ƒä½ï¼Œä¸”æ³¢å³°åœ¨ç™½å¤©10~18ç‚¹ï¼Œæ™šä¸ŠåŸºæœ¬ä¸Šæ²¡æœ‰æŸ¥è¯¢ï¼ŒCPUä½¿ç”¨ç‡ä¸åˆ°5%ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&amp;quot;,&amp;quot;0:\&amp;quot;%23333333\&amp;quot;&amp;quot;]]&quot;&gt;kafkaçš„å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨æ—¶é—´è½®å®ç°ï¼Œèƒ½å¤Ÿæ”¯æŒå¤§é‡ä»»åŠ¡çš„é«˜æ•ˆè§¦å‘ï¼Œä½†æ˜¯åœ¨kafkaå»¶è¿Ÿé˜Ÿåˆ—å®ç°æ–¹æ¡ˆé‡Œè¿˜æ˜¯çœ‹åˆ°äº†delayQueueçš„å½±å­ï¼Œä½¿ç”¨delayQueueæ˜¯å¯¹æ—¶é—´è½®é‡Œé¢çš„bucketæ”¾å…¥å»¶è¿Ÿé˜Ÿåˆ—ï¼Œä»¥æ­¤æ¥æ¨åŠ¨æ—¶é—´è½®æ»šåŠ¨ï¼Œä½†æ˜¯åŸºäºå°†æ’å…¥å’Œåˆ é™¤æ“ä½œåˆ™æ”¾å…¥æ—¶é—´è½®ä¸­ï¼Œå°†è¿™äº›æ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½é™ä¸ºO(1)ï¼Œæå‡æ•ˆç‡ã€‚Kafkaå¯¹æ€§èƒ½çš„æè‡´è¿½æ±‚è®©å®ƒæŠŠæœ€åˆé€‚çš„ç»„ä»¶æ”¾åœ¨æœ€é€‚åˆçš„ä½ç½®ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;æœ¬æ–‡ä½œè€…&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;h3&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;â–¬&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/h3&gt;&lt;h3&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;106&quot; data-backw=&quot;562&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;562&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;106&quot; data-ratio=&quot;0.18946188340807174&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzFSfRy6bcPNkSCjLkT4a5KRa0Rh1n8icXoTBmxqDdEibibXiaK5vI6zfCliag/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;892&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;é€šè¿‡ä»¥ä¸Šå·¥ä½œï¼Œæ»´æ»´Prestoé€æ¸æ¥å…¥å…¬å¸å„å¤§æ•°æ®å¹³å°ï¼Œå¹¶æˆä¸ºäº†å…¬å¸é¦–é€‰Ad-HocæŸ¥è¯¢å¼•æ“åŠHive SQLåŠ é€Ÿå¼•æ“ï¼Œä¸‹å›¾å¯ä»¥çœ‹åˆ°æŸäº§å“æ¥å…¥åçš„æ€§èƒ½æå‡ï¼š\n&amp;quot;]]&quot;&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;ä½†æ˜¯å¦‚æœçœ‹æœ€è¿‘ä¸€ä¸ªæœˆçš„CPUä½¿ç”¨ç‡ä¼šå‘ç°ï¼Œå¹³å‡CPUä½¿ç”¨ç‡æ¯”è¾ƒä½ï¼Œä¸”æ³¢å³°åœ¨ç™½å¤©10~18ç‚¹ï¼Œæ™šä¸ŠåŸºæœ¬ä¸Šæ²¡æœ‰æŸ¥è¯¢ï¼ŒCPUä½¿ç”¨ç‡ä¸åˆ°5%ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&amp;quot;,&amp;quot;0:\&amp;quot;%23333333\&amp;quot;&amp;quot;]]&quot;&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;æ‰€ä»¥ï¼Œè§£å†³æ™šä¸Šèµ„æºæµªè´¹é—®é¢˜æ˜¯æˆ‘ä»¬ä»Šåéœ€è¦è§£å†³çš„éš¾é¢˜ã€‚&amp;quot;,&amp;quot;0:\&amp;quot;%23333333\&amp;quot;&amp;quot;],[20,&amp;quot;\nåŒæ—¶ï¼Œä¸ºäº†ä¸ä¸å¼€æºç¤¾åŒºè„±èŠ‚ï¼Œæˆ‘ä»¬æ‰“ç®—å‡çº§PrestoDB 0.215åˆ°PrestoSQL 340ç‰ˆæœ¬ï¼Œå±Šæ—¶ä¼šæŠŠæˆ‘ä»¬çš„Presto on Druidä»£ç å¼€æºå‡ºæ¥ï¼Œå›é¦ˆç¤¾åŒºã€‚&amp;quot;]]&quot;&gt;æ»´æ»´è½¦é™©å›¢é˜Ÿæ¶æ„å¸ˆï¼Œè´Ÿè´£è½¦é™©æ ¸å¿ƒç³»ç»Ÿçš„æ¶æ„å’Œè®¾è®¡ï¼Œåå¹´äº’è”ç½‘ç ”å‘æ¶æ„ç»éªŒï¼Œå…¶ä¸­äº”å¹´ä¸­é—´ä»¶ä¸åŸºç¡€æ¶æ„ç»éªŒï¼Œå¯¹é«˜å¹¶å‘ï¼Œé«˜å¯ç”¨ä»¥åŠåˆ†å¸ƒå¼åº”ç”¨çš„æ¶æ„è®¾è®¡æœ‰ä¸°å¯Œçš„å®æˆ˜ç»éªŒï¼Œå°¤å…¶å¯¹åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œåˆ†å¸ƒå¼æµç¨‹ç¼–æ’å¼•æ“ã€åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶æœ‰è¾ƒæ·±å…¥çš„ç ”ç©¶ï¼Œçƒ­çˆ±æŠ€æœ¯ï¼Œå´‡å°šå¼€æºï¼Œæ˜¯Kafkaã€RocketMQã€Conductorç­‰å¤šä¸ªçŸ¥åå¼€æºé¡¹ç›®çš„æºç è´¡çŒ®è€…ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;/h3&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;strong&gt;å›¢é˜Ÿæ‹›è˜&lt;/strong&gt;&lt;strong/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;â–¬&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;å¯¹äºä½é‡è¦åº¦çš„ç‰¹å¾ï¼Œæœ€ç»ˆåšäº†åˆ é™¤ï¼Œä»è€Œé™ä½æ¨¡å‹å¤§å°ã€‚ä¾‹å¦‚æˆ‘ä»¬å‘ç°æ–¹ä½è§’çš„é‡è¦åº¦åœ¨å®é™…æ¨¡å‹è®­ç»ƒä¸­ä¸å¦‚è§’å˜é‡ã€‚æ¨æµ‹æ–¹ä½è§’æœ¬èº«çš„ä¸è¿ç»­æ€§ï¼ˆ0 = 2piï¼‰å¯èƒ½å¯¹æ¨¡å‹è®­ç»ƒæ˜¯ä¸€ç§å¹²æ‰°ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;å¯¹äºå¼‚å¸¸å€¼ï¼Œåšäº†åŸºæœ¬çš„æ•°æ®æ¸…æ´—ï¼Œå¦‚æ— æ•ˆçš„é€Ÿåº¦å€¼ï¼Œæ— æ•ˆçš„æ–¹ä½è§’ï¼›å¯¹äºä¸è¶³çš„GPSåºåˆ—é•¿åº¦ï¼Œç”¨0è¿›è¡Œå¡«å……ï¼ˆä½†éœ€è¦é¢å¤–æ³¨æ„èµ·ç‚¹å±æ€§ï¼‰ç­‰ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;3. æ¨¡å‹é€‰æ‹©ã€è®­ç»ƒä¸æ•ˆæœ&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;DNN&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;ï¼šåªéœ€è¦ç›¸å¯¹ç®€å•çš„ç®—æ³•å®ç°ï¼Œå¼•å…¥è¾ƒå°çš„æ¨¡å‹åº“ã€‚ç„¶è€ŒGPSè½¨è¿¹æ•°æ®å…·æœ‰å…¸å‹çš„æ—¶é—´åºåˆ—ç‰¹å¾ï¼Œåœ¨4ä¸‡æ ·æœ¬ä¸‹ï¼Œåº”ç”¨åˆ©ç”¨DNNæ¨¡å‹è°ƒå‚ä¼˜åŒ–åï¼Œè®­ç»ƒç»“æœå‡†ç¡®ç‡æœ€é«˜è¾¾åˆ°91%ã€‚Bad caseä¸­å­˜åœ¨å¤§é‡æ—¶é—´ä¸æ•æ„Ÿçš„æƒ…å½¢ï¼Œæœ€å…¸å‹çš„æƒ…å½¢å°±æ˜¯â€”â€”è½¨è¿¹ç”±å·®è½¬ä¼˜æ—¶ï¼Œåˆ¤å®šç»“æœæœªèƒ½åŠæ—¶è½¬å˜ä¸ºé«˜è´¨é‡ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;CNN&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;ï¼šè¿™é‡Œå¯ä»¥å°è¯•ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡ç”Ÿæˆbitmapè¿›è¡Œè¯†åˆ«ï¼Œç„¶è€ŒGPSè·¨åº¦ä¸ç¡®å®šæ€§è¾ƒé«˜ï¼Œæ–¹å‘æ€§ä¸æ˜“è¡¨è¾¾ï¼Œåœ¨å®ç°ä¸Šå…·æœ‰ä¸€å®šå›°éš¾ã€‚ç¬¬äºŒç§å°†åºåˆ—åŒ–æ•°æ®è½¬åŒ–ä¸ºäºŒç»´æ•°ç»„ï¼ŒCæ¨¡å‹èƒ½å¤Ÿè¯†åˆ«å‡ºå‰åæ—¶é—´æˆ³ä¹‹é—´çš„å˜åŒ–ç‰¹å¾ï¼Œä½†å¹¶ä¸èƒ½ä¿ç•™æ›´é•¿çš„æ—¶é—´çš„å˜åŒ–ç‰¹å¾ã€‚æœ€ç»ˆè®­ç»ƒå‡ºçš„å‡†ç¡®ç‡åœ¨93%å·¦å³ã€‚å¦å¤–ï¼ŒCNNæ¨¡å‹åº”ç”¨åœ¨ç§»åŠ¨ç«¯æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå³æ¨¡å‹å°ºå¯¸ä¸€èˆ¬è¾ƒå¤§ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;LSTMï¼ˆ&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ&amp;quot;],[20,&amp;quot;ï¼‰&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;ï¼šä¸€ç§ç‰¹æ®Šçš„RNNæ¨¡å‹ï¼Œç›¸æ¯”å‰è¿°æ¨¡å‹å¯¹è½¨è¿¹è´¨é‡åºåˆ—åˆ¤å®šæœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚åœ¨è½¨è¿¹è´¨é‡ç”±å¥½è½¬å·®ï¼Œæˆ–ç”±å·®è½¬å¥½çš„è¯†åˆ«ä¸Šå…·æœ‰éå¸¸é«˜çš„çµæ•åº¦ï¼Œä½¿ç”¨128ä¸ªunitèƒ½å¤Ÿè¾¾åˆ°97%çš„å‡†ç¡®ç‡ã€‚ç¼ºç‚¹æ˜¯LSTMæ¨¡å‹è®­ç»ƒé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç®—æ³•åº“å®ç°ç›¸å¯¹å¤æ‚ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;æœ€ç»ˆæˆ‘ä»¬é€‰æ‹©äº†ä½¿ç”¨LSTMæ¨¡å‹ã€‚ä½¿ç”¨LSTMçš„è®­ç»ƒç»“æœï¼Œå‡†ç¡®ç‡å¤§å¹…æå‡ã€‚åœ¨å‰©ä½™3%çš„é”™è¯¯æ ·ä¾‹ä¸­ï¼Œå¾ˆå¤šè½¨è¿¹åœ¨å½¢æ€ä¸Šè¡¨ç°å‡ºè¾ƒé«˜çš„çœŸå®æ€§ï¼Œä½†å´æ— æ³•åŒè·¯ç½‘è¿›è¡ŒåŒ¹é…ã€‚ç†è®ºä¸Šé€šè¿‡å¼•å…¥è·¯ç½‘å±æ€§èƒ½å¤Ÿä¸Šå¸¦æ¥å‡†ç¡®ç‡çš„è¿›ä¸€æ­¥æå‡ï¼Œç„¶è€Œè¿™ç§æ•°æ®çš„è€¦åˆè„±ç¦»äº†è½¨è¿¹è´¨é‡åˆ¤å®šçš„åˆè¡·â€”â€”æœåŠ¡äºåèˆªå¼•æ“ä¸“å®¶ç³»ç»Ÿï¼Œè€Œéç›´æ¥ç”¨äºåèˆªåˆ¤å®šã€‚å¯¹æ­¤æˆ‘ä»¬å°†ä¼šåœ¨æœ€åè¿›è¡Œæ›´è¯¦ç»†çš„ä»‹ç»ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3&amp;quot;],[20,&amp;quot;4. ç§»åŠ¨ç«¯æ€§èƒ½ä¼˜åŒ–&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;æ¨¡å‹æ¨ç®—æ€§èƒ½å¯¹äºç§»åŠ¨ç«¯å°¤ä¸ºé‡è¦ã€‚åèˆªåœºæ™¯ä¸‹ï¼ŒGPSæ›´æ–°é¢‘ç¹ï¼Œé€‰æ‹©åœ¨å¿…è¦çš„æ—¶å€™è¿›è¡Œæ¨¡å‹æ¨ç®—èƒ½å¤Ÿé¿å…ä¸å¿…è¦çš„è®¡ç®—å¼€é”€ã€‚é€šå¸¸æˆ‘ä»¬ä¼šè®¡ç®—å½“å‰GPSç‚¹ä¸è§„åˆ’è·¯çº¿çš„åç¦»åº¦ï¼Œåªæœ‰åç¦»åº¦å¤§äºé˜ˆå€¼æ—¶æ‰ä¼šè¿›è¡Œè½¨è¿¹è´¨é‡åˆ¤å®šã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;åŸºäºæ·±åº¦å­¦ä¹ çš„ä¸“å®¶ç³»ç»Ÿæ¢ç´¢&amp;quot;,&amp;quot;27:\&amp;quot;14\&amp;quot;|8:1&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;32:2&amp;quot;],[20,&amp;quot;è½¨è¿¹è´¨é‡æ¨¡å‹ä½œä¸ºåèˆªåˆ¤å®šçš„é‡è¦ä¾æ®ï¼Œèƒ½å¤Ÿä»¥è¾ƒå°çš„ä»£ä»·ç§»æ¤åˆ°ç§»åŠ¨ç«¯ã€‚å¦‚æœä¸è€ƒè™‘å‰ç«¯æ€§èƒ½åŠæ•°æ®é™åˆ¶ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å®šä¹‰æ•´ä¸ªåèˆªåˆ¤å®šé—®é¢˜ï¼Œè®­ç»ƒç›¸åº”çš„åèˆªæ¨¡å‹ã€‚ç„¶è€Œåèˆªåœºæ™¯ç§ç±»ç¹å¤šï¼Œè¿‡äºå¤æ‚ï¼Œè®­ç»ƒå‡ºä¸€å¥—é€šç”¨çš„åèˆªæ¨¡å‹éœ€è¦å¤§é‡çš„æ•°æ®ï¼Œå……è¶³çš„è·¯ç½‘ä¿¡æ¯ï¼Œå’Œè¾ƒå¤§çš„æ¨¡å‹å­˜å‚¨ï¼Œè¿™å¯¹äºç§»åŠ¨ç«¯è€Œè¨€ä¸å¤ªç°å®ã€‚  &amp;quot;]]&quot;&gt;&lt;span&gt;æ»´æ»´è½¦é™©å›¢é˜ŸåŸºäºæ»´æ»´è¿‘ç™¾ä¸‡è¾†è½¦å’Œæµ·é‡æ•°æ®ï¼Œé€šè¿‡çº¿ä¸ŠåŒ–ã€ç§‘æŠ€åŒ–ã€æ•°æ®åŒ–çš„æ‰‹æ®µï¼Œè¾¾åˆ°è½¦é™©çš„é™èµ”ä»˜ã€é™å‘ç”Ÿï¼Œé™ä¿è´¹ï¼Œä¸ºä¹˜å®¢ã€å¸æœºã€ä»¥åŠè½¦é˜Ÿã€åˆä½œä¼™ä¼´æä¾›æ–¹ä¾¿å¿«æ·é«˜æ•ˆçš„è½¦é™©é‡‘èæœåŠ¡ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span data-shimo-docs=&quot;[[20,&amp;quot;å¯¹äºä½é‡è¦åº¦çš„ç‰¹å¾ï¼Œæœ€ç»ˆåšäº†åˆ é™¤ï¼Œä»è€Œé™ä½æ¨¡å‹å¤§å°ã€‚ä¾‹å¦‚æˆ‘ä»¬å‘ç°æ–¹ä½è§’çš„é‡è¦åº¦åœ¨å®é™…æ¨¡å‹è®­ç»ƒä¸­ä¸å¦‚è§’å˜é‡ã€‚æ¨æµ‹æ–¹ä½è§’æœ¬èº«çš„ä¸è¿ç»­æ€§ï¼ˆ0 = 2piï¼‰å¯èƒ½å¯¹æ¨¡å‹è®­ç»ƒæ˜¯ä¸€ç§å¹²æ‰°ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;å¯¹äºå¼‚å¸¸å€¼ï¼Œåšäº†åŸºæœ¬çš„æ•°æ®æ¸…æ´—ï¼Œå¦‚æ— æ•ˆçš„é€Ÿåº¦å€¼ï¼Œæ— æ•ˆçš„æ–¹ä½è§’ï¼›å¯¹äºä¸è¶³çš„GPSåºåˆ—é•¿åº¦ï¼Œç”¨0è¿›è¡Œå¡«å……ï¼ˆä½†éœ€è¦é¢å¤–æ³¨æ„èµ·ç‚¹å±æ€§ï¼‰ç­‰ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;3. æ¨¡å‹é€‰æ‹©ã€è®­ç»ƒä¸æ•ˆæœ&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;DNN&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;ï¼šåªéœ€è¦ç›¸å¯¹ç®€å•çš„ç®—æ³•å®ç°ï¼Œå¼•å…¥è¾ƒå°çš„æ¨¡å‹åº“ã€‚ç„¶è€ŒGPSè½¨è¿¹æ•°æ®å…·æœ‰å…¸å‹çš„æ—¶é—´åºåˆ—ç‰¹å¾ï¼Œåœ¨4ä¸‡æ ·æœ¬ä¸‹ï¼Œåº”ç”¨åˆ©ç”¨DNNæ¨¡å‹è°ƒå‚ä¼˜åŒ–åï¼Œè®­ç»ƒç»“æœå‡†ç¡®ç‡æœ€é«˜è¾¾åˆ°91%ã€‚Bad caseä¸­å­˜åœ¨å¤§é‡æ—¶é—´ä¸æ•æ„Ÿçš„æƒ…å½¢ï¼Œæœ€å…¸å‹çš„æƒ…å½¢å°±æ˜¯â€”â€”è½¨è¿¹ç”±å·®è½¬ä¼˜æ—¶ï¼Œåˆ¤å®šç»“æœæœªèƒ½åŠæ—¶è½¬å˜ä¸ºé«˜è´¨é‡ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;CNN&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;ï¼šè¿™é‡Œå¯ä»¥å°è¯•ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯é€šè¿‡ç”Ÿæˆbitmapè¿›è¡Œè¯†åˆ«ï¼Œç„¶è€ŒGPSè·¨åº¦ä¸ç¡®å®šæ€§è¾ƒé«˜ï¼Œæ–¹å‘æ€§ä¸æ˜“è¡¨è¾¾ï¼Œåœ¨å®ç°ä¸Šå…·æœ‰ä¸€å®šå›°éš¾ã€‚ç¬¬äºŒç§å°†åºåˆ—åŒ–æ•°æ®è½¬åŒ–ä¸ºäºŒç»´æ•°ç»„ï¼ŒCæ¨¡å‹èƒ½å¤Ÿè¯†åˆ«å‡ºå‰åæ—¶é—´æˆ³ä¹‹é—´çš„å˜åŒ–ç‰¹å¾ï¼Œä½†å¹¶ä¸èƒ½ä¿ç•™æ›´é•¿çš„æ—¶é—´çš„å˜åŒ–ç‰¹å¾ã€‚æœ€ç»ˆè®­ç»ƒå‡ºçš„å‡†ç¡®ç‡åœ¨93%å·¦å³ã€‚å¦å¤–ï¼ŒCNNæ¨¡å‹åº”ç”¨åœ¨ç§»åŠ¨ç«¯æœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå³æ¨¡å‹å°ºå¯¸ä¸€èˆ¬è¾ƒå¤§ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;LSTMï¼ˆ&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ&amp;quot;],[20,&amp;quot;ï¼‰&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;ï¼šä¸€ç§ç‰¹æ®Šçš„RNNæ¨¡å‹ï¼Œç›¸æ¯”å‰è¿°æ¨¡å‹å¯¹è½¨è¿¹è´¨é‡åºåˆ—åˆ¤å®šæœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚åœ¨è½¨è¿¹è´¨é‡ç”±å¥½è½¬å·®ï¼Œæˆ–ç”±å·®è½¬å¥½çš„è¯†åˆ«ä¸Šå…·æœ‰éå¸¸é«˜çš„çµæ•åº¦ï¼Œä½¿ç”¨128ä¸ªunitèƒ½å¤Ÿè¾¾åˆ°97%çš„å‡†ç¡®ç‡ã€‚ç¼ºç‚¹æ˜¯LSTMæ¨¡å‹è®­ç»ƒé€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œç®—æ³•åº“å®ç°ç›¸å¯¹å¤æ‚ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;æœ€ç»ˆæˆ‘ä»¬é€‰æ‹©äº†ä½¿ç”¨LSTMæ¨¡å‹ã€‚ä½¿ç”¨LSTMçš„è®­ç»ƒç»“æœï¼Œå‡†ç¡®ç‡å¤§å¹…æå‡ã€‚åœ¨å‰©ä½™3%çš„é”™è¯¯æ ·ä¾‹ä¸­ï¼Œå¾ˆå¤šè½¨è¿¹åœ¨å½¢æ€ä¸Šè¡¨ç°å‡ºè¾ƒé«˜çš„çœŸå®æ€§ï¼Œä½†å´æ— æ³•åŒè·¯ç½‘è¿›è¡ŒåŒ¹é…ã€‚ç†è®ºä¸Šé€šè¿‡å¼•å…¥è·¯ç½‘å±æ€§èƒ½å¤Ÿä¸Šå¸¦æ¥å‡†ç¡®ç‡çš„è¿›ä¸€æ­¥æå‡ï¼Œç„¶è€Œè¿™ç§æ•°æ®çš„è€¦åˆè„±ç¦»äº†è½¨è¿¹è´¨é‡åˆ¤å®šçš„åˆè¡·â€”â€”æœåŠ¡äºåèˆªå¼•æ“ä¸“å®¶ç³»ç»Ÿï¼Œè€Œéç›´æ¥ç”¨äºåèˆªåˆ¤å®šã€‚å¯¹æ­¤æˆ‘ä»¬å°†ä¼šåœ¨æœ€åè¿›è¡Œæ›´è¯¦ç»†çš„ä»‹ç»ã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3&amp;quot;],[20,&amp;quot;4. ç§»åŠ¨ç«¯æ€§èƒ½ä¼˜åŒ–&amp;quot;,&amp;quot;8:1&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;æ¨¡å‹æ¨ç®—æ€§èƒ½å¯¹äºç§»åŠ¨ç«¯å°¤ä¸ºé‡è¦ã€‚åèˆªåœºæ™¯ä¸‹ï¼ŒGPSæ›´æ–°é¢‘ç¹ï¼Œé€‰æ‹©åœ¨å¿…è¦çš„æ—¶å€™è¿›è¡Œæ¨¡å‹æ¨ç®—èƒ½å¤Ÿé¿å…ä¸å¿…è¦çš„è®¡ç®—å¼€é”€ã€‚é€šå¸¸æˆ‘ä»¬ä¼šè®¡ç®—å½“å‰GPSç‚¹ä¸è§„åˆ’è·¯çº¿çš„åç¦»åº¦ï¼Œåªæœ‰åç¦»åº¦å¤§äºé˜ˆå€¼æ—¶æ‰ä¼šè¿›è¡Œè½¨è¿¹è´¨é‡åˆ¤å®šã€‚&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;7:3|text-indent:\&amp;quot;1\&amp;quot;&amp;quot;],[20,&amp;quot;åŸºäºæ·±åº¦å­¦ä¹ çš„ä¸“å®¶ç³»ç»Ÿæ¢ç´¢&amp;quot;,&amp;quot;27:\&amp;quot;14\&amp;quot;|8:1&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;32:2&amp;quot;],[20,&amp;quot;è½¨è¿¹è´¨é‡æ¨¡å‹ä½œä¸ºåèˆªåˆ¤å®šçš„é‡è¦ä¾æ®ï¼Œèƒ½å¤Ÿä»¥è¾ƒå°çš„ä»£ä»·ç§»æ¤åˆ°ç§»åŠ¨ç«¯ã€‚å¦‚æœä¸è€ƒè™‘å‰ç«¯æ€§èƒ½åŠæ•°æ®é™åˆ¶ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å®šä¹‰æ•´ä¸ªåèˆªåˆ¤å®šé—®é¢˜ï¼Œè®­ç»ƒç›¸åº”çš„åèˆªæ¨¡å‹ã€‚ç„¶è€Œåèˆªåœºæ™¯ç§ç±»ç¹å¤šï¼Œè¿‡äºå¤æ‚ï¼Œè®­ç»ƒå‡ºä¸€å¥—é€šç”¨çš„åèˆªæ¨¡å‹éœ€è¦å¤§é‡çš„æ•°æ®ï¼Œå……è¶³çš„è·¯ç½‘ä¿¡æ¯ï¼Œå’Œè¾ƒå¤§çš„æ¨¡å‹å­˜å‚¨ï¼Œè¿™å¯¹äºç§»åŠ¨ç«¯è€Œè¨€ä¸å¤ªç°å®ã€‚  &amp;quot;]]&quot;&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;å›¢é˜Ÿé•¿æœŸæ‹›è˜&lt;span&gt;javaé«˜çº§å·¥ç¨‹å¸ˆå’ŒæŠ€æœ¯ä¸“å®¶ï¼Œ&lt;/span&gt;æ¬¢è¿æœ‰å…´è¶£çš„å°ä¼™ä¼´åŠ å…¥ï¼Œå¯æŠ•é€’ç®€å†è‡³ diditech@didiglobal.comï¼Œé‚®ä»¶è¯·é‚®ä»¶ä¸»é¢˜è¯·å‘½åä¸ºã€Œå§“å-åº”è˜éƒ¨é—¨-åº”è˜æ–¹å‘ã€ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;135&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;135&quot; data-ratio=&quot;1&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBFBFcH3cDkw5qRpibVy97GUiaCUicPhRyTg6LpWp2CFHhKZSYuQnmhyZzBnnRxJ4EuWwvI3HTgqibQ7Mw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;256&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;æ‰«ç äº†è§£æ›´å¤šå²—ä½&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;å»¶ä¼¸é˜…è¯»&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;â–¬&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU1ODEzNjI2NA==&amp;amp;mid=2247512436&amp;amp;idx=1&amp;amp;sn=1fea750185b0ec4a5c5e000db7e773e1&amp;amp;chksm=fc29dfd3cb5e56c5e8d07d13a755a3434cfd61af38a161bfde4be7eaf28b56fda65644da6971&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;112&quot; data-backw=&quot;562&quot; data-ratio=&quot;0.2&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBG8fiaH5DpcXl4gX9dSJhFzFUvNyoeeVzZpUV1iao6ZywZNm1lvQfoWJiaYJF1rICaHKIACfRhLLoIeA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1000&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;section&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU1ODEzNjI2NA==&amp;amp;mid=2247507588&amp;amp;idx=1&amp;amp;sn=a4cc88ed4a14007f5d39da9e7c0e6d02&amp;amp;chksm=fc29b023cb5e393522bc096473e6ff4a5b2045bb591dd62609a6cbae7a2727991c6d82d628e3&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;112&quot; data-backw=&quot;562&quot; data-ratio=&quot;0.2&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBHraEAV6GKpIj4dQOQNs9ggIppJ4Jhjb2ic2K75ZnPYjTCBicrmiaEgQtH17Ks8E8uk0QeojUDD9whibQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1000&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/a&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU1ODEzNjI2NA==&amp;amp;mid=2247493821&amp;amp;idx=1&amp;amp;sn=c3fa1e6733cf9f2b173793adeb0139b3&amp;amp;chksm=fc29861acb5e0f0c5bb5bf02d4e0cafc68cd19232643be1cb798a05bd4a60e65d8705281a0ac&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ä½ å·²é€‰ä¸­äº†æ·»åŠ é“¾æ¥çš„å†…å®¹&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot; hasload=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.2&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;1000&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBFPvfKQEIHKT8V3yZSGBZQtHgjI7CoApEqXV3uRhYFH383kdxwNSsfOUib2NViciaJeYHtJk1CvZdVGA/640?wx_fmt=png&quot; data-backw=&quot;562&quot; data-backh=&quot;112&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;å†…å®¹ç¼–è¾‘&lt;span&gt; | Charlotte&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;è”ç³»æˆ‘ä»¬ | DiDiTech@didiglobal.com&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;pre ng-bind-html=&quot;message.MMActualContent&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;img class=&quot;rich_pages&quot; data-backh=&quot;162&quot; data-backw=&quot;562&quot; data-ratio=&quot;0.28888888888888886&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/1wBZCGiaYqBHCquJeOibVaFwqqC4iadSqFxSJRyP1G2V6ZB0tXzfDbHQmq5LXdiawGrVAfTs5INmjsvxOnH4dU8how/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>8a1133ac7a7a479ab4f433875ac1a95c</guid>
<title>[æ¨è] å·¥å…· | ä¸€ä¸ªè½»é‡çº§ä¸šåŠ¡ä¸­å°å¼€å‘æ¡†æ¶</title>
<link>https://toutiao.io/k/6qs3yvv</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;weui-dialog&quot;&gt;
      &lt;p class=&quot;weui-dialog__hd&quot;&gt;&lt;strong class=&quot;weui-dialog__title&quot;&gt;&quot;Top Stories&quot; is disabled&lt;/strong&gt;&lt;/p&gt;
      &lt;p class=&quot;weui-dialog__bd&quot;&gt;
        Enable &quot;Top Stories&quot; in &quot;Settings&quot; &amp;gt; &quot;General&quot; &amp;gt; &quot;Manage Discover&quot;      &lt;/p&gt;
      
    &lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>