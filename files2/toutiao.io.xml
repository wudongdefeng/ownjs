<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>f8028b4fcba6fdffdceecadd411cf538</guid>
<title>欢迎加入读者圈子，一起交流！</title>
<link>https://toutiao.io/k/mtrqmru</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;
            &lt;p&gt;&lt;span&gt;&lt;strong&gt;欢迎加入读者圈子，一起交流！&lt;br/&gt;↓↓↓&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;558&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;307&quot; data-ratio=&quot;0.5493333333333333&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/AjN1jquNavich3VaNkKeiaAwUhz7TQbQmic4fFsr58X9PAYleYzxqc1K1vZjeBoZDMUsmia0xH67EQYINGRvNOtLmA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;750&quot;/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;圈子剧透&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1、600+圈子成员，以中高级程序员为主，更有架构师、CTO坐镇交流；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2、1000+优质主题，数十G独家资料，每日分享，精挑细选；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3、全年52期专属邮件周报，让你轻松掌握业界资讯、技术干货，提升认知水平；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;4、全年52本好书共读，让你花最少的时间，获取更好的知识；&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;……&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;心动不如行动，赶快加入吧！&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>bd1f0b6a160b1569aca0ba1efc83599e</guid>
<title>携程机票前台Trace系统的演进之路</title>
<link>https://toutiao.io/k/3sbtt6o</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;
            &lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;作者简介&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;Devin，携程资深后端开发工程师，专注 Java相关领域以及自动化相关的研究&lt;/p&gt;&lt;p&gt;Hank，携程资深后端开发工程师，专注 java以及.net技术领域的研究&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;一、前言&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;随着微服务架构的普及，这些微服务构成了复杂的分布式网络，在支撑我们海量查询的同时，也带来了一些问题。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;机票前台预订主流程服务现在有若干个系统，每个系统部署了多个服务，每个服务又依赖多个API，用户通过终端设备（手机、PC等）预订了机票产品，过程中出现“系统异常”该如何分析排查呢？&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;运营人员将问题抛给开发/测试人员定位，开发/测试人员只知道有异常，如何高效地从复杂的调用链条中找到原因，这对开发/测试人员会带来很大的挑战。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;开发/测试人员借助单点日志逐个排查的效率是非常低的，特别是一些UI层的“待确认”的问题，只依赖一些日志报文进行排查效率是非常低下的。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;如何提高开发/测试人员的排查效率，同时降低非开发人员的使用门槛？答案或许就是携程机票前台Trace系统。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;二、Trace系统的发展历程&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;2.1 基于原始日志的Dev&amp;amp;Ops&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;机票前台的日志记录还是比较完善的，我们将系统中的服务以及上下游依赖的服务都进行了日志写入。依据业务属性制作了一些Kibana面板，结合一些解压缩工具是可以满足日常需求的。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在微服务架构中，随着业务的不断增加，复杂度同样也会越来高，对开发/测试以及运维人员的效率带来了很大的挑战，主要问题体现在：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;不同的微服务，多个日志Topic，多个查询面板&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;需要人为手动聚合/串联不同的微服务的日志，还原用户行为&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;不同团队的服务，日志压缩方式存在差异，解压方式不同&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;面向开发的服务名称，可读性低&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;公司内部系统间未打通，互相之间操作需要手工方式处理&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;2.2 基础建设&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;经过长时间的实践和探索，&lt;span&gt;机&lt;/span&gt;&lt;span&gt;票前台的&lt;/span&gt;日志体系和自动化设施都较为完备。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;日志体系在机票前台主要有以下三类日志，这三类日志可以满足日常开发运维的基本需求，实现对整个流程的精准把控。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;UBT日志，主要记录用户的一些行为日志，便于解决用户反馈的问题&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Mertics日志，主要记录一些业务指标，作为内部后续业务需求演进的依据&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Trace日志，记录服务处理过程中所产生的信息日志，如接口报文，错误信息等。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;自动化设施，大幅度降低日常运维开发的成本。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;2.3 基于Chrome插件版本的Trace 工具&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;机票前台通过日志和自动化建设来保证日常开发运维的基本流程，通过Chrome插件来解决一些重复工作。比如：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5978128797083839&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcqYou7hKohWKvqD5y3nWPfWjdicPXCk8N0LeTbwVcy6xojiaJLJoylhGw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;823&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;插件模式解决了一些重复工作，对效率有一定的提升。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;2.4 遇到的问题&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;随着业务的不断膨胀，微服务越来越多。作为BFF层（Backends For Frontends 服务于前端的后端）我们需要聚合多个接口方提供的微服务，使得BFF层的调用关系也会越来越复杂。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;现有的“插件模式”已经很难满足日常工作。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4578512396694215&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcX9oUGxrRMa6ypicuYpxcy1xiaGAROfzWx4w8siaiakSCQXrXTF8oJtja6A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1210&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;“插件模式Trace系统”遇到了如下一些问题：&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;三、系统设计&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;针对上述的问题，Trace系统进行了一些针对性的优化和演进。目前Trace系统大致架构如图所示。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6568047337278107&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEc2VvAuU5zibXetJzLkXicYotS1xrfzXOK2L8Hn0GqVjLcxFXD9gMNI9Gg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;676&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;业务层：根据业务使用方分为前台主流程、机酒业务、增值业务、IBU等&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Web层：主要有四个部分，搜索条件、数据展示、页面回放、一键Mock&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;搜索引擎层：根据Web传达到服务的请求（搜索条件），构建Clickhouse的搜索SQL，从Clickhouse获取数据&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;数据处理层：根据业务线将CK数据进行加工组装、处理一键Mock请求，并将数据传送至Web进行反馈&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;配置信息：配置信息主要是针对引擎层做Clickhouse搜索配置以及业务层做业务字段配置&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;日志记录：隶属于各个业务方的具体应用&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;四、系统的功能介绍&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.1 友好的搜索条件&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;针对Kibana的搜索条件进行了降噪和业务封装，采用了更适合用户行为习惯的友好搜索条件，见下图标志1。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4583333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcjDib8xd3kicyFCJggYS7K9fFiaHrwiabE7IMj2Lia9708kApJSYhd2vgAog/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.2 日志查看功能&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;报文日志一般记录在ES/Clickhouse中，并最终在Kibana中呈现。在Kibana中可以通过组合过滤条件来获取我们需要的日志，并且也可以实现聚合服务整个链路日志的目的，但是Kibana存有一些用户行为习惯上的问题。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;结合这两点，Trace系统对搜索条件进行了降噪，并且对链路日志采用分层处理，给予用户友好的使用体验。对日志报文支持自动解压缩以及格式化。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.4578125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dDSHabwM9ST77HhoJicGetOx7IicVmZib3FLauLVribeYGnLbxAXiccRGPPOF90GvsjL2DdQFLkyicTYpw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5396419437340153&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcd8g9xv6neOG7ibK6TREajw5RrrFIlEWhDGCBYPUKtkyToZByfDKKz6g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1564&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.3 聚合多平台&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;上面提到的日志体系，三类日志存放在不同的数据源，通过不同平台进行展示。这也就导致日常过程中需要游走于多平台进行数据采集和分析。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;比如在分析服务日志的同时需要查询用户的UI访问日志，需要在两个平台间跳转，并且平台的搜索数据无法同步。为了解决该问题，Trace系统采用了外链的形式进行聚合并关联单次查询的搜索数据，如时间和用户标志等，进行多平台之间的传递，从而达到数据串联的效果。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;之所以采用外链方式而非在系统内部集成多平台内容，主要的考虑在于该系统的定位是做链路的追踪处理。如果耦合了过多的数据，系统就会变的复杂，会给系统用户造成过多的干扰。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.40927303949627936&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcVWPGe2f4Cylicmny7LyRWTva7kB9xwz4Z8tiaOKjKdZBPjvHDS8mgOqA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1747&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.4 多业务场景聚合，过期日志补偿&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;系统在一次搜索中聚合多个业务线，如主流程预订，低价订阅，增值产品等，无需用户手动区分搜索渠道。并且对于Clickhouse过期（ClickHouse日志只存储半个月时间）数据采用Hive查询进行数据补偿。解决用户在ClieckHouse和Hive中切换。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;4.5 基于CRN_Web技术的页面回放功能&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;日志体系和自动化设施的结合除了两者处于割裂状态之外，还有一个问题在于双方都是隶属于技术驱动，而对于非开发人员来说，具有较高的使用壁垒。比如在运维人员复现用户反馈问题的时候，需要开发人员介入，进行日志数据准备，环境Mock准备，而后才可以复现用户反馈的问题。而往往用户反馈的问题中，大多数是UI展示层面的问题，如果按照上述流程，则排障的成本较大。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;因而Trace系统在链路追踪和自动Mock的基础上提供了用户页面回放的功能。&lt;span&gt;系统会收集用户访问页面关联的所有服务请求的日志，将日志报文进行Mock，再通过CRNWeb技术，真实发起一次页面访问，此时服务会返回相应的Mock报文，从而达到页面回放的效果，&lt;/span&gt;让运维人员更加直观的了解用户所反馈的问题。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;通过BatcheId关联一次页面访问中的同批次服务，系统进行自动拉取报文并进行Mock，然后将Mock结果关联当前用户标志，通过CRNWeb实现页面回放，高保真还原所见界面。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5139171758316361&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcI8hoUCK6vuc1rMGsDgrgbEIL8MelxpaQ7eIwje9OH57AaO7vl7s45g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1473&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.6 一键Mock功能&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;日常工作中，日志体系和自动化设施处于割裂状态，主要体现在日志和Mock系统的结合使用。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;在之前的使用流程中，我们需要在Kibana中搜索到链路日志，然后将接口调用的报文，在Mock系统中进行配置，这样的操作是比较费时费力的。有些服务调用的接口数量高达二三十个，这样的数据人工配置的话需要浪费非常长的时间。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;针对这个问题，Trace系统在链路聚合的基础上提供了一键Mock的功能，将此次服务所涉及的链路调用全部自动配置到接口中，过程无需人工干涉，将之前需要十分钟的工作降低至五秒内，极大地提高了工作效率。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5246105919003116&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcqAGPbqKrndZKROia8ZPpWosrwrB6VOibx0wiauiawBGqG4ZtBJ3OfGH8bg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1605&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4005123825789923&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcicrnhqib2psjicGHK5fsxzXfHoONHRseicTK4VSpAFtsX3EbhzCBCY1gww/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1171&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.7 关键信息外露&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;针对一些服务的错误场景，将错误码转换为实际错误文案，友好提示系统用户。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4334916864608076&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/kEeDgfCVf1dSibuYQ6ZibiblCCLPvGyXAEcRwiaEaZzQWcPRpWbq4JLA9k2wnMAz8WE2vx2QtNicBHfDbcTeWQzRFVg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1684&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.8 联通报表系统&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;报表系统是前台用于日常业务的监控系统，它能实时监控异常的业务场景和业务处理结果。Trace系统联通报表系统，在报表系统中可以通过外链跳转至Trace系统，并传递异常场景的相关参数，如用户标志，场景限定等，从而获取异常场景的上下文（日志），见4.7示图。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;4.9 外链其他平台&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;采用了外链的形式进行多平台功能聚合，并关联单次查询的搜索数据，如时间、用户标志等，进行多平台之间的传递，从而达到数据串联的效果。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;五、总结&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;Trace系统是针对日常开发运维过程中所浮现的一些问题，所研发的效能工具系统，它以降低开发运维成本，提高日常产能为目标，提供了诸多便捷性功能。系统在上线投入使用后，效果显著，取得了较大的产出和成果。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;5.1 降低非开发人员的使用门槛，提高问题筛查的自助率，提升相应效率&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;5.2 降低人力成本&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;5.3 降低沟通成本，提高了日常排障的产能，日常问题反馈中多以Trace系统外链进行信息共享&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;5.4 打通报表系统后使得异常场景筛查形成闭环&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;【推荐阅读】&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/kEeDgfCVf1dDSHabwM9ST77HhoJicGetOjeVowdMZyOaVeibDSVqJdHOoBZwuKU3UC48jp5NYMSlJAic9lEpAqpew/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt; “携程技术”公众号&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;  分享，交流，成长&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>83cdf78f0127a4e14ad8de815dfc5c16</guid>
<title>Spark SQL深入分析之图解五种Join策略的执行流程与应用场景</title>
<link>https://toutiao.io/k/w4rlts8</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;
            &lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;Mzg5NTE5ODUzMA==&quot; data-alias=&quot;fausai_talk&quot; data-from=&quot;0&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWRWibjLlgVjPiccGnJIg9NbdRX3YDLd0XGicicA2Mq7aZAzy4e8bfVpiajpribEbia42wwQqZ9gegfQ0KWg/0?wx_fmt=png&quot; data-nickname=&quot;浮世Talk&quot; data-signature=&quot;逍遥浮世，与道俱成。人来人往，与君共勉。&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;前言&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Join（连接）操作是大数据分析领域必不可少的操作，本文将从原理层面介绍&lt;/span&gt;&lt;span&gt;&lt;span&gt;SparkSQL支持的&lt;/span&gt;&lt;span&gt;五大&lt;/span&gt;&lt;span&gt;连接&lt;/span&gt;&lt;span&gt;策略&lt;/span&gt;&lt;span&gt;及其适用场景。通过本文的学习，你将会了解Spark SQL中五大连接策略的连接原理，&lt;span&gt;并且学会根据不同的影响因素和不同的需求场景，选择合适的连接策略，从而更好地完成你的工作。&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;五大连接策略&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span/&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;Spark SQL内置了五种连接策略，分别如下所示：&lt;/section&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;Broadcast Hash Join&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Shuffle Hash Join&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Shuffle Sort Merge Join&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Cartesian Product Join&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Broadcast Nested Loop Join&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;nginx&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;这五种连接策略分别对应&lt;span class=&quot;code-snippet__attribute&quot;&gt;Spark&lt;/span&gt; SQL中五个物理操作符：&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;BroadcastHashJoinExec&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;ShuffledHashJoinExec&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;SortMergeJoinExec&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;CartesianProductExec&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;BroadcastNestedLoopJoinExec&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;section&gt;&lt;strong&gt;三大影响因素&lt;/strong&gt;&lt;/section&gt;&lt;section&gt;在处理实际需求时，可能会根据不同的场景选择不同连接策略，而选择不同的连接操作会得到不同的处理效率。一般情况下，有三个因素影响连接操作的效率，它们分别是：&lt;/section&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;Join type is equi-join or not 连接类型是否为equi-join(等值连接)&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Join strategy hint 连接策略提示&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Size of Join relations 连接数据集的大小&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;本文剩下部分先解释这三个因素，然后讲解每个连接类型的特征与工作原理，了解这些之后你就可以基于这三个影响因素去分析，从而选择合适的连接策略去解决你的需求。&lt;/section&gt;&lt;section&gt;&lt;span&gt;下面对这&lt;/span&gt;&lt;span&gt;三个影响因素进行一一说明。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;1、是否等值连接&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;等值连接是一个在连接条件中只包含equals比较的连接，而非等值连接包含除equals以外的任何比较，例如&amp;lt;, &amp;gt;, &amp;gt;=, &amp;lt;=。由于非等值连接需要对不确定的值的范围进行比较，因而嵌套循环是必须的。因此，对于非等值连接，Spark SQL只支持Broadcast Nested Loop Join（广播嵌套循环连接）和Cartesian Product Join（笛卡尔乘积连接）。而所有连接运算符都支持等值连接。&lt;/section&gt;&lt;section&gt;Spark SQL定义了ExtractEquiJoinKeys模式，JoinSelection&lt;span&gt;（规划连接操作的核心对象）&lt;/span&gt;使用它来检查逻辑连接计划是否是等值连接。如果是等值连接，连接的元素将从逻辑计划中提取出来，包括连接类型、左键、右键、连接条件、左连接关系、右连接关系和连接提示。这些元素的信息构成了接下来连接规划过程的基础。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2961104140526976&quot; data-type=&quot;png&quot; data-w=&quot;797&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EF3dWa7DUGxfNvGKfU0XFQZaJ4yC6vsKyyQc4o9fScfoDIes23cMbrQ/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;2、连接提示&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;Spark SQL为开发人员提供了通过连接提示对连接策略选择进行一些控制。在Spark 3.0.0版本中，支持以下四个连接提示：&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2953929539295393&quot; data-type=&quot;png&quot; data-w=&quot;369&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EDlgak7WUVIAI1vzaDWVkryVn7M644kyWO6Fh5DMLlWGPhNEpKTCn4w/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;开发人员可以在SELECT子句中添加带有提示类型和表名称的提示语法：&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2532051282051282&quot; data-type=&quot;png&quot; data-w=&quot;312&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EiaicZSAuLgJEypjLibSAOO2U5Tdic40msy27MgPpoZkJPD2cf1zic3Q5bbQ/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;UnresolvedHint节点由解析器生成，并由分析器转换为ResolvedHint节点：&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.1659513590844063&quot; data-type=&quot;png&quot; data-w=&quot;699&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EazZGelatibDiaLHxAlZovrtMH1s3yiaFfHX8r7ZV1teciaOTj6OEsYPxdA/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.25327510917030566&quot; data-type=&quot;png&quot; data-w=&quot;687&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EszLR1p0ial7SrSiaiaxGwHRFjiaFOQVP2zPicGteEiagzdhTtib3bobqQgpjw/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;优化器应用了EliminateResolvedHint规则，从而将提示信息移入连接运算符，并删除ResolvedHint运算符。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.14980793854033292&quot; data-type=&quot;png&quot; data-w=&quot;781&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EK9eicrxReiar9KdNE6doDwO6Kk2OHOiceUu8ibnVvx5yH6up9eCv2Smr2Q/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;连接提示信息是通过上述ExtractEquiJoinKeys模式提取的，并用于连接策略选择过程，这一点稍后将在本文中解释。&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;3、连接的数据集大小&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;选择连接策略最重要的因素是连接数据集的大小。选择连接策略的核心原则是避免reshuffle和重新排序的操作，这些操作非常昂贵，对查询的性能影响很大。因此，首选的连接策略是不需要reshuffle或者重新排序的连接策略，如基于hash的连接策略。然而，这些连接策略的可用性取决于连接中涉及的数据集的大小。&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;如何选择合适的连接策略&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;上一小节我们已经了解在选择连接策略时需要考虑的三个因素，接下来将深入研究五大连接策略的原理以及在不同的影响因素下如何选择合适的连接策略。&lt;/section&gt;&lt;section&gt;在Spark SQL的物理计划阶段，JoinSelection对象会根据是否等值连接、连接提示类型、连接的数据集大小以及参与连接的key是否可以排序等条件进行连接策略选取，基于JoinSelection对象中选择&lt;span&gt;连接策略的&lt;/span&gt;逻辑，绘制以下流程图：&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6392961876832844&quot; data-type=&quot;png&quot; data-w=&quot;1023&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1E4X9wRjTiauTu6sysibWtB196uQ8NYKibjuhYTWXAYbLQU17GkqQH5EqPQ/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;h5&gt;下文的分析都会围绕以上流程图展开，从图中可以看到，连接选取过程从判断是否为等值连接开始。&lt;/h5&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;首先判断是否为等值连接&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;等值连接在连接操作中是最为为流行和使用的，Spark SQL的五大连接策略都支持等值连接。下面为截取以上流程图中已&lt;span&gt;选择等值连接作为连接策略的部分流程图，我们可以看到，&lt;/span&gt;候选连接策略按照可能的连接性能顺序进行搜索，第一个符合选择条件的策略将被返回，选择流程结束，不再考虑其他策略。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.865606936416185&quot; data-type=&quot;png&quot; data-w=&quot;692&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EPlQYcgXSUrKJYez6LeqnicJe3dp6fZ5OFbAwrcQ17x5KuezMqnog3QQ/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;h6&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;根据给定的连接提示选择策略&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/h6&gt;&lt;h6&gt;&lt;span&gt;在以上等值连接部分流程图我们也可以清楚看到，开发人员指定的连接提示对于连接策略的选择具有最高的优先权。当指定了一个有效的连接提示时，将根据以下条件选择连接策略：&lt;/span&gt;&lt;/h6&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;对于&lt;span&gt;BROADCAST&lt;/span&gt;提示，选择Broadcast Hash Join策略，当&lt;span&gt;BROADCAST&lt;/span&gt;提示在连接的两边都被指定时，选择数据集较小的一边。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;对于&lt;span&gt;SUFFLE_HASH&lt;/span&gt;提示，选择Shuffle Hash Join策略，当&lt;span&gt;SUFFLE_HASH&lt;/span&gt;提示在连接的两边都被指定时，选择数据集较小的一边。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;对于&lt;span&gt;SUFFLE_MERGE&lt;/span&gt;提示，如果连接键是可排序的，选择Shuffle Sort Merge Join策略。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;对于&lt;span&gt;SUFFLE_REPLICATE_NL&lt;/span&gt;，如果连接类型是内部连接，选择Cartesian Product Join策略。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;如果开发人员没有指定连接提示，或者对于指定的连接提示不满足连接条件，选择流程将会往下继续，下面将会讨论参与连接的数据集大小的情况。&lt;/section&gt;&lt;h6&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Broadcast Hash Join的满足条件与运行原理&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h6&gt;&lt;section&gt;选择流程继续&lt;span&gt;往&lt;/span&gt;&lt;span&gt;下移动&lt;/span&gt;，到了判断连接数据集的大小的节点，当连接数据集中至少有一方小到可以收集到driver端，然后广播到每个executor时，&lt;strong&gt;Broadcast Hash Join&lt;/strong&gt;是首选策略。Broadcast Hash Join背后的思想是：在driver端将小规模的数据集广播给每个executor的成本低于reshuffle或者重新排序所需的成本。为了使Broadcast Hash Join具有良好的性能，需要广播的数据集必须足够小，否则，性能会变差，甚至最终出现内存不足的错误。使用广播的数据集的默认大小阈值是10MB，也就是说，数据集需要小于10MB。默认大小可以通过配置 spark.sql.autoBroadcastJoinThreshold的值来调整，该设置基于你的driver端和executor端的可用内存。&lt;br/&gt;&lt;/section&gt;&lt;section&gt;在内部，Broadcast Hash Join重写了requiredChildDistribution方法并声明了数据集的广播分发需求。&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.33756805807622503&quot; data-type=&quot;png&quot; data-w=&quot;551&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1Eg759Nosb4BSpic23M9epf5HfoK4h52NIibCOWWibA98qBicGwdLgbMO6Xw/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;当在实际执行之前应用EnsureRequirements规则时，将在执行连接之前添加BroadcastExchange物理运算符：（原理可参考：&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg5NTE5ODUzMA==&amp;amp;mid=2247484258&amp;amp;idx=1&amp;amp;sn=9036e19f02a5a666016ff0dac20f8832&amp;amp;chksm=c012b74ff7653e593873c8849fa39c596a393016d7613168885880500e4afd6c446223e2b835&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;Spark Catalyst QueryExecution总体概况&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;Spark Catalyst QueryExecution总体概况&lt;/a&gt;中的&lt;em&gt;Execution Preparation&lt;/em&gt;部分）&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.1974025974025974&quot; data-type=&quot;png&quot; data-w=&quot;770&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EJGBtrkFCh48t0TobUDCynrb0bicibDHictnhDW04RyaibsR3l8CObJH9YQ/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;当BroadcastExchange操作符被执行时，它首先收集数据集的分区以广播给Driver：&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5430809399477807&quot; data-type=&quot;png&quot; data-w=&quot;383&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EdGbxmLn7bgRtQFiaibrw0OgXpe6M1SAfPiagibT4xic6mBX1UrEFTIddeng/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;如果数据集的总行数小于&lt;span&gt;MAX_BROADCAST_TABLE_ROWS&lt;/span&gt;阈值，数据集将被广播，&lt;span&gt;MAX_BROADCAST_TABLE_ROWS&lt;/span&gt;阈值被设置为3.41亿行，这是BytesToBytesMap最大能力容量的70%。注意，这个阈值与 spark.sql.autoBroadcastJoinThreshold（默认为10MB）不同。&lt;span&gt;MAX_BROADCAST_TABLE_ROWS&lt;/span&gt;阈值用于控制广播交换时的广播操作，而spark.sql.autoBroadcastJoinThreshold用于控制Broadcast Hash Join策略的选择。&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3969465648854962&quot; data-type=&quot;png&quot; data-w=&quot;262&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EkbZ1dlfO9dJ67icdVx8z4tH5KiaVpIJS2uq7EGcMtuZfjMrYuqHVVdkg/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;如果数据集的行数小于&lt;span&gt;MAX_BROADCAST_TABLE_ROWS&lt;/span&gt;阈值，数据集的副本将以HashhedRelation类型的广播变量形式发送到每个executor：&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.1738095238095239&quot; data-type=&quot;png&quot; data-w=&quot;420&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1ENmApGWQZw4pPSUIbfdqbMGPLrUePxEauNEXZyCxq6gxLibW3tj3hLKA/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;在executor端，广播的数据集被用作连接的BuildTable，而最初存在于executor中的数据集，即连接的大表，被用作连接的StreamTable。连接过程遍历StreamTable，并在BuildTable中查找匹配的行。&lt;br/&gt;&lt;/section&gt;&lt;h6&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Shuffle Hash Join&lt;strong&gt;&lt;span&gt;的满足条件与运行原理&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;em&gt;&lt;span/&gt;&lt;/em&gt;&lt;/h6&gt;&lt;section&gt;&lt;span/&gt;如果选择Broadcast Hash Join策略的条件没有得到满足，选择流程就会转向检查是否已经将Shuffle Sort Merge Join策略设置为首选。如果没有设置，就会检查是否满足使用Shuffle Hash Join策略的条件。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42045454545454547&quot; data-type=&quot;png&quot; data-w=&quot;616&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1ENztI1UsZgU9GH8o3LJVCRNicJsBFpwOBOkxF47ibfwTQl140ibxvrZ2bA/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;满足Shuffle Hash Join策略的条件是，至少有一个连接数据集需要小到足以建立一个hash table（使得较小的&lt;span&gt;数据集能够加载到内存中&lt;/span&gt;），其大小应该小于广播阈值（spark.sql.autoBroadcastJoinThreshold）和shuffle分区数的乘积。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.08628005657708628&quot; data-type=&quot;png&quot; data-w=&quot;707&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EGaRXAr66QHsLEHhMDP1SRLVxxQZVzOjCa1SIsV5onkevkZAmt8KUtg/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;此外，较小的数据集需要比较大数据集至少小3倍，否则，基于排序的连接策略可能收益更大。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.11010830324909747&quot; data-type=&quot;png&quot; data-w=&quot;554&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1ERL35fbQj0HIxtu9TwJt2icPAzMEINnrYRWeCoVdgdEciajPFZ7lHpAMg/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;Shuffle Hash Join策略要求对连接的两个数据集进行shuffle，以便将两边数据集中具有相同连接键的行放在同一个executor中。为较小的数据集创建一个hashedRelation，并被用作连接的BuildTable。较大的数据集被用作StreamTable。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6928838951310862&quot; data-type=&quot;png&quot; data-w=&quot;534&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EcQ8L7T8ibS5PSEFibnHgRPBibuBd6LQLa4Ric2IASUO0JiaK5KSJ0MN32Iw/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;h6&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Shuffle Sort Merge Join&lt;strong&gt;&lt;span&gt;的满足条件与运行原理&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;em&gt;&lt;span/&gt;&lt;/em&gt;&lt;/h6&gt;&lt;section&gt;&lt;span/&gt;如果选择Shuffle Hash Join策略的条件没有得到满足，或者Shuffle Sort Merge Join策略被配置为首选，那么选择流程就会继续检查是否满足使用Shuffle Sort Merge Join策略的条件。为了使用基于排序的连接算法，连接键必须是可排序的。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3014586709886548&quot; data-type=&quot;png&quot; data-w=&quot;617&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EFhxjkM2ksHLnibx4v1afLU8xp84r102uEdkAzIrkJ4tbYicZCczcAqicg/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;Shuffle Sort Merge Join策略不需要将任何连接数据集装入内存（这一点与&lt;span/&gt;&lt;span&gt;&lt;span&gt;Shuffle Hash Join策略&lt;/span&gt;连接不同&lt;/span&gt;），所以连接数据集没有大小限制。尽管基于排序的连接算法通常没有基于hash的连接算法快，但它通常比嵌套循环的连接算法表现得更好。因此，基于性能和灵活性的双重考虑，Shuffle Sort Merge Join是一个折中的选择方案。&lt;/section&gt;&lt;section&gt;&lt;span/&gt;Shuffle Sort Merge Join策略也需要对连接的两个数据集进行shuffle，以便将两边数据集中具有相同连接键的行放在同一个executor中。此外，每个分区的数据都需要按连接键进行升序排序。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4768637532133676&quot; data-type=&quot;png&quot; data-w=&quot;778&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1E1xO7nFc8WzFd4ia5eNVp1kjfFRkFHtbZJ974CohgAyOCnFlBb6LFUTQ/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;这两个连接数据集中的任何一个都可以作为StreamTable或BuildTable使用。当一个数据集被用作连接的StreamTable时，它被按顺序逐行迭代。对于每个StreamTable行，BuildTable也是按顺序逐行搜索的，以找到与StreamTable行有相同连接键的行。由于StreamTable和BuildTable都是按连接键排序的，当连接过程转移到下一个StreamTable行时，BuildTable的搜索不必从第一个BuildTable行开始，而只需要从与最后一个StreamTable行相匹配的BuildTable行继续。&lt;br/&gt;&lt;/section&gt;&lt;h6&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Cartesian Product Join&lt;strong&gt;&lt;span&gt;的满足条件与运行原理&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;em&gt;&lt;span/&gt;&lt;/em&gt;&lt;/h6&gt;&lt;section&gt;如果选择Shuffle Sort Merge Join策略的条件没有得到满足，并且连接的JoinType是InnerLike，流程则会选择Cartesian Product Join。这通常发生在没有定义连接条件的连接查询中。笛卡尔乘积连接的核心思想是计算两个连接数据集的乘积。因此可以想象，对于大型数据集，笛卡尔乘积连接的性能可能会非常糟糕，因此应该尽量避免这种类型的连接。&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.13154533844189017&quot; data-type=&quot;png&quot; data-w=&quot;783&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EGiamZiciaR95CO3gFE1j4CibiaPrhOnEDQmPhibUbZTEV0HvbDQqU6Ot5Zcw/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;h6&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Broadcast Nested Loop Join&lt;strong&gt;&lt;span&gt;的满足条件与运行原理&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;em&gt;&lt;span/&gt;&lt;/em&gt;&lt;/h6&gt;&lt;section&gt;当以上四种连接策略的条件都不满足时，流程会选择Broadcast Nested Loop Join策略。这个策略的连接过程涉及到StreamTable和BuildTable的嵌套循环。&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2864321608040201&quot; data-type=&quot;png&quot; data-w=&quot;597&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1EDdicq3pT5OwkKfWKFmC2XbhSHJjIBlghd1lPabEmPrHHPtrdFHibGfLg/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;这种策略的性能可能会变得非常糟糕，对该策略进行的优化是在数据足够小时进行广播。&lt;/section&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;如果连接为非等值&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;&lt;span&gt;连接&lt;/span&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;如果规划的连接不是等值连接，则选择流程将转向非等值连接的一边，&lt;span&gt;下图是选择流程已经进入了非等值连接判断的分支：&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8641114982578397&quot; data-type=&quot;png&quot; data-w=&quot;574&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/FckWnicBKdCWSzSFhKVvic1LqaCJ77ZF1E0y6rjArGCRYmUgukcKV7J0kcjFnU5rxSmst8Bn16Oaibq2lat6ibnsIg/640?wx_fmt=png&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;这里需要再次提醒一点：只有两种连接策略支持非等值连接，它们是&lt;span&gt;Cartesian Product Join和Broadcast Nested Loop Join。&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;在以上分支流程图中，如果在连接查询中指定了连接提示，请根据连接提示选择相应的连接策略。否则，如果数据集的一侧或两侧小到可以广播，则选择&lt;span&gt;Broadcast Nested Loop Join&lt;/span&gt;策略并广播较小的数据集。如果没有足够小的数据集可以广播，则检查JointType是否为InnerLike，如果是，则选择&lt;span&gt;Cartesian Product Join&lt;/span&gt;策略，否则就&lt;span&gt;选择Broadcast Nested Loop Join&lt;/span&gt;策略作为最终方案。&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;总结&lt;/strong&gt;&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;本文介绍Spark SQL所提供的五种Join策略和三种影响Join性能的因素，并且详细讲解了五种Join策略的连接原理以及在不同的影响因素下如何选择合适的Join策略，希望对大家有所帮助。&lt;/section&gt;&lt;section&gt;&lt;span&gt;- THE END -&lt;/span&gt;&lt;/section&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>557c52e99298fcd473d847434f1d19c6</guid>
<title>七夕了，织女这一年打了哪些装备见牛郎呢？</title>
<link>https://toutiao.io/k/rtepyvi</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;
            &lt;section data-role=&quot;outer&quot; label=&quot;Powered by 135editor.com onekey&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;238&quot; data-backw=&quot;404&quot; data-ratio=&quot;0.5888888888888889&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/6JBOwmHb1OsibmX4cjPmiaa95RHBGmf0MPFGiagdISYnRPGNNyb71WtElguYB0DDXeLJURV5QbgeLwkfPojy63plA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot; data-width=&quot;404px&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;七夕・学习&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;明月皎皎照我床，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;星汉西流夜未央。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;牵牛织女遥相望，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;尔独何辜限河梁。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;也许你还孤身一人，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;你学习的样子，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;却已是&quot;织女&quot;们心中最可爱的模样。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;也许你已有了你的&quot;织女&quot;,&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;你学习的样子，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;却已是她心中最信赖的依靠。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;今年的七夕又来了，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;织女仙姑&lt;/span&gt;&lt;span&gt;精心带了&lt;span&gt;限量版远古装备&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;送给爱学习的&quot;牛郎&quot;。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;236&quot; data-backw=&quot;404&quot; data-ratio=&quot;0.5838383838383838&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/6JBOwmHb1OsibmX4cjPmiaa95RHBGmf0MPyo7FMjw2CicDaw7OxJWVdvNerLrcupw5icbFZfyN1XKGCGEk2iagboIow/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;495&quot; data-width=&quot;424px&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;装备1 &lt;span&gt;王者腰带:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;相传为《四十二章经》中的羊皮所制&lt;/p&gt;&lt;p&gt;提升数倍王者魅力+气质,&lt;/p&gt;&lt;p&gt;让你成为街边最亮的仔。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;装备2 &lt;span&gt;昆仑蕉:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;相传长在昆仑山, 乃太阴之精叶,&lt;/p&gt;&lt;p&gt;&lt;span&gt;它的一片叶子曾做成芭蕉扇&lt;/span&gt;,  &lt;/p&gt;&lt;p&gt;让你写代码,改bug时,赶走焦虑与躁动。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;装备3 &lt;span&gt;全真秘籍:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;此秘籍出自老顽童周伯通，&lt;/p&gt;&lt;p&gt;向小龙女学完养蜂后，悟出养颜长寿的秘籍,&lt;/p&gt;&lt;p&gt;此书不用读，要玩坏它,方可容颜容常驻, 金枪不倒;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;装备4 &lt;span&gt;英雄盏:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;该盏来自远古神器,能具慧眼。&lt;/p&gt;&lt;p&gt;&lt;span&gt;相传&lt;/span&gt;曹操就用过它,&lt;span&gt;煮酒论英雄，独具慧眼,&lt;/span&gt;&lt;/p&gt;&lt;p&gt;用此英雄盏，让你慧眼识人。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;装备5 时光锥&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;此锥摆动起来能穿越时空, &lt;/p&gt;&lt;p&gt;相传项少龙靠它穿越时空成功生了项羽, &lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;上班太累,&lt;/span&gt;用它来时空穿梭。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;装备6 乾坤陀螺仪&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;又一上古神器, 可观天下，定乾坤。 &lt;/p&gt;&lt;p&gt;相传周文王通过它找到渭水钓鱼的姜子牙, &lt;/p&gt;&lt;p&gt;得到它的人，都快速定位发财致富的机会。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;七夕,织女仙姑鹊桥相会之际,&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;特意把带给牛郎的装备,&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;也带了一些给爱学习的&quot;牛郎&quot;们。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.5&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/6JBOwmHb1OsibmX4cjPmiaa95RHBGmf0MPfwRrbR8feUusBhRvkoZFwvLzOwJr34bnqicib7NPgKNzyse1ibD01WicgA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;仅限前15位&lt;/span&gt;&lt;span&gt;报名VIP课程的同学可尊享，&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;数量有限,送完即止。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;同时尊享七夕优惠&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;原价:4580套餐，优惠后&lt;span&gt;3980&lt;/span&gt;,&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;原价:5780套餐，优惠后&lt;span&gt;4980&lt;/span&gt;,&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;原价:6880套餐，优惠后&lt;span&gt;5880&lt;/span&gt;, &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;咨询报名:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;QQ: &lt;span&gt;3238 94 3271&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;微信:&lt;span&gt;bycw007&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;section data-tools=&quot;135编辑器&quot; data-id=&quot;104114&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;30%&quot;&gt;&lt;section data-width=&quot;100%&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;143&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;143&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/6JBOwmHb1OsibmX4cjPmiaa95RHBGmf0MPfSN0lJZ3Lqm7kFIY1uv3YbgEmckgB4URGJGDP5ZMt0aULAiaicly5w6Q/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;430&quot; data-width=&quot;100%&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-width=&quot;60%&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;&lt;strong&gt;七夕・学习&lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-brushtype=&quot;text&quot;&gt;尊享礼品与优惠&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-role=&quot;paragraph&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>d017438c5fe9e8283bc3240e4ae2244e</guid>
<title>超大体量项目，微前端落地方案，看完后悔来找我</title>
<link>https://toutiao.io/k/3zu7mjf</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;介绍&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;先介绍一下我们的项目背景，该项目是从18年开始启动的中间搁置了很久导致项目架构比较落后并且后期继续业务开发的时候也没有持续对架构进行优化迭代而是直接进行了业务开发，导致后面有很多的问题比如&lt;code&gt;启动慢&lt;/code&gt;、&lt;code&gt;代码耦合性强&lt;/code&gt;、&lt;code&gt;项目体量巨大&lt;/code&gt;导致开发效率降低之类的问题&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;问题描述&lt;/span&gt;&lt;/h3&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;目前项目体量达到了&lt;code&gt;400&lt;/code&gt;个路由&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;打包完的包大小为&lt;code&gt;60MB&lt;/code&gt;左右&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;首次启动时间为&lt;code&gt;3分钟&lt;/code&gt;左右&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;热更新时间为&lt;code&gt;10s&lt;/code&gt;左右&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;过程&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;经过一段时间对项目架构的优化迭代，包括对路由架构的划分重构，解决了一部分在开发中的问题，但是对于项目体量巨大导致&lt;code&gt;耦合性强&lt;/code&gt;和&lt;code&gt;启动较慢&lt;/code&gt;的问题还是没办法从根本上解决，所以我们准备采用&lt;code&gt;微前端&lt;/code&gt;的方案来对项目进行具体的拆分，最后达到的一个目的解决代码之间&lt;code&gt;耦合性&lt;/code&gt;的问题、解决项目&lt;code&gt;开发效率&lt;/code&gt;的问题、划分清楚每个子应用可以支持&lt;code&gt;单独部署&lt;/code&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;计划&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们项目核心是从场景+管控+支付生成的每一条线，之后的计划是按照这三部分划分子应用，所以采用的大的框架方案就是这样&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;先定好目标和计划然后一步步向着这个方向慢慢搞&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9777777777777777&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELThquXAe28IcGYwmJpQfZj5L9kOpV2rEW4Db80bnf37Vqjbfa65EibMEw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;720&quot;/&gt;&lt;figcaption&gt;lQDPJxaA_CIoPGDNBCDNBDiwwqe6X4-bMxUC1GUVWYB_AA_1080_1056.jpg_720x720g.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;核心逻辑&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;场景&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;管控&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;支付&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;场景是一个子应用我们有比如酒店、火车等场景&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;管控是一个子应用他可以接收来自场景的参数渲染不同的管控页面&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;收银台是一个子应用提供场景支付能力&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;方案&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们采用的是当下比较成熟的方案&lt;code&gt;qinakun&lt;/code&gt;，这个在社区已经活跃很久了并且有一定的稳定性，开发接入文档和可能遇到的一些异常的问题社区都有很好的回答，接下来看看我们的具体操作&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;梳理当前需要拆分子应用涉及到的问题和依赖&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;使用的组件依赖&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;样式上的依赖&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;适配方案的依赖&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;路由的依赖划分&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;去除当前应用之外的代码 --- 瘦身操作&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;创建一个新的架构用来承载子应用&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;采用react-scripts重新cra配置快速构建&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;搭建环境用到的依赖比如需要用到的&lt;code&gt;ts、less、vw/vh适配方案&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;根据主项目用到的依赖去构建子应用的&lt;code&gt;package&lt;/code&gt;尽量不要改动太大防止子项目启动失败&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;之后根据qiankun文档的提示去改造主应用和子应用&lt;/span&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { registerMicroApps, start } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;qiankun&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;registerMicroApps([&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&#x27;webapp-qkrechargecenter&#x27;&lt;/span&gt;, &lt;span&gt;//对应的子应用package的name&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;entry&lt;/span&gt;: &lt;span&gt;&#x27;//localhost:3000/&#x27;&lt;/span&gt;, &lt;span&gt;//子应用域名&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;container&lt;/span&gt;: &lt;span&gt;&#x27;#webapp-qkrechargecenter&#x27;&lt;/span&gt;, &lt;span&gt;//承载子应用的容器&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;activeRule&lt;/span&gt;: &lt;span&gt;(&lt;span&gt;location&lt;/span&gt;)=&amp;gt;&lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; location.pathname.startsWith(&lt;span&gt;&#x27;/nav/normal&#x27;&lt;/span&gt;) &lt;span&gt;//渲染子应用的路由匹配&lt;/span&gt;&lt;br/&gt;        },&lt;br/&gt;        &lt;span&gt;props&lt;/span&gt;: { &lt;span&gt;//传递到子应用的组件或者参数等&lt;/span&gt;&lt;br/&gt;            PrivatePayment,&lt;br/&gt;            Test1&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;])&lt;br/&gt;&lt;br/&gt;start()&lt;br/&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;在主应用中需要创建一个容器路由页面这个也就是我们的场景入口，这里面渲染的就是我们的子应用&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; React, { useEffect } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { start } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;qiankun&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; RechargeCenterPage: React.FC&amp;lt;any&amp;gt; = &lt;span&gt;&lt;span&gt;props&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    useEffect(&lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt;{&lt;br/&gt;            &lt;span&gt;console&lt;/span&gt;.log(&lt;span&gt;&#x27;卸载&#x27;&lt;/span&gt;)&lt;br/&gt;        }&lt;br/&gt;    }, [])&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;webapp-qkrechargecenter&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;default&lt;/span&gt; RechargeCenterPage&lt;br/&gt; &lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里只会有针对微前端之间的交互进行改造，其他的配置就看大家自己的一个具体方案了&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * 重写 react-scripts 默认配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt; &lt;br/&gt;&lt;span&gt;const&lt;/span&gt; appPackageJson = &lt;span&gt;require&lt;/span&gt;(&lt;span&gt;&#x27;../package.json&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;&lt;span&gt;module&lt;/span&gt;.exports = &lt;span&gt;(&lt;span&gt;config, env&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;br/&gt;  config.output.library = &lt;span&gt;`&lt;span&gt;${appPackageJson.name}&lt;/span&gt;-[name]`&lt;/span&gt;&lt;br/&gt;  config.output.libraryTarget = &lt;span&gt;&#x27;umd&#x27;&lt;/span&gt;&lt;br/&gt;  config.output.jsonpFunction = &lt;span&gt;`webpackJsonp_&lt;span&gt;${appPackageJson.name}&lt;/span&gt;`&lt;/span&gt;,&lt;br/&gt;  &lt;br/&gt;  &lt;span&gt;return&lt;/span&gt; config;&lt;br/&gt;};&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; ReactDOM &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&quot;react-dom&quot;&lt;/span&gt;;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; * &lt;span&gt;as&lt;/span&gt; React &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&quot;react&quot;&lt;/span&gt;;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; RouteComp &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&quot;./routes/routerList&quot;&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;render&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; { container } = props;&lt;br/&gt;  ReactDOM.render(&lt;span&gt;&amp;lt;&lt;span&gt;RouteComp&lt;/span&gt; {&lt;span&gt;...props&lt;/span&gt;}/&amp;gt;&lt;/span&gt;, container ? container.querySelector(&lt;span&gt;&#x27;#root&#x27;&lt;/span&gt;) : &lt;span&gt;document&lt;/span&gt;.querySelector(&lt;span&gt;&#x27;#root&#x27;&lt;/span&gt;));&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;if&lt;/span&gt; (!&lt;span&gt;window&lt;/span&gt;.__POWERED_BY_QIANKUN__) {&lt;br/&gt;  render({});&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * bootstrap 只会在微应用初始化的时候调用一次，下次微应用重新进入时会直接调用 mount 钩子，不会再重复触发 bootstrap。&lt;br/&gt; * 通常我们可以在这里做一些全局变量的初始化，比如不会在 unmount 阶段被销毁的应用级别的缓存等。&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;bootstrap&lt;/span&gt;() &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(&lt;span&gt;&quot;react app bootstraped&quot;&lt;/span&gt;);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * 应用每次进入都会调用 mount 方法，通常我们在这里触发应用的渲染方法&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;mount&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  render(props);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * 应用每次 切出/卸载 会调用的方法，通常在这里我们会卸载微应用的应用实例&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;unmount&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  ReactDOM.unmountComponentAtNode(&lt;br/&gt;    props.container&lt;br/&gt;      ? props.container.querySelector(&lt;span&gt;&quot;#root&quot;&lt;/span&gt;)&lt;br/&gt;      : &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&quot;root&quot;&lt;/span&gt;)&lt;br/&gt;  );&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;/**&lt;br/&gt; * 可选生命周期钩子，仅使用 loadMicroApp 方式加载微应用时生效&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;async&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;update&lt;/span&gt;(&lt;span&gt;props&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(&lt;span&gt;&quot;update props&quot;&lt;/span&gt;, props);&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里我是采用 react-router-config 直接渲染的路由如果大家有其他特殊配置可以自行配一下&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;import&lt;/span&gt; React &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { renderRoutes } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react-router-config&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; { BrowserRouter &lt;span&gt;as&lt;/span&gt; Router } &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;react-router-dom&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; rechange &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;app/index/index&#x27;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt; paymentRechargePrivateView &lt;span&gt;from&lt;/span&gt; &lt;span&gt;&#x27;app/paymentRechargePrivateView&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; NoFound = &lt;span&gt;(&lt;span&gt;props&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&lt;span&gt;&amp;lt;&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;        NoFound&lt;br/&gt;    &lt;span&gt;&amp;lt;/&lt;span&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; routerList = [&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/recharge/center&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: rechange,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&#x27;充值中心&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/paymentRechargePrivateView&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: paymentRechargePrivateView,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&quot;充值中心个人消费收银台&quot;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: NoFound,&lt;br/&gt;    }&lt;br/&gt;]&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// 重点是basename需要匹配上主应用activeRule对应的路径&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; RouteComp = &lt;span&gt;(&lt;span&gt;props&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &lt;span&gt;&lt;span&gt;&amp;lt;&lt;span&gt;Router&lt;/span&gt; &lt;span&gt;basename&lt;/span&gt;=&lt;span&gt;{window.__POWERED_BY_QIANKUN__&lt;/span&gt; ? &#x27;/&lt;span&gt;nav&lt;/span&gt;/&lt;span&gt;normal&lt;/span&gt;&#x27; &lt;span&gt;:&lt;/span&gt; &#x27;/&#x27;}&amp;gt;&lt;/span&gt;&lt;br/&gt;    {renderRoutes(routerList, props)}&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;Router&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;export&lt;/span&gt; &lt;span&gt;default&lt;/span&gt; RouteComp&lt;br/&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;子应用配置跨域处理&lt;/span&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt; * config-overrides.js&lt;br/&gt; * 重写 react-scripts 默认配置&lt;br/&gt; */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; configDev = &lt;span&gt;require&lt;/span&gt;(&lt;span&gt;&quot;./config/webpack.config.dev&quot;&lt;/span&gt;);&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; configProd = &lt;span&gt;require&lt;/span&gt;(&lt;span&gt;&quot;./config/webpack.config.prod&quot;&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;&lt;span&gt;module&lt;/span&gt;.exports = {&lt;br/&gt;  &lt;span&gt;webpack&lt;/span&gt;: &lt;span&gt;&lt;span&gt;function&lt;/span&gt; &lt;span&gt;override&lt;/span&gt;(&lt;span&gt;config, env&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;    &lt;span&gt;if&lt;/span&gt; (env == &lt;span&gt;&quot;development&quot;&lt;/span&gt;) {&lt;br/&gt;      &lt;span&gt;return&lt;/span&gt; configDev(config, env)&lt;br/&gt;    } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;      &lt;span&gt;return&lt;/span&gt; configProd(config, env)&lt;br/&gt;    }&lt;br/&gt;  },&lt;br/&gt;  &lt;span&gt;devServer&lt;/span&gt;: &lt;span&gt;(&lt;span&gt;configFunction&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&lt;span&gt;function&lt;/span&gt; (&lt;span&gt;proxy, allowedHost&lt;/span&gt;) &lt;/span&gt;{&lt;br/&gt;      &lt;span&gt;const&lt;/span&gt; config = configFunction(proxy, allowedHost);&lt;br/&gt;      config.open = &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;      config.hot = &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;      config.headers = {&lt;br/&gt;        &lt;span&gt;&#x27;Access-Control-Allow-Origin&#x27;&lt;/span&gt;: &lt;span&gt;&#x27;*&#x27;&lt;/span&gt;, &lt;span&gt;//设置允许跨域&lt;/span&gt;&lt;br/&gt;      };&lt;br/&gt;      &lt;span&gt;return&lt;/span&gt; config;&lt;br/&gt;    };&lt;br/&gt;  },&lt;br/&gt;};&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;整体的思路都是按照这种方式去做拆分，中间遇到了很多的问题我们在下面分享一下，如果大家也有这种比较历史悠久的项目拆分那大概率也会遇到&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;实现目标过程中的遇到的比较&lt;code&gt;麻烦&lt;/code&gt;的问题&lt;/span&gt;&lt;/h2&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4406392694063927&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELTrf5XsrY0NnWickfODiaAaRPdxiavr91SxRVdMd66CiaIE610RjtfPDjy2g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;876&quot;/&gt;&lt;figcaption&gt;image.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;拆分完成的子应用内部路由跳转一直找不到路径或者一直向主应用路由去跳&lt;/span&gt;&lt;/h3&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;出现问题的原因是我们之前老的路由name有一些自己的前缀规则&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;老的路由规则新的路由规则匹配的时候发生了异常，导致进行跳转的时候脱离了当前子应用的容器出现了跳转白屏&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;解决办法是针对子应用里面跳转的路径需要在主应用里面也配置一个对应的路由指向的是同一个容器页面，相当于重新加载了子应用容器这样不会在跳转的时候产生页面跳转错误导致白屏问题&lt;/p&gt;&lt;/blockquote&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;br/&gt;&lt;span&gt;//主应用&lt;/span&gt;&lt;br/&gt;&lt;span&gt;//引用同一个页面RechargeCenter&lt;/span&gt;&lt;br/&gt;&amp;lt;Route path=&lt;span&gt;&quot;/nav/normal/views/recharge/center&quot;&lt;/span&gt; component={RechargeCenter} /&amp;gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;Route&lt;/span&gt; &lt;span&gt;path&lt;/span&gt;=&lt;span&gt;&quot;/nav/normal/views/paymentRechargePrivateView&quot;&lt;/span&gt; &lt;span&gt;component&lt;/span&gt;=&lt;span&gt;{RechargeCenter}&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//子应用&lt;/span&gt;&lt;br/&gt;&lt;span&gt;const&lt;/span&gt; routerList = [&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/recharge/center&#x27;&lt;/span&gt;, &lt;span&gt;//该路径在主应用中注册&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: rechange,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&#x27;充值中心&#x27;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;path&lt;/span&gt;: &lt;span&gt;&#x27;/views/paymentRechargePrivateView&#x27;&lt;/span&gt;, &lt;span&gt;//该路径在主应用中注册&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: paymentRechargePrivateView,&lt;br/&gt;        &lt;span&gt;name&lt;/span&gt;: &lt;span&gt;&quot;充值中心个人消费收银台&quot;&lt;/span&gt;,&lt;br/&gt;        &lt;span&gt;exact&lt;/span&gt;: &lt;span&gt;true&lt;/span&gt;,&lt;br/&gt;    },&lt;br/&gt;    {&lt;br/&gt;        &lt;span&gt;component&lt;/span&gt;: NoFound,&lt;br/&gt;    }&lt;br/&gt;]&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;子应用使用主应用传递下来的函数组件使用异常&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;异常图🔽&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.30017152658662094&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELTk1BPbxl6QqDphMfb5cYz0qxSDtREN6s27M5Qmy9JVbibWupSiaJAr42g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;2332&quot;/&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;注意是只有函数组件传递到子应用中使用才有异常提示，类组件是没有的，原因是当前使用的地方和传递下来的组件不是同一个实例，hooks组件需要在同一个实例下&lt;/p&gt;&lt;/blockquote&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;pre&gt;&lt;code&gt;借助`webpack`的`externals`，去使用同一份react，同时改造子应用和主应用&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;//主应用&lt;/span&gt;&lt;br/&gt;&lt;span&gt;externals&lt;/span&gt;:{&lt;br/&gt;    &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;React&#x27;&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&#x27;react-dom&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;ReactDOM&#x27;&lt;/span&gt;,&lt;br/&gt;},&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;//子应用&lt;/span&gt;&lt;br/&gt;config.externals = {&lt;br/&gt;    &lt;span&gt;&#x27;react&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;React&#x27;&lt;/span&gt;,&lt;br/&gt;    &lt;span&gt;&#x27;react-dom&#x27;&lt;/span&gt;:&lt;span&gt;&#x27;ReactDOM&#x27;&lt;/span&gt;,&lt;br/&gt;}&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;2&quot; data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;pre&gt;&lt;code&gt;在主应用的入口文件引入react的cdn链接注意尽量和本地用的是同一个版本，防止兼容问题&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;  &amp;lt;script src=&lt;span&gt;&quot;https://unpkg.com/react@16.13.1/umd/react.development.js&quot;&lt;/span&gt;&amp;gt;&amp;lt;&lt;span&gt;/script&amp;gt;&lt;br/&gt;  &amp;lt;script src=&quot;https://unpkg.com/&lt;/span&gt;react-dom@&lt;span&gt;16.13.1&lt;/span&gt;/umd/react-dom.development.js&lt;span&gt;&quot;&amp;gt;&amp;lt;/script&amp;gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;结束&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上是我们项目拆分的整体思路和具体落实方案第一季，后面肯定还会遇到更多的问题，所以不出意外还有第二季和第三季..... 谁家还有特别大的项目可以按照这种思路参考一下，按照业务线或者是比较独立的模块去单独拆子应用&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;如果大家有更好的方案可以在评论区讨论一下~&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7597222222222222&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz/H8M5QJDxMHrmr4m8kicMaBGVMefLAZELTv5eJmRlzQibepS97bXY5Rgl8Oibtul1b1awUicibybPK4WR9OVl07voQFg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;720&quot;/&gt;&lt;figcaption&gt;lQDPJxaA_BWj4-nNA1bNBGWwP4d5S3bIu2cC1GUUMcB_AA_1125_854.jpg_720x720g.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;关于本文&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1 data-v-a4949a24=&quot;&quot;&gt;&lt;span&gt;作者：零狐冲&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;https://juejin.cn/post/7121244973558661150&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p data-darkmode-color-16057140139831=&quot;rgb(162, 162, 162)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(68, 68, 68)&quot; data-style=&quot;padding-top: 7px; padding-bottom: 7px; color: rgb(68, 68, 68); font-size: 14px; line-height: 1.8; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, &amp;quot;Lucida Grande&amp;quot;, Arial, &amp;quot;Hiragino Sans GB&amp;quot;, 微软雅黑, &amp;quot;WenQuanYi Micro Hei&amp;quot;, STHeiti, SimSun, sans-serif; text-align: center;&quot;&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(63, 63, 63)&quot; data-style=&quot;color: rgb(63, 63, 63); font-family: monospace; font-size: 20px; letter-spacing: 0.544px; white-space: pre-wrap; widows: 1; caret-color: rgb(51, 51, 51);&quot;&gt;The End&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;如果你觉得这篇内容对你挺有启发，我想请你帮我三个小忙：&lt;/span&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(0,0,0)&quot; data-style=&quot;padding-right: 10px; padding-left: 10px; font-size: 16px; color: black; line-height: 1.6; letter-spacing: 0px; word-break: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif;&quot;&gt;&lt;section&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;1、点个 &lt;span data-darkmode-color-16057140139831=&quot;rgb(71, 193, 168)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(71, 193, 168)&quot;&gt;「在看」&lt;/span&gt;，让更多的人也能看到这篇内容&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;2、关注官网 &lt;span data-darkmode-color-16057140139831=&quot;rgb(71, 193, 168)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(71, 193, 168)&quot;&gt;https://muyiy.cn&lt;/span&gt;，让我们成为长期关系&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;3、关注公众号「高级前端进阶」，公众号后台回复 &lt;span data-darkmode-color-16057140139831=&quot;rgb(71, 193, 168)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(71, 193, 168)&quot;&gt;「加群」&lt;/span&gt; ，加入我们一起学习并送你精心整理的高级前端面试题。&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile data-index=&quot;0&quot; data-id=&quot;MzA4Nzg0MDM5Nw==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/sz_mmbiz_png/H8M5QJDxMHpg1ClH18gOQIicISIoSybyDNK203zFMpSM7jHdovb4elgdqNoy6Bylk7XicC6Rpj5QrCv3FkOpR6tw/0?wx_fmt=png&amp;amp;wx_head=1&quot; data-nickname=&quot;高级前端进阶&quot; data-alias=&quot;FrontendGaoji&quot; data-signature=&quot;网易 &amp;amp; 蚂蚁前端，专注前端进阶领域，已帮助无数前端跳槽涨薪。每日一题「Daily-Interview-Question」 Github 收获近 25000 颗小星星，各公司面试官都在使用。接下来带你走进高级前端的世界，在进阶的路上，共勉！&quot; data-origin_num=&quot;48&quot; data-is_biz_ban=&quot;0&quot; data-isban=&quot;0&quot; class=&quot;js_wx_tap_highlight&quot; data-from=&quot;2&quot;/&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;a class=&quot;weapp_text_link&quot; data-miniprogram-appid=&quot;wx27c980b913cbfb08&quot; data-miniprogram-path=&quot;pages/index/index?_um_campaign=5ec14536978eea0825f4eb6f&amp;amp;_um_channel=5ec14536978eea0825f4eb70&quot; data-miniprogram-nickname=&quot;高级前端面试&quot; data-miniprogram-type=&quot;text&quot; data-miniprogram-servicetype=&quot;0&quot; data-darkmode-bgcolor-15950741730771=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-15950741730771=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-15950741730771=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15950741730771=&quot;rgb(0,0,0)&quot; data-darkmode-color-15963792901125=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15963792901125=&quot;rgb(0,0,0)&quot; data-darkmode-bgcolor-16018219266315=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16018219266315=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16018219266315=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16018219266315=&quot;rgb(58, 58, 58)&quot; data-darkmode-bgcolor-16020008769986=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16020008769986=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16020008769986=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16020008769986=&quot;rgb(58, 58, 58)&quot; data-darkmode-color-16021670869911=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(58, 58, 58)&quot; data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16030305897056=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030305897056=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030305897056=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(58, 58, 58)&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(58, 58, 58)&quot; wah-hotarea=&quot;click&quot; href=&quot;&quot;&gt;》》面试官都在用的题库，快来看看《&lt;/a&gt;《&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;section data-darkmode-color-16030305897056=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(63, 63, 63)&quot; data-style=&quot;color: rgb(63, 63, 63); font-size: 16px; font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(63, 63, 63)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-right: 10px; padding-left: 10px; line-height: 1.6; word-break: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; font-size: 15px; letter-spacing: 0.05em; color: rgb(89, 89, 89);&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;pre data-darkmode-bgcolor-15987645674728=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-15987645674728=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-15987645674728=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15987645674728=&quot;rgb(0, 0, 0)&quot; data-style=&quot;color: rgb(0, 0, 0); text-align: left; letter-spacing: 0.544px; word-spacing: 2px; font-size: 20px; font-weight: 700; background-color: rgb(255, 255, 255);&quot; data-original-code=&quot;&amp;lt;br&amp;gt;扩展阅读1、一篇文章上手Vue3中新增的API&amp;lt;br&amp;gt;2、Vue源码解析——异步组件是如何使用的&amp;lt;br&amp;gt;3、写好JavaScript条件语句的5条守则&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;The End如果你觉得这篇内容对你挺有启发，我想请你帮我三个小忙：点个「在看」，让更多的人也能看到这篇内容&amp;lt;br&amp;gt;关注官网 https://muyiy.cn，让我们成为长期关系&amp;lt;br&amp;gt;关注公众号「高级前端进阶」，公众号后台回复「加群」 加入我们一起学习并送你精心整理的高级前端面试题。&amp;lt;br&amp;gt;》》面试官都在用的题库，快来看看《《                        高级前端进阶 发起了一个读者讨论         写留言                                        &amp;lt;br&amp;gt;“在看”吗？在看就点一下吧&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot; data-snippet-id=&quot;ext.dfdc660f8db84bdd3e9d3d519ceaec46&quot; data-snippet-saved=&quot;false&quot; data-codota-status=&quot;done&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-darkmode-bgcolor-15987645674728=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-15987645674728=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-15987645674728=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15987645674728=&quot;rgb(62, 62, 62)&quot; data-style=&quot;letter-spacing: 0px; white-space: normal; font-size: 16px; color: rgb(62, 62, 62); font-family: &#x27;Helvetica Neue&#x27;, Helvetica, &#x27;Hiragino Sans GB&#x27;, &#x27;Microsoft YaHei&#x27;, Arial, sans-serif; widows: 1; line-height: 1.6;&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-bgcolor-15987645674728=&quot;rgba(112, 0, 0, 0.018750000000000003)&quot; data-darkmode-original-bgcolor-15987645674728=&quot;rgba(20, 0, 0, 0.018750000000000003)&quot; data-darkmode-color-15987645674728=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-15987645674728=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding: 10px; word-break: break-word; line-height: 1.75; color: rgb(89, 89, 89); font-family: Optima-Regular, Optima, PingFangTC-Light, PingFangSC-light, PingFangTC-light; letter-spacing: 2px; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;pre data-original-code=&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;The End如果你觉得这篇内容对你挺有启发，我想请你帮我三个小忙：点个「在看」，让更多的人也能看到这篇内容&amp;lt;br&amp;gt;关注官网 https://muyiy.cn，让我们成为长期关系&amp;lt;br&amp;gt;关注公众号「高级前端进阶」，公众号后台回复「加群」 加入我们一起学习并送你精心整理的高级前端面试题。&amp;lt;br&amp;gt;》》面试官都在用的题库，快来看看《《                        高级前端进阶 发起了一个读者讨论         参与讨论                                        &amp;lt;br&amp;gt;“在看”吗？在看就点一下吧&amp;lt;br&amp;gt;&quot; data-snippet-id=&quot;ext.89a96a6ef2d46757b2677de8206703d5&quot; data-snippet-saved=&quot;false&quot; data-codota-status=&quot;done&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-bgcolor-16018219266315=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16018219266315=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16018219266315=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16018219266315=&quot;rgb(0,0,0)&quot; data-style=&quot;padding-right: 10px; padding-left: 10px; letter-spacing: 0px; background-color: rgb(255, 255, 255); line-height: 1.6; word-break: break-word;&quot; data-darkmode-bgcolor-16020008769986=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16020008769986=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16020008769986=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16020008769986=&quot;rgb(0,0,0)&quot; data-darkmode-color-16021670869911=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(0,0,0)&quot; data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tools=&quot;新媒体排版&quot; data-id=&quot;13777&quot; data-style-type=&quot;关注&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-darkmode-color-16030305897056=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(0, 0, 0)&quot; data-style=&quot;font-family: &amp;quot;PingFang SC&amp;quot;, 微软雅黑, mp-quote, -apple-system-font, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 14px; color: rgb(0, 0, 0); letter-spacing: 1.56px; font-weight: 600; line-height: 20px;&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(0, 0, 0)&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;span&gt;最后不要忘了点赞呦！&lt;span&gt;&lt;img data-ratio=&quot;1.0076923076923077&quot; data-type=&quot;gif&quot; data-w=&quot;260&quot; data-fileid=&quot;100022933&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_gif/H8M5QJDxMHo0BmF9r9Z5jmnjiaRjia63KdItrdfQPpQLTn685ib4pQK1j8wNibqXIQb5m7oLf2v7pke7SMTzCFVs3w/640?wx_fmt=gif&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;span&gt;祝 2022 年暴富！暴美！暴瘦！&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>