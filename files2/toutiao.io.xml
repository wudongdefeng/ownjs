<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>9a9b3cb7a7dfb532a3fec121cf6e6bd7</guid>
<title>ä¸€æ–‡ææ‡‚å‰ç«¯å…¼å®¹é—®é¢˜</title>
<link>https://toutiao.io/k/plsx3t3</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5274151436031331&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8MK8X2XQgu4C6KSk9OcJMIt6vbm4cQ0mzricSSj51xbyHo5ULFolCf03nylYpkxc0TD1kzDgkkrn0ZTm8mNtgWA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1915&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ğŸ“Œ&lt;/span&gt;&lt;p&gt;å¦‚æœä½ å–œæ¬¢æˆ‘å†™çš„æ–‡ç« ï¼Œå¯ä»¥æŠŠæˆ‘çš„å…¬ä¼—å·è®¾ä¸º&lt;strong&gt;æ˜Ÿæ ‡ ğŸŒŸ&lt;/strong&gt;ï¼Œè¿™æ ·æ¯æ¬¡æœ‰æ›´æ–°å°±å¯ä»¥åŠæ—¶æ¨é€ç»™ä½ å•¦&lt;/p&gt;&lt;/blockquote&gt;&lt;hr data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;/&gt;&lt;br data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;/&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯¹äºå¤§éƒ¨åˆ†å¼€å‘è€…æ¥è¯´ï¼Œç‰ˆæœ¬å…¼å®¹æ˜¯ä¸€ä»¶å­˜åœ¨æ„Ÿå¾ˆä½çš„äº‹æƒ…ï¼Œå› ä¸ºå®ƒåœ¨ç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯ä¸€è¡Œé…ç½®ï¼Œåœ¨ä¸€äº›å‰ç«¯å·¥å…·é“¾ï¼ˆä¾‹å¦‚ Babelã€CoreJSï¼ŒAutoprefixer ç­‰å·¥å…·ï¼‰çš„å¸®åŠ©ä¸‹é€‚é…åˆ°ç›®æ ‡æµè§ˆå™¨ï¼Œåªä¼šåœ¨ä¸€äº›å¤§çš„ break change äº‹ä»¶ï¼ˆä¾‹å¦‚ Vue3 å¿…é¡»åœ¨æ”¯æŒ Proxy çš„ç°ä»£æµè§ˆå™¨ä¸‹æ‰èƒ½è¿è¡Œï¼‰ä¸‹æ‰ä¼šå…³æ³¨è¿™ä»¶ä¸èµ·çœ¼çš„äº‹æƒ…ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½†å½“ä½ ç¨å¾®ç ”ç©¶ä¸€ä¸‹çš„æ—¶å€™ï¼Œæ‰ä¼šå‘ç°è¿™å—å„¿å†…å®¹çŸ¥è¯†éå¸¸æ‚ï¼Œå› ä¸ºç‰ˆæœ¬å…¼å®¹çš„ç›¸å…³çŸ¥è¯†æ²¡æœ‰é‚£ä¹ˆå¤šå†…åœ¨é€»è¾‘æ€§ï¼Œå¾ˆå¤šç»†ç¢çš„çŸ¥è¯†ç‚¹æ•£è½åœ¨åœ¨å„ä¸ªå•†ä¸šå…¬å¸çš„åšå¼ˆå’Œç‰ˆæœ¬å˜æ›´ä¸­ã€‚å‰æ®µæ—¶é—´å› å·¥ä½œéœ€è¦å¯¹éƒ¨åˆ†è¯­è¨€/æµè§ˆå™¨ç‰¹æ€§é‡ç‚¹å…³æ³¨äº†ä¸€ä¸‹ï¼Œä»¥æ­¤æ–‡åšä¸€ä¸‹è®°å½•ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ¬æ–‡ä¸»è¦è®°å½•äº†ç§»åŠ¨ç«¯çš„ç‰ˆæœ¬é€‚é…é—®é¢˜ï¼Œæœªå¯¹æ¡Œé¢ç«¯åšæ›´å¤šçš„ç ”ç©¶ï¼Œåé¢æœ‰å¯èƒ½è¡¥å……ç›¸å…³å†…å®¹ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1.iOS &amp;amp; Safari&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;iOS å’Œ Android è™½ç„¶éƒ½æ˜¯ä¸€å¹´æ›´æ–°ä¸€ä¸ªå¤§ç‰ˆæœ¬ï¼Œä½†å—ç›Šäºç”Ÿæ€çš„å°é—­æ€§ï¼ŒiOS çš„æ›´æ–°ç‡&lt;strong&gt;æé«˜&lt;/strong&gt;ï¼ŒåŸºæœ¬ä¸Šæœ€è¿‘çš„ä¸¤ä¸ªç‰ˆæœ¬å°±èƒ½è¦†ç›– 95% ä»¥ä¸Šçš„äººç¾¤ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¾‹å¦‚ &lt;span&gt;Apple å®˜æ–¹ç»Ÿè®¡&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;ï¼Œæˆªæ­¢åˆ° 2022-05-31ï¼ŒApple å››å¹´å†…æ¨å‡ºçš„æ–°æœºå‹ä¸­ï¼Œ&lt;code&gt;iOS 15&lt;/code&gt; å·²ç»æœ‰ 89% çš„è£…æœºç‡ï¼Œ&lt;code&gt;iOS 14&lt;/code&gt; ä¹Ÿæœ‰ 10% çš„è£…æœºç‡ï¼›è€Œåœ¨æ‰€æœ‰å†å²æœºå‹é‡Œï¼Œ&lt;code&gt;iOS 15&lt;/code&gt; å’Œ &lt;code&gt;iOS 14&lt;/code&gt; åŠ èµ·æ¥ä¹Ÿæœ‰ 96% çš„è£…æœºç‡ï¼Œéš”å£ Android éƒ½ç¾¡æ…•å“­äº†ï¼š&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.419871794871795&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8MK8X2XQgu4C6KSk9OcJMIt6vbm4cQ0mCLUsFIvu4XFeYszICdCVruZwCK36aI69Za3uhJPC6BG3OONS6ITf2A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;624&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºä»€ä¹ˆå¦‚æ­¤å…³æ³¨ iOS çš„ç‰ˆæœ¬å·ï¼Ÿ&lt;strong&gt;å› ä¸º iOS ç‰ˆæœ¬åŸºæœ¬ä¸Šå’Œ Safari ç‰ˆæœ¬ä¸€ä¸€å¯¹åº”çš„&lt;/strong&gt;ï¼Œä¾‹å¦‚ &lt;code&gt;iOS 15.6&lt;/code&gt; ä¸Šå®‰è£…ç€ &lt;code&gt;Safari 15.6&lt;/code&gt;ï¼Œ&lt;code&gt;iOS 14.5&lt;/code&gt; ä¸Šå®‰è£…ç€ &lt;code&gt;Safari 14.1&lt;/code&gt;ï¼Œå…·ä½“çš„æ˜ å°„å…³ç³»å¯è§ &lt;span&gt;MDN çš„æ˜ å°„è¡¨&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;ï¼Œæˆ–è€…å¯ä»¥çœ‹ &lt;span&gt;core-js: SafariToIOS&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬åŸºæœ¬ä¸Šåªè¦æ¯”å¯¹ iOS ç‰ˆæœ¬å·å³å¯ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæœ‰ä¸€å®š C ç«¯å¼€å‘ç»éªŒçš„å¼€å‘è€…å¯èƒ½è¿˜ä¼šå…³æ³¨ iOS ä¸Šè¿è¡Œçš„æ˜¯ UIWebView è¿˜æ˜¯ WKWebViewï¼Œåœ¨ 2022 å¹´è¿™ä¸ªæ—¶é—´ç‚¹å…¶å®å·²ç»ä¸éœ€è¦å…³æ³¨äº†ï¼Œå› ä¸º Apple Store å·²ç»å‘è¿‡&lt;span&gt;å…¬å‘Š&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;ï¼Œ2020 12 æœˆä¹‹åå·²ç»ç¦æ­¢å« UIWebView çš„ APP ä¸Šæ¶äº†ï¼Œæ‰€ä»¥ iOS å¹³å°åªæœ‰ WKWebView è¿™ä¸€ä¸ª WebView äº†ï¼Œè€Œä¸”å®ƒ&lt;span&gt;å…¼å®¹æ€§ä¹Ÿä¸é”™&lt;/span&gt;&lt;sup&gt;[5]&lt;/sup&gt;ï¼Œæœ€ä½æ”¯æŒåˆ° &lt;code&gt;iOS 8&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2.Android &amp;amp; Chrome&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯´å®Œ iOS æˆ‘ä»¬å†è°ˆè°ˆ Androidã€‚å› ä¸ºä¸¤ä¸ªæ“ä½œç³»ç»Ÿçš„å‘å±•ç­–ç•¥ä¸åŒï¼Œå†åŠ ä¸Šå›½å†…å„å¤§å‚å•†çš„é­”æ”¹ï¼ŒAndroid ä»ä¸€å¼€å§‹å°±æ·±é™·ç¢ç‰‡åŒ–çš„æ·±æ¸Šï¼Œæœ‰ Android å¼€å‘ç»å†çš„åŒå­¦ä¸€å®šéƒ½æ·±æœ‰æ„Ÿè§¦ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Android ç³»ç»Ÿæœ¬èº«ç¢ç‰‡åŒ–ï¼ŒAndroid ç³»ç»Ÿè‡ªå¸¦çš„æµè§ˆå™¨&lt;strong&gt;æ›´ç¢ç‰‡åŒ–&lt;/strong&gt;ã€‚åœ¨ Android æ—©æœŸï¼ŒAndroid ç‰ˆæœ¬å’Œ Chrome æµè§ˆå™¨ç‰ˆæœ¬æ˜¯æœ‰ç»‘å®šå…³ç³»çš„ï¼Œé‚£è¿™ä¸ªæ—©æœŸæ˜¯æœ‰å¤šæ—©ï¼Ÿé‚£å°±æ˜¯ &lt;code&gt;Android 4&lt;/code&gt;ï¼Œ2014 å¹´å‘å¸ƒï¼Œç»‘å®šäº† Chrome æ—©æœŸå‡ ä¸ªç‰ˆæœ¬ï¼Œå› ä¸ºæ•°æ®ä¸å¤šï¼Œæˆ‘è¿™é‡Œå°±ç›´æ¥åˆ—å‡ºæ¥ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;&lt;span&gt;//Â https://github.com/zloirock/core-js/blob/master/packages/core-js-compat/src/mapping.mjs&lt;/span&gt;&lt;br/&gt;&lt;span&gt;ChromeToAndroid&lt;/span&gt;:Â [&lt;br/&gt;Â Â [&lt;span&gt;9&lt;/span&gt;,Â &lt;span&gt;&#x27;3.0&#x27;&lt;/span&gt;],&lt;br/&gt;Â Â [&lt;span&gt;12&lt;/span&gt;,Â &lt;span&gt;&#x27;4.0&#x27;&lt;/span&gt;],&lt;br/&gt;Â Â [&lt;span&gt;30&lt;/span&gt;,Â &lt;span&gt;&#x27;4.4&#x27;&lt;/span&gt;],&lt;br/&gt;Â Â [&lt;span&gt;33&lt;/span&gt;,Â &lt;span&gt;&#x27;4.4.3&#x27;&lt;/span&gt;],&lt;br/&gt;]&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;äº‹æƒ…çš„è½¬æœºå‡ºç°åœ¨ &lt;code&gt;Android 5&lt;/code&gt;ï¼Œ&lt;span&gt;è¿™ä¸ªç‰ˆæœ¬&lt;/span&gt;&lt;sup&gt;[6]&lt;/sup&gt;é‡Œ WebView è¢«ç§»æ¤ä¸ºä¸€ä¸ªç‹¬ç«‹çš„ APKï¼Œå¯ä»¥ç‹¬ç«‹æ›´æ–°ï¼Œä¸å†å’Œ Android ç³»ç»Ÿæ·±åº¦ç»‘å®šã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Google çš„æƒ³æ³•åˆè¡·æ˜¯å¥½çš„ï¼Œå€ŸåŠ©äº Google å•†åº—ï¼Œè§£è€¦æ›´åˆ©äºæµè§ˆå™¨çš„ç‰ˆæœ¬è¿­ä»£ã€‚ä½†æ˜¯åœ¨å›½å†…å¤šå‚å•†é­”æ”¹å’Œä¸€äº›ç½‘ç»œé—®é¢˜ä¸Šï¼Œææœ‰å¯èƒ½å‘ç”Ÿè¿™æ ·çš„äº‹æƒ…ï¼šå¯¹äºä¸€å° &lt;code&gt;Android 5&lt;/code&gt; æ‰‹æœºï¼Œç†è®ºä¸Šç”¨æˆ·å¯ä»¥å®‰è£… &lt;code&gt;Chrome 36&lt;/code&gt; - &lt;code&gt;Chrome 95&lt;/code&gt; &lt;strong&gt;ä»»æ„ä¸€ä¸ªç‰ˆæœ¬&lt;/strong&gt;ï¼&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰€ä»¥å’Œ iOS å¯¹æ¯”èµ·æ¥ï¼ŒAndroid å› ä¸ºä»–çš„å¼€æ”¾æ€§å¸¦æ¥ä¸¥é‡çš„ç¢ç‰‡åŒ–é—®é¢˜ï¼šAndroid ç‰ˆæœ¬å¤šæ ·ï¼ŒChrome ç‰ˆæœ¬å¤šæ ·ï¼Œè¿˜æœ‰å„ç§é­”æ”¹å†…æ ¸ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´é€‚é…èµ·æ¥çœŸçš„è‹¦ä¸å ªè¨€ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;3.Web Browser&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;äº†è§£å®Œæ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬å†å²ï¼Œæˆ‘ä»¬å†çœ‹çœ‹æµè§ˆå™¨ä¸Šæœ€å…³é”®çš„ JavaScript è¯­æ³•å…¼å®¹åº¦ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;JavaScript&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€è¿‘åå¹´å†…ï¼ŒJS è¿™é—¨è¯­è¨€çš„çš„æœ€å¤§å˜é©å°±æ˜¯ ES6ï¼ˆES2015ï¼‰çš„å‘å¸ƒäº†ï¼Œå¸¦æ¥äº†éå¸¸å¤šçš„æ–°ç‰¹æ€§ã€‚ä¸‹é¢æˆ‘æäº†ä¸€ä¸ªè¡¨æ ¼ï¼Œåˆ—å‡ºå‡ ä¸ªå¤§å®¶å¸¸ç”¨çš„ JS è¯­æ³•æ˜¯ä»å“ªä¸ªç‰ˆæœ¬å¼€å§‹æ”¯æŒçš„ï¼š&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;è¯­æ³•/API&lt;/th&gt;&lt;th&gt;iOS&lt;/th&gt;&lt;th&gt;Chrome&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;Class&lt;/code&gt;&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;td&gt;49&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;=&amp;gt;&lt;/code&gt;&lt;/td&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;45&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;const&lt;/code&gt;&lt;/td&gt;&lt;td&gt;11&lt;/td&gt;&lt;td&gt;49&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;let&lt;/code&gt;&lt;/td&gt;&lt;td&gt;11&lt;/td&gt;&lt;td&gt;49&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;Proxy&lt;/code&gt;&lt;/td&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;49&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;generators&lt;/code&gt;&lt;/td&gt;&lt;td&gt;10&lt;/td&gt;&lt;td&gt;39&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;Promise&lt;/code&gt;&lt;/td&gt;&lt;td&gt;8&lt;/td&gt;&lt;td&gt;33&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;async await&lt;/code&gt;&lt;/td&gt;&lt;td&gt;11&lt;/td&gt;&lt;td&gt;55&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;import&lt;/code&gt; &lt;code&gt;export&lt;/code&gt;&lt;/td&gt;&lt;td&gt;10.3&lt;/td&gt;&lt;td&gt;61&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;...&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™äº›è¯­æ³•çš„æœ€ä½æ”¯æŒç‰ˆæœ¬é›†ä¸­åœ¨ &lt;code&gt;iOS 10&lt;/code&gt;ã€&lt;code&gt;iOS 11&lt;/code&gt;ï¼Œ&lt;code&gt;Chrome 49&lt;/code&gt;ï¼Œ&lt;code&gt;Chrome 61&lt;/code&gt; è¿™å‡ ä¸ªç‰ˆæœ¬ä¸Šï¼Œæˆ‘ä»¬æŠŠå®ƒä»¬çš„ç‰ˆæœ¬å‘å¸ƒæ—¶é—´åˆ—å‡ºæ¥ï¼š&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;äº‹ä»¶&lt;/th&gt;&lt;th&gt;å‘å¸ƒæ—¶é—´&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;ES5&lt;/code&gt; æ ‡å‡†å‘å¸ƒæ—¶é—´&lt;/td&gt;&lt;td&gt;2009.12&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;ES6&lt;/code&gt; æ ‡å‡†å‘å¸ƒæ—¶é—´&lt;/td&gt;&lt;td&gt;2015.06&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;iOS 10&lt;/code&gt; å‘å¸ƒæ—¶é—´&lt;/td&gt;&lt;td&gt;2016.06&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;iOS 11&lt;/code&gt; å‘å¸ƒæ—¶é—´&lt;/td&gt;&lt;td&gt;2017.06&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;Chrome 49&lt;/code&gt; å‘å¸ƒæ—¶é—´&lt;/td&gt;&lt;td&gt;2016.03&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;code&gt;Chrome 61&lt;/code&gt; å‘å¸ƒæ—¶é—´&lt;/td&gt;&lt;td&gt;2017.09&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ—¶é—´åˆ—å‡ºæ¥åç»“è®ºåŸºæœ¬ä¸Šæ˜¯å‘¼ä¹‹æ¬²å‡ºäº†ï¼š&lt;strong&gt;ES6 æ ‡å‡†å‘å¸ƒåçš„æœªæ¥ä¸€å¹´æ—¶é—´å†…ï¼Œå„å¤§æµè§ˆå™¨è¯­æ³•å°±æ”¯æŒçš„å·®ä¸å¤šäº†ï¼Œä¸¤å¹´ååŸºæœ¬ä¸Šå°±å…¨éƒ¨æ”¯æŒäº†&lt;/strong&gt;ï¼Œ&lt;strong&gt;è¿™ä¸ªæ—¶é—´ç‚¹å°±æ˜¯ 2017 å¹´ï¼Œå¯¹åº”ç€&lt;/strong&gt; &lt;code&gt;iOS 11&lt;/code&gt; &lt;strong&gt;å’Œ&lt;/strong&gt; &lt;code&gt;Chrome 61&lt;/code&gt;ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;legacy vs modern&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;çœ‹å®Œ ES6 çš„æ”¯æŒæƒ…å†µï¼Œæˆ‘ä»¬å†æ¥äº†è§£ä¸¤ä¸ªæ¦‚å¿µï¼Œã€Œç»å…¸æµè§ˆå™¨ã€å’Œã€Œç°ä»£æµè§ˆå™¨ã€ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸¤ä¸ªè¯åœ¨è‹±æ–‡é‡Œå¯¹åº”ç€ã€Œlegacy browserã€å’Œã€Œmodern browserã€ã€‚å¦‚æœå¤§å®¶æ¯”è¾ƒå…³æ³¨ä¸€äº›ç›¸å¯¹å‰æ²¿çš„å‰ç«¯é¡¹ç›®ï¼Œæ¯”å¦‚è¯´ Vue3ï¼ŒSolidjsï¼ŒViteï¼Œå®ƒä»¬çš„å®˜ç½‘é‡Œå…¶å®ç»å¸¸æåˆ°è¿™ä¸¤ä¸ªè¯ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ—¢ç„¶æœ‰ä¸¤ä¸ªç§°å‘¼ï¼Œé‚£åœ¨å·¥ç¨‹é‡Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªåˆ†ç•Œçº¿å»åŒºåˆ† legacy å’Œ modernï¼Œ&lt;strong&gt;è¿™ä¸ªåˆ†ç•Œçº¿å°±æ˜¯ &lt;code&gt;iOS10.3&lt;/code&gt; å’Œ &lt;code&gt;Chrome 61&lt;/code&gt;ï¼Œæ—¢æµè§ˆå™¨æ”¯æŒ ES Modules çš„ç‰ˆæœ¬&lt;/strong&gt;ï¼ˆæ”¯æŒ &lt;code&gt;&amp;lt;script type=&quot;module&quot;&amp;gt;&lt;/code&gt; &amp;amp; &lt;code&gt;import&lt;/code&gt; &amp;amp; &lt;code&gt;export&lt;/code&gt;ï¼‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™æ ·ä¸€çœ‹æ˜¯ä¸æ˜¯å°±å’Œä¸Šé¢çš„å†…å®¹å¯¹ä¸Šäº†ï¼ŸBabel å®˜ç½‘ä¹Ÿåšäº†ç›¸å…³çš„&lt;span&gt;è§£é‡Š&lt;/span&gt;&lt;sup&gt;[7]&lt;/sup&gt;ï¼Œcore-js ä¹Ÿä¸“é—¨åšäº†&lt;span&gt;åŒºåˆ†&lt;/span&gt;&lt;sup&gt;[8]&lt;/sup&gt;ï¼Œæ›´è¯¦ç»†çš„ä»‹ç»å¯ä»¥çœ‹ MDN çš„æ–‡ç« ï¼š&lt;span&gt;JavaScript modules&lt;/span&gt;&lt;sup&gt;[9]&lt;/sup&gt;ï¼Œæˆ‘å°±ä¸åšå¤šä½™ä»‹ç»äº†ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;modern feature&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»è¿‡ä¸Šé¢çš„æ¢ç´¢ï¼Œæˆ‘ä»¬å†å›è¿‡æ¥çœ‹çœ‹ä¸€äº›æ¯”è¾ƒ modern çš„ browser feature çš„æ”¯æŒç¨‹åº¦ï¼š&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;browser fature&lt;/th&gt;&lt;th&gt;iOS&lt;/th&gt;&lt;th&gt;Chrome&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;Web Worker&lt;/td&gt;&lt;td&gt;5&lt;/td&gt;&lt;td&gt;4&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;SubtleCrypto&lt;/td&gt;&lt;td&gt;7&lt;/td&gt;&lt;td&gt;37&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Service Worker&lt;/td&gt;&lt;td&gt;11.3&lt;/td&gt;&lt;td&gt;45&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;WebAssembly&lt;/td&gt;&lt;td&gt;11&lt;/td&gt;&lt;td&gt;57&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;CSS Grid Layout&lt;/td&gt;&lt;td&gt;10.3&lt;/td&gt;&lt;td&gt;58&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;WebGPU&lt;/td&gt;&lt;td&gt;not support&lt;/td&gt;&lt;td&gt;not support&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;...&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;td&gt;...&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;çœ‹çœ‹å„ä¸ª API çš„å…¼å®¹åº¦ï¼Œå†ç»“åˆä¸Šæ–‡çš„å†…å®¹ï¼Œå°±å¯ä»¥å‘ç°å¾ˆå¤šã€Œå…¼å®¹æ€§ä¸å¥½ã€äººäº‘äº¦äº‘çš„è¯´æ³•ä¸æ”»è‡ªç ´ï¼Œ&lt;strong&gt;å…¶å®å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä¸æ˜¯å…¼å®¹åº¦ä¸å¥½ä»è€Œä¸ç”¨ï¼Œæ˜¯é¡¹ç›®è¿˜æ²¡æœ‰å¤æ‚åˆ°é‚£ä¸ªç¨‹åº¦éœ€è¦ç”¨è¿™äº›é«˜çº§åŠŸèƒ½&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;4.Open Source Project&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ—¥å¸¸å¼€å‘ä¸­è‚¯å®šä¸èƒ½å†™ä¸€è¡Œä»£ç æŸ¥ä¸€ä¸‹å…¼å®¹åº¦ï¼Œè¿™äº›éƒ½æ˜¯ç”±ç¤¾åŒºå·¥å…·åšæŠ¹å¹³çš„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¼å®¹åº¦æ•°æ®æºå¤´å¯ä»¥è¿½è¿°åˆ° MDN çš„ &lt;span&gt;browser-compat-data&lt;/span&gt;&lt;sup&gt;[10]&lt;/sup&gt;ï¼Œè®°å½•äº†å„ç§ API çš„å…¼å®¹ï¼ŒMDN ç½‘ç«™çš„å…¼å®¹åº¦ç›´æ¥æ˜¯ä»è¿™ä¸ª repo é‡Œè¯»çš„ã€‚æˆ‘ä»¬å¸¸ç”¨çš„ &lt;span&gt;caniuse&lt;/span&gt;&lt;sup&gt;[11]&lt;/sup&gt; ç½‘ç«™ï¼Œä¸€éƒ¨åˆ†æ•°æ®ä¹Ÿæ˜¯ä¾èµ–äºå®ƒçš„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¥ä¸‹æ¥æ˜¯å·¥ç¨‹ä¸Šä¾èµ–æœ€å¤šçš„ &lt;span&gt;browserslist&lt;/span&gt;&lt;sup&gt;[12]&lt;/sup&gt;ï¼Œbabelã€eslintã€autoprefixerã€postcssï¼Œwebpack ç­‰æ„å»ºå·¥å…·éƒ½ä¾èµ–äºå®ƒï¼Œbrowserslist çš„æ•°æ®åˆä¾èµ–äº &lt;span&gt;caniuse-lite&lt;/span&gt;&lt;sup&gt;[13]&lt;/sup&gt;ï¼Œå…¶å®ä¹Ÿæ˜¯ä¾èµ–äº &lt;span&gt;caniuse&lt;/span&gt;&lt;sup&gt;[14]&lt;/sup&gt;ï¼Œlite åªä¿ç•™äº†æ ¸å¿ƒæ•°æ®ï¼Œå¯¹ä¸€äº›è¯´æ˜æ–‡æ¡ˆåšäº†è£å‰ªå¤„ç†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»¼åˆä»¥ä¸Šåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œåœ¨é¡¹ç›®å·¥ç¨‹é‡Œä¾èµ–çš„ browserslistï¼Œæ•°æ®å‡†ç¡®æ€§è¿˜æ˜¯å¯ä»¥å¾—åˆ°ä¿è¯çš„ï¼Œæ‰€ä»¥å…¼å®¹æ€§è¿˜æ˜¯æ— éœ€æ‹…å¿ƒçš„ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;5.Adaptation Suggestions&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£ä¹ˆæœ‰ä»€ä¹ˆé…ç½®å»ºè®®å‘¢ï¼Ÿæˆ‘ä¸ªäººè®¤ä¸ºä¸»è¦æœ‰ 3 ç‚¹å»ºè®®æä¾›å‚è€ƒã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ç¬¬ä¸€ä¸ªæ˜¯å‚è€ƒå›½æ°‘çº§ APP çš„æœ€ä½æ”¯æŒåº¦é…ç½®&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨å›½å†…ï¼Œåœ¨æ—¥æ´»ä¸Šèƒ½ç§°ä¸ºå›½æ°‘çº§ APP çš„å°±æ˜¯å¾®ä¿¡æŠ–éŸ³äº†ï¼Œè¿™ä¸¤ä¸ª APP å› ä¸ºæ—¥æ´»å·¨å¤§ï¼ŒåŸºæœ¬ä¸Šå·²ç»è¦†ç›–åˆ°å…¨éƒ¨ä¸­å›½äººï¼Œæ‰€ä»¥ä»–ä»¬çš„é…ç½®ä¸€å®šæœ‰æ‰€è€ƒé‡ï¼Œå¯ä»¥ååº”å‡ºå›½å†…çš„æ•´ä½“æ‰‹æœºç‰ˆæœ¬æ°´å¹³ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä» App Store/Android åº”ç”¨å•†åº—/æµè§ˆå™¨ UA ä¸Šçœ‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å¤„ä»¥ä¸‹ç»“è®ºï¼ˆæˆªæ­¢åˆ° 2022-8-8ï¼‰ï¼š&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;å¾®ä¿¡&lt;/strong&gt;ï¼šæœ€ä½æ”¯æŒåˆ° &lt;code&gt;iOS 12&lt;/code&gt;ã€&lt;code&gt;Android 5&lt;/code&gt;ã€å†…ç½®æµè§ˆå™¨ç‰ˆæœ¬ä¸º &lt;code&gt;Chrome 86&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;æŠ–éŸ³&lt;/strong&gt;ï¼šæœ€ä½æ”¯æŒåˆ° &lt;code&gt;iOS 10&lt;/code&gt;ã€&lt;code&gt;Android 5&lt;/code&gt;ã€å†…ç½®æµè§ˆå™¨ç‰ˆæœ¬ä¸º &lt;code&gt;Chrome 75&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“ç„¶ä½ ä¹Ÿå¯ä»¥å‚è€ƒå…¶ä»– APPï¼Œç”±äºç²¾åŠ›æœ‰é™æˆ‘å°±ä¸åšè¿‡å¤šå±•å¼€äº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ ¹æ®é¡¹ç›®çš„è¿­ä»£é€Ÿåº¦æ¥çœ‹ï¼ŒiOS åŸºæœ¬ä¸Šå¯ä»¥åšåˆ°ä¸€å¹´ä¸€å‡çº§ï¼Œæ¯”å¦‚è¯´ä»Šå¹´ &lt;code&gt;iOS 16&lt;/code&gt; å‡ºæ¥åï¼Œæ˜å¹´æœ€ä½é€‚é…ç‰ˆæœ¬åŸºæœ¬ä¸Šå¯ä»¥å‡åˆ° &lt;code&gt;iOS 11&lt;/code&gt; äº†ï¼ŒAndroid å› ä¸ºé•¿å°¾æ•ˆåº”å’Œç‰ˆæœ¬ä¸ç»‘å®šçš„é—®é¢˜ï¼Œåº”è¯¥è¿˜ä¼šæ”¯æŒåˆ° &lt;code&gt;Android 5&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ç¬¬äºŒä¸ªå»ºè®®æ˜¯ç›´æ¥çœ‹å½“å‰ä¸šåŠ¡çš„ç‰ˆæœ¬æ•°æ®&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸åŒçš„å…¬å¸ä¸åŒçš„é¡¹ç›®éƒ½æœ‰ä¸åŒçš„ç”¨æˆ·åœºæ™¯ï¼Œæ¯”å¦‚è¯´é¢å‘ä¸‰å››çº¿ C ç«¯ç”¨æˆ·çš„åœºæ™¯ï¼Œä¸€èˆ¬ä½ç«¯æœºå°±ä¼šå¤šä¸€äº›ï¼›é¢å‘é—¨åº—çš„åœºæ™¯ï¼Œè¯´ä¸å®šè¿˜å¾—é€‚é… IE æµè§ˆå™¨ï¼›é¢å‘ä¼ä¸šå†…çš„å¼€å‘è€…é¡¹ç›®ï¼Œç›´æ¥é€‚é…åˆ°æœ€æ–°å‡ ä¸ªæµè§ˆå™¨å³å¯ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœºæ™¯å¦‚æ­¤ä¹‹å¤šå°±è¦ä¾èµ–äºç”¨æˆ·ç‰ˆæœ¬æ•°æ®ç»Ÿè®¡äº†ã€‚ä¸€èˆ¬ä¸­å¤§å‚éƒ½æœ‰æ¯”è¾ƒå®Œå–„çš„æ•°æ®ç›‘æ§ä¸­å°ï¼Œç›´æ¥æ‹‰ä¸€ä»½æ•°æ®å°±èƒ½è·å–å¤§è‡´æƒ…å†µï¼ŒåŸºå»ºä¸å®Œå–„çš„å°å…¬å¸ä¹Ÿå¯ä»¥å•ç‹¬å¼€ä¸ªæ¥å£è®°å½•æ•°æ®ï¼Œæ”¶é›†ä¸€ä¸ªæœˆåšä¸ªå»é‡ç»Ÿè®¡ä¹Ÿèƒ½å¾—åˆ°ç›¸å…³æ•°æ®ã€‚æ‹¿åˆ°æ•°æ®åå†ç»“åˆä¸šåŠ¡åœºæ™¯åšäº›&lt;strong&gt;å–èˆ&lt;/strong&gt;ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥æ‹¿åˆ°æœ€ä½é€‚é…äº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ç¬¬ä¸‰ä¸ªå»ºè®®ç»“åˆå‰ç«¯æ¡†æ¶å’Œ Chrome ç‰ˆæœ¬åšå…¼å®¹ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»“åˆå‰ç«¯æ¡†æ¶å…¶å®å¾ˆå¥½ç†è§£ï¼Œæ¯”å¦‚è¯´ä½ ç”¨äº† Vue3ï¼Œåº•å±‚ä¾èµ–äº Proxyï¼Œé‚£ä¹ˆæœ€ä½ä¾èµ–å·²ç»é”æ­»åˆ° &lt;code&gt;iOS 10&lt;/code&gt; å’Œ &lt;code&gt;Chrome 49&lt;/code&gt; äº†ï¼Œé‚£ä½ çš„æœ€ä½é…ç½®åªèƒ½æ¯”ä»¥ä¸Šç‰ˆæœ¬é«˜ï¼Œå‡å¦‚ä½ æ— è„‘è®¾ç½®ä¸º &lt;code&gt;iOS 9&lt;/code&gt; æˆ– &lt;code&gt;Android 4&lt;/code&gt;ï¼Œé™¤äº†åœ¨æœ€ä½ç‰ˆæœ¬ä¸Šè·‘ä¸èµ·æ¥ï¼Œè¿˜è¦å¹³ç™½æ— æ•…çš„å¤šäº†è®¸å¤šè¯­æ³•è½¬æ¢å’Œ polyfillï¼Œåœ¨ &lt;strong&gt;æ„å»ºé€Ÿåº¦/è¿è¡Œæ—¶æ€§èƒ½/äº§ç‰©ä½“ç§¯&lt;/strong&gt; ä¸Šéƒ½ä¼šäº§ç”Ÿä¸å¿…è¦çš„åŠ£åŒ–ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»“åˆ Chrome ç‰ˆæœ¬åšå…¼å®¹å…¶å®å°±æ˜¯æœ¬æ–‡ç¬¬äºŒå¤§èŠ‚çš„å†…å®¹ã€‚å› ä¸º &lt;code&gt;Android 5&lt;/code&gt; ä¹‹åä¸å†å’Œ Chrome åšæ·±åº¦ç»‘å®šï¼Œç‰ˆæœ¬å…¼å®¹è®¾ç½® Android ç‰ˆæœ¬å…¶å®æ˜¯æ— æ„ä¹‰çš„è¡Œä¸ºï¼Œåº”è¯¥æ ¹æ®ç»Ÿè®¡ç»“æœç›´æ¥è®¾ç½® Chrome ç‰ˆæœ¬ï¼Œåšæ›´ç»†ç²’åº¦çš„é…ç½®ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;Refs: Version History&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥ä¸Šçš„ç‰ˆæœ¬å†å²å’Œå‘å¸ƒæ—¶é—´ä¸»è¦å‚è€ƒå®˜æ–¹æ›´æ–°æ—¥å¿—/æ–‡æ¡£ å’Œ ç»´åŸºç™¾ç§‘ï¼Œç›¸å…³é“¾æ¥å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;iOS ç‰ˆæœ¬å†å²ï¼š&lt;span&gt;https://en.wikipedia.org/wiki/IOS_version_history&lt;/span&gt;&lt;sup/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Android ç‰ˆæœ¬å†å²ï¼š&lt;span&gt;https://en.wikipedia.org/wiki/Android_version_history&lt;/span&gt;&lt;sup/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Chrome ç‰ˆæœ¬å†å²ï¼š&lt;span&gt;https://en.wikipedia.org/wiki/Google_Chrome_version_history&lt;/span&gt;&lt;sup/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;WKWebView API å…¼å®¹åº¦ï¼š&lt;span&gt;https://developer.apple.com/documentation/webkit/wkwebview&lt;/span&gt;&lt;sup/&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Android Verison å’Œ APILevel çš„å¯¹åº”å…³ç³»ï¼š&lt;span&gt;https://developer.android.com/guide/topics/manifest/uses-sdk-element#ApiLevels&lt;/span&gt;&lt;sup/&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;br data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;/&gt;&lt;br data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;/&gt;&lt;hr data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;/&gt;&lt;hr data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;/&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ğŸ“Œ&lt;/span&gt;&lt;p&gt;å¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ï¼Œå¸Œæœ›ç‚¹èµğŸ‘ æ”¶è— ğŸ“ åœ¨çœ‹ ğŸŒŸ ä¸‰è¿æ”¯æŒä¸€ä¸‹ï¼Œè°¢è°¢ä½ ï¼Œè¿™å¯¹æˆ‘çœŸçš„å¾ˆé‡è¦ï¼&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¬¢è¿å¤§å®¶å…³æ³¨æˆ‘çš„å¾®ä¿¡å…¬ä¼—å·ï¼š&lt;strong&gt;å¤è›‹å®éªŒå®¤&lt;/strong&gt;ï¼Œç›®å‰ä¸“æ³¨å‰ç«¯æŠ€æœ¯ï¼Œå¯¹å›¾å½¢å­¦ä¹Ÿæœ‰ä¸€äº›å¾®å°ç ”ç©¶ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¹Ÿå¯ä»¥åŠ æˆ‘çš„å¾®ä¿¡ &lt;strong&gt;egg_labs&lt;/strong&gt;ï¼Œæ¬¢è¿å¤§å®¶æ¥æ’©ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9874476987447699&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8MK8X2XQgu4C6KSk9OcJMIt6vbm4cQ0mINJEvt1UEUBBaR1hftktLbw5Wwzu3h0GMACiaNxcY9TWWUEkiaEcSfJg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;956&quot;/&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3055555555555556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/8MK8X2XQgu4C6KSk9OcJMIt6vbm4cQ0mKytNksWwTjQvricVbXuhKSt2Bwt0uBaJSTE4MgZjyQqncmzIzZbthfg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;å‚è€ƒèµ„æ–™&lt;/span&gt;&lt;/h3&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;Apple å®˜æ–¹ç»Ÿè®¡: &lt;em&gt;https://developer.apple.com/support/app-store/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;MDN çš„æ˜ å°„è¡¨: &lt;em&gt;https://github.com/mdn/browser-compat-data/blob/main/browsers/safari_ios.json&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[3]&lt;/span&gt;&lt;p&gt;core-js: SafariToIOS: &lt;em&gt;https://github.com/zloirock/core-js/blob/master/packages/core-js-compat/src/mapping.mjs&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[4]&lt;/span&gt;&lt;p&gt;å…¬å‘Š: &lt;em&gt;https://developer.apple.com/cn/news/?id=edwud51q&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[5]&lt;/span&gt;&lt;p&gt;å…¼å®¹æ€§ä¹Ÿä¸é”™: &lt;em&gt;https://developer.apple.com/documentation/webkit/wkwebview&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[6]&lt;/span&gt;&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬: &lt;em&gt;https://developer.chrome.com/docs/multidevice/webview/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[7]&lt;/span&gt;&lt;p&gt;è§£é‡Š: &lt;em&gt;https://babeljs.io/docs/en/options#targetsesmodules&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[8]&lt;/span&gt;&lt;p&gt;åŒºåˆ†: &lt;em&gt;https://github.com/zloirock/core-js/blob/master/packages/core-js-compat/src/external.mjs&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[9]&lt;/span&gt;&lt;p&gt;JavaScript modules: &lt;em&gt;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[10]&lt;/span&gt;&lt;p&gt;browser-compat-data: &lt;em&gt;https://github.com/mdn/browser-compat-data&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[11]&lt;/span&gt;&lt;p&gt;caniuse: &lt;em&gt;https://caniuse.com/&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[12]&lt;/span&gt;&lt;p&gt;browserslist: &lt;em&gt;https://github.com/browserslist/browserslist&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[13]&lt;/span&gt;&lt;p&gt;caniuse-lite: &lt;em&gt;https://github.com/browserslist/caniuse-lite&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[14]&lt;/span&gt;&lt;p&gt;caniuse: &lt;em&gt;https://github.com/Fyrd/caniuse&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;p&gt;&lt;em/&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>68ed88cd728129197dbdd3a42651ea12</guid>
<title>[æ–°æ–‡å¯¼è¯»] æ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡</title>
<link>https://toutiao.io/k/6ztt44k</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;&lt;p data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;span&gt;æœ¬æ–‡å¼•ç”¨è‡ªInfoQç¤¾åŒºâ€œ5äº¿ç”¨æˆ·å¦‚ä½•é«˜æ•ˆæ²Ÿé€šï¼Ÿé’‰é’‰é¦–æ¬¡å¯¹å¤–æ­ç§˜å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMâ€ä¸€æ–‡ï¼Œä½œè€…é™ˆä¸‡çº¢ç­‰ã€ç­–åˆ’è¤šæå¨Ÿï¼Œå³æ—¶é€šè®¯ç½‘æœ‰ä¿®è®¢å’Œæ”¹åŠ¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;ä¸€ã€å¼•è¨€&lt;/h2&gt;&lt;h1&gt;&lt;strong&gt;æœ¬æ–‡æ˜¯å›½å†…ä¼ä¸šIMçš„äº‹å®ç‹è€…é’‰é’‰é¦–æ¬¡å¯¹å¤–æ·±åº¦è§£å¯†å…¶å³æ—¶æ¶ˆæ¯æœåŠ¡ï¼ˆ&lt;span&gt;å³DingTalk IMï¼Œç®€ç§°DTIM&lt;/span&gt;ï¼‰çš„æŠ€æœ¯è®¾è®¡å®è·µã€‚&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;æœ¬ç¯‡æ–‡ç« å†…å®¹å°†ä»æ¨¡å‹è®¾è®¡åŸç†åˆ°å…·ä½“çš„æŠ€æœ¯æ¶æ„ã€æœ€åº•å±‚çš„å­˜å‚¨æ¨¡å‹åˆ°è·¨åœ°åŸŸçš„å•å…ƒåŒ–ç­‰ï¼Œå…¨æ–¹ä½å±•ç°äº† DTIM åœ¨å®é™…ç”Ÿäº§åº”ç”¨ä¸­æ‰€é‡åˆ°çš„å„ç§æŠ€æœ¯æŒ‘æˆ˜åŠç›¸åº”çš„è§£å†³æ–¹æ¡ˆï¼Œå¸Œæœ›å€Ÿæœ¬æ–‡å†…å®¹çš„åˆ†äº«èƒ½ä¸ºå›½å†…ä¼ä¸šçº§IMçš„å¼€å‘å¸¦æ¥æ€è€ƒå’Œå¯å‘ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;ignore_js_op&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.28134556574923547&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/st3UArDtcvLZxFHfmicDjISxR3CTWdhicLyNtiaBdfAUTDHq64ItbxThe103LyTAUYnpyb1BYrUAoJ82JBp6o38vQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;654&quot; title=&quot;é˜¿é‡ŒIMæŠ€æœ¯åˆ†äº«(å…«)ï¼šæ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡_cover-opti.jpg&quot;/&gt;&lt;/ignore_js_op&gt;&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;ignore_js_op&gt;&lt;br/&gt;&lt;/ignore_js_op&gt;&lt;/p&gt;&lt;h2&gt;äºŒã€æŠ€æœ¯çœ‹ç‚¹&lt;/h2&gt;&lt;h1&gt;&lt;em&gt;&lt;strong&gt;&lt;span&gt;ä¸€ã€&lt;/span&gt;&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;å¼•è¨€&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;äºŒã€&lt;/strong&gt;&lt;/em&gt;ç³»åˆ—æ–‡ç« &lt;/p&gt;&lt;p&gt;&lt;em&gt;ä¸‰ã€&lt;/em&gt;é’‰é’‰çš„æŠ€æœ¯æŒ‘æˆ˜&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;å››ã€&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;æ¨¡å‹è®¾è®¡&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;4.1ã€DTIMç³»ç»Ÿæ¶æ„&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;4.2ã€æ¶ˆæ¯æ”¶å‘é“¾è·¯&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;4.3ã€å­˜å‚¨æ¨¡å‹è®¾è®¡&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;4.4ã€åŒæ­¥æ¨¡å‹è®¾è®¡&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;äº”ã€&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;æ¶ˆæ¯å­˜å‚¨è®¾è®¡&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;å…­ã€&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;å¤šç«¯åŒæ­¥æœºåˆ¶è®¾è®¡&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;6.1ã€æ¦‚è¿°&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;6.2ã€å…¨é‡æ¶ˆæ¯å­˜å‚¨é€»è¾‘&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;6.3ã€æ¶ˆæ¯å¤šç«¯åŒæ­¥é€»è¾‘&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;6.4ã€å¤§é‡éœ€åŒæ­¥ç¦»çº¿æ¶ˆæ¯çš„ä¼˜åŒ–é€»è¾‘&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;ä¸ƒã€&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;é«˜å¯ç”¨è®¾è®¡&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;å…«ã€&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;æœ¬æ–‡å°ç»“&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;em&gt;&lt;strong&gt;ä¹ã€&lt;/strong&gt;&lt;/em&gt;&lt;/span&gt;ç›¸å…³æ–‡ç« &lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;ä¸‰ã€é’‰é’‰çš„æŠ€æœ¯æŒ‘æˆ˜&lt;/h2&gt;&lt;h1&gt;&lt;ignore_js_op&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.43666666666666665&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/st3UArDtcvLZxFHfmicDjISxR3CTWdhicLOPeKY6WUr6NxZ3oSmBicn73DcxPDloTKG8OGWbRtMicWGVOxP1FsunPQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;600&quot; title=&quot;é˜¿é‡ŒIMæŠ€æœ¯åˆ†äº«(å…«)ï¼šæ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡_0.jpg&quot;/&gt;&lt;/ignore_js_op&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;é’‰é’‰å·²ç»æœ‰ 2100 ä¸‡ + ç»„ç»‡ã€5 äº¿ + æ³¨å†Œç”¨æˆ·åœ¨ä½¿ç”¨ã€‚DTIM ä¸ºé’‰é’‰ç”¨æˆ·æä¾›å³æ—¶æ¶ˆæ¯æœåŠ¡ï¼Œç”¨äºç»„ç»‡å†…å¤–çš„æ²Ÿé€šï¼Œè¿™äº›ç»„ç»‡åŒ…æ‹¬å…¬å¸ã€æ”¿åºœã€å­¦æ ¡ç­‰ï¼Œè§„æ¨¡ä»å‡ äººåˆ°ç™¾ä¸‡äººä¸ç­‰ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;DTIM æœ‰ç€ä¸°å¯Œçš„åŠŸèƒ½ï¼Œå•èŠã€å„ç§ç±»å‹çš„ç¾¤èŠã€æ¶ˆæ¯å·²è¯»ã€æ–‡å­—è¡¨æƒ…ã€å¤šç«¯åŒæ­¥ã€åŠ¨æ€å¡ç‰‡ã€ä¸“å±å®‰å…¨å’Œå­˜å‚¨ç­‰ç­‰ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;åŒæ—¶ï¼š&lt;/strong&gt;&lt;span&gt;é’‰é’‰å†…éƒ¨å¾ˆå¤šä¸šåŠ¡æ¨¡å—ï¼Œæ¯”å¦‚æ–‡æ¡£ã€é’‰é—ªä¼šã€Teambitionã€éŸ³è§†é¢‘ã€è€ƒå‹¤ã€å®¡æ‰¹ç­‰ï¼Œæ¯ä¸ªä¸šåŠ¡éƒ½åœ¨ä½¿ç”¨ DTIMï¼Œç”¨äºå®ç°ä¸šåŠ¡æµç¨‹é€šçŸ¥ã€è¿è¥æ¶ˆæ¯æ¨é€ã€ä¸šåŠ¡ä¿¡ä»¤ä¸‹å‘ç­‰ã€‚æ¯ä¸ªä¸šåŠ¡æ¨¡å—å¯¹äº DTIM è°ƒç”¨çš„æµé‡å³°å€¼æ¨¡å‹å„æœ‰å·®åˆ«ï¼Œå¯¹å¯ç”¨æ€§è¦æ±‚ä¹Ÿä¸å°½ç›¸åŒã€‚&lt;/span&gt;&lt;strong&gt;DTIM éœ€è¦èƒ½å¤Ÿé¢å¯¹è¿™äº›å¤æ‚çš„åœºæ™¯ï¼Œä¿æŒè‰¯å¥½çš„å¯ç”¨æ€§å’Œä½“éªŒï¼ŒåŒæ—¶å…¼é¡¾æ€§èƒ½ä¸æˆæœ¬&lt;/strong&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;é€šç”¨çš„å³æ—¶æ¶ˆæ¯ç³»ç»Ÿå¯¹æ¶ˆæ¯å‘é€çš„æˆåŠŸç‡ã€æ—¶å»¶ã€åˆ°è¾¾ç‡æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œä¼ä¸š IM ç”±äº ToB çš„ç‰¹æ€§ï¼Œåœ¨æ•°æ®å®‰å…¨å¯é ã€ç³»ç»Ÿå¯ç”¨æ€§ã€å¤šç»ˆç«¯ä½“éªŒã€å¼€æ”¾å®šåˆ¶ç­‰å¤šä¸ªæ–¹é¢æœ‰ç€æè‡´çš„è¦æ±‚ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;æ„å»ºç¨³å®šé«˜æ•ˆçš„ä¼ä¸š IM æœåŠ¡ï¼ŒDTIM ä¸»è¦é¢ä¸´çš„æŒ‘æˆ˜æ˜¯ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;/h1&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;ä¼ä¸š IM æè‡´çš„ä½“éªŒè¦æ±‚å¯¹äºç³»ç»Ÿæ¶æ„è®¾è®¡çš„æŒ‘æˆ˜&lt;/span&gt;ï¼šæ¯”å¦‚æ•°æ®é•¿æœŸä¿å­˜å¯æ¼«æ¸¸ã€å¤šç«¯æ•°æ®åŒæ­¥ã€åŠ¨æ€æ¶ˆæ¯ç­‰å¸¦æ¥çš„æ•°æ®å­˜å‚¨æ•ˆç‡å’Œæˆæœ¬å‹åŠ›ï¼Œå¤šç«¯æ•°æ®åŒæ­¥å¸¦æ¥çš„ä¸€è‡´æ€§é—®é¢˜ç­‰ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;æé™åœºæ™¯å†²å‡»ã€ä¾èµ–ç³»ç»Ÿé”™è¯¯å¸¦æ¥çš„å¯ç”¨æ€§é—®é¢˜&lt;/span&gt;ï¼šæ¯”å¦‚è¶…å¤§ç¾¤æ¶ˆæ¯ï¼Œçªå‘ç–«æƒ…å¸¦æ¥çš„çº¿ä¸ŠåŠå…¬å’Œçº¿ä¸Šæ•™å­¦é«˜å¹¶å‘æµé‡ï¼Œç³»ç»Ÿéœ€è¦èƒ½å¤Ÿåº”å¯¹æµé‡çš„å†²å‡»ï¼Œä¿éšœé«˜å¯ç”¨ï¼›åŒæ—¶åœ¨ä¸­é—´ä»¶æ™®éå¯ç”¨æ€§ä¸åˆ° 99.99% çš„æ—¶å€™ï¼ŒDTIM æœåŠ¡éœ€è¦ä¿éšœæ ¸å¿ƒåŠŸèƒ½çš„ 99.995% çš„å¯ç”¨æ€§ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;ä¸æ–­æ‰©å¤§çš„ä¸šåŠ¡è§„æ¨¡ï¼Œå¯¹äºç³»ç»Ÿéƒ¨ç½²æ¶æ„çš„æŒ‘æˆ˜&lt;/span&gt;ï¼šæ¯”å¦‚æŒç»­å¢é•¿çš„ç”¨æˆ·è§„æ¨¡ï¼Œçªå‘äº‹ä»¶å¦‚å¸­å·å…¨çƒçš„ç–«æƒ…ï¼Œå•åœ°åŸŸæ¶æ„å·²ç»æ— æ³•æ»¡è¶³ä¸šåŠ¡å‘å±•çš„è¦æ±‚ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;DTIM åœ¨ç³»ç»Ÿè®¾è®¡ä¸Šï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;ä¸ºäº†å®ç°æ¶ˆæ¯æ”¶å‘ä½“éªŒã€æ€§èƒ½å’Œæˆæœ¬çš„å¹³è¡¡ï¼Œè®¾è®¡äº†é«˜æ•ˆçš„è¯»å†™æ‰©æ•£æ¨¡å‹å’ŒåŒæ­¥æœåŠ¡ï¼Œä»¥åŠå®šåˆ¶åŒ–çš„ NoSQL å­˜å‚¨ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;é€šè¿‡å¯¹ DTIM æœåŠ¡æµé‡çš„åˆ†æï¼Œå¯¹äºå¤§ç¾¤æ¶ˆæ¯ã€å•è´¦å·å¤§é‡çš„æ¶ˆæ¯çƒ­ç‚¹ä»¥åŠæ¶ˆæ¯æ›´æ–°çƒ­ç‚¹çš„åœºæ™¯è¿›è¡Œäº†åˆå¹¶ã€å‰Šå³°å¡«è°·ç­‰å¤„ç†ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;æ ¸å¿ƒé“¾è·¯çš„åº”ç”¨ä¸­é—´ä»¶çš„ä¾èµ–åšå®¹ç¾å¤„ç†ï¼Œå®ç°äº†å•ä¸€ä¸­é—´ä»¶å¤±è´¥ä¸å½±å“æ ¸å¿ƒæ¶ˆæ¯æ”¶å‘ï¼Œä¿éšœåŸºç¡€çš„ç”¨æˆ·ä½“éªŒã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;span&gt;åœ¨æ¶ˆæ¯å­˜å‚¨è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‡ºç°å­˜å‚¨ç³»ç»Ÿå†™å…¥å¼‚å¸¸ï¼Œç³»ç»Ÿä¼šå›æ—‹ç¼“å†²é‡åšï¼Œå¹¶ä¸”åœ¨æœåŠ¡æ¢å¤æ—¶ï¼Œæ•°æ®èƒ½ä¸»åŠ¨å‘ç«¯ä¸ŠåŒæ­¥ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;éšç€ç”¨æˆ·æ•°ä¸æ–­å¢é•¿ï¼Œå•ä¸€åœ°åŸŸå·²æ— æ³•æ‰¿è½½ DTIM çš„å®¹é‡å’Œå®¹ç¾éœ€æ±‚ï¼Œ&lt;/span&gt;&lt;strong&gt;DTIM å®ç°äº†å¼‚åœ°å¤šå•å…ƒçš„äº‘åŸç”Ÿçš„å¼¹æ€§æ¶æ„&lt;/strong&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;åœ¨åˆ†å±‚ä¸Šéµä»çš„åŸåˆ™ä¸ºé‡äº‘è½»ç«¯ï¼š&lt;/strong&gt;&lt;span&gt;ä¸šåŠ¡æ•°æ®è®¡ç®—ã€å­˜å‚¨ã€åŒæ­¥ç­‰å¤æ‚æ“ä½œå°½é‡åç§»åˆ°äº‘ç«¯å¤„ç†ï¼Œå®¢æˆ·ç«¯åªåšç»ˆæ€æ•°æ®çš„æ¥æ”¶ã€å±•ç¤ºï¼Œé€šè¿‡é™ä½å®¢æˆ·ç«¯ä¸šåŠ¡å®ç°çš„å¤æ‚åº¦ï¼Œæœ€å¤§åŒ–åœ°æå‡å®¢æˆ·ç«¯è¿­ä»£é€Ÿåº¦ï¼Œè®©ç«¯ä¸Šå¼€å‘å¯ä»¥ä¸“æ³¨äºæå‡ç”¨æˆ·çš„äº¤äº’ä½“éªŒï¼Œæ‰€æœ‰çš„åŠŸèƒ½éœ€æ±‚å’Œç³»ç»Ÿæ¶æ„éƒ½å›´ç»•ç€è¯¥åŸåˆ™åšè®¾è®¡å’Œæ‰©å±•ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;ä»¥ä¸‹ç« èŠ‚æˆ‘ä»¬å°†å¯¹ DTIM åšæ›´åŠ è¯¦ç»†çš„ä»‹ç»ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;å››ã€æ¨¡å‹è®¾è®¡&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;4.1ã€DTIMç³»ç»Ÿæ¶æ„&lt;/h2&gt;&lt;p&gt;&lt;br/&gt;&lt;span&gt;ä½å»¶è¿Ÿã€é«˜è§¦è¾¾ã€é«˜å¯ç”¨ä¸€ç›´æ˜¯ DTIM è®¾è®¡çš„ç¬¬ä¸€åŸåˆ™ï¼Œä¾æ®è¿™ä¸ªåŸåˆ™åœ¨æ¶æ„ä¸Š DTIM å°†ç³»ç»Ÿæ‹†åˆ†ä¸ºä¸‰ä¸ªæœåŠ¡åšèƒ½åŠ›çš„æ‰¿è½½ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;ä¸‰ä¸ªæœåŠ¡åˆ†åˆ«æ˜¯ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;æ¶ˆæ¯æœåŠ¡&lt;/span&gt;ï¼šè´Ÿè´£ IM æ ¸å¿ƒæ¶ˆæ¯æ¨¡å‹å’Œå¼€æ”¾ APIï¼ŒIM åŸºç¡€èƒ½åŠ›åŒ…æ‹¬æ¶ˆæ¯å‘é€ã€å•èŠå…³ç³»ç»´æŠ¤ã€ç¾¤ç»„å…ƒä¿¡æ¯ç®¡ç†ã€å†å²æ¶ˆæ¯æ‹‰å–ã€å·²è¯»çŠ¶æ€é€šçŸ¥ã€IM æ•°æ®å­˜å‚¨ä»¥åŠè·¨åœ°åŸŸçš„æµé‡è½¬å‘ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;åŒæ­¥æœåŠ¡&lt;/span&gt;ï¼šè´Ÿè´£ç”¨æˆ·æ¶ˆæ¯æ•°æ®ä»¥åŠçŠ¶æ€æ•°æ®çš„ç«¯åˆ°ç«¯åŒæ­¥ï¼Œé€šè¿‡å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯é•¿è¿æ¥é€šé“åšå®æ—¶çš„æ•°æ®äº¤äº’ï¼Œå½“é’‰é’‰å„ç±»è®¾å¤‡åœ¨çº¿æ—¶ IM åŠä¸Šæ¸¸å„ä¸šåŠ¡é€šè¿‡åŒæ­¥æœåŠ¡åšå¤šç«¯çš„æ•°æ®åŒæ­¥ï¼Œä¿éšœå„ç«¯æ•°æ®å’Œä½“éªŒä¸€è‡´ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;é€šçŸ¥æœåŠ¡&lt;/span&gt;ï¼šè´Ÿè´£ç”¨æˆ·ç¬¬ä¸‰æ–¹é€šé“ç»´æŠ¤ä»¥åŠé€šçŸ¥åŠŸèƒ½ï¼Œå½“é’‰é’‰çš„è‡ªå»ºé€šé“æ— æ³•å°†æ•°æ®åŒæ­¥åˆ°ç«¯ä¸Šæ—¶ï¼Œé€šè¿‡ä¸‰æ–¹æä¾›çš„é€šçŸ¥å’Œé€ä¼ èƒ½åŠ›åšæ¶ˆæ¯æ¨é€ï¼Œä¿éšœé’‰é’‰æ¶ˆæ¯çš„åŠæ—¶æ€§å’Œæœ‰æ•ˆæ€§ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;span&gt;åŒæ­¥æœåŠ¡å’Œé€šçŸ¥æœåŠ¡é™¤äº†æœåŠ¡äºæ¶ˆæ¯æœåŠ¡ï¼Œä¹Ÿé¢å‘å…¶ä»–é’‰é’‰ä¸šåŠ¡æ¯”å¦‚éŸ³è§†é¢‘ã€ç›´æ’­ã€Dingã€æ–‡æ¡£ç­‰å¤šç«¯ (&lt;/span&gt;&lt;span&gt;å¤šè®¾å¤‡&lt;/span&gt;&lt;span&gt;) æ•°æ®åŒæ­¥ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;å›¾1ï¼š&lt;/strong&gt;&lt;span&gt;DTIMæ¶æ„å›¾ â–¼&lt;/span&gt;&lt;br/&gt;&lt;ignore_js_op/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9615384615384616&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/st3UArDtcvLZxFHfmicDjISxR3CTWdhicL2QruwvFSMJ5Je2q4KL7eslkhFg2ic8y8haAa01TkypgBEok6gsPLyoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;650&quot; title=&quot;é˜¿é‡ŒIMæŠ€æœ¯åˆ†äº«(å…«)ï¼šæ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡_1.png&quot;/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;ä¸Šå›¾å±•ç¤ºäº† DTIM ç³»ç»Ÿæ¶æ„ï¼Œæ¥ä¸‹æ¥è¯¦ç»†ä»‹ç»æ¶ˆæ¯æ”¶å‘é“¾è·¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;4.2ã€æ¶ˆæ¯æ”¶å‘é“¾è·¯&lt;/h2&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;å›¾2ï¼š&lt;/strong&gt;&lt;span&gt;DTIMæ¶ˆæ¯å¤„ç†æ¶æ„ â–¼&lt;/span&gt;&lt;br/&gt;&lt;ignore_js_op/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7259978425026968&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/st3UArDtcvLZxFHfmicDjISxR3CTWdhicLgRvjAT2bibic15victO7g45fAj0JJ4q41KtgZolGg2nu18bbOzFqmBGWQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;927&quot; title=&quot;é˜¿é‡ŒIMæŠ€æœ¯åˆ†äº«(å…«)ï¼šæ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡_2.png&quot;/&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;æ¶ˆæ¯å‘é€ï¼š&lt;/strong&gt;&lt;span&gt;æ¶ˆæ¯å‘é€æ¥å£ç”± Receiver æä¾›ï¼Œé’‰é’‰ç»Ÿä¸€æ¥å…¥å±‚å°†ç”¨æˆ·ä»å®¢æˆ·ç«¯å‘é€çš„æ¶ˆæ¯è¯·æ±‚è½¬å‘åˆ° Receiver æ¨¡å—ï¼ŒReceiver æ ¡éªŒæ¶ˆæ¯çš„åˆæ³•æ€§ï¼ˆ&lt;/span&gt;&lt;span&gt;æ–‡å­—å›¾ç‰‡ç­‰å®‰å…¨å®¡æ ¸ã€ç¾¤ç¦è¨€åŠŸèƒ½æ˜¯å¦å¼€å¯æˆ–è€…æ˜¯å¦è§¦å‘ä¼šè¯æ¶ˆæ¯é™æµè§„åˆ™ç­‰&lt;/span&gt;&lt;span&gt;ï¼‰ä»¥åŠæˆå‘˜å…³ç³»çš„æœ‰æ•ˆæ€§ï¼ˆ&lt;/span&gt;&lt;span&gt;å•èŠæ ¡éªŒäºŒè€…èŠå¤©ã€ç¾¤èŠæ ¡éªŒå‘é€è€…åœ¨ç¾¤èŠæˆå‘˜åˆ—è¡¨ä¸­&lt;/span&gt;&lt;span&gt;ï¼‰ï¼Œæ ¡éªŒé€šè¿‡åä¸ºè¯¥æ¶ˆæ¯ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€çš„ MessageId éšæ¶ˆæ¯ä½“ä»¥åŠæ¥æ”¶è€…åˆ—è¡¨æ‰“åŒ…æˆæ¶ˆæ¯æ•°æ®åŒ…æŠ•é€’ç»™å¼‚æ­¥é˜Ÿåˆ—ï¼Œç”±ä¸‹æ¸¸ Processor å¤„ç†ã€‚æ¶ˆæ¯æŠ•é€’æˆåŠŸä¹‹åï¼ŒReceiver è¿”å›æ¶ˆæ¯å‘é€æˆåŠŸçš„å›æ‰§ç»™å®¢æˆ·ç«¯ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;æ¶ˆæ¯å¤„ç† ï¼š&lt;/strong&gt;&lt;span&gt;Processor æ¶ˆè´¹åˆ° IM å‘é€äº‹ä»¶é¦–å…ˆåšæŒ‰æ¥æ”¶è€…çš„åœ°åŸŸåˆ†å¸ƒï¼ˆ&lt;/span&gt;&lt;span&gt;DTIM æ”¯æŒè·¨åŸŸéƒ¨ç½²ï¼Œ Geographyï¼ŒGeo&lt;/span&gt;&lt;span&gt;ï¼‰åšæ¶ˆæ¯äº‹ä»¶åˆ†æµï¼Œå°†æœ¬åŸŸç”¨æˆ·çš„æ¶ˆæ¯åšæœ¬åœ°å­˜å‚¨å…¥åº“ï¼ˆ&lt;/span&gt;&lt;span&gt;æ¶ˆæ¯ä½“ã€æ¥æ”¶è€…ç»´åº¦ã€å·²è¯»çŠ¶æ€ã€ä¸ªäººä¼šè¯åˆ—è¡¨çº¢ç‚¹æ›´æ–°&lt;/span&gt;&lt;span&gt;ï¼‰ï¼Œæœ€åå°†æ¶ˆæ¯ä½“ä»¥åŠæœ¬åŸŸæ¥æ”¶è€…åˆ—è¡¨æ‰“åŒ…ä¸º IM åŒæ­¥äº‹ä»¶é€šè¿‡å¼‚æ­¥é˜Ÿåˆ—è½¬å‘ç»™åŒæ­¥æœåŠ¡ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;æ¶ˆæ¯æ¥æ”¶ ï¼š&lt;/strong&gt;&lt;span&gt;åŒæ­¥æœåŠ¡æŒ‰æ¥æ”¶è€…ç»´åº¦å†™å…¥å„è‡ªçš„åŒæ­¥é˜Ÿåˆ—ï¼ŒåŒæ—¶æŸ¥å–å½“å‰ç”¨æˆ·è®¾å¤‡åœ¨çº¿çŠ¶æ€ï¼Œå½“ç”¨æˆ·åœ¨çº¿æ—¶æå–é˜Ÿåˆ—ä¸­æœªåŒæ­¥çš„æ¶ˆæ¯ï¼Œé€šè¿‡æ¥å…¥å±‚é•¿è¿æ¥æ¨é€åˆ°å„ç«¯ã€‚å½“ç”¨æˆ·ç¦»çº¿æ—¶ï¼Œæ‰“åŒ…æ¶ˆæ¯æ•°æ®ä»¥åŠç¦»çº¿ç”¨æˆ·çŠ¶æ€åˆ—è¡¨ä¸º IM é€šçŸ¥äº‹ä»¶ï¼Œè½¬å‘ç»™é€šçŸ¥æœåŠ¡çš„ PNS æ¨¡å—ï¼ŒPNS æŸ¥è¯¢ç¦»çº¿è®¾å¤‡åšä¸‰æ–¹å‚å•†é€šé“æ¨é€ï¼Œè‡³æ­¤ä¸€æ¡æ¶ˆæ¯çš„æ¨é€æµç¨‹ç»“æŸã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;4.3ã€å­˜å‚¨æ¨¡å‹è®¾è®¡&lt;/h2&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;äº†è§£ IM æœåŠ¡æœ€å¿«çš„é€”å¾„å°±æ˜¯æŒæ¡å®ƒçš„å­˜å‚¨æ¨¡å‹ã€‚&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;ä¸šç•Œä¸»æµ IM æœåŠ¡å¯¹äºæ¶ˆæ¯ã€ä¼šè¯ã€ä¼šè¯ä¸æ¶ˆæ¯çš„ç»„ç»‡å…³ç³»è™½ç„¶ä¸å°½ç›¸åŒï¼Œä½†æ˜¯å½’çº³èµ·æ¥ä¸»è¦æ˜¯ä¸¤ç§å½¢å¼ï¼šå†™æ‰©æ•£è¯»èšåˆã€è¯»æ‰©æ•£å†™èšåˆã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;æ‰€è°“è¯»å†™æ‰©æ•£å…¶å®æ˜¯å®šä¹‰æ¶ˆæ¯åœ¨ç¾¤ç»„ä¼šè¯ä¸­çš„å­˜å‚¨å½¢å¼ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;å›¾3ï¼š&lt;/strong&gt;&lt;span&gt;è¯»æ¨¡å¼å’Œå†™æ¨¡å¼ â–¼&lt;/span&gt;&lt;br/&gt;&lt;ignore_js_op/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.39438085327783556&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/st3UArDtcvLZxFHfmicDjISxR3CTWdhicLo1bib1OM58x3u4WsEPWOMKFQYjcDlLWbHzAjH1qQLDfRNpB7TffPCFw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;961&quot; title=&quot;é˜¿é‡ŒIMæŠ€æœ¯åˆ†äº«(å…«)ï¼šæ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡_3.png&quot;/&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;è¯»æ‰©æ•£çš„åœºæ™¯&lt;/span&gt;ï¼šæ¶ˆæ¯å½’å±äºä¼šè¯ï¼Œå¯¹åº”åˆ°å­˜å‚¨ä¸­ç›¸å½“äºæœ‰å¼  conversation_message çš„è¡¨å­˜å‚¨ç€è¯¥ä¼šè¯äº§ç”Ÿçš„æ‰€æœ‰æ¶ˆæ¯ (cid-&amp;gt;msgid-&amp;gt;messageï¼Œcid ä¼šè¯ IDã€msgid æ¶ˆæ¯ IDã€message æ¶ˆæ¯)ï¼Œè¿™æ ·å®ç°çš„å¥½å¤„æ˜¯æ¶ˆæ¯å…¥åº“æ•ˆç‡é«˜ï¼Œåªå­˜å‚¨ä¼šè¯ä¸æ¶ˆæ¯çš„ç»‘å®šå…³ç³»å³å¯ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;å†™æ‰©æ•£çš„åœºæ™¯&lt;/span&gt;ï¼šä¼šè¯äº§ç”Ÿçš„æ¶ˆæ¯æŠ•é€’åˆ°ç±»ä¼¼äºä¸ªäººé‚®ä»¶çš„æ”¶ä»¶ç®±ï¼Œå³ message_inbox è¡¨ï¼Œå­˜å‚¨ä¸ªäººçš„æ‰€æœ‰æ¶ˆæ¯ï¼ˆuid-&amp;gt;msgid-&amp;gt;messageï¼Œ uid ç”¨æˆ· IDã€msgid æ¶ˆæ¯ IDã€message æ¶ˆæ¯ï¼‰ï¼ŒåŸºäºè¿™ç§å®ç°ï¼Œä¼šè¯ä¸­çš„æ¯æ¡æ¶ˆæ¯é¢å‘ä¸åŒçš„æ¥æ”¶è€…å¯ä»¥å‘ˆç°å‡ºä¸åŒçŠ¶æ€ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;span&gt;DTIM å¯¹ IM æ¶ˆæ¯çš„åŠæ—¶æ€§ã€å‰åç«¯å­˜å‚¨çŠ¶æ€ä¸€è‡´æ€§è¦æ±‚å¼‚å¸¸ä¸¥æ ¼ï¼Œç‰¹åˆ«å¯¹äºå†å²æ¶ˆæ¯æ¼«æ¸¸çš„è¯‰æ±‚ååˆ†å¼ºçƒˆï¼Œå½“å‰ä¸šç•Œ IM äº§å“å¯¹äºæ¶ˆæ¯é•¿æ—¶é—´å­˜å‚¨å’Œå®¢æˆ·ç«¯å†å²æ¶ˆæ¯å¤šç«¯æ¼«æ¸¸éƒ½åšå¾—ä¸å°½å¦‚äººæ„ï¼Œä¸»è¦æ˜¯å­˜å‚¨æˆæœ¬è¿‡é«˜ã€‚å› æ­¤åœ¨äº§å“ä½“éªŒä¸æŠ•å…¥æˆæœ¬ä¹‹é—´éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå¹³è¡¡ç‚¹ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;é‡‡ç”¨è¯»æ‰©æ•£ï¼š&lt;/strong&gt;&lt;span&gt;åœ¨ä¸ªæ€§åŒ–çš„æ¶ˆæ¯æ‰©å±•åŠå®ç°å±‚é¢æœ‰å¾ˆå¤§çš„çº¦æŸã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;é‡‡ç”¨å†™æ‰©æ•£å¸¦æ¥çš„é—®é¢˜ä¹Ÿå¾ˆæ˜æ˜¾ï¼š&lt;/strong&gt;&lt;span&gt;ä¸€ä¸ªç¾¤æˆå‘˜ä¸º N çš„ä¼šè¯ä¸€æ—¦äº§ç”Ÿæ¶ˆæ¯å°±ä¼šæ‰©æ•£ N æ¡æ¶ˆæ¯è®°å½•ï¼Œå¦‚æœåœ¨æ¶ˆæ¯å‘é€å’Œæ‰©æ•£é‡è¾ƒå°‘çš„åœºæ™¯ï¼Œè¿™æ ·çš„å®ç°ç›¸æ¯”äºè¯»æ‰©æ•£è½åœ°æ›´ä¸ºç®€å•ï¼Œå­˜å‚¨æˆæœ¬ä¹Ÿä¸æ˜¯é—®é¢˜ã€‚ä½†æ˜¯ DTIM ä¼šè¯æ´»è·ƒåº¦è¶…é«˜ï¼Œä¸€æ¡æ¶ˆæ¯çš„å¹³å‡æ‰©æ•£æ¯”å¯ä»¥è¾¾åˆ° 1ï¼š30ï¼Œè¶…å¤§ç¾¤åˆæ˜¯ä¼ä¸š IM æœ€æ ¸å¿ƒçš„æ²Ÿé€šåœºæ™¯ï¼Œå¦‚æœé‡‡ç”¨å®Œå…¨å†™æ‰©æ•£æ‰€å¸¦æ¥å­˜å‚¨æˆæœ¬é—®é¢˜åŠ¿å¿…åˆ¶çº¦é’‰é’‰ä¸šåŠ¡å‘å±•ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;æ‰€ä»¥ï¼Œ&lt;/span&gt;&lt;strong&gt;&lt;span&gt;åœ¨ DTIM çš„å­˜å‚¨å®ç°ä¸Šï¼Œé’‰é’‰é‡‡å–äº†æ··åˆçš„æ–¹æ¡ˆï¼Œå°†è¯»æ‰©æ•£å’Œå†™æ‰©æ•£é’ˆå¯¹ä¸åŒåœºæ™¯åšäº†é€‚é…ï¼Œæœ€ç»ˆåœ¨ç”¨æˆ·è§†è§’ç³»ç»Ÿä¼šåšç»Ÿä¸€åˆå¹¶&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;å›¾4ï¼š&lt;/strong&gt;&lt;span&gt;DTIM è¯»å†™æ··åˆæ¨¡å¼ â–¼&lt;/span&gt;&lt;br/&gt;&lt;ignore_js_op&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.612942612942613&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/st3UArDtcvLZxFHfmicDjISxR3CTWdhicLrczaF55bcjtLJ2MTA7TUjYgiaNbcWcddicrG6sBxuAKhiaQkuwGPhs6BQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;819&quot; title=&quot;é˜¿é‡ŒIMæŠ€æœ¯åˆ†äº«(å…«)ï¼šæ·±åº¦è§£å¯†é’‰é’‰å³æ—¶æ¶ˆæ¯æœåŠ¡DTIMçš„æŠ€æœ¯è®¾è®¡_4.png&quot;/&gt;&lt;/ignore_js_op&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;ä½œä¸ºè¯»æ‰©æ•£ã€å†™æ‰©æ•£æ–¹æ¡ˆçš„æ··åˆå½¢å¼å­˜åœ¨ï¼Œç”¨æˆ·ç»´åº¦çš„æ¶ˆæ¯åˆ†åˆ«ä»Â &lt;/span&gt;&lt;span&gt;conversation_message&lt;/span&gt;&lt;span&gt;Â å’ŒÂ &lt;/span&gt;&lt;span&gt;message_inbox&lt;/span&gt;&lt;span&gt;Â è¡¨ä¸­è·å–ï¼Œåœ¨åº”ç”¨ä¾§æŒ‰æ¶ˆæ¯å‘é€æ—¶é—´åšæ’åºåˆå¹¶ï¼Œ&lt;/span&gt;&lt;span&gt;conversation_message&lt;/span&gt;&lt;span&gt;Â è¡¨ä¸­è®°å½•äº†è¯¥ä¼šè¯é¢å‘æ‰€æœ‰ç¾¤æˆå‘˜æ¥æ”¶çš„æ™®é€šæ¶ˆæ¯ Nï¼ˆ&lt;/span&gt;&lt;span&gt;Normal&lt;/span&gt;&lt;span&gt;ï¼‰ï¼Œè€ŒÂ &lt;/span&gt;&lt;span&gt;message_inbox&lt;/span&gt;&lt;span&gt;Â è¡¨åœ¨ä»¥ä¸‹ä¸¤ç§åœºæ™¯ä¸‹è¢«å†™å…¥ï¼š&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;ç¬¬ä¸€ç§æ˜¯ï¼š&lt;/strong&gt;&lt;span&gt;å®šå‘æ¶ˆæ¯ Pï¼ˆ&lt;/span&gt;&lt;span&gt;Privateï¼Œç§æœ‰æ¶ˆæ¯&lt;/span&gt;&lt;span&gt;ï¼‰ï¼Œç¾¤ä¼šè¯ä¸­å‘é€çš„æ¶ˆæ¯æŒ‡å®šäº†æ¥æ”¶è€…èŒƒå›´ï¼Œé‚£ä¹ˆä¼šç›´æ¥å†™å…¥åˆ°æ¥æ”¶è€…çš„ message_inbox è¡¨ä¸­ï¼Œæ¯”å¦‚çº¢åŒ…çš„é¢†å–çŠ¶æ€æ¶ˆæ¯åªèƒ½è¢«çº¢åŒ…å‘é€è€…å¯è§ï¼Œé‚£ä¹ˆè¿™ç§æ¶ˆæ¯å³è¢«å®šä¹‰ä¸ºå®šå‘æ¶ˆæ¯ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;ç¬¬äºŒç§æ˜¯ï¼š&lt;/strong&gt;&lt;span&gt;å½’å±äºä¼šè¯æ¶ˆæ¯çš„çŠ¶æ€è½¬æ¢ NPï¼ˆ&lt;/span&gt;&lt;span&gt;Normal to Privateï¼Œæ™®é€šæ¶ˆæ¯è½¬ç§æœ‰æ¶ˆæ¯&lt;/span&gt;&lt;span&gt;ï¼‰ï¼Œå½“ä¼šè¯æ¶ˆæ¯é€šè¿‡æŸç§è¡Œä¸ºä½¿å¾—æŸäº›æ¶ˆæ¯æ¥æ”¶è€…çš„æ¶ˆæ¯çŠ¶æ€å‘ç”Ÿè½¬æ¢æ—¶ï¼Œè¯¥çŠ¶æ€ä¼šå†™å…¥åˆ°Â &lt;/span&gt;&lt;span&gt;message_inbox&lt;/span&gt;&lt;span&gt;Â è¡¨ä¸­ï¼Œæ¯”å¦‚ç”¨æˆ·åœ¨æ¥æ”¶ä¾§åˆ é™¤äº†æ¶ˆæ¯ï¼Œé‚£ä¹ˆæ¶ˆæ¯çš„åˆ é™¤çŠ¶æ€ä¼šå†™å…¥åˆ°Â &lt;/span&gt;&lt;span&gt;message_inbox&lt;/span&gt;&lt;span&gt;Â ä¸­ï¼Œåœ¨ç”¨æˆ·æ‹‰å–æ—¶ä¼šé€šè¿‡Â &lt;/span&gt;&lt;span&gt;message_inbox&lt;/span&gt;&lt;span&gt;Â çš„åˆ é™¤çŠ¶æ€å°†Â &lt;/span&gt;&lt;span&gt;conversation_message&lt;/span&gt;&lt;span&gt;Â ä¸­çš„æ¶ˆæ¯åšè¦†ç›–ï¼Œæœ€ç»ˆç”¨æˆ·æ‹‰å–ä¸åˆ°è‡ªå·±å·²åˆ é™¤çš„æ¶ˆæ¯ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;å½“ç”¨æˆ·åœ¨å®¢æˆ·ç«¯å‘èµ·æŸä¸ªä¼šè¯çš„å†å²æ¶ˆæ¯æ¼«æ¸¸è¯·æ±‚æ—¶ï¼ŒæœåŠ¡ç«¯æ ¹æ®ç”¨æˆ·ä¸Šä¼ çš„æ¶ˆæ¯æˆªæ­¢æ—¶é—´ï¼ˆ&lt;/span&gt;&lt;span&gt;message_create_time&lt;/span&gt;&lt;span&gt;ï¼‰åˆ†åˆ«ä»Â &lt;/span&gt;&lt;span&gt;conversation_message&lt;/span&gt;&lt;span&gt;Â è¡¨å’ŒÂ &lt;/span&gt;&lt;span&gt;message_inbox&lt;/span&gt;&lt;span&gt;Â è¡¨æ‹‰å–æ¶ˆæ¯åˆ—è¡¨ï¼Œåœ¨åº”ç”¨å±‚åšçŠ¶æ€çš„åˆå¹¶ï¼Œæœ€ç»ˆè¿”å›ç»™ç”¨æˆ·åˆå¹¶ä¹‹åçš„æ•°æ®ï¼ŒNã€Pã€NP ä¸‰ç§ç±»å‹æ¶ˆæ¯åœ¨æ¶ˆæ¯ä¸ªæ€§åŒ–å¤„ç†å’Œå­˜å‚¨æˆæœ¬ä¹‹é—´å–å¾—äº†å¾ˆå¥½çš„å¹³è¡¡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;4.4ã€åŒæ­¥æ¨¡å‹è®¾è®¡&lt;/h2&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;4.4.1&lt;/span&gt;æ¨é€æ¨¡å‹&lt;/h3&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;ç”¨æˆ·åœ¨ä¼šè¯ä¸­å‘å‡ºçš„æ¶ˆæ¯å’Œæ¶ˆæ¯çŠ¶æ€å˜æ›´ç­‰äº‹ä»¶æ˜¯å¦‚ä½•åŒæ­¥åˆ°ç«¯ä¸Šå‘¢ï¼Ÿ&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;ä¸šç•Œå…³äºæ¶ˆæ¯çš„åŒæ­¥æ¨¡å‹çš„å®ç°æ–¹æ¡ˆå¤§è‡´æœ‰ä¸‰ç§ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;å®¢æˆ·ç«¯æ‹‰å–æ–¹æ¡ˆï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;æœåŠ¡ç«¯æ¨é€æ–¹æ¡ˆï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;æœåŠ¡ç«¯æ¨é€ä½ç‚¹ä¹‹åå®¢æˆ·ç«¯æ‹‰å–çš„æ¨æ‹‰ç»“åˆæ–¹æ¡ˆã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;ä¸‰ç§æ–¹æ¡ˆå„æœ‰ä¼˜åŠ£ï¼Œåœ¨æ­¤ç®€çŸ­æ€»ç»“ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;é¦–å…ˆ&lt;/span&gt;ï¼šå®¢æˆ·ç«¯æ‹‰å–æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯è¯¥æ–¹æ¡ˆå®æ–½ç®€å•ã€ç ”å‘æˆæœ¬ä½ï¼Œæ˜¯ä¼ ç»Ÿçš„ B/S æ¶æ„ã€‚åŠ£åŠ¿æ˜¯æ•ˆç‡ä½ä¸‹ï¼Œæ‹‰å–é—´éš”æ§åˆ¶æƒåœ¨å®¢æˆ·ç«¯ï¼Œå¯¹äº IM è¿™ç§å®æ—¶çš„åœºæ™¯ï¼Œå¾ˆéš¾è®¾ç½®ä¸€ä¸ªæœ‰æ•ˆçš„æ‹‰å–é—´éš”ï¼Œé—´éš”å¤ªçŸ­å¯¹æœåŠ¡ç«¯å‹åŠ›å¤§ï¼Œé—´éš”å¤ªé•¿æ—¶æ•ˆæ€§å·®ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;å…¶æ¬¡&lt;/span&gt;ï¼šæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ–¹æ¡ˆçš„ä¼˜ç‚¹æ˜¯ä½å»¶è¿Ÿã€èƒ½åšåˆ°å®æ—¶ï¼Œæœ€é‡è¦çš„ä¸»åŠ¨æƒåœ¨æœåŠ¡ç«¯ã€‚åŠ£åŠ¿ç›¸å¯¹æ‹‰å–æ–¹æ¡ˆï¼Œå¦‚ä½•åè°ƒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„å¤„ç†èƒ½åŠ›å­˜åœ¨é—®é¢˜ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;æœ€å&lt;/span&gt;ï¼šæ¨æ‹‰ç»“åˆè¿™ä¸ªæ–¹æ¡ˆæ•´åˆäº†æ‹‰å’Œæ¨çš„ä¼˜ç‚¹ï¼Œä½†æ˜¯æ–¹æ¡ˆæ›´å¤æ‚ï¼ŒåŒæ—¶ä¼šæ¯”æ¨çš„æ–¹æ¡ˆå¤šä¸€æ¬¡ RTTï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨ç½‘ç»œçš„åœºæ™¯ä¸‹ï¼Œä¸å¾—ä¸é¢ä¸´åŠŸè€—å’Œæ¨é€æˆåŠŸç‡çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;DTIM ç›¸å¯¹ä¼ ç»Ÿ toC çš„åœºæ™¯ï¼Œæœ‰è¾ƒæ˜æ˜¾çš„åŒºåˆ«ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;br/&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;strong&gt;ç¬¬ä¸€æ˜¯å¯¹å®æ—¶æ€§çš„è¦æ±‚ï¼š&lt;/strong&gt;&lt;span&gt;åœ¨ä¼ä¸šæœåŠ¡ä¸­ï¼Œæ¯”å¦‚å‘˜å·¥èŠå¤©æ¶ˆæ¯ã€å„ç§ç³»ç»ŸæŠ¥è­¦ï¼Œåˆæ¯”å¦‚éŸ³è§†é¢‘ä¸­çš„å…±äº«ç”»æ¿ï¼Œæ— ä¸è¦æ±‚å®æ—¶äº‹ä»¶åŒæ­¥ï¼Œå› æ­¤éœ€è¦ä¸€ç§ä½å»¶æ—¶çš„åŒæ­¥æ–¹æ¡ˆã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;strong&gt;ç¬¬äºŒæ˜¯å¼±ç½‘æ¥å…¥çš„èƒ½åŠ›ï¼š&lt;/strong&gt;&lt;span&gt;åœ¨ DTIM æœåŠ¡çš„å¯¹è±¡ä¸­ï¼Œä¸Šåƒä¸‡çš„ä¼ä¸šç»„ç»‡æ¶‰åŠå„è¡Œå„ä¸šï¼Œä»å¤§åŸå¸‚ 5G çš„é«˜é€Ÿåˆ°åè¿œçš„å±±åŒºå¼±ç½‘ï¼Œéƒ½éœ€è¦ DTIM çš„æ¶ˆæ¯èƒ½å‘é€ã€èƒ½è§¦è¾¾ã€‚å¯¹äºå¤æ‚çš„ç½‘ç»œç¯å¢ƒï¼Œéœ€è¦æœåŠ¡ç«¯èƒ½åˆ¤æ–­æ¥å…¥ç¯å¢ƒï¼Œå¹¶ä¾æ®ä¸åŒçš„ç¯å¢ƒæ¡ä»¶è°ƒæ•´åŒæ­¥æ•°æ®çš„ç­–ç•¥ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;strong&gt;ç¬¬ä¸‰æ˜¯åŠŸè€—å¯æ§æˆæœ¬å¯æ§ï¼š&lt;/strong&gt;&lt;span&gt;åœ¨ DTIM çš„ä¼ä¸šåœºæ™¯ä¸­ï¼Œæ¶ˆæ¯æ”¶å‘é¢‘ç‡æ¯”ä¼ ç»Ÿçš„ IM å¤šå‡ºä¸€ä¸ªæ•°é‡çº§ï¼Œåœ¨è¿™ä¹ˆå¤§çš„æ¶ˆæ¯æ”¶å‘åœºæ™¯æ€ä¹ˆä¿éšœ DTIM çš„åŠŸè€—å¯æ§ï¼Œç‰¹åˆ«æ˜¯ç§»åŠ¨ç«¯çš„åŠŸè€—å¯æ§ï¼Œæ˜¯ DTIM å¿…é¡»é¢å¯¹çš„é—®é¢˜ã€‚åœ¨è¿™ç§è¦æ±‚ä¸‹ï¼Œå°±éœ€è¦ DTIM å°½é‡é™ä½ IO æ¬¡æ•°ï¼Œå¹¶åŸºäºä¸åŒçš„æ¶ˆæ¯ä¼˜å…ˆçº§è¿›è¡Œåˆå¹¶åŒæ­¥ï¼Œæ—¢èƒ½è¦ä¿éšœå®æ—¶æ€§ä¸è¢«ç ´åï¼Œåˆè¦åšåˆ°ä½åŠŸè€—ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;ä»ä»¥ä¸Šä¸‰ç‚¹å¯çŸ¥ï¼ŒæœåŠ¡ç«¯ä¸»åŠ¨æ¨é€çš„æ¨¡å‹æ›´é€‚åˆ DTIM åœºæ™¯ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;é¦–å…ˆå¯ä»¥åšåˆ°æä½çš„å»¶æ—¶ï¼Œä¿éšœæ¨é€è€—æ—¶åœ¨æ¯«ç§’çº§åˆ«ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;å…¶æ¬¡æ˜¯æœåŠ¡ç«¯èƒ½é€šè¿‡ç”¨æˆ·æ¥å…¥ä¿¡æ¯åˆ¤æ–­ç”¨æˆ·æ¥å…¥ç¯å¢ƒå¥½åï¼Œè¿›è¡Œå¯¹åº”çš„åˆ†åŒ…ä¼˜åŒ–ï¼Œä¿éšœå¼±ç½‘é“¾è·¯ä¸‹çš„æˆåŠŸç‡ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;æœ€åæ˜¯ä¸»åŠ¨æ¨é€ç›¸å¯¹äºæ¨æ‹‰ç»“åˆæ¥è¯´ï¼Œå¯ä»¥é™ä½ä¸€æ¬¡ IOï¼Œå¯¹ DTIM è¿™ç§æ¯åˆ†é’Ÿè¿‡äº¿æ¶ˆæ¯æœåŠ¡æ¥è¯´ï¼Œèƒ½æå¤§çš„é™ä½è®¾å¤‡åŠŸè€—ï¼ŒåŒæ—¶é…åˆæ¶ˆæ¯ä¼˜å…ˆçº§åˆå¹¶åŒ…çš„ä¼˜åŒ–ï¼Œè¿›ä¸€æ­¥é™ä½ç«¯çš„åŠŸè€—ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;span&gt;è™½è¯´ä¸»åŠ¨æ¨é€æœ‰è¯¸å¤šä¼˜åŠ¿ï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¼šç¦»çº¿ï¼Œç”šè‡³å®¢æˆ·ç«¯å¤„ç†é€Ÿåº¦æ— æ³•è·Ÿä¸ŠæœåŠ¡ç«¯çš„é€Ÿåº¦ï¼Œå¿…ç„¶å¯¼è‡´æ¶ˆæ¯å †ç§¯ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;DTIM ä¸ºäº†åè°ƒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¤„ç†èƒ½åŠ›ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œæ”¯æŒ Rebase çš„èƒ½åŠ›ï¼Œå½“æœåŠ¡ç«¯æ¶ˆæ¯å †ç§¯çš„æ¡æ•°è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶è§¦å‘ Rebaseï¼Œå®¢æˆ·ç«¯ä¼šä» DTIM æ‹‰å–æœ€æ–°çš„æ¶ˆæ¯ï¼ŒåŒæ—¶æœåŠ¡ç«¯è·³è¿‡è¿™éƒ¨åˆ†æ¶ˆæ¯ä»æœ€æ–°çš„ä½ç‚¹å¼€å§‹æ¨é€æ¶ˆæ¯ã€‚DTIM ç§°è¿™ä¸ªåŒæ­¥æ¨¡å‹ä¸ºæ¨ä¼˜å…ˆæ¨¡å‹ï¼ˆ&lt;/span&gt;&lt;span&gt;Preferentially-Push Modelï¼ŒPPM&lt;/span&gt;&lt;span&gt;ï¼‰ã€‚ï»¿&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;åœ¨åŸºäº PPM çš„æ¨é€æ–¹æ¡ˆä¸‹ï¼Œä¸ºäº†ä¿éšœæ¶ˆæ¯çš„å¯é è¾¾åˆ°ï¼ŒDTIM è¿˜åšä¸€ç³»åˆ—ä¼˜åŒ–ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;è¿™äº›ä¼˜åŒ–å…·ä½“æ˜¯ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;æ”¯æŒæ¶ˆæ¯å¯é‡å…¥&lt;/span&gt;ï¼šæœåŠ¡ç«¯å¯èƒ½ä¼šé’ˆå¯¹æŸæ¡æ¶ˆæ¯åšé‡å¤æ¨é€ï¼Œå®¢æˆ·ç«¯éœ€è¦æ ¹æ® msgId åšå»é‡å¤„ç†ï¼Œé¿å…ç«¯ä¸Šæ¶ˆæ¯é‡å¤å±•ç¤ºã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;æ”¯æŒæ¶ˆæ¯æ’åº&lt;/span&gt;ï¼šæœåŠ¡ç«¯æ¨é€æ¶ˆæ¯ç‰¹åˆ«æ˜¯ç¾¤æ¯”è¾ƒæ´»è·ƒçš„åœºæ™¯ï¼ŒæŸæ¡æ¶ˆæ¯ç”±äºæ¨é€é“¾è·¯æˆ–è€…ç«¯ä¾§ç½‘ç»œæŠ–åŠ¨ï¼Œæ¨é€å¤±è´¥ï¼Œè€Œæ–°çš„æ¶ˆæ¯æ­£å¸¸æ¨é€åˆ°ç«¯ä¾§ï¼Œå¦‚æœç«¯ä¸Šä¸åšæ¶ˆæ¯æ’åºçš„è¯ï¼Œæ¶ˆæ¯åˆ—è¡¨å°±ä¼šå‘ç”Ÿä¹±åºï¼Œæ‰€ä»¥æœåŠ¡ç«¯ä¼šä¸ºæ¯æ¡æ¶ˆæ¯åˆ†é…ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå®¢æˆ·ç«¯æ¯æ¬¡è¿›å…¥æ¶ˆæ¯åˆ—è¡¨å°±æ˜¯æ ¹æ®æ—¶é—´æˆ³åšæ’åºå†æŠ•é€’ç»™ UI å±‚åšæ¶ˆæ¯å±•ç¤ºã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;&lt;span&gt;æ”¯æŒç¼ºå¤±æ•°æ®å›è¡¥&lt;/span&gt;ï¼šåœ¨æŸä¸ªæç«¯æƒ…å†µä¸‹å®¢æˆ·ç«¯ç¾¤æ¶ˆæ¯äº‹ä»¶æ¯”ç¾¤åˆ›å»ºäº‹ä»¶æ›´æ—©åˆ°è¾¾ç«¯ä¸Šï¼Œæ­¤æ—¶ç«¯ä¸Šæ²¡æœ‰ç¾¤çš„åŸºæœ¬ä¿¡æ¯æ¶ˆæ¯ä¹Ÿå°±æ— æ³•å±•ç°ï¼Œæ‰€ä»¥éœ€è¦å®¢æˆ·ç«¯ä¸»åŠ¨å‘æœåŠ¡ç«¯æ‹‰å–ç¾¤ä¿¡æ¯åŒæ­¥åˆ°æœ¬åœ°ï¼Œå†åšæ¶ˆæ¯çš„é€å‡ºã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;4.4.2&lt;/span&gt;å¤šç«¯æ•°æ®ä¸€è‡´æ€§&lt;/h3&gt;&lt;p&gt;&lt;br/&gt;&lt;span&gt;å¤šç«¯æ•°æ®ä¸€è‡´æ€§é—®é¢˜ä¸€ç›´æ˜¯å¤šç«¯åŒæ­¥æœ€æ ¸å¿ƒçš„é—®é¢˜ï¼Œå•ä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶åœ¨ PCã€Pad ä»¥åŠ Mobile ç™»å½•ï¼Œæ¶ˆæ¯ã€ä¼šè¯çº¢ç‚¹ç­‰çŠ¶æ€éœ€è¦åœ¨å¤šç«¯ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”ç”¨æˆ·æ›´æ¢è®¾å¤‡æƒ…å†µä¸‹æ¶ˆæ¯å¯ä»¥åšå…¨é‡çš„å›æº¯ã€‚ï»¿&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;åŸºäºä¸Šé¢çš„ä¸šåŠ¡è¯‰æ±‚ä»¥åŠç³»ç»Ÿå±‚é¢é¢ä¸´çš„è¯¸å¤šæŒ‘æˆ˜ï¼Œé’‰é’‰è‡ªç ”äº†åŒæ­¥æœåŠ¡æ¥è§£å†³ä¸€è‡´æ€§é—®é¢˜ã€‚&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;strong&gt;é’‰é’‰çš„åŒæ­¥æœåŠ¡çš„è®¾è®¡ç†å¿µå’ŒåŸåˆ™å¦‚ä¸‹ï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;1ï¼‰&lt;/strong&gt;&lt;/em&gt;ç»Ÿä¸€æ¶ˆæ¯æ¨¡å‹æŠ½è±¡ï¼Œå¯¹äº DTIM æœåŠ¡äº§ç”Ÿçš„æ–°æ¶ˆæ¯ä»¥åŠå·²è¯»äº‹ä»¶ã€ä¼šè¯å¢åˆ æ”¹ã€å¤šç«¯çº¢ç‚¹æ¸…é™¤ç­‰äº‹ä»¶ç»Ÿä¸€æŠ½è±¡ä¸ºåŒæ­¥æœåŠ¡çš„äº‹ä»¶ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;2ï¼‰&lt;/strong&gt;&lt;/em&gt;åŒæ­¥æœåŠ¡ä¸æ„ŸçŸ¥äº‹ä»¶çš„ç±»å‹ä»¥åŠæ•°æ®åºåˆ—åŒ–æ–¹å¼ã€‚åŒæ­¥æœåŠ¡ä¸ºæ¯ä¸ªç”¨æˆ·çš„äº‹ä»¶åˆ†é…ä¸€ä¸ªè‡ªå¢çš„ IDï¼ˆæ³¨ï¼šè¿™é‡Œéè¿ç»­é€’å¢ï¼‰ï¼Œç¡®ä¿æ¶ˆæ¯å¯ä»¥æ ¹æ® ID åšéå†çš„æœ‰åºæŸ¥è¯¢ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;3ï¼‰&lt;/strong&gt;&lt;/em&gt;ç»Ÿä¸€åŒæ­¥é˜Ÿåˆ—ï¼ŒåŒæ­¥æœåŠ¡ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…äº†ä¸€ä¸ª FIFO çš„é˜Ÿåˆ—å­˜å‚¨ï¼Œè‡ªå¢ id å’Œäº‹ä»¶ä¸²è¡Œå†™å…¥é˜Ÿåˆ—ï¼›å½“æœ‰äº‹ä»¶æ¨é€æ—¶ï¼ŒæœåŠ¡ç«¯æ ¹æ®ç”¨æˆ·å½“å‰å„ç«¯åœ¨çº¿è®¾å¤‡çŠ¶æ€åšå¢é‡å˜æ›´ï¼Œå°†å¢é‡äº‹ä»¶æ¨é€åˆ°å„ç«¯ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;em&gt;&lt;strong&gt;4ï¼‰&lt;/strong&gt;&lt;/em&gt;æ ¹æ®è®¾å¤‡å’Œç½‘ç»œè´¨é‡çš„ä¸åŒå¯ä»¥åšå¤šç§åˆ†åŒ…æ¨é€ç­–ç•¥ï¼Œç¡®ä¿æ¶ˆæ¯å¯ä»¥æœ‰åºã€å¯é ã€é«˜æ•ˆçš„å‘é€ç»™å®¢æˆ·ç«¯ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;ä¸Šé¢ä»‹ç»äº† DTIM çš„å­˜å‚¨æ¨¡å‹ä»¥åŠåŒæ­¥æ¨¡å‹çš„è®¾è®¡ä¸æ€è€ƒï¼š&lt;/strong&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2&gt;äº”ã€ç›¸å…³èµ„æ–™&lt;/h2&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[1]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¼ä¸šçº§IMç‹è€…â€”â€”é’‰é’‰åœ¨åç«¯æ¶æ„ä¸Šçš„è¿‡äººä¹‹å¤„&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-2848-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[2]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ç°ä»£IMç³»ç»Ÿä¸­èŠå¤©æ¶ˆæ¯çš„åŒæ­¥å’Œå­˜å‚¨æ–¹æ¡ˆæ¢è®¨&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-1230-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[3]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; é’‰é’‰â€”â€”åŸºäºIMæŠ€æœ¯çš„æ–°ä¸€ä»£ä¼ä¸šOAå¹³å°çš„æŠ€æœ¯æŒ‘æˆ˜(è§†é¢‘+PPT)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-527-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[4]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¸€å¥—äº¿çº§ç”¨æˆ·çš„IMæ¶æ„æŠ€æœ¯å¹²è´§(ä¸Šç¯‡)ï¼šæ•´ä½“æ¶æ„ã€æœåŠ¡æ‹†åˆ†ç­‰&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-3393-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[5]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¸€å¥—äº¿çº§ç”¨æˆ·çš„IMæ¶æ„æŠ€æœ¯å¹²è´§(ä¸‹ç¯‡)ï¼šå¯é æ€§ã€æœ‰åºæ€§ã€å¼±ç½‘ä¼˜åŒ–ç­‰&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-3445-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[6]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä»æ–°æ‰‹åˆ°ä¸“å®¶ï¼šå¦‚ä½•è®¾è®¡ä¸€å¥—äº¿çº§æ¶ˆæ¯é‡çš„åˆ†å¸ƒå¼IMç³»ç»Ÿ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-3472-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[7]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¼ä¸šå¾®ä¿¡çš„IMæ¶æ„è®¾è®¡æ­ç§˜ï¼šæ¶ˆæ¯æ¨¡å‹ã€ä¸‡äººç¾¤ã€å·²è¯»å›æ‰§ã€æ¶ˆæ¯æ’¤å›ç­‰&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-3631-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[8]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; å…¨é¢æ­ç§˜äº¿çº§IMæ¶ˆæ¯çš„å¯é æŠ•é€’æœºåˆ¶&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-3638-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[9]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¸€å¥—é«˜å¯ç”¨ã€æ˜“ä¼¸ç¼©ã€é«˜å¹¶å‘çš„IMç¾¤èŠã€å•èŠæ¶æ„æ–¹æ¡ˆè®¾è®¡å®è·µ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-2015-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[10]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¸€å¥—æµ·é‡åœ¨çº¿ç”¨æˆ·çš„ç§»åŠ¨ç«¯IMæ¶æ„è®¾è®¡å®è·µåˆ†äº«(å«è¯¦ç»†å›¾æ–‡)&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-812-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;[11]&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; ä¸€å¥—åŸåˆ›åˆ†å¸ƒå¼å³æ—¶é€šè®¯(IM)ç³»ç»Ÿç†è®ºæ¶æ„æ–¹æ¡ˆ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;http://www.52im.net/thread-151-1-1.html&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h2&gt;å…­ã€å…¨æ–‡é“¾æ¥&lt;/h2&gt;&lt;p&gt;&lt;span&gt;å³æ—¶é€šè®¯ç½‘(52im.net)&lt;/span&gt;&lt;span&gt;&lt;span&gt;ç¤¾åŒºé“¾æ¥ï¼š&lt;/span&gt;&lt;span&gt;http://www.52im.net/thread-4012-1-1.html&lt;/span&gt;&lt;span&gt;ï¼Œæˆ–ç‚¹å‡»ä¸‹æ–‡çš„â€œ&lt;/span&gt;&lt;span&gt;&lt;strong&gt;é˜…è¯»åŸæ–‡&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;â€ï¼&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>6894b0f486d7d654c4c6bd2e48028fb2</guid>
<title>æœ€å¼ºåˆ†å¸ƒå¼é”å·¥å…·ï¼šRedisson</title>
<link>https://toutiao.io/k/v9di3a4</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;pre&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åŸæ–‡ï¼šjuejin.cn/post/6961380552519712798&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»Šå¤©æ¥èŠèŠåˆ†å¸ƒå¼é”çš„æœ€å¼ºå®ç°ï¼š&lt;strong&gt;Redisson&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»åˆ†å¸ƒå¼é”åˆ°Redissonå®ç°éå¸¸è¯¦ç»†ï¼Œé€‚åˆæ…¢æ…¢å’€åš¼~&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1. Redissonæ¦‚è¿°&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;strong&gt;ä»€ä¹ˆæ˜¯Redissonï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissonæ˜¯ä¸€ä¸ªåœ¨Redisçš„åŸºç¡€ä¸Šå®ç°çš„Javaé©»å†…å­˜æ•°æ®ç½‘æ ¼ï¼ˆIn-Memory Data Gridï¼‰ã€‚å®ƒä¸ä»…æä¾›äº†ä¸€ç³»åˆ—çš„åˆ†å¸ƒå¼çš„Javaå¸¸ç”¨å¯¹è±¡ï¼Œè¿˜æä¾›äº†è®¸å¤šåˆ†å¸ƒå¼æœåŠ¡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissonçš„å®—æ—¨æ˜¯ä¿ƒè¿›ä½¿ç”¨è€…å¯¹Redisçš„å…³æ³¨åˆ†ç¦»ï¼ˆSeparation of Concernï¼‰ï¼Œä»è€Œè®©ä½¿ç”¨è€…èƒ½å¤Ÿå°†ç²¾åŠ›æ›´é›†ä¸­åœ°æ”¾åœ¨å¤„ç†ä¸šåŠ¡é€»è¾‘ä¸Šã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ä¸€ä¸ªåŸºäºRediså®ç°çš„åˆ†å¸ƒå¼å·¥å…·ï¼Œæœ‰åŸºæœ¬åˆ†å¸ƒå¼å¯¹è±¡å’Œé«˜çº§åˆæŠ½è±¡çš„åˆ†å¸ƒå¼æœåŠ¡ï¼Œä¸ºæ¯ä¸ªè¯•å›¾å†é€ åˆ†å¸ƒå¼è½®å­çš„ç¨‹åºå‘˜å¸¦æ¥äº†å¤§éƒ¨åˆ†åˆ†å¸ƒå¼é—®é¢˜çš„è§£å†³åŠæ³•ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;Redissonå’ŒJedisã€Lettuceæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå€’ä¹Ÿä¸æ˜¯é›·é”‹å’Œé›·é”‹å¡”&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissonå’Œå®ƒä¿©çš„åŒºåˆ«å°±åƒä¸€ä¸ªç”¨é¼ æ ‡æ“ä½œå›¾å½¢åŒ–ç•Œé¢ï¼Œä¸€ä¸ªç”¨å‘½ä»¤è¡Œæ“ä½œæ–‡ä»¶ã€‚Redissonæ˜¯æ›´é«˜å±‚çš„æŠ½è±¡ï¼ŒJediså’ŒLettuceæ˜¯Rediså‘½ä»¤çš„å°è£…ã€‚&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;Jedisæ˜¯Rediså®˜æ–¹æ¨å‡ºçš„ç”¨äºé€šè¿‡Javaè¿æ¥Rediså®¢æˆ·ç«¯çš„ä¸€ä¸ªå·¥å…·åŒ…ï¼Œæä¾›äº†Redisçš„å„ç§å‘½ä»¤æ”¯æŒ&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Lettuceæ˜¯ä¸€ç§å¯æ‰©å±•çš„çº¿ç¨‹å®‰å…¨çš„ Redis å®¢æˆ·ç«¯ï¼Œé€šè®¯æ¡†æ¶åŸºäºNettyï¼Œæ”¯æŒé«˜çº§çš„ Redis ç‰¹æ€§ï¼Œæ¯”å¦‚å“¨å…µï¼Œé›†ç¾¤ï¼Œç®¡é“ï¼Œè‡ªåŠ¨é‡æ–°è¿æ¥å’ŒRedisæ•°æ®æ¨¡å‹ã€‚Spring Boot 2.x å¼€å§‹ Lettuce å·²å–ä»£ Jedis æˆä¸ºé¦–é€‰ Redis çš„å®¢æˆ·ç«¯ã€‚&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Redissonæ˜¯æ¶è®¾åœ¨RedisåŸºç¡€ä¸Šï¼Œé€šè®¯åŸºäºNettyçš„ç»¼åˆçš„ã€æ–°å‹çš„ä¸­é—´ä»¶ï¼Œä¼ä¸šçº§å¼€å‘ä¸­ä½¿ç”¨Redisçš„æœ€ä½³èŒƒæœ¬&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;JedisæŠŠRediså‘½ä»¤å°è£…å¥½ï¼ŒLettuceåˆ™è¿›ä¸€æ­¥æœ‰äº†æ›´ä¸°å¯Œçš„Apiï¼Œä¹Ÿæ”¯æŒé›†ç¾¤ç­‰æ¨¡å¼ã€‚ä½†æ˜¯ä¸¤è€…ä¹Ÿéƒ½ç‚¹åˆ°ä¸ºæ­¢ï¼Œåªç»™äº†ä½ æ“ä½œRedisæ•°æ®åº“çš„è„šæ‰‹æ¶ï¼Œè€ŒRedissonåˆ™æ˜¯åŸºäºRedisã€Luaå’ŒNettyå»ºç«‹èµ·äº†æˆç†Ÿçš„åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆï¼Œç”šè‡³rediså®˜æ–¹éƒ½æ¨èçš„ä¸€ç§å·¥å…·é›†ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2. åˆ†å¸ƒå¼é”&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;strong&gt;åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°ï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åˆ†å¸ƒå¼é”æ˜¯å¹¶å‘ä¸šåŠ¡ä¸‹çš„åˆšéœ€ï¼Œè™½ç„¶å®ç°äº”èŠ±å…«é—¨ï¼šZooKeeperæœ‰Znodeé¡ºåºèŠ‚ç‚¹ï¼Œæ•°æ®åº“æœ‰è¡¨çº§é”å’Œä¹/æ‚²è§‚é”ï¼ŒRedisæœ‰setNxï¼Œä½†æ˜¯æ®Šé€”åŒå½’ï¼Œæœ€ç»ˆè¿˜æ˜¯è¦å›åˆ°äº’æ–¥ä¸Šæ¥ï¼Œæœ¬ç¯‡ä»‹ç»Redissonï¼Œé‚£å°±ä»¥redisä¸ºä¾‹ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;strong&gt;æ€ä¹ˆå†™ä¸€ä¸ªç®€å•çš„Redisåˆ†å¸ƒå¼é”ï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥Spring Data Redisä¸ºä¾‹ï¼Œç”¨RedisTemplateæ¥æ“ä½œRedisï¼ˆsetIfAbsentå·²ç»æ˜¯setNx + expireçš„åˆå¹¶å‘½ä»¤ï¼‰ï¼Œå¦‚ä¸‹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â åŠ é”&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â BooleanÂ &lt;span&gt;tryLock&lt;/span&gt;&lt;span&gt;(StringÂ key,Â StringÂ value,Â &lt;span&gt;long&lt;/span&gt;Â timeout,Â TimeUnitÂ unit)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â redisTemplate.opsForValue().setIfAbsent(key,Â value,Â timeout,Â unit);&lt;br/&gt;}&lt;br/&gt;&lt;span&gt;//Â è§£é”ï¼Œé˜²æ­¢åˆ é”™åˆ«äººçš„é”ï¼Œä»¥uuidä¸ºvalueæ ¡éªŒæ˜¯å¦è‡ªå·±çš„é”&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;unlock&lt;/span&gt;&lt;span&gt;(StringÂ lockName,Â StringÂ uuid)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;(uuid.equals(redisTemplate.opsForValue().get(lockName)){Â Â Â Â Â Â Â Â redisTemplate.opsForValue().del(lockName);Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â ç»“æ„&lt;/span&gt;&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;(tryLock){&lt;br/&gt;Â Â Â Â &lt;span&gt;//Â todo&lt;/span&gt;&lt;br/&gt;}&lt;span&gt;finally&lt;/span&gt;{&lt;br/&gt;Â Â Â Â unlock;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç®€å•1.0ç‰ˆæœ¬å®Œæˆï¼Œèªæ˜çš„å°å¼ ä¸€çœ¼çœ‹å‡ºï¼Œè¿™æ˜¯é”æ²¡é”™ï¼Œä½†getå’Œdelæ“ä½œéåŸå­æ€§ï¼Œå¹¶å‘ä¸€æ—¦å¤§äº†ï¼Œæ— æ³•ä¿è¯è¿›ç¨‹å®‰å…¨ã€‚äºæ˜¯å°å¼ æè®®ï¼Œç”¨Luaè„šæœ¬&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;strong&gt;Luaè„šæœ¬æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Luaè„šæœ¬æ˜¯rediså·²ç»å†…ç½®çš„ä¸€ç§è½»é‡å°å·§è¯­è¨€ï¼Œå…¶æ‰§è¡Œæ˜¯é€šè¿‡redisçš„&lt;strong&gt;eval&lt;/strong&gt; /&lt;strong&gt;evalsha&lt;/strong&gt; å‘½ä»¤æ¥è¿è¡Œï¼ŒæŠŠæ“ä½œå°è£…æˆä¸€ä¸ªLuaè„šæœ¬ï¼Œå¦‚è®ºå¦‚ä½•éƒ½æ˜¯ä¸€æ¬¡æ‰§è¡Œçš„åŸå­æ“ä½œã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;äºæ˜¯2.0ç‰ˆæœ¬é€šè¿‡Luaè„šæœ¬åˆ é™¤&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;lockDel.luaå¦‚ä¸‹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;if&lt;/span&gt;Â redis.call(&lt;span&gt;&#x27;get&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;])Â ==Â ARGV[&lt;span&gt;1&lt;/span&gt;]Â &lt;br/&gt;Â Â Â Â thenÂ &lt;br/&gt;Â --Â æ‰§è¡Œåˆ é™¤æ“ä½œ&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â redis.call(&lt;span&gt;&#x27;del&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;])Â &lt;br/&gt;Â Â Â Â &lt;span&gt;else&lt;/span&gt;Â &lt;br/&gt;Â --Â ä¸æˆåŠŸï¼Œè¿”å›&lt;span&gt;0&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;0&lt;/span&gt;Â &lt;br/&gt;end&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;deleteæ“ä½œæ—¶æ‰§è¡ŒLuaå‘½ä»¤&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â è§£é”è„šæœ¬&lt;/span&gt;&lt;br/&gt;DefaultRedisScript&amp;lt;Object&amp;gt;Â unlockScriptÂ =Â &lt;span&gt;new&lt;/span&gt;Â DefaultRedisScript();&lt;br/&gt;unlockScript.setScriptSource(&lt;span&gt;new&lt;/span&gt;Â ResourceScriptSource(&lt;span&gt;new&lt;/span&gt;Â ClassPathResource(&lt;span&gt;&quot;lockDel.lua&quot;&lt;/span&gt;)));&lt;br/&gt;&lt;br/&gt;&lt;span&gt;//Â æ‰§è¡Œluaè„šæœ¬è§£é”&lt;/span&gt;&lt;br/&gt;redisTemplate.execute(unlockScript,Â Collections.singletonList(keyName),Â value);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;2.0ä¼¼ä¹æ›´åƒä¸€æŠŠé”ï¼Œä½†å¥½åƒåˆç¼ºå°‘äº†ä»€ä¹ˆï¼Œå°å¼ ä¸€æ‹è„‘è¢‹ï¼Œsynchronizedå’ŒReentrantLockéƒ½å¾ˆä¸æ»‘ï¼Œå› ä¸ºä»–ä»¬éƒ½æ˜¯å¯é‡å…¥é”ï¼Œä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡æ‹¿é”ä¹Ÿä¸ä¼šæ­»é”ï¼Œæˆ‘ä»¬éœ€è¦å¯é‡å…¥ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;&lt;strong&gt;æ€ä¹ˆä¿è¯å¯é‡å…¥ï¼Ÿ&lt;/strong&gt;&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‡å…¥å°±æ˜¯ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–åŒä¸€æŠŠé”æ˜¯å…è®¸çš„ï¼Œä¸ä¼šé€ æˆæ­»é”ï¼Œè¿™ä¸€ç‚¹synchronizedåå‘é”æä¾›äº†å¾ˆå¥½çš„æ€è·¯ï¼Œsynchronizedçš„å®ç°é‡å…¥æ˜¯åœ¨JVMå±‚é¢ï¼ŒJAVAå¯¹è±¡å¤´MARK WORDä¸­ä¾¿è—æœ‰çº¿ç¨‹IDå’Œè®¡æ•°å™¨æ¥å¯¹å½“å‰çº¿ç¨‹åšé‡å…¥åˆ¤æ–­ï¼Œé¿å…æ¯æ¬¡CASã€‚&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—å¹¶è·å–é”æ—¶ï¼Œä¼šåœ¨å¯¹è±¡å¤´å’Œæ ˆå¸§ä¸­çš„é”è®°å½•é‡Œå­˜å‚¨åå‘çš„çº¿ç¨‹IDï¼Œä»¥åè¯¥çº¿ç¨‹åœ¨è¿›å…¥å’Œé€€å‡ºåŒæ­¥å—æ—¶ä¸éœ€è¦è¿›è¡ŒCASæ“ä½œæ¥åŠ é”å’Œè§£é”ï¼Œåªéœ€ç®€å•æµ‹è¯•ä¸€ä¸‹å¯¹è±¡å¤´çš„Mark Wordé‡Œæ˜¯å¦å­˜å‚¨ç€æŒ‡å‘å½“å‰çº¿ç¨‹çš„åå‘é”ã€‚å¦‚æœæµ‹è¯•æˆåŠŸï¼Œè¡¨ç¤ºçº¿ç¨‹å·²ç»è·å¾—äº†é”ã€‚å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œåˆ™éœ€è¦å†æµ‹è¯•ä¸€ä¸‹Mark Wordä¸­åå‘é”æ ‡å¿—æ˜¯å¦è®¾ç½®æˆ1ï¼šæ²¡æœ‰åˆ™CASç«äº‰ï¼›è®¾ç½®äº†ï¼Œåˆ™CASå°†å¯¹è±¡å¤´åå‘é”æŒ‡å‘å½“å‰çº¿ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;å†ç»´æŠ¤ä¸€ä¸ªè®¡æ•°å™¨ï¼ŒåŒä¸ªçº¿ç¨‹è¿›å…¥åˆ™è‡ªå¢1ï¼Œç¦»å¼€å†å‡1ï¼Œç›´åˆ°ä¸º0æ‰èƒ½é‡Šæ”¾&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;å¯é‡å…¥é”&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¿é€ è¯¥æ–¹æ¡ˆï¼Œæˆ‘ä»¬éœ€æ”¹é€ Luaè„šæœ¬ï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;1.éœ€è¦å­˜å‚¨ é”åç§°&lt;strong&gt;lockName&lt;/strong&gt; ã€è·å¾—è¯¥é”çš„&lt;strong&gt;çº¿ç¨‹id&lt;/strong&gt; å’Œå¯¹åº”çº¿ç¨‹çš„&lt;strong&gt;è¿›å…¥æ¬¡æ•°count&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;2.åŠ é”&lt;/p&gt;&lt;p&gt;æ¯æ¬¡çº¿ç¨‹è·å–é”æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨è¯¥é”&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;ä¸å­˜åœ¨&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;è®¾ç½®hashçš„keyä¸ºçº¿ç¨‹idï¼Œvalueåˆå§‹åŒ–ä¸º1&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;è®¾ç½®è¿‡æœŸæ—¶é—´&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;è¿”å›è·å–é”æˆåŠŸtrue&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å­˜åœ¨&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ç»§ç»­åˆ¤æ–­æ˜¯å¦å­˜åœ¨å½“å‰çº¿ç¨‹idçš„hash key&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å­˜åœ¨ï¼Œçº¿ç¨‹keyçš„value + 1ï¼Œé‡å…¥æ¬¡æ•°å¢åŠ 1ï¼Œè®¾ç½®è¿‡æœŸæ—¶é—´&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ä¸å­˜åœ¨ï¼Œè¿”å›åŠ é”å¤±è´¥&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;3.è§£é”&lt;/p&gt;&lt;p&gt;æ¯æ¬¡çº¿ç¨‹æ¥è§£é”æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦å·²å­˜åœ¨è¯¥é”&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;å­˜åœ¨&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ˜¯å¦æœ‰è¯¥çº¿ç¨‹çš„idçš„hash keyï¼Œæœ‰åˆ™å‡1ï¼Œæ— åˆ™è¿”å›è§£é”å¤±è´¥&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å‡1åï¼Œåˆ¤æ–­å‰©ä½™countæ˜¯å¦ä¸º0ï¼Œä¸º0åˆ™è¯´æ˜ä¸å†éœ€è¦è¿™æŠŠé”ï¼Œæ‰§è¡Œdelå‘½ä»¤åˆ é™¤&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;1.å­˜å‚¨ç»“æ„&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†æ–¹ä¾¿ç»´æŠ¤è¿™ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬ç”¨Hashç»“æ„æ¥å­˜å‚¨è¿™äº›å­—æ®µã€‚Redisçš„Hashç±»ä¼¼Javaçš„HashMapï¼Œé€‚åˆå­˜å‚¨å¯¹è±¡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.515625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/JfTPiahTHJhovmibd98agRTiamZFNibribDoFHZwGZ0fzwuYibicwTHO8aZT9UgPAOiblOwiaRtLLMhZT7WkVI8XR8LIRPw/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&amp;amp;random=0.4520806851381116&quot; data-w=&quot;640&quot;/&gt;å›¾ç‰‡&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;hsetÂ lockname1Â threadIdÂ &lt;span&gt;1&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è®¾ç½®ä¸€ä¸ªåå­—ä¸º&lt;strong&gt;lockname1&lt;/strong&gt; çš„hashç»“æ„ï¼Œè¯¥hashç»“æ„keyä¸º&lt;strong&gt;threadId&lt;/strong&gt; ï¼Œå€¼valueä¸º&lt;strong&gt;1&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;hgetÂ lockname1Â threadId&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è·å–lockname1çš„threadIdçš„å€¼&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å­˜å‚¨ç»“æ„ä¸º&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;locknameÂ é”åç§°&lt;br/&gt;Â Â Â  key1ï¼šÂ Â  threadId Â Â å”¯ä¸€é”®ï¼Œçº¿ç¨‹id&lt;br/&gt;Â Â Â  value1ï¼šÂ  count Â Â Â Â è®¡æ•°å™¨ï¼Œè®°å½•è¯¥çº¿ç¨‹è·å–é”çš„æ¬¡æ•°&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;redisä¸­çš„ç»“æ„&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3371104815864023&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zQlJibwibtLoeUTxT9icas31E0eRtgpw0NfPia9xfibOFKE9aFUPqpuf93Lg/640?wx_fmt=other&amp;amp;random=0.1390218909689791&quot; data-type=&quot;other&quot; data-w=&quot;1412&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;2.è®¡æ•°å™¨çš„åŠ å‡&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“åŒä¸€ä¸ªçº¿ç¨‹è·å–åŒä¸€æŠŠé”æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å¯¹åº”çº¿ç¨‹çš„è®¡æ•°å™¨countåšåŠ å‡&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åˆ¤æ–­ä¸€ä¸ªredis keyæ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥ç”¨&lt;code&gt;exists&lt;/code&gt;ï¼Œè€Œåˆ¤æ–­ä¸€ä¸ªhashçš„keyæ˜¯å¦å­˜åœ¨ï¼Œå¯ä»¥ç”¨&lt;code&gt;hexists&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6464968152866242&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zgX7xHxGSKv0eOJfKHfFoSIpqRvsceIYruDc7ibYgOmgtpDmLrteU5Ig/640?wx_fmt=other&amp;amp;random=0.5893847106639996&quot; data-type=&quot;other&quot; data-w=&quot;628&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œredisä¹Ÿæœ‰hashè‡ªå¢çš„å‘½ä»¤&lt;code&gt;hincrby&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¯æ¬¡è‡ªå¢1æ—¶ &lt;code&gt;hincrby lockname1 threadId 1&lt;/code&gt;ï¼Œè‡ªå‡1æ—¶ &lt;code&gt;hincrby lockname1 threadId -1&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2139917695473251&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zj7H1X1eNDBXibBGkhYHIk9ccbJSwolJ8xoJJ8Fg5PzccIIu2ibYr5EJg/640?wx_fmt=other&amp;amp;random=0.05510636950966741&quot; data-type=&quot;other&quot; data-w=&quot;486&quot;/&gt;&lt;/figure&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;3.è§£é”çš„åˆ¤æ–­&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“ä¸€æŠŠé”ä¸å†è¢«éœ€è¦äº†ï¼Œæ¯æ¬¡è§£é”ä¸€æ¬¡ï¼Œcountå‡1ï¼Œç›´åˆ°ä¸º0æ—¶ï¼Œæ‰§è¡Œåˆ é™¤&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»¼åˆä¸Šè¿°çš„å­˜å‚¨ç»“æ„å’Œåˆ¤æ–­æµç¨‹ï¼ŒåŠ é”å’Œè§£é”Luaå¦‚ä¸‹&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŠ é” lock.lua&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;localÂ keyÂ =Â KEYS[&lt;span&gt;1&lt;/span&gt;];&lt;br/&gt;localÂ threadIdÂ =Â ARGV[&lt;span&gt;1&lt;/span&gt;];&lt;br/&gt;localÂ releaseTimeÂ =Â ARGV[&lt;span&gt;2&lt;/span&gt;];&lt;br/&gt;&lt;br/&gt;--Â locknameä¸å­˜åœ¨&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;(redis.call(&lt;span&gt;&#x27;exists&#x27;&lt;/span&gt;,Â key)Â ==Â &lt;span&gt;0&lt;/span&gt;)Â then&lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;hset&#x27;&lt;/span&gt;,Â key,Â threadId,Â &lt;span&gt;&#x27;1&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;expire&#x27;&lt;/span&gt;,Â key,Â releaseTime);&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â å½“å‰çº¿ç¨‹å·²idå­˜åœ¨&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;(redis.call(&lt;span&gt;&#x27;hexists&#x27;&lt;/span&gt;,Â key,Â threadId)Â ==Â &lt;span&gt;1&lt;/span&gt;)Â then&lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;hincrby&#x27;&lt;/span&gt;,Â key,Â threadId,Â &lt;span&gt;&#x27;1&#x27;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;expire&#x27;&lt;/span&gt;,Â key,Â releaseTime);&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;end;&lt;br/&gt;&lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è§£é” unlock.lua&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;localÂ keyÂ =Â KEYS[&lt;span&gt;1&lt;/span&gt;];&lt;br/&gt;localÂ threadIdÂ =Â ARGV[&lt;span&gt;1&lt;/span&gt;];&lt;br/&gt;&lt;br/&gt;--Â locknameã€threadIdä¸å­˜åœ¨&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â (redis.call(&lt;span&gt;&#x27;hexists&#x27;&lt;/span&gt;,Â key,Â threadId)Â ==Â &lt;span&gt;0&lt;/span&gt;)Â then&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â nil;&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â è®¡æ•°å™¨-&lt;span&gt;1&lt;/span&gt;&lt;br/&gt;localÂ countÂ =Â redis.call(&lt;span&gt;&#x27;hincrby&#x27;&lt;/span&gt;,Â key,Â threadId,Â -&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;&lt;br/&gt;--Â åˆ é™¤&lt;span&gt;lock&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â &lt;span&gt;(countÂ ==Â &lt;span&gt;0&lt;/span&gt;)&lt;/span&gt;Â then&lt;br/&gt;Â Â Â Â redis.&lt;span&gt;call&lt;/span&gt;&lt;span&gt;(&lt;span&gt;&#x27;del&#x27;&lt;/span&gt;,Â key)&lt;/span&gt;&lt;/span&gt;;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â nil;&lt;br/&gt;end;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»£ç &lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt;Â *Â &lt;span&gt;@description&lt;/span&gt;Â åŸç”Ÿrediså®ç°åˆ†å¸ƒå¼é”&lt;br/&gt;Â **/&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Getter&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@Setter&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;RedisLock&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â RedisTemplateÂ redisTemplate;&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â DefaultRedisScript&amp;lt;Long&amp;gt;Â lockScript;&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â DefaultRedisScript&amp;lt;Object&amp;gt;Â unlockScript;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;RedisLock&lt;/span&gt;&lt;span&gt;(RedisTemplateÂ redisTemplate)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.redisTemplateÂ =Â redisTemplate;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â åŠ è½½åŠ é”çš„è„šæœ¬&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â lockScriptÂ =Â &lt;span&gt;new&lt;/span&gt;Â DefaultRedisScript&amp;lt;&amp;gt;();&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.lockScript.setScriptSource(&lt;span&gt;new&lt;/span&gt;Â ResourceScriptSource(&lt;span&gt;new&lt;/span&gt;Â ClassPathResource(&lt;span&gt;&quot;lock.lua&quot;&lt;/span&gt;)));&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.lockScript.setResultType(Long&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;)&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â åŠ è½½é‡Šæ”¾é”çš„è„šæœ¬&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â unlockScriptÂ =Â &lt;span&gt;new&lt;/span&gt;Â DefaultRedisScript&amp;lt;&amp;gt;();&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.unlockScript.setScriptSource(&lt;span&gt;new&lt;/span&gt;Â ResourceScriptSource(&lt;span&gt;new&lt;/span&gt;Â ClassPathResource(&lt;span&gt;&quot;unlock.lua&quot;&lt;/span&gt;)));&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;/**&lt;br/&gt;Â Â Â Â Â *Â è·å–é”&lt;br/&gt;Â Â Â Â Â */&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â StringÂ &lt;span&gt;tryLock&lt;/span&gt;&lt;span&gt;(StringÂ lockName,Â &lt;span&gt;long&lt;/span&gt;Â releaseTime)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â å­˜å…¥çš„çº¿ç¨‹ä¿¡æ¯çš„å‰ç¼€&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â StringÂ keyÂ =Â UUID.randomUUID().toString();&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â æ‰§è¡Œè„šæœ¬&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â LongÂ resultÂ =Â (Long)Â redisTemplate.execute(&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lockScript,&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Collections.singletonList(lockName),&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â keyÂ +Â Thread.currentThread().getId(),&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â releaseTime);&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (resultÂ !=Â &lt;span&gt;null&lt;/span&gt;Â &amp;amp;&amp;amp;Â result.intValue()Â ==Â &lt;span&gt;1&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â key;&lt;br/&gt;Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;null&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;/**&lt;br/&gt;Â Â Â Â Â *Â è§£é”&lt;br/&gt;Â Â Â Â Â *Â &lt;span&gt;@param&lt;/span&gt;Â lockName&lt;br/&gt;Â Â Â Â Â *Â &lt;span&gt;@param&lt;/span&gt;Â key&lt;br/&gt;Â Â Â Â Â */&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;unlock&lt;/span&gt;&lt;span&gt;(StringÂ lockName,Â StringÂ key)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â redisTemplate.execute(unlockScript,&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Collections.singletonList(lockName),&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â keyÂ +Â Thread.currentThread().getId()&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â );&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è‡³æ­¤å·²ç»å®Œæˆäº†ä¸€æŠŠåˆ†å¸ƒå¼é”ï¼Œç¬¦åˆäº’æ–¥ã€å¯é‡å…¥ã€é˜²æ­»é”çš„åŸºæœ¬ç‰¹ç‚¹ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸¥è°¨çš„å°å¼ è§‰å¾—è™½ç„¶å½“ä¸ªæ™®é€šäº’æ–¥é”ï¼Œå·²ç»ç¨³ç¨³å¤Ÿç”¨ï¼Œå¯æ˜¯ä¸šåŠ¡é‡Œæ€»æ˜¯åˆå¾ˆå¤šç‰¹æ®Šæƒ…å†µçš„ï¼Œ&lt;strong&gt;æ¯”å¦‚Aè¿›ç¨‹åœ¨è·å–åˆ°é”çš„æ—¶å€™ï¼Œå› ä¸šåŠ¡æ“ä½œæ—¶é—´å¤ªé•¿ï¼Œé”é‡Šæ”¾äº†ä½†æ˜¯ä¸šåŠ¡è¿˜åœ¨æ‰§è¡Œï¼Œè€Œæ­¤åˆ»Bè¿›ç¨‹åˆå¯ä»¥æ­£å¸¸æ‹¿åˆ°é”åšä¸šåŠ¡æ“ä½œï¼Œä¸¤ä¸ªè¿›ç¨‹æ“ä½œå°±ä¼šå­˜åœ¨ä¾æ—§æœ‰å…±äº«èµ„æºçš„é—®é¢˜&lt;/strong&gt; ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œä¸”å¦‚æœè´Ÿè´£å‚¨å­˜è¿™ä¸ªåˆ†å¸ƒå¼é”çš„&lt;strong&gt;RedisèŠ‚ç‚¹å®•æœºä»¥åï¼Œè€Œä¸”è¿™ä¸ªé”æ­£å¥½å¤„äºé”ä½çš„çŠ¶æ€æ—¶ï¼Œè¿™ä¸ªé”ä¼šå‡ºç°é”æ­»çš„çŠ¶æ€&lt;/strong&gt; ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°å¼ ä¸æ˜¯æ ç²¾ï¼Œå› ä¸ºåº“å­˜æ“ä½œæ€»æœ‰è¿™æ ·é‚£æ ·çš„ç‰¹æ®Šã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›åœ¨è¿™ç§æƒ…å†µæ—¶ï¼Œå¯ä»¥å»¶é•¿é”çš„releaseTimeå»¶è¿Ÿé‡Šæ”¾é”æ¥ç›´åˆ°å®Œæˆä¸šåŠ¡æœŸæœ›ç»“æœï¼Œè¿™ç§ä¸æ–­å»¶é•¿é”è¿‡æœŸæ—¶é—´æ¥ä¿è¯ä¸šåŠ¡æ‰§è¡Œå®Œæˆçš„æ“ä½œå°±æ˜¯é”ç»­çº¦ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯»å†™åˆ†ç¦»ä¹Ÿæ˜¯å¸¸è§ï¼Œä¸€ä¸ªè¯»å¤šå†™å°‘çš„ä¸šåŠ¡ä¸ºäº†æ€§èƒ½ï¼Œå¸¸å¸¸æ˜¯æœ‰è¯»é”å’Œå†™é”çš„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œæ­¤åˆ»çš„æ‰©å±•å·²ç»è¶…å‡ºäº†ä¸€æŠŠç®€å•è½®å­çš„å¤æ‚ç¨‹åº¦ï¼Œå…‰æ˜¯å¤„ç†ç»­çº¦ï¼Œå°±å¤Ÿå°å¼ å–ä¸€å£¶ï¼Œä½•å†µåœ¨æ€§èƒ½ï¼ˆé”çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼‰ã€ä¼˜é›…ï¼ˆæ— æ•ˆé”ç”³è¯·ï¼‰ã€é‡è¯•ï¼ˆå¤±è´¥é‡è¯•æœºåˆ¶ï¼‰ç­‰æ–¹é¢è¿˜è¦ä¸‹åŠŸå¤«ç ”ç©¶ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨å°å¼ è‹¦æ€å†¥æƒ³æ—¶ï¼Œæ—è¾¹çš„å°ç™½å‡‘è¿‡æ¥çœ‹äº†çœ‹å°å¼ ï¼Œå¾ˆå¥½å¥‡ï¼Œéƒ½2021å¹´äº†ï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨redissonå‘¢ï¼Ÿ&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissonå°±æœ‰è¿™æŠŠä½ è¦çš„é”ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;3. Redissonåˆ†å¸ƒå¼é”&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å·ç§°ç®€å•çš„Redissonåˆ†å¸ƒå¼é”çš„ä½¿ç”¨å§¿åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1. ä¾èµ–&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&amp;lt;!--Â åŸç”Ÿï¼Œæœ¬ç« ä½¿ç”¨--&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.redisson&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;redisson&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.13.6&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;!--Â å¦ä¸€ç§Springé›†æˆstarterï¼Œæœ¬ç« æœªä½¿ç”¨Â --&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.redisson&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;redisson-spring-boot-starter&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;3.13.6&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2. é…ç½®&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@Configuration&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;RedissionConfig&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${spring.redis.host}&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â StringÂ redisHost;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;@Value&lt;/span&gt;(&lt;span&gt;&quot;${spring.redis.password}&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â StringÂ password;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;int&lt;/span&gt;Â portÂ =Â &lt;span&gt;6379&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;@Bean&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â RedissonClientÂ &lt;span&gt;getRedisson&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â ConfigÂ configÂ =Â &lt;span&gt;new&lt;/span&gt;Â Config();&lt;br/&gt;Â Â Â Â Â Â Â Â config.useSingleServer().&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â setAddress(&lt;span&gt;&quot;redis://&quot;&lt;/span&gt;Â +Â redisHostÂ +Â &lt;span&gt;&quot;:&quot;&lt;/span&gt;Â +Â port).&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â setPassword(password);&lt;br/&gt;Â Â Â Â Â Â Â Â config.setCodec(&lt;span&gt;new&lt;/span&gt;Â JsonJacksonCodec());&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â Redisson.create(config);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;3. å¯ç”¨åˆ†å¸ƒå¼é”&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@Resource&lt;/span&gt;&lt;br/&gt;&lt;span&gt;private&lt;/span&gt;Â RedissonClientÂ redissonClient;&lt;br/&gt;&lt;br/&gt;RLockÂ rLockÂ =Â redissonClient.getLock(lockName);&lt;br/&gt;&lt;span&gt;try&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â &lt;span&gt;boolean&lt;/span&gt;Â isLockedÂ =Â rLock.tryLock(expireTime,Â TimeUnit.MILLISECONDS);&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (isLocked)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;//Â TODO&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }Â &lt;span&gt;catch&lt;/span&gt;Â (ExceptionÂ e)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â rLock.unlock();&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç®€æ´æ˜äº†ï¼Œåªéœ€è¦ä¸€ä¸ªRLockï¼Œæ—¢ç„¶æ¨èRedissonï¼Œå°±å¾€é‡Œé¢çœ‹çœ‹ä»–æ˜¯æ€ä¹ˆå®ç°çš„ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;4. RLock&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;RLockæ˜¯Redissonåˆ†å¸ƒå¼é”çš„æœ€æ ¸å¿ƒæ¥å£ï¼Œç»§æ‰¿äº†concurrentåŒ…çš„Lockæ¥å£å’Œè‡ªå·±çš„RLockAsyncæ¥å£ï¼ŒRLockAsyncçš„è¿”å›å€¼éƒ½æ˜¯RFutureï¼Œæ˜¯Redissonæ‰§è¡Œå¼‚æ­¥å®ç°çš„æ ¸å¿ƒé€»è¾‘ï¼Œä¹Ÿæ˜¯Nettyå‘æŒ¥çš„ä¸»è¦é˜µåœ°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;RLockå¦‚ä½•åŠ é”ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»RLockè¿›å…¥ï¼Œæ‰¾åˆ°RedissonLockç±»ï¼Œæ‰¾åˆ°&lt;strong&gt;tryLock&lt;/strong&gt; æ–¹æ³•å†é€’è¿›åˆ°å¹²äº‹çš„&lt;strong&gt;tryAcquireOnceAsync&lt;/strong&gt; æ–¹æ³•ï¼Œè¿™æ˜¯åŠ é”çš„ä¸»è¦ä»£ç ï¼ˆç‰ˆæœ¬ä¸ä¸€æ­¤å¤„å®ç°æœ‰å·®åˆ«ï¼Œå’Œæœ€æ–°3.15.xæœ‰ä¸€å®šå‡ºå…¥ï¼Œä½†æ˜¯æ ¸å¿ƒé€»è¾‘ä¾ç„¶æœªå˜ã€‚æ­¤å¤„ä»¥3.13.6ä¸ºä¾‹ï¼‰&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â RFuture&amp;lt;Boolean&amp;gt;Â &lt;span&gt;tryAcquireOnceAsync&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt;Â waitTime,Â &lt;span&gt;long&lt;/span&gt;Â leaseTime,Â TimeUnitÂ unit,Â &lt;span&gt;long&lt;/span&gt;Â threadId)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (leaseTimeÂ !=Â -&lt;span&gt;1L&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;this&lt;/span&gt;.tryLockInnerAsync(waitTime,Â leaseTime,Â unit,Â threadId,Â RedisCommands.EVAL_NULL_BOOLEAN);&lt;br/&gt;Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â RFuture&amp;lt;Boolean&amp;gt;Â ttlRemainingFutureÂ =Â &lt;span&gt;this&lt;/span&gt;.tryLockInnerAsync(waitTime,Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.getConnectionManager().getCfg().getLockWatchdogTimeout(),Â TimeUnit.MILLISECONDS,Â threadId,Â RedisCommands.EVAL_NULL_BOOLEAN);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â ttlRemainingFuture.onComplete((ttlRemaining,Â e)Â -&amp;gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (eÂ ==Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (ttlRemaining)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.scheduleExpirationRenewal(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â });&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â ttlRemainingFuture;&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¤å¤„å‡ºç°leaseTimeæ—¶é—´åˆ¤æ–­çš„2ä¸ªåˆ†æ”¯ï¼Œå®é™…ä¸Šå°±æ˜¯åŠ é”æ—¶æ˜¯å¦è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæœªè®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ-1ï¼‰æ—¶åˆ™ä¼šæœ‰&lt;strong&gt;watchDog&lt;/strong&gt; çš„&lt;strong&gt;é”ç»­çº¦&lt;/strong&gt; ï¼ˆä¸‹æ–‡ï¼‰ï¼Œä¸€ä¸ªæ³¨å†Œäº†åŠ é”äº‹ä»¶çš„ç»­çº¦ä»»åŠ¡ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹æœ‰è¿‡æœŸæ—¶é—´&lt;strong&gt;tryLockInnerAsync&lt;/strong&gt; éƒ¨åˆ†ï¼Œ&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;evalWriteAsyncæ˜¯evalå‘½ä»¤æ‰§è¡Œluaçš„å…¥å£&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â RFuture&amp;lt;Boolean&amp;gt;Â &lt;span&gt;tryAcquireOnceAsync&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt;Â waitTime,Â &lt;span&gt;long&lt;/span&gt;Â leaseTime,Â TimeUnitÂ unit,Â &lt;span&gt;long&lt;/span&gt;Â threadId)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (leaseTimeÂ !=Â -&lt;span&gt;1L&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;this&lt;/span&gt;.tryLockInnerAsync(waitTime,Â leaseTime,Â unit,Â threadId,Â RedisCommands.EVAL_NULL_BOOLEAN);&lt;br/&gt;Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â RFuture&amp;lt;Boolean&amp;gt;Â ttlRemainingFutureÂ =Â &lt;span&gt;this&lt;/span&gt;.tryLockInnerAsync(waitTime,Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.getConnectionManager().getCfg().getLockWatchdogTimeout(),Â TimeUnit.MILLISECONDS,Â threadId,Â RedisCommands.EVAL_NULL_BOOLEAN);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â ttlRemainingFuture.onComplete((ttlRemaining,Â e)Â -&amp;gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (eÂ ==Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (ttlRemaining)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.scheduleExpirationRenewal(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â });&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â ttlRemainingFuture;&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œæ­å¼€çœŸé¢ç›®ï¼Œevalå‘½ä»¤æ‰§è¡ŒLuaè„šæœ¬çš„åœ°æ–¹ï¼Œæ­¤å¤„çš„Luaè„šæœ¬å±•å¼€&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;--Â ä¸å­˜åœ¨è¯¥keyæ—¶&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â (redis.call(&lt;span&gt;&#x27;exists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;])Â ==Â &lt;span&gt;0&lt;/span&gt;)Â thenÂ &lt;br/&gt;Â Â --Â æ–°å¢è¯¥é”å¹¶ä¸”hashä¸­è¯¥çº¿ç¨‹idå¯¹åº”çš„countç½®&lt;span&gt;1&lt;/span&gt;&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;hincrby&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;],Â &lt;span&gt;1&lt;/span&gt;);Â &lt;br/&gt;Â Â --Â è®¾ç½®è¿‡æœŸæ—¶é—´&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;pexpire&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;1&lt;/span&gt;]);Â &lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â nil;Â &lt;br/&gt;end;Â &lt;br/&gt;&lt;br/&gt;--Â å­˜åœ¨è¯¥keyÂ å¹¶ä¸”Â hashä¸­çº¿ç¨‹idçš„keyä¹Ÿå­˜åœ¨&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â (redis.call(&lt;span&gt;&#x27;hexists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;])Â ==Â &lt;span&gt;1&lt;/span&gt;)Â thenÂ &lt;br/&gt;Â Â --Â çº¿ç¨‹é‡å…¥æ¬¡æ•°++&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;hincrby&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;],Â &lt;span&gt;1&lt;/span&gt;);Â &lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;pexpire&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;1&lt;/span&gt;]);Â &lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â nil;Â &lt;br/&gt;end;Â &lt;br/&gt;&lt;span&gt;return&lt;/span&gt;Â redis.call(&lt;span&gt;&#x27;pttl&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;]);&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å’Œå‰é¢æˆ‘ä»¬å†™è‡ªå®šä¹‰çš„åˆ†å¸ƒå¼é”çš„è„šæœ¬å‡ ä¹ä¸€è‡´ï¼Œçœ‹æ¥redissonä¹Ÿæ˜¯ä¸€æ ·çš„å®ç°ï¼Œå…·ä½“å‚æ•°åˆ†æï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;//Â keyName&lt;/span&gt;&lt;br/&gt;KEYS[&lt;span&gt;1&lt;/span&gt;]Â =Â Collections.singletonList(&lt;span&gt;this&lt;/span&gt;.getName())&lt;br/&gt;&lt;span&gt;//Â leaseTime&lt;/span&gt;&lt;br/&gt;ARGV[&lt;span&gt;1&lt;/span&gt;]Â =Â &lt;span&gt;this&lt;/span&gt;.internalLockLeaseTime&lt;br/&gt;&lt;span&gt;//Â uuid+threadIdç»„åˆçš„å”¯ä¸€å€¼&lt;/span&gt;&lt;br/&gt;ARGV[&lt;span&gt;2&lt;/span&gt;]Â =Â &lt;span&gt;this&lt;/span&gt;.getLockName(threadId)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ€»å…±3ä¸ªå‚æ•°å®Œæˆäº†ä¸€æ®µé€»è¾‘ï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;åˆ¤æ–­è¯¥é”æ˜¯å¦å·²ç»æœ‰å¯¹åº”hashè¡¨å­˜åœ¨ï¼Œ&lt;/p&gt;&lt;p&gt;â€¢ æ²¡æœ‰å¯¹åº”çš„hashè¡¨ï¼šåˆ™setè¯¥hashè¡¨ä¸­ä¸€ä¸ªentryçš„keyä¸ºé”åç§°ï¼Œvalueä¸º1ï¼Œä¹‹åè®¾ç½®è¯¥hashè¡¨å¤±æ•ˆæ—¶é—´ä¸ºleaseTime&lt;/p&gt;&lt;p&gt;â€¢ å­˜åœ¨å¯¹åº”çš„hashè¡¨ï¼šåˆ™å°†è¯¥lockNameçš„valueæ‰§è¡Œ+1æ“ä½œï¼Œä¹Ÿå°±æ˜¯è®¡ç®—è¿›å…¥æ¬¡æ•°ï¼Œå†è®¾ç½®å¤±æ•ˆæ—¶é—´leaseTime&lt;/p&gt;&lt;p&gt;â€¢ æœ€åè¿”å›è¿™æŠŠé”çš„ttlå‰©ä½™æ—¶é—´&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¹Ÿå’Œä¸Šè¿°è‡ªå®šä¹‰é”æ²¡æœ‰åŒºåˆ«&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ—¢ç„¶å¦‚æ­¤ï¼Œé‚£è§£é”çš„æ­¥éª¤ä¹Ÿè‚¯å®šæœ‰å¯¹åº”çš„-1æ“ä½œï¼Œå†çœ‹unlockæ–¹æ³•ï¼ŒåŒæ ·æŸ¥æ‰¾æ–¹æ³•åï¼Œä¸€è·¯åˆ°&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â RFuture&amp;lt;Boolean&amp;gt;Â &lt;span&gt;unlockInnerAsync&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt;Â threadId)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.evalWriteAsync(&lt;span&gt;this&lt;/span&gt;.getName(),Â LongCodec.INSTANCE,Â RedisCommands.EVAL_BOOLEAN,Â &lt;span&gt;&quot;ifÂ (redis.call(&#x27;exists&#x27;,Â KEYS[1])Â ==Â 0)Â thenÂ redis.call(&#x27;publish&#x27;,Â KEYS[2],Â ARGV[1]);Â returnÂ 1;Â end;ifÂ (redis.call(&#x27;hexists&#x27;,Â KEYS[1],Â ARGV[3])Â ==Â 0)Â thenÂ returnÂ nil;end;Â localÂ counterÂ =Â redis.call(&#x27;hincrby&#x27;,Â KEYS[1],Â ARGV[3],Â -1);Â ifÂ (counterÂ &amp;gt;Â 0)Â thenÂ redis.call(&#x27;pexpire&#x27;,Â KEYS[1],Â ARGV[2]);Â returnÂ 0;Â elseÂ redis.call(&#x27;del&#x27;,Â KEYS[1]);Â redis.call(&#x27;publish&#x27;,Â KEYS[2],Â ARGV[1]);Â returnÂ 1;Â end;Â returnÂ nil;&quot;&lt;/span&gt;,Â Arrays.asList(&lt;span&gt;this&lt;/span&gt;.getName(),Â &lt;span&gt;this&lt;/span&gt;.getChannelName()),Â &lt;span&gt;new&lt;/span&gt;Â Object[]{LockPubSub.unlockMessage,Â &lt;span&gt;this&lt;/span&gt;.internalLockLeaseTime,Â &lt;span&gt;this&lt;/span&gt;.getLockName(threadId)});&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æå‡ºLuaéƒ¨åˆ†&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;--Â ä¸å­˜åœ¨&lt;span&gt;key&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â &lt;span&gt;(redis.call(&lt;span&gt;&#x27;hexists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;3&lt;/span&gt;])&lt;/span&gt;Â &lt;/span&gt;==Â &lt;span&gt;0&lt;/span&gt;)Â thenÂ &lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â nil;&lt;br/&gt;end;&lt;br/&gt;--Â è®¡æ•°å™¨Â -&lt;span&gt;1&lt;/span&gt;&lt;br/&gt;localÂ counterÂ =Â redis.call(&lt;span&gt;&#x27;hincrby&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;3&lt;/span&gt;],Â -&lt;span&gt;1&lt;/span&gt;);Â &lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â (counterÂ &amp;gt;Â &lt;span&gt;0&lt;/span&gt;)Â thenÂ &lt;br/&gt;Â Â --Â è¿‡æœŸæ—¶é—´é‡è®¾&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;pexpire&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;]);Â &lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;0&lt;/span&gt;;Â &lt;br/&gt;&lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â --Â åˆ é™¤å¹¶å‘å¸ƒè§£é”æ¶ˆæ¯&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;del&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;]);Â &lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;publish&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;],Â ARGV[&lt;span&gt;1&lt;/span&gt;]);Â &lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;1&lt;/span&gt;;&lt;br/&gt;end;Â &lt;br/&gt;&lt;span&gt;return&lt;/span&gt;Â nil;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯¥Lua KEYSæœ‰2ä¸ª&lt;code&gt;Arrays.asList(getName(), getChannelName())&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;nameÂ é”åç§°&lt;br/&gt;channelNameï¼Œç”¨äºpubSubå‘å¸ƒæ¶ˆæ¯çš„channelåç§°&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ARGVå˜é‡æœ‰ä¸‰ä¸ª&lt;code&gt;LockPubSub.UNLOCK_MESSAGE, internalLockLeaseTime, getLockName(threadId)&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;LockPubSub.UNLOCK_MESSAGEï¼Œchannelå‘é€æ¶ˆæ¯çš„ç±»åˆ«ï¼Œæ­¤å¤„è§£é”ä¸º&lt;span&gt;0&lt;/span&gt;&lt;br/&gt;internalLockLeaseTimeï¼ŒwatchDogé…ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œé»˜è®¤ä¸º&lt;span&gt;30&lt;/span&gt;s&lt;br/&gt;lockNameÂ è¿™é‡Œçš„lockNameæŒ‡çš„æ˜¯uuidå’ŒthreadIdç»„åˆçš„å”¯ä¸€å€¼&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¥éª¤å¦‚ä¸‹ï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;1.å¦‚æœè¯¥é”ä¸å­˜åœ¨åˆ™è¿”å›nilï¼›&lt;/p&gt;&lt;p&gt;2.å¦‚æœè¯¥é”å­˜åœ¨åˆ™å°†å…¶çº¿ç¨‹çš„hash keyè®¡æ•°å™¨-1ï¼Œ&lt;/p&gt;&lt;p&gt;3.è®¡æ•°å™¨counter&amp;gt;0ï¼Œé‡ç½®ä¸‹å¤±æ•ˆæ—¶é—´ï¼Œè¿”å›0ï¼›å¦åˆ™ï¼Œåˆ é™¤è¯¥é”ï¼Œå‘å¸ƒè§£é”æ¶ˆæ¯unlockMessageï¼Œè¿”å›1ï¼›&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¶ä¸­unLockçš„æ—¶å€™ä½¿ç”¨åˆ°äº†Rediså‘å¸ƒè®¢é˜…PubSubå®Œæˆæ¶ˆæ¯é€šçŸ¥ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œè®¢é˜…çš„æ­¥éª¤å°±åœ¨RedissonLockçš„åŠ é”å…¥å£çš„lockæ–¹æ³•é‡Œ&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;long&lt;/span&gt;Â threadIdÂ =Â Thread.currentThread().getId();&lt;br/&gt;Â Â Â Â Â Â Â Â LongÂ ttlÂ =Â &lt;span&gt;this&lt;/span&gt;.tryAcquire(-&lt;span&gt;1L&lt;/span&gt;,Â leaseTime,Â unit,Â threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (ttlÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;//Â è®¢é˜…&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â RFuture&amp;lt;RedissonLockEntry&amp;gt;Â futureÂ =Â &lt;span&gt;this&lt;/span&gt;.subscribe(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (interruptibly)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.syncSubscriptionInterrupted(future);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.syncSubscription(future);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;//Â çœç•¥&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å½“é”è¢«å…¶ä»–çº¿ç¨‹å ç”¨æ—¶ï¼Œé€šè¿‡ç›‘å¬é”çš„é‡Šæ”¾é€šçŸ¥ï¼ˆåœ¨å…¶ä»–çº¿ç¨‹é€šè¿‡RedissonLocké‡Šæ”¾é”æ—¶ï¼Œä¼šé€šè¿‡å‘å¸ƒè®¢é˜…pub/subåŠŸèƒ½å‘èµ·é€šçŸ¥ï¼‰ï¼Œç­‰å¾…é”è¢«å…¶ä»–çº¿ç¨‹é‡Šæ”¾ï¼Œä¹Ÿæ˜¯ä¸ºäº†é¿å…è‡ªæ—‹çš„ä¸€ç§å¸¸ç”¨æ•ˆç‡æ‰‹æ®µã€‚&lt;/strong&gt;&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;1. è§£é”æ¶ˆæ¯&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†ä¸€æ¢ç©¶ç«Ÿé€šçŸ¥äº†ä»€ä¹ˆï¼Œé€šçŸ¥ååˆåšäº†ä»€ä¹ˆï¼Œè¿›å…¥LockPubSubã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œåªæœ‰ä¸€ä¸ªæ˜æ˜¾çš„ç›‘å¬æ–¹æ³•onMessageï¼Œå…¶è®¢é˜…å’Œä¿¡å·é‡çš„é‡Šæ”¾éƒ½åœ¨çˆ¶ç±»PublishSubscribeï¼Œæˆ‘ä»¬åªå…³æ³¨ç›‘å¬äº‹ä»¶çš„å®é™…æ“ä½œ&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;onMessage&lt;/span&gt;&lt;span&gt;(RedissonLockEntryÂ value,Â LongÂ message)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â RunnableÂ runnableToExecute;&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (message.equals(unlockMessage))Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;//Â ä»ç›‘å¬å™¨é˜Ÿåˆ—å–ç›‘å¬çº¿ç¨‹æ‰§è¡Œç›‘å¬å›è°ƒ&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â runnableToExecuteÂ =Â (Runnable)value.getListeners().poll();&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (runnableToExecuteÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â runnableToExecute.run();&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;//Â getLatch()è¿”å›çš„æ˜¯Semaphoreï¼Œä¿¡å·é‡ï¼Œæ­¤å¤„æ˜¯é‡Šæ”¾ä¿¡å·é‡&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;//Â é‡Šæ”¾ä¿¡å·é‡åä¼šå”¤é†’ç­‰å¾…çš„entry.getLatch().tryAcquireå»å†æ¬¡å°è¯•ç”³è¯·é”&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â value.getLatch().release();&lt;br/&gt;Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â &lt;span&gt;if&lt;/span&gt;Â (message.equals(readUnlockMessage))Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;while&lt;/span&gt;(&lt;span&gt;true&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â runnableToExecuteÂ =Â (Runnable)value.getListeners().poll();&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (runnableToExecuteÂ ==Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â value.getLatch().release(value.getLatch().getQueueLength());&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;break&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â runnableToExecute.run();&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å‘ç°ä¸€ä¸ªæ˜¯&lt;strong&gt;é»˜è®¤è§£é”æ¶ˆæ¯&lt;/strong&gt; ï¼Œä¸€ä¸ªæ˜¯&lt;strong&gt;è¯»é”è§£é”æ¶ˆæ¯&lt;/strong&gt; ï¼Œå› ä¸ºredissonæ˜¯æœ‰æä¾›è¯»å†™é”çš„ï¼Œè€Œè¯»å†™é”è¯»è¯»æƒ…å†µå’Œè¯»å†™ã€å†™å†™æƒ…å†µäº’æ–¥æƒ…å†µä¸åŒï¼Œæˆ‘ä»¬åªçœ‹ä¸Šé¢çš„é»˜è®¤è§£é”æ¶ˆæ¯unlockMessageåˆ†æ”¯&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;LockPubSubç›‘å¬æœ€ç»ˆæ‰§è¡Œäº†2ä»¶äº‹&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;runnableToExecute.run()&lt;/code&gt; æ‰§è¡Œç›‘å¬å›è°ƒ&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;value.getLatch().release();&lt;/code&gt; é‡Šæ”¾ä¿¡å·é‡&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissoné€šè¿‡&lt;strong&gt;LockPubSub&lt;/strong&gt; ç›‘å¬è§£é”æ¶ˆæ¯ï¼Œæ‰§è¡Œç›‘å¬å›è°ƒå’Œé‡Šæ”¾ä¿¡å·é‡é€šçŸ¥ç­‰å¾…çº¿ç¨‹å¯ä»¥é‡æ–°æŠ¢é”ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™æ—¶å†å›æ¥çœ‹tryAcquireOnceAsyncå¦ä¸€åˆ†æ”¯&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â RFuture&amp;lt;Boolean&amp;gt;Â &lt;span&gt;tryAcquireOnceAsync&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt;Â waitTime,Â &lt;span&gt;long&lt;/span&gt;Â leaseTime,Â TimeUnitÂ unit,Â &lt;span&gt;long&lt;/span&gt;Â threadId)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (leaseTimeÂ !=Â -&lt;span&gt;1L&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;this&lt;/span&gt;.tryLockInnerAsync(waitTime,Â leaseTime,Â unit,Â threadId,Â RedisCommands.EVAL_NULL_BOOLEAN);&lt;br/&gt;Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â RFuture&amp;lt;Boolean&amp;gt;Â ttlRemainingFutureÂ =Â &lt;span&gt;this&lt;/span&gt;.tryLockInnerAsync(waitTime,Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.getConnectionManager().getCfg().getLockWatchdogTimeout(),Â TimeUnit.MILLISECONDS,Â threadId,Â RedisCommands.EVAL_NULL_BOOLEAN);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â ttlRemainingFuture.onComplete((ttlRemaining,Â e)Â -&amp;gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (eÂ ==Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (ttlRemaining)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.scheduleExpirationRenewal(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â });&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â ttlRemainingFuture;&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥çœ‹åˆ°ï¼Œæ— è¶…æ—¶æ—¶é—´æ—¶ï¼Œåœ¨æ‰§è¡ŒåŠ é”æ“ä½œåï¼Œè¿˜æ‰§è¡Œäº†ä¸€æ®µè´¹è§£çš„é€»è¾‘&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;ttlRemainingFuture.onComplete((ttlRemaining,Â e)Â -&amp;gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (eÂ ==Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (ttlRemaining)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.scheduleExpirationRenewal(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â })&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¤å¤„æ¶‰åŠåˆ°Nettyçš„Future/Promise-Listeneræ¨¡å‹ï¼ŒRedissonä¸­å‡ ä¹å…¨éƒ¨ä»¥è¿™ç§æ–¹å¼é€šä¿¡ï¼ˆæ‰€ä»¥è¯´Redissonæ˜¯åŸºäºNettyé€šä¿¡æœºåˆ¶å®ç°çš„ï¼‰ï¼Œç†è§£è¿™æ®µé€»è¾‘å¯ä»¥è¯•ç€å…ˆç†è§£&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;åœ¨ Java çš„ Future ä¸­ï¼Œä¸šåŠ¡é€»è¾‘ä¸ºä¸€ä¸ª Callable æˆ– Runnable å®ç°ç±»ï¼Œè¯¥ç±»çš„ call()æˆ– run()æ‰§è¡Œå®Œæ¯•æ„å‘³ç€ä¸šåŠ¡é€»è¾‘çš„å®Œç»“ï¼Œåœ¨ Promise æœºåˆ¶ä¸­ï¼Œå¯ä»¥åœ¨ä¸šåŠ¡é€»è¾‘ä¸­äººå·¥è®¾ç½®ä¸šåŠ¡é€»è¾‘çš„æˆåŠŸä¸å¤±è´¥ï¼Œè¿™æ ·æ›´åŠ æ–¹ä¾¿çš„ç›‘æ§è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™å—ä»£ç çš„è¡¨é¢æ„ä¹‰å°±æ˜¯ï¼Œåœ¨æ‰§è¡Œå¼‚æ­¥åŠ é”çš„æ“ä½œåï¼ŒåŠ é”æˆåŠŸåˆ™æ ¹æ®åŠ é”å®Œæˆè¿”å›çš„ttlæ˜¯å¦è¿‡æœŸæ¥ç¡®è®¤æ˜¯å¦æ‰§è¡Œä¸€æ®µå®šæ—¶ä»»åŠ¡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™æ®µå®šæ—¶ä»»åŠ¡çš„å°±æ˜¯watchDogçš„æ ¸å¿ƒã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;2. é”ç»­çº¦&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸ¥çœ‹&lt;code&gt;RedissonLock.this.scheduleExpirationRenewal(threadId)&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;scheduleExpirationRenewal&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt;Â threadId)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â RedissonLock.ExpirationEntryÂ entryÂ =Â &lt;span&gt;new&lt;/span&gt;Â RedissonLock.ExpirationEntry();&lt;br/&gt;Â Â Â Â Â Â Â Â RedissonLock.ExpirationEntryÂ oldEntryÂ =Â (RedissonLock.ExpirationEntry)EXPIRATION_RENEWAL_MAP.putIfAbsent(&lt;span&gt;this&lt;/span&gt;.getEntryName(),Â entry);&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (oldEntryÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â oldEntry.addThreadId(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â entry.addThreadId(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;this&lt;/span&gt;.renewExpiration();&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;renewExpiration&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â RedissonLock.ExpirationEntryÂ eeÂ =Â (RedissonLock.ExpirationEntry)EXPIRATION_RENEWAL_MAP.get(&lt;span&gt;this&lt;/span&gt;.getEntryName());&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (eeÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â TimeoutÂ taskÂ =Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.getConnectionManager().newTimeout(&lt;span&gt;new&lt;/span&gt;Â TimerTask()Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;run&lt;/span&gt;&lt;span&gt;(TimeoutÂ timeout)&lt;/span&gt;Â &lt;span&gt;throws&lt;/span&gt;Â ExceptionÂ &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â RedissonLock.ExpirationEntryÂ entÂ =Â (RedissonLock.ExpirationEntry)RedissonLock.EXPIRATION_RENEWAL_MAP.get(RedissonLock.&lt;span&gt;this&lt;/span&gt;.getEntryName());&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (entÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â LongÂ threadIdÂ =Â ent.getFirstThreadId();&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (threadIdÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â RFuture&amp;lt;Boolean&amp;gt;Â futureÂ =Â RedissonLock.&lt;span&gt;this&lt;/span&gt;.renewExpirationAsync(threadId);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â future.onComplete((res,Â e)Â -&amp;gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (eÂ !=Â &lt;span&gt;null&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â RedissonLock.log.error(&lt;span&gt;&quot;Can&#x27;tÂ updateÂ lockÂ &quot;&lt;/span&gt;Â +Â RedissonLock.&lt;span&gt;this&lt;/span&gt;.getName()Â +Â &lt;span&gt;&quot;Â expiration&quot;&lt;/span&gt;,Â e);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }Â &lt;span&gt;else&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (res)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â RedissonLock.&lt;span&gt;this&lt;/span&gt;.renewExpiration();&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â });&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â },Â &lt;span&gt;this&lt;/span&gt;.internalLockLeaseTimeÂ /Â &lt;span&gt;3L&lt;/span&gt;,Â TimeUnit.MILLISECONDS);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â ee.setTimeout(task);&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‹†åˆ†æ¥çœ‹ï¼Œè¿™æ®µè¿ç»­åµŒå¥—ä¸”å†—é•¿çš„ä»£ç å®é™…ä¸Šåšäº†å‡ æ­¥&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;â€¢ æ·»åŠ ä¸€ä¸ªnettyçš„Timeoutå›è°ƒä»»åŠ¡ï¼Œæ¯ï¼ˆ&lt;code&gt;internalLockLeaseTime / 3&lt;/code&gt;ï¼‰æ¯«ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰§è¡Œçš„æ–¹æ³•æ˜¯&lt;code&gt;renewExpirationAsync&lt;/code&gt;&lt;/p&gt;&lt;p&gt;â€¢ &lt;code&gt;renewExpirationAsync&lt;/code&gt;é‡ç½®äº†é”è¶…æ—¶æ—¶é—´ï¼Œåˆæ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œç›‘å¬å›è°ƒåˆæ‰§è¡Œäº†&lt;code&gt;renewExpiration&lt;/code&gt;&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;renewExpirationAsync&lt;/code&gt; çš„Luaå¦‚ä¸‹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â RFuture&amp;lt;Boolean&amp;gt;Â &lt;span&gt;renewExpirationAsync&lt;/span&gt;&lt;span&gt;(&lt;span&gt;long&lt;/span&gt;Â threadId)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;this&lt;/span&gt;.commandExecutor.evalWriteAsync(&lt;span&gt;this&lt;/span&gt;.getName(),Â LongCodec.INSTANCE,Â RedisCommands.EVAL_BOOLEAN,Â &lt;span&gt;&quot;ifÂ (redis.call(&#x27;hexists&#x27;,Â KEYS[1],Â ARGV[2])Â ==Â 1)Â thenÂ redis.call(&#x27;pexpire&#x27;,Â KEYS[1],Â ARGV[1]);Â returnÂ 1;Â end;Â returnÂ 0;&quot;&lt;/span&gt;,Â Collections.singletonList(&lt;span&gt;this&lt;/span&gt;.getName()),Â &lt;span&gt;new&lt;/span&gt;Â Object[]{&lt;span&gt;this&lt;/span&gt;.internalLockLeaseTime,Â &lt;span&gt;this&lt;/span&gt;.getLockName(threadId)});&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â (redis.call(&lt;span&gt;&#x27;hexists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;])Â ==Â &lt;span&gt;1&lt;/span&gt;)Â thenÂ &lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;pexpire&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;1&lt;/span&gt;]);Â &lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;1&lt;/span&gt;;Â &lt;br/&gt;end;Â &lt;br/&gt;&lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;0&lt;/span&gt;;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‡æ–°è®¾ç½®äº†è¶…æ—¶æ—¶é—´ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;RedissonåŠ è¿™æ®µé€»è¾‘çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç›®çš„æ˜¯ä¸ºäº†æŸç§åœºæ™¯ä¸‹ä¿è¯ä¸šåŠ¡ä¸å½±å“ï¼Œå¦‚ä»»åŠ¡æ‰§è¡Œè¶…æ—¶ä½†æœªç»“æŸï¼Œé”å·²ç»é‡Šæ”¾çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å½“ä¸€ä¸ªçº¿ç¨‹æŒæœ‰äº†ä¸€æŠŠé”ï¼Œç”±äºå¹¶æœªè®¾ç½®è¶…æ—¶æ—¶é—´leaseTimeï¼ŒRedissoné»˜è®¤é…ç½®äº†30Sï¼Œå¼€å¯watchDogï¼Œæ¯10Så¯¹è¯¥é”è¿›è¡Œä¸€æ¬¡ç»­çº¦ï¼Œç»´æŒ30Sçš„è¶…æ—¶æ—¶é—´ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆå†åˆ é™¤é”ã€‚&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™å°±æ˜¯Redissonçš„&lt;strong&gt;é”ç»­çº¦&lt;/strong&gt; ï¼Œä¹Ÿå°±æ˜¯&lt;strong&gt;WatchDog&lt;/strong&gt; å®ç°çš„åŸºæœ¬æ€è·¯ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;3. æµç¨‹æ¦‚æ‹¬&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é€šè¿‡æ•´ä½“çš„ä»‹ç»ï¼Œæµç¨‹ç®€å•æ¦‚æ‹¬ï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;Aã€Bçº¿ç¨‹äº‰æŠ¢ä¸€æŠŠé”ï¼ŒAè·å–åˆ°åï¼ŒBé˜»å¡&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Bçº¿ç¨‹é˜»å¡æ—¶å¹¶éä¸»åŠ¨CASï¼Œè€Œæ˜¯PubSubæ–¹å¼è®¢é˜…è¯¥é”çš„å¹¿æ’­æ¶ˆæ¯&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Aæ“ä½œå®Œæˆé‡Šæ”¾äº†é”ï¼ŒBçº¿ç¨‹æ”¶åˆ°è®¢é˜…æ¶ˆæ¯é€šçŸ¥&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Bè¢«å”¤é†’å¼€å§‹ç»§ç»­æŠ¢é”ï¼Œæ‹¿åˆ°é”&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯¦ç»†åŠ é”è§£é”æµç¨‹æ€»ç»“å¦‚ä¸‹å›¾ï¼š&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;1.1055319148936171&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4z6KL95s2fVjrD5ZuLl7MCsAF7NSEBnp3LpJicMsQnl1p5BqtQF2BAHRg/640?wx_fmt=other&amp;amp;random=0.4274622971093134&quot; data-type=&quot;other&quot; data-w=&quot;1175&quot;/&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;5. å…¬å¹³é”&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»¥ä¸Šä»‹ç»çš„å¯é‡å…¥é”æ˜¯éå…¬å¹³é”ï¼ŒRedissonè¿˜åŸºäºRedisçš„é˜Ÿåˆ—ï¼ˆListï¼‰å’ŒZSetå®ç°äº†å…¬å¹³é”&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å…¬å¹³çš„å®šä¹‰æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¬å¹³å°±æ˜¯æŒ‰ç…§å®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆæ¥ååˆ°æ’é˜Ÿæ¥è·å–é”ï¼Œå…ˆåˆ°å…ˆå¾—ï¼Œä¹Ÿå°±æ˜¯FIFOï¼Œæ‰€ä»¥é˜Ÿåˆ—å’Œå®¹å™¨é¡ºåºç¼–æ’å¿…ä¸å¯å°‘&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;FairSync&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å›é¡¾JUCçš„ReentrantLockå…¬å¹³é”çš„å®ç°&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;/**&lt;br/&gt;Â *Â SyncÂ objectÂ forÂ fairÂ locks&lt;br/&gt;Â */&lt;/span&gt;&lt;br/&gt;&lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;FairSync&lt;/span&gt;Â &lt;span&gt;extends&lt;/span&gt;Â &lt;span&gt;Sync&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;long&lt;/span&gt;Â serialVersionUIDÂ =Â -&lt;span&gt;3000897897090466540L&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;/**&lt;br/&gt;Â Â Â Â Â *Â FairÂ versionÂ ofÂ tryAcquire.Â Â Don&#x27;tÂ grantÂ accessÂ unless&lt;br/&gt;Â Â Â Â Â *Â recursiveÂ callÂ orÂ noÂ waitersÂ orÂ isÂ first.&lt;br/&gt;Â Â Â Â Â */&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â acquires)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;final&lt;/span&gt;Â ThreadÂ currentÂ =Â Thread.currentThread();&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;int&lt;/span&gt;Â cÂ =Â getState();&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (cÂ ==Â &lt;span&gt;0&lt;/span&gt;)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (!hasQueuedPredecessors()Â &amp;amp;&amp;amp;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â compareAndSetState(&lt;span&gt;0&lt;/span&gt;,Â acquires))Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â setExclusiveOwnerThread(current);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;else&lt;/span&gt;Â &lt;span&gt;if&lt;/span&gt;Â (currentÂ ==Â getExclusiveOwnerThread())Â {&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;int&lt;/span&gt;Â nextcÂ =Â cÂ +Â acquires;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (nextcÂ &amp;lt;Â &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;throw&lt;/span&gt;Â &lt;span&gt;new&lt;/span&gt;Â Error(&lt;span&gt;&quot;MaximumÂ lockÂ countÂ exceeded&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â setState(nextc);&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;;&lt;br/&gt;Â Â Â Â Â Â Â Â }&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;false&lt;/span&gt;;&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;AQSå·²ç»æä¾›äº†æ•´ä¸ªå®ç°ï¼Œæ˜¯å¦å…¬å¹³å–å†³äºå®ç°ç±»å–å‡ºèŠ‚ç‚¹é€»è¾‘æ˜¯å¦é¡ºåºå–&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9441747572815534&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zOD1SOEoS0j3HSLwIvFmANCesOgtDGNl84cdTPwvT2whaAEXQGBBVsw/640?wx_fmt=other&amp;amp;random=0.07091225780261312&quot; data-type=&quot;other&quot; data-w=&quot;824&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;AbstractQueuedSynchronizeræ˜¯ç”¨æ¥æ„å»ºé”æˆ–è€…å…¶ä»–åŒæ­¥ç»„ä»¶çš„åŸºç¡€æ¡†æ¶ï¼Œé€šè¿‡å†…ç½®FIFOé˜Ÿåˆ—æ¥å®Œæˆèµ„æºè·å–çº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œï¼Œä»–è‡ªèº«æ²¡æœ‰å®ç°åŒæ­¥æ¥å£ï¼Œä»…ä»…å®šä¹‰äº†è‹¥å¹²åŒæ­¥çŠ¶æ€è·å–å’Œé‡Šæ”¾çš„æ–¹æ³•æ¥ä¾›è‡ªå®šä¹‰åŒæ­¥ç»„ä»¶ä½¿ç”¨ï¼ˆä¸Šå›¾ï¼‰ï¼Œæ”¯æŒç‹¬å å’Œå…±äº«è·å–ï¼Œè¿™æ˜¯åŸºäºæ¨¡ç‰ˆæ–¹æ³•æ¨¡å¼çš„ä¸€ç§è®¾è®¡ï¼Œç»™å…¬å¹³/éå…¬å¹³æä¾›äº†åœŸå£¤ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬ç”¨2å¼ å›¾æ¥ç®€å•è§£é‡ŠAQSçš„ç­‰å¾…æµç¨‹ï¼ˆå‡ºè‡ªã€ŠJAVAå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ï¼‰&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸€å¼ æ˜¯åŒæ­¥é˜Ÿåˆ—ï¼ˆFIFOåŒå‘é˜Ÿåˆ—ï¼‰&lt;strong&gt;ç®¡ç† è·å–åŒæ­¥çŠ¶æ€å¤±è´¥ï¼ˆæŠ¢é”å¤±è´¥ï¼‰çš„çº¿ç¨‹å¼•ç”¨ã€ç­‰å¾…çŠ¶æ€å’Œå‰é©±åç»§èŠ‚ç‚¹çš„æµç¨‹å›¾&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.28445006321112515&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zqthfQlhVnaL1ksAMBYJBzOTwTiaqakdM3WTes0y60Rm3OOfRhUVSpCg/640?wx_fmt=other&amp;amp;random=0.9592101252387035&quot; data-type=&quot;other&quot; data-w=&quot;791&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸€å¼ æ˜¯&lt;strong&gt;ç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€çš„æ€»æµç¨‹&lt;/strong&gt; ï¼Œæ ¸å¿ƒacquire(int arg)æ–¹æ³•è°ƒç”¨æµç¨‹&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.925686591276252&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zmX7C9nO61QUvLz5KZgKzIJDuAbX81L6NNcqzicPoV8Ck9cvNjVvOFoQ/640?wx_fmt=other&amp;amp;random=0.9514430855491649&quot; data-type=&quot;other&quot; data-w=&quot;619&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥çœ‹å‡ºé”çš„è·å–æµç¨‹&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;AQSç»´æŠ¤ä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—ï¼Œè·å–çŠ¶æ€å¤±è´¥çš„çº¿ç¨‹éƒ½ä¼šåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­è¿›è¡Œè‡ªæ—‹ï¼Œç§»å‡ºé˜Ÿåˆ—æˆ–åœæ­¢è‡ªæ—‹çš„æ¡ä»¶æ˜¯å‰é©±èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹åˆ‡æˆåŠŸè·å–äº†åŒæ­¥çŠ¶æ€ã€‚&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œæ¯”è¾ƒå¦ä¸€æ®µéå…¬å¹³é”ç±»&lt;code&gt;NonfairSync&lt;/code&gt;å¯ä»¥å‘ç°ï¼Œæ§åˆ¶å…¬å¹³å’Œéå…¬å¹³çš„å…³é”®ä»£ç ï¼Œåœ¨äº&lt;code&gt;hasQueuedPredecessors&lt;/code&gt;æ–¹æ³•ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;NonfairSync&lt;/span&gt;Â &lt;span&gt;extends&lt;/span&gt;Â &lt;span&gt;Sync&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;private&lt;/span&gt;Â &lt;span&gt;static&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;long&lt;/span&gt;Â serialVersionUIDÂ =Â &lt;span&gt;7316153563782823691L&lt;/span&gt;;&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;/**&lt;br/&gt;Â Â Â Â Â *Â PerformsÂ lock.Â Â TryÂ immediateÂ barge,Â backingÂ upÂ toÂ normal&lt;br/&gt;Â Â Â Â Â *Â acquireÂ onÂ failure.&lt;br/&gt;Â Â Â Â Â */&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;lock&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â (compareAndSetState(&lt;span&gt;0&lt;/span&gt;,Â &lt;span&gt;1&lt;/span&gt;))&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â setExclusiveOwnerThread(Thread.currentThread());&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â acquire(&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;protected&lt;/span&gt;Â &lt;span&gt;final&lt;/span&gt;Â &lt;span&gt;boolean&lt;/span&gt;Â &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt;Â acquires)&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â nonfairTryAcquire(acquires);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;NonfairSync&lt;/code&gt;å‡å°‘äº†äº†&lt;code&gt;hasQueuedPredecessors&lt;/code&gt;åˆ¤æ–­æ¡ä»¶ï¼Œè¯¥æ–¹æ³•çš„ä½œç”¨å°±æ˜¯&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;æŸ¥çœ‹åŒæ­¥é˜Ÿåˆ—ä¸­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰æ¯”å½“å‰çº¿ç¨‹æ›´æ—©è¯·æ±‚è·å–é”åˆ™è¿”å›trueã€‚&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ä¿è¯æ¯æ¬¡éƒ½å–é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆçº¿ç¨‹ï¼‰æ¥è·å–é”ï¼Œè¿™å°±æ˜¯å…¬å¹³è§„åˆ™&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;ä¸ºä»€ä¹ˆJUCä»¥é»˜è®¤éå…¬å¹³é”å‘¢ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;å› ä¸ºå½“ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚é”æ—¶ï¼Œåªè¦è·å–æ¥åŒæ­¥çŠ¶æ€å³æˆåŠŸè·å–ã€‚åœ¨æ­¤å‰æä¸‹ï¼Œåˆšé‡Šæ”¾çš„çº¿ç¨‹å†æ¬¡è·å–åŒæ­¥çŠ¶æ€çš„å‡ ç‡ä¼šéå¸¸å¤§ï¼Œä½¿å¾—å…¶ä»–çº¿ç¨‹åªèƒ½åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚ä½†è¿™æ ·å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼Œéå…¬å¹³é”å¤§å¤§å‡å°‘äº†ç³»ç»Ÿçº¿ç¨‹ä¸Šä¸‹æ–‡çš„åˆ‡æ¢å¼€é”€ã€‚&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯è§å…¬å¹³çš„ä»£ä»·æ˜¯æ€§èƒ½ä¸ååé‡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redisé‡Œæ²¡æœ‰AQSï¼Œä½†æ˜¯æœ‰Listå’ŒzSetï¼Œçœ‹çœ‹Redissonæ˜¯æ€ä¹ˆå®ç°å…¬å¹³çš„ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;RedissonFairLock&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;RedissonFairLock ç”¨æ³•ä¾ç„¶å¾ˆç®€å•&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;RLockÂ fairLockÂ =Â redissonClient.getFairLock(lockName);&lt;br/&gt;&lt;br/&gt;fairLock.lock();&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;RedissonFairLock&lt;/code&gt;ç»§æ‰¿è‡ª&lt;code&gt;RedissonLock&lt;/code&gt;ï¼ŒåŒæ ·ä¸€è·¯å‘ä¸‹æ‰¾åˆ°åŠ é”å®ç°æ–¹æ³•&lt;strong&gt;tryLockInnerAsync&lt;/strong&gt; ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œæœ‰2æ®µå†—é•¿çš„Luaï¼Œä½†æ˜¯Debugå‘ç°ï¼Œå…¬å¹³é”çš„å…¥å£åœ¨ &lt;code&gt;command == RedisCommands.EVAL_LONG&lt;/code&gt; ä¹‹åï¼Œæ­¤æ®µLuaè¾ƒé•¿ï¼Œå‚æ•°ä¹Ÿå¤šï¼Œæˆ‘ä»¬ç€é‡åˆ†æLuaçš„å®ç°è§„åˆ™&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å‚æ•°&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;--Â luaä¸­çš„å‡ ä¸ªå‚æ•°&lt;br/&gt;KEYSÂ =Â Arrays.&amp;lt;Object&amp;gt;asList(getName(),Â threadsQueueName,Â timeoutSetName)&lt;br/&gt;KEYS[&lt;span&gt;1&lt;/span&gt;]:Â lock_name,Â é”åç§°Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;br/&gt;KEYS[&lt;span&gt;2&lt;/span&gt;]:Â &lt;span&gt;&quot;redisson_lock_queue:{xxx}&quot;&lt;/span&gt;Â Â çº¿ç¨‹é˜Ÿåˆ—&lt;br/&gt;KEYS[&lt;span&gt;3&lt;/span&gt;]:Â &lt;span&gt;&quot;redisson_lock_timeout:{xxx}&quot;&lt;/span&gt;Â Â çº¿ç¨‹idå¯¹åº”çš„è¶…æ—¶é›†åˆ&lt;br/&gt;&lt;br/&gt;ARGVÂ =Â Â internalLockLeaseTime,Â getLockName(threadId),Â currentTimeÂ +Â threadWaitTime,Â currentTime&lt;br/&gt;ARGV[&lt;span&gt;1&lt;/span&gt;]:Â &lt;span&gt;&quot;{leaseTime}&quot;&lt;/span&gt;Â è¿‡æœŸæ—¶é—´&lt;br/&gt;ARGV[&lt;span&gt;2&lt;/span&gt;]:Â &lt;span&gt;&quot;{Redisson.UUID}:{threadId}&quot;&lt;/span&gt;Â Â Â &lt;br/&gt;ARGV[&lt;span&gt;3&lt;/span&gt;]Â =Â å½“å‰æ—¶é—´Â +Â çº¿ç¨‹ç­‰å¾…æ—¶é—´:ï¼ˆ&lt;span&gt;10&lt;/span&gt;:&lt;span&gt;00&lt;/span&gt;:&lt;span&gt;00&lt;/span&gt;ï¼‰Â +Â &lt;span&gt;5000&lt;/span&gt;æ¯«ç§’Â =Â &lt;span&gt;10&lt;/span&gt;:&lt;span&gt;00&lt;/span&gt;:&lt;span&gt;05&lt;/span&gt;&lt;br/&gt;ARGV[&lt;span&gt;4&lt;/span&gt;]Â =Â å½“å‰æ—¶é—´ï¼ˆ&lt;span&gt;10&lt;/span&gt;:&lt;span&gt;00&lt;/span&gt;:&lt;span&gt;00&lt;/span&gt;ï¼‰Â Â éƒ¨ç½²æœåŠ¡å™¨æ—¶é—´ï¼Œéredis-serveræœåŠ¡å™¨æ—¶é—´&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å…¬å¹³é”å®ç°çš„Luaè„šæœ¬&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;--Â &lt;span&gt;1&lt;/span&gt;.æ­»å¾ªç¯æ¸…é™¤è¿‡æœŸkey&lt;br/&gt;&lt;span&gt;while&lt;/span&gt;Â &lt;span&gt;true&lt;/span&gt;Â &lt;span&gt;do&lt;/span&gt;Â &lt;br/&gt;Â Â --Â è·å–å¤´èŠ‚ç‚¹&lt;br/&gt;Â Â Â Â localÂ firstThreadId2Â =Â redis.call(&lt;span&gt;&#x27;lindex&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;],Â &lt;span&gt;0&lt;/span&gt;);&lt;br/&gt;Â Â Â Â --Â é¦–æ¬¡è·å–å¿…ç©ºè·³å‡ºå¾ªç¯&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â firstThreadId2Â ==Â &lt;span&gt;false&lt;/span&gt;Â thenÂ &lt;br/&gt;Â Â Â Â &lt;span&gt;break&lt;/span&gt;;&lt;br/&gt;Â Â end;&lt;br/&gt;Â Â --Â æ¸…é™¤è¿‡æœŸkey&lt;br/&gt;Â Â localÂ timeoutÂ =Â tonumber(redis.call(&lt;span&gt;&#x27;zscore&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â firstThreadId2));&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â timeoutÂ &amp;lt;=Â tonumber(ARGV[&lt;span&gt;4&lt;/span&gt;])Â then&lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;zrem&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â firstThreadId2);&lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;lpop&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;]);&lt;br/&gt;Â Â &lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;break&lt;/span&gt;;&lt;br/&gt;Â Â end;&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â &lt;span&gt;2&lt;/span&gt;.ä¸å­˜åœ¨è¯¥é”Â &amp;amp;&amp;amp;Â ï¼ˆä¸å­˜åœ¨çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—Â ||Â å­˜åœ¨çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—è€Œä¸”ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯æ­¤çº¿ç¨‹ID)ï¼ŒåŠ é”éƒ¨åˆ†ä¸»è¦é€»è¾‘&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â (redis.call(&lt;span&gt;&#x27;exists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;])Â ==Â &lt;span&gt;0&lt;/span&gt;)Â andÂ &lt;br/&gt;Â Â ((redis.call(&lt;span&gt;&#x27;exists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;])Â ==Â &lt;span&gt;0&lt;/span&gt;)Â Â orÂ (redis.call(&lt;span&gt;&#x27;lindex&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;],Â &lt;span&gt;0&lt;/span&gt;)Â ==Â ARGV[&lt;span&gt;2&lt;/span&gt;]))Â then&lt;br/&gt;Â Â --Â å¼¹å‡ºé˜Ÿåˆ—ä¸­çº¿ç¨‹idå…ƒç´ ï¼Œåˆ é™¤Zsetä¸­è¯¥çº¿ç¨‹idå¯¹åº”çš„å…ƒç´ &lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;lpop&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;]);&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;zrem&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;]);&lt;br/&gt;Â Â localÂ keysÂ =Â redis.call(&lt;span&gt;&#x27;zrange&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â &lt;span&gt;0&lt;/span&gt;,Â -&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;Â Â --Â éå†zSetæ‰€æœ‰keyï¼Œå°†keyçš„è¶…æ—¶æ—¶é—´(score)Â -Â å½“å‰æ—¶é—´ms&lt;br/&gt;Â Â &lt;span&gt;for&lt;/span&gt;Â iÂ =Â &lt;span&gt;1&lt;/span&gt;,Â #keys,Â &lt;span&gt;1&lt;/span&gt;Â &lt;span&gt;do&lt;/span&gt;Â &lt;br/&gt;Â Â Â Â redis.call(&lt;span&gt;&#x27;zincrby&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â -tonumber(ARGV[&lt;span&gt;3&lt;/span&gt;]),Â keys[i]);&lt;br/&gt;Â Â end;&lt;br/&gt;Â Â Â Â --Â åŠ é”è®¾ç½®é”è¿‡æœŸæ—¶é—´&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;hset&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;],Â &lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;pexpire&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;1&lt;/span&gt;]);&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â nil;&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â &lt;span&gt;3&lt;/span&gt;.çº¿ç¨‹å­˜åœ¨ï¼Œé‡å…¥åˆ¤æ–­&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â redis.call(&lt;span&gt;&#x27;hexists&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;])Â ==Â &lt;span&gt;1&lt;/span&gt;Â then&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;hincrby&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;],&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;pexpire&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;],Â ARGV[&lt;span&gt;1&lt;/span&gt;]);&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â nil;&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â &lt;span&gt;4&lt;/span&gt;.è¿”å›å½“å‰çº¿ç¨‹å‰©ä½™å­˜æ´»æ—¶é—´&lt;br/&gt;localÂ timeoutÂ =Â redis.call(&lt;span&gt;&#x27;zscore&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;]);&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â timeoutÂ ~=Â &lt;span&gt;false&lt;/span&gt;Â then&lt;br/&gt;Â Â --Â è¿‡æœŸæ—¶é—´timeoutçš„å€¼åœ¨ä¸‹æ–¹è®¾ç½®ï¼Œæ­¤å¤„çš„å‡æ³•ç®—å‡ºçš„ä¾æ—§æ˜¯å½“å‰çº¿ç¨‹çš„ttl&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â timeoutÂ -Â tonumber(ARGV[&lt;span&gt;3&lt;/span&gt;])Â -Â tonumber(ARGV[&lt;span&gt;4&lt;/span&gt;]);&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â &lt;span&gt;5&lt;/span&gt;.å°¾èŠ‚ç‚¹å‰©ä½™å­˜æ´»æ—¶é—´&lt;br/&gt;localÂ lastThreadIdÂ =Â redis.call(&lt;span&gt;&#x27;lindex&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;],Â -&lt;span&gt;1&lt;/span&gt;);&lt;br/&gt;localÂ ttl;&lt;br/&gt;--Â å°¾èŠ‚ç‚¹ä¸ç©ºÂ &amp;amp;&amp;amp;Â å°¾èŠ‚ç‚¹éå½“å‰çº¿ç¨‹&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â lastThreadIdÂ ~=Â &lt;span&gt;false&lt;/span&gt;Â andÂ lastThreadIdÂ ~=Â ARGV[&lt;span&gt;2&lt;/span&gt;]Â then&lt;br/&gt;Â Â --Â è®¡ç®—é˜Ÿå°¾èŠ‚ç‚¹å‰©ä½™å­˜æ´»æ—¶é—´&lt;br/&gt;Â Â ttlÂ =Â tonumber(redis.call(&lt;span&gt;&#x27;zscore&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â lastThreadId))Â -Â tonumber(ARGV[&lt;span&gt;4&lt;/span&gt;]);&lt;br/&gt;&lt;span&gt;else&lt;/span&gt;&lt;br/&gt;Â Â --Â è·å–lock_nameå‰©ä½™å­˜æ´»æ—¶é—´&lt;br/&gt;Â Â ttlÂ =Â redis.call(&lt;span&gt;&#x27;pttl&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;1&lt;/span&gt;]);&lt;br/&gt;end;&lt;br/&gt;&lt;br/&gt;--Â &lt;span&gt;6&lt;/span&gt;.æœ«å°¾æ’é˜Ÿ&lt;br/&gt;--Â zSetÂ è¶…æ—¶æ—¶é—´ï¼ˆscoreï¼‰ï¼Œå°¾èŠ‚ç‚¹ttlÂ +Â å½“å‰æ—¶é—´Â +Â &lt;span&gt;5000&lt;/span&gt;msÂ +Â å½“å‰æ—¶é—´ï¼Œæ— åˆ™æ–°å¢ï¼Œæœ‰åˆ™æ›´æ–°&lt;br/&gt;--Â çº¿ç¨‹idæ”¾å…¥é˜Ÿåˆ—å°¾éƒ¨æ’é˜Ÿï¼Œæ— åˆ™æ’å…¥ï¼Œæœ‰åˆ™ä¸å†æ’å…¥&lt;br/&gt;localÂ timeoutÂ =Â ttlÂ +Â tonumber(ARGV[&lt;span&gt;3&lt;/span&gt;])Â +Â tonumber(ARGV[&lt;span&gt;4&lt;/span&gt;]);&lt;br/&gt;&lt;span&gt;if&lt;/span&gt;Â redis.call(&lt;span&gt;&#x27;zadd&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;3&lt;/span&gt;],Â timeout,Â ARGV[&lt;span&gt;2&lt;/span&gt;])Â ==Â &lt;span&gt;1&lt;/span&gt;Â then&lt;br/&gt;Â Â redis.call(&lt;span&gt;&#x27;rpush&#x27;&lt;/span&gt;,Â KEYS[&lt;span&gt;2&lt;/span&gt;],Â ARGV[&lt;span&gt;2&lt;/span&gt;]);&lt;br/&gt;end;&lt;br/&gt;&lt;span&gt;return&lt;/span&gt;Â ttl;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;1.å…¬å¹³é”åŠ é”æ­¥éª¤&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é€šè¿‡ä»¥ä¸ŠLuaï¼Œå¯ä»¥å‘ç°ï¼Œluaæ“ä½œçš„å…³é”®ç»“æ„æ˜¯åˆ—è¡¨ï¼ˆlistï¼‰å’Œæœ‰åºé›†åˆï¼ˆzSetï¼‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¶ä¸­listç»´æŠ¤äº†ä¸€ä¸ªç­‰å¾…çš„çº¿ç¨‹é˜Ÿåˆ—&lt;code&gt;redisson_lock_queue:{xxx}&lt;/code&gt;ï¼ŒzSetç»´æŠ¤äº†ä¸€ä¸ªçº¿ç¨‹è¶…æ—¶æƒ…å†µçš„æœ‰åºé›†åˆ&lt;code&gt;redisson_lock_timeout:{xxx}&lt;/code&gt;ï¼Œå°½ç®¡luaè¾ƒé•¿ï¼Œä½†æ˜¯å¯ä»¥æ‹†åˆ†ä¸º6ä¸ªæ­¥éª¤&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;1.é˜Ÿåˆ—æ¸…ç†&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;2.é¦–æ¬¡åŠ é”&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;3.é‡å…¥åˆ¤æ–­&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;4.è¿”å›ttl&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;5.è®¡ç®—å°¾èŠ‚ç‚¹ttl&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;6.æœ«å°¾æ’é˜Ÿ&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;ttl + 2 * currentTime + waitTime&lt;/code&gt;æ˜¯scoreçš„é»˜è®¤å€¼è®¡ç®—å…¬å¼&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;2.æ¨¡æ‹Ÿ&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœæ¨¡æ‹Ÿä»¥ä¸‹é¡ºåºï¼Œå°±ä¼šæ˜äº†redissonå…¬å¹³é”æ•´ä¸ªåŠ é”æµç¨‹&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å‡è®¾ &lt;code&gt;t1 10:00:00 &amp;lt; t2 10:00:10 &amp;lt; t3 10:00:20&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;t1ï¼šå½“çº¿ç¨‹1åˆæ¬¡è·å–é”&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;1.ç­‰å¾…é˜Ÿåˆ—æ— å¤´èŠ‚ç‚¹ï¼Œè·³å‡ºæ­»å¾ªç¯-&amp;gt;2&lt;/p&gt;&lt;p&gt;2.ä¸å­˜åœ¨è¯¥é” &amp;amp;&amp;amp; ä¸å­˜åœ¨çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ— æˆç«‹&lt;/p&gt;&lt;p&gt;2.1 lpopå’Œzermã€zincrbyéƒ½æ˜¯æ— æ•ˆæ“ä½œï¼Œåªæœ‰åŠ é”ç”Ÿæ•ˆï¼Œè¯´æ˜æ˜¯é¦–æ¬¡åŠ é”ï¼ŒåŠ é”åè¿”å›nil&lt;/p&gt;&lt;p&gt;åŠ é”æˆåŠŸï¼Œçº¿ç¨‹1è·å–åˆ°é”ï¼Œç»“æŸ&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;t2ï¼šçº¿ç¨‹2å°è¯•è·å–é”ï¼ˆçº¿ç¨‹1æœªé‡Šæ”¾é”ï¼‰&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;1.ç­‰å¾…é˜Ÿåˆ—æ— å¤´èŠ‚ç‚¹ï¼Œè·³å‡ºæ­»å¾ªç¯-&amp;gt;2&lt;/p&gt;&lt;p&gt;2.ä¸å­˜åœ¨è¯¥é” ä¸æˆç«‹-&amp;gt;3&lt;/p&gt;&lt;p&gt;3.éé‡å…¥çº¿ç¨‹ -&amp;gt;4&lt;/p&gt;&lt;p&gt;4.scoreæ— å€¼ -&amp;gt;5&lt;/p&gt;&lt;p&gt;5.å°¾èŠ‚ç‚¹ä¸ºç©ºï¼Œè®¾ç½®ttlåˆå§‹å€¼ä¸ºlock_nameçš„ttl -&amp;gt; 6&lt;/p&gt;&lt;p&gt;6.æŒ‰ç…§ttl + waitTime + currentTime + currentTime æ¥è®¾ç½®zSetè¶…æ—¶æ—¶é—´scoreï¼Œå¹¶ä¸”åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œçº¿ç¨‹2ä¸ºå¤´èŠ‚ç‚¹&lt;/p&gt;&lt;p&gt;score = 20S + 5000ms + 10:00:10 + 10:00:10 = 10:00:35 + 10:00:10&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;t3ï¼šçº¿ç¨‹3å°è¯•è·å–é”ï¼ˆçº¿ç¨‹1æœªé‡Šæ”¾é”ï¼‰&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;1.ç­‰å¾…é˜Ÿåˆ—æœ‰å¤´èŠ‚ç‚¹&lt;/p&gt;&lt;p&gt;1.1æœªè¿‡æœŸ-&amp;gt;2&lt;/p&gt;&lt;p&gt;2.ä¸å­˜åœ¨è¯¥é”ä¸æˆç«‹-&amp;gt;3&lt;/p&gt;&lt;p&gt;3.éé‡å…¥çº¿ç¨‹-&amp;gt;4&lt;/p&gt;&lt;p&gt;4.scoreæ— å€¼ -&amp;gt;5&lt;/p&gt;&lt;p&gt;5.å°¾èŠ‚ç‚¹ä¸ä¸ºç©º &amp;amp;&amp;amp; å°¾èŠ‚ç‚¹çº¿ç¨‹ä¸º2ï¼Œéå½“å‰çº¿ç¨‹&lt;/p&gt;&lt;p&gt;5.1å–å‡ºä¹‹å‰è®¾ç½®çš„scoreï¼Œå‡å»å½“å‰æ—¶é—´ï¼šttl = score - currentTime -&amp;gt;6&lt;/p&gt;&lt;p&gt;6.æŒ‰ç…§ttl + waitTime + currentTime + currentTime æ¥è®¾ç½®zSetè¶…æ—¶æ—¶é—´scoreï¼Œå¹¶ä¸”åŠ å…¥ç­‰å¾…é˜Ÿåˆ—&lt;/p&gt;&lt;p&gt;score = 10S + 5000ms + 10:00:20 + 10:00:20 = 10:00:35 + 10:00:20&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æ­¤ä¸€æ¥ï¼Œä¸‰ä¸ªéœ€è¦æŠ¢å¤ºä¸€æŠŠé”çš„çº¿ç¨‹ï¼Œå®Œæˆäº†ä¸€æ¬¡æ’é˜Ÿï¼Œåœ¨listä¸­æ’åˆ—ä»–ä»¬ç­‰å¾…çº¿ç¨‹idï¼Œåœ¨zSetä¸­å­˜æ”¾è¿‡æœŸæ—¶é—´ï¼ˆä¾¿äºæ’åˆ—ä¼˜å…ˆçº§ï¼‰ã€‚å…¶ä¸­è¿”å›ttlçš„çº¿ç¨‹2å®¢æˆ·ç«¯ã€çº¿ç¨‹3å®¢æˆ·ç«¯å°†ä¼šä¸€ç›´æŒ‰ä¸€å®šé—´éš”è‡ªæ—‹é‡å¤æ‰§è¡Œè¯¥æ®µLuaï¼Œå°è¯•åŠ é”ï¼Œå¦‚æ­¤ä¸€æ¥ä¾¿å’ŒAQSæœ‰äº†å¼‚æ›²åŒå·¥ä¹‹å¤„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œå½“çº¿ç¨‹1é‡Šæ”¾é”ä¹‹åï¼ˆè¿™é‡Œä¾æ—§æœ‰é€šè¿‡Pub/Subå‘å¸ƒè§£é”æ¶ˆæ¯ï¼Œé€šçŸ¥å…¶ä»–çº¿ç¨‹è·å–ï¼‰&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;10:00:30 çº¿ç¨‹2å°è¯•è·å–é”ï¼ˆçº¿ç¨‹1å·²é‡Šæ”¾é”ï¼‰&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;1.ç­‰å¾…é˜Ÿåˆ—æœ‰å¤´èŠ‚ç‚¹ï¼Œæœªè¿‡æœŸ-&amp;gt;2&lt;/p&gt;&lt;p&gt;2.ä¸å­˜åœ¨è¯¥é” &amp;amp; ç­‰å¾…é˜Ÿåˆ—å¤´èŠ‚ç‚¹æ˜¯å½“å‰çº¿ç¨‹ æˆç«‹&lt;/p&gt;&lt;p&gt;2.1åˆ é™¤å½“å‰çº¿ç¨‹çš„é˜Ÿåˆ—ä¿¡æ¯å’ŒzSetä¿¡æ¯ï¼Œè¶…æ—¶æ—¶é—´ä¸ºï¼š&lt;/p&gt;&lt;p&gt;çº¿ç¨‹2 10:00:35 + 10:00:10 - 10:00:30 = 10:00:15&lt;/p&gt;&lt;p&gt;çº¿ç¨‹3 10:00:35 + 10:00:20 - 10:00:30 = 10:00:25&lt;/p&gt;&lt;p&gt;2.2çº¿ç¨‹2è·å–åˆ°é”ï¼Œé‡æ–°è®¾ç½®è¿‡æœŸæ—¶é—´&lt;/p&gt;&lt;p&gt;åŠ é”æˆåŠŸï¼Œçº¿ç¨‹2è·å–åˆ°é”ï¼Œç»“æŸ&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ’é˜Ÿç»“æ„å¦‚å›¾&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3871277617675312&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/19cc2hfD2rA9CEavop032BOGjmsaVl4zLBGvibtoRWBodBPSgTM9l854uicKibL5Hoia27yyGfjzhZ7DfX98SB4INw/640?wx_fmt=other&amp;amp;random=0.35807781993817156&quot; data-type=&quot;other&quot; data-w=&quot;2082&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¬å¹³é”çš„é‡Šæ”¾è„šæœ¬å’Œé‡å…¥é”ç±»ä¼¼ï¼Œå¤šäº†ä¸€æ­¥åŠ é”å¼€å¤´çš„æ¸…ç†è¿‡æœŸkeyçš„while trueé€»è¾‘ï¼Œåœ¨æ­¤ä¸å†å±•å¼€ç¯‡å¹…æè¿°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç”±ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒRedissonå…¬å¹³é”çš„ç©æ³•ç±»ä¼¼äºå»¶è¿Ÿé˜Ÿåˆ—çš„ç©æ³•ï¼Œæ ¸å¿ƒéƒ½åœ¨Redisçš„Listå’ŒzSetç»“æ„çš„æ­é…ï¼Œä½†åˆå€Ÿé‰´äº†AQSå®ç°ï¼Œåœ¨å®šæ—¶åˆ¤æ–­å¤´èŠ‚ç‚¹ä¸Šå¦‚å‡ºä¸€è¾™ï¼ˆwatchDogï¼‰ï¼Œä¿è¯äº†é”çš„ç«äº‰å…¬å¹³å’Œäº’æ–¥ã€‚å¹¶å‘åœºæ™¯ä¸‹ï¼Œluaè„šæœ¬é‡Œï¼ŒzSetçš„scoreå¾ˆå¥½åœ°è§£å†³äº†é¡ºåºæ’å…¥çš„é—®é¢˜ï¼Œæ’åˆ—å¥½ä¼˜å…ˆçº§ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¹¶ä¸”ä¸ºäº†é˜²æ­¢å› å¼‚å¸¸è€Œé€€å‡ºçš„çº¿ç¨‹æ— æ³•æ¸…ç†ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ¤æ–­å¤´èŠ‚ç‚¹çš„è¿‡æœŸæƒ…å†µç»™äºˆæ¸…ç†ï¼Œæœ€åé‡Šæ”¾æ—¶é€šè¿‡CHANNELé€šçŸ¥è®¢é˜…çº¿ç¨‹å¯ä»¥æ¥è·å–é”ï¼Œé‡å¤ä¸€å¼€å§‹çš„æ­¥éª¤ï¼Œé¡ºåˆ©äº¤æ¥åˆ°ä¸‹ä¸€ä¸ªé¡ºåºçº¿ç¨‹ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;6. æ€»ç»“&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissonæ•´ä½“å®ç°åˆ†å¸ƒå¼åŠ è§£é”æµç¨‹çš„å®ç°ç¨æ˜¾å¤æ‚ï¼Œä½œè€…Rui Guå¯¹Nettyå’ŒJUCã€Redisç ”ç©¶æ·±å…¥ï¼Œåˆ©ç”¨äº†å¾ˆå¤šé«˜çº§ç‰¹æ€§å’Œè¯­ä¹‰ï¼Œå€¼å¾—æ·±å…¥å­¦ä¹ ï¼Œæœ¬æ¬¡ä»‹ç»ä¹Ÿåªæ˜¯å•æœºRedisä¸‹é”å®ç°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Redissonä¹Ÿæä¾›äº†å¤šæœºæƒ…å†µä¸‹çš„è”é”MultiLockï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;https://github.com/redisson/redisson/wiki/8.-åˆ†å¸ƒå¼é”å’ŒåŒæ­¥å™¨#81-å¯é‡å…¥é”reentrant-lock&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å’Œå®˜æ–¹æ¨èçš„çº¢é”RedLockï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;â€œ&lt;/span&gt;&lt;p&gt;https://github.com/redisson/redisson/wiki/8.-åˆ†å¸ƒå¼é”å’ŒåŒæ­¥å™¨#84-çº¢é”redlock&lt;/p&gt;&lt;span&gt;â€&lt;/span&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰€ä»¥ï¼Œå½“ä½ çœŸçš„éœ€è¦åˆ†å¸ƒå¼é”æ—¶ï¼Œä¸å¦¨å…ˆæ¥Redissoné‡Œæ‰¾æ‰¾ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;/p&gt;&lt;pre&gt;&lt;section data-recommend-type=&quot;list-normal&quot; data-recommend-tid=&quot;2&quot; data-mpa-template=&quot;t&quot; data-mid=&quot;&quot; data-from=&quot;yb-recommend&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501257_1&quot; data-recommend-article-time=&quot;1636251616&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/zc3KLDBfJlm8bD2WBlwbvnsktMdtfSudNaJWbHr1Iyr6HkwCxETHiaiceaWYLmq7tWmHV29U8Xv8UnoeCAOYNj9Q/0?wx_fmt=jpeg&amp;amp;amp;random=0.27521905775014543&quot; data-recommend-article-title=&quot;å¼ºåŠ¿å¼€æºä¸€æ¬¾å°ç¨‹åºï¼&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501257&amp;amp;idx=1&amp;amp;sn=7b4e27cdb1d3146a5e7e1951b5bdc9e8&amp;amp;chksm=c1ca33f9f6bdbaefd3874fa6313e422c8fb6b2799b40d09f36620f0ceaed4fd63c820da1f3ff#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501257&amp;amp;idx=1&amp;amp;sn=7b4e27cdb1d3146a5e7e1951b5bdc9e8&amp;amp;chksm=c1ca33f9f6bdbaefd3874fa6313e422c8fb6b2799b40d09f36620f0ceaed4fd63c820da1f3ff&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;å¼ºåŠ¿å¼€æºä¸€æ¬¾å°ç¨‹åºï¼&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-11-07&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42592592592592593&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/zc3KLDBfJlm8bD2WBlwbvnsktMdtfSudNaJWbHr1Iyr6HkwCxETHiaiceaWYLmq7tWmHV29U8Xv8UnoeCAOYNj9Q/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501242_1&quot; data-recommend-article-time=&quot;1634952613&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7UWibGeSzVdcKHzDRdVHusb9CJicA5FdhDVPAiaicdTbibx5XoRkhKA3O7Q727cTSurBkJpciczjLrF2wkA/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;å¼ºåŠ›æ¨èä¸€ä¸ªå®Œå–„çš„ç‰©æµï¼ˆWMSï¼‰ç®¡ç†é¡¹ç›®ï¼ˆé™„ä»£ç ï¼‰&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501242&amp;amp;idx=1&amp;amp;sn=aa2297b69874de0993f62ea404376bab&amp;amp;chksm=c1ca338af6bdba9cf3e051ff3001e1f31f9fa97350f3851c797d6486eca360df537196dbe67b#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501242&amp;amp;idx=1&amp;amp;sn=aa2297b69874de0993f62ea404376bab&amp;amp;chksm=c1ca338af6bdba9cf3e051ff3001e1f31f9fa97350f3851c797d6486eca360df537196dbe67b&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;å¼ºåŠ›æ¨èä¸€ä¸ªå®Œå–„çš„ç‰©æµï¼ˆWMSï¼‰ç®¡ç†é¡¹ç›®ï¼ˆé™„ä»£ç ï¼‰&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-10-23&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.425&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7UWibGeSzVdcKHzDRdVHusb9CJicA5FdhDVPAiaicdTbibx5XoRkhKA3O7Q727cTSurBkJpciczjLrF2wkA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501238_1&quot; data-recommend-article-time=&quot;1634606700&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VduLA9tc9dQkaw5HWIV6pqNrOiciaE17jeIeTtoLfgLbyu67dWkRj3tjKX7AFIMrV0rKD5ic6kwicyxg/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;æ¨èä¸€ä¸ª Spring Boot + MyBatis + Vue éŸ³ä¹ç½‘ç«™&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501238&amp;amp;idx=1&amp;amp;sn=d7e873d752a28b582d70bc9f7a981ddb&amp;amp;chksm=c1ca3386f6bdba9031ce115e734ce04c9b6728e8e027fbcf17d8d07f1e029ea5bea04f4a6273#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501238&amp;amp;idx=1&amp;amp;sn=d7e873d752a28b582d70bc9f7a981ddb&amp;amp;chksm=c1ca3386f6bdba9031ce115e734ce04c9b6728e8e027fbcf17d8d07f1e029ea5bea04f4a6273&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;æ¨èä¸€ä¸ª Spring Boot + MyBatis + Vue éŸ³ä¹ç½‘ç«™&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-10-19&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42592592592592593&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VduLA9tc9dQkaw5HWIV6pqNrOiciaE17jeIeTtoLfgLbyu67dWkRj3tjKX7AFIMrV0rKD5ic6kwicyxg/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501208_1&quot; data-recommend-article-time=&quot;1632101100&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VibcP3PNgQvXGZ7UJkVeu0JZsrldvF1urHlmNwhUP89IeKHz1PfJ12es2ArTwkYibAh3Y0soOib2rjA/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;åˆ†äº«ä¸€å¥—å®¶åº­ç†è´¢ç³»ç»Ÿï¼ˆé™„æºç ï¼‰&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501208&amp;amp;idx=1&amp;amp;sn=44fcdfe2d7f81a26845faf33750ea9bb&amp;amp;chksm=c1ca33a8f6bdbabec8ff34719f438465adf745cbef30bfb92be53897c714d8c13bdd01989d17#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501208&amp;amp;idx=1&amp;amp;sn=44fcdfe2d7f81a26845faf33750ea9bb&amp;amp;chksm=c1ca33a8f6bdbabec8ff34719f438465adf745cbef30bfb92be53897c714d8c13bdd01989d17&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;åˆ†äº«ä¸€å¥—å®¶åº­ç†è´¢ç³»ç»Ÿï¼ˆé™„æºç ï¼‰&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-09-20&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42407407407407405&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VibcP3PNgQvXGZ7UJkVeu0JZsrldvF1urHlmNwhUP89IeKHz1PfJ12es2ArTwkYibAh3Y0soOib2rjA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501192_1&quot; data-recommend-article-time=&quot;1630718700&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7UG0pYPldneUCCVsPia3Rtr9j3hlFHakhItFlOXuwLicUqQvP1PhkTM28CUU9BpRCWfWPfHYredCBiaA/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;æ¨èä¸€ä¸ªäº’è”ç½‘ä¼ä¸šçº§åˆ«çš„å¼€æºæ”¯ä»˜ç³»ç»Ÿ&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501192&amp;amp;idx=1&amp;amp;sn=444404a565f02a8c532d291d99678a7b&amp;amp;chksm=c1ca33b8f6bdbaaeb7c65d9f6f0c399f609fb203f065b6e88a3ad5431473713dbb5ae3507b32#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501192&amp;amp;idx=1&amp;amp;sn=444404a565f02a8c532d291d99678a7b&amp;amp;chksm=c1ca33b8f6bdbaaeb7c65d9f6f0c399f609fb203f065b6e88a3ad5431473713dbb5ae3507b32&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;æ¨èä¸€ä¸ªäº’è”ç½‘ä¼ä¸šçº§åˆ«çš„å¼€æºæ”¯ä»˜ç³»ç»Ÿ&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-09-04&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.425&quot; data-type=&quot;jpeg&quot; data-w=&quot;1080&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7UG0pYPldneUCCVsPia3Rtr9j3hlFHakhItFlOXuwLicUqQvP1PhkTM28CUU9BpRCWfWPfHYredCBiaA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501176_1&quot; data-recommend-article-time=&quot;1629509100&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VQRwetNLhDOB2Ej0fDZK4eRXsYlRNicgmsWwmuvlhibooic3N3su1lbMQPqWD186JiaOC5yJ9iaaic8bzw/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;æ¨èä¸€å¥—å¼€æºé€šç”¨åå°ç®¡ç†ç³»ç»Ÿï¼ˆé™„æºç ï¼‰&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501176&amp;amp;idx=1&amp;amp;sn=68e3ae7a9dc33fbbd379906ddcefdf5b&amp;amp;chksm=c1ca3348f6bdba5e1774625745f5ef40081c9b8eb0189073734b6808efb872720781d25b8dc0#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501176&amp;amp;idx=1&amp;amp;sn=68e3ae7a9dc33fbbd379906ddcefdf5b&amp;amp;chksm=c1ca3348f6bdba5e1774625745f5ef40081c9b8eb0189073734b6808efb872720781d25b8dc0&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;æ¨èä¸€å¥—å¼€æºé€šç”¨åå°ç®¡ç†ç³»ç»Ÿï¼ˆé™„æºç ï¼‰&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-08-21&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4265625&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VQRwetNLhDOB2Ej0fDZK4eRXsYlRNicgmsWwmuvlhibooic3N3su1lbMQPqWD186JiaOC5yJ9iaaic8bzw/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501153_1&quot; data-recommend-article-time=&quot;1627704022&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7UbyFoOMqOObokEYiahCar20LiaY8ZLGKzU7NYQQoGycgnhrmIzNJibPicGcNia3cbbXlYib6bcLJVV5aww/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;ä¸€æ¬¾ç¥ä»™æ¥ç§æ´»å„¿è½¯ä»¶ï¼ŒåŠåˆ°ä¸è¡Œï¼&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501153&amp;amp;idx=1&amp;amp;sn=bb29cffa56431b72a92709c0ae993af7&amp;amp;chksm=c1ca3351f6bdba4729c671cdcd0ee8b6af75c6ce8a7003e6c032942b849aab5bfedecd0f9d3b#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501153&amp;amp;idx=1&amp;amp;sn=bb29cffa56431b72a92709c0ae993af7&amp;amp;chksm=c1ca3351f6bdba4729c671cdcd0ee8b6af75c6ce8a7003e6c032942b849aab5bfedecd0f9d3b&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;ä¸€æ¬¾ç¥ä»™æ¥ç§æ´»å„¿è½¯ä»¶ï¼ŒåŠåˆ°ä¸è¡Œï¼&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-07-31&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4265625&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7UbyFoOMqOObokEYiahCar20LiaY8ZLGKzU7NYQQoGycgnhrmIzNJibPicGcNia3cbbXlYib6bcLJVV5aww/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501139_1&quot; data-recommend-article-time=&quot;1626571500&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VGxZrbRFy96Sm9cXQzVEhiaLibUUYhYH1SJL4HUXenau3DCeq0KEOsguY4CWjaEd1BeAicJd24qFM2w/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;åŸºäº SpringBoot çš„ä»¿è±†ç“£å¹³å°ã€æºç åˆ†äº«ã€‘&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501139&amp;amp;idx=1&amp;amp;sn=f133e70bda8abae27459ccc4d3d6d8fd&amp;amp;chksm=c1ca3363f6bdba75b9a4145510d9b6108c56146a3146b2e2e6d660a08221618b01c815d55642#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501139&amp;amp;idx=1&amp;amp;sn=f133e70bda8abae27459ccc4d3d6d8fd&amp;amp;chksm=c1ca3363f6bdba75b9a4145510d9b6108c56146a3146b2e2e6d660a08221618b01c815d55642&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;åŸºäº SpringBoot çš„ä»¿è±†ç“£å¹³å°ã€æºç åˆ†äº«ã€‘&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-07-18&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42427884615384615&quot; data-type=&quot;jpeg&quot; data-w=&quot;832&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VGxZrbRFy96Sm9cXQzVEhiaLibUUYhYH1SJL4HUXenau3DCeq0KEOsguY4CWjaEd1BeAicJd24qFM2w/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501105_1&quot; data-recommend-article-time=&quot;1623979500&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7Xw68Ow8vZian4lanQFAu09f4JOZlXbC85jsByb8V6StkOpibAdgPamPWoPPY3G7S3nic50QvxxuGNrg/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;å¹²æ‰ Wordpressï¼è¿™ä¸ªå¼€æºå»ºç«™ç¥å™¨æœ‰ç‚¹åŠï¼&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501105&amp;amp;idx=1&amp;amp;sn=caf01186b6d2e4a38e940ce07d822238&amp;amp;chksm=c1ca3301f6bdba17ba7127da24e28963ae40f944e587f14b57405e2a9ee9d8cdbcb835c880c8#rd&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501105&amp;amp;idx=1&amp;amp;sn=caf01186b6d2e4a38e940ce07d822238&amp;amp;chksm=c1ca3301f6bdba17ba7127da24e28963ae40f944e587f14b57405e2a9ee9d8cdbcb835c880c8&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;å¹²æ‰ Wordpressï¼è¿™ä¸ªå¼€æºå»ºç«™ç¥å™¨æœ‰ç‚¹åŠï¼&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;2021-06-18&lt;/p&gt;&lt;/section&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42578125&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7Xw68Ow8vZian4lanQFAu09f4JOZlXbC85jsByb8V6StkOpibAdgPamPWoPPY3G7S3nic50QvxxuGNrg/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/section&gt;&lt;/a&gt;&lt;/section&gt;&lt;section data-mpa-template=&quot;t&quot; data-recommend-article-type=&quot;list-normal&quot; data-recomment-template-id=&quot;2&quot; data-recommend-article-id=&quot;2247501098_2&quot; data-recommend-article-time=&quot;1623461160&quot; data-recommend-article-cover=&quot;http://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VzIP6xibP6U8htKa7YEad1iaTE02ZbsOfvDX1D8LoTiaNsMVgdjFOdm5LahpnNXFe3ibSp8S4FJ39KkA/0?wx_fmt=jpeg&quot; data-recommend-article-title=&quot;ä»æœ‹å‹é‚£é‡Œæäº† 20 ä¸ªå®æˆ˜é¡¹ç›®ï¼Œé€Ÿé¢†ï¼&quot; data-recommend-article-content-url=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501098&amp;amp;idx=2&amp;amp;sn=520b81839bb5b4f1c990278e03e1991d&amp;amp;chksm=c1ca331af6bdba0c0e3435da519fadda3be81744168e30c56a823180bd458a5ec8a6b499f2a4#rd&quot;&gt;&lt;section data-recommend-content=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501098&amp;amp;idx=2&amp;amp;sn=520b81839bb5b4f1c990278e03e1991d&amp;amp;chksm=c1ca331af6bdba0c0e3435da519fadda3be81744168e30c56a823180bd458a5ec8a6b499f2a4&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot;&gt;ä»æœ‹å‹é‚£é‡Œæäº† 20 ä¸ªå®æˆ˜é¡¹ç›®ï¼Œé€Ÿé¢†ï¼&lt;/a&gt;&lt;/p&gt;&lt;p data-recommend-date=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501098&amp;amp;idx=2&amp;amp;sn=520b81839bb5b4f1c990278e03e1991d&amp;amp;chksm=c1ca331af6bdba0c0e3435da519fadda3be81744168e30c56a823180bd458a5ec8a6b499f2a4&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;2&quot; wah-hotarea=&quot;click&quot;&gt;2021-06-12&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;a href=&quot;http://mp.weixin.qq.com/s?__biz=MzkyNTI5NTQ1NQ==&amp;amp;mid=2247501098&amp;amp;idx=2&amp;amp;sn=520b81839bb5b4f1c990278e03e1991d&amp;amp;chksm=c1ca331af6bdba0c0e3435da519fadda3be81744168e30c56a823180bd458a5ec8a6b499f2a4&amp;amp;scene=21#wechat_redirect&quot; data-linktype=&quot;1&quot; wah-hotarea=&quot;click&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-type=&quot;jpeg&quot; data-w=&quot;200&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/Baq5lYpIw7VzIP6xibP6U8htKa7YEad1iaTE02ZbsOfvDX1D8LoTiaNsMVgdjFOdm5LahpnNXFe3ibSp8S4FJ39KkA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4703703703703704&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Baq5lYpIw7X6YPYGQITyP8Zdk96ab7CX0Ind5E05VokoepTP9Adic0xRwiaQrAvfTeC7iafngRibhBShpVqibqNcCCA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;1080&quot;/&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚æœ‰æ”¶è·ï¼Œç‚¹ä¸ªåœ¨çœ‹ï¼Œè¯šæŒšæ„Ÿè°¢&lt;/span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-fileid=&quot;100018364&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/fEsWkVrSk54JM0xl7WLNGnqqwbcXQBWIOCMuOgPHRoOjMamXzrCqMS2xgOo5ibic9icPk7u3zsVgic3s1ZUYJ4xHXg/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;19&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>2db63b691ae0141504e170bab0516fce</guid>
<title>å¦‚ä½•åšå¥½åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦â€”â€”Scheduler çš„ä¸€äº›æ¢ç´¢</title>
<link>https://toutiao.io/k/jp5tr8p</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-id=&quot;MzI1MzYzMjE0MQ==&quot; data-pluginname=&quot;mpprofile&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhkoWTP1gVm0Lqs480XOARyoSYjPEsRVCSF35cbWIp6cliaYic8KUfNfiaSjVnruzTQUTCA0lmv9vUmw/0?wx_fmt=png&quot; data-nickname=&quot;å­—èŠ‚è·³åŠ¨æŠ€æœ¯å›¢é˜Ÿ&quot; data-alias=&quot;BytedanceTechBlog&quot; data-signature=&quot;å­—èŠ‚è·³åŠ¨çš„æŠ€æœ¯å®è·µåˆ†äº«&quot; data-from=&quot;2&quot; data-is_biz_ban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;åŠ¨æ‰‹ç‚¹å…³æ³¨Â å¹²è´§ä¸è¿·è·¯&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;Â ğŸ‘†&lt;/span&gt;&lt;/p&gt;&lt;blockquote data-type=&quot;quote_container&quot;&gt;&lt;p&gt;ä½œè€…ï¼šå¼ å®‡è½©ï¼Œç« é€¸ï¼Œæ›¾ä¸¹&lt;/p&gt;&lt;/blockquote&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åˆè¯† Scheduler&lt;/p&gt;&lt;/section&gt;&lt;h2&gt;æ‰¾å‡†å®šä½ï¼šåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°&lt;/h2&gt;&lt;p&gt;&lt;span&gt;æ— è®ºæ˜¯äº’è”ç½‘åº”ç”¨æˆ–è€…ä¼ä¸šçº§åº”ç”¨ï¼Œéƒ½å……æ–¥ç€å¤§é‡çš„ä»»åŠ¡ã€‚æˆ‘ä»¬å¸¸å¸¸éœ€è¦ä¸€äº›ä»»åŠ¡è°ƒåº¦ç³»ç»Ÿå¸®åŠ©æˆ‘ä»¬è§£å†³é—®é¢˜ã€‚éšç€å¾®æœåŠ¡åŒ–æ¶æ„çš„é€æ­¥æ¼”è¿›ï¼Œå•ä½“æ¶æ„é€æ¸æ¼”å˜ä¸ºåˆ†å¸ƒå¼ã€å¾®æœåŠ¡æ¶æ„ã€‚åœ¨æ­¤çš„èƒŒæ™¯ä¸‹ï¼Œå¾ˆå¤šåŸå…ˆçš„å•ç‚¹å¼ä»»åŠ¡è°ƒåº¦å¹³å°å·²ç»ä¸èƒ½æ»¡è¶³ä¸šåŠ¡ç³»ç»Ÿçš„éœ€æ±‚ã€‚äºæ˜¯å‡ºç°äº†ä¸€äº›åŸºäºåˆ†å¸ƒå¼çš„ä»»åŠ¡è°ƒåº¦å¹³å°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Scheduler æ˜¯é£ä¹¦å†…çš„åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ã€‚åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦èƒ½åŠ›ä¸»è¦åŒ…æ‹¬ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ul start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;åˆ†å¸ƒå¼ï¼šå¹³å°æ˜¯åˆ†å¸ƒå¼éƒ¨ç½²çš„ï¼Œå„ä¸ªèŠ‚ç‚¹ä¹‹é—´å¯ä»¥æ— çŠ¶æ€å’Œæ— é™çš„æ°´å¹³æ‰©å±•ï¼ˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;ä¿è¯å¯æ‰©å±•ï¼‰ï¼›&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;ä»»åŠ¡è°ƒåº¦ï¼šæ¶‰&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;åŠåˆ°ä»»åŠ¡çŠ¶æ€ç®¡ç†ã€ä»»åŠ¡è°ƒåº¦è¯·æ±‚çš„å‘é€ä¸æ¥æ”¶ã€å…·ä½“ä»»åŠ¡çš„åˆ†é…ã€ä»»åŠ¡çš„å…·ä½“æ‰§è¡Œï¼›ï¼ˆé›†ç¾¤ä¸­å“ªäº›æœºå™¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œä»€ä¹ˆä»»åŠ¡ï¼Œæ‰€ä»¥åˆéœ€è¦ä¸€ä¸ªå¯ä»¥æ„ŸçŸ¥æ•´ä¸ªé›†ç¾¤è¿è¡ŒçŠ¶æ€çš„é…ç½®ä¸­å¿ƒï¼‰ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;é…ç½®ä¸­å¿ƒï¼šå¯ä»¥æ„ŸçŸ¥æ•´ä¸ªé›†ç¾¤çš„çŠ¶æ€ã€ä»»åŠ¡ä¿¡æ¯çš„æ³¨å†Œã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;æ‘¸æ¸…è„‰ç»œï¼šSchedulerçš„ç»“æ„å’Œæ ¸å¿ƒæ¨¡å—&lt;/h2&gt;&lt;blockquote data-type=&quot;quote_container&quot;&gt;&lt;p&gt;&lt;strong&gt;åè¯è§£é‡Šï¼š&lt;/strong&gt;&lt;/p&gt;&lt;ul start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;Processor: ç¼–ç¨‹å¤„ç†å™¨, æ‹¥æœ‰ä¸€å®šçš„ç¼–ç¨‹è§„èŒƒ, ç”¨æˆ·è‡ªå®šä¹‰å®ç°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;Executor: ä¸€ä¸ª SDKï¼Œè¿è¡Œ Processor çš„è¿›è¡Œå®¹å™¨ï¼Œä¸ Scheduler é€šä¿¡çš„è½½ä½“ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;Jobï¼šç”¨æˆ·åˆ›å»ºçš„ä»»åŠ¡ï¼Œå…¶ä¸­åŒ…å«ä»»åŠ¡çš„è°ƒåº¦è§„åˆ™ã€è°ƒåº¦æ¨¡å‹ã€æ‰§è¡Œå™¨åç§°ç­‰ä¿¡æ¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;Instanceï¼šè¿è¡Œæ€çš„Jobï¼Œæ¯å½“Jobè§¦å‘åä¼šç”Ÿæˆä¸€ä¸ªInstanceï¼Œè®°å½•æœ¬æ¬¡æ‰§è¡Œçš„è°ƒåº¦ä¿¡æ¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;Taskï¼šæœ€å°æ‰§è¡Œå•å…ƒï¼Œä¸åŒè°ƒåº¦æ¨¡å‹çš„ä»»åŠ¡äº§ç”Ÿçš„Taskæ•°é‡ä¸åŒã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/blockquote&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.7116071428571429&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4sSGiaIXXWIYibdzfKibuy2boZI1K4gXF8DogCMg32ic7zeia7bu38fwOnEA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1120&quot;/&gt;&lt;span/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;é€šè¿‡æ¶æ„å›¾å¯ä»¥å‘ç°ï¼ŒSchedulerä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;è°ƒåº¦å™¨ (Scheduler)ï¼šä»»åŠ¡è°ƒåº¦ä¸­å¿ƒï¼Œè´Ÿè´£ç®¡ç†ä»»åŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚æ¥å—ä»»åŠ¡æ³¨å†Œï¼Œå‡†æ—¶å‡†ç¡®æ‰¾å‡ºå¾…è§¦å‘çš„ä»»åŠ¡ï¼Œè¿›è¡Œä»»åŠ¡æ‹†åˆ†ä¸‹å‘ã€‚æ‰¾å‡ºä¸ä¹‹å…³è”çš„æ‰§è¡Œå™¨å¹¶ä¸‹å‘å¯¹åº”ä»»åŠ¡ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ‰§è¡Œå™¨ (Executor)ï¼šæ¥æ”¶è°ƒåº¦ä»»åŠ¡ï¼Œå¹¶å°†è‡ªèº«çŠ¶æ€ä¸ŠæŠ¥ç»™è°ƒåº¦å™¨ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ§åˆ¶å° (Web å‰ç«¯)ï¼šè´Ÿè´£é…ç½®æ‰§è¡Œå™¨çš„ä¿¡æ¯ä»¥åŠè°ƒåº¦ä»»åŠ¡çš„é…ç½®ã€ä»»åŠ¡çŠ¶æ€ã€ä¿¡æ¯å±•ç¤ºã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€å¥è¯è§£é‡Šæ¸…æ¥š Scheduler æ‰€åšçš„äº‹æƒ…ï¼Œå³ï¼š&lt;/span&gt;&lt;strong&gt;&lt;span&gt;åœ¨ã€ŒæŒ‡å®šæ—¶é—´ã€ã€Œé€šçŸ¥æ‰§è¡Œå™¨ã€ä»¥ã€ŒæŒ‡å®šæ–¹å¼ã€æ‰§è¡Œä»»åŠ¡&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è¿™å¥è¯ä¸­åŒ…å«äº†ä¸‰ä¸ªå…³é”®ç‚¹ï¼Œä¹Ÿåˆ†åˆ«ä»£è¡¨ç€ Scheduler çš„ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æŒ‡å®šæ—¶é—´&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šä»»åŠ¡çš„è§¦å‘è§„åˆ™ï¼Œå¦‚ï¼šæ¯å¤©æ—©ä¸Š8ç‚¹ã€æ¯å‘¨äºŒã€æ¯æœˆ15å·ç­‰ã€‚&lt;strong&gt;è§¦å‘å™¨æ¨¡å—&lt;/strong&gt;ï¼ˆLauncher Cronï¼‰è´Ÿè´£ä»»åŠ¡è§¦å‘ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æŒ‡å®šæ–¹å¼&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šä»»åŠ¡çš„æ‰§è¡Œå½¢å¼ï¼Œå¦‚ï¼šå•æ’­ä»»åŠ¡-æŒ‡å®šä¸€ä¸ªæœºå™¨æ‰§è¡Œï¼›å¹¿æ’­ä»»åŠ¡-æŒ‡å®šæ‰€æœ‰æœºå™¨æ‰§è¡Œï¼›åˆ†ç‰‡ä»»åŠ¡-ä»»åŠ¡åˆ†é˜¶æ®µåˆ†æ‰¹çš„æ‰§è¡Œã€‚&lt;strong&gt;åˆ†æ´¾å™¨æ¨¡å—&lt;/strong&gt;ï¼ˆAssignment Cronï¼‰è´Ÿè´£ä»»åŠ¡çš„æ‰§è¡Œæ–¹å¼ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;é€šçŸ¥æ‰§è¡Œå™¨&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šå°†ä»»åŠ¡å‘é€åˆ°æŒ‡å®šæ‰§è¡Œå™¨ï¼Œæ‰§è¡Œä»»åŠ¡ã€‚&lt;strong&gt;æ´¾é£å™¨æ¨¡å—&lt;/strong&gt;ï¼ˆDispatcher Cronï¼‰è´Ÿè´£ä»»åŠ¡çš„å‘é€ï¼Œé‡‡ç”¨æµå¼é€šä¿¡ï¼Œè°ƒåº¦å™¨ä»¥&lt;strong&gt;æ¨é€&lt;/strong&gt;çš„æ–¹å¼å°†ä»»åŠ¡å‘é€ç»™æ‰§è¡Œå™¨ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;åœ¨ä¸€ä¸ªJobçš„è°ƒåº¦å‘¨æœŸä¸­ï¼Œå„ä¸ªæ¨¡å—å„å¸å…¶èŒï¼Œæ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.209375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4A59zI8eK454p5icQjusOLRykMWwGiah7PwmDn98liaicicJx6ibYuKWhnzWA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;æ‹¥æœ‰è¿™ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—åï¼ŒScheduler å·²å…·å¤‡äº†æˆç†Ÿçš„ä»»åŠ¡è°ƒåº¦åŠŸèƒ½ã€‚å¦å¤–ï¼Œä¸ºäº†å¢åŠ  Scheduler çš„ç¨³å®šæ€§ï¼Œæœ‰é¢å¤–ä¸¤ä¸ªæ¨¡å—ä¸ºå…¶ä¿é©¾æŠ¤èˆªï¼š&lt;/span&gt;&lt;/section&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;å¥åº·ç®¡ç†æ¨¡å—&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt; (Service Health Cron): è´Ÿè´£ç®¡ç† Job çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ£€æµ‹æœªæ­£å¸¸æ´¾å‘æ‰§è¡Œçš„ Jobã€Instance å’Œ Taskï¼Œå¹¶å°†ç»“æœä¸ŠæŠ¥ç»™è¿ç»´äººå‘˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;ä»»åŠ¡è¿›åº¦åˆ·æ–°æ¨¡å—&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt; (Task Cron): å¼‚æ­¥æ›´æ–° Task çŠ¶æ€ï¼Œæµé‡è¾ƒé«˜æ—¶è¿›è¡Œå‰Šå³°ï¼Œä¿è¯ä¾èµ–çš„ mysql åŠ redis ä¸å› ä¸ºæµé‡è¿‡é«˜è€Œå‡ºç°é—®é¢˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;æœ¬ç¯‡æ–‡ç« ä¸å¯¹ Scheduler æ‰€æ”¯æŒçš„å®šæ—¶ä»»åŠ¡èƒ½åŠ›ä½œèµ˜è¿°ï¼Œè€Œæ˜¯ä»ä¸‰ä¸ªæ–¹é¢ï¼ˆ&lt;strong&gt;æ˜“ç”¨æ€§ã€å¤šåŠŸèƒ½æ€§ã€ç¨³å®šæ€§&lt;/strong&gt;ï¼‰ä»‹ç» Scheduler å¯¹äºåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦çš„æ€è€ƒå’Œæ¢ç´¢ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;ã€Œæ˜“ç”¨æ€§ã€&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;: å†³å®šäº†ç”¨æˆ·æ˜¯å¦é€‰æ‹©ä½¿ç”¨è¯¥æ¡†æ¶çš„æ„æ„¿ï¼Œä¸€ä¸ªå¥½çš„æ¡†æ¶å¿…é¡»æ˜¯æ˜“ç”¨ä¸”å¿«é€Ÿæ¥å…¥çš„ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;ã€Œå¤šåŠŸèƒ½æ€§ã€&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;: æ¥å…¥æ–¹éœ€æ±‚å¤šç§å¤šæ ·ï¼Œè¦ç«™åœ¨ç”¨æˆ·è§’åº¦æƒ³é—®é¢˜ï¼Œä¸èƒ½é—­é—¨é€ è½¦ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;ã€Œç¨³å®šæ€§ã€&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;: å¯¹äºåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°æ¥è¯´ï¼Œä¸ä»…ä»…å±€é™äºè‡ªèº«çš„ç¨³å®šæ€§ï¼Œæ¥å…¥æ–¹çš„ç¨³å®šæ€§ä¹Ÿååˆ†é‡è¦ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h1&gt;æ¢ä½æ€è€ƒ-å¿«é€Ÿæ¥å…¥&lt;/h1&gt;&lt;h2&gt;èƒŒæ™¯ï¼šæ•ˆç‡è‡³ä¸Šï¼Œæ—¶é—´æ˜¯é‡‘&lt;/h2&gt;&lt;p&gt;&lt;span&gt;ä»¥å­—èŠ‚è·³åŠ¨å†…éƒ¨ä¸ºä¾‹ï¼Œå½“å‰å›¢é˜Ÿæƒ³è¦å®ç°ä¸€ä¸ªå®šæ—¶ä»»åŠ¡æœ‰å¤šç§æ–¹å¼ï¼šæ¥å…¥å­—èŠ‚äº‘çš„ cronjob å¹³å°ã€è‡ªå·±å®ç°ä¸€å¥—å®šæ—¶ä»»åŠ¡æ¡†æ¶æˆ–è€…æ¥å…¥ç¬¬ä¸‰æ–¹å®šæ—¶ä»»åŠ¡æ¡†æ¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¯¹äºç¬¬ä¸€ç§æ¥å…¥ cronjob å¹³å°ï¼Œæ¯ä¸€ç§å®šæ—¶ä»»åŠ¡éƒ½éœ€è¦æ³¨å†Œå„è‡ªçš„ psm å’Œè¿è¡Œæ—¶ç¯å¢ƒï¼ˆé•œåƒï¼‰ï¼Œå½“ä»»åŠ¡éœ€è¦è®¿é—®ä¾èµ–èµ„æºå¦‚ redis/db ç­‰æ—¶ï¼Œéœ€è¦å„è‡ªæ·»åŠ æˆæƒã€‚ä»»åŠ¡ä»£ç é€»è¾‘æœ‰å˜åŒ–æ—¶ä¹Ÿéœ€è¦å„è‡ªå‡çº§ï¼Œå¯¼è‡´å¼€å‘ã€ç®¡ç†èµ·æ¥è¾ƒä¸ºå¤æ‚ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¯¹äºç¬¬äºŒç§è‡ªå·±å®ç°ä¸€å¥—å®šæ—¶ä»»åŠ¡æ¡†æ¶ï¼Œä¸ä»…æ•´ä½“å¼€å‘æ—¶é—´è¾ƒé•¿ï¼Œä¸”éœ€è¦å¤§é‡æ—¶é—´è¿›è¡Œæµ‹è¯•å›å½’æ¥ä¿è¯æ¡†æ¶çš„ç¨³å®šæ€§ã€‚å¦‚æœé¡¹ç›®å†…ä½¿ç”¨åˆ°çš„å®šæ—¶ä»»åŠ¡è¾ƒå¤šï¼Œé‚£ä¹ˆè‡ªèº«ç ”å‘ä¸€å¥—æ¡†æ¶ç”¨é€”ä¹Ÿè¾ƒå¹¿æ³›ï¼›è‹¥é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„å®šæ—¶ä»»åŠ¡è¾ƒå°‘ï¼Œåˆ™ ROI è¾ƒä½ï¼Œå¾ˆå¤šæ—¶å€™ä¹Ÿåªæ˜¯ä¸ºäº†é€ è½®å­è€Œé€ è½®å­ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å› æ­¤ï¼Œå¤§å¤šæ•°é¡¹ç›®é¢å¯¹å¢åŠ å®šæ—¶ä»»åŠ¡çš„éœ€æ±‚æ—¶ï¼Œéƒ½ä¼šå¯»æ±‚ç›´æ¥æ¥å…¥ç¬¬ä¸‰æ–¹æˆç†Ÿçš„å®šæ—¶ä»»åŠ¡æ¡†æ¶ã€‚å¯¹äºä»–ä»¬æ¥è¯´ï¼Œæ˜¯å¦æ˜“äºæ¥å…¥ã€ä¸ç°æœ‰ä»£ç è”ç³»æ˜¯å¦ç´§å¯†ã€è°ƒè¯•æ˜¯å¦æ–¹ä¾¿æ˜¯å¾ˆé‡è¦çš„é€‰å–æŒ‡æ ‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åŸºäºè¿™ç§èƒŒæ™¯ï¼ŒScheduler åœ¨è®¾è®¡æ—¶å°±ç«™åœ¨äº†æ¥å…¥æ–¹çš„è§’åº¦ï¼Œæ€è€ƒäº†å¦‚ä½•è®©æ¥å…¥æ–¹èƒ½å¤Ÿåœ¨æœ€çŸ­æ—¶é—´å†…ä»¥æœ€ä½æˆæœ¬æ¥å…¥ Schedulerï¼Œå®ç°è‡ªå·±çš„å®šæ—¶ä»»åŠ¡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;åˆ†æï¼šç«™åœ¨ç”¨æˆ·è§’åº¦æƒ³é—®é¢˜&lt;/h2&gt;&lt;p&gt;&lt;span&gt;ç«™åœ¨æ¥å…¥æ–¹è§’åº¦ï¼Œå¯¹å®šæ—¶ä»»åŠ¡æ¡†æ¶è¿›è¡Œé€‰å‹æ—¶æœ€å…³æ³¨çš„å‡ ä¸ªç‚¹æ— éæ˜¯å®šæ—¶ä»»åŠ¡æ‰§è¡Œå‡†ç¡®æ€§ã€æœ€é«˜æ”¯æŒ qpsã€å®šæ—¶è®¾ç½®å¤šæ ·æ€§ã€æ¥å…¥æˆæœ¬è¿™å‡ ä¸ªã€‚å¯¹äºå‰ä¸¤ä¸ªæŒ‡æ ‡ï¼ŒScheduler ç›®å‰æ¥å…¥ä¸šåŠ¡æ–¹ 50+ï¼Œæ—¥å‡è°ƒåº¦ä»»åŠ¡ 20w+ æ¬¡ï¼Œä¸å…¬å¸å†…å…¶ä»–ç¬¬ä¸‰æ–¹å®šæ—¶ä»»åŠ¡æ¡†æ¶ç›¸æ¯”ä¹Ÿè¾ƒæœ‰ç«äº‰æ€§ï¼ŒåŒæ—¶å¯¹äºåä¸¤ä¸ªå…³æ³¨ç‚¹ï¼ŒScheduler ä¹Ÿæœ‰è‡ªå·±çš„é£æ ¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;ä¸°å¯Œçš„è°ƒåº¦è®¾ç½®&lt;/h2&gt;&lt;p&gt;&lt;span&gt;ä¸€èˆ¬çš„å®šæ—¶ä»»åŠ¡æ¡†æ¶åªæ”¯æŒ crontab è¡¨è¾¾å¼ï¼Œä¾‹å¦‚Â &lt;/span&gt;&lt;strong&gt;&lt;span&gt;0 1 * * *&lt;/span&gt;&lt;/strong&gt;&lt;span&gt; ï¼Œä»£è¡¨æ¯å¤©å‡Œæ™¨ä¸€ç‚¹æ‰§è¡Œä¸€æ¬¡ã€‚cronTab åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯è‹¥é…ç½®å¤æ‚çš„å®šæ—¶ç­–ç•¥ï¼Œæœ‰ä¸€å®šå­¦ä¹ æˆæœ¬ï¼Œä¸”å¯è¯»æ€§ä¸é«˜ã€‚å› æ­¤ï¼Œé‰´äºè¿™ç§æƒ…å†µï¼ŒScheduler åœ¨ crontab ä¹‹ä¸Šè®¾è®¡äº†æ›´æ˜“è¯»æ›´å¼ºå¤§çš„å®šæ—¶ç­–ç•¥ï¼Œåšåˆ°æ‰€è§å³æ‰€å¾—ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;false&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;json&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;startTime&quot;&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;1648029600000&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;timeZone&quot;&lt;/span&gt;:&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;Asia/Shanghai&quot;&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;repeatLevel&quot;&lt;/span&gt;:&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;month&quot;&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;repeatInterval&quot;&lt;/span&gt;:&lt;span class=&quot;code-snippet__number&quot;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;repeatDays&quot;&lt;/span&gt;:[&lt;span class=&quot;code-snippet__number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;code-snippet__number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;code-snippet__number&quot;&gt;23&lt;/span&gt;]&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;start_time: å¼€å§‹æ—¶é—´æˆ³ï¼Œåœ¨æ­¤ä¹‹å‰å®šæ—¶ä»»åŠ¡ä¸ä¼šæ‰§è¡Œï¼Œåˆ°è¾¾è¯¥æ—¶é—´åä¼šæ‰§è¡Œç¬¬ä¸€æ¬¡&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;timeZone: æ—¶åŒºè®¾ç½®ï¼Œæ ¹æ®å½“å‰è®¾ç½®çš„æ—¶åŒºå‡†ç¡®æ´¾å‘&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;repeatLevel: é‡å¤çº§åˆ«ï¼Œç›®å‰å¯ä»¥è®¾ç½®æŒ‰ã€Œå°æ—¶ã€ã€ã€Œå¤©ã€ã€ã€Œæœˆã€ã€ã€Œå‘¨ã€ã€ã€Œå¹´ã€ä»¥åŠã€Œå·¥ä½œæ—¥ã€è¿›è¡Œé‡å¤&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;repeatInterval: é‡å¤é—´éš”ï¼Œä»£è¡¨æ¯éš” $repertInterval $repeatLevel æ‰§è¡Œä¸€æ¬¡&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;repeatDays: é‡å¤å¤©æ•°ï¼Œé‡å¤çº§åˆ«æ˜¯å‘¨æˆ–æœˆæ—¶ç”Ÿæ•ˆ&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;å› æ­¤ï¼Œè¯¥è®¾ç½®æ‰€ä»£è¡¨çš„å®šæ—¶é—´éš”ä¸ºï¼š&lt;strong&gt;æ¯ä¸¤æœˆçš„3ã€5ã€23å·è§¦å‘ä¸€æ¬¡&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;table data-ace-table-col-widths=&quot;178&quot;&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p&gt;&lt;strong&gt;è§¦å‘æ—¶é—´ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰&lt;/strong&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p&gt;2022-03-23 18:00:00&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p&gt;2022-05-03 18:00:00&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p&gt;2022-05-05 18:00:00&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td colspan=&quot;1&quot; rowspan=&quot;1&quot;&gt;&lt;p&gt;2022-05-23 18:00:00&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h3&gt;&lt;span&gt;ä¸ºä»€ä¹ˆè¦åšå·¥ä½œæ—¥è°ƒåº¦&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;å¯èƒ½æœ‰åŒå­¦æ³¨æ„åˆ°ï¼ŒScheduler å¯¹äºé‡å¤çº§åˆ«çš„æ”¯æŒååˆ†ä¸°å¯Œï¼Œä¸ä»…å¯ä»¥æŒ‰ç…§æ™®é€šçš„å¹´ã€æœˆã€æ—¥ç­‰çº§åˆ«è¿›è¡Œè®¾ç½®ï¼Œè¿˜å¯ä»¥æŒ‰ç…§å·¥ä½œæ—¥è¿›è¡Œé‡å¤è°ƒåº¦ï¼ˆä¾‹å¦‚æ¯ä¸¤ä¸ªå·¥ä½œæ—¥æ‰§è¡Œä¸€æ¬¡ï¼‰ï¼Œè¿™å½’å› åœ¨ Scheduler å­µåŒ–äºå­—èŠ‚è·³åŠ¨å†…éƒ¨ä¼ä¸šæœåŠ¡ç³»ç»Ÿï¼Œä¸ºè¯¸å¦‚äººäº‹ç³»ç»Ÿã€æƒé™ç³»ç»Ÿç­‰ ToB æœåŠ¡æä¾›å®šæ—¶ä»»åŠ¡èƒ½åŠ›ã€‚å¾€å¾€ ToB å®¢æˆ·çš„éœ€æ±‚å¤æ‚å¤šå˜ï¼Œå› æ­¤ï¼Œéœ€è¦æå‰å…·å¤‡æ›´å¤šèƒ½åŠ›ï¼Œæ‰èƒ½æ›´å¥½åœ°æœåŠ¡å¥½ ToB å®¢æˆ·ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Scheduler åœ¨è°ƒç ”æ¥å…¥æ–¹éœ€æ±‚æ—¶ï¼Œå¾—åˆ°äº†æœ‰äº›å®¢æˆ·å¯¹äºå®šæ—¶æé†’è¿™ç±»ä»»åŠ¡çš„éœ€æ±‚æ˜¯å°½é‡ä¸è¦åœ¨ã€Œéå·¥ä½œæ—¥ã€æ‰“æ‰°ã€‚äºæ˜¯ï¼ŒScheduler å†³å®šå¢åŠ å·¥ä½œæ—¥è°ƒåº¦é€‰é¡¹æ¥é€‚é…å®¢æˆ·æ½œåœ¨éœ€æ±‚ï¼Œä¹Ÿä¾§é¢è¯´æ˜äº† Scheduler ä¸ºäº†è®©æ¥å…¥æ–¹æ›´å¿«æ›´å°æˆæœ¬æ¥å…¥åšå‡ºçš„åŠªåŠ›ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;è½»æ¾çš„ä½¿ç”¨æ–¹å¼&lt;/h2&gt;&lt;p&gt;&lt;span&gt;ç›¸ä¿¡ã€Œå¼€ç®±å³ç”¨ã€å¯¹äºäººä»¬åœ¨é‡‡ä¹°è¯¸å¦‚å®¶ç”µã€æ•°ç äº§å“æ—¶ï¼Œæ˜¯ååˆ†é‡è¦çš„ä¸€ä¸ªè€ƒæ ¸æŒ‡æ ‡ã€‚è€Œå¯¹äºå¯¹å¤–æä¾›çš„æœåŠ¡ or æ¡†æ¶ï¼Œäº¦æ˜¯å¦‚æ­¤ã€‚Scheduler çš„ç›®æ ‡å°±æ˜¯è®©æ¥å…¥æ–¹èƒ½å¤Ÿåœ¨çŸ­æ—¶é—´ç†Ÿæ‚‰ Schedulerã€ç¼–å†™æµ‹è¯•ä»£ç ä»¥åŠä¸Šçº¿å®šæ—¶ä»»åŠ¡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;ä¸“æ³¨ä¸šåŠ¡&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;å¦‚æœæƒ³å®ç°ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ¥å…¥æ–¹åªéœ€è¦ä¸‰æ­¥ï¼šå¼•å…¥ Scheduler sdkï¼Œç»‘å®šç›¸åº” processorï¼Œåœ¨ process æ¥å£ä¸­å®ç°å…·ä½“ä¸šåŠ¡é€»è¾‘ã€‚åŒæ—¶ï¼Œç”±äºå®šæ—¶ä»»åŠ¡çš„å®ç°ä½äºåŸä»£ç ä¸­ï¼Œå¯åŠ¨é…ç½®æ— éœ€æ›´æ”¹ï¼Œæœ¬åœ°æµ‹è¯•ä¹Ÿè¾ƒä¸ºä¾¿æ·ã€‚åŒæ—¶ï¼Œåœ¨å­—èŠ‚è·³åŠ¨ç¯å¢ƒä¸‹ï¼Œæ— éœ€æ–°å¢ psmã€æˆæƒé…ç½®ç­‰ï¼Œå°½å¯èƒ½åšåˆ°äº†ã€Œå¼€ç®±å³ç”¨ã€ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;false&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;import&lt;/span&gt; (&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;context&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;code.byted.org/apaas/scheduler_sdk/executor&quot;&lt;/span&gt;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    executorSvc, err := executor.NewExecutor(executor.NewDefaultExecutorConfig(), &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &amp;amp;HelloWorld{}) &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; err != &lt;span class=&quot;code-snippet__literal&quot;&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;span class=&quot;code-snippet__built_in&quot;&gt;panic&lt;/span&gt;(err)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; err = executorSvc.Run(); err != &lt;span class=&quot;code-snippet__literal&quot;&gt;nil&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;span class=&quot;code-snippet__built_in&quot;&gt;panic&lt;/span&gt;(err)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;type&lt;/span&gt; HelloWorld &lt;span class=&quot;code-snippet__keyword&quot;&gt;struct&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   ProcessorApiName &lt;span class=&quot;code-snippet__keyword&quot;&gt;string&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(h *HelloWorld)&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;GetApiName&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;string&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; h.ProcessorApiName&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(h *HelloWorld)&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;SimpleProcess&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(ctx context.Context, tc *executor.TaskContext)&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(err error)&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   tc.LogInfo(ctx, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;hello world&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;&lt;span&gt;å¿«é€Ÿè¿ç»´&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;æ²¡æœ‰ç¨‹åºå‘˜æƒ³ä¸»åŠ¨å†™å‡º bugï¼Œä½†é—®é¢˜æ€»æ˜¯ä¼šçªç„¶å‡ºç°ã€‚å¦‚ä½•åœ¨å‡ºç°é—®é¢˜æ—¶å¿«é€Ÿè¿ç»´ã€å¿«é€Ÿæ­¢æŸï¼Œæ˜¯æ‰€æœ‰å·¥ç¨‹å¸ˆéƒ½è¿½æ±‚çš„ç›®æ ‡ã€‚Scheduler åœ¨è¿™æ–¹é¢åšäº†å‡ ç§å°è¯•ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;æŠ¥è­¦æ›´ç›´è§‚&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ç”¨æˆ·å¯ä»¥åœ¨åˆ›å»º job æ—¶ï¼Œå¯ä»¥é€‰æ‹©é…ç½®æŠ¥è­¦æœºå™¨äººï¼Œå¹¶æŠŠ Scheduler æœºå™¨äººæ‹‰å…¥å¯¹åº”æŠ¥è­¦ç¾¤ç»„ã€‚å½“æ£€æµ‹åˆ°å¯¹åº” job å‡ºç°é—®é¢˜æ—¶ï¼ŒScheduler æœºå™¨äººä¼šæŠŠç›¸åº”æŠ¥è­¦æ¨é€åˆ°å¯¹åº”ç¾¤ç»„ï¼Œåšåˆ°å®æ—¶å“åº”ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;2&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;çŠ¶æ€æ›´æ¸…æ™°&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ç›®å‰ task çš„ç›¸å…³çŠ¶æ€å¦‚ä¸‹ï¼Œå½“ä¸€ä¸ª task é•¿æœŸæ²¡æœ‰åˆ°ç»ˆæ€æ—¶ï¼Œæ ¹æ®çŠ¶æ€ç å³å¯çŸ¥ task ç›®å‰å¤„äºä»€ä¹ˆçŠ¶&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ€ï¼Œä»è€Œæ¨æ–­æ˜¯å“ªä¸€æ­¥éª¤å‡ºäº†é—®é¢˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;çŠ¶æ€ç &amp;quot;&quot;&gt;çŠ¶æ€ç &lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;çŠ¶æ€&amp;quot;&quot;&gt;çŠ¶æ€&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;100&quot;&gt;100&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;ç­‰å¾…è§¦å‘&amp;quot;&quot;&gt;ç­‰å¾…è§¦å‘&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;101&quot;&gt;101&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;Ready å°±ç»ªæ€ï¼Œç­‰å¾…æ¨é€&amp;quot;&quot;&gt;Ready å°±ç»ªæ€ï¼Œç­‰å¾…æ¨é€&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;201&quot;&gt;201&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ¨é€åˆ° Executorï¼Œè¿˜æœªå®é™…æ‰§è¡Œï¼ˆä»»åŠ¡å¤ªå¤šæ’é˜Ÿï¼‰&amp;quot;&quot;&gt;æ¨é€åˆ° Executorï¼Œè¿˜æœªå®é™…æ‰§è¡Œï¼ˆä»»åŠ¡å¤ªå¤šæ’é˜Ÿï¼‰&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;202&quot;&gt;202&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰§è¡Œä¸­&amp;quot;&quot;&gt;æ‰§è¡Œä¸­&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;203&quot;&gt;203&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰§è¡Œè¶…æ—¶ï¼Œé€»è¾‘å¤æ‚å¯¼è‡´&amp;quot;&quot;&gt;æ‰§è¡Œè¶…æ—¶ï¼Œé€»è¾‘å¤æ‚å¯¼è‡´&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;301&quot;&gt;301&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰§è¡ŒæˆåŠŸ&amp;quot;&quot;&gt;æ‰§è¡ŒæˆåŠŸ&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;302&quot;&gt;302&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰§è¡Œå¤±è´¥&amp;quot;&quot;&gt;æ‰§è¡Œå¤±è´¥&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;401&quot;&gt;401&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;Ready è¶…æ—¶ï¼Œæ²¡æœ‰ Executor æ‹‰å–&amp;quot;&quot;&gt;Ready è¶…æ—¶ï¼Œæ²¡æœ‰ Executor æ‹‰å–&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;402&quot;&gt;402&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ¨é€åˆ° Executor åé•¿æœŸæœªæ‰§è¡Œ &amp;quot;&quot;&gt;æ¨é€åˆ° Executor åé•¿æœŸæœªæ‰§è¡Œ&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;403&quot;&gt;403&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰§è¡Œè¶…æ—¶ï¼ŒExecutor å®•æœºå¯¼è‡´&amp;quot;&quot;&gt;æ‰§è¡Œè¶…æ—¶ï¼ŒExecutor å®•æœºå¯¼è‡´&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;span&gt;å¹¶ä¸”ä¸€äº› Scheduler å¸¸è§çš„æŠ¥é”™ä¹Ÿåšäº†å°è£…ï¼Œå¸®åŠ©å¿«é€Ÿå®šä½é—®é¢˜ï¼Œä¾‹å¦‚&lt;/span&gt;&lt;/p&gt;&lt;table&gt;&lt;colgroup&gt;&lt;col/&gt;&lt;col/&gt;&lt;/colgroup&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;é”™è¯¯ç &amp;quot;&quot;&gt;é”™è¯¯ç &lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;é”™è¯¯åŸå› &amp;quot;&quot;&gt;é”™è¯¯åŸå› &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;k_sc_ec_000004&amp;quot;&quot;&gt;k_sc_ec_000004&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰¾ä¸åˆ°ä»»åŠ¡{{.jobApiName}}&amp;quot;&quot;&gt;æ‰¾ä¸åˆ°ä»»åŠ¡{{.jobApiName}}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;k_sc_ec_100004&amp;quot;&quot;&gt;k_sc_ec_100004&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰¾ä¸åˆ°ä»»åŠ¡å®ä¾‹{{.instanceID}}&amp;quot;&quot;&gt;æ‰¾ä¸åˆ°ä»»åŠ¡å®ä¾‹{{.instanceID}}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;k_sc_ec_300001&amp;quot;&quot;&gt;k_sc_ec_300001&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;Processor Name æœªæ³¨å†Œ{{.content}}&amp;quot;&quot;&gt;Processor Name æœªæ³¨å†Œ{{.content}}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;k_sc_ec_300006&amp;quot;&quot;&gt;k_sc_ec_300006&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;processor({{.content}}) æ‰¾ä¸åˆ°å¯¹åº” executor&amp;quot;&quot;&gt;processor({{.content}}) æ‰¾ä¸åˆ°å¯¹åº” executor&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;k_sc_ec_400002&amp;quot;&quot;&gt;k_sc_ec_400002&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ‰¾ä¸åˆ°Executor {{.content}}&amp;quot;&quot;&gt;æ‰¾ä¸åˆ°Executor {{.content}}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td data-sheet-value=&quot;&amp;quot;k_sc_ec_400005&amp;quot;&quot;&gt;k_sc_ec_400005&lt;/td&gt;&lt;td data-sheet-value=&quot;&amp;quot;æ— æƒé™æ“ä½œ&amp;quot;&quot;&gt;æ— æƒé™æ“ä½œ&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;h1&gt;å¹¶è‚©ä½œæˆ˜-åˆ†ç‰‡ä»»åŠ¡&lt;/h1&gt;&lt;h2&gt;èƒŒæ™¯ï¼šä»»åŠ¡è¶Šå¤šï¼ŒæŒ‘æˆ˜è¶Šå¤§&lt;/h2&gt;&lt;p&gt;&lt;span&gt;ä¸€ä¸ªæˆç†Ÿçš„é¡¹ç›®ä¸­é¿å…ä¸äº†å¤§å‹æ‰¹é‡ä»»åŠ¡ï¼Œæ¯”å¦‚é€šè¿‡ Excelã€csv æˆ–å…¶ä»–æ•°æ®æºæ‰¹é‡åˆ›å»ºæˆ–æ›´æ–°æ•°æ®ï¼Œæ‰¹é‡ä»»åŠ¡ä¸€èˆ¬æ•°æ®é‡å¾ˆå¤§ï¼Œå¦‚æœæŒ‰ç…§å•å®ä¾‹ä¸²è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆä¸èƒ½å……åˆ†åˆ©ç”¨è®¡ç®—æœºèµ„æºä¸”ä¸€æ¬¡è¿è¡Œä¼šæ¶ˆè´¹å¤§é‡æ—¶é—´ï¼Œç”¨æˆ·ä½“éªŒä¸å‹å¥½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä»¥ Kunlun ä¸¾ä¾‹ï¼Œ æ—§é˜¶æ®µçš„æ‰¹é‡ä»»åŠ¡ä¾èµ–äºæ¶ˆæ¯é˜Ÿåˆ—ã€Redis å®ç°ï¼Œæ€»ä½“åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;è§£æå¹¶æ ¡éªŒExcelï¼Œå°†æ•°æ®è§£ææˆä¸€æ¡æ¡æ•°æ®ï¼Œå°†æ¯æ¡æ¶ˆæ¯å°è£…æˆä¸€æ¡æ¶ˆæ¯å‘é€è‡³æ¶ˆæ¯é˜Ÿåˆ—ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ¶ˆè´¹æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿›è¡Œåˆ›å»ºã€æ›´æ–°ç­‰æ“ä½œï¼Œå¹¶åœ¨Redisè®°å½•æ€»ä½“è¿›åº¦å¹¶æ¨é€ç»™ç”¨æˆ·ï¼Œå¦‚æœä»»åŠ¡å¤±è´¥ï¼Œä¼šå°†è¡Œæ•°å’Œé”™è¯¯åŸå› åŒæ—¶è®°å½•è¿›redisï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;å¾…æ‰€æœ‰æ•°æ®å¤„ç†ç»“æŸåï¼Œå¦‚æœredisä¸­æ²¡æœ‰é”™è¯¯æ•°æ®ï¼Œåˆ™æç¤ºç”¨æˆ·æˆåŠŸï¼Œå¦åˆ™æ ¹æ®é”™è¯¯ä¿¡æ¯ç”ŸæˆExcelè¿”å›ç»™ç”¨æˆ·ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span/&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;271&quot; data-backw=&quot;525&quot; data-ratio=&quot;0.5167394468704513&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4Q5AERM5D3txQMnMrMMiasnJJcoeQYK4tE2vdhW3X6z0TvnN6KPEzdaw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;687&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ã€redisçš„å®šæ—¶ä»»åŠ¡å¯ä»¥æé€Ÿå’Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒï¼Œä½†æœ‰ä»¥ä¸‹ä¸è¶³ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ç»´æŠ¤èµ·æ¥ä¸æ–¹ä¾¿ï¼Œä¾‹å¦‚å½“æœ‰æ–°æœåŠ¡éœ€è¦æ­¤ç±»åŠŸèƒ½æ—¶ï¼Œéœ€è¦è‡ªå·±å†å®ç°ä¸€å¥—å·®ä¸å¤šçš„æ¡†æ¶ï¼Œæ‰€ä»¥éœ€è¦å°†åˆ†ç‰‡åŠŸèƒ½æ‰˜ç®¡åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œè€Œä¸šåŠ¡æ–¹åªç”¨ä¸“æ³¨äºå…·ä½“ä¸šåŠ¡ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ä¾èµ–äºæ¶ˆæ¯é˜Ÿåˆ—å’ŒRedisä¸¤ä¸ªå¤–éƒ¨ç»„ä»¶ï¼Œå¯¹ä¸¤ä¸ªç»„ä»¶çš„ç¨³å®šæ€§è¦æ±‚æé«˜ï¼Œå½“å…¶ä¸­ä¸€ä¸ªå‡ºç°é—®é¢˜ï¼Œéƒ½ä¼šå¸¦æ¥ä¸å°çš„éº»çƒ¦ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;åŸºäºè¿™ç§èƒŒæ™¯ï¼ŒScheduler ä¸°å¯Œäº†åŸæœ¬çš„ä»»åŠ¡è°ƒåº¦èƒ½åŠ›ï¼Œè¡¥å……äº†åˆ†ç‰‡èƒ½åŠ›ï¼Œä»¥æ»¡è¶³å¤æ‚ç¹ççš„ä»»åŠ¡åˆ†ç‰‡å¤„ç†çš„éœ€æ±‚ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;åˆ†æï¼šæ—§é—®é¢˜ï¼Œæ–°è§£æ³•&lt;/h2&gt;&lt;p&gt;&lt;span&gt;è‹¥æ‰“ç®—åšå‡ºä¸€å¥—è´´åˆä¸šåŠ¡éœ€æ±‚çš„åˆ†ç‰‡ä»»åŠ¡æ¡†æ¶ï¼Œéœ€è¦å…ˆäº†è§£ç°é˜¶æ®µçš„åˆ†ç‰‡ä»»åŠ¡çš„å®ç°æ­¥éª¤ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç°é˜¶æ®µçš„åˆ†ç‰‡ä»»åŠ¡å¤§è‡´å¯ä»¥æŠ½è±¡æˆ3ä¸ªæ­¥éª¤ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;æ€»&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ã€‚è·å–æ•°æ®ï¼Œå¯ä»¥ä»ä¸Šä¼ çš„æ–‡ä»¶è§£ææ•°æ®ã€ä» DB æŸ¥è¯¢å‡ºå¤§æ‰¹æ•°æ®æˆ–å…¶ä»–æ•°æ®æºã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;åˆ†&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ã€‚å¤„ç†æ•°æ®ï¼Œèšç„¦äºå…·ä½“ä¸šåŠ¡ï¼Œå¦‚ï¼šåˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;æ€»&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ã€‚å¤„ç†ç»“æœï¼Œå°†æ­¤æ¬¡ä»»åŠ¡è¿è¡Œç»“æœå¤„ç†æˆç»“æœæŠ¥å‘Šè¿”å›ç»™ç”¨æˆ·ï¼ŒæŠ¥å‘Šå¯ä»¥ä¸º Excelã€ä¸€æ¡æ¶ˆæ¯ã€ä¸€å°é‚®ä»¶ç­‰ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;Scheduler è¦åšçš„äº‹æƒ…åˆ™æ˜¯æ›¿æ¢å…¶ä¸­åˆ†ç‰‡ã€æ¶ˆæ¯é˜Ÿåˆ—ã€Redis çš„åŠŸèƒ½ï¼Œåšå‡ºä»¥ä¸‹æŠ½è±¡ï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;true&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;typescript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;type&lt;/span&gt; ShardingProcessor &lt;span class=&quot;code-snippet__keyword&quot;&gt;interface&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   PreProcess(ctx context.Context, tc *TaskContext) error&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   ShardingProcess(ctx context.Context, tc *TaskContext) error&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   Notify(ctx context.Context, tc *TaskContext)error&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   PostProcess(ctx context.Context, tc *TaskContext) error&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;PreProcess(æ€»)&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šæ•°æ®å‡†å¤‡é˜¶æ®µã€‚å¯åœ¨æ­¤æ–¹æ³•ä¸­å¯¹æ•°æ®è¿›è¡Œé¢å¤–å¤„ç†ï¼Œå¦‚è®¡ç®—æ‹“æ‰‘å…³ç³»ï¼Œå®šä¹‰æ•°æ®ä¼˜å…ˆçº§ã€‚å•æœºè¿è¡Œã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ShardingProcess(åˆ†)&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šåˆ†ç‰‡å¤„ç†é˜¶æ®µã€‚å®é™…å¤„ç†å‡½æ•°ï¼Œå¤šæœºè¿è¡Œã€‚åˆ†ç‰‡å¤„ç†å‡½æ•°ï¼Œæ‰§è¡Œæ‰¹é‡å¯¼å…¥ã€æ›´æ–°ç­‰å¤„ç†ã€‚ï¼ˆ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;strong&gt;å…¥å‚ï¼šScheduler å¯¹ PreProcess è¿”å›ç»“æœçš„åˆ†ç‰‡å­å‚æ•°ï¼‰&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Notify(é˜¶æ®µå¼-æ€»)&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šè¿›åº¦æ›´æ–°å¤„ç†ï¼Œæ¯å½“è¿›åº¦å˜æ›´çš„å¤§å°å¤§äºè®¾å®šé˜ˆå€¼ï¼Œåˆ™ç”Ÿæˆä¸€æ¬¡ Notify çš„Taskã€‚Executor å‘ Scheduler æ±‡æŠ¥å­ä»»åŠ¡è¿›åº¦ï¼ŒScheduler è®¡ç®—å‡ºæ€»ä½“è¿›åº¦ï¼Œå½“æ€»è¿›åº¦å‘ç”Ÿå˜æ›´åç”Ÿæˆ NotifyTask é€šçŸ¥ Executor è¿›è¡Œå¤„ç†ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;PostProcess(æ€»)&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ï¼šç»“æœå¤„ç†é˜¶æ®µã€‚ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åå¯åœ¨æ­¤å‡½æ•°è¿›è¡Œåç»­å¤„ç†ï¼Œå•æœºè¿è¡Œã€‚å½“æ‰€æœ‰åˆ†ç‰‡å­ä»»åŠ¡éƒ½æ‰§è¡Œå®Œåï¼ŒScheduler ä¼šå°†å­ä»»åŠ¡çš„æ‰§è¡Œç»“æœå‘é€åˆ°æ­¤å‡½æ•°å¤„ç†ã€‚ï¼ˆ&lt;strong&gt;å…¥å‚ï¼šæ¯ä¸€ä¸ªå­ä»»åŠ¡ ShardingProcess åçš„ç»“æœæ•°ç»„ï¼‰&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;æ‰§è¡Œå™¨éœ€è¦å®ç°ShardingProcessoræ¥å£ä»¥ä¾›è°ƒåº¦å™¨è¿›è¡Œè°ƒåº¦ã€‚è°ƒåº¦è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-backh=&quot;316&quot; data-backw=&quot;514&quot; data-ratio=&quot;0.614065180102916&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4icUAJ5LBx7RKYjgouRiby19HDMdvS7hV5EZq0SKeHKialepAmHZ64DiaoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;583&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;Scheduler æ”¯æŒåˆ†ç‰‡ä»»åŠ¡é‡ç‚¹åœ¨äºä¸°å¯Œè°ƒåº¦æ¨¡å‹ï¼Œæå‡è°ƒåº¦å™¨è°ƒåº¦èƒ½åŠ›ï¼Œå®Œå–„æ‰§è¡Œå™¨æ‰§è¡Œèƒ½åŠ›æ¥è¾¾åˆ°æ”¯æŒåˆ†ç‰‡ä»»åŠ¡çš„ç›®çš„&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;è°ƒåº¦ä¾§èƒ½åŠ›&lt;/h2&gt;&lt;h3&gt;&lt;span&gt;åˆ†æ‰¹è°ƒåº¦çš„èƒ½åŠ›&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;span&gt;è°ƒåº¦ä¾§éœ€è¦æ ¹æ®ä»»åŠ¡è¿›åº¦ä¾æ¬¡ç”Ÿæˆ PreTaskã€ProcessTaskã€NotifyTaskã€PostTask æ¥è°ƒåº¦æ‰§è¡Œå™¨ &lt;/span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ShardingProcessor&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;span&gt; ä¸­çš„ PreProcess - Process - Notify - PostProcess å››ä¸ªæ–¹æ³•ã€‚å•æœºè°ƒåº¦ PreProcessï¼ŒPostProcessï¼ŒNotifyï¼Œå¹¶è¡Œè°ƒåº¦ PostProcessï¼Œæ€»ä½“è°ƒåº¦å‘ˆç°æ€»-åˆ†-æ€»çš„å½¢å¼ã€‚è°ƒåº¦è¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.45234375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4NwkHW1Fv8Uy7nvQoLtGWWyqIm1NGQzRIU7HhZoB8sicw5YXiaRThwkBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;span/&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;æ•°æ®æ‹†åˆ†çš„èƒ½åŠ›&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;æ•°æ®æ‹†åˆ†å³ä»»åŠ¡åˆ†ç‰‡ï¼ŒæŒ‡çš„æ˜¯å°†å•ä¸€ä»»åŠ¡æŒ‰ç…§ç‰¹å®šçš„é€»è¾‘åˆ‡åˆ†ä¸ºå¤šä¸ª&lt;strong&gt;ç‹¬ç«‹çš„&lt;/strong&gt;å­ä»»åŠ¡ï¼Œå°†å…¶åˆ†æ´¾åˆ°ä¸åŒçš„èŠ‚ç‚¹æ‰§è¡Œï¼Œä»¥æé«˜ä»»åŠ¡çš„æ‰§è¡Œæ•ˆç‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;è€Œ Scheduler è¦å¤„ç†çš„ä»»åŠ¡å†…éƒ¨å¯èƒ½å­˜åœ¨&lt;strong&gt;ä¾èµ–å…³ç³»&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;ï¼ˆæ¯”å¦‚ kunlun ä¸šåŠ¡ä¸­ metadata æ‰¹é‡åˆ›å»ºçš„éœ€æ±‚ï¼Œç”±äºå­˜åœ¨ lookup å’Œ reference å­—æ®µç­‰ï¼Œè®°å½•åˆ›å»ºä¹‹é—´å­˜åœ¨æ‹“æ‰‘å…³ç³»ï¼‰&lt;/span&gt;&lt;span&gt;ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œæ—¶éœ€è¦&lt;strong&gt;ä¼˜å…ˆçº§&lt;/strong&gt;çš„æ¦‚å¿µï¼Œè€Œä¸èƒ½è¢«ç®€å•æ‹†åˆ†ä¸º&lt;strong&gt;ç‹¬ç«‹&lt;/strong&gt;çš„å­ä»»åŠ¡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¸ºäº†æ”¯æŒå¸¦ä¼˜å…ˆçº§çš„ä»»åŠ¡åˆ†ç‰‡ï¼ŒScheduler æ¥æ”¶çš„åˆ†ç‰‡ä»»åŠ¡çš„æ•°æ®ç‰¹ç‚¹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;äºŒç»´æ•°ç»„å¯ä»¥æ˜¯ä¸‹é¢è¿™æ ·ï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;true&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;json&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;[&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    [&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        // ç¬¬ä¸€ä¼˜å…ˆçº§çš„ä»»åŠ¡&lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;ï¼Œå¯ä»¥æ˜¯ä¸»é”®&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__number&quot;&gt;101&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        // ç¬¬ä¸€ä¼˜å…ˆçº§çš„ä»»åŠ¡&lt;span class=&quot;code-snippet__number&quot;&gt;2&lt;/span&gt;ï¼Œå¯ä»¥æ˜¯SQLè¯­å¥&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;Insert into tablename xxx&quot;&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        // ç¬¬ä¸€ä¼˜å…ˆçº§çš„ä»»åŠ¡&lt;span class=&quot;code-snippet__number&quot;&gt;3&lt;/span&gt;ï¼Œå¯ä»¥æ˜¯ç»“æ„ä½“ç­‰ç­‰...&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;ID&quot;&lt;/span&gt;: &lt;span class=&quot;code-snippet__number&quot;&gt;999&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__attr&quot;&gt;&quot;Name&quot;&lt;/span&gt;: &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;zhangsan&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    ],&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    [    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        // ç¬¬äºŒä¼˜å…ˆçº§çš„ä»»åŠ¡&lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;ã€&lt;span class=&quot;code-snippet__number&quot;&gt;2&lt;/span&gt;ã€...&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__number&quot;&gt;102&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__number&quot;&gt;103&lt;/span&gt;,&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        ...&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    ]&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;äº†è§£äº†å¾…åˆ†ç‰‡ä»»åŠ¡çš„ç»“æ„ï¼Œæˆ‘ä»¬æ¥è®¨è®ºå¦‚ä½•å¯¹ä»»åŠ¡è¿›è¡Œåˆ†ç‰‡ã€‚æ¯”å¦‚ï¼Œåˆ†ç‰‡çš„æ•°é‡ç”±ä»€ä¹ˆå†³å®šï¼Œå•ä¸ªåˆ†ç‰‡ä¸Šçš„ä¿¡æ¯æ˜¯å¦‚ä½•åˆ†é…çš„ï¼Œä¸åŒåˆ†ç‰‡åˆæ˜¯ä¸åŒåˆ†æ´¾åˆ°ä¸åŒçš„å¤„ç†å™¨ä¸Šçš„...&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;åˆ†ç‰‡æ•°çš„ç¡®å®š&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;åˆ†ç‰‡æ•°çš„ç¡®å®šåŸºäºä»¥ä¸‹å‚æ•°çš„å€¼ï¼š&lt;strong&gt;æ•°æ®é‡&lt;/strong&gt;ã€ä»»åŠ¡åˆ›å»ºæ—¶ç”¨æˆ·æŒ‡å®šçš„&lt;strong&gt;å•ç‰‡æœ€å¤§æ•°é‡ã€å•ç‰‡æœ€å°æ•°é‡&lt;/strong&gt;ï¼Œä»¥åŠå®é™…å¯ç”¨çš„&lt;strong&gt;æ‰§è¡Œå™¨æ•°é‡&lt;/strong&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;2&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;åˆ†ç‰‡&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ç®—æ³•&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;åˆ†ç‰‡ç‰¹å¾å€¼ï¼ˆsharding keyï¼‰çš„é€‰æ‹©è¦éµå¾ªçš„åŸåˆ™åº”è¯¥æ˜¯&lt;strong&gt;åŸºäºæœ€å¸¸ç”¨çš„è®¿é—®æ–¹å¼&lt;/strong&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ç”±äº Scheduler åˆ†ç‰‡æ—¶å¹¶ä¸å…³å¿ƒä¸šåŠ¡æ•°æ®çš„ç»“æ„ï¼Œæ‰€ä»¥é€‰ç”¨&lt;strong&gt;æ•°æ®æ•°ç»„çš„ä¸‹æ ‡&lt;/strong&gt;æ¥&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ä½œä¸ºåˆ†ç‰‡ç‰¹å¾å€¼ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ç”±äºåˆ†ç‰‡æ•°é‡ç¡®å®šåï¼Œä¸æ¶‰åŠåˆ°ç”±äºåˆ†ç‰‡çš„å¢åŠ æˆ–å‡å°‘å¯¹æ•°æ®è¿›è¡Œ Rehash çš„æƒ…å†µï¼Œæ‰€ä»¥æ— éœ€è€ƒè™‘è™šæ‹ŸèŠ‚ç‚¹ã€ä¸€è‡´æ€§å“ˆå¸Œç­‰æ–¹å¼è¿›è¡Œåˆ†ç‰‡ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;è¿™é‡Œé€‰ç”¨å“ˆå¸Œåˆ†ç‰‡çš„åˆ†ç‰‡ç®—æ³•ï¼ŒåŸå› æ˜¯æ—¢å¯ä»¥å‡åŒ€åˆ†å¸ƒæ•°æ®ï¼Œå®ç°èµ·æ¥ä¹Ÿå¾ˆç®€å•ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;3&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;åˆ†ç‰‡çš„å­˜å‚¨å’Œæ´¾å‘&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;åˆ†ç‰‡å®Œæˆåï¼Œéœ€è¦ç»™æ¯ä¸ªåˆ†ç‰‡åˆ›å»ºä¸€ä¸ª Taskï¼Œå¹¶æŠŠåˆ†ç‰‡çš„æ•°æ®å­˜å‚¨ä¸‹æ¥ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;å…³äº Task çš„æ´¾å‘ï¼Œæ ¹æ®ä¸Šé¢å…³äºåˆ†ç‰‡æ•°çš„è®¨è®ºï¼Œå¯ä»¥å¾—åˆ°åˆ†ç‰‡æ•°å’Œ Executor æ•°çš„å…³ç³»ï¼š&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;åœ¨æ•°æ®é‡åˆé€‚çš„æƒ…å†µä¸‹ï¼ˆå•ç‰‡æœ€å¤§æ•°é‡å’Œå•ç‰‡æœ€å°æ•°é‡è®¾ç½®åˆç†æ—¶ï¼Œæ˜¯æœ€æ™®éçš„æƒ…å†µï¼‰ï¼Œåˆ†ç‰‡æ•°å’ŒExecutor çš„æ•°ç›®æ˜¯ä¸€è‡´çš„ï¼›&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å½“æ•°æ®é‡å¾ˆå°æ—¶ï¼Œä¼šå‡ºç°åˆ†ç‰‡æ•°å°äº Executor æ•°ï¼›&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å½“æ•°æ®é‡å¾ˆå¤§æ—¶ï¼Œä¼šå‡ºç°åˆ†ç‰‡æ•°å¤§äº Executor æ•°ï¼Œç”šè‡³å¯èƒ½æ˜¯åè€…çš„å‡ å€ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;span&gt;ä¸ºäº†è®©å„ä¸ª Task / å„ä¸ªåˆ†ç‰‡ èƒ½å¤Ÿå‡åŒ€æ´¾å‘ç»™å„ä¸ª Executorï¼Œä¹Ÿä¸ºäº†é¿å…æŸä¸ªexecutoræŒ‚æ‰æ—¶ï¼Œå…¶ä»–Executor ä¸èƒ½å‡åŒ€åˆ†æ‘ŠæŒ‚æ‰çš„èŠ‚ç‚¹åŸå…ˆæ‰¿æ‹…çš„åˆ†ç‰‡ï¼Œéœ€è¦é‡‡ç”¨åˆç†çš„åˆ†ç‰‡ç­–ç•¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åœ¨åˆ†ç‰‡æ—¶ï¼Œæˆ‘ä»¬ä¿è¯äº†å„åˆ†ç‰‡çš„æ•°æ®æ˜¯å°½é‡å‡åŒ€åˆ†å¸ƒçš„ï¼Œæ‰€ä»¥ä»åˆ†ç‰‡åˆ° Executor çš„åˆ†æ´¾æ–¹å¼å¯ä»¥å°½å¯èƒ½åœ°ç®€å•ï¼Œé‡‡ç”¨å¹³å‡åˆ†é…çš„ç­–ç•¥å³å¯ã€‚å¯¹äºæŒ‚æ‰çš„èŠ‚ç‚¹æ‰€æ‰¿æ‹…çš„åˆ†ç‰‡ï¼Œä¹Ÿé‡‡ç”¨åŒæ ·çš„ç­–ç•¥æ´¾å‘åˆ°å­˜æ´»çš„ Executors ä¸Šå³å¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä¾‹å¦‚:&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æœ‰3ä¸ª Executorï¼Œåˆ†æˆ9ç‰‡ï¼Œåˆ™æ¯ä¸ª Executor åˆ†åˆ°çš„åˆ†ç‰‡æ˜¯: &lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;1=[0,1,2], 2=[3,4,5], 3=[6,7,8]&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¦‚æœExecutor 1æŒ‚æ‰ï¼Œåˆ™å°†1çš„åˆ†ç‰‡&lt;em&gt;å¹³å‡åˆ†é…*&lt;/em&gt; åˆ°Executor 2ã€3: &lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;2=[0,1,3,4,5], 3=[2,6,7,8]&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;blockquote data-type=&quot;quote_container&quot;&gt;&lt;p&gt;&lt;strong&gt;å¹³å‡åˆ†é…*&lt;/strong&gt;ï¼šå¯¹äºä¸èƒ½å‡åˆ†çš„æƒ…å†µï¼Œä¸ºäº†é¿å…é å‰çš„ Executor æ€»æ˜¯æ‰¿æ‹…æ›´å¤šçš„å‹åŠ›ï¼Œå¯ä»¥æ ¹æ®å¾…åˆ†é…åˆ†ç‰‡æ•°é‡çš„å¥‡å¶æ¥å†³å®šæ˜¯å‡åºåˆ†æ´¾è¿˜æ˜¯é™åºåˆ†æ´¾ã€‚&lt;span/&gt;&lt;span/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;h3&gt;&lt;span&gt;è¿›åº¦é€šçŸ¥çš„èƒ½åŠ›&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;Scheduler æ”¯æŒé€šçŸ¥ Executor ä»»åŠ¡æ‰§è¡Œçš„æ•´ä½“è¿›åº¦&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;Executor ä¸ŠæŠ¥å­ä»»åŠ¡è¿›åº¦è‡³ Schedulerï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;Scheduler è®¡ç®—æ€»ä»»åŠ¡è¿›åº¦ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ€»ä»»åŠ¡è¿›åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™ç”Ÿæˆ NotifyTask å‘é€è‡³ Executorã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.3936651583710407&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4n9hTBcxHUJMR06QpDiaiaQQIbAeyB2zKuJ8Zk6m0Qd8K1iavp4Fibf27rg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;663&quot;/&gt;&lt;/section&gt;&lt;h2&gt;æ‰§è¡Œä¾§åˆ†æ‰¹æ‰§è¡Œçš„èƒ½åŠ›&lt;/h2&gt;&lt;p&gt;&lt;span&gt;æ‰§è¡Œä¾§éœ€è¦å®ç°å¹¶æ³¨å†Œ SDK æä¾›çš„ShardingProcessoræ¥å£ï¼Œæ¥å¤„ç†ç”±è°ƒåº¦ä¾§å‘æ¥çš„å¤šç§ç±»å‹çš„Taskã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;PreProcess&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é¢„å¤„ç†æ–¹æ³•ï¼Œå¯ä»¥è¿›è¡Œä½†ä¸é™äºä»¥ä¸‹çš„æ“ä½œï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;å¯åŠ¨å‚æ•°ä¸ç¬¦åˆ Scheduler è§„å®šæ ¼å¼ï¼Œå¯ä»¥é€šè¿‡ PreProcess æ–¹æ³•è¿›è¡Œä¸€æ¬¡è½¬æ¢ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ•°æ®å­˜åœ¨å¯¼å…¥ä¼˜å…ˆçº§ï¼Œå¯ä»¥åœ¨ PreProcess ä¸­ç¼–å†™è®¡ç®—æ‹“æ‰‘å…³ç³»çš„æ–¹æ³•ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;blockquote data-type=&quot;quote_container&quot;&gt;&lt;p&gt;å¦‚æœä¸éœ€è¦é¢„å¤„ç†ï¼Œå¯ç›´æ¥åœ¨æ–¹æ³•å†… returnï¼Œåˆ†ç‰‡æ—¶æ•°æ®ä½¿ç”¨å¯åŠ¨æ—¶çš„ Data&lt;span/&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;css&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;func&lt;/span&gt; (&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;s&lt;/span&gt; *&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ShardingProcessor&lt;/span&gt;) &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;PreProcess&lt;/span&gt;(&lt;span class=&quot;code-snippet__selector-tag&quot;&gt;ctx&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;code-snippet__selector-class&quot;&gt;.Context&lt;/span&gt;, &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;tc&lt;/span&gt; &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;taskContext&lt;/span&gt;) &lt;span class=&quot;code-snippet__selector-tag&quot;&gt;error&lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__attribute&quot;&gt;oldData &lt;/span&gt;:= tc.&lt;span class=&quot;code-snippet__built_in&quot;&gt;GetData&lt;/span&gt;()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    // ç”¨æˆ·ä¸šåŠ¡, æ•°æ®å¤„ç†&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    newData := &lt;span class=&quot;code-snippet__built_in&quot;&gt;Transform&lt;/span&gt;(oldData)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    // è¿”å›å¸¦æ‹“æ‰‘æ’åºçš„æ•°æ®&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    tc.&lt;span class=&quot;code-snippet__built_in&quot;&gt;SetResult&lt;/span&gt;(newData)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    return nil&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;ShardingProcess&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åˆ†ç‰‡å¤„ç†å‡½æ•°ï¼Œä¸»è¦æ˜¯è¿›è¡Œæ•°æ®æ›´æ–°ã€åˆ›å»ºæ“ä½œã€‚ShardingProcess çš„å…¥å‚æ˜¯åˆ‡åˆ†åçš„æ•°ç»„ï¼ˆ&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;[]interface{}&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;ï¼‰ã€‚Executor éœ€è¦å¯¹å‚æ•°è¿›è¡Œä¸¤éƒ¨åˆ†é¢å¤–å¤„ç†ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;å°†Â &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;[]interface{}Â &lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ä¸­çš„Â &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;interface{}Â &lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ–­è¨€æˆå…·ä½“Â &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;struct{}&lt;/strong&gt;&lt;span&gt;&lt;span&gt;ï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;å¤„ç†åã€‚è®¡ç®—å½“å‰å­ä»»åŠ¡æ‰§è¡Œè¿›åº¦ï¼Œè¿›è¡Œä¸ŠæŠ¥ï¼›å¦‚æœçœç•¥ä¸ŠæŠ¥ï¼ŒæœåŠ¡ç«¯ä»¥åˆ†ç‰‡ç²’åº¦ç”Ÿæˆ NotifyTaské€šçŸ¥æ‰§è¡Œå™¨ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;pre&gt;&lt;code data-wrap=&quot;true&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(s *ShardingProcessor)&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;ShardingProcess&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(ctx context.Context, tc taskContext)&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;error&lt;/span&gt;&lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   taskData := tc.GetData()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; _, data := &lt;span class=&quot;code-snippet__keyword&quot;&gt;range&lt;/span&gt; taskData{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   tc.SetResult(...)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;PostProcess&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ¥å—æ‰€æœ‰åˆ†ç‰‡å¤„ç†ç»“æœï¼Œè¿›è¡Œåç»­å¤„ç†ï¼Œå¦‚ç”Ÿæˆé”™è¯¯æ–‡ä»¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;false&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(s *ShardingProcessor)&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;PostProcess&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(ctx context.Context, tc taskContext)&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;error&lt;/span&gt;&lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    taskData := tc.GetData()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; _, result := &lt;span class=&quot;code-snippet__keyword&quot;&gt;range&lt;/span&gt; taskData{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    tc.SetResult(...)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Notify&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æä¾›ç»™å­ä»»åŠ¡ä¸ŠæŠ¥çš„èƒ½åŠ›ï¼ŒScheduler ä¼šæ ¹æ®æ‰€æœ‰å­ä»»åŠ¡ä¸ŠæŠ¥ç»“æœè®¡ç®—è¿›åº¦ï¼Œé€šçŸ¥ Executorï¼Œ&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;é€šçŸ¥ç²’åº¦ä¸ºæ•°æ®æ¡æ•°&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;ã€‚å¦‚æœæ¥å…¥æ–¹ä¸ä¸»åŠ¨ä¸ŠæŠ¥å­ä»»åŠ¡è¿›åº¦ï¼ŒScheduler ä¼šæ ¹æ®å­ä»»åŠ¡å®Œæˆåº¦è¿›è¡Œé€šçŸ¥ï¼Œ&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;é€šçŸ¥ç²’åº¦ä¸ºåˆ†ç‰‡ç²’åº¦&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;åˆ†ç‰‡ä»»åŠ¡æµç¨‹&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.2342342342342343&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4crI1FmJdqIhxe9Dod49EtUH6R3mJibzaJ9vaGYmZ5b8T2Tl7Ycz6oKg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;444&quot;/&gt;&lt;/p&gt;&lt;h1&gt;å‰Šå³°å¡«è°·-æµé‡æ§åˆ¶&lt;/h1&gt;&lt;h2&gt;èƒŒæ™¯ï¼šæä¾›èƒ½åŠ›ï¼Œè€Œéæ–½åŠ å‹åŠ›&lt;/h2&gt;&lt;p&gt;&lt;span&gt;åœ¨ Scheduler è®¾è®¡åˆæœŸæ—¶ï¼Œæ›´å¤šçš„æ˜¯æŠŠæ³¨æ„åŠ›æ”¾åœ¨äº†å¦‚ä½•èƒ½å¤Ÿå¿«é€Ÿã€å‡†ç¡®ã€ä½å»¶è¿Ÿçš„è§¦å‘ä»»åŠ¡ï¼Œä¸ºæ­¤è¿˜å¤šæ¬¡ä¼˜åŒ–äº†è§¦å‘å™¨ã€åˆ†æ´¾å™¨ã€æ´¾é£å™¨ä¸‰å¤§æ¨¡å—çš„è½®è¯¢é€»è¾‘ï¼Œä½†æ˜¯å¿½ç•¥äº†ä»»åŠ¡é‡è¿‡å¤§æ—¶ä¸‹æ¸¸èƒ½å¦æŠ—ä½æµé‡çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚æœ Scheduler åœ¨è°ƒåº¦æ—¶æ— æ³•å‡†ç¡®æ„ŸçŸ¥ä¸‹æ¸¸å‹åŠ›ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“å°†ä¸‹æ¸¸æ‰“æŒ‚ï¼Œå¦‚ï¼šåœ¨å®šæ—¶ä»»åŠ¡é¦–æ¬¡ä¸Šçº¿æ—¶ï¼Œå› ä¸º kunlun çš„è£…åŒ…æœºåˆ¶å¯¼è‡´æ•°åƒä¸ªåº”ç”¨ä¸‹é…ç½®äº†åŒæ ·çš„å®šæ—¶ä»»åŠ¡ï¼Œè™½ç„¶ä¸€ä¸ªåŒ…å†…çš„æ•°åä¸ªå®šæ—¶ä»»åŠ¡è§¦å‘æ—¶é—´åˆ†æ•£ï¼Œä½†æ˜¯åº”ç”¨åŒ…ä¹‹é—´çš„åŒä¸€ä¸ªä»»åŠ¡è§¦å‘æ—¶é—´ç›¸åŒï¼Œå¯¼è‡´ä¸‹æ¸¸éœ€è¦åœ¨åŒä¸€æ—¶åˆ»å¤„ç†æ•°åƒä¸ªä»»åŠ¡ï¼Œå†åŠ ä¸Šä»»åŠ¡çš„å¤„ç†æµç¨‹è¿˜ä¼šé€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶è¿›è¡Œæ‰©æ•£ï¼Œå¯¼è‡´æ•°æ®åº“åœ¨ä»»åŠ¡æ‰§è¡Œé˜¶æ®µä¸€ç›´å¤„ç†ä½IDLE é˜¶æ®µã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;åˆ†æï¼šæµé‡è¿½è¸ªï¼Œå‰¥èŒ§æŠ½ä¸&lt;/h2&gt;&lt;section&gt;&lt;span&gt;ç›®å‰å¤§éƒ¨åˆ†åç«¯æœåŠ¡ï¼Œé€šè¿‡åˆ†æä»»åŠ¡çš„æµé‡èµ°å‘ï¼Œå¯ä»¥å¤§è‡´ç¡®è®¤æ¯ä¸€æ¡ä»»åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸è®ºæ‰©æ•£è¿˜æ˜¯éæ‰©æ•£æµé‡éƒ½ä¼šèµ°å‘DBï¼Œæµé‡å›¾å¤§è‡´å¦‚å›¾ã€‚&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.24676850763807284&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv44TBZibG6RLeqgp1jF1u85r9gq99LEKlibxVxticyD0xX7MQtPJABx4NvQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;851&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ä»»åŠ¡çš„æµé‡æœ€ç»ˆæ‰“åˆ°äº† DBï¼Œæ‰€ä»¥æµé‡æ§åˆ¶çš„ç›®æ ‡å°±æ›´åŠ æ¸…æ™°ï¼šå¯¹ DB çš„æµé‡æ§åˆ¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;éœ€è¦å¯¹ DB è¿›è¡Œæµé‡æ§åˆ¶ï¼Œé‚£ä¹ˆå°±è¦è®¾å®šåˆç†çš„æŒ‡æ ‡ï¼Œç†è®ºä¸Šï¼Œåªè¦æŒ‡æ ‡é‡‡çº³çš„è¶³å¤Ÿåˆç†ï¼Œå°±èƒ½ä¸¥æ ¼ã€å‡†ç¡®çš„æ§åˆ¶æµé‡ï¼ŒæŒ‡æ ‡åˆ™éœ€è¦å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;å®æ—¶æ€§ã€‚èƒ½å¤Ÿ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;å‡†æ—¶&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ååº”æ•°æ®åº“å¥åº·çŠ¶å†µï¼›&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æƒå¨æ€§ã€‚èƒ½å¤Ÿ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;å‡†ç¡®&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ååº”æ•°æ®åº“å¥åº·çŠ¶å†µã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;ä¼˜å…ˆçº§ï¼šå®æ—¶æ€§ &amp;gt; æƒå¨æ€§ã€‚å½“ä¸€ä¸ªæŒ‡æ ‡çš„å®æ—¶æ€§ä¸å¤Ÿé«˜ï¼Œé‚£ä¹ˆå®ƒçš„æƒå¨æ€§å°±ä¸å†æœ‰ä»·å€¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åªéœ€è¦å®æ—¶ç›‘å¬ç€ DB çš„æŒ‡æ ‡ï¼Œæ¥åˆ¤æ–­ä»»åŠ¡æ˜¯ç«‹åˆ»æ‰§è¡Œï¼Œè¿˜æ˜¯å»¶è¿Ÿæ‰§è¡Œå°±èƒ½æœ‰æ•ˆçš„ä¿æŠ¤ DBã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æŒ‡æ ‡é€‰æ‹©&lt;/span&gt;&lt;/p&gt;&lt;ol start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ¶ˆè´¹ metrics çš„ç›‘æ§ç‚¹ï¼Œå…³äºæ•°æ®åº“çš„æ‰“ç‚¹ä¿¡æ¯éå¸¸å…¨é¢ï¼Œèƒ½å¤Ÿéå¸¸è½»æ˜“çš„è·å–åˆ°æ•°æ®åº“å®¿ä¸»æœºçš„CPUã€å†…å­˜æˆ–æ•°æ®åº“æœ¬èº«çš„è¿æ¥æ•°ã€æŸ¥è¯¢æ•°ç­‰æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡çš„æƒå¨æ€§æ¯‹åº¸ç½®ç–‘ï¼Œä½†æ˜¯ metrics é€šè¿‡å°†æŒ‡æ ‡æ”¶é›†åˆ°æœ¬åœ°ä»£ç†ï¼Œä»£ç†æ¯ 30s åšä¸€æ¬¡èšåˆå‘é€è‡³æœåŠ¡ç«¯ï¼Œ&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;å…¶æ—¶æ•ˆæ€§å¤ªå·®&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;æ•°æ®åº“ä¸å¯ç”¨å› ç´ ä¸ºï¼šå¤§é‡ä»»åŠ¡è§¦å‘ -&amp;gt; DB è®¿é—®æµé‡å¢é«˜ -&amp;gt; CPU idle é™ä½ -&amp;gt; æ•°æ®åº“ä¸å¯ç”¨ã€‚é€ æˆ CPU idle é™ä½çš„å› ç´ ä¸º DB æµé‡å¢é«˜ï¼Œå¯ä»¥å°† DB çš„æµé‡ä½œä¸ºæŒ‡æ ‡è¿›è¡Œæµé‡æ§åˆ¶ï¼Œç¼ºç‚¹æ˜¯&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;strong&gt;éœ€è¦è‡ªå·±é‡‡é›†æŒ‡æ ‡&lt;/strong&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;æŒ‡æ ‡æ”¶é›†&lt;/h2&gt;&lt;h3&gt;&lt;span&gt;æŒ‡æ ‡èŒƒå›´&lt;/span&gt;&lt;/h3&gt;&lt;section&gt;&lt;span&gt;åæ˜  DB å‹åŠ›è¾ƒä¸ºç›´æ¥çš„æŒ‡æ ‡æ˜¯ cpu idleï¼Œä½†è€ƒè™‘åˆ°æœåŠ¡éƒ¨ç½²å¾€å¾€å¤šå®ä¾‹ä»¥åŠ cpu idle é‡‡é›†éš¾åº¦å¤§çš„æƒ…å†µï¼Œä»¥è¿‘ä¼¼æŒ‡æ ‡æ¥ä»£æ›¿ã€‚å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡å†å²æ•°æ®åˆ†æï¼ŒDB æµé‡ä¸ cpu idle æœ‰ä¸€å®šçš„å…³è”ï¼Œå› æ­¤ä»¥ DB æµé‡ä½œä¸º DB å‹åŠ›æŒ‡æ ‡ã€‚&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-height=&quot;1286&quot; data-ratio=&quot;0.7485448195576252&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4icDib3SOiaLpgJanDcpEFWuGosmEoCcQI0ib4IqibeL09iaq0spcnIY4l1ag/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1718&quot; data-width=&quot;1718&quot;/&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;æ•°æ®å­˜å‚¨&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;å‚è€ƒé™æµçš„å®ç°æ–¹æ¡ˆï¼Œé‡‡ç”¨å•ç‹¬çš„ Redis å­˜å‚¨æµé‡æ•°æ®ï¼Œä»¥ 1s ä¸ºæ—¶é—´çª—å£ä½œä¸º Redis keyï¼Œæ¯ä¸ªæ—¶é—´çª—å£çš„æµé‡ä½œä¸º Redis valueï¼Œæ¯æ¬¡å‘ç”Ÿ DB æ“ä½œæ—¶æ›´æ–°æµé‡æ•°æ®ã€‚ç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ª DBï¼Œæ¯ä¸ª DB å•ç‹¬ç»Ÿè®¡ï¼Œåœ¨ Redis key ä¸­åŠ å…¥dbä¿¡æ¯ã€‚Redis key è®¾ç½®10sè¿‡æœŸæ—¶é—´ï¼ŒæŸ¥è¯¢æ—¶æ ¹æ®è¿‡å»3ä¸ªçª—å£çš„åŠ æƒå¹³å‡ï¼ˆ80%/15%/5%ï¼‰ä½œä¸ºå½“å‰æµé‡ï¼Œä»¥å¤„ç†çª—å£äº¤ç•Œå¤„çš„çªå‘æµé‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;æ”¶é›†æ–¹å¼&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;ç›®å‰ DB æµé‡å·²æœ‰ metrics ç›‘æ§æ•°æ®ï¼Œä½†ç”±äº metrics ä¼šåœ¨æœ¬åœ°èšåˆ 30s æ•°æ®åä¸ŠæŠ¥ï¼Œè‡³å°‘ä¼šæœ‰ 30sçš„å»¶è¿Ÿã€‚è€Œé€ æˆ DB å‹åŠ›å¤§çš„å®šæ—¶ä»»åŠ¡å¤šä¸ºçŸ­æœŸé›†ä¸­è§¦å‘ï¼Œä½¿ç”¨ metrics æ•°æ®ä¼šæœ‰æ„ŸçŸ¥ä¸åŠæ—¶çš„é—®é¢˜ï¼Œå› æ­¤éœ€è¦é¢å¤–æ”¶é›†æ•°æ®ã€‚å‚è€ƒ DB metrics æ•°æ®é‡‡é›†çš„æ–¹å¼ï¼Œé€šè¿‡ Gorm çš„ callback æœºåˆ¶æ’å…¥å…·ä½“çš„é‡‡é›†é€»è¾‘ï¼Œå‡å°‘å¯¹ä¸šåŠ¡ä»£ç çš„ä¾µå…¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;true&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;SetMonitorCallBack&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(db *gorm.DB)&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   db.Callback().Create().Before(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;gorm:before_create&quot;&lt;/span&gt;).Register(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;metric:before_create&quot;&lt;/span&gt;, beforeCreateCallback)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   db.Callback().Delete().Before(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;gorm:before_delete&quot;&lt;/span&gt;).Register(&lt;span class=&quot;code-snippet__string&quot;&gt;&quot;metric:before_delete&quot;&lt;/span&gt;, beforeDeleteCallback)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   ...&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;beforeCreateCallback&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(scope *gorm.Scope)&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    beforeCallback(scope, &lt;span class=&quot;code-snippet__string&quot;&gt;&quot;create&quot;&lt;/span&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;beforeCallback&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(scope *gorm.Scope, method &lt;span class=&quot;code-snippet__keyword&quot;&gt;string&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    ...&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;span&gt;åœ¨é‡‡é›†é€»è¾‘ä¸Šï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ï¼š&lt;/span&gt;&lt;/p&gt;&lt;pre&gt;&lt;code data-wrap=&quot;true&quot;&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;go&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;type&lt;/span&gt; MetricType &lt;span class=&quot;code-snippet__keyword&quot;&gt;int8&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;const&lt;/span&gt; (&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  QueryCount MetricType = &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;type&lt;/span&gt; DBMetric &lt;span class=&quot;code-snippet__keyword&quot;&gt;struct&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    DBName   &lt;span class=&quot;code-snippet__keyword&quot;&gt;string&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    DBMethod &lt;span class=&quot;code-snippet__keyword&quot;&gt;string&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    Type MetricType&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    Timestamp &lt;span class=&quot;code-snippet__keyword&quot;&gt;int64&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    Value     &lt;span class=&quot;code-snippet__keyword&quot;&gt;interface&lt;/span&gt;{}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;beforeCallback&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(scope *gorm.Scope, method &lt;span class=&quot;code-snippet__keyword&quot;&gt;string&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    dbName := getStringValueFromCtx(scope.DB().Ctx, CtxVariableDBName)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    curMs := time.Now().UnixNano()/&lt;span class=&quot;code-snippet__keyword&quot;&gt;int64&lt;/span&gt;(time.Millisecond)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    metric := DBMetric{dbName, method, QueryCount, curMs, &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;select&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;case&lt;/span&gt; ch &amp;lt;- metric:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;default&lt;/span&gt;:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;metricAgent&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    windowSize := &lt;span class=&quot;code-snippet__number&quot;&gt;100&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    aggrMetrics := &lt;span class=&quot;code-snippet__keyword&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;code-snippet__keyword&quot;&gt;int64&lt;/span&gt;]&lt;span class=&quot;code-snippet__keyword&quot;&gt;map&lt;/span&gt;[&lt;span class=&quot;code-snippet__keyword&quot;&gt;string&lt;/span&gt;]DBMetric&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    timer := time.NewTicker(windowSize)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;defer&lt;/span&gt; &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;func&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       timer.Stop()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }()&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;for&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;span class=&quot;code-snippet__keyword&quot;&gt;select&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;span class=&quot;code-snippet__keyword&quot;&gt;case&lt;/span&gt; msg := &amp;lt;-ch:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           curWindow := curMs/windowSize&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           æ›´æ–°aggrMetricsä¸­curWindowå¯¹åº”çš„metricï¼ˆå¯¹queryCountæ¥è¯´æ˜¯åŠ &lt;span class=&quot;code-snippet__number&quot;&gt;1&lt;/span&gt;ï¼‰&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;       &lt;span class=&quot;code-snippet__keyword&quot;&gt;case&lt;/span&gt; &amp;lt;-timer.C:&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;           å°†aggrMetricsä¸­key+windowSize&amp;lt;=curTimeçš„æ•°æ®ä¸ŠæŠ¥å¹¶æ¸…é™¤&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;      }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul start=&quot;1&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;span&gt;è¿ç»´æˆæœ¬ï¼šé‡‡é›†é€»è¾‘ä¼šè¿è¡Œåœ¨å„ä¸ªæœåŠ¡ä¸Šï¼Œè€ƒè™‘åˆ°åç»­ä¼šæ”¶é›†æ›´å¤šçš„æŒ‡æ ‡ï¼Œç›´æ¥ä¸ŠæŠ¥ Redis éœ€è¦ç»™å„ä¸ªæœåŠ¡å¼€é€šè¯»å†™æƒé™ï¼Œè¿ç»´ç®¡ç†æˆæœ¬è¾ƒé«˜ã€‚åŸºäºæ­¤ï¼Œä½¿ç”¨é¢å¤–çš„æœåŠ¡æ¥ç®¡ç†æŒ‡æ ‡æ•°æ®ï¼Œæ¥æ”¶ä¸ŠæŠ¥çš„æŒ‡æ ‡æ•°æ®å­˜å…¥ Redisï¼Œå¹¶é€šè¿‡æ¥å£çš„æ–¹å¼æä¾›æŸ¥è¯¢æœåŠ¡ã€‚æŒ‡æ ‡å­˜æ”¾åœ¨æ›´åŠ èšç„¦åœ¨DBèµ„æºçš„resource æœåŠ¡ä¸­ï¼Œåœ¨ resource æœåŠ¡ä¸­é€šè¿‡å¢åŠ æ¥å£çš„æ–¹å¼å®ç°æŒ‡æ ‡æ•°æ®çš„ç®¡ç†åŠŸèƒ½ï¼ŒåŒæ—¶ï¼Œä¸ºäº†ä¸å½±å“ resource åŸæœ‰ä¸šåŠ¡çš„ç¨³å®šæ€§ï¼Œä½¿ç”¨å•ç‹¬çš„é›†ç¾¤æä¾›æœåŠ¡ã€‚&lt;/span&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.8130563798219584&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4kOfmWjv1vpJJGG03BYUjTNV1U1zU6feGtalm5Wp1mNa3oEQs2fvkvg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;674&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span data-meta-block-props=&quot;{&amp;quot;blockType&amp;quot;:&amp;quot;DIAGRAM_BLOCK&amp;quot;,&amp;quot;initData&amp;quot;:&amp;quot;%7B%22data%22%3A%7B%22mxCellList%22%3A%5B%22Xfazc13W%22%2C%22Pect1uf9%22%2C%22IzcPPDCM%22%2C%22dKVFLhD7%22%2C%22y9MiJU2P%22%2C%221UWkGJ8U%22%2C%22cZiSN9SC%22%2C%221xAmiJGI%22%2C%22BqbtgSQN%22%2C%22saeOpCAs%22%2C%22AqV2vvLC%22%2C%22IwQZXnox%22%2C%22G11qs1VY%22%2C%22euPp4iCQ%22%2C%22Wq3ezNTp%22%2C%22oKbWjFpV%22%2C%22tkfJr3ne%22%2C%22h9QvUkVa%22%2C%22Oi2BPCn8%22%2C%22o31bDaCF%22%2C%225Ipy4vFs%22%2C%226tMpMM21%22%2C%22ISZYlo1D%22%2C%22rVZr7hBi%22%2C%224ZD4SYXv%22%2C%22cqRlqkVT%22%2C%22oiLT6GWI%22%2C%22oMOyPYSk%22%2C%22rCj21opl%22%2C%2287jAkrS5%22%2C%22FpSoaVYM%22%2C%22ROD88lM4%22%2C%22Oj3VFKah%22%2C%22eBKTH4D0%22%2C%22TaG2Gi4M%22%2C%221VuHPxBA%22%2C%22yF8bVHdP%22%2C%22Mo4BlpfR%22%5D%2C%22mxGraphModel%22%3A%7B%22arrows%22%3A%221%22%2C%22connect%22%3A%221%22%2C%22dx%22%3A%22946%22%2C%22dy%22%3A%22549%22%2C%22fold%22%3A%221%22%2C%22grid%22%3A%221%22%2C%22gridSize%22%3A%2210%22%2C%22guides%22%3A%221%22%2C%22page%22%3A%221%22%2C%22pageHeight%22%3A%221169%22%2C%22pageScale%22%3A%221%22%2C%22pageWidth%22%3A%22827%22%2C%22tooltips%22%3A%221%22%7D%2C%22mxCellMap%22%3A%7B%221UWkGJ8U%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%2290%22%2C%22x%22%3A%22224%22%2C%22y%22%3A%22365%22%7D%2C%22id%22%3A%221UWkGJ8U%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23FFE6CC%3B%22%2C%22value%22%3A%22%u6027%u80FD%u6570%u636E%u91C7%u96C6%22%2C%22vertex%22%3A%221%22%7D%2C%221VuHPxBA%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2215%22%2C%22width%22%3A%2277%22%2C%22x%22%3A%22531%22%2C%22y%22%3A%22245%22%7D%2C%22id%22%3A%221VuHPxBA%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3Brotation%3D30%3B%22%2C%22value%22%3A%22%u6027%u80FD%u6570%u636E%u67E5%u8BE2%22%2C%22vertex%22%3A%221%22%7D%2C%221xAmiJGI%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2260%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22194%22%2C%22y%22%3A%22525%22%7D%2C%22id%22%3A%221xAmiJGI%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22shape%3Dmxgraph.flowchart.database%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23ffffff%3BstrokeColor%3D%23000000%3BstrokeWidth%3D2%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%224ZD4SYXv%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%22150%22%2C%22width%22%3A%22250%22%2C%22x%22%3A%22373%22%2C%22y%22%3A%2270%22%7D%2C%22id%22%3A%224ZD4SYXv%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%225Ipy4vFs%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%2290%22%2C%22x%22%3A%22534%22%2C%22y%22%3A%22349%22%7D%2C%22id%22%3A%225Ipy4vFs%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%u8D44%u6E90%u8DEF%u7531%22%2C%22vertex%22%3A%221%22%7D%2C%226tMpMM21%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%2290%22%2C%22x%22%3A%22634%22%2C%22y%22%3A%22349%22%7D%2C%22id%22%3A%226tMpMM21%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23FFE6CC%3B%22%2C%22value%22%3A%22%u6027%u80FD%u6570%u636E%u7BA1%u7406%22%2C%22vertex%22%3A%221%22%7D%2C%2287jAkrS5%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22483%22%2C%22y%22%3A%2279%22%7D%2C%22id%22%3A%2287jAkrS5%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22Scheduler%22%2C%22vertex%22%3A%221%22%7D%2C%22AqV2vvLC%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22204%22%2C%22y%22%3A%22294%22%7D%2C%22id%22%3A%22AqV2vvLC%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22Metadata%22%2C%22vertex%22%3A%221%22%7D%2C%22BqbtgSQN%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2260%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22263%22%2C%22y%22%3A%22525%22%7D%2C%22id%22%3A%22BqbtgSQN%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22shape%3Dmxgraph.flowchart.database%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23ffffff%3BstrokeColor%3D%23000000%3BstrokeWidth%3D2%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22FpSoaVYM%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22568.75%22%2C%22y%22%3A%22420%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22568.25%22%2C%22y%22%3A%22490%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22FpSoaVYM%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%7D%2C%22G11qs1VY%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22214.5%22%2C%22y%22%3A%22445%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22214%22%2C%22y%22%3A%22515%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22G11qs1VY%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%7D%2C%22ISZYlo1D%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2260%22%2C%22x%22%3A%22599%22%2C%22y%22%3A%22314%22%7D%2C%22id%22%3A%22ISZYlo1D%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22resource%22%2C%22vertex%22%3A%221%22%7D%2C%22IwQZXnox%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22154%22%2C%22y%22%3A%22445%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22153.5%22%2C%22y%22%3A%22515%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22IwQZXnox%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%7D%2C%22IzcPPDCM%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%22150%22%2C%22width%22%3A%22250%22%2C%22x%22%3A%2294%22%2C%22y%22%3A%22285%22%7D%2C%22id%22%3A%22IzcPPDCM%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22Mo4BlpfR%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2215%22%2C%22width%22%3A%2277%22%2C%22x%22%3A%22416%22%2C%22y%22%3A%22367.5%22%7D%2C%22id%22%3A%22Mo4BlpfR%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22%u6027%u80FD%u6570%u636E%u4E0A%u62A5%22%2C%22vertex%22%3A%221%22%7D%2C%22Oi2BPCn8%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22623%22%2C%22y%22%3A%22499%22%7D%2C%22id%22%3A%22Oi2BPCn8%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22redis%22%2C%22vertex%22%3A%221%22%7D%2C%22Oj3VFKah%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22689.25%22%2C%22y%22%3A%22420%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22688.75%22%2C%22y%22%3A%22490%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22Oj3VFKah%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%7D%2C%22Pect1uf9%22%3A%7B%22id%22%3A%22Pect1uf9%22%2C%22parent%22%3A%22Xfazc13W%22%7D%2C%22ROD88lM4%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22629.25%22%2C%22y%22%3A%22420%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22628.75%22%2C%22y%22%3A%22490%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22ROD88lM4%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%7D%2C%22TaG2Gi4M%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2215%22%2C%22width%22%3A%2257%22%2C%22x%22%3A%22510%22%2C%22y%22%3A%22260%22%7D%2C%22id%22%3A%22TaG2Gi4M%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3Brotation%3D30%3B%22%2C%22value%22%3A%22%u8DEF%u7531%u67E5%u8BE2%22%2C%22vertex%22%3A%221%22%7D%2C%22Wq3ezNTp%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22124%22%2C%22y%22%3A%22549%22%7D%2C%22id%22%3A%22Wq3ezNTp%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22DB%22%2C%22vertex%22%3A%221%22%7D%2C%22Xfazc13W%22%3A%7B%22id%22%3A%22Xfazc13W%22%7D%2C%22cZiSN9SC%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2260%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22124%22%2C%22y%22%3A%22525%22%7D%2C%22id%22%3A%22cZiSN9SC%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22shape%3Dmxgraph.flowchart.database%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23ffffff%3BstrokeColor%3D%23000000%3BstrokeWidth%3D2%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22cqRlqkVT%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%22100%22%2C%22width%22%3A%22210%22%2C%22x%22%3A%22393%22%2C%22y%22%3A%22110%22%7D%2C%22id%22%3A%22cqRlqkVT%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22dKVFLhD7%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%22100%22%2C%22width%22%3A%22210%22%2C%22x%22%3A%22114%22%2C%22y%22%3A%22325%22%7D%2C%22id%22%3A%22dKVFLhD7%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22eBKTH4D0%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22170%22%2C%22y%22%3A%22240%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22220%22%2C%22y%22%3A%22190%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22eBKTH4D0%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22source%22%3A%22IzcPPDCM%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3BexitX%3D1%3BexitY%3D0.5%3BexitDx%3D0%3BexitDy%3D0%3BentryX%3D0%3BentryY%3D0.5%3BentryDx%3D0%3BentryDy%3D0%3B%22%2C%22target%22%3A%22o31bDaCF%22%2C%22value%22%3A%22%22%7D%2C%22euPp4iCQ%22%3A%7B%22-0-mxGeometry%22%3A%7B%22-0-mxPoint%22%3A%7B%22as%22%3A%22sourcePoint%22%2C%22x%22%3A%22274.5%22%2C%22y%22%3A%22445%22%7D%2C%22-1-mxPoint%22%3A%7B%22as%22%3A%22targetPoint%22%2C%22x%22%3A%22274%22%2C%22y%22%3A%22515%22%7D%2C%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22relative%22%3A%221%22%2C%22width%22%3A%2250%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22euPp4iCQ%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22endArrow%3Dclassic%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%7D%2C%22h9QvUkVa%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%22102%22%2C%22x%22%3A%22592%22%2C%22y%22%3A%22494%22%7D%2C%22id%22%3A%22h9QvUkVa%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22shape%3Dcube%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BboundedLbl%3D1%3BbackgroundOutline%3D1%3BdarkOpacity%3D0.05%3BdarkOpacity2%3D0.1%3BfillColor%3D%23E6E6E6%3Bsize%3D32%3B%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22o31bDaCF%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%22100%22%2C%22width%22%3A%22210%22%2C%22x%22%3A%22524%22%2C%22y%22%3A%22309%22%7D%2C%22id%22%3A%22o31bDaCF%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%22%2C%22vertex%22%3A%221%22%7D%2C%22oKbWjFpV%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22194%22%2C%22y%22%3A%22549%22%7D%2C%22id%22%3A%22oKbWjFpV%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22DB%22%2C%22vertex%22%3A%221%22%7D%2C%22oMOyPYSk%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%2290%22%2C%22x%22%3A%22503%22%2C%22y%22%3A%22150%22%7D%2C%22id%22%3A%22oMOyPYSk%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3BfillColor%3D%23FFE6CC%3B%22%2C%22value%22%3A%22%u6027%u80FD%u6570%u636E%u67E5%u8BE2%22%2C%22vertex%22%3A%221%22%7D%2C%22oiLT6GWI%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%2290%22%2C%22x%22%3A%22403%22%2C%22y%22%3A%22150%22%7D%2C%22id%22%3A%22oiLT6GWI%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%u8D44%u6E90%u8DEF%u7531%22%2C%22vertex%22%3A%221%22%7D%2C%22rCj21opl%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2260%22%2C%22x%22%3A%22403%22%2C%22y%22%3A%22120%22%7D%2C%22id%22%3A%22rCj21opl%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22resource_sdk%22%2C%22vertex%22%3A%221%22%7D%2C%22rVZr7hBi%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22relative%22%3A%221%22%7D%2C%22edge%22%3A%221%22%2C%22id%22%3A%22rVZr7hBi%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22source%22%3A%224ZD4SYXv%22%2C%22style%22%3A%22rounded%3D0%3BorthogonalLoop%3D1%3BjettySize%3Dauto%3Bhtml%3D1%3BexitX%3D0.5%3BexitY%3D1%3BexitDx%3D0%3BexitDy%3D0%3BentryX%3D0.5%3BentryY%3D0%3BentryDx%3D0%3BentryDy%3D0%3B%22%2C%22target%22%3A%22o31bDaCF%22%7D%2C%22saeOpCAs%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2260%22%2C%22x%22%3A%22124%22%2C%22y%22%3A%22335%22%7D%2C%22id%22%3A%22saeOpCAs%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22resource_sdk%22%2C%22vertex%22%3A%221%22%7D%2C%22tkfJr3ne%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2220%22%2C%22width%22%3A%2240%22%2C%22x%22%3A%22263%22%2C%22y%22%3A%22550%22%7D%2C%22id%22%3A%22tkfJr3ne%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22DB%22%2C%22vertex%22%3A%221%22%7D%2C%22y9MiJU2P%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2250%22%2C%22width%22%3A%2290%22%2C%22x%22%3A%22124%22%2C%22y%22%3A%22365%22%7D%2C%22id%22%3A%22y9MiJU2P%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22rounded%3D0%3BwhiteSpace%3Dwrap%3Bhtml%3D1%3B%22%2C%22value%22%3A%22%u8D44%u6E90%u8DEF%u7531%22%2C%22vertex%22%3A%221%22%7D%2C%22yF8bVHdP%22%3A%7B%22-0-mxGeometry%22%3A%7B%22as%22%3A%22geometry%22%2C%22height%22%3A%2215%22%2C%22width%22%3A%2257%22%2C%22x%22%3A%22423%22%2C%22y%22%3A%22341%22%7D%2C%22id%22%3A%22yF8bVHdP%22%2C%22parent%22%3A%22Pect1uf9%22%2C%22style%22%3A%22text%3Bhtml%3D1%3BstrokeColor%3Dnone%3BfillColor%3Dnone%3Balign%3Dcenter%3BverticalAlign%3Dmiddle%3BwhiteSpace%3Dwrap%3Brounded%3D0%3B%22%2C%22value%22%3A%22%u8DEF%u7531%u67E5%u8BE2%22%2C%22vertex%22%3A%221%22%7D%7D%7D%2C%22diagramType%22%3A%22flowchart%22%2C%22lastEditTime%22%3A0%7D&amp;quot;,&amp;quot;props&amp;quot;:{&amp;quot;diagramType&amp;quot;:&amp;quot;flowchart&amp;quot;,&amp;quot;viewType&amp;quot;:&amp;quot;card&amp;quot;},&amp;quot;blockId&amp;quot;:&amp;quot;d70932ee-7e6d-403a-bfcb-1563dab93403&amp;quot;}&quot;/&gt;&lt;/p&gt;&lt;h2&gt;Scheduler è°ƒåº¦åé¦ˆ&lt;/h2&gt;&lt;h3&gt;&lt;span&gt;æµé‡é˜ˆå€¼é™åˆ¶&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;Scheduler è°ƒåº¦é€Ÿç‡ä¸ DB è´Ÿè½½ä¹‹é—´çš„å…³ç³»è¾ƒä¸ºå¤æ‚ï¼Œæœ¬æœŸé‡‡ç”¨ç®€å•çš„é˜ˆå€¼åé¦ˆæœºåˆ¶ï¼Œè®¾ç½® DB æµé‡é˜ˆå€¼ï¼Œå½“æµé‡è¶…å‡ºé˜ˆå€¼æ—¶ï¼Œåœæ­¢ Scheduler å½“å‰å‘¨æœŸè°ƒåº¦ã€‚æ ¹æ®å†å²æ•°æ®ï¼Œè®¾ç½®é˜ˆå€¼ä¸º5Kã€‚&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;å½“æµé‡æœªè¶…å‡ºé˜ˆå€¼æ—¶ï¼Œä¸èƒ½é¢„ä¼°ä»»åŠ¡å¯¹ DB æµé‡çš„å½±å“ï¼Œé‡‡ç”¨ç®€å•ç­–ç•¥å¯¹ä»»åŠ¡æ•°è¿›è¡Œé™åˆ¶ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä»»åŠ¡æ•° = max(ï¼ˆDBæµé‡é˜ˆå€¼ - DBå½“å‰æµé‡ï¼‰* 100 / DB æµé‡é˜ˆå€¼, 0)&lt;/span&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;DBè·¯ç”±&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;ç›®å‰ Kunlun çš„ DB èµ„æºæ ¹æ®ç§Ÿæˆ·è¿›è¡Œåˆ†é…ï¼Œä¸åŒç§Ÿæˆ·çš„æ•°æ®å’Œæµé‡ä¼šè½åœ¨ä¸åŒçš„ DB ä¸Šã€‚Schedulerä¼šè®°å½• Job æ‰€å¤„ç§Ÿæˆ·ï¼Œæ‰€ä»¥åœ¨è°ƒåº¦æ—¶ï¼Œéœ€è¦æ ¹æ®ç§Ÿæˆ·æŸ¥æ‰¾çœŸå®çš„ DB èµ„æºï¼Œé€šè¿‡ DB æŒ‡æ ‡çš„å¥åº·çŠ¶å†µæ¥å†³å®šæ˜¯å¦æ´¾é£ä»»åŠ¡ï¼š&lt;/span&gt;&lt;/p&gt;&lt;h2&gt;&lt;span&gt;è°ƒåº¦æ§åˆ¶æµç¨‹&lt;/span&gt;&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;1.620253164556962&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhTYhABQhe0A6BKcF0zBhv4urevd2cYIubSziaicP3CGWqJEzmwEGRQhKwRvZZia43mcr5xWwBLhBJEQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;553&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mp-common-profile class=&quot;js_uneditable js_wx_tap_highlight&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzI1MzYzMjE0MQ==&quot; data-alias=&quot;BytedanceTechBlog&quot; data-from=&quot;2&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/5EcwYhllQOhkoWTP1gVm0Lqs480XOARyoSYjPEsRVCSF35cbWIp6cliaYic8KUfNfiaSjVnruzTQUTCA0lmv9vUmw/0?wx_fmt=png&amp;amp;wx_head=1&quot; data-nickname=&quot;å­—èŠ‚è·³åŠ¨æŠ€æœ¯å›¢é˜Ÿ&quot; data-signature=&quot;å­—èŠ‚è·³åŠ¨çš„æŠ€æœ¯å®è·µåˆ†äº«&quot; has-insert-preloading=&quot;1&quot; data-index=&quot;1&quot; data-origin_num=&quot;223&quot; data-is_biz_ban=&quot;0&quot; data-isban=&quot;0&quot;/&gt;&lt;/section&gt;&lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>9785dc5aa1ca1c26f2d5d29dfd23f9de</guid>
<title>Spring Boot å®ç°è·¨åŸŸçš„ 5 ç§æ–¹å¼ï¼Œæ€»æœ‰ä¸€ç§é€‚åˆä½ ï¼Œå»ºè®®æ”¶è—</title>
<link>https://toutiao.io/k/v14ga1m</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ï¼ˆç»™&lt;/span&gt;&lt;span&gt;ImportNew&lt;/span&gt;&lt;span&gt;åŠ æ˜Ÿæ ‡ï¼Œæé«˜JavaæŠ€èƒ½ï¼‰&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;ä¸€ã€ä¸ºä»€ä¹ˆä¼šå‡ºç°è·¨åŸŸé—®é¢˜&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å‡ºäºæµè§ˆå™¨çš„åŒæºç­–ç•¥é™åˆ¶ã€‚åŒæºç­–ç•¥ï¼ˆSameoriginpolicyï¼‰æ˜¯ä¸€ç§çº¦å®šï¼Œå®ƒæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒä¹Ÿæœ€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå¦‚æœç¼ºå°‘äº†åŒæºç­–ç•¥ï¼Œåˆ™æµè§ˆå™¨çš„æ­£å¸¸åŠŸèƒ½å¯èƒ½éƒ½ä¼šå—åˆ°å½±å“ã€‚å¯ä»¥è¯´Webæ˜¯æ„å»ºåœ¨åŒæºç­–ç•¥åŸºç¡€ä¹‹ä¸Šçš„ï¼Œæµè§ˆå™¨åªæ˜¯é’ˆå¯¹åŒæºç­–ç•¥çš„ä¸€ç§å®ç°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŒæºç­–ç•¥ä¼šé˜»æ­¢ä¸€ä¸ªåŸŸçš„javascriptè„šæœ¬å’Œå¦å¤–ä¸€ä¸ªåŸŸçš„å†…å®¹è¿›è¡Œäº¤äº’ã€‚æ‰€è°“åŒæºï¼ˆå³æŒ‡åœ¨åŒä¸€ä¸ªåŸŸï¼‰å°±æ˜¯ä¸¤ä¸ªé¡µé¢å…·æœ‰ç›¸åŒçš„åè®®ï¼ˆprotocolï¼‰ï¼Œä¸»æœºï¼ˆhostï¼‰å’Œç«¯å£å·ï¼ˆportï¼‰&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;äºŒã€ä»€ä¹ˆæ˜¯è·¨åŸŸ&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“ä¸€ä¸ªè¯·æ±‚urlçš„åè®®ã€åŸŸåã€ç«¯å£ä¸‰è€…ä¹‹é—´ä»»æ„ä¸€ä¸ªä¸å½“å‰é¡µé¢urlä¸åŒå³ä¸ºè·¨åŸŸ&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2613065326633166&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/R3InYSAIZkFRZvaxxgibNH55YbguENmRO91HhpLwywywlIcnFyKxpgUhiaQqXian9vB00DGichYzSQHJxOwlmoNllQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;995&quot;/&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;ä¸‰ã€éåŒæºé™åˆ¶&lt;/span&gt;&lt;/h2&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;æ— æ³•è¯»å–éåŒæºç½‘é¡µçš„ Cookieã€LocalStorage å’Œ IndexedDB&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ— æ³•æ¥è§¦éåŒæºç½‘é¡µçš„ DOM&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ— æ³•å‘éåŒæºåœ°å€å‘é€ AJAX è¯·æ±‚&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;å››ã€java åç«¯ å®ç° CORS è·¨åŸŸè¯·æ±‚çš„æ–¹å¼&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯¹äº CORSçš„è·¨åŸŸè¯·æ±‚ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼å¯ä¾›é€‰æ‹©ï¼š&lt;/p&gt;&lt;ol data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;è¿”å›æ–°çš„CorsFilter&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;é‡å†™ WebMvcConfigurer&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ä½¿ç”¨æ³¨è§£ @CrossOrigin&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;æ‰‹åŠ¨è®¾ç½®å“åº”å¤´ (HttpServletResponse)&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;è‡ªå®šweb filter å®ç°è·¨åŸŸ&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ³¨æ„:&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;CorFilter / WebMvConfigurer / @CrossOrigin éœ€è¦ SpringMVC 4.2ä»¥ä¸Šç‰ˆæœ¬æ‰æ”¯æŒï¼Œå¯¹åº”springBoot 1.3ç‰ˆæœ¬ä»¥ä¸Š&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;ä¸Šé¢å‰ä¸¤ç§æ–¹å¼å±äºå…¨å±€ CORS é…ç½®ï¼Œåä¸¤ç§å±äºå±€éƒ¨ CORSé…ç½®ã€‚å¦‚æœä½¿ç”¨äº†å±€éƒ¨è·¨åŸŸæ˜¯ä¼šè¦†ç›–å…¨å±€è·¨åŸŸçš„è§„åˆ™ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ @CrossOrigin æ³¨è§£æ¥è¿›è¡Œç»†ç²’åº¦æ›´é«˜çš„è·¨åŸŸèµ„æºæ§åˆ¶&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å…¶å®æ— è®ºå“ªç§æ–¹æ¡ˆï¼Œæœ€ç»ˆç›®çš„éƒ½æ˜¯ä¿®æ”¹å“åº”å¤´ï¼Œå‘å“åº”å¤´ä¸­æ·»åŠ æµè§ˆå™¨æ‰€è¦æ±‚çš„æ•°æ®ï¼Œè¿›è€Œå®ç°è·¨åŸŸ&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;Spring Boot ç³»åˆ—æœ€å…¨æ•™ç¨‹çœ‹è¿™é‡Œï¼š&lt;/span&gt;&lt;span&gt;https://blog.didispace.com/spring-boot-learning-2x/&lt;/span&gt;&lt;/section&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;1.è¿”å›æ–°çš„ CorsFilter(å…¨å±€è·¨åŸŸ)&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨ä»»æ„é…ç½®ç±»ï¼Œè¿”å›ä¸€ä¸ª æ–°çš„ CorsFIlter Bean ï¼Œå¹¶æ·»åŠ æ˜ å°„è·¯å¾„å’Œå…·ä½“çš„CORSé…ç½®è·¯å¾„ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;@Configuration&lt;br/&gt;publicÂ classÂ GlobalCorsConfigÂ {&lt;br/&gt;Â Â Â Â @Bean&lt;br/&gt;Â Â Â Â publicÂ CorsFilterÂ &lt;span&gt;&lt;span&gt;corsFilter&lt;/span&gt;&lt;/span&gt;()Â {&lt;br/&gt;Â Â Â Â Â Â Â Â //1.Â æ·»åŠ Â CORSé…ç½®ä¿¡æ¯&lt;br/&gt;Â Â Â Â Â Â Â Â CorsConfigurationÂ configÂ =Â newÂ CorsConfiguration();&lt;br/&gt;Â Â Â Â Â Â Â Â //æ”¾è¡Œå“ªäº›åŸå§‹åŸŸ&lt;br/&gt;Â Â Â Â Â Â Â Â config.addAllowedOrigin(&lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â //æ˜¯å¦å‘é€Â Cookie&lt;br/&gt;Â Â Â Â Â Â Â Â config.setAllowCredentials(&lt;span&gt;true&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â //æ”¾è¡Œå“ªäº›è¯·æ±‚æ–¹å¼&lt;br/&gt;Â Â Â Â Â Â Â Â config.addAllowedMethod(&lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â //æ”¾è¡Œå“ªäº›åŸå§‹è¯·æ±‚å¤´éƒ¨ä¿¡æ¯&lt;br/&gt;Â Â Â Â Â Â Â Â config.addAllowedHeader(&lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â //æš´éœ²å“ªäº›å¤´éƒ¨ä¿¡æ¯&lt;br/&gt;Â Â Â Â Â Â Â Â config.addExposedHeader(&lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â Â Â Â Â //2.Â æ·»åŠ æ˜ å°„è·¯å¾„&lt;br/&gt;Â Â Â Â Â Â Â Â UrlBasedCorsConfigurationSourceÂ corsConfigurationSourceÂ =Â newÂ UrlBasedCorsConfigurationSource();&lt;br/&gt;Â Â Â Â Â Â Â Â corsConfigurationSource.registerCorsConfiguration(&lt;span&gt;&quot;/**&quot;&lt;/span&gt;,config);&lt;br/&gt;Â Â Â Â Â Â Â Â //3.Â è¿”å›æ–°çš„CorsFilter&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â newÂ CorsFilter(corsConfigurationSource);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;2. é‡å†™ WebMvcConfigurer(å…¨å±€è·¨åŸŸ)&lt;span/&gt;&lt;/h3&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;@Configuration&lt;br/&gt;publicÂ classÂ CorsConfigÂ implementsÂ WebMvcConfigurerÂ {&lt;br/&gt;Â Â Â Â @Override&lt;br/&gt;Â Â Â Â publicÂ voidÂ addCorsMappings(CorsRegistryÂ registry)Â {&lt;br/&gt;Â Â Â Â Â Â Â Â registry.addMapping(&lt;span&gt;&quot;/**&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //æ˜¯å¦å‘é€Cookie&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .allowCredentials(&lt;span&gt;true&lt;/span&gt;)&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //æ”¾è¡Œå“ªäº›åŸå§‹åŸŸ&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .allowedOrigins(&lt;span&gt;&quot;*&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .allowedMethods(newÂ String[]{&lt;span&gt;&quot;GET&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;POST&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;PUT&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;DELETE&quot;&lt;/span&gt;})&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .allowedHeaders(&lt;span&gt;&quot;*&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â .exposedHeaders(&lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;3. ä½¿ç”¨æ³¨è§£ (å±€éƒ¨è·¨åŸŸ)&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨æ§åˆ¶å™¨(ç±»ä¸Š)ä¸Šä½¿ç”¨æ³¨è§£ @CrossOrigin:ï¼Œè¡¨ç¤ºè¯¥ç±»çš„æ‰€æœ‰æ–¹æ³•å…è®¸è·¨åŸŸã€‚Spring Boot ç³»åˆ—æœ€å…¨æ•™ç¨‹çœ‹è¿™é‡Œï¼šhttps://blog.didispace.com/spring-boot-learning-2x/&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@RestController&lt;/span&gt;&lt;br/&gt;&lt;span&gt;@CrossOrigin&lt;/span&gt;(originsÂ =Â &lt;span&gt;&quot;*&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;HelloController&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;@RequestMapping&lt;/span&gt;(&lt;span&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br/&gt;Â Â Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â StringÂ &lt;span&gt;hello&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;&quot;helloÂ world&quot;&lt;/span&gt;;&lt;br/&gt;Â Â Â Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨æ–¹æ³•ä¸Šä½¿ç”¨æ³¨è§£ &lt;code&gt;@CrossOrigin&lt;/code&gt;ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;@RequestMapping&lt;/span&gt;(&lt;span&gt;&quot;/hello&quot;&lt;/span&gt;)&lt;br/&gt;&lt;span&gt;@CrossOrigin&lt;/span&gt;(originsÂ =Â &lt;span&gt;&quot;*&quot;&lt;/span&gt;)&lt;br/&gt;Â &lt;span&gt;//@CrossOrigin(valueÂ =Â &quot;http://localhost:8081&quot;)Â //æŒ‡å®šå…·ä½“ipå…è®¸è·¨åŸŸ&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â StringÂ &lt;span&gt;hello&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;&quot;helloÂ world&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;4. æ‰‹åŠ¨è®¾ç½®å“åº”å¤´(å±€éƒ¨è·¨åŸŸ)&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½¿ç”¨ HttpServletResponse å¯¹è±¡æ·»åŠ å“åº”å¤´(Access-Control-Allow-Origin)æ¥æˆæƒåŸå§‹åŸŸï¼Œè¿™é‡Œ Originçš„å€¼ä¹Ÿå¯ä»¥è®¾ç½®ä¸º â€œ*â€,è¡¨ç¤ºå…¨éƒ¨æ”¾è¡Œã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;@RequestMapping(&lt;span&gt;&quot;/index&quot;&lt;/span&gt;)&lt;br/&gt;publicÂ StringÂ index(HttpServletResponseÂ response)Â {&lt;br/&gt;Â Â Â Â response.addHeader(&lt;span&gt;&quot;Access-Allow-Control-Origin&quot;&lt;/span&gt;,&lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â &lt;span&gt;&quot;index&quot;&lt;/span&gt;;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5. ä½¿ç”¨è‡ªå®šä¹‰filterå®ç°è·¨åŸŸ&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é¦–å…ˆç¼–å†™ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œå¯ä»¥èµ·åå­—ä¸ºï¼š&lt;code&gt;MyCorsFilter.java&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;package&lt;/span&gt;Â com.mesnac.aop;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â java.io.IOException;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.Filter;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.FilterChain;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.FilterConfig;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.ServletException;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.ServletRequest;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.ServletResponse;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â javax.servlet.http.HttpServletResponse;&lt;br/&gt;&lt;span&gt;import&lt;/span&gt;Â org.springframework.stereotype.Component;&lt;br/&gt;&lt;span&gt;@Component&lt;/span&gt;&lt;br/&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;&lt;span&gt;class&lt;/span&gt;Â &lt;span&gt;MyCorsFilter&lt;/span&gt;Â &lt;span&gt;implements&lt;/span&gt;Â &lt;span&gt;Filter&lt;/span&gt;Â &lt;/span&gt;{&lt;br/&gt;Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;doFilter&lt;/span&gt;&lt;span&gt;(ServletRequestÂ req,Â ServletResponseÂ res,Â FilterChainÂ chain)&lt;/span&gt;Â &lt;span&gt;throws&lt;/span&gt;Â IOException,Â ServletExceptionÂ &lt;/span&gt;{&lt;br/&gt;Â Â Â Â HttpServletResponseÂ responseÂ =Â (HttpServletResponse)Â res;&lt;br/&gt;Â Â Â Â response.setHeader(&lt;span&gt;&quot;Access-Control-Allow-Origin&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;*&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â response.setHeader(&lt;span&gt;&quot;Access-Control-Allow-Methods&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;POST,Â GET,Â OPTIONS,Â DELETE&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â response.setHeader(&lt;span&gt;&quot;Access-Control-Max-Age&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;3600&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â response.setHeader(&lt;span&gt;&quot;Access-Control-Allow-Headers&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;x-requested-with,content-type&quot;&lt;/span&gt;);&lt;br/&gt;Â Â Â Â chain.doFilter(req,Â res);&lt;br/&gt;Â Â }&lt;br/&gt;Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;init&lt;/span&gt;&lt;span&gt;(FilterConfigÂ filterConfig)&lt;/span&gt;Â &lt;/span&gt;{}&lt;br/&gt;Â Â &lt;span&gt;&lt;span&gt;public&lt;/span&gt;Â &lt;span&gt;void&lt;/span&gt;Â &lt;span&gt;destroy&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;Â &lt;/span&gt;{}&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨web.xmlä¸­é…ç½®è¿™ä¸ªè¿‡æ»¤å™¨ï¼Œä½¿å…¶ç”Ÿæ•ˆ&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&amp;lt;!--Â è·¨åŸŸè®¿é—®Â START--&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;filter&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;&amp;lt;&lt;span&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;CorsFilter&lt;span&gt;&amp;lt;/&lt;span&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;&amp;lt;&lt;span&gt;filter-class&lt;/span&gt;&amp;gt;&lt;/span&gt;com.mesnac.aop.MyCorsFilter&lt;span&gt;&amp;lt;/&lt;span&gt;filter-class&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;filter&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;filter-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;&amp;lt;&lt;span&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;CorsFilter&lt;span&gt;&amp;lt;/&lt;span&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;&amp;lt;&lt;span&gt;url-pattern&lt;/span&gt;&amp;gt;&lt;/span&gt;/*&lt;span&gt;&amp;lt;/&lt;span&gt;url-pattern&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;filter-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;!--Â è·¨åŸŸè®¿é—®Â ENDÂ Â --&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;éƒ½å­¦ä¼šäº†å§ï¼Ÿå»ºè®®æ”¶è—å¤‡ç”¨ï¼&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>