<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>ca13ba09e58a40cebde2cfc68bf98427</guid>
<title>TCP æ‹¥å¡æ§åˆ¶è¯¦è§£ | 5. å›é¿ç®—æ³•</title>
<link>https://toutiao.io/k/hl9hinl</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;&lt;em&gt;ç½‘ç»œä¼ è¾“é—®é¢˜æœ¬è´¨ä¸Šæ˜¯å¯¹ç½‘ç»œèµ„æºçš„å…±äº«å’Œå¤ç”¨é—®é¢˜ï¼Œå› æ­¤æ‹¥å¡æ§åˆ¶æ˜¯ç½‘ç»œå·¥ç¨‹é¢†åŸŸçš„æ ¸å¿ƒé—®é¢˜ä¹‹ä¸€ï¼Œå¹¶ä¸”éšç€äº’è”ç½‘å’Œæ•°æ®ä¸­å¿ƒæµé‡çš„çˆ†ç‚¸å¼å¢é•¿ï¼Œç›¸å…³ç®—æ³•å’Œæœºåˆ¶å‡ºç°äº†å¾ˆå¤šåˆ›æ–°ï¼Œæœ¬ç³»åˆ—æ˜¯å…è´¹ç”µå­ä¹¦ã€ŠTCP Congestion Control: A Systems Approachã€‹çš„ä¸­æ–‡ç‰ˆï¼Œå®Œæ•´ä»‹ç»äº†æ‹¥å¡æ§åˆ¶çš„æ¦‚å¿µã€åŸç†ã€ç®—æ³•å’Œå®ç°æ–¹å¼ã€‚åŸæ–‡: &lt;span&gt;TCP Congestion Control: A Systems Approach&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt;&lt;/em&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.5908273381294964&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0WzfByFlh5E7Zp9lqR7HW0c875R2ibqINPUerQrYxPu5Gsc21os8hKOHKHmIC614ibiacouxFTH3nRUQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1112&quot;/&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p&gt;TCPæ‹¥å¡æ§åˆ¶è¯¦è§£:&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU2MTgxODgwNA==&amp;amp;mid=2247485888&amp;amp;idx=1&amp;amp;sn=4819dcc1373f0e8ffa679847f7ab26e9&amp;amp;chksm=fc73b41bcb043d0dd0e5f2b6ea351b1183fd956ad21a259af84b30f7687d2e838a4122aaa5af&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;1.Â æ¦‚è¿°&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;1.Â æ¦‚è¿°&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU2MTgxODgwNA==&amp;amp;mid=2247485889&amp;amp;idx=1&amp;amp;sn=8b1f3c0d0d6e75a4e5b9dfc3eee8649c&amp;amp;chksm=fc73b41acb043d0c43e88b49b65d7f735c20af8eef23a7671d2da3d22af1db5ee0350aaff04e&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;2. èƒŒæ™¯&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;2. èƒŒæ™¯&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU2MTgxODgwNA==&amp;amp;mid=2247485941&amp;amp;idx=1&amp;amp;sn=7740dc9e8b3a11d0f549c77b1139391b&amp;amp;chksm=fc73b42ecb043d38d8654fa457cde541a2053492022abb64c7bf2a88420add4214fa573fe94e&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;3.Â è®¾è®¡ç©ºé—´&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;3.Â è®¾è®¡ç©ºé—´&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzU2MTgxODgwNA==&amp;amp;mid=2247485942&amp;amp;idx=1&amp;amp;sn=7fc91be8593085d4222c2af7b77cf3c7&amp;amp;chksm=fc73b42dcb043d3b1eb103830533c6cea1a561c5f25eabd3e1669caaa163feaf35e573a3c7ee&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;4. æ§åˆ¶ç®—æ³•&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;4. æ§åˆ¶ç®—æ³•&lt;/a&gt;&lt;/p&gt;&lt;p&gt;5. å›é¿ç®—æ³•&lt;span&gt;ï¼ˆæœ¬&lt;/span&gt;&lt;span&gt;æ–‡ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;p&gt;6. ä¸»åŠ¨é˜Ÿåˆ—ç®¡ç†&lt;/p&gt;&lt;p&gt;7. è¶…è¶ŠTCP&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¬¬5ç«  å›é¿ç®—æ³•(Avoidance-Based Algorithms)&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯¹TCPæ‹¥å¡æ§åˆ¶å­¦æœ¯æ–‡çŒ®çš„å›é¡¾å¯ä»¥å‘ç°ï¼Œæœ€åˆåœ¨1988å¹´å’Œ1990å¹´åˆ†åˆ«å¼•å…¥çš„TCP Tahoeå’ŒRenoæœºåˆ¶ä¸1994å¹´å¼€å§‹çš„ç ”ç©¶æ´»åŠ¨ä¹‹é—´å­˜åœ¨ç€æ˜æ˜¾ä¸åŒï¼Œä¸»è¦æ ‡å¿—æ˜¯å¼•å…¥äº†ä¸€ç§è¢«ç§°ä¸ºTCP Vegasçš„æ›¿ä»£æ–¹æ¡ˆï¼Œä»è€Œå¼•å‘äº†å¤§é‡æ¯”è¾ƒç ”ç©¶å’Œæ›¿ä»£è®¾è®¡ï¼Œå¹¶æŒç»­äº†25å¹´ä»¥ä¸Šçš„æ—¶é—´ã€‚&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;å»¶ä¼¸é˜…è¯»:&lt;br/&gt;L. Brakmo, S. Oâ€™Malley and L. Peterson &lt;span&gt;TCP Vegas: New Technique for Congestion Detection and Avoidance&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt;. ACM SIGCOMM â€˜94 Symposium. August 1994. (Reprinted in IEEE/ACM Transactions on Networking, October 1995).&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å°½ç®¡æˆªæ­¢ç›®å‰æ‰€ä»‹ç»çš„æ–¹æ³•éƒ½å°†ä¸¢åŒ…è§†ä¸ºæ‹¥å¡ä¿¡å·ï¼Œå¹¶è¯•å›¾åœ¨æ‹¥å¡å‘ç”Ÿåå¯¹&lt;em&gt;æ§åˆ¶&lt;/em&gt;æ‹¥å¡åšå‡ºååº”ï¼Œä½†TCP Vegasé‡‡å–äº†ä¸€ç§&lt;em&gt;åŸºäºå›é¿(avoidance-based)&lt;/em&gt; çš„æ–¹æ³•åº”å¯¹æ‹¥å¡: å®ƒè¯•å›¾æ£€æµ‹ååç‡çš„å˜åŒ–æ¥å‘ç°æ‹¥å¡ï¼Œå¹¶åœ¨æ‹¥å¡ä¸¥é‡åˆ°è¶³ä»¥å¯¼è‡´ä¸¢åŒ…ä¹‹å‰è°ƒæ•´å‘é€é€Ÿç‡ã€‚æœ¬ç« å°†ä»‹ç»ä¸€èˆ¬çš„&quot;Vegasç­–ç•¥&quot;ï¼Œä»¥åŠéšç€æ—¶é—´çš„æ¨ç§»å¼•å…¥çš„ä¸‰ä¸ªä¸åŒçš„ä¾‹å­ã€‚è¿™ç±»ç ”ç©¶çš„é«˜æ½®æ˜¯è°·æ­Œå¦‚ä»Šæ‰€å€¡å¯¼çš„BBRç®—æ³•ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5.1 TCP Vegas&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;TCP VegasèƒŒåçš„åŸºæœ¬æ€æƒ³æ˜¯æ ¹æ®æµ‹é‡çš„ååç‡å’Œé¢„æœŸååç‡çš„æ¯”è¾ƒæ¥è°ƒæ•´å‘é€é€Ÿç‡ã€‚å¯ä»¥ä»å›¾29ä¸­ç»™å‡ºçš„TCP Renoå›¾ç¤ºä¸­ç›´è§‚çœ‹åˆ°ï¼Œæœ€ä¸Šé¢çš„å›¾æ˜¾ç¤ºäº†è¿æ¥çš„æ‹¥å¡çª—å£ï¼Œç»™å‡ºçš„ä¿¡æ¯ä¸å‰ä¸€ç« ç›¸åŒã€‚ä¸­é—´å’Œåº•éƒ¨çš„å›¾æè¿°äº†æ–°çš„ä¿¡æ¯: ä¸­é—´çš„å›¾æ˜¾ç¤ºäº†åœ¨å‘é€ç«¯å¤„æµ‹é‡çš„å¹³å‡å‘é€é€Ÿç‡ï¼Œè€Œåº•éƒ¨çš„å›¾æ˜¾ç¤ºäº†åœ¨ç“¶é¢ˆè·¯ç”±å™¨å¤„æµ‹é‡çš„å¹³å‡é˜Ÿåˆ—é•¿åº¦ï¼Œä¸‰ä¸ªå›¾åœ¨æ—¶é—´ä¸Šæ˜¯åŒæ­¥çš„ã€‚åœ¨4.5ç§’åˆ°6.0ç§’ä¹‹é—´(é˜´å½±åŒºåŸŸ)ï¼Œæ‹¥å¡çª—å£å¢åŠ (ä¸Šå›¾)ï¼Œæˆ‘ä»¬é¢„è®¡è§‚å¯Ÿåˆ°çš„ååé‡ä¹Ÿä¼šå¢åŠ ï¼Œä½†å®é™…ä¸Šå´ä¿æŒä¸å˜(ä¸­å›¾)ï¼Œè¿™æ˜¯å› ä¸ºååé‡çš„å¢åŠ ä¸èƒ½è¶…è¿‡å¯ç”¨å¸¦å®½ï¼Œè¶…è¿‡å¯ç”¨å¸¦å®½ä¹‹åï¼Œä»»ä½•çª—å£å¤§å°çš„å¢åŠ åªä¼šå¯¼è‡´å ç”¨æ›´å¤šçš„ç“¶é¢ˆè·¯ç”±å™¨ç¼“å†²åŒºç©ºé—´(ä¸‹å›¾)ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.8232224396607958&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0WzfByFlh5E7Zp9lqR7HW0cqkR3D8TtBgZggBfNW0PgEYnQ4p7dT9qN0vRrPhNlibbcwl1BzKUcSHg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1533&quot;/&gt;&lt;figcaption&gt;å›¾29. æ‹¥å¡çª—å£ä¸è§‚å¯Ÿåˆ°çš„ååé‡æ¯”ç‡(ä¸‰ä¸ªå›¾æ˜¯åŒæ­¥çš„)ã€‚æœ€ä¸Šæ˜¯æ‹¥å¡çª—å£ï¼›ä¸­é—´æ˜¯è§‚å¯Ÿåˆ°çš„ååé‡ï¼›åº•éƒ¨æ˜¯è·¯ç”±å™¨å ç”¨çš„ç¼“å†²åŒºç©ºé—´ã€‚å½©è‰²çº¿=CongestionWindowï¼›å®å¿ƒæ ‡è®°=è¶…æ—¶ï¼›æ•£åˆ—æ ‡è®°=æ¯ä¸ªæ•°æ®åŒ…ä¼ è¾“çš„æ—¶é—´ï¼›ç«–çº¿=æœ€ç»ˆé‡ä¼ çš„æ•°æ®åŒ…çš„ç¬¬ä¸€æ¬¡ä¼ è¾“æ—¶é—´ã€‚&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸€ä¸ªæœ‰è¶£çš„æ¯”å–»å¯ä»¥ç”¨æ¥æè¿°å›¾29ä¸­æ‰€ç¤ºç°è±¡ï¼Œå³å†°ä¸Šé©¾é©¶ã€‚é€Ÿåº¦è®¡(æ‹¥å µçª—å£)å¯èƒ½ä¼šæ˜¾ç¤ºé€Ÿåº¦æ˜¯æ¯å°æ—¶30è‹±é‡Œï¼Œä½†é€šè¿‡çœ‹è½¦çª—å¤–é¢ï¼Œçœ‹åˆ°æ­¥è¡Œç»è¿‡ä½ çš„äººä»¬(æµ‹é‡çš„ååç‡)ï¼Œä½ çŸ¥é“è‡ªå·±çš„é€Ÿåº¦ä¸è¶…è¿‡æ¯å°æ—¶5è‹±é‡Œã€‚åœ¨è¿™ç§ç±»æ¯”ä¸­ï¼Œå‘åŠ¨æœºæ— æ„ä¹‰çš„ç©ºè½¬å°±åƒå‘é€çš„é¢å¤–æ•°æ®åŒ…ä¸€æ ·ï¼Œåªæ˜¯æ— ç”¨çš„åœç•™åœ¨è·¯ç”±å™¨ç¼“å†²åŒºä¸­ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;TCP Vegasç”¨è¿™ç§æ€æƒ³æ¥æµ‹é‡å’Œæ§åˆ¶è¿æ¥ä¼ è¾“ä¸­çš„é¢å¤–æ•°æ®é‡ï¼Œè¿™é‡Œçš„&quot;é¢å¤–æ•°æ®&quot;æŒ‡çš„æ˜¯å¦‚æœå‘é€ç«¯èƒ½å¤Ÿå®Œå…¨åŒ¹é…ç½‘ç»œå¯ç”¨å¸¦å®½ï¼Œå°±ä¸ä¼šä¼ è¾“çš„æ•°æ®ã€‚TCP Vegasçš„ç›®æ ‡æ˜¯åœ¨ç½‘ç»œä¸­ç»´æŠ¤&quot;æ­£ç¡®çš„&quot;é¢å¤–æ•°æ®é‡ã€‚æ˜¾ç„¶ï¼Œå¦‚æœä¸€ä¸ªå‘é€ç«¯å‘é€äº†å¤ªå¤šé¢å¤–æ•°æ®ï¼Œå°†å¯¼è‡´é•¿æ—¶é—´çš„å»¶è¿Ÿï¼Œå¹¶å¯èƒ½å¯¼è‡´æ‹¥å¡ã€‚ä¸å¤ªæ˜æ˜¾çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªè¿æ¥å‘é€çš„é¢å¤–æ•°æ®å¤ªå°‘ï¼Œå°±æ— æ³•å¯¹å¯ç”¨ç½‘ç»œå¸¦å®½çš„çŸ­æš‚å¢åŠ åšå‡ºè¶³å¤Ÿå¿«çš„å“åº”ã€‚TCP VegasåŸºäºä¼°ç®—ç½‘ç»œä¸­é¢å¤–æ•°æ®é‡çš„å˜åŒ–åšå‡ºå›é¿æ‹¥å¡åŠ¨ä½œï¼Œè€Œä¸ä»…ä»…åŸºäºä¸¢åŒ…ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯¦ç»†ä»‹ç»è¿™ä¸ªç®—æ³•ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é¦–å…ˆï¼Œå°†ç»™å®šæµçš„&lt;code&gt;BaseRTT&lt;/code&gt;å®šä¹‰ä¸ºå½“æµæ²¡æœ‰æ‹¥å¡æ—¶æ•°æ®åŒ…çš„RTTã€‚åœ¨å®è·µä¸­ï¼ŒTCP Vegaså°†&lt;code&gt;BaseRTT&lt;/code&gt;è®¾ç½®ä¸ºæµ‹é‡åˆ°çš„æ‰€æœ‰å¾€è¿”æ—¶é—´çš„æœ€å°å€¼ï¼Œé€šå¸¸æ˜¯åœ¨è·¯ç”±å™¨ç”±äºè¯¥æµé€ æˆé˜Ÿåˆ—å¢åŠ ä¹‹å‰ï¼Œè¿æ¥å‘é€çš„ç¬¬ä¸€ä¸ªåŒ…çš„RTTã€‚å¦‚æœå‡è®¾æ²¡æœ‰æº¢å‡ºè¿æ¥ï¼Œé‚£ä¹ˆé¢„æœŸååé‡ä¸º&lt;/p&gt;&lt;span data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;section role=&quot;presentation&quot; data-formula=&quot;\mathsf{ExpectedRate = CongestionWindow\ /\ BaseRTT}&amp;#10;&quot; data-formula-type=&quot;block-equation&quot;&gt;&lt;embed src=&quot;https://mmbiz.qlogo.cn/mmbiz_svg/WmwqjsSBsZLayX7sCuRAiaBx55eHbcJjYAmKcsBibmhAsHgJ50S3OgCb4Ct2Vts1ZBkrGfFCMKYYsiamuDtQWibapmoPsW8NuEYic/0?wx_fmt=svg&quot; data-type=&quot;svg+xml&quot;/&gt;&lt;/section&gt;&lt;/span&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¶ä¸­&lt;code&gt;CongestionWindow&lt;/code&gt;æ˜¯TCPæ‹¥å¡çª—å£ï¼Œå‡è®¾(ä¸ºäº†è¿™ä¸ªè®¨è®ºçš„ç›®çš„)ç­‰äºä¼ è¾“ä¸­çš„å­—èŠ‚æ•°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…¶æ¬¡ï¼ŒTCP Vegasè®¡ç®—å½“å‰å‘é€é€Ÿç‡&lt;code&gt;ActualRate&lt;/code&gt;ã€‚è®¡ç®—æ–¹æ³•æ˜¯è®°å½•ä¸€ä¸ªåŒºåˆ†æ•°æ®åŒ…(distinguished packet)çš„å‘é€æ—¶é—´ï¼Œè®°å½•ä»æ•°æ®åŒ…å‘é€åˆ°æ¥æ”¶åˆ°å®ƒçš„ACKä¹‹é—´ä¼ è¾“äº†å¤šå°‘å­—èŠ‚ï¼Œå¹¶å½“ACKä¿¡æ¯åˆ°è¾¾æ—¶è®¡ç®—åŒºåˆ†æ•°æ®åŒ…çš„æ ·æœ¬RTTï¼Œæœ€åä¼ è¾“å­—èŠ‚æ•°é™¤ä»¥æ ·æœ¬RTTï¼Œæ­¤è®¡ç®—åœ¨æ¯æ¬¡å¾€è¿”æ—¶é—´ä¸­æ‰§è¡Œä¸€æ¬¡ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¬¬ä¸‰ï¼ŒTCP Vegasæ¯”è¾ƒ&lt;code&gt;ActualRate&lt;/code&gt;å’Œ&lt;code&gt;ExpectedRate&lt;/code&gt;å¹¶ç›¸åº”è°ƒæ•´çª—å£ã€‚&lt;code&gt;Diff = ExpectedRate - ActualRate&lt;/code&gt;ï¼Œæ³¨æ„ï¼Œæ ¹æ®å®šä¹‰ï¼Œ&lt;code&gt;Diff&lt;/code&gt;ä¸ºæ­£æˆ–0ã€‚åªæœ‰å½“æµ‹é‡æ ·æœ¬RTTå°äºBaseRTTæ—¶ï¼Œæ‰ä¼šå‡ºç°&lt;code&gt;ActualRate &amp;gt; ExpectedRate&lt;/code&gt;çš„æƒ…å†µï¼Œå¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œå°†&lt;code&gt;BaseRTT&lt;/code&gt;æ”¹ä¸ºæœ€æ–°é‡‡æ ·çš„RTTã€‚æˆ‘ä»¬è¿˜å®šä¹‰äº†ä¸¤ä¸ªé˜ˆå€¼ï¼ŒÎ± &amp;lt; Î²ï¼Œåˆ†åˆ«å¯¹åº”äºç½‘ç»œä¸­é¢å¤–æ•°æ®å¤ªå°‘å’Œå¤ªå¤šçš„æƒ…å†µã€‚å½“&lt;code&gt;Diff&lt;/code&gt; &amp;lt; Î±æ—¶ï¼ŒTCP Vegasåœ¨ä¸‹ä¸€ä¸ªRTTæœŸé—´çº¿æ€§å¢åŠ æ‹¥å¡çª—å£ï¼›å½“&lt;code&gt;Diff&lt;/code&gt; &amp;gt; Î²æ—¶ï¼ŒTCP Vegasåœ¨ä¸‹ä¸€ä¸ªRTTæœŸé—´çº¿æ€§å‡å°‘æ‹¥å¡çª—å£ã€‚å½“Î± &amp;lt; &lt;code&gt;Diff&lt;/code&gt; &amp;lt; Î²æ—¶ï¼ŒTCP Vegasä¿æŒæ‹¥å¡çª—å£ä¸å˜ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç›´è§‚æ¥çœ‹ï¼Œå®é™…ååé‡ä¸é¢„æœŸååé‡ä¹‹é—´çš„å·®è·è¶Šè¿œï¼Œç½‘ç»œä¸­çš„æ‹¥å¡å°±è¶Šå¤§ï¼Œæ„å‘³ç€å‘é€é€Ÿç‡åº”è¯¥é™ä½ï¼ŒÎ²é˜ˆå€¼å°±ä¼šè§¦å‘å‘é€ç‡ä¸‹é™ã€‚å¦ä¸€æ–¹é¢ï¼Œå½“å®é™…ååç‡å¤ªæ¥è¿‘é¢„æœŸååç‡æ—¶ï¼Œè¿æ¥å°±ä¼šé¢ä¸´æ— æ³•åˆ©ç”¨å¯ç”¨å¸¦å®½çš„å¢ƒåœ°ï¼ŒÎ±é˜ˆå€¼å°±ä¼šè§¦å‘å‘é€ç‡çš„å¢åŠ ã€‚æ€»çš„ç›®æ ‡æ˜¯åœ¨ç½‘ç»œä¸­ä¿ç•™çš„é¢å¤–å­—èŠ‚æ•°ä»‹äºÎ±å’ŒÎ²ä¹‹é—´ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.5191292875989446&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0WzfByFlh5E7Zp9lqR7HW0co6VsfbJBAhXAXnnw02G0Az88EQVR0XmNudeGYokTbVWPUDuwcwaA5w/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1516&quot;/&gt;&lt;figcaption&gt;å›¾30. TCP Vegasæ‹¥å¡å›é¿æœºåˆ¶å›¾ç¤ºã€‚ä¸Šå›¾æ˜¯æ‹¥å¡çª—å£ï¼›ä¸‹å›¾ä¸­å½©è‰²çº¿æ˜¯é¢„æœŸååé‡å’Œå®é™…ååé‡(é»‘çº¿)ã€‚é˜´å½±éƒ¨åˆ†æ˜¯Î±å’ŒÎ²é˜ˆå€¼çš„åŒºé—´ã€‚&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å›¾30æ˜¾ç¤ºäº†TCP Vegasæ‹¥å¡é¿å…ç®—æ³•ã€‚ä¸Šå›¾æ˜¾ç¤ºäº†æ‹¥å¡çª—å£ï¼Œä¸æœ¬ç« ç»™å‡ºçš„å…¶ä»–å›¾ç¤ºç›¸åŒã€‚ä¸‹å›¾æ˜¾ç¤ºäº†é¢„æœŸå’Œå®é™…çš„ååé‡ï¼Œè¿™å†³å®šäº†å¦‚ä½•è®¾ç½®æ‹¥å¡çª—å£ã€‚ä¸‹å›¾æœ€èƒ½è¯´æ˜ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚å½©è‰²çº¿æ˜¾ç¤ºäº†&lt;code&gt;ExpectedRate&lt;/code&gt;ï¼Œè€Œé»‘çº¿æ˜¾ç¤ºäº†&lt;code&gt;ActualRate&lt;/code&gt;ã€‚é˜´å½±éƒ¨åˆ†ç»™å‡ºäº†Î±å’ŒÎ²é˜ˆå€¼åŒºé—´ï¼Œé˜´å½±å¸¦çš„é¡¶éƒ¨è·ç¦»&lt;code&gt;ExpectedRate&lt;/code&gt;æœ‰Î± KBpsçš„è·ç¦»ï¼Œåº•éƒ¨è·ç¦»&lt;code&gt;ExpectedRate&lt;/code&gt;æœ‰Î² KBpsçš„è·ç¦»ï¼Œç›®æ ‡æ˜¯å°†&lt;code&gt;ActualRate&lt;/code&gt;ä¿æŒåœ¨é˜´å½±åŒºåŸŸå†…çš„è¿™ä¸¤ä¸ªé˜ˆå€¼ä¹‹é—´ã€‚æ¯å½“&lt;code&gt;ActualRate&lt;/code&gt;ä½äºé˜´å½±åŒºåŸŸ(å³ç¦»&lt;code&gt;ExpectedRate&lt;/code&gt;å¤ªè¿œ)ï¼ŒTCP Vegaså°±ä¼šæ‹…å¿ƒç½‘ç»œä¸­æœ‰å¤ªå¤šçš„åŒ…è¢«ç¼“å†²ï¼Œä»è€Œå‡å°‘æ‹¥å¡çª—å£ã€‚åŒæ ·ï¼Œæ¯å½“&lt;code&gt;ActualRate&lt;/code&gt;è¶…è¿‡é˜´å½±åŒºåŸŸ(å³å¤ªæ¥è¿‘&lt;code&gt;ExpectedRate&lt;/code&gt;)ï¼ŒTCP Vegaså°±ä¼šæ‹…å¿ƒç½‘ç»œæ²¡æœ‰è¢«å……åˆ†åˆ©ç”¨ï¼Œå› æ­¤ä¼šå¢åŠ æ‹¥å¡çª—å£ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç”±äºåˆšæ‰ä»‹ç»çš„ç®—æ³•æ¯”è¾ƒå®é™…å’ŒæœŸæœ›ååé‡ç‡ä¸Î±å’ŒÎ²é˜ˆå€¼ä¹‹é—´çš„å·®å¼‚ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªé˜ˆå€¼æ˜¯æŒ‰ç…§KBpså®šä¹‰çš„ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘è¿æ¥åœ¨ç½‘ç»œä¸­å ç”¨äº†å¤šå°‘é¢å¤–çš„åŒ…ç¼“å†²åŒºå¯èƒ½æ›´å‡†ç¡®ã€‚ä¾‹å¦‚ï¼Œåœ¨&lt;code&gt;BaseRTT&lt;/code&gt;ä¸º100msï¼Œæ•°æ®åŒ…å¤§å°ä¸º1 KBçš„è¿æ¥ä¸Šï¼Œå¦‚æœÎ± = 30 KBpsä»¥åŠÎ² = 60 KBpsï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºÎ±æŒ‡å®šè¯¥è¿æ¥éœ€è¦åœ¨ç½‘ç»œä¸­å ç”¨è‡³å°‘3ä¸ªé¢å¤–çš„ç¼“å†²åŒºï¼Œå¹¶ä¸”Î²æŒ‡å®šè¯¥è¿æ¥åœ¨ç½‘ç»œä¸­å ç”¨ä¸è¶…è¿‡6ä¸ªé¢å¤–çš„ç¼“å†²åŒºã€‚Î±å’ŒÎ²çš„è®¾ç½®åœ¨Vegasç¬¬ä¸€æ¬¡éƒ¨ç½²çš„å®é™…ç¯å¢ƒä¸­å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†æ­£å¦‚ä¸‹ä¸€èŠ‚å°†ä¼šä»‹ç»çš„ï¼Œè¿™äº›å‚æ•°å°†æŒç»­æ ¹æ®ä¸æ–­å˜åŒ–çš„ç¯å¢ƒè¿›è¡Œè°ƒæ•´ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€åï¼Œæ³¨æ„TCP Vegasä»¥çº¿æ€§æ–¹å¼å‡å°‘æ‹¥å¡çª—å£ï¼Œä¼¼ä¹ä¸éœ€è¦æŒ‡æ•°å‡å°‘æ¥ç¡®ä¿ç¨³å®šæ€§çš„è§„åˆ™ç›¸å†²çªã€‚è¿™æ˜¯å› ä¸ºTCP Vegasåœ¨è¶…æ—¶å‘ç”Ÿæ—¶ç¡®å®ä½¿ç”¨æŒ‡æ•°å‡å°‘ï¼Œåˆšæ‰ä»‹ç»çš„çº¿æ€§ä¸‹é™æ˜¯æ‹¥å¡çª—å£çš„æ—©æœŸä¸‹é™ï¼Œå‘ç”Ÿåœ¨æ‹¥å¡å‘ç”Ÿä»¥åŠæ•°æ®åŒ…å¼€å§‹è¢«ä¸¢å¼ƒä¹‹å‰ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5.2 ä¸åŒçš„å‡è®¾&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†å“åº”ä¸åŒç½‘ç»œçš„å‡è®¾ï¼ŒTCP Vegasä»¥åŠç±»ä¼¼Vegasçš„æ‹¥å¡å›é¿æ–¹æ³•å·²ç»éšç€æ—¶é—´çš„æ¨ç§»è¿›è¡Œäº†è°ƒæ•´ã€‚Vegasä»æœªåƒRenoé‚£æ ·è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ‰€ä»¥è¿™äº›ä¿®æ”¹é€šå¸¸æ›´å¤šçš„æ˜¯ç”±å®éªŒå®¤ç ”ç©¶è€Œä¸æ˜¯å¹¿æ³›çš„ç°å®ç»éªŒé©±åŠ¨çš„ï¼Œä½†å¯¹ç®—æ³•çš„å®Œå–„æœ‰åŠ©äºæˆ‘ä»¬å¯¹åŸºäºå›é¿çš„ç®—æ³•çš„ç†è§£ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œæ€»ç»“äº†å…¶ä¸­ä¸€äº›è§è§£ï¼Œä½†åœ¨ç¬¬7ç« ä¸­æˆ‘ä»¬å°†ç»§ç»­ä»‹ç»ä¸ºç‰¹å®šç”¨ä¾‹å®šåˆ¶æ‹¥å¡æ§åˆ¶ç®—æ³•çš„ä¸€èˆ¬æ€§ä¸»é¢˜ã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5.2.1 FAST TCP&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç¬¬ä¸€ç§å—åˆ°Vegaså¯å‘çš„æœºåˆ¶æ˜¯FAST TCPï¼Œå®ƒå¯¹Vegasè¿›è¡Œäº†æ”¹è¿›ï¼Œä½¿å…¶åœ¨å…·æœ‰å¤§å¸¦å®½æ—¶å»¶ç§¯çš„é«˜é€Ÿç½‘ç»œä¸Šæ›´åŠ é«˜æ•ˆã€‚å…¶ä¸»è¦æƒ³æ³•æ˜¯åœ¨ç®—æ³•è¯•å›¾æ‰¾åˆ°å¯ç”¨çš„&quot;ä¼ è¾“ä¸­&quot;å¸¦å®½(æ•°æ®åŒ…åœ¨ç½‘ç»œä¸­è¢«ç¼“å†²ä¹‹å‰)çš„é˜¶æ®µæ›´ç§¯æçš„å¢åŠ æ‹¥å¡çª—å£ï¼Œç„¶ååœ¨ç®—æ³•å¼€å§‹ä¸å…¶ä»–æµåœ¨ç“¶é¢ˆè·¯ç”±å™¨ä¸Šäº‰å¤ºç¼“å†²åŒºæ—¶è¡¨ç°çš„ä¿å®ˆã€‚FASTè¿˜å»ºè®®å°†Î±å€¼è°ƒæ•´ä¸ºå¤§çº¦30ä¸ªåŒ…ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é™¤äº†åœ¨å…·æœ‰å¤§å¸¦å®½æ—¶å»¶ç§¯çš„ç½‘ç»œä¸­ç®¡ç†æ‹¥å¡ä¹‹å¤–ï¼Œä¿æŒæµæ°´çº¿æ»¡ä¹Ÿæ˜¯ä¸€ä¸ªå®è´¨æ€§çš„æŒ‘æˆ˜ï¼Œå…³äºFASTè¿˜æœ‰ä¸¤ä¸ªå€¼å¾—æ³¨æ„çš„äº‹é¡¹ã€‚é¦–å…ˆï¼ŒTCP Renoå’ŒTCP Vegaséƒ½æ˜¯åŸºäºç›´è§‰å’Œå¤§é‡è¯•é”™çš„ç»“æœï¼Œè€ŒFASTæ˜¯åŸºäºä¼˜åŒ–ç†è®º(åæ¥è¿™è¢«ç”¨æ¥è§£é‡Šä¸ºä»€ä¹ˆVegasè¡Œå¾—é€š)ã€‚å…¶æ¬¡ï¼Œä¸æˆ‘ä»¬æ‰€çŸ¥çš„æ‰€æœ‰å…¶ä»–æ‹¥å¡æ§åˆ¶ç®—æ³•ä¸åŒï¼ŒFASTçš„å®ç°åªèƒ½ä½œä¸ºä¸“æœ‰çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;å»¶ä¼¸é˜…è¯»:&lt;br/&gt;S. Low, L. Peterson, and L. Wang. &lt;span&gt;Understanding TCP Vegas: A Duality Model&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt;. Journal of the ACM, Volume 49, Issue 2, March 2002.&lt;/p&gt;&lt;/blockquote&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5.2.2 TCP Westwood&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è™½ç„¶Vegasçš„åŠ¨æœºæ˜¯åœ¨å‘ç”Ÿä¸¢åŒ…ä¹‹å‰æ£€æµ‹å¹¶é¿å…æ‹¥å¡ï¼Œä½†TCP Westwood (TCPW)çš„åŠ¨æœºä¸»è¦æ˜¯æ„è¯†åˆ°æ•°æ®åŒ…ä¸¢å¤±å¹¶ä¸æ€»æ˜¯æ‹¥å¡çš„å¯é æŒ‡æ ‡ã€‚è¿™åœ¨æ— çº¿è¿æ¥æ–¹é¢å°¤å…¶æ˜æ˜¾ï¼Œåœ¨Vegasè¢«æå‡ºæ—¶è¿™è¿˜æ˜¯æ–°é²œäº‹ç‰©ï¼Œä½†åœ¨TCPWå‡ºç°æ—¶å·²ç»å˜å¾—å¾ˆæ™®éäº†ã€‚æ— çº¿é“¾è·¯ç»å¸¸ä¼šå› ä¸ºæ— çº¿ä¿¡é“ä¸Šæœªçº æ­£çš„é”™è¯¯è€Œä¸¢åŒ…ï¼Œè€Œè¿™ä¸æ‹¥å¡æ— å…³ï¼Œå› æ­¤ï¼Œéœ€è¦ç”¨å¦ä¸€ç§æ–¹æ³•æ£€æµ‹æ‹¥å¡ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå…¶æœ€ç»ˆç»“æœä¸Vegasæœ‰äº›ç›¸ä¼¼ï¼ŒTCPWè¿˜è¯•å›¾é€šè¿‡æŸ¥çœ‹ACKè¿”å›æˆåŠŸäº¤ä»˜çš„æ•°æ®åŒ…çš„é€Ÿç‡æ¥ç¡®å®šç“¶é¢ˆå¸¦å®½ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“å‘ç”Ÿä¸¢åŒ…æ—¶ï¼Œå› ä¸ºè¿˜ä¸çŸ¥é“ä¸¢åŒ…æ˜¯ç”±äºæ‹¥å¡è¿˜æ˜¯ç”±äºé“¾è·¯ç›¸å…³ï¼ŒTCPWä¸ä¼šç«‹å³å°†æ‹¥å¡çª—å£ç¼©çŸ­ä¸€åŠï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ä¼šä¼°è®¡åœ¨ä¸¢åŒ…å‘ç”Ÿä¹‹å‰æµé‡çš„æµåŠ¨é€Ÿåº¦ï¼Œè¿™æ˜¯ä¸€ç§æ¯”TCP Renoæ›´æ¸©å’Œçš„é€€è®©å½¢å¼ã€‚å¦‚æœä¸¢åŒ…ä¸æ‹¥å¡ç›¸å…³ï¼Œåˆ™TCPWåº”è¯¥ä»¥ä¸¢åŒ…å‰å¯æ¥å—çš„é€Ÿç‡å‘é€ã€‚å¦‚æœä¸¢åŒ…æ˜¯ç”±æ— çº¿é”™è¯¯é€ æˆçš„ï¼Œåˆ™TCPWä¸ä¼šé™ä½å‘é€ç‡ï¼Œå¹¶ä¸”è¿˜ä¼šå¼€å§‹å†æ¬¡æé«˜å‘é€ç‡ï¼Œä»¥å……åˆ†åˆ©ç”¨ç½‘ç»œã€‚å…¶ç»“æœæ˜¯ä¸€ä¸ªåœ¨å›ºå®šé“¾æ¥ä¸Šç±»ä¼¼äºRenoï¼Œä½†åœ¨æœ‰æŸé“¾æ¥ä¸Šæ€§èƒ½è·å¾—äº†å®è´¨æ€§æå‡çš„åè®®ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ— çº¿é“¾è·¯ä¸Šæ‹¥å¡æ§åˆ¶ç®—æ³•çš„ä¼˜åŒ–ä»ç„¶æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œæ›´å¤æ‚çš„æ˜¯ï¼ŒWiFiå’Œç§»åŠ¨èœ‚çªç½‘ç»œå…·æœ‰ä¸åŒçš„ç‰¹æ€§ã€‚æˆ‘ä»¬å°†åœ¨ç¬¬7ç« é‡æ–°è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;&lt;h5 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5.2.3 New Vegas&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€åä¸€ä¸ªä¾‹å­æ˜¯New Vegas (NV)ï¼Œå®ƒæ˜¯å¯¹VegasåŸºäºå»¶è¿Ÿçš„æ–¹æ³•çš„ä¸€ç§é€‚åº”ï¼Œé€‚ç”¨äºé“¾è·¯å¸¦å®½ä¸º10Gbpsæˆ–æ›´é«˜çš„æ•°æ®ä¸­å¿ƒç½‘ç»œï¼Œå…¶RTTé€šå¸¸åœ¨å‡ åå¾®ç§’å†…ã€‚è¿™æ˜¯æˆ‘ä»¬åœ¨ç¬¬7ç« å°†ä»‹ç»çš„ä¸€ä¸ªé‡è¦ç”¨ä¾‹ï¼Œå½“å‰çš„ç›®æ ‡æ˜¯å»ºç«‹ä¸€äº›ç›´è§‚æ„Ÿå—ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†ç†è§£NVçš„åŸºæœ¬æ€æƒ³ï¼Œå‡è®¾æˆ‘ä»¬ä¸ºæ¯ä¸ªæ”¶åˆ°ACKçš„åŒ…ç»˜åˆ¶&lt;code&gt;Rate&lt;/code&gt;ä¸&lt;code&gt;CongestionWindow&lt;/code&gt;çš„å…³ç³»å›¾ã€‚å‡ºäºç®€åŒ–ç›®çš„ï¼Œ&lt;code&gt;Rate&lt;/code&gt;ä»…ä»…æ˜¯&lt;code&gt;CongestionWindow&lt;/code&gt;(ä»¥å­—èŠ‚ä¸ºå•ä½)ä¸è¢«ACK(ä»¥ç§’ä¸ºå•ä½)çš„æ•°æ®åŒ…RTTçš„æ¯”ç‡ã€‚æ³¨æ„ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œè®¨è®ºä¸­ä½¿ç”¨äº†&lt;code&gt;CongestionWindow&lt;/code&gt;ï¼Œè€Œå®é™…ä¸ŠNVä½¿ç”¨çš„æ˜¯ä¼ è¾“ä¸­(æœªæ”¶åˆ°ACK)çš„å­—èŠ‚ã€‚å¦‚å›¾31æ‰€ç¤ºï¼Œæˆ‘ä»¬ç”¨ç«–æ¡(è€Œä¸æ˜¯ç‚¹)è¡¨ç¤ºç”±äºæµ‹é‡ä¸­çš„ç¬æ—¶æ‹¥å¡æˆ–å™ªå£°è€Œå¯¼è‡´çš„&lt;code&gt;CongestionWindow&lt;/code&gt;å€¼ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.597027972027972&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0WzfByFlh5E7Zp9lqR7HW0c9WouOt22zQvxc533yuKZEV8TZnN0XVBaLHRTY2nRChbiakEwNcOkiaOQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1144&quot;/&gt;&lt;figcaption&gt;å›¾31. é€Ÿç‡ä¸æ‹¥å¡çª—å£ç¤ºæ„å›¾ã€‚&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¡å½¢å›¾é¡¶éƒ¨çš„æœ€å¤§æ–œç‡è¡¨ç¤ºè¿‡å»æ‰€èƒ½è¾¾åˆ°çš„æœ€ä½³æ°´å¹³ã€‚åœ¨ä¸€ä¸ªç»è¿‡è‰¯å¥½è°ƒæ•´çš„ç³»ç»Ÿä¸­ï¼Œæ¡å½¢å›¾çš„é¡¶ç«¯ç”±ä¸€æ¡ç©¿è¿‡åŸç‚¹çš„ç›´çº¿ä½œä¸ºè¾¹ç•Œã€‚è¿™ä¸ªæƒ³æ³•æ˜¯ï¼Œåªè¦ç½‘ç»œæ²¡æœ‰æ‹¥å¡ï¼Œæ¯RTTå‘é€çš„æ•°æ®é‡å¢åŠ ä¸€å€ï¼Œé€Ÿç‡å°±ä¼šå¢åŠ ä¸€å€ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;Rate&lt;/code&gt;å’Œ&lt;code&gt;CongestionWindow&lt;/code&gt;çš„æ–°æµ‹é‡å€¼å¯ä»¥è½åœ¨è¾¹ç•Œçº¿é™„è¿‘(å›¾ä¸­çš„é»‘è‰²è±å½¢)æˆ–ä¸‹é¢(å›¾ä¸­çš„è“è‰²è±å½¢)ã€‚åœ¨è¯¥ç›´çº¿ä¸Šæ–¹çš„æµ‹é‡ä¼šå¯¼è‡´NVé€šè¿‡å¢åŠ å…¶æ–œç‡æ¥è‡ªåŠ¨æ›´æ–°è¯¥ç›´çº¿ï¼Œå› æ­¤æµ‹é‡ç»“æœå°†è½åœ¨æ–°ç›´çº¿ä¸Šã€‚å¦‚æœæ–°çš„åº¦é‡å€¼æ¥è¿‘è¿™æ¡çº¿ï¼Œé‚£ä¹ˆNVä¼šå¢åŠ &lt;code&gt;CongestionWindow&lt;/code&gt;ã€‚å¦‚æœæµ‹é‡å€¼ä½äºè¿™æ¡çº¿ï¼Œé‚£å°±æ„å‘³ç€å’Œä¹‹å‰è¾ƒä½çš„æ‹¥å¡çª—å£ç±»ä¼¼çš„æ€§èƒ½ã€‚å›¾31æ‰€ç¤ºç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸&lt;code&gt;CongestionWindow=12&lt;/code&gt;ç±»ä¼¼çš„æ€§èƒ½ï¼Œæ‰€ä»¥å‡å°‘äº†&lt;code&gt;CongestionWindow&lt;/code&gt;ã€‚åœ¨æ–°çš„æµ‹é‡æœ‰å™ªå£°çš„æƒ…å†µä¸‹ï¼Œè¿™ç§é™ä½æ˜¯æŒ‡æ•°çº§çš„ï¼Œè€Œä¸æ˜¯ç¬é—´çš„ã€‚ä¸ºäº†è¿‡æ»¤æ‰ä¸å¥½çš„åº¦é‡å€¼ï¼ŒNVæ”¶é›†äº†è®¸å¤šåº¦é‡å€¼ï¼Œç„¶ååœ¨åšå‡ºæ‹¥å¡åˆ¤æ–­ä¹‹å‰ä½¿ç”¨æœ€å¥½çš„åº¦é‡å€¼ã€‚&lt;/p&gt;&lt;h4 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5.3 TCP BBR&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;BBR(Bottleneck Bandwidth and RTT)æ˜¯è°·æ­Œç ”ç©¶äººå‘˜å¼€å‘çš„ä¸€ç§æ–°çš„TCPæ‹¥å¡æ§åˆ¶ç®—æ³•ã€‚åƒVegasä¸€æ ·ï¼ŒBBRæ˜¯åŸºäºå»¶è¿Ÿçš„ï¼Œæ„å‘³ç€å®ƒè¯•å›¾æ£€æµ‹ç¼“å†²åŒºçš„å¢é•¿ï¼Œä»¥é¿å…æ‹¥å¡å’Œä¸¢åŒ…ã€‚BBRå’ŒVegaséƒ½ä½¿ç”¨æœ€å°RTTå’Œè§‚å¯Ÿåˆ°çš„ç“¶é¢ˆå¸¦å®½(æ ¹æ®ä¸€æ®µæ—¶é—´é—´éš”è®¡ç®—)ä½œä¸ºä¸»è¦æ§åˆ¶ä¿¡å·ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5086442220200182&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0WzfByFlh5E7Zp9lqR7HW0cBolnvb2sAWoDUNayZYV38aIqCzV0LgXhmR9OFO6MA9Roa797rCwGeA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1099&quot;/&gt;&lt;figcaption&gt;å›¾32. æ ¹æ®è§‚å¯Ÿåˆ°çš„ååé‡å’ŒRTTç¡®å®šæœ€ä½³å‘é€é€Ÿç‡ã€‚&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å›¾32æ˜¾ç¤ºäº†BBRçš„åŸºæœ¬æ€æƒ³ã€‚å‡è®¾æŸä¸ªç½‘ç»œçš„ç“¶é¢ˆé“¾è·¯è¿˜æœ‰ä¸€äº›å¯ç”¨å¸¦å®½å’Œé˜Ÿåˆ—å®¹é‡ï¼Œéšç€æ‹¥å¡çª—å£æ‰“å¼€ï¼Œæ›´å¤šçš„æ•°æ®è¢«å‘é€ï¼Œæœ€åˆç”±äºç“¶é¢ˆæœªæ»¡ï¼Œå»¶è¿Ÿæ²¡æœ‰å¢åŠ ï¼Œååé‡ä¼šå¢åŠ (ä¸‹å›¾)ã€‚ç„¶åï¼Œä¸€æ—¦é€Ÿç‡è¾¾åˆ°ç“¶é¢ˆå¸¦å®½ï¼Œå°±å¼€å§‹å¡«å……é˜Ÿåˆ—ã€‚æ­¤æ—¶ï¼ŒRTTä¸Šå‡ï¼Œä½†æ²¡æœ‰è§‚å¯Ÿåˆ°ååé‡ä¸Šå‡ï¼Œè¿™æ˜¯æ‹¥å¡é˜¶æ®µçš„å¼€å§‹ã€‚è¿™ä¸ªå›¾è¡¨å®é™…ä¸Šæ˜¯æˆ‘ä»¬åœ¨å›¾29ä¸­4.5åˆ°6.0ç§’æ—¶é—´æ¡†æ¶ä¸­çœ‹åˆ°çš„ç®€åŒ–ç‰ˆæœ¬ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åƒVegasä¸€æ ·ï¼ŒBBRçš„ç›®æ ‡æ˜¯å‡†ç¡®ç¡®å®šé˜Ÿåˆ—åˆšåˆšå¼€å§‹å¡«å……çš„é‚£ä¸ªç‚¹ï¼Œè€Œä¸æ˜¯åƒRenoé‚£æ ·ä¸€ç›´æŒç»­åˆ°å¡«æ»¡ç¼“å†²åŒºå¹¶å¯¼è‡´ä¸¢åŒ…ã€‚BBRçš„å¾ˆå¤šå·¥ä½œéƒ½æ˜¯å›´ç»•ç€æé«˜å®šä½æœ€ä½³ç‚¹çš„æœºåˆ¶çš„çµæ•åº¦ï¼Œå…¶ä¸­æœ‰è®¸å¤šæŒ‘æˆ˜: æµ‹é‡å¸¦å®½å’Œå»¶è¿Ÿæ˜¯æœ‰å™ªå£°çš„ï¼›ç½‘ç»œæ¡ä»¶æ˜¯åŠ¨æ€çš„ï¼›ä»¥åŠåœ¨ä¸BBRå’ŒéBBRæµç«äº‰å¸¦å®½æ—¶å¯¹å…¬å¹³çš„é•¿æœŸè¿½æ±‚ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸å…¶ä»–æ–¹æ³•ç›¸æ¯”ï¼ŒBBRçš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹æ˜¯ä¸å®Œå…¨ä¾èµ–äº&lt;code&gt;CongestionWindow&lt;/code&gt;æ¥å†³å®šæœ‰å¤šå°‘æ•°æ®è¢«ä¼ è¾“ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒBBRè¿˜è¯•å›¾å¹³æ»‘å‘é€è€…å°†æ•°æ®é€å…¥ç½‘ç»œçš„é€Ÿç‡ï¼Œä»¥é¿å…ä¼šå¯¼è‡´è¿‡åº¦æ’é˜Ÿçš„çªå‘å³°å€¼æµé‡ã€‚ç†æƒ³æ¡ä»¶ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä»¥å®Œå…¨ç¬¦åˆç“¶é¢ˆçš„é€Ÿåº¦å‘é€æ•°æ®ï¼Œä»è€Œåœ¨ä¸é€ æˆé˜Ÿåˆ—å †ç§¯çš„æƒ…å†µä¸‹å®ç°å°½å¯èƒ½é«˜çš„ååé‡ã€‚è™½ç„¶å¤§å¤šæ•°TCPå˜ä½“ä½¿ç”¨ACKåˆ°è¾¾æ¥è§¦å‘æ•°æ®çš„å‘é€ï¼Œä»è€Œç¡®ä¿ä¼ è¾“ä¸­æœªç¡®è®¤æ•°æ®çš„æ•°é‡ä¿æŒä¸å˜ï¼Œä½†BBRåˆ›å»ºäº†ç“¶é¢ˆå¸¦å®½çš„ä¼°ç®—ï¼Œå¹¶ä½¿ç”¨æœ¬åœ°è°ƒåº¦ç®—æ³•ä»¥è¯¥é€Ÿç‡å‘é€æ•°æ®ã€‚ACKåœ¨æ›´æ–°æœ‰å…³ç½‘ç»œçš„çŠ¶æ€æ–¹é¢ä»ç„¶å‘æŒ¥ç€é‡è¦ä½œç”¨ï¼Œä½†å¹¶ä¸ç›´æ¥ç”¨äºè°ƒæ•´ä¼ è¾“é€Ÿåº¦ï¼Œè¿™æ„å‘³ç€å»¶è¿Ÿçš„ACKä¸ä¼šå¯¼è‡´ä¼ è¾“é‡çš„çªç„¶çˆ†å‘ã€‚å½“ç„¶ï¼Œ&lt;code&gt;CongestionWindow&lt;/code&gt;ä»ç„¶ç”¨äºç¡®ä¿å¯ä»¥å‘é€è¶³å¤Ÿçš„æ•°æ®ä»¥ä¿æŒæµæ°´çº¿æ»¡ï¼Œå¹¶ç¡®ä¿ä¼ è¾“ä¸­çš„æ•°æ®é‡ä¸ä¼šæ¯”å¸¦å®½å»¶è¿Ÿç§¯å¤§å¤ªå¤šï¼Œä»è€Œé¿å…é˜Ÿåˆ—æº¢å‡ºã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†ç»´æŠ¤å½“å‰RTTå’Œç“¶é¢ˆå¸¦å®½çš„æœ€æ–°è§†å›¾ï¼Œæœ‰å¿…è¦åœ¨å½“å‰ä¼°è®¡çš„ç“¶é¢ˆå¸¦å®½ä¸Šä¸‹æŒç»­æ¢æµ‹ã€‚ç”±äºç«äº‰æµæµé‡çš„å‡å°‘ã€é“¾è·¯å±æ€§(å¦‚æ— çº¿é“¾è·¯)çš„å˜åŒ–æˆ–è·¯ç”±çš„å˜åŒ–ï¼Œä¹Ÿè®¸å¯ä»¥è·å¾—æ›´å¤šå¸¦å®½ã€‚å¦‚æœè·¯å¾„å˜åŒ–äº†ï¼ŒRTTä¹Ÿæœ‰å¯èƒ½ä¼šå˜ã€‚ä¸ºäº†æ£€æµ‹RTTçš„å˜åŒ–ï¼Œéœ€è¦å‘é€æ›´å°‘çš„æµé‡ï¼Œä»è€Œæ¸…ç©ºé˜Ÿåˆ—ã€‚ä¸ºäº†æ£€æµ‹å¯ç”¨å¸¦å®½çš„å˜åŒ–ï¼Œéœ€è¦å‘é€æ›´å¤šçš„æµé‡ã€‚å› æ­¤ï¼ŒBBRåœ¨å…¶å½“å‰ä¼°è®¡çš„ç“¶é¢ˆå¸¦å®½çš„ä¸Šä¸‹åŒæ—¶æ¢æµ‹ï¼Œå¦‚æœæœ‰å¿…è¦ï¼Œä¼šæ›´æ–°ä¼°ç®—ï¼Œå¹¶ç›¸åº”æ›´æ–°å‘é€é€Ÿç‡å’Œ&lt;code&gt;CongestionWindow&lt;/code&gt;ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;2.3642611683848798&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/9utHkjMdE0WzfByFlh5E7Zp9lqR7HW0cic92ImEhjxHjPG6BLM5LHPFZ42icjAbxNrZafg3Wicg13uibFlJl8ml5icQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;291&quot;/&gt;&lt;figcaption&gt;å›¾33. BBRçŠ¶æ€æœºå›¾ã€‚&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å›¾33çš„çŠ¶æ€å›¾æ˜¾ç¤ºäº†é¡ºåºæ¢æµ‹å¯ç”¨å¸¦å®½å’Œæœ€å°RTTçš„è¿‡ç¨‹ã€‚åœ¨å°è¯•å»ºç«‹è·¯å¾„ä¸Šçš„å¯ç”¨å¸¦å®½çš„æ¿€è¿›å¯åŠ¨é˜¶æ®µä¹‹åï¼Œé™ä½å‘é€é€Ÿç‡ä»¥æ¸…ç©ºé˜Ÿåˆ—ï¼Œç„¶åç®—æ³•è¿›å…¥å›¾çš„å†…ç¯ï¼Œåœ¨å†…ç¯ä¸­ï¼Œå®šæœŸæ£€æŸ¥åœ¨è¾ƒä½å‘é€é€Ÿç‡ä¸‹æ˜¯å¦æœ‰æ›´ä½çš„å»¶è¿Ÿï¼Œæˆ–è€…åœ¨è¾ƒé«˜å‘é€é€Ÿç‡ä¸‹æ˜¯å¦æœ‰æ›´é«˜çš„ååé‡ã€‚åœ¨ä¸€ä¸ªç›¸å¯¹è¾ƒé•¿çš„æ—¶é—´èŒƒå›´å†…(å‡ ç§’)ï¼Œç®—æ³•è¿›å…¥&lt;code&gt;ProbeRTT&lt;/code&gt;çŠ¶æ€ï¼Œå°†å…¶å‘é€é€Ÿç‡é™ä½ä¸¤å€ï¼Œä»¥å®Œå…¨æ¸…ç©ºé˜Ÿåˆ—å¹¶æµ‹è¯•æ˜¯å¦æœ‰æ›´ä½çš„RTTã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯¥æ–¹æ³•æœ‰è¶£çš„åœ°æ–¹åœ¨äºï¼Œå½“ä¸€ä¸ªå¤§æµåœ¨&lt;code&gt;ProbeRTT&lt;/code&gt;çŠ¶æ€ä¸‹æ˜¾è‘—é™ä½å‘é€é€Ÿç‡æ—¶ï¼Œè¯¥æµå¯¹é˜Ÿåˆ—å»¶è¿Ÿçš„è´¡çŒ®å°†ä¸‹é™ï¼Œè¿™å°†å¯¼è‡´å…¶ä»–æµåŒæ—¶çœ‹åˆ°ä¸€ä¸ªæ–°çš„ã€æ›´ä½çš„RTTï¼Œå¹¶æ›´æ–°å®ƒä»¬çš„ä¼°ç®—ã€‚å› æ­¤ï¼Œå½“é˜Ÿåˆ—å®é™…ä¸Šæ˜¯ç©ºçš„æˆ–æ¥è¿‘ç©ºçš„æ—¶å€™ï¼Œæµè¡¨ç°å‡ºåŒæ­¥RTTä¼°ç®—çš„è¶‹åŠ¿ï¼Œä»è€Œæé«˜äº†ä¼°ç®—çš„å‡†ç¡®æ€§ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;BBRæ­£åœ¨ç§¯æå¼€å‘å¹¶åœ¨å¿«é€Ÿå‘å±•ä¸­ï¼Œæ’°å†™æœ¬æ–‡æ—¶æœ€æ–°ç‰ˆæœ¬æ˜¯2ã€‚å…¶ä¸»è¦ç„¦ç‚¹æ˜¯å…¬å¹³ï¼Œä¾‹å¦‚ï¼Œä¸€äº›æ—©æœŸå®éªŒè¡¨æ˜ï¼ŒCUBICæµåœ¨ä¸BBRæµç«äº‰æ—¶è·å¾—çš„å¸¦å®½å‡å°‘äº†100å€ï¼Œè€Œå…¶ä»–å®éªŒè¡¨æ˜ï¼ŒBBRæµä¹‹é—´å¯èƒ½å­˜åœ¨ä¸å…¬å¹³æ€§ã€‚BBRç‰ˆæœ¬1å¯¹ä¸¢åŒ…ä¸æ•æ„Ÿï¼Œç‰¹åˆ«æ˜¯å½“è·¯å¾„ä¸Šçš„ç¼“å†²é‡ç›¸å¯¹è¾ƒä½æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¾ƒé«˜çš„ä¸¢åŒ…ç‡ã€‚ç”±äºBBRçš„å‡ ç§å®ç°ç°åœ¨æ­£åœ¨ä¸åŒç¯å¢ƒä¸­è¿›è¡Œè¯•éªŒï¼ŒåŒ…æ‹¬åœ¨è°·æ­Œçš„å†…éƒ¨ä¸»å¹²ç½‘ä»¥åŠæ›´å¹¿æ³›çš„äº’è”ç½‘ä¸­ï¼Œäººä»¬æ­£åœ¨æ”¶é›†ç»éªŒæ¥è¿›ä¸€æ­¥å®Œå–„è®¾è®¡ã€‚IETFçš„æ‹¥å¡æ§åˆ¶å·¥ä½œç»„æ­£åœ¨ä¸»æŒå…³äºæ­£åœ¨è¿›è¡Œçš„è®¾è®¡å’Œå®éªŒçš„è®¨è®ºã€‚&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;å»¶ä¼¸é˜…è¯»:&lt;br/&gt;N. Cardwell, Y. Cheng, C. S. Gunn, S. Yeganeh, V. Jacobson. &lt;span&gt;BBR: Congestion-based Congestion Control&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;. Communications of the ACM, Volume 60, Issue 2, February 2017.&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;ä½ å¥½ï¼Œæˆ‘æ˜¯ä¿å‡¡ï¼Œåœ¨Motorolaåšè¿‡ç ”å‘ï¼Œç°åœ¨åœ¨MaveniråšæŠ€æœ¯å·¥ä½œï¼Œå¯¹é€šä¿¡ã€ç½‘ç»œã€åç«¯æ¶æ„ã€äº‘åŸç”Ÿã€DevOpsã€CICDã€åŒºå—é“¾ã€AIç­‰æŠ€æœ¯å§‹ç»ˆä¿æŒç€æµ“åšçš„å…´è¶£ï¼Œå¹³æ—¶å–œæ¬¢é˜…è¯»ã€æ€è€ƒï¼Œç›¸ä¿¡æŒç»­å­¦ä¹ ã€ç»ˆèº«æˆé•¿ï¼Œæ¬¢è¿ä¸€èµ·äº¤æµå­¦ä¹ ã€‚&lt;br/&gt;å¾®ä¿¡å…¬ä¼—å·ï¼šDeepNoMind&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;å‚è€ƒèµ„æ–™&lt;/span&gt;&lt;/h3&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;&lt;span&gt;[1]&lt;/span&gt;&lt;p&gt;TCP Congestion Control: A Systems Approach: &lt;em&gt;https://tcpcc.systemsapproach.org/index.html&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[2]&lt;/span&gt;&lt;p&gt;TCP Vegas: New Technique for Congestion Detection and Avoidance: &lt;em&gt;https://sites.cs.ucsb.edu/~almeroth/classes/F05.276/papers/vegas.pdf&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[3]&lt;/span&gt;&lt;p&gt;Understanding TCP Vegas: A Duality Model: &lt;em&gt;https://dl.acm.org/doi/10.1145/506147.506152&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;[4]&lt;/span&gt;&lt;p&gt;BBR: Congestion-based Congestion Control: &lt;em&gt;https://cacm.acm.org/magazines/2017/2/212428-bbr-congestion-based-congestion-control/fulltext&lt;/em&gt;&lt;/p&gt;&lt;/span&gt;&lt;/section&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>7d1ba59e41230c9029a0b938b16015e7</guid>
<title>JuiceFS åœ¨ Elasticsearch/ClickHouse æ¸©å†·æ•°æ®å­˜å‚¨ä¸­çš„å®è·µ</title>
<link>https://toutiao.io/k/2ufg4sb</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;&lt;blockquote data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p&gt;ğŸ“– &lt;span&gt;æœ¬æ–‡ä½œè€…ï¼šÂ &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é«˜æ˜Œå¥ï¼ŒJuicedata æŠ€æœ¯ä¸“å®¶ï¼Œå‚ä¸å»ºè®¾ JuiceFS å¼€æºç¤¾åŒºçš„ä¸»åŠ›é˜Ÿå‘˜ã€‚åå¹´äº’è”ç½‘è¡Œä¸šä»ä¸šç»å†ï¼Œæ›¾åœ¨çŸ¥ä¹ã€å³åˆ»ã€å°çº¢ä¹¦å¤šä¸ªå›¢é˜Ÿæ‹…ä»»æ¶æ„å¸ˆèŒä½ï¼Œä¸“æ³¨äºåˆ†å¸ƒå¼ç³»ç»Ÿã€å¤§æ•°æ®ã€AI é¢†åŸŸçš„æŠ€æœ¯ç ”ç©¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.52&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/3EcuPIickyyEwbzUrMVnXJaXicEHYVRUz1Xar9X3Tic8ZUNJ3IfuVNP8wUpaKiafwYOY6lfXjlYbcJUJklKI7psbsg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;750&quot;/&gt;&lt;/p&gt;&lt;p&gt;ä¼ä¸šæ•°æ®è¶Šå­˜è¶Šå¤šï¼Œå­˜å‚¨å®¹é‡ä¸æŸ¥è¯¢æ€§èƒ½ã€ä»¥åŠå­˜å‚¨æˆæœ¬ä¹‹é—´çš„çŸ›ç›¾å¯¹äºæŠ€æœ¯å›¢é˜Ÿæ¥è¯´æ˜¯ä¸ªæ™®ééš¾é¢˜ã€‚è¿™ä¸ªéš¾é¢˜åœ¨ Elasticsearch ä¸ ClickHouse è¿™ä¸¤ä¸ªåœºæ™¯ä¸­å°¤ä¸ºçªå‡ºï¼Œä¸ºäº†åº”å¯¹ä¸åŒçƒ­åº¦æ•°æ®å¯¹æŸ¥è¯¢æ€§èƒ½çš„è¦æ±‚ï¼Œè¿™ä¸¤ä¸ªç»„ä»¶åœ¨æ¶æ„è®¾è®¡ä¸Šå°±æœ‰ä¸€äº›å°†æ•°æ®è¿›è¡Œåˆ†å±‚çš„ç­–ç•¥ã€‚&lt;/p&gt;&lt;p&gt;åŒæ—¶ï¼Œåœ¨å­˜å‚¨ä»‹è´¨æ–¹é¢ï¼Œéšç€äº‘è®¡ç®—çš„å‘å±•ï¼Œå¯¹è±¡å­˜å‚¨ä»¥ä½å»‰çš„ä»·æ ¼å’Œå¼¹æ€§ä¼¸ç¼©çš„ç©ºé—´è·å¾—äº†ä¼ä¸šçš„é’çã€‚è¶Šæ¥è¶Šå¤šçš„ä¼ä¸šå°†æ¸©ã€å†·æ•°æ®è¿ç§»è‡³å¯¹è±¡å­˜å‚¨ã€‚&lt;strong&gt;ä½†å¦‚æœå°†ç´¢å¼•ã€åˆ†æç»„ä»¶ç›´æ¥å¯¹æ¥è‡³å¯¹è±¡å­˜å‚¨æ—¶ä¼šå‘ç”ŸæŸ¥è¯¢æ€§èƒ½ã€å…¼å®¹æ€§ç­‰é—®é¢˜&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;è¿™ç¯‡æ–‡ç« å°†ä¸ºå¤§å®¶ä»‹ç»è¿™ä¸¤ä¸ªåœºæ™¯ä¸­å†·çƒ­æ•°æ®åˆ†å±‚çš„åŸºæœ¬åŸç†ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ä½¿ç”¨ JuiceFS æ¥åº”å¯¹åœ¨å¯¹è±¡å­˜å‚¨ä¸Šå­˜åœ¨çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;h2&gt;01- Elasticsearch æ•°æ®åˆ†å±‚ç»“æ„è¯¦è§£&lt;/h2&gt;&lt;p&gt;åœ¨ä»‹ç» ES å¦‚ä½•å®ç°å†·çƒ­æ•°æ®åˆ†å±‚ç­–ç•¥ä¹‹å‰å…ˆæ¥äº†è§£ä¸‰ä¸ªç›¸å…³çš„æ¦‚å¿µï¼šData Streamï¼ŒIndex Lifecycle Management å’Œ Node Roleã€‚&lt;/p&gt;&lt;h3&gt;Data Stream&lt;/h3&gt;&lt;p&gt;Data Streamï¼ˆæ•°æ®æµï¼‰æ˜¯ ES ä¸­ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œå®ƒæœ‰å¦‚ä¸‹ç‰¹å¾ï¼š&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;â€¢Â æµå¼å†™å…¥ï¼šå®ƒæ˜¯ä¸€ä¸ªæµå¼å†™å…¥çš„æ•°æ®é›†ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå›ºå®šå¤§å°çš„é›†åˆï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â ä»…è¿½åŠ å†™ï¼šå®ƒæ˜¯ç”¨è¿½åŠ å†™çš„æ–¹å¼å°†æ•°æ®æ›´æ–°è¿›å»ï¼Œä¸”ä¸éœ€è¦ä¿®æ”¹å†å²æ•°æ®ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â æ—¶é—´æˆ³ï¼šæ¯ä¸€æ¡æ–°å¢çš„æ•°æ®éƒ½ä¼šæœ‰ä¸€ä¸ªæ—¶é—´æˆ³è®°å½•æ˜¯ä»€ä¹ˆæ—¶å€™äº§ç”Ÿçš„ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â å¤šä¸ªç´¢å¼•ï¼šåœ¨ ES é‡Œæœ‰ä¸€ä¸ªç´¢å¼•çš„æ¦‚å¿µï¼Œæ¯ä¸€æ¡æ•°æ®æœ€ç»ˆä¼šè½åˆ°å®ƒå¯¹åº”çš„ä¸€ä¸ªç´¢å¼•ä¸­ï¼Œä½†æ˜¯æ•°æ®æµæ˜¯ä¸€ä¸ªæ›´ä¸Šå±‚ã€æ›´å¤§çš„æ¦‚å¿µï¼Œä¸€ä¸ªæ•°æ®æµèƒŒåå¯èƒ½ä¼šæœ‰å¾ˆå¤šç´¢å¼•ï¼Œè¿™äº›ç´¢å¼•æ˜¯æ ¹æ®ä¸åŒçš„è§„åˆ™æ¥ç”Ÿæˆçš„ã€‚ä¸€ä¸ªæ•°æ®æµè™½ç„¶ç”±å¾ˆå¤šçš„ç´¢å¼•æ¥æ„æˆï¼Œä½†æ˜¯åªæœ‰æœ€æ–°çš„ç´¢å¼•æ‰æ˜¯å¯å†™çš„ï¼Œå†å²ç´¢å¼•æ˜¯åªè¯»çš„ï¼Œä¸€æ—¦å›ºåŒ–å¥½ä¹‹åå°±ä¸èƒ½å†ä¿®æ”¹ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;æ—¥å¿—æ•°æ®å°±æ˜¯ç¬¦åˆæ•°æ®æµç‰¹å¾çš„ä¸€ç±»æ•°æ®ï¼Œå®ƒæ˜¯åªè¿½åŠ å†™ï¼ŒåŒæ—¶ä¹Ÿå¾—æœ‰æ—¶é—´æˆ³ï¼Œç”¨æˆ·ä¼šæ ¹æ®ä¸åŒçš„ç»´åº¦ï¼Œæ¯”å¦‚æŒ‰å¤©æˆ–è€…æŒ‰å…¶ä»–çš„ç»´åº¦æ¥ç”Ÿæˆæ–°çš„ç´¢å¼•ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹å›¾æ˜¯ä¸€ä¸ªæ•°æ®æµå»ºç«‹ç´¢å¼•çš„ç®€å•ç¤ºä¾‹ï¼Œåœ¨ç”¨æ•°æ®æµçš„è¿‡ç¨‹ä¸­ï¼ŒES ä¼šç›´æ¥å†™åˆ°æœ€æ–°çš„ç´¢å¼•ï¼Œè€Œä¸æ˜¯å†å²ç´¢å¼•ï¼Œå†å²ç´¢å¼•ä¸ä¼šè¢«ä¿®æ”¹ã€‚éšç€åç»­æ›´å¤šæ–°çš„æ•°æ®ç”Ÿæˆï¼Œè¿™ä¸ªç´¢å¼•ä¹Ÿä¼šæ²‰æ·€æˆä¸ºä¸€ä¸ªè€çš„ç´¢å¼•ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6554455445544555&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FcGg9Zw5iaoPQsia2xMLN2edNW9Xxz5EteN66eqKZMNYJsOfAKictcuO7g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;505&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸‹å›¾ï¼Œå½“ç”¨æˆ·å¾€ ES é‡Œé¢å»å†™æ•°æ®æ—¶ï¼Œå¤§è‡´åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š&lt;/p&gt;&lt;p&gt;è¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½ä¼šæœ‰ä¸€äº›æ—¶é—´å·®ï¼Œåœ¨æŒä¹…åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå»è§¦å‘æŸ¥è¯¢ï¼Œ æ–°åˆ›å»ºçš„Segment ä¸èƒ½è¢«æœç´¢åˆ°ã€‚ä¸€æ—¦è¿™ä¸ª Segment æŒä¹…åŒ–å®Œæˆä¹‹åï¼Œå°±å¯ä»¥ç«‹å³è¢«ä¸Šå±‚çš„æŸ¥è¯¢å¼•æ“æœç´¢ã€‚&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8092783505154639&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9Fq1E6qC4c50DX9ffKFbrEW0547vrXela1ANAqYicqVlicy6OqCQibVRuhg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;776&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;h3&gt;Index Lifecycle Management&lt;/h3&gt;&lt;p&gt;Index Lifecycle Managementï¼Œç®€ç§° ILMï¼Œå°±æ˜¯ç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚ILM å°†ç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸå®šä¹‰ä¸º 5 ä¸ªé˜¶æ®µï¼š&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;â€¢Â çƒ­æ•°æ®ï¼ˆHotï¼‰ï¼šéœ€è¦é¢‘ç¹æ›´æ–°æˆ–è€…æŸ¥è¯¢çš„æ•°æ®ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â æ¸©æ•°æ®ï¼ˆWarmï¼‰ï¼šä¸å†æ›´æ–°ï¼Œä½†ä»ä¼šè¢«é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â å†·æ•°æ®ï¼ˆColdï¼‰ï¼šä¸å†æ›´æ–°ï¼Œä¸”æŸ¥è¯¢é¢‘ç‡è¾ƒä½çš„æ•°æ®ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â æå†·æ•°æ®ï¼ˆFrozenï¼‰ï¼šä¸å†æ›´æ–°ï¼Œä¸”å‡ ä¹ä¸ä¼šè¢«æŸ¥è¯¢çš„æ•°æ®ã€‚å¯ä»¥æ¯”è¾ƒæ”¾å¿ƒåœ°æŠŠè¿™ç±»æ•°æ®æ”¾åœ¨ä¸€ä¸ªç›¸å¯¹æœ€ä½é€Ÿæœ€ä¾¿å®œçš„å­˜å‚¨ä»‹è´¨ä¸­ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢Â åˆ é™¤æ•°æ®ï¼ˆDelete) : ä¸å†éœ€è¦ç”¨åˆ°ï¼Œå¯ä»¥æ”¾å¿ƒåˆ é™¤çš„æ•°æ®ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;ä¸€ä¸ªç´¢å¼•é‡Œçš„æ•°æ®ï¼Œä¸ç®¡æ˜¯ index è¿˜æ˜¯ segmentï¼Œéƒ½ä¼šç»å†è¿™äº›é˜¶æ®µï¼Œè¿™ä¸ªåˆ†ç±»çš„è§„åˆ™å¾ˆå¥½åœ°å¸®åŠ©ç”¨æˆ·å»ç®¡ç† ES é‡Œçš„æ•°æ®ï¼Œç”¨æˆ·å¯ä»¥è‡ªå·±å®šä¹‰ä¸åŒé˜¶æ®µçš„è§„åˆ™ã€‚&lt;/p&gt;&lt;h3&gt;Node Role&lt;/h3&gt;&lt;p&gt;åœ¨ ES ä¸­ï¼Œæ¯ä¸€ä¸ªéƒ¨ç½²èŠ‚ç‚¹éƒ½ä¼šæœ‰ä¸€ä¸ª Node Roleï¼Œä¹Ÿå°±æ˜¯èŠ‚ç‚¹è§’è‰²ã€‚æ¯ä¸€ä¸ª ES èŠ‚ç‚¹ä¼šåˆ†é…ä¸åŒçš„è§’è‰²ï¼Œæ¯”å¦‚ masterã€dataã€ingest ç­‰ã€‚ç”¨æˆ·å¯ä»¥ç»“åˆèŠ‚ç‚¹è§’è‰²ï¼Œä»¥åŠä¸Šæ–‡æåˆ°çš„ä¸åŒç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µæ¥ç»„åˆè¿›è¡Œæ•°æ®ç®¡ç†ã€‚&lt;/p&gt;&lt;p&gt;æ•°æ®èŠ‚ç‚¹ä¼šæœ‰ä¸åŒçš„é˜¶æ®µï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå­˜å‚¨çƒ­æ•°æ®çš„èŠ‚ç‚¹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªå­˜å‚¨æ¸©æ•°æ®ã€å†·æ•°æ®ï¼Œç”šè‡³æå†·æ•°æ®çš„èŠ‚ç‚¹ã€‚éœ€è¦æ ¹æ®èŠ‚ç‚¹çš„åŠŸèƒ½å»ç»™ä»–åˆ†é…ä¸åŒçš„è§’è‰²ï¼ŒåŒæ—¶ä¼šç»™ä¸åŒçš„è§’è‰²çš„èŠ‚ç‚¹é…ç½®ä¸åŒçš„ç¡¬ä»¶ã€‚&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ï¼Œå¯¹äºçƒ­æ•°æ®èŠ‚ç‚¹éœ€è¦é…ç½®é«˜æ€§èƒ½çš„ CPU æˆ–è€…ç£ç›˜ï¼Œå¯¹äºæ¸©å†·æ•°æ®çš„èŠ‚ç‚¹ï¼ŒåŸºæœ¬ä¸Šè®¤ä¸ºè¿™äº›æ•°æ®è¢«æŸ¥è¯¢çš„é¢‘ç‡è¾ƒä½ï¼Œè¿™ä¸ªæ—¶å€™å…¶å®å¯¹äºæŸäº›è®¡ç®—èµ„æºçš„ç¡¬ä»¶è¦æ±‚å°±æ²¡æœ‰é‚£ä¹ˆé«˜äº†ã€‚&lt;/p&gt;&lt;p&gt;èŠ‚ç‚¹è§’è‰²æ˜¯æ ¹æ®ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒé˜¶æ®µæ¥å®šä¹‰çš„ï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ¯ä¸€ä¸ª ES èŠ‚ç‚¹ï¼Œå¯ä»¥æœ‰å¤šç§è§’è‰²ï¼Œè¿™äº›è§’è‰²å¹¶ä¸æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚ä¸‹é¢æœ‰ä¸ªç¤ºä¾‹ï¼Œåœ¨ ES çš„ YAML æ–‡ä»¶é‡Œé¢é…ç½®çš„æ—¶å€™ï¼Œnode.roles å°±æ˜¯èŠ‚ç‚¹è§’è‰²çš„é…ç½®ï¼Œå¯ä»¥é’ˆå¯¹è¿™ä¸ªèŠ‚ç‚¹åº”è¯¥æœ‰çš„è§’è‰²ç»™å®ƒé…ç½®å¤šç§è§’è‰²ã€‚&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;node.roles:Â [&lt;span&gt;&quot;data_hot&quot;&lt;/span&gt;,Â &lt;span&gt;&quot;data_content&quot;&lt;/span&gt;]&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;h3&gt;ç”Ÿå‘½å‘¨æœŸç­–ç•¥&lt;/h3&gt;&lt;p&gt;åœ¨äº†è§£å®Œ Data Stream ã€Index Lifecycle Managementã€Node Role è¿™äº›æ¦‚å¿µä»¥åï¼Œå°±å¯ä»¥ä¸ºæ•°æ®åˆ›å»ºä¸€äº›ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸç­–ç•¥ï¼ˆLifecycle Policyï¼‰ã€‚&lt;/p&gt;&lt;p&gt;æ ¹æ®ç”Ÿå‘½å‘¨æœŸç­–ç•¥ä¸­å®šä¹‰çš„ä¸åŒç»´åº¦çš„ç´¢å¼•ç‰¹å¾ï¼Œå¦‚ç´¢å¼•çš„å¤§å°ã€ç´¢å¼•é‡Œçš„æ–‡æ¡£çš„æ•°é‡ã€ç´¢å¼•åˆ›å»ºçš„æ—¶é—´ï¼ŒES å¯ä»¥è‡ªåŠ¨åœ°å¸®ç”¨æˆ·æŠŠæŸä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µçš„æ•°æ®æ»šåŠ¨åˆ°å¦ä¸€ä¸ªé˜¶æ®µï¼Œåœ¨ ES ä¸­çš„æœ¯è¯­æ˜¯ rolloverã€‚&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ï¼Œç”¨æˆ·å¯ä»¥åˆ¶å®šåŸºäºç´¢å¼•å¤§å°ç»´åº¦çš„ç‰¹å¾ï¼ŒæŠŠçƒ­æ•°æ®æ»šåŠ¨åˆ°æ¸©æ•°æ®ï¼Œæˆ–è€…æ ¹æ®ä¸€äº›å…¶å®ƒè§„åˆ™ï¼Œå†æŠŠæ¸©æ•°æ®æ»šåŠ¨åˆ°å†·æ•°æ®ã€‚è¿™æ ·ï¼Œç´¢å¼•åœ¨ä¸åŒç”Ÿå‘½å‘¨æœŸçš„é˜¶æ®µä¹‹é—´å»æ»šåŠ¨çš„æ—¶å€™ï¼Œç›¸åº”çš„å®ƒç´¢å¼•çš„æ•°æ®ä¹Ÿä¼šå»åšè¿ç§»å’Œæ»šåŠ¨ã€‚ES å¯ä»¥è‡ªåŠ¨å®Œæˆè¿™äº›å·¥ä½œï¼Œä½†æ˜¯ç”Ÿå‘½å‘¨æœŸç­–ç•¥åˆ™éœ€è¦ç”¨æˆ·è‡ªå·±æ¥å®šä¹‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹é¢çš„æˆªå›¾ï¼Œæ˜¯ Kibana çš„ç®¡ç†ç•Œé¢ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å›¾å½¢åŒ–çš„æ–¹å¼å»é…ç½®ç”Ÿå‘½å‘¨æœŸç­–ç•¥ã€‚å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ªé˜¶æ®µï¼Œä»ä¸Šåˆ°ä¸‹åˆ†åˆ«æ˜¯çƒ­æ•°æ®ã€æ¸©æ•°æ®ä»¥åŠå†·æ•°æ®ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.98125&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FnHD8wJ4xcoibicmxZjRMiaZPW7JkiaWgTMicCm956icyIqJpKuATIbP4TXTA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;p&gt;å±•å¼€å…¶ä¸­çƒ­æ•°æ®é˜¶æ®µçš„é«˜çº§è®¾ç½®ï¼Œå¯ä»¥çœ‹åˆ°æ›´è¯¦ç»†ï¼Œä¸Šæ–‡æåˆ°çš„åŸºäºä¸åŒç»´åº¦ç‰¹å¾çš„ç­–ç•¥é…ç½®ï¼Œå¦‚åœ¨ä¸‹å›¾å³è¾¹çœ‹åˆ°çš„è¿™ä¸‰ä¸ªé€‰é¡¹ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.4625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FO37qALE2hGLYUyQnTWcrc0VbzDTXVo8TIuOwe8GU7DWSNORhh3ic7aw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;1. ç´¢å¼•çš„å¤§å°ï¼Œç¤ºæ„å›¾ä¸Šçš„ä¾‹å­æ˜¯ 50GBï¼Œå½“ç´¢å¼•çš„å¤§å°è¶…è¿‡ 50GB çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠå®ƒä»çƒ­æ•°æ®é˜¶æ®µæ»šåŠ¨åˆ°æ¸©æ•°æ®é˜¶æ®µã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2. æœ€å¤§çš„æ–‡æ¡£æ•°ï¼ŒES é‡Œç´¢å¼•çš„å•å…ƒæ˜¯æ–‡æ¡£ï¼Œç”¨æˆ·æ•°æ®æ˜¯ä»¥æ–‡æ¡£çš„å½¢å¼å†™å…¥ ES ä¸­çš„ï¼Œæ‰€ä»¥æ–‡æ¡£æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯ä»¥è¡¡é‡çš„æŒ‡æ ‡ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;3. æœ€å¤§ç´¢å¼•åˆ›å»ºæ—¶é—´ï¼Œè¿™é‡Œçš„ç¤ºä¾‹æ˜¯ 30 å¤©ï¼Œå‡è®¾æŸä¸ªç´¢å¼•å·²ç»åˆ›å»ºäº† 30 å¤©äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè§¦å‘åˆšåˆšæåˆ°çš„ä»çƒ­æ•°æ®é˜¶æ®µåˆ°æ¸©æ•°æ®çš„æ»šåŠ¨ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;h2&gt;02- ClickHouse æ•°æ®åˆ†å±‚æ¶æ„è¯¦è§£&lt;/h2&gt;&lt;p&gt;ä¸‹å›¾æ˜¯ä¸€ç»„ä»å¤§åˆ°å°çš„ä¿„ç½—æ–¯å¥—å¨ƒï¼Œå®ƒéå¸¸å½¢è±¡åœ°å±•ç°äº† ClickHouse çš„æ•°æ®ç®¡ç†æ¨¡å¼ï¼Œ MergeTree å¼•æ“ã€‚&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;â€¢ Table: åœ¨å›¾ç‰‡çš„æœ€å³è¾¹æ˜¯ä¸€ä¸ªæœ€å¤§çš„æ¦‚å¿µï¼Œç”¨æˆ·æœ€å¼€å§‹è¦åˆ›å»ºæˆ–è€…èƒ½å¤Ÿç›´æ¥æ¥è§¦åˆ°çš„å°±æ˜¯ Tableï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢ Partitionï¼šæ˜¯ä¸€ä¸ªæ›´å°çš„ç»´åº¦æˆ–è€…æ›´å°çš„ç²’åº¦ã€‚åœ¨ ClickHouse é‡Œï¼Œæ•°æ®åˆ†æˆ Partition æ¥å­˜å‚¨ï¼Œæ¯ä¸ª Partition ä¼šæœ‰ä¸€ä¸ªæ ‡è¯†ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢ Partï¼šåœ¨æ¯ä¸ª Partition ä¸­ï¼Œåˆä¼šå†è¿›ä¸€æ­¥åœ°ç»†åˆ†ä¸ºå¤šä¸ª Partã€‚å¦‚æœæŸ¥çœ‹ ClickHouse ç£ç›˜ä¸Šå­˜å‚¨çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥è®¤ä¸ºæ¯ä¸€ä¸ªå­ç›®å½•å°±æ˜¯ä¸€ä¸ª Partï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢ Columnï¼šåœ¨ Part é‡Œä¼šçœ‹åˆ°ä¸€äº›æ›´å°ç²’åº¦çš„æ•°æ®ï¼Œå³ Columnã€‚ClickHouse çš„å¼•æ“ä½¿ç”¨çš„æ˜¯åˆ—å¼å­˜å‚¨ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯æŒ‰ç…§åˆ—å­˜çš„æ–¹å¼æ¥ç»„ç»‡ã€‚åœ¨ Part ç›®å½•é‡Œä¼šçœ‹åˆ°å¾ˆå¤šåˆ—ï¼Œæ¯”å¦‚ Table å¯èƒ½æœ‰100 åˆ—ï¼Œå°±ä¼šæœ‰ 100 ä¸ª Column æ–‡ä»¶ï¼›&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;â€¢ Blockï¼šæ¯ä¸ª Column æ–‡ä»¶é‡Œæ˜¯æŒ‰ç…§ Block çš„ç²’åº¦æ¥ç»„ç»‡ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5366430260047281&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FQhlCicDoDpZlmUaMDkiaSYibicGNa9JxrGlJQbMlJD1cOHNBNeaUvzQ7rA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;846&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;p&gt;ä¸‹é¢è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œåœ¨ table ç›®å½•ä¸‹å¯ä»¥çœ‹åˆ°æœ‰ 4 ä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•å°±æ˜¯ä¸Šæ–‡æåˆ°çš„ Partã€‚&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;$Â lsÂ -lÂ /var/lib/clickhouse/data/&amp;lt;database&amp;gt;/&amp;lt;table&amp;gt;&lt;br/&gt;drwxr-xr-xÂ Â 2Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â 64BÂ AugÂ Â 8Â 13:46Â 202208_1_3_0&lt;br/&gt;drwxr-xr-xÂ Â 2Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â 64BÂ AugÂ Â 8Â 13:46Â 202208_4_6_1&lt;br/&gt;drwxr-xr-xÂ Â 2Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â 64BÂ SepÂ Â 8Â 13:46Â 202209_1_1_0&lt;br/&gt;drwxr-xr-xÂ Â 2Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â 64BÂ SepÂ Â 8Â 13:46Â 202209_4_4_&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;å›¾ç¤ºçš„æœ€å³è¾¹è¿™ä¸€åˆ—ï¼Œæ¯ä¸ªå­ç›®å½•çš„åå­—å‰é¢å¯èƒ½æ˜¯ä¸€ä¸ªæ—¶é—´ï¼Œæ¯”å¦‚ 202208 ç±»ä¼¼è¿™æ ·çš„å‰ç¼€ï¼Œ202208 å…¶å®å°±æ˜¯ Partition åã€‚Partition åå­—æ˜¯ç”¨æˆ·è‡ªå·±æ¥å®šä¹‰çš„ï¼Œä½†æ˜¯æŒ‰ç…§çº¦å®šä¿—æˆæˆ–è€…ä¸€äº›å®è·µä¹ æƒ¯ï¼Œé€šå¸¸ä¼šä½¿ç”¨æ—¶é—´æ¥å‘½åã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;æ¯”å¦‚ï¼Œ 202208 è¿™ä¸ª Partitionï¼Œå®ƒä¼šæœ‰ä¸¤ä¸ªå­ç›®å½•ï¼Œå­ç›®å½•å°±æ˜¯ Partï¼Œä¸€ä¸ª Partition é€šå¸¸ä¼šç”±å¤šä¸ª Part æ¥æ„æˆã€‚ç”¨æˆ·åœ¨å¾€ ClickHoue å†™å…¥æ•°æ®æ—¶ï¼Œä¼šå…ˆå†™åˆ°å†…å­˜é‡Œï¼Œå†æ ¹æ®å†…å­˜é‡Œçš„æ•°æ®ç»“æ„ï¼ŒæŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šã€‚åŒä¸€ä¸ªPartition é‡Œé¢çš„æ•°æ®å¦‚æœæ¯”è¾ƒå¤§çš„è¯ï¼Œåœ¨ç£ç›˜ä¸Šå°±ä¼šå˜æˆå¾ˆå¤š partã€‚ClickHouse å®˜æ–¹å»ºè®®ä¸è¦åœ¨ä¸€ä¸ª Table ä¸‹åˆ›å»ºå¤ªå¤š Partï¼Œå®ƒä¼šå®šæœŸæˆ–è€…ä¸å®šæœŸåœ°å¯¹ Part è¿›è¡Œåˆå¹¶ï¼Œå‡å°‘æ€»çš„ Part æ•°é‡ã€‚Merge çš„æ¦‚å¿µå°±æ˜¯åˆå¹¶ Partï¼Œè¿™ä¹Ÿæ˜¯ MergeTree è¿™ä¸ªå¼•æ“çš„åå­—æ¥æºä¹‹ä¸€ã€‚&lt;/p&gt;&lt;p&gt;å†é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥äº†è§£ Partã€‚Part é‡Œä¼šæœ‰å¾ˆå¤šå°æ–‡ä»¶ï¼Œæœ‰ä¸€äº›æ˜¯å…ƒä¿¡æ¯ï¼Œæ¯”å¦‚ç´¢å¼•ä¿¡æ¯ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€ŸæŸ¥æ‰¾æ•°æ®ã€‚&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;$Â lsÂ -lÂ /var/lib/clickhouse/data/&amp;lt;database&amp;gt;/&amp;lt;table&amp;gt;/202208_1_3_0&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â ColumnA.bin&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â ColumnA.mrk&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â ColumnB.bin&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â ColumnB.mrk&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â checksums.txt&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â columns.txt&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â count.txt&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â minmax_ColumnC.idx&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â partition.dat&lt;br/&gt;-rw-r--r--Â Â 1Â &lt;span&gt;test&lt;/span&gt;Â Â &lt;span&gt;test&lt;/span&gt;Â Â ??Â AugÂ Â 8Â 14:06Â primary.id&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;åœ¨ç¤ºä¾‹çš„å³ä¾§ï¼Œä»¥ Column ä½œä¸ºå‰ç¼€çš„è¿™äº›æ–‡ä»¶æ˜¯å®é™…çš„æ•°æ®æ–‡ä»¶ï¼Œç›¸æ¯”å…ƒä¿¡æ¯é€šå¸¸ä¼šæ¯”è¾ƒå¤§ã€‚è¿™ä¸ªç¤ºä¾‹ä¸­åªæœ‰ Aã€B ä¸¤åˆ—ï¼Œå®é™…çš„è¡¨é‡Œå¯èƒ½æœ‰å¾ˆå¤šåˆ—ã€‚æ‰€æœ‰è¿™äº›æ–‡ä»¶ï¼ŒåŒ…æ‹¬å…ƒä¿¡æ¯ã€ç´¢å¼•ä¿¡æ¯ï¼Œéƒ½ä¼šå…±åŒå¸®åŠ©ç”¨æˆ·å¿«é€Ÿåœ°åœ¨ä¸åŒæ–‡ä»¶ä¹‹é—´å»åšè·³è½¬æˆ–è€…æŸ¥æ‰¾ã€‚&lt;/p&gt;&lt;h3&gt;ClickHouse å­˜å‚¨ç­–ç•¥&lt;/h3&gt;&lt;p&gt;å¦‚æœè¦åœ¨ ClickHouse é‡Œåšå†·çƒ­æ•°æ®åˆ†å±‚ï¼Œä¼šç”¨åˆ°ç±»ä¼¼äº ES ä¸­æåˆ°çš„ç”Ÿå‘½å‘¨æœŸç­–ç•¥ï¼Œåœ¨ ClickHouse é‡Œç§°ä¸ºå­˜å‚¨ç­–ç•¥ï¼ˆStorage Policyï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ä¸ ES ç¨æœ‰ä¸åŒï¼ŒClickHouse å®˜æ–¹å¹¶æ²¡æœ‰å°†æ•°æ®åˆ’åˆ†ä¸åŒçš„é˜¶æ®µï¼Œæ¯”å¦‚çƒ­æ•°æ®ã€æ¸©æ•°æ®ã€å†·æ•°æ®è¿™äº›ä¸åŒçš„é˜¶æ®µï¼ŒClickHouse æä¾›äº†ä¸€äº›è§„åˆ™å’Œé…ç½®æ–¹æ³•ï¼Œéœ€è¦ç”¨æˆ·è‡ªå·±æ¥åˆ¶å®šåˆ†å±‚ç­–ç•¥&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;p&gt;æ¯ä¸ª ClickHouse èŠ‚ç‚¹æ”¯æŒåŒæ—¶é…ç½®å¤šå—ç£ç›˜ï¼Œå­˜å‚¨ä»‹è´¨å¯ä»¥æ˜¯å¤šç§å¤šæ ·çš„ã€‚æ¯”å¦‚ï¼Œä¸€èˆ¬ç”¨æˆ·ä¸ºäº†æ€§èƒ½ä¼šç»™ ClickHouse èŠ‚ç‚¹é…ç½® SSD ç›˜ï¼›å¯¹äºä¸€äº›æ¸©å†·æ•°æ®ï¼Œç”¨æˆ·å¯ä»¥æŠŠæ•°æ®å­˜å‚¨åœ¨æˆæœ¬æ›´ä½çš„ä»‹è´¨ï¼Œå¦‚æœºæ¢°ç›˜ã€‚ClickHouse çš„ç”¨æˆ·å¯¹åº•å±‚å­˜å‚¨ä»‹è´¨æ˜¯æ— æ„ŸçŸ¥çš„ã€‚&lt;/p&gt;&lt;p&gt;ä¸ ES ç›¸ä¼¼ï¼ŒClickHouse ç”¨æˆ·éœ€è¦æ ¹æ®æ•°æ®ä¸åŒçš„ç»´åº¦ç‰¹å¾å»åˆ¶å®šå­˜å‚¨ç­–ç•¥ï¼Œæ¯”å¦‚æ¯ä¸ª part å­ç›®å½•çš„å¤§å°ã€æ•´ä¸ªç£ç›˜çš„å‰©ä½™ç©ºé—´æ¯”ä¾‹ç­‰ï¼Œå½“æ»¡è¶³æŸä¸ªç»´åº¦ç‰¹å¾è®¾å®šçš„æ¡ä»¶æ—¶å°±ä¼šè§¦å‘å­˜å‚¨ç­–ç•¥çš„æ‰§è¡Œã€‚è¿™ä¸ªç­–ç•¥ä¼šå°†æŸä¸€ä¸ª part ä»ä¸€å—ç›˜è¿ç§»åˆ°å¦å¤–ä¸€å—ç›˜ã€‚åœ¨ ClickHouse ä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹é…ç½®çš„å¤šå—ç›˜æ˜¯æœ‰ä¼˜å…ˆçº§çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹æ•°æ®ä¼šä¼˜å…ˆè½åœ¨æœ€é«˜ä¼˜å…ˆçº§çš„ç›˜ä¸Šã€‚è¿™æ ·å®ç°äº† Part ä»ä¸€ä¸ªå­˜å‚¨ä»‹è´¨è½¬ç§»åˆ°å¦å¤–ä¸€ä¸ªå­˜å‚¨ä»‹è´¨ä¸Šã€‚&lt;/p&gt;&lt;p&gt;é€šè¿‡ ClickHouse çš„ä¸€äº› SQL å‘½ä»¤ï¼Œå¦‚ MOVE PARTITION/PART å‘½ä»¤å¯ä»¥æ‰‹åŠ¨è§¦å‘æ•°æ®è¿ç§»ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡è¿™äº›å‘½ä»¤åšä¸€äº›åŠŸèƒ½æ€§çš„éªŒè¯ã€‚å…¶æ¬¡æœ‰æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¹Ÿå¸Œæœ›èƒ½å¤Ÿé€šè¿‡æ‰‹åŠ¨çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯è‡ªåŠ¨è½¬ç§»çš„æ–¹å¼æ¥æ˜¾å¼æŠŠ part ä»å½“å‰çš„å­˜å‚¨ä»‹è´¨ä¸Šè½¬ç§»åˆ°å¦å¤–ä¸€ä¸ªå­˜å‚¨ä»‹è´¨ä¸Šã€‚&lt;/p&gt;&lt;p&gt;ClickHouse è¿˜æ”¯æŒåŸºäºæ—¶é—´çš„è¿ç§»ç­–ç•¥ï¼Œè¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹äºå­˜å‚¨ç­–ç•¥çš„æ¦‚å¿µã€‚æ•°æ®å†™å…¥åï¼ŒClickHouse ä¼šæŒ‰ç…§æ¯ä¸ªè¡¨çš„ TTL å±æ€§è®¾ç½®çš„æ—¶é—´æ¥è§¦å‘ç£ç›˜ä¸Šæ•°æ®çš„è¿ç§»ã€‚æ¯”å¦‚è®¾ç½® TTL ä¸º 7 å¤©ï¼ŒClickHouse å°±ä¼šæŠŠè¡¨ä¸­è¶…è¿‡ 7 å¤©çš„æ•°æ®ä»å½“å‰çš„ç£ç›˜ï¼ˆå¦‚é»˜è®¤çš„ SSDï¼‰å†å†™åˆ°å¦å¤–ä¸€ä¸ªæ›´ä½ä¼˜å…ˆçº§çš„ç£ç›˜ä¸Šï¼ˆå¦‚ JuiceFSï¼‰ã€‚&lt;/p&gt;&lt;h2&gt;03- æ¸©å†·æ•°æ®å­˜å‚¨ï¼šä¸ºä»€ä¹ˆä½¿ç”¨å¯¹è±¡å­˜å‚¨+ JuiceFS ï¼Ÿ&lt;/h2&gt;&lt;p&gt;ä¼ä¸šæŠŠæ¸©ã€å†·æ•°æ®å­˜æ”¾åˆ°äº‘ä¸Šåï¼Œå­˜å‚¨æˆæœ¬ç›¸è¾ƒäºä¼ ç»Ÿçš„ SSD æ¶æ„å¤§ä¸ºä¸‹é™ã€‚&lt;strong&gt;ä¼ä¸šè¿˜äº«å—åˆ°äº†äº‘ä¸Šçš„å¼¹æ€§ä¼¸ç¼©ç©ºé—´ï¼›ä¸ç”¨ä¸ºæ•°æ®å­˜å‚¨å»åšä»»ä½•è¿ç»´æ“ä½œï¼Œæ¯”å¦‚æ‰©ç¼©å®¹ï¼Œæˆ–è€…ä¸€äº›æ•°æ®æ¸…ç†ç±»çš„å·¥ä½œ&lt;/strong&gt;ã€‚æ¸©å†·æ•°æ®æ‰€éœ€çš„å­˜å‚¨å®¹é‡æ¯”çƒ­æ•°æ®å¤§å¾ˆå¤šï¼Œå°¤å…¶æ˜¯éšç€æ—¶é—´æ¨ç§»ï¼Œä¼šäº§ç”Ÿå¤§é‡éœ€è¦é•¿æœŸä¿å­˜çš„æ•°æ®ï¼Œå¦‚æœè¿™äº›æ•°æ®éƒ½å­˜å‚¨åœ¨æœ¬åœ°ï¼Œç›¸åº”çš„è¿ç»´å·¥ä½œå°†ä¸å ªé‡è´Ÿã€‚&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;ä½†å¦‚æœåœ¨å¯¹è±¡å­˜å‚¨ä¸Šä½¿ç”¨ Elasticsearchã€ClickHouse è¿™ç±»æ•°æ®åº”ç”¨ç»„ä»¶ï¼Œä¼šå­˜åœ¨å†™å…¥æ€§èƒ½å·®ã€å…¼å®¹æ€§ç­‰é—®é¢˜ã€‚å¸Œæœ›å…¼é¡¾æŸ¥è¯¢æ€§èƒ½çš„ä¼ä¸šï¼Œå¼€å§‹åœ¨äº‘ä¸Šå¯»æ‰¾è§£å†³æ–¹æ¡ˆã€‚åœ¨è¿™æ ·çš„èƒŒæ™¯ä¹‹ä¸‹ï¼ŒJuiceFS è¢«è¶Šæ¥è¶Šå¤šåœ°åº”ç”¨äºæ•°æ®åˆ†å±‚çš„æ¶æ„ä¹‹ä¸­ã€‚&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;é€šè¿‡ä¸‹é¢ ClickHouse å†™å…¥æ€§èƒ½æµ‹è¯•å¯ä»¥ç›´è§‚äº†è§£åˆ°å†™å…¥SSDã€JuiceFS ä»¥åŠå¯¹è±¡å­˜å‚¨çš„æ€§èƒ½å·®å¼‚ã€‚&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.5146666666666667&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FDMYsgm6kvic7c7eUxUUnibZSzGbYXI5KULTibiaqIV7edoNtJ4OQtiaH9LA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;750&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;JuiceFS çš„å†™å…¥ååé‡è¿œå¤§äºç›´æ¥å¯¹æ¥å¯¹è±¡å­˜å‚¨ï¼Œæ¥è¿‘ SSD&lt;/strong&gt;ã€‚å½“ç”¨æˆ·æŠŠçƒ­æ•°æ®è½¬ç§»åˆ°æ¸©æš–æ•°æ®è¿™ä¸€å±‚æ—¶ï¼Œå¯¹äºå†™å…¥æ€§èƒ½ä¹Ÿæœ‰ä¸€å®šè¦æ±‚ã€‚åœ¨è¿ç§»çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœåº•å±‚å­˜å‚¨ä»‹è´¨çš„å†™å…¥æ€§èƒ½å·®ï¼Œæ•´ä¸ªè¿ç§»çš„æµç¨‹ä¹Ÿä¼šæ‹–å¾—å¾ˆé•¿ï¼Œå¯¹äºæ•´ä¸ª pipeline æˆ–æ•°æ®ç®¡ç†ä¹Ÿä¼šå¸¦æ¥ä¸€äº›æŒ‘æˆ˜ã€‚&lt;/p&gt;&lt;p&gt;ä¸‹å›¾çš„ ClickHouse æŸ¥è¯¢æ€§èƒ½æµ‹è¯•ä½¿ç”¨çœŸå®ä¸šåŠ¡ä¸­çš„æ•°æ®ï¼Œå¹¶é€‰å–å‡ ä¸ªå…¸å‹çš„æŸ¥è¯¢åœºæ™¯è¿›è¡Œæµ‹è¯•ã€‚å…¶ä¸­ q1-q4 æ˜¯æ‰«æå…¨è¡¨çš„æŸ¥è¯¢ï¼Œq5-q7 æ˜¯å‘½ä¸­ä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢ã€‚æµ‹è¯•ç»“æœå¦‚ä¸‹å›¾ï¼š&lt;/p&gt;&lt;figure&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.616875&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FibENmDgfWKkDJudQDpEybPFnRXf00FttEddDxzX8qXBlrg09lUClVwg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1600&quot; title=&quot;null&quot;/&gt;&lt;/figure&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.6171875&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9FicCN8fJsJOBDsYysa8j6k2nOjD6Q0rpL23lT0dbdLSWFicZdUIzAjH8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;JuiceFS ä¸ SSD ç›˜çš„æŸ¥è¯¢æ€§èƒ½åŸºæœ¬ç›¸å½“ï¼Œå¹³å‡å·®å¼‚åœ¨ 6% å·¦å³ï¼Œä½†æ˜¯å¯¹è±¡å­˜å‚¨ç›¸æ¯” SSD ç›˜æœ‰ 1.4 è‡³ 30 å€çš„æ€§èƒ½ä¸‹é™&lt;/strong&gt;ã€‚å¾—ç›Šäº JuiceFS é«˜æ€§èƒ½çš„å…ƒæ•°æ®æ“ä½œä»¥åŠæœ¬åœ°ç¼“å­˜ç‰¹æ€§ï¼Œå¯ä»¥è‡ªåŠ¨å°†æŸ¥è¯¢è¯·æ±‚éœ€è¦çš„çƒ­æ•°æ®ç¼“å­˜åœ¨ ClickHouse èŠ‚ç‚¹æœ¬åœ°ï¼Œå¤§å¹…æå‡äº† ClickHouse çš„æŸ¥è¯¢æ€§èƒ½ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä»¥ä¸Šæµ‹è¯•ä¸­å¯¹è±¡å­˜å‚¨æ˜¯é€šè¿‡ ClickHouse çš„ S3 ç£ç›˜ç±»å‹è¿›è¡Œè®¿é—®ï¼Œè¿™ç§æ–¹å¼åªæœ‰æ•°æ®æ˜¯å­˜å‚¨åœ¨å¯¹è±¡å­˜å‚¨ä¸Šï¼Œå…ƒæ•°æ®è¿˜æ˜¯åœ¨æœ¬åœ°ç£ç›˜ã€‚å¦‚æœé€šè¿‡ç±»ä¼¼ S3FS çš„æ–¹å¼æŠŠå¯¹è±¡å­˜å‚¨æŒ‚è½½åˆ°æœ¬åœ°ï¼Œæ€§èƒ½ä¼šæœ‰è¿›ä¸€æ­¥çš„ä¸‹é™ã€‚&lt;/p&gt;&lt;p&gt;å¦å¤–å€¼å¾—ä¸€æçš„æ˜¯ JuiceFS æ˜¯ä¸€ä¸ªå®Œå…¨å…¼å®¹ POSIX çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒèƒ½å¤Ÿä¸ä¸Šå±‚åº”ç”¨ï¼ˆå¦‚ Elasticsearchã€ClickHouseï¼‰æœ‰å¾ˆå¥½çš„å…¼å®¹ã€‚ç”¨æˆ·å¯¹åº•å±‚å­˜å‚¨æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæˆ–è€…æ˜¯æœ¬åœ°ç£ç›˜æ˜¯æ²¡æœ‰æ„ŸçŸ¥çš„ã€‚å¦‚æœç›´æ¥ä½¿ç”¨å¯¹è±¡å­˜å‚¨ï¼Œä¸èƒ½å¾ˆå¥½åœ°å®ç°ä¸ä¸Šå±‚åº”ç”¨çš„å…¼å®¹ã€‚&lt;/p&gt;&lt;h2&gt;04- å®æ“ï¼šES + JuiceFS&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Step 1ï¼šå‡†å¤‡å¤šç§ç±»å‹èŠ‚ç‚¹ï¼Œåˆ†é…ä¸åŒè§’è‰²ã€‚&lt;/strong&gt;æ¯ä¸€ä¸ª ES èŠ‚ç‚¹å¯ä»¥åˆ†é…ä¸åŒçš„è§’è‰²ï¼Œæ¯”å¦‚å­˜çƒ­æ•°æ®ã€æ¸©æ•°æ®ã€å†·æ•°æ®ç­‰ï¼Œç”¨æˆ·éœ€è¦å‡†å¤‡ä¸åŒæœºå‹çš„èŠ‚ç‚¹æ¥åŒ¹é…ä¸åŒè§’è‰²çš„éœ€æ±‚ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 2ï¼šæŒ‚è½½ JuiceFS æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/strong&gt;ä¸€èˆ¬ç”¨æˆ·å°† JuiceFS ç”¨äºæ¸©ã€å†·æ•°æ®çš„å­˜å‚¨ï¼Œç”¨æˆ·éœ€è¦åœ¨ ES æ¸©æ•°æ®èŠ‚ç‚¹æˆ–å†·æ•°æ®çš„èŠ‚ç‚¹ä¸ŠæŠŠ JuiceFS æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°æœ¬åœ°ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç¬¦å·é“¾æ¥æˆ–å…¶å®ƒæ–¹å¼æŠŠæŒ‚è½½ç‚¹é…ç½®åˆ° ES ä¸­å»ï¼Œè®© ES è®¤ä¸ºå®ƒçš„æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ç›®å½•é‡Œï¼Œä½†è¿™ä¸ªç›®å½•èƒŒåå…¶å®æ˜¯ä¸€ä¸ª JuiceFS æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 3ï¼šåˆ›å»ºç”Ÿå‘½å‘¨æœŸç­–ç•¥ã€‚&lt;/strong&gt;è¿™ä¸ªéœ€è¦æ¯ä¸ªç”¨æˆ·è‡ªå·±å»å®šåˆ¶ï¼Œç”¨æˆ·æ—¢å¯ä»¥é€šè¿‡ ES API å»åˆ›å»ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Kibana å»åˆ›å»ºï¼ŒKibana æä¾›äº†ä¸€äº›ç›¸å¯¹ä¾¿æ·çš„æ–¹å¼å»åˆ›å»ºå’Œç®¡ç†ç”Ÿå‘½å‘¨æœŸç­–ç•¥ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 4ï¼šä¸ºç´¢å¼•è®¾ç½®ç”Ÿå‘½å‘¨æœŸç­–ç•¥ã€‚&lt;/strong&gt;åˆ›å»ºå®Œç”Ÿå‘½å‘¨æœŸç­–ç•¥ä¹‹åï¼Œç”¨æˆ·éœ€è¦æŠŠè¿™ä¸ªç­–ç•¥åº”ç”¨åˆ°ç´¢å¼•ä¸Šï¼Œä¹Ÿå°±æ˜¯è¦ä¸ºç´¢å¼•å»è®¾ç½®åˆšåˆšåˆ›å»ºå¥½çš„ç­–ç•¥ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç´¢å¼•æ¨¡æ¿çš„æ–¹å¼ï¼Œå¯ä»¥åœ¨ Kibana é‡Œåˆ›å»ºç´¢å¼•æ¨¡æ¿ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ index.lifycycle.nameï¼Œæ˜¾å¼é€šè¿‡ API é…ç½®ã€‚&lt;/p&gt;&lt;p&gt;è¿™é‡Œæœ‰å‡ ä¸ªå°æç¤ºï¼š&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Tip 1ï¼š&lt;/strong&gt;&lt;strong&gt;Warm æˆ– Cold èŠ‚ç‚¹çš„å‰¯æœ¬æ•°ï¼ˆreplicaï¼‰å¯ä»¥è®¾ç½®ä¸º 1ã€‚&lt;/strong&gt;æ‰€æœ‰æ•°æ®æœ¬è´¨ä¸Šéƒ½æ˜¯æ”¾åœ¨ JuiceFS ä¸Šï¼Œå®ƒçš„åº•å±‚æ˜¯å¯¹è±¡å­˜å‚¨ï¼Œå› è€Œæ•°æ®çš„å¯é æ€§å·²ç»è¶³å¤Ÿé«˜äº†ï¼Œæ‰€ä»¥åœ¨ ES è¿™è¾¹å¯ä»¥é€‚å½“é™ä½å‰¯æœ¬æ•°ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ã€‚&lt;/p&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img js_insertlocalimg&quot; data-ratio=&quot;0.98984375&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/F446RY3QsZlxUL7e9sy6EbbHNqMDSY9F80IiadNCLGnnfLtmNUMxzaKgXLn8P7ZeG0JtXYWjwt63a7wpzQGvFtg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1280&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;Tip 2ï¼š&lt;/strong&gt;&lt;strong&gt;å¼€å¯ Force merge å¯èƒ½ä¼šå¯¼è‡´èŠ‚ç‚¹ CPU æŒç»­å ç”¨ï¼Œé…Œæƒ…å…³é—­&lt;/strong&gt;ã€‚ä»çƒ­æ•°æ®è½¬ç§»åˆ°æ¸©æ•°æ®è¿™ä¸ªé˜¶æ®µæ—¶ï¼ŒES ä¼šå°†æ‰€æœ‰çƒ­æ•°æ®ç´¢å¼•å¯¹åº”çš„åº•å±‚ segment åšåˆå¹¶ã€‚å¦‚æœå¼€å¯ Force merge è¿™ä¸ªåŠŸèƒ½ï¼ŒES ä¼šå…ˆåˆå¹¶å®Œè¿™äº› segment ä»¥åï¼Œå†æŠŠå®ƒå­˜å‚¨åˆ°æ¸©æ•°æ®çš„åº•å±‚ç³»ç»Ÿã€‚ç„¶è€Œåˆå¹¶ segment æ˜¯ä¸€ä¸ªéå¸¸æ¶ˆè€— CPU çš„è¿‡ç¨‹ï¼Œå¦‚æœæ¸©æ•°æ®çš„æ•°æ®èŠ‚ç‚¹åŒæ—¶ä¹Ÿéœ€è¦æ‰¿è½½ä¸€äº›æŸ¥è¯¢è¯·æ±‚ï¼Œå¯ä»¥é…Œæƒ…å…³é—­è¿™ä¸ªåŠŸèƒ½èƒ½ï¼Œä¹Ÿå°±æ˜¯åŸå°ä¸åŠ¨åœ°æŠŠæ•°æ®ä¿ç•™ä¸‹æ¥ï¼Œç›´æ¥å†™åˆ°åº•å±‚å­˜å‚¨ä¸­ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Tip 3ï¼š&lt;/strong&gt;&lt;strong&gt;Warm æˆ– Cold é˜¶æ®µçš„ç´¢å¼•å¯ä»¥è®¾ç½®ä¸ºåªè¯»&lt;/strong&gt;ã€‚åœ¨ç»™æ¸©æ•°æ®å’Œå†·æ•°æ®é˜¶æ®µå»ºç«‹ç´¢å¼•æ—¶ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥è®¤ä¸ºè¿™äº›æ•°æ®æ˜¯åªè¯»çš„ï¼Œè¿™äº›é˜¶æ®µçš„ç´¢å¼•ä¸ä¼šè¢«ä¿®æ”¹ã€‚è®¾ç½®ä¸ºåªè¯»å¯ä»¥é€‚å½“é™ä½æ¸©å†·æ•°æ®èŠ‚ç‚¹ä¸Šçš„èµ„æºï¼Œæ¯”å¦‚å†…å­˜å¯ä»¥é‡Šæ”¾ä¸€äº›ï¼Œä»è€ŒèŠ‚çœä¸€äº›åœ¨æ¸©èŠ‚ç‚¹æˆ–è€…å†·èŠ‚ç‚¹ä¸Šçš„ç¡¬ä»¶èµ„æºã€‚&lt;/p&gt;&lt;h2&gt;05- å®æ“ï¼šClickHouse + JuiceFS&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Step 1ï¼šåœ¨æ‰€æœ‰ ClickHouse èŠ‚ç‚¹ä¸ŠæŒ‚è½½ JuiceFS æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/strong&gt;è¿™ä¸ªè·¯å¾„å¯ä»¥æ˜¯ä»»æ„è·¯å¾„ï¼Œå› ä¸º ClickHouse ä¼šæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶å»æŒ‡å‘æŒ‚è½½ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 2ï¼šä¿®æ”¹ ClickHouse é…ç½®ï¼Œæ–°å¢ JuiceFS ç›˜ã€‚&lt;/strong&gt;åœ¨ ClickHouse ä¸­æŠŠåˆšåˆšæŒ‚è½½å¥½çš„ JuiceFS æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹æ·»åŠ è¿›æ¥ï¼Œè®© ClickHouse å¯ä»¥è¯†åˆ«è¿™ä¸ªæ–°ç£ç›˜ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 3ï¼šæ–°å¢å­˜å‚¨ç­–ç•¥ï¼Œè®¾å®šä¸‹æ²‰æ•°æ®è§„åˆ™ã€‚&lt;/strong&gt;è¿™ä¸ªå­˜å‚¨ç­–ç•¥ä¼šæ ¹æ®ç”¨æˆ·çš„è§„åˆ™å»ä¸å®šæœŸçš„ã€è‡ªåŠ¨åœ°å°†æ•°æ®ä»é»˜è®¤ç£ç›˜ä¸Šä¸‹æ²‰åˆ°æŒ‡å®šçš„ï¼Œæ¯”å¦‚ JuiceFS ä¸­ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 4ï¼šä¸ºç‰¹å®šè¡¨è®¾ç½®å­˜å‚¨ç­–ç•¥åŠ TTLã€‚&lt;/strong&gt;å­˜å‚¨ç­–ç•¥åˆ¶å®šå¥½ä¹‹åï¼Œéœ€è¦æŠŠè¿™ä¸ªç­–ç•¥åº”ç”¨åˆ°æŸä¸€ä¸ªè¡¨ä¸Šã€‚å‰æœŸæµ‹è¯•é˜¶æ®µå’ŒéªŒè¯é˜¶æ®µï¼Œå¯ä»¥æŠŠç”¨ç›¸å¯¹å¤§ä¸€ç‚¹çš„è¡¨å»åšæµ‹è¯•å’ŒéªŒè¯ï¼Œå¦‚æœç”¨æˆ·å¸Œæœ›åŸºäºæ—¶é—´ç»´åº¦æ¥å®ç°æ•°æ®ä¸‹æ²‰ï¼Œå°±åŒæ—¶ä¹Ÿéœ€è¦åœ¨è¡¨ä¸Šè®¾ç½® TTLã€‚æ•´ä¸ªä¸‹æ²‰è¿‡ç¨‹æ˜¯ä¸€ä¸ªè‡ªåŠ¨çš„æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡ ClickHouse çš„ system è¡¨æŸ¥çœ‹å½“å‰æ­£åœ¨è¿›è¡Œæ•°æ®è¿ç§»çš„ part ä»¥åŠè¿ç§»è¿›åº¦ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;Step 5ï¼šæ‰‹åŠ¨ç§»åŠ¨ part è¿›è¡ŒéªŒè¯ã€‚&lt;/strong&gt;å¯ä»¥é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œ&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;MOVE PARTITION&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;å‘½ä»¤çš„æ–¹å¼å»éªŒè¯å½“å‰çš„é…ç½®æˆ–å­˜å‚¨ç­–ç•¥æ˜¯å¦ç”Ÿæ•ˆã€‚&lt;/p&gt;&lt;p&gt;ä¸‹å›¾æ˜¯ä¸€ä¸ªå…·ä½“ç¤ºä¾‹ï¼Œåœ¨ ClickHouse ä¸­æœ‰ä¸€ä¸ªå«åš&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;storage_configuration&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„é…ç½®é¡¹ï¼Œå…¶ä¸­åŒ…å« disks é…ç½®ï¼Œè¿™é‡Œä¼šæŠŠ JuiceFS ä½œä¸ºä¸€ä¸ªç›˜åŠ è¿›æ¥ï¼Œæˆ‘ä»¬å°†å®ƒå‘½åä¸ºâ€œjfsâ€ï¼Œä½†å…¶å®å¯ä»¥ç”¨ä»»æ„åå­—ï¼ŒæŒ‚è½½ç‚¹æ˜¯&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;/jfs&lt;/code&gt;ç›®å½•ã€‚&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;&amp;lt;storage_configuration&amp;gt;&lt;br/&gt;Â &amp;lt;disks&amp;gt;&lt;br/&gt;Â Â Â Â Â &amp;lt;jfs&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â &amp;lt;path&amp;gt;/jfs&amp;lt;/path&amp;gt;&lt;br/&gt;Â Â Â Â Â &amp;lt;/jfs&amp;gt;&lt;br/&gt;Â &amp;lt;/disks&amp;gt;&lt;br/&gt;Â &amp;lt;policies&amp;gt;&lt;br/&gt;Â Â Â Â Â &amp;lt;hot_and_cold&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â &amp;lt;volumes&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;hot&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;disk&amp;gt;default&amp;lt;/disk&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;max_data_part_size_bytes&amp;gt;1073741824&amp;lt;/max_data_part_size_bytes&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;/hot&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;cold&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;disk&amp;gt;jfs&amp;lt;/disk&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â Â Â Â Â &amp;lt;/cold&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â &amp;lt;/volumes&amp;gt;&lt;br/&gt;Â Â Â Â Â Â Â Â Â &amp;lt;move_factor&amp;gt;0.1&amp;lt;/move_factor&amp;gt;&lt;br/&gt;Â Â Â Â Â &amp;lt;/hot_and_cold&amp;gt;&lt;br/&gt;Â &amp;lt;/policies&amp;gt;&lt;br/&gt;&amp;lt;/storage_configuration&amp;gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;å†å¾€ä¸‹æ˜¯ policies é…ç½®é¡¹ï¼Œè¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå«åš &lt;span&gt;hot_and_cold&lt;/span&gt; çš„å­˜å‚¨ç­–ç•¥ï¼Œç”¨æˆ·éœ€è¦å®šä¹‰ä¸€äº›å…·ä½“çš„è§„åˆ™ï¼Œå¦‚ volumes ä¸­æŒ‰ç…§å…ˆçƒ­åå†·çš„ä¼˜å…ˆçº§æ’åˆ—ï¼Œæ•°æ®é¦–å…ˆä¼šè½åˆ° volumes é‡Œçš„ç¬¬ä¸€ä¸ª hot ç›˜ä¸Šï¼ŒåŠé»˜è®¤çš„ ClickHouse ç£ç›˜ï¼Œä¸€èˆ¬æ˜¯æœ¬åœ°çš„ SSDã€‚&lt;/p&gt;&lt;p&gt;volumes ä¸­çš„ &lt;span&gt;max_data_part_size_bytes&lt;/span&gt; é…ç½®è¡¨ç¤ºå½“æŸä¸€ä¸ª part çš„å¤§å°è¶…è¿‡è®¾å®šçš„å¤§å°ä¹‹åï¼Œå°±ä¼šè§¦å‘å­˜å‚¨ç­–ç•¥çš„æ‰§è¡Œï¼Œå¯¹åº”çš„ part ä¼šä¸‹æ²‰åˆ°ä¸‹ä¸€ä¸ª volumeï¼Œä¹Ÿå°±æ˜¯ cold volumeã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œcold volume å°±æ˜¯ JuiceFSã€‚&lt;/p&gt;&lt;p&gt;æœ€ä¸‹é¢çš„ &lt;span&gt;move_factorÂ &lt;/span&gt; é…ç½®ä»£è¡¨ ClickHouse ä¼šæ ¹æ®å½“å‰ç£ç›˜çš„å‰©ä½™ç©ºé—´æ¯”ä¾‹æ¥è§¦å‘å­˜å‚¨ç­–ç•¥çš„æ‰§è¡Œã€‚&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;CREATEÂ TABLEÂ &lt;span&gt;test&lt;/span&gt;Â (&lt;br/&gt;Â Â dÂ DateTime,&lt;br/&gt;Â Â ...&lt;br/&gt;)Â ENGINEÂ =Â MergeTree&lt;br/&gt;...&lt;br/&gt;TTLÂ dÂ +Â INTERVALÂ 1Â DAYÂ TOÂ DISKÂ &lt;span&gt;&#x27;jfs&#x27;&lt;/span&gt;&lt;br/&gt;SETTINGSÂ storage_policyÂ =Â &lt;span&gt;&#x27;hot_and_cold&#x27;ï¼›&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;å¦‚ä¸Šé¢çš„ä»£ç æ‰€ç¤ºï¼Œæœ‰äº†å­˜å‚¨ç­–ç•¥ä¹‹åï¼Œåœ¨åˆ›å»ºè¡¨æˆ–è€…ä¿®æ”¹è¿™ä¸ªè¡¨çš„ schema æ—¶ï¼Œå¯ä»¥åœ¨ SETTINGS ä¸­è®¾ç½® &lt;span&gt;storage_policyÂ &lt;/span&gt; ä¸ºå‰é¢å®šä¹‰çš„ &lt;span&gt;hot_and_cold&lt;/span&gt; å­˜å‚¨ç­–ç•¥ã€‚ä¸Šè¿°ä»£ç ä¸­å€’æ•°ç¬¬äºŒè¡Œçš„ TTL å³ä¸ºä¸Šæ–‡æè¿‡çš„åŸºäºæ—¶é—´çš„åˆ†å±‚è§„åˆ™ã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šçš„è¡¨ä¸­æŸä¸€ä¸ªå«åš d çš„åˆ—ï¼Œå®ƒçš„ç±»å‹æ˜¯ &lt;span&gt;DateTime&lt;/span&gt;ï¼Œç»“åˆ &lt;span&gt;INTERVAL 1 DAY&lt;/span&gt; å°±è¡¨ç¤ºå½“æ–°çš„æ•°æ®å†™è¿›æ¥è¶…è¿‡ä¸€å¤©ä¹‹åï¼Œè¿™äº›æ•°æ®å°±ä¼šè½¬ç§»åˆ° JuiceFS ä¸Šã€‚&lt;/p&gt;&lt;h2&gt;06- å±•æœ›&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;ç¬¬ä¸€ï¼Œå‰¯æœ¬å…±äº«ã€‚&lt;/strong&gt;æ— è®ºæ˜¯ ES è¿˜æ˜¯ ClickHouseï¼Œä»–ä»¬éƒ½æ˜¯ç”±å¤šå‰¯æœ¬æ¥ä¿è¯æ•°æ®çš„å¯ç”¨æ€§å’Œå¯é æ€§ã€‚JuiceFS æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå…±äº«æ–‡ä»¶ç³»ç»Ÿï¼Œä»»ä½•ä¸€ä»½æ•°æ®å†™å…¥åˆ° JuiceFS ä¹‹åï¼Œä¸å†éœ€è¦ç»´æŠ¤å¤šä¸ªå‰¯æœ¬ã€‚æ¯”å¦‚ï¼Œç”¨æˆ·æœ‰ä¸¤ä¸ª ClickHouse èŠ‚ç‚¹ï¼Œéƒ½æœ‰æŸä¸€ä¸ªè¡¨çš„æˆ–è€…æŸä¸€ä¸ª part çš„å‰¯æœ¬ï¼Œè¿™ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ä¸‹æ²‰åˆ°äº† JuiceFSï¼Œå®ƒå¯èƒ½ä¼šå†™ä¸¤æ¬¡ä¸€æ ·çš„æ•°æ®ã€‚&lt;span&gt;&lt;strong&gt;æœªæ¥ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥åšåˆ°è®©ä¸Šå±‚å¼•æ“èƒ½å¤Ÿæ„ŸçŸ¥åˆ°ä¸‹å±‚ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªå…±äº«å­˜å‚¨ï¼Œå½“æ•°æ®ä¸‹æ²‰çš„æ—¶å€™å»é™ä½å‰¯æœ¬æ•°ï¼Œè¿™æ ·åœ¨ä¸åŒèŠ‚ç‚¹ä¹‹é—´æ˜¯å¯ä»¥åšå‰¯æœ¬å…±äº«çš„ã€‚&lt;/strong&gt;&lt;/span&gt;ä»åº”ç”¨å±‚æ¥è¯´ï¼Œç”¨æˆ·æŸ¥çœ‹è¿™ä¸ªè¡¨ï¼Œ part æ•°è¿˜æ˜¯å¤šå‰¯æœ¬ï¼Œä½†å®é™…åœ¨åº•å±‚çš„å­˜å‚¨ä¸Šåªä¿äº†ä¸€ä¸ªå‰¯æœ¬ï¼Œå› ä¸ºæœ¬è´¨ä¸Šæ•°æ®æ˜¯å¯ä»¥å…±äº«çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ç¬¬äºŒç‚¹ï¼Œæ•…éšœæ¢å¤ã€‚&lt;/strong&gt;å½“æ•°æ®å·²ç»ä¸‹æ²‰åˆ°ä¸€ä¸ªè¿œç«¯çš„å…±äº«å­˜å‚¨ä¹‹åï¼Œå¦‚æœ ES æˆ– ClickHousle èŠ‚ç‚¹å®•æœºæ•…éšœä¹‹åï¼Œæ€ä¹ˆå¿«é€Ÿåœ°åšæ•…éšœæ¢å¤ï¼Ÿé™¤äº†çƒ­æ•°æ®ä»¥å¤–çš„å¤§éƒ¨åˆ†æ•°æ®å…¶å®éƒ½å·²ç»è½¬ç§»åˆ°äº†ä¸€ä¸ªè¿œç«¯çš„å…±äº«å­˜å‚¨ä¸Šï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœè¦å»æ¢å¤æˆ–åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹æ—¶ï¼Œæˆæœ¬ä¼šæ¯”ä¼ ç»Ÿçš„åŸºäºæœ¬åœ°ç›˜çš„æ•…éšœæ¢å¤æ–¹å¼è½»é‡å¾ˆå¤šï¼Œè¿™åœ¨ ES æˆ–è€… ClickHouse åœºæ™¯ä¸Šæ˜¯å€¼å¾—æ¢ç´¢çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ç¬¬ä¸‰ç‚¹ï¼Œå­˜ç®—åˆ†ç¦»ã€‚&lt;/strong&gt;ä¸ç®¡ ES ä¹Ÿå¥½ï¼Œè¿˜æ˜¯ ClickHouseï¼Œæ•´ä¸ªç¤¾åŒºä¹Ÿéƒ½åœ¨å°è¯•æˆ–è€…æ¢ç´¢åœ¨äº‘åŸç”Ÿçš„å¤§ç¯å¢ƒä¸‹ï¼Œæ€ä¹ˆå»è®©ä¼ ç»Ÿçš„è¿™äº›åŸºäºæœ¬åœ°ç›˜çš„å­˜å‚¨ç³»ç»Ÿå˜æˆä¸€ä¸ªçœŸæ­£çš„å­˜ç®—åˆ†ç¦»ç³»ç»Ÿã€‚ä½†å­˜ç®—åˆ†ç¦»ä¸æ˜¯ä»…ä»…ç®€å•åœ°æŠŠæ•°æ®å’Œè®¡ç®—åˆ†ç¦»å°±å¥½äº†ï¼ŒåŒæ—¶è¦æ»¡è¶³ä¸Šå±‚å„ç§å¤æ‚çš„éœ€æ±‚ï¼Œæ¯”å¦‚å¯¹äºæŸ¥è¯¢æ€§èƒ½çš„éœ€æ±‚ã€å¯¹äºå†™å…¥æ€§èƒ½çš„éœ€æ±‚ã€å¯¹å„ç§ç»´åº¦è°ƒä¼˜çš„éœ€æ±‚ï¼Œåœ¨å­˜é‡åˆ†ç¦»æ•´ä¸ªå¤§çš„æ–¹å‘ä¸Šè¿˜æ˜¯æœ‰è®¸å¤šå€¼å¾—æ¢ç´¢çš„æŠ€æœ¯éš¾ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;&lt;strong&gt;ç¬¬å››ç‚¹ï¼Œå…¶ä»–ä¸Šå±‚åº”ç”¨ç»„ä»¶æ•°æ®åˆ†å±‚æ¢ç´¢ã€‚&lt;/strong&gt;é™¤äº†ES å’Œ ClickHouse è¿™ä¸¤ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬æœ€è¿‘ä¹Ÿæœ‰åœ¨åšä¸€äº›å°è¯•ï¼ŒæŠŠ Apache Pulsar ä¸­çš„æ¸©å†·æ•°æ®ä¸‹æ²‰åˆ° JuiceFS ä¸­ï¼Œç”¨åˆ°çš„ä¸€äº›ç­–ç•¥å’Œæ–¹æ¡ˆä¸æœ¬æ–‡ä¸­æåˆ°çš„æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡åœ¨ Apache Pulsar ä¸­ï¼Œå®ƒéœ€è¦ä¸‹æ²‰çš„æ•°æ®ç±»å‹æˆ–è€…æ•°æ®æ ¼å¼ä¸å¤ªä¸€æ ·ã€‚æœ‰äº†è¿›ä¸€æ­¥æˆåŠŸå®è·µåï¼Œä¼šåˆ†äº«å‡ºæ¥ã€‚&lt;/p&gt;&lt;section data-width=&quot;100%&quot; data-opacity=&quot;1&quot; data-rotate=&quot;0&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section data-width=&quot;100%&quot; data-opacity=&quot;1&quot; data-rotate=&quot;0&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>c33ada77de4389595c609ba2afe2951e</guid>
<title>å¦‚ä½•å®ç°æ•°æ®åº“è¯»ä¸€è‡´æ€§</title>
<link>https://toutiao.io/k/xpscpsa</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                           autoTypeSetting24psection&amp;#10;                          &quot; id=&quot;js_content&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;ï¼ˆç»™&lt;/span&gt;&lt;span&gt;ImportNew&lt;/span&gt;&lt;span&gt;åŠ æ˜Ÿæ ‡ï¼Œæé«˜JavaæŠ€èƒ½ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;1 å¯¼è¯»&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;æ•°æ®çš„ä¸€è‡´æ€§æ˜¯æ•°æ®å‡†ç¡®çš„é‡è¦æŒ‡æ ‡ï¼Œé‚£å¦‚ä½•å®ç°æ•°æ®çš„ä¸€è‡´æ€§å‘¢ï¼Ÿæœ¬æ–‡ä»äº‹åŠ¡ç‰¹æ€§å’Œäº‹åŠ¡çº§åˆ«çš„è§’åº¦å’Œå¤§å®¶ä¸€èµ·å­¦ä¹ å¦‚ä½•å®ç°æ•°æ®çš„è¯»å†™ä¸€è‡´æ€§ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;2 ä¸€è‡´æ€§&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;1. æ•°æ®çš„ä¸€è‡´æ€§ï¼šé€šå¸¸æŒ‡å…³è”æ•°æ®ä¹‹é—´çš„é€»è¾‘å…³ç³»æ˜¯å¦æ­£ç¡®å’Œå®Œæ•´ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸¾ä¸ªä¾‹å­ï¼šæŸç³»ç»Ÿå®ç°è¯»å†™åˆ†ç¦»ï¼Œè¯»æ•°æ®åº“æ˜¯å†™æ•°æ®åº“çš„å¤‡ä»½åº“ï¼Œå°æåœ¨ç³»ç»Ÿä¸­ä¹‹å‰å½•å…¥çš„å­¦å†ä¿¡æ¯æ˜¯é«˜ä¸­ï¼Œç»è¿‡å°æåŠªåŠ›å­¦ä¹ ï¼ŒæˆåŠŸè·å¾—äº†æœ¬ç§‘å­¦ä½ã€‚å°æåŠæ—¶æŠŠä¿¡æ¯å˜æˆæˆäº†æœ¬ç§‘ï¼Œå¯æ˜¯ç”±äºä»Šå¤©ç³»ç»Ÿå¤‡ä»½æ—¶é—´è¾ƒé•¿ï¼Œå°æå˜æ›´ä¿¡æ¯æ—¶ï¼Œæ•°æ®å·²ç»å¼€å§‹å¤‡ä»½ã€‚å…¬å¸çš„ HR é€šè¿‡ç³»ç»ŸæŸ¥è¯¢å°æä¿¡æ¯æ—¶ï¼Œå‘ç°è¿˜æ˜¯æœ¬ç§‘ï¼Œå°æçš„ç”³è¯·è¢«é©³å›ã€‚è¿™å°±æ˜¯æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;2. æ•°æ®åº“çš„ä¸€è‡´æ€§ï¼šæ˜¯æŒ‡æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚è¿™æ˜¯äº‹åŠ¡çš„ä¸€è‡´æ€§çš„å®šä¹‰ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸¾ä¸ªä¾‹å­ï¼šä»“åº“ä¸­å•†å“ A æœ‰ 100 ä»¶ï¼Œé—¨åº—ä¸­å•†å“ A æœ‰ 10 ä»¶ã€‚ä¸Šåˆ 10 ç‚¹ï¼Œä»“åº“å‘é€å•†å“ A50 ä»¶åˆ°é—¨åº—ï¼Œæœ€åä»“åº“ä¸­æœ‰å•†å“ A50 ä»¶ï¼Œé—¨åº—æœ‰å•†å“ A60 ä»¶ï¼Œè¿™æ ·å•†å“çš„æ€»æ˜¯æ˜¯ä¸å˜çš„ã€‚ä¸èƒ½é—¨åº—æ”¶åˆ°è´§åï¼Œä»“åº“çš„å•†å“ A è¿˜æ˜¯ 100 ä»¶ï¼Œè¿™æ ·å°±å‡ºç°æ•°æ®åº“ä¸ä¸€è‡´é—®é¢˜ã€‚ä»“åº“å’Œé—¨åº—å•†å“ A çš„æ€»æ•°æ˜¯ 110 æ‰æ˜¯æ­£ç¡®çš„ï¼Œè¿™å°±æ˜¯æ•°æ®åº“çš„ä¸€è‡´æ€§ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;3 æ•°æ®åº“äº‹åŠ¡&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;æ•°æ®åº“äº‹åŠ¡ (transaction) æ˜¯è®¿é—®å¹¶å¯èƒ½æ“ä½œå„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªæ•°æ®åº“æ“ä½œåºåˆ—ï¼Œè¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ã€‚äº‹åŠ¡ç”±äº‹åŠ¡å¼€å§‹ä¸äº‹åŠ¡ç»“æŸä¹‹é—´æ‰§è¡Œçš„å…¨éƒ¨æ•°æ®åº“æ“ä½œç»„æˆã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;äº‹åŠ¡çš„æ€§è´¨ï¼š&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;åŸå­æ€§ (Atomicity)ï¼šäº‹åŠ¡ä¸­çš„å…¨éƒ¨æ“ä½œåœ¨æ•°æ®åº“ä¸­æ˜¯ä¸å¯åˆ†å‰²çš„ï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;ä¸€è‡´æ€§ (Consistency)ï¼šå‡ ä¸ªå¹¶è¡Œæ‰§è¡Œçš„äº‹åŠ¡ï¼Œå…¶æ‰§è¡Œç»“æœå¿…é¡»ä¸æŒ‰æŸä¸€é¡ºåº ä¸²è¡Œæ‰§è¡Œçš„ç»“æœç›¸ä¸€è‡´ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;éš”ç¦»æ€§ (Isolation)ï¼šäº‹åŠ¡çš„æ‰§è¡Œä¸å—å…¶ä»–äº‹åŠ¡çš„å¹²æ‰°ï¼Œäº‹åŠ¡æ‰§è¡Œçš„ä¸­é—´ç»“æœå¯¹å…¶ä»–äº‹åŠ¡å¿…é¡»æ˜¯é€æ˜çš„ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æŒä¹…æ€§ (Durability): å¯¹äºä»»æ„å·²æäº¤äº‹åŠ¡ï¼Œç³»ç»Ÿå¿…é¡»ä¿è¯è¯¥äº‹åŠ¡å¯¹æ•°æ®åº“çš„æ”¹å˜ä¸è¢«ä¸¢å¤±ï¼Œå³ä½¿æ•°æ®åº“å‡ºç°æ•…éšœ&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;4 å¹¶å‘é—®é¢˜&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;æ•°æ®åº“åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä¼šå‡ºç°è„è¯»ã€é‡å¤è¯»å’Œå¹»è¯»é—®é¢˜ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;1. è„è¯»&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;äº‹åŠ¡ A è¯»å–äº†äº‹åŠ¡ B æœªæäº¤çš„æ•°æ®ï¼Œå¦‚æœäº‹åŠ¡ B å›æ»šäº†ï¼Œäº‹åŠ¡ A è¯»å–çš„æ•°æ®å°±æ˜¯è„çš„ã€‚&lt;br/&gt;ä¸¾ä¾‹ï¼šè®¢å• A éœ€è¦å•†å“ A20 ä»¶ï¼Œè®¢å• B éœ€è¦å•†å“ A10 ä»¶ã€‚ä»“åº“ä¸­æœ‰å•†å“ A åº“å­˜æ˜¯ 20 ä»¶ã€‚è®¢å• B å…ˆæŸ¥è¯¢ï¼Œå‘ç°åº“å­˜å¤Ÿï¼Œè¿›è¡Œæ‰£å‡ã€‚åœ¨æ‰£å‡çš„è¿‡ç¨‹ä¸­ï¼Œè®¢å• A è¿›è¡ŒæŸ¥è¯¢ï¼Œå‘ç°åº“å­˜åªæœ‰ 10 ä¸ªä¸å¤Ÿè®¢å•æ•°é‡ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚è¿™æ—¶å€™è®¢å• B æäº¤å¤±è´¥äº†ã€‚åº“å­˜æ•°é‡åˆå˜æˆ 20 äº†ã€‚è¿™æ—¶å€™ï¼Œä»“åº“äººå‘˜å»æŸ¥åº“å­˜ï¼Œå‘ç°æ•°é‡æ˜¯ 20ï¼Œå¯æ˜¯è®¢å• A å´è¯´åº“å­˜ä¸è¶³ï¼Œè¿™å°±è®©äººå¾ˆå¥‡æ€ªã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3546875&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/dkwuWwLoRKibkzvr8M8nH8bQ2g39B9T6zvniajMRicUHtm3G5KaY35omzLnHRwvHet1VKhvsyBJILOHY0qzSBgCeA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;jpeg&quot; data-w=&quot;640&quot;/&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;2. ä¸å¯é‡å¤è¯»&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;å¤è¯»æŒ‡çš„æ˜¯åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œæœ€å¼€å§‹è¯»åˆ°çš„æ•°æ®å’Œäº‹åŠ¡ç»“æŸå‰çš„ä»»æ„æ—¶åˆ»è¯»åˆ°çš„åŒä¸€æ‰¹æ•°æ®å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µã€‚&lt;br/&gt;ä¸¾ä¾‹ï¼šåº“æˆ¿ç®¡ç†å‘˜æŸ¥è¯¢å•†å“ A çš„æ•°é‡ï¼Œè¯»å–ç»“æœæ˜¯ 20 ä»¶ã€‚è¿™æ˜¯è®¢å• A å‡ºåº“ï¼Œæ‰£å‡äº†å•†å“ 10 ä»¶ã€‚è¿™æ—¶ç®¡ç†å‘˜å†å»æŸ¥å•†å“ A æ—¶ï¼Œå‘ç°å•†å“ A çš„æ•°é‡æ—¶ 10 ä»¶å’Œç¬¬ä¸€æ­¤æŸ¥è¯¢çš„ç»“æœä¸åŒäº†ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4859375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/dkwuWwLoRKibkzvr8M8nH8bQ2g39B9T6zCpvl8us3xItiaJryia3Am1GIH2buVDUWdHoIqq8kuUrcX8f3WneOycUw/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;jpeg&quot; data-w=&quot;640&quot;/&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;3. å¹»è¯»&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;äº‹åŠ¡ A åœ¨æ‰§è¡Œè¯»å–æ“ä½œï¼Œéœ€è¦ä¸¤æ¬¡ç»Ÿè®¡æ•°æ®çš„æ€»é‡ï¼Œå‰ä¸€æ¬¡æŸ¥è¯¢æ•°æ®æ€»é‡åï¼Œæ­¤æ—¶äº‹åŠ¡ B æ‰§è¡Œäº†æ–°å¢æ•°æ®çš„æ“ä½œå¹¶æäº¤åï¼Œè¿™ä¸ªæ—¶å€™äº‹åŠ¡ A è¯»å–çš„æ•°æ®æ€»é‡å’Œä¹‹å‰ç»Ÿè®¡çš„ä¸ä¸€æ ·ï¼Œå°±åƒäº§ç”Ÿäº†å¹»è§‰ä¸€æ ·ï¼Œå¹³ç™½æ— æ•…çš„å¤šäº†å‡ æ¡æ•°æ®ï¼Œæˆä¸ºå¹»è¯»ã€‚&lt;br/&gt;ä¸¾ä¾‹ï¼šæ“ä½œå‘˜æŸ¥è¯¢å¯ç”Ÿäº§å•é‡ 10 ä¸ªï¼Œè°ƒç”¨æ¥å£ä¸‹å‘ 10 ä¸ªè®¢å•ï¼Œäº‹åŠ¡ A å¢åŠ  10 ä¸ªè®¢å•ã€‚æ“ä½œå‘˜è·å– 10 ä¸ªè®¢å•è½åº“ï¼ŒæŸ¥è¯¢ å‘ç°å˜æˆ 30 ä¸ªè®¢å•ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3015625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/dkwuWwLoRKibkzvr8M8nH8bQ2g39B9T6zeTAgSicwUtUicib5k9CkriaibdlqhA8TeNB8DsRd7cLk4oaxpCnYsMy5JLQ/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;jpeg&quot; data-w=&quot;640&quot;/&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;5 äº‹åŠ¡éš”ç¦»çº§åˆ«&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;Read Uncommittedï¼ˆæœªæäº¤è¯»ï¼‰&lt;/span&gt;&lt;br/&gt;&lt;span&gt;ä¸€ä¸ªäº‹åŠ¡å¯ä»¥è¯»å–åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼Œä¼šå‡ºç°è„è¯»ï¼Œæ‰€ä»¥å«åš RUï¼Œå®ƒæ²¡æœ‰è§£å†³ä»»ä½•çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;Read Committedï¼ˆå·²æäº¤è¯»ï¼‰&lt;/span&gt;&lt;br/&gt;&lt;span&gt;ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡å·²æäº¤çš„æ•°æ®ï¼Œä¸èƒ½è¯»å–åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼Œå®ƒè§£å†³äº†è„è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯ä¼šå‡ºç°ä¸å¯é‡å¤è¯»çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;Repeatable Readï¼ˆå¯é‡å¤è¯»ï¼‰&lt;/span&gt;&lt;br/&gt;&lt;span&gt;å®ƒè§£å†³äº†ä¸å¯é‡å¤è¯»çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯åœ¨åŒä¸€ä¸ªäº‹åŠ¡é‡Œé¢å¤šæ¬¡è¯»å–åŒæ ·çš„æ•°æ®ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªçº§åˆ«ä¸‹ï¼Œæ²¡æœ‰å®šä¹‰è§£å†³å¹»è¯»çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;Serializableï¼ˆä¸²è¡ŒåŒ–ï¼‰&lt;/span&gt;&lt;br/&gt;&lt;span&gt;åœ¨è¿™ä¸ªéš”ç¦»çº§åˆ«é‡Œé¢ï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ï¼Œä¹Ÿå°±æ˜¯å¯¹æ•°æ®çš„æ“ä½œéœ€è¦æ’é˜Ÿï¼Œå·²ç»ä¸å­˜åœ¨äº‹åŠ¡çš„å¹¶å‘æ“ä½œäº†ï¼Œæ‰€ä»¥å®ƒè§£å†³äº†æ‰€æœ‰çš„é—®é¢˜ã€‚&lt;/span&gt;&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;6 è§£å†³æ•°æ®è¯»ä¸€è‡´æ€§&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;æœ‰ä¸¤ä¸ªæ–¹æ¡ˆå¯ä»¥è§£å†³è¯»ä¸€è‡´æ€§é—®é¢˜ï¼šåŸºäºé”çš„å¹¶å‘æ“ä½œï¼ˆLBCCï¼‰å’ŒåŸºäºå¤šç‰ˆæœ¬çš„å¹¶å‘æ“ä½œï¼ˆMVCCï¼‰&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;6.1 LBCC&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;æ—¢ç„¶è¦ä¿è¯å‰åä¸¤æ¬¡è¯»å–æ•°æ®ä¸€è‡´ï¼Œé‚£ä¹ˆè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œé”å®šæˆ‘è¦æ“ä½œçš„æ•°æ®ï¼Œä¸å…è®¸å…¶ä»–çš„äº‹åŠ¡ä¿®æ”¹å°±è¡Œäº†ã€‚è¿™ç§æ–¹æ¡ˆå«åšåŸºäºé”çš„å¹¶å‘æ§åˆ¶ Lock Based Concurrency Controlï¼ˆLBCCï¼‰ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;LBCC æ˜¯é€šè¿‡æ‚²è§‚é”æ¥å®ç°å¹¶å‘æ§åˆ¶çš„ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¦‚æœäº‹åŠ¡ A å¯¹æ•°æ®è¿›è¡ŒåŠ é”ï¼Œåœ¨é”é‡Šæ”¾å‰ï¼Œå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å¯¹æ•°æ®è¿›è¡Œè¯»å†™æ“ä½œã€‚è¿™æ ·å¹¶å‘è°ƒç”¨ï¼Œæ”¹æˆäº†é¡ºåºè°ƒç”¨ã€‚å¯¹ç›®å‰çš„å¤§å¤šæ•°ç³»ç»Ÿæ¥è¯´ï¼Œæ€§èƒ½å®Œå…¨ä¸èƒ½æ»¡è¶³è¦æ±‚ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;6.2 MVCC&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;è¦è®©ä¸€ä¸ªäº‹åŠ¡å‰åä¸¤æ¬¡è¯»å–çš„æ•°æ®ä¿æŒä¸€è‡´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ä¿®æ”¹æ•°æ®çš„æ—¶å€™ç»™å®ƒå»ºç«‹ä¸€ä¸ªå¤‡ä»½æˆ–è€…å«å¿«ç…§ï¼Œåé¢å†æ¥è¯»å–è¿™ä¸ªå¿«ç…§å°±è¡Œäº†ã€‚ä¸ç®¡äº‹åŠ¡æ‰§è¡Œå¤šé•¿æ—¶é—´ï¼Œäº‹åŠ¡å†…éƒ¨çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸å—å…¶å®ƒäº‹åŠ¡å½±å“çš„ï¼Œæ ¹æ®äº‹åŠ¡å¼€å§‹çš„æ—¶é—´ä¸åŒï¼Œæ¯ä¸ªäº‹åŠ¡å¯¹åŒä¸€å¼ è¡¨ï¼ŒåŒä¸€æ—¶åˆ»çœ‹åˆ°çš„æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™ç§æ–¹æ¡ˆæˆ‘ä»¬å«åšå¤šç‰ˆæœ¬çš„å¹¶å‘æ§åˆ¶ Multi Version Concurrency Control (MVCC)ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;MVCC æ˜¯åŸºäºä¹è§‚é”çš„ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;åœ¨ InnoDB ä¸­ï¼ŒMVCC æ˜¯é€šè¿‡ Undo log ä¸­çš„ç‰ˆæœ¬é“¾å’Œ Read-View ä¸€è‡´æ€§è§†å›¾æ¥å®ç°çš„ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;6.2.1 Undo log&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;undo log æ˜¯ innodb å¼•æ“çš„ä¸€ç§æ—¥å¿—ï¼Œåœ¨äº‹åŠ¡çš„ä¿®æ”¹è®°å½•ä¹‹å‰ï¼Œä¼šæŠŠè¯¥è®°å½•çš„åŸå€¼å…ˆä¿å­˜èµ·æ¥å†åšä¿®æ”¹ï¼Œä»¥ä¾¿ä¿®æ”¹è¿‡ç¨‹ä¸­å‡ºé”™èƒ½å¤Ÿæ¢å¤åŸå€¼æˆ–è€…å…¶ä»–çš„äº‹åŠ¡è¯»å–ã€‚undo log æ˜¯ä¸€ç§ç”¨äºæ’¤é”€å›é€€çš„æ—¥å¿—ï¼Œåœ¨äº‹åŠ¡æ²¡æäº¤ä¹‹å‰ï¼ŒMySQL ä¼šå…ˆè®°å½•æ›´æ–°å‰çš„æ•°æ®åˆ° undo log æ—¥å¿—æ–‡ä»¶é‡Œé¢ï¼Œå½“äº‹åŠ¡å›æ»šæ—¶æˆ–è€…æ•°æ®åº“å´©æºƒæ—¶ï¼Œå¯ä»¥åˆ©ç”¨ undo log æ¥è¿›è¡Œå›é€€ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¯¹æ•°æ®å˜æ›´çš„æ“ä½œä¸åŒï¼Œundo log è®°å½•çš„å†…å®¹ä¹Ÿä¸åŒ:&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ–°å¢ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œåœ¨åˆ›å»ºå¯¹åº” undo æ—¥å¿—æ—¶ï¼Œåªéœ€è¦æŠŠè¿™æ¡è®°å½•çš„ä¸»é”®å€¼è®°å½•ä¸‹æ¥ï¼Œå¦‚æœè¦å›æ»šæ’å…¥æ“ä½œï¼Œåªéœ€è¦æ ¹æ®å¯¹åº”çš„ä¸»é”®å€¼å¯¹è®°å½•è¿›è¡Œåˆ é™¤æ“ä½œã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;åˆ é™¤ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œåœ¨åˆ›å»ºå¯¹åº” undo æ—¥å¿—æ—¶ï¼Œéœ€è¦æŠŠè¿™æ¡æ•°æ®çš„æ‰€æœ‰å†…å®¹éƒ½è®°å½•ä¸‹æ¥ï¼Œå¦‚æœè¦å›æ»šåˆ é™¤è¯­å¥ï¼Œéœ€è¦æŠŠè®°å½•çš„æ•°æ®å†…å®¹ç”Ÿäº§ç›¸åº”çš„ insert è¯­å¥ï¼Œå¹¶æ’å…¥åˆ°æ•°æ®åº“ä¸­ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰æ›´æ–°ä¸»é”®ï¼Œåœ¨åˆ›å»ºå¯¹åº” undo æ—¥å¿—æ—¶ï¼Œå¦‚æœè¦å›æ»šæ›´æ–°è¯­å¥ï¼Œéœ€è¦æŠŠå˜æ›´å‰çš„å†…å®¹è®°å½•ä¸‹æ¥ï¼Œå¦‚æœè¦å›æ»šæ›´æ–°è¯­å¥ï¼Œéœ€è¦æ ¹æ®ä¸»é”®ï¼ŒæŠŠè®°å½•çš„æ•°æ®æ›´æ–°å›å»ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;æ›´æ–°ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œå¦‚æœæœ‰æ›´æ–°ä¸»é”®ï¼Œåœ¨åˆ›å»ºå¯¹åº” undo æ—¥å¿—æ—¶ï¼Œéœ€è¦æŠŠæ•°æ®çš„æ‰€æœ‰å†…å®¹éƒ½è®°å½•ä¸‹æ¥ï¼Œå¦‚æœè¦å›æ»šæ›´æ–°è¯­å¥ï¼Œå…ˆæŠŠå˜æ›´åçš„æ•°æ®åˆ æ‰ï¼Œå†æ‰§è¡Œæ’å…¥è¯­å¥ï¼ŒæŠŠå¤‡ä»½çš„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“ä¸­ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;undo log ç‰ˆæœ¬é“¾&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ¯æ¡æ•°æ®æœ‰ä¸¤ä¸ªéšè—å­—æ®µï¼Œtrx_id å’Œ roll_pointerï¼Œtrx_id è¡¨ç¤ºæœ€è¿‘ä¸€æ¬¡äº‹åŠ¡çš„ idï¼Œroll_pointer è¡¨ç¤ºæŒ‡å‘ä½ æ›´æ–°è¿™ä¸ªäº‹åŠ¡ä¹‹å‰ç”Ÿæˆçš„ undo logã€‚&lt;br/&gt;äº‹åŠ¡ IDï¼šMySQL ç»´æŠ¤ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå½“éœ€è¦ä¸ºæŸä¸ªäº‹åŠ¡åˆ†é…äº‹åŠ¡ ID æ—¶ï¼Œå°†è¯¥å˜é‡çš„å€¼ä½œä¸ºäº‹åŠ¡ id åˆ†é…ç»™äº‹åŠ¡ï¼Œç„¶åå°†å˜é‡è‡ªå¢ 1ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä¸¾ä¾‹ï¼š&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;äº‹åŠ¡ A id æ˜¯ 1 æ’å…¥ä¸€æ¡æ•°æ® Xï¼Œè¿™æ¡æ•°æ®çš„ trx_id =1 ,roll_pointer æ˜¯ç©ºï¼ˆç¬¬ä¸€æ¬¡æ’å…¥ï¼‰ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;äº‹åŠ¡ B id æ˜¯ 2 å¯¹è¿™æ¡æ•°æ®è¿›è¡Œäº†æ›´æ–°ï¼Œè¿™æ¡æ•°æ®çš„ trx_id =2 ,roll_pointer æŒ‡å‘ äº‹åŠ¡ A çš„ undo log.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;äº‹åŠ¡ C id æ˜¯ 3 åˆå¯¹æ•°æ®è¿›è¡Œäº†æ›´æ–°æ“ä½œï¼Œè¿™æ¡æ•°æ®çš„ trx_id =3,roll_pointer æŒ‡å‘ äº‹åŠ¡ B çš„ undo log.&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;span&gt;æ‰€ä»¥å½“å¤šä¸ªäº‹åŠ¡ä¸²è¡Œæ‰§è¡Œçš„æ—¶å€™ï¼Œæ¯ä¸ªäº‹åŠ¡ä¿®æ”¹äº†ä¸€è¡Œæ•°æ®ï¼Œéƒ½ä¼šæ›´æ–°éšè—å­—æ®µ trx_id å’Œ roll_pointerï¼ŒåŒæ—¶å¤šä¸ªäº‹åŠ¡çš„ undo log ä¼šé€šè¿‡ roll_pointer æŒ‡é’ˆä¸²è”èµ·æ¥ï¼Œå½¢æˆ undo log ç‰ˆæœ¬é“¾ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;6.2.2 Read-View ä¸€è‡´æ€§è§†å›¾&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;InnoDB ä¸ºæ¯ä¸ªäº‹åŠ¡ç»´æŠ¤äº†ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„ç”¨æ¥ä¿å­˜è¿™ä¸ªäº‹åŠ¡å¯åŠ¨çš„ç¬é—´ï¼Œå½“å‰æ´»è·ƒçš„äº‹åŠ¡ IDã€‚è¿™ä¸ªæ•°ç»„é‡Œæœ‰ä¸¤ä¸ªæ°´ä½å€¼ï¼š ä½æ°´ä½ (äº‹åŠ¡ ID æœ€å°å€¼) å’Œ é«˜æ°´ä½ (äº‹åŠ¡ ID æœ€å¤§å€¼ + 1); è¿™ä¸¤ä¸ªæ°´ä½å€¼å°±æ„æˆäº†å½“å‰äº‹åŠ¡çš„ä¸€è‡´æ€§è§†å›¾ï¼ˆRead-Viewï¼‰&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ReadView ä¸­ä¸»è¦åŒ…å« 4 ä¸ªæ¯”è¾ƒé‡è¦çš„å†…å®¹ï¼š&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;m_idsï¼šè¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶å½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡çš„äº‹åŠ¡ id åˆ—è¡¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;min_trx_idï¼šè¡¨ç¤ºåœ¨ç”Ÿæˆ ReadView æ—¶å½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡ idï¼Œä¹Ÿå°±æ˜¯ m_ids ä¸­çš„æœ€å°å€¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;max_trx_idï¼šè¡¨ç¤ºç”Ÿæˆ ReadView æ—¶ç³»ç»Ÿä¸­åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„ id å€¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;creator_trx_idï¼šè¡¨ç¤ºç”Ÿæˆè¯¥ ReadView çš„äº‹åŠ¡çš„äº‹åŠ¡ idã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;span&gt;æœ‰äº†è¿™äº›ä¿¡æ¯ï¼Œè¿™æ ·åœ¨è®¿é—®æŸæ¡è®°å½•æ—¶ï¼Œåªéœ€è¦æŒ‰ç…§ä¸‹è¾¹çš„æ­¥éª¤åˆ¤æ–­è®°å½•çš„æŸä¸ªç‰ˆæœ¬æ˜¯å¦å¯è§ï¼š&lt;/span&gt;&lt;/section&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ trx_id å±æ€§å€¼ä¸ ReadView ä¸­çš„ creator_trx_id å€¼ç›¸åŒï¼Œæ„å‘³ç€å½“å‰äº‹åŠ¡åœ¨è®¿é—®å®ƒè‡ªå·±ä¿®æ”¹è¿‡çš„è®°å½•ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ trx_id å±æ€§å€¼å°äº ReadView ä¸­çš„ min_trx_id å€¼ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”Ÿæˆ ReadView å‰å·²ç»æäº¤ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ trx_id å±æ€§å€¼å¤§äº ReadView ä¸­çš„ max_trx_id å€¼ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”Ÿæˆ ReadView åæ‰å¼€å¯ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ trx_id å±æ€§å€¼åœ¨ ReadView çš„ min_trx_id å’Œ max_trx_id ä¹‹é—´ï¼Œé‚£å°±éœ€è¦åˆ¤æ–­ä¸€ä¸‹ trx_id å±æ€§å€¼æ˜¯ä¸æ˜¯åœ¨ m_ids åˆ—è¡¨ä¸­ï¼Œå¦‚æœåœ¨ï¼Œè¯´æ˜åˆ›å»º ReadView æ—¶ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œè¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«è®¿é—®ï¼›å¦‚ä¸åœ¨ï¼Œè¯´æ˜åˆ›å»º ReadView æ—¶ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡å·²ç»è¢«æäº¤ï¼Œè¯¥ç‰ˆæœ¬å¯ä»¥è¢«è®¿é—®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;å¦‚æœæŸä¸ªç‰ˆæœ¬çš„æ•°æ®å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§çš„è¯ï¼Œé‚£å°±é¡ºç€ç‰ˆæœ¬é“¾æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œç»§ç»­æŒ‰ç…§ä¸Šè¾¹çš„æ­¥éª¤åˆ¤æ–­å¯è§æ€§ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°ç‰ˆæœ¬é“¾ä¸­çš„æœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚å¦‚æœæœ€åä¸€ä¸ªç‰ˆæœ¬ä¹Ÿä¸å¯è§çš„è¯ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€è¯¥æ¡è®°å½•å¯¹è¯¥äº‹åŠ¡å®Œå…¨ä¸å¯è§ï¼ŒæŸ¥è¯¢ç»“æœå°±ä¸åŒ…å«è¯¥è®°å½•ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1&gt;&lt;span&gt;6.2.3 æ•°æ®çš„æŸ¥æ‰¾æ–¹å¼&lt;/span&gt;&lt;/h1&gt;&lt;h1&gt;&lt;span&gt;1. å¿«ç…§è¯»&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;å¿«ç…§è¯»åˆå«ä¸€è‡´æ€§è¯»ï¼Œè¯»å–çš„æ˜¯å†å²ç‰ˆæœ¬çš„æ•°æ®ã€‚ä¸åŠ é”çš„ç®€å•çš„ SELECT éƒ½å±äºå¿«ç…§è¯»ï¼Œå³ä¸åŠ é”çš„éé˜»å¡è¯»ï¼Œåªèƒ½æŸ¥æ‰¾åˆ›å»ºæ—¶é—´å°äºç­‰äºå½“å‰äº‹åŠ¡ ID çš„æ•°æ®æˆ–è€…åˆ é™¤æ—¶é—´å¤§äºå½“å‰äº‹åŠ¡ ID çš„è¡Œï¼ˆæˆ–æœªåˆ é™¤ï¼‰ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;2. å½“å‰è¯»&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;å½“å‰è¯»æŸ¥æ‰¾çš„æ˜¯è®°å½•çš„æœ€æ–°æ•°æ®ã€‚åŠ é”çš„ SELECTã€å¯¹æ•°æ®è¿›è¡Œå¢åˆ æ”¹éƒ½ä¼šè¿›è¡Œå½“å‰è¯»ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;6.2.4 æ•°æ®ä¸¾ä¾‹&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.575&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/dkwuWwLoRKibkzvr8M8nH8bQ2g39B9T6zSIgt5VUDicIUKufCdegRxJDMibtyk1QibWK9qEOZnqzib1vgQUTPAadoNA/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;png&quot; data-w=&quot;640&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å¦‚å›¾æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;äº‹åŠ¡ A id =1 åˆå§‹åŒ–äº†æ•°æ®&lt;/span&gt;&lt;br/&gt;&lt;span&gt;äº‹åŠ¡ B id=2 è¿›è¡Œäº†æŸ¥è¯¢æ“ä½œ&lt;/span&gt;&lt;span&gt;ï¼ˆMVCC åªè¯»å–åˆ›å»ºæ—¶é—´å°äºå½“å‰äº‹åŠ¡ ID çš„æ•°æ®æˆ–è€…åˆ é™¤æ—¶é—´å¤§äºå½“å‰äº‹åŠ¡ ID çš„è¡Œï¼‰&lt;br/&gt;äº‹åŠ¡ B çš„ç»“æœæ˜¯ (å•†å“ Aï¼š10, å•†å“ Bï¼š5ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;äº‹åŠ¡ C id =3 æ’å…¥äº†å•†å“ C&lt;/span&gt;&lt;br/&gt;&lt;span&gt;äº‹åŠ¡ B id=2 è¿›è¡Œäº†æŸ¥è¯¢æ“ä½œï¼ˆMVCC åªè¯»å–åˆ›å»ºæ—¶é—´å°äºå½“å‰äº‹åŠ¡ ID çš„æ•°æ®æˆ–è€…åˆ é™¤æ—¶é—´å¤§äºå½“å‰äº‹åŠ¡ ID çš„è¡Œï¼‰&lt;br/&gt;äº‹åŠ¡ B çš„ç»“æœæ˜¯ (å•†å“ Aï¼š10, å•†å“ Bï¼š5ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;äº‹åŠ¡ D id =4 åˆ é™¤å•†å“ B&lt;/span&gt;&lt;br/&gt;&lt;span&gt;äº‹åŠ¡ B id=2 è¿›è¡Œäº†æŸ¥è¯¢æ“ä½œï¼ˆMVCC åªè¯»å–åˆ›å»ºæ—¶é—´å°äºå½“å‰äº‹åŠ¡ ID çš„æ•°æ®æˆ–è€…åˆ é™¤æ—¶é—´å¤§äºå½“å‰äº‹åŠ¡ ID çš„è¡Œï¼‰&lt;br/&gt;äº‹åŠ¡ B çš„ç»“æœæ˜¯ (å•†å“ Aï¼š10, å•†å“ Bï¼š5ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;span&gt;äº‹åŠ¡ E id =4 ä¿®æ”¹å•†å“ A çš„æ•°é‡&lt;/span&gt;&lt;br/&gt;&lt;span&gt;äº‹åŠ¡ B id=2 è¿›è¡Œäº†æŸ¥è¯¢æ“ä½œï¼ˆMVCC åªè¯»å–åˆ›å»ºæ—¶é—´å°äºå½“å‰äº‹åŠ¡ ID çš„æ•°æ®æˆ–è€…åˆ é™¤æ—¶é—´å¤§äºå½“å‰äº‹åŠ¡ ID çš„è¡Œï¼‰&lt;br/&gt;äº‹åŠ¡ B çš„ç»“æœæ˜¯ (å•†å“ Aï¼š10, å•†å“ Bï¼š5ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æ‰€ä»¥å½“äº‹åŠ¡ E æäº¤åï¼Œå½“å‰è¯»è·å–çš„æ•°æ®å’Œäº‹åŠ¡ B è¯»å–çš„å¿«ç…§æ•°æ®æ˜æ˜¾ä¸åŒã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;6.2.5 å¯è§£å†³é—®é¢˜&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;MVCC å¯ä»¥å¾ˆå¥½çš„è§£å†³è¯»ä¸€è‡´é—®é¢˜ï¼Œåªèƒ½çœ‹åˆ°è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹å‰äº‹åŠ¡æäº¤æ›´æ–°çš„ç»“æœï¼Œè€Œä¸èƒ½çœ‹åˆ°è¿™ä¸ªæ—¶é—´ç‚¹ä¹‹åäº‹åŠ¡æäº¤çš„æ›´æ–°ç»“æœã€‚è€Œä¸”é™ä½äº†æ­»é”çš„æ¦‚ç‡å’Œè§£å†³è¯»å†™ä¹‹é—´å µå¡é—®é¢˜ã€‚&lt;/span&gt;&lt;span/&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;7 å°ç»“&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section&gt;&lt;span&gt;LBCC å’Œ MVCC éƒ½å¯ä»¥è§£å†³è¯»ä¸€è‡´é—®é¢˜ï¼Œå…·ä½“ä½¿ç”¨å“ªç§æ–¹å¼ï¼Œè¦ç»“åˆä¸šåŠ¡åœºæ™¯é€‰æ‹©æœ€åˆé€‚çš„æ–¹å¼ï¼ŒMVCC å’Œé”ä¹Ÿå¯ä»¥ç»“åˆä½¿ç”¨ï¼Œæ²¡æœ‰æœ€å¥½åªæœ‰æ›´å¥½ã€‚&lt;/span&gt;&lt;/section&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span&gt;è½¬è‡ªï¼šOSCHINA&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é“¾æ¥&lt;span&gt;ï¼š&lt;span&gt;https://my.oschina.net/u/4090830/blog/5580720&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;- EOF -&lt;/span&gt;&lt;/p&gt;&lt;section donone=&quot;shifuMouseDownCard(&#x27;shifu_c_030&#x27;)&quot; label=&quot;Copyright Reserved by PLAYHUDONG.&quot;&gt;&lt;section&gt;&lt;span&gt;æ¨èé˜…è¯»&lt;/span&gt;Â Â &lt;span&gt;ç‚¹å‡»æ ‡é¢˜å¯è·³è½¬&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;amp;mid=2651519607&amp;amp;idx=1&amp;amp;sn=9a6e498c86b2d966f1f80fbd364f6c4d&amp;amp;chksm=bd2596088a521f1e3a6b70915917ad333f1e505dabcc8e8688475e3c50ada0bec573bee95752&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;æ˜åœ°ä¸‰å°ºæå®š Redis ä¸ MySQL æ•°æ®ä¸€è‡´æ€§é—®é¢˜&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;11&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;æ˜åœ°ä¸‰å°ºæå®š Redis ä¸ MySQL æ•°æ®ä¸€è‡´æ€§é—®é¢˜&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MjM5NzMyMjAwMA==&amp;amp;mid=2651509714&amp;amp;idx=1&amp;amp;sn=8d2338d1868103aa7de6cce2aec91a8c&amp;amp;chksm=bd25bfad8a5236bba84735740e968846dd5d51295aca3ee06a61d04ca9d7c1831a3ae1ce9ac6&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;ç¼“å­˜å’Œæ•°æ®åº“ä¸€è‡´æ€§é—®é¢˜ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;11&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;ç¼“å­˜å’Œæ•°æ®åº“ä¸€è‡´æ€§é—®é¢˜ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;çœ‹å®Œæœ¬æ–‡æœ‰æ”¶è·ï¼Ÿè¯·è½¬å‘åˆ†äº«ç»™æ›´å¤šäºº&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;å…³æ³¨ã€ŒImportNewã€ï¼Œæå‡JavaæŠ€èƒ½&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9166666666666666&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/2A8tXicCG8ylbWIGfdoDED35IRRySQZTXUkJ1eop9MHApzFibKnOo0diboXpl0rmS5mH78YJhsWQv0dhv718A6kUA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;600&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;ç‚¹èµå’Œåœ¨çœ‹å°±æ˜¯æœ€å¤§çš„æ”¯æŒ&lt;/span&gt;&lt;span&gt;â¤ï¸&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/div&gt;

          
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>29a8b600b7a530d9b0c6fbc762d6ef30</guid>
<title>cgo æœºåˆ¶ - ä» c è°ƒç”¨ go</title>
<link>https://toutiao.io/k/oq6plpn</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;ä¸€ã€å‰è¨€&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;å»å¹´åˆšå­¦ go è¯­è¨€çš„æ—¶å€™ï¼Œå†™äº†è¿™ç¯‡ &lt;span&gt;cgo å®ç°æœºåˆ¶&lt;/span&gt;&lt;span&gt;&lt;sup&gt;[1]Â &lt;/sup&gt;&lt;/span&gt;ï¼Œä»‹ç»äº† cgo çš„åŸºæœ¬æƒ…å†µã€‚ä¸»è¦ä»‹ç»çš„æ˜¯Â &lt;code&gt;go=&amp;gt;c&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;è¿™ä¸ªè°ƒç”¨æ–¹å¼ï¼Œå±äºæ¯”è¾ƒæµ…çš„å±‚æ¬¡ã€‚éšç€äº†è§£çš„æ·±å…¥ï¼Œå‘ç°&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;c=&amp;gt;go&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„å¤æ‚åº¦åˆé«˜äº†ä¸€çº§ï¼Œæ‰€ä»¥æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;äºŒã€ä¸¤ä¸ªæ–¹å‘&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;é¦–å…ˆï¼Œcgo åŒ…å«&lt;/span&gt;&lt;/span&gt;&lt;span&gt;äº†ä¸¤ä¸ª&lt;/span&gt;&lt;span&gt;&lt;span&gt;æ–¹å‘ï¼ŒÂ &lt;/span&gt;&lt;/span&gt;&lt;code&gt;c=&amp;gt;go&lt;/code&gt;&lt;span&gt;Â ï¼Œ&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;code&gt;go=&amp;gt;c&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ç›¸å¯¹æ¥è¯´ï¼Œ&lt;span/&gt;&lt;code&gt;go=&amp;gt;c&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ˜¯æ›´ç®€å•çš„ï¼Œæ˜¯åœ¨ go runtime åˆ›å»ºçš„çº¿ç¨‹ä¸­ï¼Œè°ƒç”¨æ‰§è¡Œ c å‡½æ•°ã€‚å¯¹ go è°ƒåº¦å™¨è€Œè¨€ï¼Œè°ƒç”¨ c å‡½æ•°ï¼Œå°±ç›¸å½“äºç³»ç»Ÿè°ƒç”¨ã€‚æ‰§è¡Œç¯å¢ƒè¿˜æ˜¯åœ¨æœ¬çº¿ç¨‹ï¼Œåªæ˜¯è°ƒç”¨æ ˆæœ‰åˆ‡æ¢ï¼Œè¿˜å¤šäº†ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„ ABI å¯¹é½ï¼Œå¯¹äº go runtime ä¾èµ–çš„ GMP ç¯å¢ƒï¼Œéƒ½æ˜¯ç°æœ‰çš„ï¼Œå¹¶æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;è€Œ&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;c=&amp;gt;go&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;åˆ™å¤æ‚å¾ˆå¤šï¼Œæ˜¯åœ¨ä¸€ä¸ª c å®¿ä¸»åˆ›å»ºçš„çº¿ç¨‹ä¸Šï¼Œè°ƒç”¨æ‰§è¡Œ go å‡½æ•°ã€‚è¿™æ„å‘³ç€ï¼Œéœ€è¦åœ¨ c çº¿ç¨‹ä¸­ï¼Œå‡†å¤‡å¥½ go runtime æ‰€éœ€è¦çš„ GMP ç¯å¢ƒï¼Œæ‰èƒ½è¿è¡Œ go å‡½æ•°ã€‚ä»¥åŠï¼Œgo å’Œ c å¯¹äºçº¿ç¨‹æŒæ§çš„ä¸åŒï¼Œä¸»è¦æ˜¯ä¿¡å·è¿™å—ã€‚æ‰€ä»¥ï¼Œå¤æ‚åº¦åˆé«˜äº†ä¸€çº§ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;ä¸‰ã€GMP ä»å“ªé‡Œæ¥&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;é¦–å…ˆç®€å•è§£é‡Šä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆéœ€è¦&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;GMP&lt;/code&gt;Â ï¼Œå› ä¸ºåœ¨ go å‡½æ•°è¿è¡Œçš„æ—¶å€™ï¼Œæ€»æ˜¯å‡è®¾æ˜¯è¿è¡Œåœ¨ä¸€ä¸ª goroutine ç¯å¢ƒä¸­ï¼Œä»¥åŠç»‘å®šæœ‰å¯¹åº”çš„&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;å’Œ&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span/&gt;ã€‚æ¯”å¦‚ï¼Œè¦ç”³è¯·å†…å­˜çš„æ—¶å€™ï¼Œåˆ™ä¼šå…ˆä»Â &lt;span&gt;P&lt;/span&gt;Â è¿™ä¸€å±‚ cache çš„ span ä¸­çš„è·å–ï¼Œå¦‚æœè¿™äº›æ²¡æœ‰çš„è¯ï¼Œgo runtime å°±æ²¡æ³•è¿è¡Œäº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;è™½ç„¶&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ˜¯çº¿ç¨‹ï¼Œä½†æ˜¯å…·ä½“å®ç°ä¸Šï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„æ•°æ®ç»“æ„æ¥è¡¨ç¤ºï¼Œå¯¹äº c åˆ›å»ºçš„åç¨‹ï¼Œè·å–çš„æ˜¯&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;Â ï¼Œä¹Ÿå°±æ˜¯å•ç‹¬çš„è¡¨ç¤ºçº¿ç¨‹çš„&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ•°æ®ç»“æ„ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ç®€å•æ¥è¯´ï¼Œc çº¿ç¨‹éœ€è¦è·å–çš„&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;GMP&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span/&gt;ï¼Œå°±æ˜¯ä¸‰ä¸ªæ•°æ®å¯¹è±¡ã€‚åœ¨å…·ä½“çš„å®ç°è¿‡ç¨‹ä¸­ï¼Œæ˜¯åˆ†ä¸ºä¸¤æ­¥æ¥çš„ï¼š&lt;br/&gt;&lt;/p&gt;&lt;p&gt;1.Â &lt;code&gt;needm&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;è·å–ä¸€ä¸ª &lt;span&gt;extra M&lt;/span&gt;&lt;/p&gt;&lt;p&gt;å¼€å¯äº† cgo çš„æƒ…å†µä¸‹ï¼Œgo runtime ä¼šé¢„å…ˆåˆ›å»ºå¥½é¢å¤–çš„&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ï¼ŒåŒæ—¶è¿˜ä¼šåˆ›å»ºä¸€ä¸ª goroutineï¼Œè·Ÿè¿™ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ç»‘å®šã€‚æ‰€ä»¥ï¼Œè·å–åˆ° Mï¼Œä¹Ÿå°±åŒæ—¶å¾—åˆ°äº† Gã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;è€Œä¸”ï¼Œgo runtime å¯¹äº M å¹¶æ²¡æœ‰é™åˆ¶ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ— é™çš„ï¼Œä¹Ÿå°±ä¸å­˜åœ¨è·å–ä¸åˆ° M çš„æƒ…å†µã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;2.&lt;code&gt;exitsyscall&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;è·å–&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span/&gt;&lt;/p&gt;&lt;p&gt;æ˜¯çš„ï¼Œè¿™ä¸ªå°±æ˜¯&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;go=&amp;gt;c&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„åå‘è¿‡ç¨‹ã€‚åªæ˜¯&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;Â èµ„æºæ˜¯æœ‰é™çš„ï¼Œå¯èƒ½ä¼šå‡ºç°æŠ¢ä¸åˆ° &lt;span&gt;PÂ &lt;/span&gt;çš„æƒ…å†µï¼Œæ­¤æ—¶å°±å¾—çœ‹è°ƒåº¦æœºåˆ¶äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;å››ã€è°ƒåº¦æœºåˆ¶&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ç®€å•æƒ…å†µä¸‹ï¼Œ&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;å’Œ&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;èµ„æºéƒ½é¡ºåˆ©æ‹¿åˆ°äº†ï¼Œè¿™ä¸ª c çº¿ç¨‹ï¼Œå°±å¯ä»¥åœ¨ &lt;span&gt;M&lt;/span&gt; ç»‘å®šçš„ goroutine ä¸­è¿è¡ŒæŒ‡å®šçš„ go å‡½æ•°äº†ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœ go å‡½æ•°å¾ˆç®€å•ï¼Œåªæ˜¯ç®€å•çš„åšç‚¹çº¯ CPU è®¡ç®—å°±ç»“æŸäº†ï¼Œé‚£ä¹ˆè¿™æœŸé—´åˆ™ä¸ä¾èµ– go çš„è°ƒåº¦äº†ã€‚&lt;/p&gt;&lt;p&gt;æœ‰ä¸¤ç§æƒ…å†µï¼Œä¼šå‘ç”Ÿè°ƒåº¦ï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;1. exitsyscallÂ è·å–ä¸åˆ° P&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;æ­¤æ—¶æ²¡æ³•ç»§ç»­æ‰§è¡Œäº†ï¼Œåªèƒ½ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1.å°†å½“å‰&lt;/span&gt;&lt;span&gt; extra MÂ &lt;/span&gt;&lt;span&gt;ä¸Šç»‘å®šçš„ &lt;/span&gt;&lt;span&gt;gÂ &lt;/span&gt;&lt;span&gt;ï¼Œæ”¾å…¥å…¨å±€ &lt;/span&gt;&lt;span&gt;g&lt;/span&gt;&lt;span&gt; ç­‰å¾…é˜Ÿåˆ—&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2.å°†å½“å‰ c çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾… &lt;/span&gt;&lt;span&gt;g&lt;/span&gt;&lt;span&gt; è¢«å”¤èµ·æ‰§è¡Œ&lt;br/&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åœ¨ &lt;/span&gt;&lt;span&gt;g&lt;/span&gt;&lt;span&gt; è¢«å”¤èµ·æ‰§è¡Œçš„æ—¶å€™ï¼Œå› ä¸º &lt;/span&gt;&lt;span&gt;g&lt;/span&gt;&lt;span&gt; å’Œ &lt;/span&gt;&lt;span&gt;M&lt;/span&gt;&lt;span&gt; æ˜¯ç»‘å®šå…³ç³»ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1.æ‰§è¡Œ &lt;/span&gt;&lt;span&gt;g&lt;/span&gt;&lt;span&gt; çš„é‚£ä¸ªçº¿ç¨‹ï¼Œä¼šæŒ‚èµ·ï¼Œè®©å‡º &lt;/span&gt;&lt;span&gt;P&lt;/span&gt;&lt;span&gt;Â ï¼Œå”¤èµ·ç­‰å¾…çš„ c çº¿ç¨‹&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2.c çº¿ç¨‹è¢«å”¤èµ·ä¹‹åï¼Œæ‹¿åˆ° P ç»§ç»­æ‰§è¡Œ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;2. go å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿäº†åç¨‹æŒ‚èµ·&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;æ¯”å¦‚ï¼Œgo å‡½æ•°ä¸­å‘èµ·äº†ç½‘ç»œè°ƒç”¨ï¼Œéœ€è¦ç­‰å¾…ç½‘ç»œå“åº”ï¼ŒæŒ‰ç…§ä¹‹å‰ä»‹ç»çš„æ–‡ç« ï¼Œ&lt;/span&gt;&lt;span&gt;Goroutine è°ƒåº¦ - ç½‘ç»œè°ƒ&lt;/span&gt;&lt;span&gt;&lt;span&gt;&lt;span&gt;ç”¨&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;sup&gt;[2]Â &lt;/sup&gt;&lt;/span&gt;&lt;span&gt;ã€‚å½“å‰ &lt;/span&gt;&lt;span&gt;g&lt;/span&gt;&lt;span&gt; ä¼šæŒ‚èµ·ï¼Œå”¤é†’ä¸‹ä¸€ä¸ª &lt;/span&gt;&lt;span&gt;gÂ &lt;/span&gt;&lt;span&gt;ï¼Œç»§ç»­æ‰§è¡Œã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ä½†æ˜¯ï¼Œå› ä¸º &lt;span&gt;M&lt;/span&gt; å’Œ &lt;span&gt;g&lt;/span&gt; æ˜¯ç»‘å®šå…³ç³»ï¼Œæ­¤æ—¶ä¼šï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.Â &lt;span&gt;g&lt;/span&gt; æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—&lt;/p&gt;&lt;p&gt;2.å½“å‰ c çº¿ç¨‹è¢«æŒ‚èµ·ï¼Œç­‰å¾… &lt;span&gt;g&lt;/span&gt; è¢«å”¤é†’&lt;/p&gt;&lt;p&gt;3.Â &lt;span&gt;P&lt;/span&gt; è¢«é‡Šæ”¾&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;åœ¨ &lt;span&gt;g&lt;/span&gt; è¢«å”¤é†’çš„æ—¶å€™ï¼Œæ­¤æ—¶è‚¯å®šä¸æ˜¯åœ¨åŸæ¥çš„ c çº¿ç¨‹ä¸Šäº†&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.å½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œè®©å‡º &lt;span&gt;P&lt;/span&gt;ï¼Œå”¤é†’ç­‰å¾…çš„ c çº¿ç¨‹&lt;/p&gt;&lt;p&gt;2.c çº¿ç¨‹è¢«å”¤é†’åï¼Œæ‹¿åˆ° &lt;span&gt;P&lt;/span&gt;ï¼Œç»§ç»­æ‰§è¡Œ&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ç›´è§‚æ¥è¯´ï¼Œä¹Ÿå°±æ˜¯åœ¨ c çº¿ç¨‹ä¸Šæ‰§è¡Œçš„ goroutineï¼Œå¹¶ä¸åƒæ™®é€šçš„ go çº¿ç¨‹ä¸€æ ·ï¼Œå‚ä¸ go runtime çš„è°ƒåº¦ã€‚å¯¹äº go runtime è€Œè¨€ï¼Œåç¨‹ä¸­çš„ç½‘ç»œä»»åŠ¡ï¼Œè¿˜æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼åœ¨æ‰§è¡Œï¼Œåªæ˜¯å¯¹äº c çº¿ç¨‹è€Œè¨€ï¼Œåˆ™å®Œå…¨æ˜¯ä»¥é˜»å¡çš„æ–¹å¼æ¥æ‰§è¡Œäº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦è¿™æ ·ï¼Œè¿˜æ˜¯å› ä¸ºçº¿ç¨‹çš„è°ƒç”¨æ ˆï¼Œåªæœ‰ä¸€ä¸ªï¼Œæ²¡æœ‰åŠæ³•å¹¶å‘ï¼Œéœ€è¦æŠŠçº¿ç¨‹æŒ‚èµ·ï¼Œä¿æŠ¤å¥½è°ƒç”¨æ ˆã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;PSï¼šè¿™é‡Œçš„æ‰§è¡Œæµç¨‹ï¼Œå…¶å®è·Ÿä¸Šé¢æŠ¢ä¸åˆ° P çš„æµç¨‹ï¼Œå¾ˆç±»ä¼¼ï¼Œåº•å±‚ä¹Ÿæ˜¯åŒä¸€å¥—å‡½æ•°åœ¨è·‘ï¼ˆæ ¸å¿ƒè¿˜æ˜¯&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;schedule&lt;/code&gt;&lt;span&gt;ï¼‰ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;äº”ã€ä¿¡å·å¤„ç†&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;å¦å¤–ä¸€å¤§å·®å¼‚æ˜¯ï¼Œä¿¡å·å¤„ç†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1. c è¯­è¨€ä¸–ç•Œé‡Œï¼ŒæŠŠä¿¡å·å¤„ç†çš„æƒåˆ©/è´£ä»»ï¼Œå®Œå…¨äº¤ç»™ç”¨æˆ·äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2. go è¯­è¨€ï¼Œåˆ™åœ¨ runtime åšäº†ä¸€å±‚å¤„ç†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;æ¯”å¦‚ï¼Œä¸€ä¸ªå…·ä½“çš„é—®é¢˜ï¼Œå½“ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿäº† segfault ä¿¡å·ï¼Œæ­¤æ—¶æ˜¯åº”è¯¥ç”± go æ¥å¤„ç†ï¼Œè¿˜æ˜¯ c æ¥å“åº”ä¿¡å·å‘¢ï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;ç­”æ¡ˆæ˜¯ï¼Œçœ‹å‘ç”Ÿ segfault æ—¶çš„ä¸Šä¸‹æ–‡ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;1.å¦‚æœæ­£åœ¨è¿è¡Œ go ä»£ç ï¼Œåˆ™äº¤ç»™ go runtime æ¥å¤„ç†&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2.å¦‚æœæ­£åœ¨è¿è¡Œ c ä»£ç ï¼Œåˆ™è¿˜æ˜¯ c æ¥å“åº”&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;é‚£å…·ä½“æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿä¿¡å·å¤„ç†è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæœ‰æ¯”è¾ƒå¤šçš„ç»†èŠ‚ï¼Œè¿™é‡Œæˆ‘ä»¬åªä»‹ç»å‡ ä¸ªæ ¸å¿ƒç‚¹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;1. sighandler æ³¨å†Œ&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;é¦–å…ˆï¼Œå¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€ï¼ŒåŒä¸€ä¸ªä¿¡å·ï¼Œåªèƒ½æœ‰ä¸€ä¸ª handler ã€‚å†çœ‹ go å’Œ c å‘ç”Ÿ sighandler æ³¨å†Œçš„æ—¶æœºï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1. go ç¼–è¯‘äº§ç”Ÿçš„ so æ–‡ä»¶ï¼Œè¢«åŠ è½½çš„æ—¶å€™ï¼Œä¼šæ³¨å†Œ sighandlerï¼ˆä»…é’ˆå¯¹ go éœ€è¦ç”¨çš„ä¿¡å·ï¼‰ï¼Œå¹¶ä¸”ä¼šæŠŠåŸå§‹çš„ sighandler ä¿å­˜ä¸‹æ¥ã€‚&lt;/p&gt;&lt;p&gt;2. c å¯ä»¥åœ¨ä»»æ„çš„æ—¶é—´ï¼Œæ³¨å†Œ sighandlerï¼Œå¯ä»¥æ˜¯ä»»æ„çš„ä¿¡å·ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œæ¨èçš„åšæ³•æ˜¯ï¼Œåœ¨åŠ è½½ go so ä¹‹å‰ï¼Œc å…ˆå®Œæˆä¿¡å·æ³¨å†Œï¼Œåœ¨ go so åŠ è½½ä¹‹åï¼Œä¸è¦å†æ³¨å†Œ sighandler äº†ï¼Œé¿å…è¦†ç›– go æ³¨å†Œ sighandlerã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;2.ä¿¡å·å¤„ç†&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;å¯¹äºæœ€ç®€å•çš„æƒ…å†µï¼Œå¦‚æœä¸€ä¸ªä¿¡å·ï¼Œåªæœ‰ c æ³¨å†Œäº† sighandlerï¼Œé‚£ä¹ˆè¿˜æ˜¯æŒ‰ç…§å¸¸è§„ c ä¿¡å·å¤„ç†çš„æ–¹å¼æ¥ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å¯¹äº sigfault è¿™ç§ï¼Œgo ä¹Ÿæ³¨å†Œäº† sighandler çš„ä¿¡å·ï¼ŒæŒ‰ç…§è¿™ä¸ªæµç¨‹æ¥ï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.æ“ä½œç³»ç»Ÿè§¦å‘ä¿¡å·æ—¶ï¼Œä¼šè°ƒç”¨ go æ³¨å†Œçš„ sighandlerï¼ˆæœ€ä½³å®è·µä¸­ï¼Œgo çš„ä¿¡å·æ³¨å†Œåœ¨åé¢ï¼‰ï¼›&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;2.go sighandler å…ˆåˆ¤æ–­æ˜¯å¦åœ¨ c ä¸Šä¸‹æ–‡ä¸­ï¼ˆç®€å•çš„ç†è§£ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ gï¼Œå®é™…ä¸Šè¿˜æ˜¯æŒºå¤æ‚çš„ï¼‰ï¼›&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;3.å¦‚æœï¼Œåœ¨ c ä¸Šä¸‹æ–‡ä¸­ï¼Œä¼šè°ƒç”¨ä¹‹å‰ä¿å­˜çš„åŸå§‹ sighandlerï¼ˆæ²¡æœ‰åŸå§‹çš„ sighandlerï¼Œåˆ™ä¼šä¸´æ—¶æ¢å¤ signal é…ç½®ï¼Œé‡æ–°è§¦å‘ä¿¡å·ï¼‰ï¼›&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;4.å¦‚æœï¼Œåœ¨ go ä¸Šä¸‹æ–‡ä¸­ï¼Œåˆ™ä¼šæ‰§è¡Œæ™®é€šçš„ä¿¡å·å¤„ç†æµç¨‹ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­ï¼Œ2 å’Œ 3 æ˜¯æœ€å¤æ‚çš„ï¼Œå› ä¸º cgo åŒ…å«äº†ä¸¤ä¸ªæ–¹å‘ï¼Œä»¥åŠä¿¡å·è¿˜æœ‰ sigmask ç­‰ç­‰é¢å¤–çš„å› ç´ ï¼Œæ‰€ä»¥è¿™é‡Œç»†èŠ‚æ˜¯éå¸¸å¤šçš„ï¼Œä¸è¿‡æ€è·¯æ–¹å‘è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;å…­ã€ä¼˜åŒ–&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ä¸Šç¯‡&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;cgo å®ç°æœºåˆ¶&lt;/span&gt;&lt;span&gt;&lt;sup&gt;[1]Â &lt;/sup&gt;&lt;/span&gt;ï¼Œæè¿‡ä¼˜åŒ–ä¸€äº›æ€è·¯ï¼Œä¸è¿‡ä¸»è¦é’ˆå¯¹&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;go =&amp;gt; c&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;è¿™ä¸ªæ–¹å‘ã€‚å› ä¸º&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;c =&amp;gt; go&lt;/code&gt;Â çš„åœºæ™¯ä¸­ï¼Œè¿˜æœ‰å…¶ä»–æ›´é‡è¦çš„ä¼˜åŒ–ç‚¹ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;1.å¤ç”¨ extra M&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œæœ€å¤§çš„æ€§èƒ½æ¶ˆè€—ç‚¹åœ¨è·å–/é‡Šæ”¾&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.ä¸Šé¢æåˆ°ï¼Œä» c è¿›å…¥ goï¼Œéœ€è¦é€šè¿‡&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;needm&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ¥è·å–&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;Â ã€‚è¿™æœŸé—´æœ‰ 5 ä¸ªä¿¡å·ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ã€‚æ¯”å¦‚ï¼šé¿å…æ­»é”ç”¨çš„ï¼Œä¸´æ—¶å±è”½æ‰€æœ‰ä¿¡å·ï¼Œä»¥åŠå¼€å¯ go æ‰€éœ€è¦çš„ä¿¡å·ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;2.ä» go è¿”å› c çš„æ—¶å€™ï¼Œé€šè¿‡&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;dropm&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;æ¥é‡Šæ”¾&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span/&gt;&lt;span&gt;&lt;span&gt;ã€‚&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;è¿™æœŸé—´æœ‰ 3 ä¸ªä¿¡å·ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span&gt;ç›®çš„æ˜¯æ¢å¤åˆ°&lt;/span&gt;&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;needm&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;&lt;span&gt;ä¹‹å‰çš„ä¿¡å·çŠ¶æ€ï¼ˆå› Â &lt;/span&gt;&lt;/span&gt;&lt;span&gt;&lt;span/&gt;&lt;/span&gt;&lt;span&gt;needmÂ &lt;/span&gt;&lt;span&gt;&lt;span&gt;å¼ºåˆ¶å¼€å¯äº† go å¿…é¡»çš„ä¿¡å·ï¼‰ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¸¤ä¸ªæ“ä½œï¼Œåœ¨ MOSN æ–°çš„ MOE æ¶æ„çš„æµ‹è¯•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°çº¦å æ•´ä½“ 2~5% çš„ CPU å ç”¨ï¼Œè¿˜æ˜¯æ¯”è¾ƒå¯è§‚çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;äº†è§£äº†ç“¶é¢ˆä¹‹åï¼Œä¹Ÿå°±æˆåŠŸäº†ä¸€åŠã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ä¼˜åŒ–æ€è·¯ä¹Ÿå¾ˆç›´è§‚ï¼Œç¬¬ä¸€æ¬¡ä» go è¿”å› c çš„æ—¶å€™ï¼Œä¸é‡Šæ”¾&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ï¼Œç»§ç»­ç•™ç€ä½¿ç”¨ï¼Œä¸‹ä¸€æ¬¡ä» c è¿›å…¥ go ä¹Ÿå°±ä¸éœ€è¦å†è·å–&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;äº†ã€‚å› ä¸º&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;èµ„æºæ˜¯æ— é™çš„ï¼Œc çº¿ç¨‹ä¸€ç›´å ç”¨ä¸€ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ä¹Ÿæ— æ‰€è°“ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ä¸è¿‡ï¼Œåœ¨ c çº¿ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œè¿˜æ˜¯éœ€è¦é‡Šæ”¾&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ï¼Œé¿å…æ³„æ¼ã€‚æ‰€ä»¥ï¼Œè¿™ä¸ªä¼˜åŒ–ï¼Œåœ¨ windows å°±ä¸èƒ½å¯ç”¨äº†ï¼Œå› ä¸º windows çš„ pthread API æ²¡æœ‰çº¿ç¨‹é€€å‡ºçš„ callback æœºåˆ¶ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ç›®å‰å®ç°äº†ä¸€ç‰ˆåœ¨ &lt;span&gt;CL 392854&lt;/span&gt;&lt;span&gt;&lt;sup&gt;[3]Â &lt;/sup&gt;&lt;/span&gt;ã€‚è™½ç„¶é€šè¿‡äº†ä¸€ä¸ªå¤§ä½¬çš„åˆæ­¥ reviewï¼Œä»¥åŠè·‘é€šäº†å…¨éƒ¨æµ‹è¯•ï¼Œä¸è¿‡ï¼Œä¼°è®¡è¦åˆå¹¶è¿˜è¦å¾ˆä¹…...å› ä¸ºè¿™ä¸ª PR å·²ç»æ¯”è¾ƒå¤§äº†ï¼Œè¢«æ ‡è®° L size äº†ï¼Œè¿™ç§ CL ä¼°è®¡å¤§ä½¬ä»¬ review èµ·æ¥ä¹Ÿå¤´å¤§...&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;åœ¨ç®€å•åœºæ™¯çš„æµ‹è¯•ä¸­ï¼Œå•æ¬¡&lt;span&gt; c =&amp;gt; go &lt;/span&gt;çš„è°ƒç”¨ï¼Œä»&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;~1600ns&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ä¼˜åŒ–åˆ°äº†&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;~140ns&lt;/code&gt;&lt;span/&gt;ï¼Œæå‡ 10 å€ï¼Œè¾¾åˆ°äº†æ¥è¿‘ go =&amp;gt; c çš„æ°´å¹³ï¼ˆ&lt;/span&gt;&lt;span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/span&gt;&lt;code&gt;~80ns&lt;/code&gt;&lt;span&gt;&lt;span&gt;Â ï¼‰æ•ˆæœè¿˜æ˜¯æŒºæ˜æ˜¾çš„ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å®ç°ä¸Šä¸»è¦æœ‰ä¸¤ä¸ªè¾ƒå¤æ‚çš„ç‚¹ï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.æ¥æ”¶åˆ°ä¿¡å·æ—¶ï¼Œåˆ¤æ–­åœ¨å“ªä¸ªä¸Šä¸‹æ–‡é‡Œï¼Œä»¥åŠæ˜¯å¦åº”è¯¥è½¬å‘ç»™ cã€‚å› ä¸º cgo æœ‰ä¸¤ä¸ªæ–¹å‘ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªæ–¹å‘åˆæ˜¯å¯ä»¥åœ¨ä¸€ä¸ªè°ƒç”¨æ ˆä¸­åŒæ—¶å‘ç”Ÿçš„ï¼Œä»¥åŠä¿¡å·è¿˜æœ‰&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;mask&lt;/code&gt;&lt;span/&gt; ï¼Œç³»ç»Ÿé»˜è®¤ handler ä¹‹åˆ†ã€‚è¿™é‡Œé¢å·²ç»ä¸æ˜¯ç®€å•çš„çŠ¶æ€æœºå¯ä»¥æè¿°çš„ï¼Œgo runtime åœ¨è¿™å—æœ‰çº¦ 100 + è¡Œçš„æ ¸å¿ƒåˆ¤æ–­ä»£ç ï¼Œä»¥åº”å¯¹å„å¼å„æ ·çš„ç”¨æ³•ã€‚ä¼°è®¡æ²¡å‡ ä¸ªäººå¯ä»¥å…¨éƒ¨è®°ä½ï¼Œåªæœ‰ç¢°åˆ°å…·ä½“åœºæ™¯ä¸´æ—¶å»åˆ†æã€‚æˆ–è€…åœ¨è·‘æµ‹è¯•ç”¨ä¾‹å¤±è´¥çš„æ—¶å€™ï¼Œæ‰å…·ä½“å»åˆ†æã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;2.åœ¨ c çº¿ç¨‹é€€å‡ºï¼Œcallback åˆ° go çš„æ—¶å€™ï¼Œæ¶‰åŠåˆ° c å’Œ go function call ABI å¯¹é½ã€‚è¿™é‡Œä¸»è¦çš„å¤æ‚åº¦åœ¨äºï¼Œéœ€è¦å¤„ç†å¥½ä¸åŒçš„ CPU ä½“ç³»ç»“æ„ï¼Œä»¥åŠæ“ä½œç³»ç»Ÿä¸Šçš„å·®å¼‚ã€‚æ‰€ä»¥å·¥ä½œé‡è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ã€‚æ¯”å¦‚ arm ï¼Œarm64 ï¼Œ æœŸé—´æœ‰ä¸€ä¸ªæœ‰æ„æ€çš„å‘ï¼ŒAarch64 çš„ stack pointer å¿…é¡»æ˜¯ 16 byte å¯¹é½çš„ï¼Œå¦åˆ™ä¼šè§¦å‘ bus error ä¿¡å·ã€‚ï¼ˆä¹Ÿå› æ­¤ arm64 çš„å‹æ ˆ/å‡ºæ ˆæŒ‡ä»¤ï¼Œéƒ½æ˜¯ä¸¤ä¸ªä¸¤ä¸ªæ“ä½œçš„ï¼‰&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;2.è·å–ä¸åˆ° P&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ä» c è¿›å…¥ goï¼Œè·å– GMP çš„è¿‡ç¨‹ä¸­ï¼Œåªæœ‰&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;èµ„æºæ˜¯å—é™çš„ï¼Œåœ¨è´Ÿè½½è¾ƒé«˜æ—¶ï¼Œè·å–ä¸åˆ°&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ä¹Ÿæ˜¯æ¯”è¾ƒå®¹æ˜“ç¢°åˆ°çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å½“è·å–ä¸åˆ°&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ—¶ï¼Œc çº¿ç¨‹ä¼šæŒ‚èµ·ï¼Œç­‰å¾…è¿›å…¥å…¨å±€é˜Ÿåˆ—çš„&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;g&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;è¢«å”¤é†’ã€‚è¿™ä¸ªè¿‡ç¨‹å¯¹äº go runtime è€Œè¨€æ˜¯æ¯”è¾ƒåˆç†çš„ï¼Œä½†æ˜¯å¯¹äº c çº¿ç¨‹åˆ™æ¯”è¾ƒå±é™©ï¼Œå°¤å…¶å½“ c çº¿ç¨‹ä¸­è·‘çš„æ˜¯å¤šè·¯å¤ç”¨çš„é€»è¾‘ï¼Œåˆ™å½±å“æ›´å¤§äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;æ­¤æ—¶æœ‰ä¸¤ä¸ªä¼˜åŒ–æ€è·¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.ç±»ä¼¼&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra M&lt;/code&gt;Â ï¼Œå†ç»™ c çº¿ç¨‹ç»‘ä¸€ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ï¼Œæˆ–è€…é¢„å…ˆç»‘å®šä¸€ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;Â &lt;span&gt;ã€‚&lt;/span&gt;è¿™æ · c çº¿ç¨‹å°±ä¸éœ€è¦è¢«æŒ‚èµ·äº†ã€‚è¿™ä¸ªæ€è·¯ï¼Œæœ€å¤§çš„æŒ‘æˆ˜åœ¨äº&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span/&gt;ï¼Œæ˜¯ä¸å—å¸¸è§„&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ•°é‡çš„é™åˆ¶ï¼Œå¯¹äº go ä¸­&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„å®šä¹‰ï¼Œæ˜¯ä¸€ä¸ªä¸å°çš„æŒ‘æˆ˜ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;2.å°†&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;g&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ä¸æ”¾å…¥å…¨å±€é˜Ÿåˆ—ï¼Œæ”¹ä¸ºæ”¾åˆ°ä¼˜å…ˆçº§æ›´é«˜çš„Â &lt;code&gt;P.runnext&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;ï¼Œè¿™æ · &lt;span&gt;g&lt;/span&gt; å¯ä»¥è¢«å¿«é€Ÿçš„è°ƒåº¦åˆ°ï¼Œc çº¿ç¨‹å¯ä»¥ç­‰å¾…çš„æ—¶é—´æ›´çŸ­äº†ã€‚è¿™ä¸ªæ€è·¯ï¼Œæœ€å¤§çš„æŒ‘æˆ˜åˆ™åœ¨äºï¼Œå¯¹è¿™ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;g&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;åŠ äº†ä¼˜å…ˆçº§çš„åˆ¤æ–­ï¼Œæˆ–è®¸æœ‰ä¸€ç‚¹æœ‰æ‚–äº &lt;span&gt;g&lt;/span&gt; åº”è¯¥æ˜¯å¹³ç­‰çš„åŸåˆ™ã€‚ä¸è¿‡åº”è¯¥ä¹Ÿè¿˜å¥½ï¼Œ&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P.runnext&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æœ¬æ¥ä¹Ÿæ˜¯ä¸ºäº†åº”å¯¹æŸäº›éœ€è¦ä¼˜å…ˆçš„åœºæ™¯çš„ï¼Œè¿™é‡Œåªæ˜¯å¤šäº†ä¸€ä¸ªåœºæ™¯ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;è¿™ä¸ªä¼˜åŒ–æ–¹å‘ï¼Œè¿˜æ²¡æœ‰ CLï¼Œä¸è¿‡æˆ‘ä»¬æœ‰åŒå­¦åœ¨æäº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;3.å°½å¿«é‡Šæ”¾ P&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;span&gt;å½“ä» go è¿”å› c çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;entersyscall&lt;/code&gt;&lt;span/&gt;&lt;span&gt; ï¼Œå…·ä½“æ˜¯ï¼Œ&lt;code&gt;M&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/span&gt;&lt;span&gt;å’Œ&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;å¹¶æ²¡æœ‰å®Œå…¨è§£é™¤ç»‘å®šï¼Œè€Œæ˜¯è®©&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;è¿›å…¥&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;syscall&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span&gt;çš„çŠ¶æ€ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œä¼šæœ‰ä¸¤ç§æƒ…å†µï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.å¾ˆå¿«åˆæœ‰äº†ä¸‹ä¸€ä¸ª &lt;span&gt;c=&amp;gt;go&lt;/span&gt; è°ƒç”¨ï¼Œåˆ™ç›´æ¥ç”¨è¿™ä¸ª &lt;span&gt;P&lt;/span&gt;Â ï¼›&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;2.sysmon ä¼šå¼ºåˆ¶è§£é™¤ç»‘å®šã€‚å¯¹äºè¿›å…¥&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;syscall&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„ &lt;span&gt;P&lt;/span&gt;Â ï¼Œsysmon ä¼šç­‰ 20 us =&amp;gt; 10 msï¼Œç„¶åå°† P æŠ¢èµ°é‡Šæ”¾æ‰ã€‚ç­‰å¾…æ—¶é—´è·¨åº¦è¿˜æ˜¯æŒºå¤§çš„ï¼Œå…·ä½“å¤šä¹…å°±çœ‹å‘½äº†ï¼Œä¸»è¦çœ‹&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;sysmon&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ˜¯å¦ä¹‹å‰å·²ç»é•¿æ—¶é—´ç©ºé—²äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å¯¹äº go =&amp;gt; c è¿™æ–¹å‘ï¼Œä¸€ä¸ª syscall çš„ç­‰å¾…æ—¶é—´ï¼Œé€šå¸¸æ˜¯æ¯”è¾ƒå°çš„ï¼Œæ‰€ä»¥è¿™å¥—æœºåˆ¶æ˜¯åˆé€‚çš„ã€‚ä½†æ˜¯å¯¹äº c =&amp;gt; go è¿™ä¸ªæ–¹å‘ï¼Œè¿™ç§ä¼ª syscall çš„ç­‰å¾…æ—¶é—´ï¼Œå–å†³äºä¸¤ä¸ª c =&amp;gt; go è°ƒç”¨çš„é—´éš”æ—¶é—´ï¼Œå…¶å®ä¸å¤ªæœ‰è§„å¾‹çš„ã€‚æ‰€ä»¥ï¼Œå¯èƒ½ä¼šé€ æˆ&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;èµ„æºè¢«æµªè´¹ 20us =&amp;gt; 10msã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;æ‰€ä»¥ï¼Œåˆæœ‰ä¸€ä¸ªä¼˜åŒ–æ–¹å‘ï¼Œä¸¤ä¸ªæ€è·¯ï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;1.ä» go è¿”å› c çš„æ—¶å€™ï¼Œç«‹å³é‡Šæ”¾&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span/&gt;ï¼Œè¿™æ ·ä¸ä¼šæµªè´¹&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;èµ„æºã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;2.è°ƒæ•´ä¸‹ sysmonï¼Œé’ˆå¯¹è¿™ç§åœºæ™¯ï¼Œæœ‰ä¸€ç§æœºåˆ¶ï¼Œèƒ½å°½é‡åœ¨ 20 us å°±æŠŠ P æŠ¢èµ°ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å…¶ä¸­ï¼Œæ€è·¯ 1 ï¼Œè¿™ä¸ª CL 411034 é‡Œé¡ºä¾¿å®ç°äº†ã€‚è¿™ä¸ªæœ¬æ¥æ˜¯ä¸ºäº†ä¿®å¤ go trace åœ¨ cgo åœºæ™¯ä¸‹ä¸èƒ½ç”¨çš„ bug ï¼Œæ”¹åˆ°è¿™ä¸ªç‚¹ï¼Œæ˜¯å› ä¸ºè·Ÿ Michael å¤§ä½¬è®¨è®ºï¼Œå¼•å‘çš„ä¸€ä¸ªæ”¹åŠ¨ï¼ˆä¸€å¼€å§‹è¿˜æ²¡æœ‰æ„è¯†åˆ°æ˜¯ä¸€ä¸ªä¼˜åŒ–ï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;ä¸ƒã€æ€»ç»“&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;ä¸çŸ¥é“çœ‹åˆ°è¿™é‡Œï¼Œä½ æ˜¯å¦ä¸€æ ·è§‰å¾—ï¼Œ&lt;span&gt;c =&amp;gt; go&lt;/span&gt; æ¯” &lt;span&gt;go =&amp;gt; c&lt;/span&gt; çš„å¤æ‚åº¦åˆé«˜äº†ä¸€çº§ã€‚åæ­£æˆ‘æ˜¯æœ‰çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;é¦–å…ˆï¼Œc çº¿ç¨‹å¾—æ‹¿åˆ° &lt;span&gt;GMP&lt;/span&gt; æ‰èƒ½è¿è¡Œ go å‡½æ•°ï¼Œç„¶åï¼Œc çº¿ç¨‹ä¸Šçš„ g å‘ç”Ÿäº†åç¨‹è°ƒåº¦äº‹ä»¶çš„æ—¶å€™ï¼Œ&lt;span&gt;è°ƒåº¦ç­–ç•¥åˆè·Ÿæ™®é€šçš„ go çº¿ç¨‹ä¸ä¸€æ ·ã€‚&lt;/span&gt;å¦å¤–ä¸€ä¸ªå¤§å‘åˆ™æ˜¯ä¿¡å·å¤„ç†ï¼Œåœ¨ go runtime æ¥ç®¡äº† sighandler ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦è®© c çº¿ç¨‹ä¹‹å‰æ³¨å†Œçš„ sighandler ä¸€æ ·æœ‰æ•ˆï¼Œä½¿ c çº¿ç¨‹æ„Ÿè§‰ä¸åˆ°è¢« go runtime æ¥ç®¡äº†ä¸€é“ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ä¼˜åŒ–è¿™å—ï¼Œç›¸å¯¹æ¥è¯´ï¼Œæ¯”è¾ƒå¥½ç†è§£ä¸€äº›ï¼Œä¸»è¦æ˜¯æ¶‰åŠåˆ° go ç›®å‰çš„å®ç°æ–¹å¼ï¼Œå¹¶æ²¡æœ‰å¤ªå¤šåº•å±‚åŸç†ä¸Šçš„æ”¹è¿›ã€‚å¤ç”¨ extra M å±äºé™ä½ CPU å¼€é”€ï¼›P ç›¸å…³çš„è·å–å’Œé‡Šæ”¾ï¼Œåˆ™æ›´å¤šæ¶‰åŠåˆ°å»¶æ—¶ç±»çš„ä¼˜åŒ–ï¼ˆå¦‚æœæäº† extra Pï¼Œåˆ™ä¹Ÿä¼šæœ‰ CPU çš„ä¼˜åŒ–æ•ˆæœï¼‰ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;å…«ã€æœ€å&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;æœ€ååä¸ªæ§½ï¼Œå…¶å®ç›®å‰çš„å®ç°æ–¹æ¡ˆä¸­ï¼Œä» c è°ƒç”¨ go çš„åœºæ™¯ï¼Œgo runtime çš„è°ƒåº¦ç­–ç•¥ï¼Œæ›´å¤šæ˜¯è€ƒè™‘ go è¿™ä¸€ä¾§ï¼Œæ¯”å¦‚ goroutine å’Œ P ä¸èƒ½è¢«é˜»å¡ã€‚ä½†æ˜¯ï¼Œå¯¹ c çº¿ç¨‹å…¶å®æ˜¯å¾ˆä¸å‹å¥½çš„ï¼Œåªè¦æ¶‰åŠåˆ°ç­‰å¾…ï¼Œå°±ä¼šæŠŠ c çº¿ç¨‹æŒ‚èµ·...&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;å› ä¸º go çš„å¹¶å‘æ¨¡å‹ä¸­ï¼Œçº¿ç¨‹æŒ‚èµ·é€šå¸¸æ˜¯å¯ä»¥æ¥å—çš„ï¼Œä½†æ˜¯å¯¹äºå®¿ä¸» c çº¿ç¨‹è€Œè¨€ï¼Œæœ‰æ—¶å€™è¢«é˜»å¡æŒ‚èµ·åˆ™æ˜¯å¾ˆæ•æ„Ÿçš„ã€‚æ¯”å¦‚ï¼Œåœ¨ MOSN çš„ MOE æ¶æ„ä¸­ï¼Œå¯¹äºè¿™ç±»å¯èƒ½å¯¼è‡´ c çº¿ç¨‹è¢«æŒ‚èµ·çš„è¡Œä¸ºï¼Œéœ€è¦å¾ˆå°å¿ƒçš„å¤„ç†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;é‚£æœ‰æ²¡æœ‰åŠæ³•æ”¹å˜ï¼Œä¹Ÿæ˜¯æœ‰çš„ï¼Œåªæ˜¯æ”¹åŠ¨ç›¸å¯¹è¦å¤§ä¸€ç‚¹ï¼Œå¤§ä½“æ€è·¯æ˜¯ï¼Œå°† c è°ƒç”¨ go çš„ API å¼‚æ­¥åŒ–ï¼š&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;gÂ =Â GoFunc(a,Â b)&lt;br/&gt;&lt;span&gt;printf&lt;/span&gt;(&lt;span&gt;&quot;g.status:Â %d,Â g.result:Â %d\n&quot;&lt;/span&gt;,Â g.status,Â g.result)&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;æ„æ€æ˜¯ï¼Œè°ƒç”¨ Go å‡½æ•°ï¼Œä¸å†åŒæ­¥è¿”å›å‡½æ•°è¿”å›å€¼ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªå¸¦çŠ¶æ€&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;g&lt;/code&gt;ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå› ä¸º API å¼‚æ­¥äº†ï¼Œæ‰€ä»¥æ‰§è¡Œçš„æ—¶å€™ï¼Œä¹Ÿä¸å¿…åŒæ­¥ç­‰å¾… g è¿”å›äº†ã€‚å¦‚æœç¢°åˆ° g è¢«æŒ‚èµ·äº†ï¼Œç›´æ¥è¿”å›&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;status = yield&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;çš„ g å³å¯ï¼Œgoroutine åç¨‹ç»§ç»­èµ° go runtime çš„è°ƒåº¦ï¼Œc çº¿ç¨‹ä¹Ÿä¸å¿…æŒ‚èµ·ç­‰å¾…äº†ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;è¿™æ ·çš„è®¾è®¡ï¼Œå¯¹äº c çº¿ç¨‹æ˜¯æœ€å‹å¥½çš„ï¼Œå½“ç„¶ä¹Ÿè¿˜å¾—æœ‰ä¸€äº›é…å¥—çš„æ”¹åŠ¨ï¼Œæ¯”å¦‚ç¼ºå°‘ P çš„æ—¶å€™ï¼Œå¾—æœ‰ä¸ª&lt;span&gt;Â &lt;/span&gt;&lt;code&gt;extra P&lt;/code&gt;&lt;span&gt;Â &lt;/span&gt;æ›´å¥½ä¸€äº›ï¼Œç­‰å…¶ä»–çš„ç»†èŠ‚ã€‚&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;ä¸è¿‡ï¼Œè¿™æ ·å­çš„æ”¹åŠ¨è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œè®© go å®˜æ–¹æ¥å—è¿™ç§è®¾è®¡ï¼Œåº”è¯¥è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ï¼Œä»¥åæ²¡å‡†å¯ä»¥è¯•è¯•ï¼Œä¸‡ä¸€æ¥å—äº†å‘¢~&lt;/p&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;p&gt;&lt;strong&gt;ä¹ã€ç›¸å…³é“¾æ¥&lt;br/&gt;&lt;/strong&gt;&lt;/p&gt;&lt;/section&gt;&lt;section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;section&gt;&lt;svg viewbox=&quot;0 0 1 1&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;span&gt;[1] cgo å®ç°æœºåˆ¶ï¼š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;em&gt;&lt;span&gt;https://uncledou.site/2021/go-cgo/&lt;/span&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;[2]Â &lt;span&gt;Goroutine è°ƒåº¦ - ç½‘ç»œè°ƒç”¨ï¼š&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;em&gt;&lt;span&gt;https://uncledou.site/2021/goroutine-schedule-network/&lt;/span&gt;&lt;/em&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;[3]Â &lt;span&gt;CL 392854 :&lt;/span&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;em&gt;&lt;span&gt;https://go-review.googlesource.com/c/go/+/392854&lt;/span&gt;&lt;/em&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;&lt;strong&gt;Â &lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;Â æœ¬å‘¨æ¨èé˜…è¯»Â &lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;Â &lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUzMzU5Mjc1Nw==&amp;amp;mid=2247513902&amp;amp;idx=1&amp;amp;sn=be00c5af2e9775a4039430bf187e16f4&amp;amp;chksm=faa358f4cdd4d1e23d7e9c93b4a94d6e6c377f51eb5e96b6dd5f74b840e48ebd3f518c4bf80a&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;538&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;229&quot; data-ratio=&quot;0.4255555555555556&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/nibOZpaQKw0icVic2YozAVFT3Glnb0kGOm9Itgia880Ug1iaAMicZVsrccXmGLmDPkIYRezMRcICZo7h84W0wVoVabvA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;span&gt;MOSNÂ åå‘é€šé“è¯¦è§£&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUzMzU5Mjc1Nw==&amp;amp;mid=2247512138&amp;amp;idx=1&amp;amp;sn=851abb8d07d47f703e33978c9c125c59&amp;amp;chksm=faa35f90cdd4d6869c6cd4934c042484dbe1063c3fb85462d2f33e936b96240ae33d02d18c3a&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;538&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;229&quot; data-ratio=&quot;0.4255555555555556&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/nibOZpaQKw0ib6ocxPJUcdDfHVIL3niax97WtwdyHsicym5kbOAGaZlXEesshLic6uK6SMkh2X3xRHFAGWkKibITVdKg/640?wx_fmt=png&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;span&gt;&lt;span&gt;Go åŸç”Ÿæ’ä»¶ä½¿ç”¨é—®é¢˜å…¨è§£æ&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUzMzU5Mjc1Nw==&amp;amp;mid=2247516046&amp;amp;idx=1&amp;amp;sn=c8ed0fbbc18b4377778c2ed06c7332ba&amp;amp;chksm=faa35054cdd4d9425b6780ae5ed1a6b83ab16afd9d870affba350c8002a2c4e2efdb85abc603&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;11&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot; hasload=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;578&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;246&quot; data-ratio=&quot;0.4255555555555556&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/nibOZpaQKw08VNbtYZicic5Nog5MV3VxrPUKQaiakOMvYf25J0xpOzIRCoicGHWor1G3liaOn4ibVEuOKHVAc3HuoibbCw/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;jpeg&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;span&gt;Go å†…å­˜æ³„æ¼ï¼Œpprof å¤Ÿç”¨äº†ä¹ˆï¼Ÿ&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzUzMzU5Mjc1Nw==&amp;amp;mid=2247516354&amp;amp;idx=1&amp;amp;sn=804c45c191a9e319d4a47135e301f91a&amp;amp;chksm=faa36f18cdd4e60e445dd9b4acfe51e40e2060349199e6160811ca069c2c54270d42ec0ca2b7&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;â€â€&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;11&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;538&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;229&quot; data-ratio=&quot;0.4255555555555556&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/nibOZpaQKw0icJDEQVeM5ibuaTdsYLgTOfSBhic5Ule6GK401ibJX7XuBGz4RV02AicSTHkg8Jw5BicCKNEsck478h8oA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p data-recommend-title=&quot;t&quot; data-mid=&quot;&quot;&gt;&lt;span&gt;ä»è§„æ¨¡åŒ–å¹³å°å·¥ç¨‹å®è·µï¼Œæˆ‘ä»¬å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-recommend-type=&quot;normal&quot; data-recommend-tid=&quot;1&quot; data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;section data-mid=&quot;&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.8148148148148148&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/nibOZpaQKw084tjDIkMOl22S8SFeCHHuZwaf4pQdLma9LNCwTSjtUcZBa4H6GoxvmvctKW4KcCFtuHYsm2tic4ZQ/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-w=&quot;1080&quot;/&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>5ee89c09de1dccdefdedf6b5eafa7a34</guid>
<title>OpenJDK çš„ Amber é¡¹ç›®å¯¹ Java å…¥å£ç±»çš„ä¿®æ”¹æ–¹å‘</title>
<link>https://toutiao.io/k/8rfhzod</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div id=&quot;v_desc&quot; class=&quot;video-desc-v1&quot; data-v-220c9cc3=&quot;&quot;&gt;&lt;p class=&quot;desc-info desc-v2&quot;&gt;&lt;span class=&quot;desc-info-text&quot;&gt;Oracle çš„ Java è¯­è¨€æ¶æ„å¸ˆ Brian Goetz å‘å¸ƒäº† OpenJDK çš„ Amber é¡¹ç›®çš„æ–°çš„è®¾è®¡ç¬”è®°ï¼Œæ ‡é¢˜æ˜¯ Paving the on-rampã€‚è¯¥ç¬”è®°é˜è¿°äº† Amber é¡¹ç›®ä¼šå¯¹ Java ç¨‹åºä¸­çš„æ‰§è¡Œå…¥å£ç±»æ‰€åšçš„ä¿®æ”¹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p report-id=&quot;abstract_unspread&quot; class=&quot;toggle-btn&quot;&gt;&lt;span&gt;æ”¶èµ·&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>