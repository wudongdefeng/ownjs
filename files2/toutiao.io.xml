<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>a653996147d109e2bf83be1b5d991785</guid>
<title>ç½‘ç»œç¼–ç¨‹æ€ä¹ˆåšæ‰ç®—æ˜¯ä¼˜é›…ï¼Ÿ</title>
<link>https://toutiao.io/k/zylzzpi</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-backh=&quot;174&quot; data-backw=&quot;365&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4767123287671233&quot; data-type=&quot;gif&quot; data-w=&quot;365&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/cvQbJDZsKLp6wejHtKTRbqqQyt0wMk9K1wNtuwRqQTJAPOJ1KiaqSeSRbIJRTicVicKpDKRndBodY2DBNN20tvWwA/640?wx_fmt=gif&quot;/&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;åŸåˆ›ï¼šå°å§å§å‘³é“ï¼ˆå¾®ä¿¡å…¬ä¼—å·IDï¼šxjjdogï¼‰ï¼Œæ¬¢è¿åˆ†äº«ï¼Œè½¬è½½è¯·ä¿ç•™å‡ºå¤„ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ®è¯´ï¼Œweb2.0çš„é­…åŠ›åœ¨äºç”±é™æ€èµ„æºå˜æˆäº¤äº’æ€§èµ„æºï¼Œweb3.0çš„é­…åŠ›åœ¨äºå…¶å»ä¸­å¿ƒåŒ–çš„èµ„æºï¼Œå¤§å®¶éƒ½å¯ä»¥å‚ä¸å…¶ä¸­å¾—äº«æ—¶ä»£çš„ç¦åˆ©ã€‚ä½†æ˜¯ï¼Œæ— è®ºä¸Šå±‚æ¦‚å¿µç©çš„å†èŠ±å“¨ï¼Œæœ€ä¸‹å±‚çš„é€šä¿¡è¿˜æ˜¯åŸºäºweb1.0æ‰€å½¢æˆçš„æŠ€æœ¯ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬çš„ç»ˆæç›®æ ‡ï¼Œå…¶å®å°±æ˜¯æ‰“ç€å»ä¸­å¿ƒåŒ–çš„åä¹‰ï¼Œåšå®é™…ä¸Šçš„ä¸­å¿ƒåŒ–ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“æµé‡å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼Œç½‘ç»œç¼–ç¨‹ä¼šå‘ç”Ÿå„ç§æ€ªå¼‚çš„åœºæ™¯ã€‚ä¸‹é¢å°†ä»¥åå‡ ä¸ªå®é™…çš„æ¡ˆä¾‹ï¼Œæ¥è¯´æ˜xjjdogå¹³å¸¸åœ¨å·¥ä½œä¸­é‡åˆ°çš„ä¸ç½‘ç»œç›¸å…³çš„é«˜é¢‘é—®é¢˜ï¼Œå¸Œæœ›èƒ½å¤ŸåŠ©ä½ ä¸€è‡‚ä¹‹åŠ›ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;1. å¤§é‡å®¢æˆ·ç«¯ä¸Šçº¿æ³¨æ„èº²é¿&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ— è®ºä½ çš„æœåŠ¡å™¨èƒ½åŠ›å¤šå¼ºï¼Œåœ¨å¤§æ‰¹é‡è¿æ¥åˆ°æ¥ï¼Œè¿›è¡Œä¸šåŠ¡æœåŠ¡çš„æ—¶å€™ï¼Œéƒ½ä¼šäº§ç”Ÿç¬æ—¶çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ çš„MQTTæœåŠ¡å™¨è¿æ¥äº†å‡ åä¸‡å°è®¾å¤‡ã€‚å½“ä½ çš„MQTTæœåŠ¡å™¨å®•æœºé‡å¯çš„æ—¶å€™ï¼Œå°±è¦æ¥å—å‡ åä¸‡çš„å¹¶å‘ï¼Œè¿™å‡ ä¹æ²¡æœ‰ä»»ä½•æœåŠ¡èƒ½å¤Ÿå—å¾—äº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨xjjdogä»¥å¾€çš„ç»éªŒä¸­ï¼Œå› ä¸ºæœåŠ¡ç«¯é‡å¯é—®é¢˜è€Œé€ æˆçš„é˜»å¡äº‹æ•…ï¼Œæ•°ä¸èƒœæ•°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªåœºæ™¯ï¼Œå…¶å®å’Œç¼“å­˜çš„å‡»ç©¿æ¦‚å¿µéå¸¸çš„ç›¸ä¼¼ã€‚å½“ç¼“å­˜ä¸­çš„çƒ­ç‚¹æ•°æ®é›†ä¸­å¤±æ•ˆçš„æ—¶å€™ï¼Œè¯·æ±‚å°±ä¼šå…¨éƒ¨å‡»ç©¿åˆ°æ•°æ®åº“å±‚é¢ï¼Œé€ æˆé—®é¢˜ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4798807749627422&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;1342&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLr2VuKPZxnONlCFrhAIg0Agc6t3LlnbibUrKk6UCDUnCzAfqntNh0mz60QcMVpNHaDPMFfyDp0aj5A/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚ä¸Šå›¾ï¼Œè§£å†³ç¼“å­˜å‡»ç©¿é—®é¢˜å°±æ˜¯ç»™æ¯ä¸ªkeyåŠ ä¸ªå¤±æ•ˆæ—¶é—´çš„éšæœºå€¼ï¼Œè®©å®ƒä»¬ä¸è¦åœ¨åŒä¸€æ—¶é—´å¤±æ•ˆã€‚ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¢æˆ·ç«¯é‡è¿æœåŠ¡ç«¯çš„æ—¶å€™ï¼ŒåŠ ä¸Šä¸€ä¸ªéšæœºçš„æ—¶é—´ã€‚éšæœºæ•°æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå®ƒèƒ½è®©æˆ‘ä»¬çš„æµ·é‡è¿æ¥åœ¨éšæœºæ—¶é—´çª—å£å†…ä¿æŒç±»çº¿æ€§çš„å¢é•¿ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;2. å¤šç½‘å¡é˜Ÿåˆ—&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨ç±»ä¼¼openstackç­‰è™šæ‹Ÿå¹³å°ä¸Šå‡è®¾çš„è™šæ‹Ÿæœºï¼Œå¾€å¾€å› ä¸ºç½‘å¡èƒ½åŠ›ä¸å¼ºè€Œé€ æˆæµé‡åœ¨è¾¾åˆ°ä¸€å®šç¨‹åº¦ä¹‹åï¼ŒæœåŠ¡å‘ç”Ÿå¡é¡¿ã€‚è¿™æ˜¯å› ä¸ºå•ä¸ªcpuåœ¨å¤„ç†ä¸­æ–­æ—¶ï¼Œäº§ç”Ÿäº†ç“¶é¢ˆã€‚é€šè¿‡dstatæˆ–è€…iftopå‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰çš„ç½‘ç»œæµé‡ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4381551362683438&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;954&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLraeg3qV1NqYqicNYpXMukH2HSibZc6bRbZyvIKzHKsczuuwpRuviamELTCT78oUQaUkmZzLnvPXricYQ/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¯”å¦‚ï¼ŒKafkaæ–°æœºå™¨ä¸Šçº¿ä¹‹åï¼Œä¼šè¿›è¡Œå¤§è§„æ¨¡çš„æ•°æ®æ‹·è´ï¼Œè¿™ä¸ªæ—¶å€™å¦‚æœä½ å»pingç›¸å…³çš„æœºå™¨ï¼Œä¼šå‘ç°pingå€¼å˜çš„éå¸¸å¤§ã€‚åŒæ—¶ï¼Œ&lt;code&gt;Recv-Q&lt;/code&gt;å’Œ&lt;code&gt;Send-Q&lt;/code&gt;çš„å€¼ä¹Ÿä¼šå¢å¤§ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦å¼€å¯ç½‘å¡å¤šé˜Ÿåˆ—æ¨¡å¼ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½¿ç”¨&lt;code&gt;ethtool&lt;/code&gt;å¯ä»¥çœ‹åˆ°ç½‘å¡çš„é˜Ÿåˆ—ä¿¡æ¯ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;ethtoolÂ -lÂ eth0Â |Â grepÂ &lt;span&gt;&#x27;Combined&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;Combined:Â 1&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“ç„¶ï¼Œé€šè¿‡ä¸‹é¢çš„å‘½ä»¤ï¼Œå¯ä»¥å¢åŠ ç½‘å¡çš„é˜Ÿåˆ—ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;ethtoolÂ -LÂ eth0Â combinedÂ 2&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å»ºè®®åŒæ—¶å¼€å¯ä¸­æ–­å¹³è¡¡æœåŠ¡ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;systemctlÂ startÂ irqbalance&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;3. ä¸å®šæ—¶çš„åˆ‡æ–­ä¸€ä¸‹é•¿è¿æ¥&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿æ¥ä¸Šäº†ï¼Œå¹¶ä¸€ç›´ä¿æŒè¿æ¥ä¸å…³é—­å¯¹æ–¹ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€æ¡é•¿è¿æ¥ã€‚é•¿è¿æ¥å¯ä»¥é¿å…é¢‘ç¹çš„è¿æ¥åˆ›å»ºæ‰€äº§ç”Ÿçš„å¼€é”€ã€‚ä»HTTP1åˆ°HTTP2å†åˆ°HTTP3ï¼Œä¸€ç›´åœ¨å‘å‡å°‘è¿æ¥ï¼Œå¤ç”¨è¿æ¥æ–¹é¢å»åŠªåŠ›ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé•¿è¿æ¥æ˜¯ç¬¬ä¸€é€‰æ‹©ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä½†æœ‰ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬å¸Œæœ›é•¿è¿æ¥å¹¶ä¸è¦ä¸€ç›´åœ¨é‚£é‡Œä¿æŒç€ï¼Œéœ€è¦ç»™å®ƒå¢åŠ TTLã€‚è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨è´Ÿè½½å‡è¡¡åœºæ™¯é‡Œã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¯”å¦‚LVSã€HAProxyç­‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœåç«¯æœ‰Aã€Bã€Cä¸‰å°æœºå™¨ï¼Œç»è¿‡LVSè´Ÿè½½ä¹‹åï¼Œ90æ¡è¿æ¥è¢«åˆ†æ•£åˆ°ä¸‰å°æœºå™¨ã€‚ä½†æŸä¸ªæ—¶åˆ»ï¼ŒAå®•æœºäº†ï¼Œå®ƒæ‰€æŒæœ‰çš„30ä¸ªè¿æ¥å°±ä¼šè¢«é‡æ–°è´Ÿè½½åˆ°Bã€Cä¸Šï¼Œè¿™æ—¶å€™å®ƒä»¬éƒ½æŒæœ‰45æ¡è¿æ¥ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“Aé‡å¯ä¹‹åï¼Œå®ƒå´å†ä¹Ÿæ‹¿ä¸åˆ°æ–°çš„è¿æ¥ã€‚å¦‚æœLVSè¿ç®—ä¸€æ¬¡å†å¹³è¡¡çš„è¯ï¼Œäº§ç”Ÿçš„å½±å“ä¹Ÿæ¯”è¾ƒå¤§ã€‚æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›åˆ›å»ºçš„é•¿è¿æ¥èƒ½å¤Ÿæœ‰ä¸€ä¸ªç”Ÿå­˜æ—¶é•¿çš„å±æ€§ï¼Œåœ¨æŸä¸ªæ—¶é—´é—´éš”å†…è¾¾åˆ°æ¸è¿›å¼çš„å†å¹³è¡¡ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;4. k8sç«¯å£èŒƒå›´&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†k8så’Œåˆ«çš„ç¨‹åºä¸èµ·å†²çªï¼Œé»˜è®¤ç«¯å£çš„èŒƒå›´æ˜¯ 30000-32767ã€‚å¦‚æœä½ åœ¨ä½¿ç”¨k8så¹³å°ï¼Œé…ç½®äº†nodeportä½†æ˜¯æ— æ³•è®¿é—®åˆ°ï¼Œè¦æ³¨æ„æ˜¯ä¸æ˜¯è®¾ç½®çš„ç«¯å£å·å¤ªå°äº†ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;5. TIME_WAIT&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;TIME_WAITæ˜¯ä¸»åŠ¨å…³é—­è¿æ¥çš„ä¸€æ–¹ä¿æŒçš„çŠ¶æ€ï¼Œåƒnginxã€çˆ¬è™«æœåŠ¡å™¨ï¼Œç»å¸¸å‘ç”Ÿå¤§é‡å¤„äºtime_waitçŠ¶æ€çš„è¿æ¥ã€‚TCPä¸€èˆ¬åœ¨ä¸»åŠ¨å…³é—­è¿æ¥åï¼Œä¼šç­‰å¾…2MSï¼Œç„¶åå½»åº•å…³é—­è¿æ¥ã€‚ç”±äºHTTPä½¿ç”¨äº†TCPåè®®ï¼Œæ‰€ä»¥åœ¨è¿™äº›é¢‘ç¹å¼€å…³è¿æ¥çš„æœåŠ¡å™¨ä¸Šï¼Œå°±ç§¯å‹äº†éå¸¸å¤šçš„TIME_WAITçŠ¶æ€è¿æ¥ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸäº›ç³»ç»Ÿé€šè¿‡dmesgå¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä¿¡æ¯ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;__ratelimit:Â 2170Â callbacksÂ suppressed&lt;br/&gt;TCP:Â timeÂ &lt;span&gt;wait&lt;/span&gt;Â bucketÂ tableÂ overflow&lt;br/&gt;TCP:Â timeÂ &lt;span&gt;wait&lt;/span&gt;Â bucketÂ tableÂ overflow&lt;br/&gt;TCP:Â timeÂ &lt;span&gt;wait&lt;/span&gt;Â bucketÂ tableÂ overflow&lt;br/&gt;TCP:Â timeÂ &lt;span&gt;wait&lt;/span&gt;Â bucketÂ tableÂ overflow&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;sysctlå‘½ä»¤å¯ä»¥è®¾ç½®è¿™äº›å‚æ•°ï¼Œå¦‚æœæƒ³è¦é‡å¯ç”Ÿæ•ˆçš„è¯ï¼ŒåŠ å…¥/etc/sysctl.confæ–‡ä»¶ä¸­ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;&lt;span&gt;#Â ä¿®æ”¹é˜ˆå€¼&lt;/span&gt;&lt;br/&gt;net.ipv4.tcp_max_tw_bucketsÂ =Â 50000Â &lt;br/&gt;&lt;span&gt;#Â è¡¨ç¤ºå¼€å¯TCPè¿æ¥ä¸­TIME-WAITÂ socketsçš„å¿«é€Ÿå›æ”¶&lt;/span&gt;&lt;br/&gt;net.ipv4.tcp_tw_reuseÂ =Â 1&lt;br/&gt;&lt;span&gt;#å¯ç”¨timewait å¿«é€Ÿå›æ”¶ã€‚è¿™ä¸ªä¸€å®šè¦å¼€å¯ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ã€‚&lt;/span&gt;&lt;br/&gt;net.ipv4.tcp_tw_recycle=Â 1Â Â Â &lt;br/&gt;&lt;span&gt;#Â ä¿®æ”¹ç³»çµ±é»˜è®¤çš„TIMEOUTæ—¶é—´,é»˜è®¤æ˜¯60s&lt;/span&gt;&lt;br/&gt;net.ipv4.tcp_fin_timeoutÂ =Â 10&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æµ‹è¯•å‚æ•°çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ sysctl -w net.ipv4.tcp_tw_reuse = 1 è¿™æ ·çš„å‘½ä»¤ã€‚å¦‚æœæ˜¯å†™å…¥è¿›æ–‡ä»¶çš„ï¼Œåˆ™ä½¿ç”¨sysctl -pç”Ÿæ•ˆã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;6. CLOSE_WAIT&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;CLOSE_WAITä¸€èˆ¬æ˜¯ç”±äºå¯¹ç«¯ä¸»åŠ¨å…³é—­ï¼Œè€Œæˆ‘æ–¹æ²¡æœ‰æ­£ç¡®å¤„ç†çš„åŸå› å¼•èµ·çš„ã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯ç¨‹åºå†™çš„æœ‰é—®é¢˜ï¼Œå±äºå±å®³æ¯”è¾ƒå¤§çš„ä¸€ç§ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¤§å®¶éƒ½çŸ¥é“TCPçš„è¿æ¥æ˜¯ä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ï¼Œè¿™æ˜¯ç”±äºTCPè¿æ¥å…è®¸å•å‘å…³é—­ã€‚&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1.0374707259953162&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;427&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLraeg3qV1NqYqicNYpXMukH2Hic8Rj6p5VFicDO6n01u1CNMWO3db3SdCibKMqOz8u3yv9wOicoWyS5sPQ/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚å›¾ï¼Œå½“ä¸€ä¸ªè¿æ¥å‘èµ·ä¸»åŠ¨å…³é—­ä¹‹åï¼Œå®ƒå°†è¿›å…¥fin_wait_1çŠ¶æ€ã€‚åŒæ—¶ï¼Œæ”¶åˆ°finæŠ¥æ–‡çš„è¢«åŠ¨å…³é—­æ–¹ï¼Œè¿›å…¥close_waitçŠ¶æ€ï¼Œç„¶åå›å¤ackåï¼Œä¸»åŠ¨å…³é—­æ–¹è¿›å…¥fin_wait_2çŠ¶æ€ã€‚è¿™å°±æ˜¯å•å‘çš„å…³é—­ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ­¤æ—¶ï¼Œå¦‚æœè¢«åŠ¨å…³é—­æ–¹å› ä¸ºæŸäº›åŸå› ï¼Œæ²¡æœ‰å‘é€finæŠ¥æ–‡ç»™ä¸»åŠ¨å…³é—­æ–¹ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šä¸€ç›´å¤„äºclose_waitçŠ¶æ€ã€‚æ¯”å¦‚ï¼Œæ”¶åˆ°äº†EOFä½†æ²¡æœ‰å‘èµ·closeæ“ä½œã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ˜¾ç„¶ï¼Œè¿™å¤šæ•°æ˜¯ä¸€ç§ç¼–ç¨‹bugï¼Œåªèƒ½é€šè¿‡ä»£ç reviewæ¥è§£å†³ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;7. ä¸€ä¸ªè¿›ç¨‹èƒ½å¤Ÿæ‰“å¼€çš„ç½‘ç»œè¿æ¥&lt;/h2&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.4233576642335766&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;685&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/cvQbJDZsKLraeg3qV1NqYqicNYpXMukH2hIibPMZfiaXutYUhHiaqpYdg2bKY24g6Nj96l0KpdV7JUC1041pEO0Aiag/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Linuxå³ä½¿æ”¾å¼€ä¸€ä¸ªç«¯å£ï¼Œèƒ½å¤Ÿæ¥å—çš„è¿æ¥ä¹Ÿæ˜¯æµ·é‡çš„ã€‚è¿™äº›è¿æ¥çš„ä¸Šé™ï¼Œå—åˆ°å•è¿›ç¨‹æ–‡ä»¶å¥æŸ„æ•°é‡å’Œæ“ä½œç³»ç»Ÿæ–‡ä»¶å¥æŸ„æ•°é‡çš„é™åˆ¶ï¼Œä¹Ÿå°±æ˜¯ulimitå’Œfile-maxã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸ºäº†èƒ½å¤Ÿå°†å‚æ•°ä¿®æ”¹æŒä¹…åŒ–ï¼Œæˆ‘ä»¬å€¾å‘äºå°†æ”¹åŠ¨å†™å…¥åˆ°æ–‡ä»¶é‡Œã€‚è¿›ç¨‹çš„æ–‡ä»¶å¥æŸ„é™åˆ¶ï¼Œå¯ä»¥æ”¾åœ¨&lt;code&gt;/etc/security/limits.conf&lt;/code&gt;ä¸­ï¼Œå®ƒçš„ä¸Šé™å—åˆ°&lt;code&gt;fs.nr_open&lt;/code&gt;çš„åˆ¶çº¦ï¼›æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶å¥æŸ„é™åˆ¶ï¼Œå¯ä»¥æ”¾åˆ°&lt;code&gt;/etc/sysctl.conf&lt;/code&gt;æ–‡ä»¶ä¸­ã€‚æœ€åï¼Œåˆ«å¿˜äº†åœ¨&lt;code&gt;/proc/$id/limits&lt;/code&gt;æ–‡ä»¶ä¸­ï¼Œç¡®è®¤ä¿®æ”¹æ˜¯å¦å¯¹è¿›ç¨‹ç”Ÿæ•ˆäº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;/etc/security/limits.confé…ç½®æ¡ˆä¾‹ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;rootÂ softÂ nofileÂ 1000000&lt;br/&gt;rootÂ hardÂ nofileÂ 1000000&lt;br/&gt;*Â softÂ nofileÂ 1000000&lt;br/&gt;*Â hardÂ nofileÂ 1000000&lt;br/&gt;esÂ Â -Â Â nofileÂ Â 65535&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;8. SO_KEEPALIVE&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœå°†è¿™ä¸ªSocketé€‰é¡¹æ‰“å¼€ï¼Œå®¢æˆ·ç«¯Socketæ¯éš”æ®µçš„æ—¶é—´ï¼ˆå¤§çº¦ä¸¤ä¸ªå°æ—¶ï¼‰å°±ä¼šåˆ©ç”¨ç©ºé—²çš„è¿æ¥å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªæ•°æ®åŒ…ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªæ•°æ®åŒ…å¹¶æ²¡æœ‰å…¶å®ƒçš„ä½œç”¨ï¼Œåªæ˜¯ä¸ºäº†æ£€æµ‹ä¸€ä¸‹æœåŠ¡å™¨æ˜¯å¦ä»å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœæœåŠ¡å™¨æœªå“åº”è¿™ä¸ªæ•°æ®åŒ…ï¼Œåœ¨å¤§çº¦11åˆ†é’Ÿåï¼Œå®¢æˆ·ç«¯Socketå†å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¦‚æœåœ¨12åˆ†é’Ÿå†…ï¼ŒæœåŠ¡å™¨è¿˜æ²¡å“åº”ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯Socketå°†å…³é—­ã€‚å¦‚æœå°†Socketé€‰é¡¹å…³é—­ï¼Œå®¢æˆ·ç«¯Socketåœ¨æœåŠ¡å™¨æ— æ•ˆçš„æƒ…å†µä¸‹å¯èƒ½ä¼šé•¿æ—¶é—´ä¸ä¼šå…³é—­ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;9. SO_REUSEADDRæ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“æˆ‘ä»¬åœ¨ç½‘ç»œå¼€å‘æ—¶ï¼Œæ—¶å¸¸ä¼šç¢°åˆ°&lt;code&gt;address already in use&lt;/code&gt;çš„å¼‚å¸¸ï¼Œè¿™æ˜¯ç”±äºå…³é—­åº”ç”¨ç¨‹åºæ—¶ï¼Œè¿˜æœ‰å¯¹åº”ç«¯å£çš„ç½‘ç»œè¿æ¥å¤„äº&lt;code&gt;TIME_WAIT&lt;/code&gt;çŠ¶æ€è€Œé€ æˆçš„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;TIME_WAITçŠ¶æ€é€šå¸¸ä¼šæŒç»­ä¸€æ®µæ—¶é—´ï¼ˆ2MLï¼‰ï¼Œè®¾ç½®SO_REUSEADDRå¯ä»¥æ”¯æŒå¿«é€Ÿç«¯å£å¤ç”¨ï¼Œæ”¯æŒåº”ç”¨çš„å¿«é€Ÿé‡å¯ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;10. å¥åº·æ£€æŸ¥é‡‡ç”¨åº”ç”¨å¿ƒè·³&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;tcpè‡ªèº«çš„keepalivedæœºåˆ¶éå¸¸çš„é¸¡è‚‹ï¼Œå®ƒé™æ‚„æ‚„çš„åœ¨åº•å±‚è¿è¡Œï¼Œæ— æ³•äº§ç”Ÿåº”ç”¨å±‚çš„è¯­ä¹‰ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨æˆ‘ä»¬çš„æƒ³è±¡é‡Œï¼Œè¿æ¥å°±åº”è¯¥æ˜¯ä¸€æ¡çº¿ã€‚ä½†å…¶å®ï¼Œå®ƒåªæ˜¯2ä¸ªç‚¹ï¼Œè€Œä¸”æ¯æ¬¡èµ°çš„è·¯å¾„éƒ½å¯èƒ½ä¸ä¸€æ ·ã€‚ä¸€ä¸ªç‚¹ï¼Œéœ€è¦åœ¨å‘å‡ºå¿ƒè·³åŒ…ç„¶åæ”¶åˆ°å›å¤ä¹‹åï¼Œæ‰èƒ½çŸ¥é“å¯¹æ–¹æ˜¯å¦å­˜æ´»ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;tcpè‡ªå¸¦çš„å¿ƒè·³æœºåˆ¶ï¼Œä»…ä»…èƒ½çŸ¥é“å¯¹æ–¹æ˜¯å¦å­˜æ´»ï¼Œå¯¹äºæœåŠ¡æ˜¯å¦å¯ç”¨ï¼Œå¥åº·çŠ¶å†µè¿™äº›ä¸œè¥¿ä¸€æ¦‚ä¸çŸ¥ï¼Œè€Œä¸”è¶…æ—¶é…ç½®å¸¸å¸¸ä¸è¶…æ—¶é‡ä¼ æœºåˆ¶ç›¸å†²çªã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰€ä»¥ï¼Œæœ‰ç¡®åˆ‡å«ä¹‰çš„åº”ç”¨å±‚å¿ƒè·³æ˜¯å¿…è¦çš„ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;11. SO_LINGER&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªSocketé€‰é¡¹å¯ä»¥å½±å“closeæ–¹æ³•çš„è¡Œä¸ºã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“è°ƒç”¨closeæ–¹æ³•åï¼Œå°†ç«‹å³è¿”å›ï¼›å¦‚æœè¿™æ—¶ä»ç„¶æœ‰æœªè¢«é€å‡ºçš„æ•°æ®åŒ…ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®åŒ…å°†è¢«ä¸¢å¼ƒã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœå°†lingerå‚æ•°è®¾ä¸ºä¸€ä¸ªæ­£æ•´æ•°næ—¶ï¼ˆnçš„å€¼æœ€å¤§æ˜¯65ï¼Œ535ï¼‰ï¼Œåœ¨è°ƒç”¨closeæ–¹æ³•åï¼Œå°†æœ€å¤šè¢«é˜»å¡nç§’ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨è¿™nç§’å†…ï¼Œç³»ç»Ÿå°†å°½é‡å°†æœªé€å‡ºçš„æ•°æ®åŒ…å‘é€å‡ºå»ï¼›å¦‚æœè¶…è¿‡äº†nç§’ï¼Œå¦‚æœè¿˜æœ‰æœªå‘é€çš„æ•°æ®åŒ…ï¼Œè¿™äº›æ•°æ®åŒ…å°†å…¨éƒ¨è¢«ä¸¢å¼ƒï¼›è€Œcloseæ–¹æ³•ä¼šç«‹å³è¿”å›ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœå°†lingerè®¾ä¸º0ï¼Œå’Œå…³é—­SO_LINGERé€‰é¡¹çš„ä½œç”¨æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;12. SO_TIMEOUT&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥é€šè¿‡è¿™ä¸ªé€‰é¡¹æ¥è®¾ç½®è¯»å–æ•°æ®è¶…æ—¶ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å½“è¾“å…¥æµçš„readæ–¹æ³•è¢«é˜»å¡æ—¶ï¼Œå¦‚æœè®¾ç½®timeoutï¼ˆtimeoutçš„å•ä½æ˜¯æ¯«ç§’ï¼‰ï¼Œé‚£ä¹ˆç³»ç»Ÿåœ¨ç­‰å¾…äº†timeoutæ¯«ç§’åä¼šæŠ›å‡ºä¸€ä¸ªInterruptedIOExceptionä¾‹å¤–ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨æŠ›å‡ºä¾‹å¤–åï¼Œè¾“å…¥æµå¹¶æœªå…³é—­ï¼Œä½ å¯ä»¥ç»§ç»­é€šè¿‡readæ–¹æ³•è¯»å–æ•°æ®ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;13. SO_SNDBUFï¼ŒSO_RCVBUF&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾“å‡ºæµçš„å‘é€ç¼“å†²åŒºæ˜¯8096ä¸ªå­—èŠ‚ï¼ˆ8Kï¼‰ã€‚è¿™ä¸ªå€¼æ˜¯Javaæ‰€å»ºè®®çš„è¾“å‡ºç¼“å†²åŒºçš„å¤§å°ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœè¿™ä¸ªé»˜è®¤å€¼ä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œå¯ä»¥ç”¨setSendBufferSizeæ–¹æ³•æ¥é‡æ–°è®¾ç½®ç¼“å†²åŒºçš„å¤§å°ã€‚ä½†æœ€å¥½ä¸è¦å°†è¾“å‡ºç¼“å†²åŒºè®¾å¾—å¤ªå°ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¼ è¾“æ•°æ®è¿‡äºé¢‘ç¹ï¼Œä»è€Œé™ä½ç½‘ç»œä¼ è¾“çš„æ•ˆç‡ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;14. SO_OOBINLINE&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚æœè¿™ä¸ªSocketé€‰é¡¹æ‰“å¼€ï¼Œå¯ä»¥é€šè¿‡Socketç±»çš„sendUrgentDataæ–¹æ³•å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªå•å­—èŠ‚çš„æ•°æ®ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªå•å­—èŠ‚æ•°æ®å¹¶ä¸ç»è¿‡è¾“å‡ºç¼“å†²åŒºï¼Œè€Œæ˜¯ç«‹å³å‘å‡ºã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è™½ç„¶åœ¨å®¢æˆ·ç«¯å¹¶ä¸æ˜¯ä½¿ç”¨OutputStreamå‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œä½†åœ¨æœåŠ¡ç«¯ç¨‹åºä¸­è¿™ä¸ªå•å­—èŠ‚çš„æ•°æ®æ˜¯å’Œå…¶å®ƒçš„æ™®é€šæ•°æ®æ··åœ¨ä¸€èµ·çš„ã€‚å› æ­¤ï¼Œåœ¨æœåŠ¡ç«¯ç¨‹åºä¸­å¹¶ä¸çŸ¥é“ç”±å®¢æˆ·ç«¯å‘è¿‡æ¥çš„æ•°æ®æ˜¯ç”±OutputStreamè¿˜æ˜¯ç”±sendUrgentDataå‘è¿‡æ¥çš„ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;End&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘éå¸¸æƒŠè®¶çš„å‘ç°ï¼Œç°åœ¨æœ‰äº›ç½‘ç»œç¯å¢ƒï¼Œä¾ç„¶è¿˜æ˜¯åƒå…†ç½‘å¡ï¼ŒåŒ…æ‹¬ä¸€äº›æ¯”è¾ƒä¸“ä¸šçš„æµ‹è¯•ç¯å¢ƒã€‚å½“åœ¨è¿™äº›ç¯å¢ƒä¸Šè¿›è¡Œå®é™…çš„å‹æµ‹æ—¶ï¼Œå½“æµé‡çªç ´äº†ç½‘å¡çš„é™åˆ¶ï¼Œåº”ç”¨å“åº”å°†ä¼šå˜çš„å¼‚å¸¸ç¼“æ…¢ã€‚è®¡ç®—æœºç³»ç»Ÿæ˜¯ä¸€ä¸ªæ•´ä½“ï¼ŒCPUã€å†…å­˜ã€ç½‘ç»œã€IOï¼Œä»»ä½•ä¸€ç¯å‡ºç°ç“¶é¢ˆï¼Œéƒ½ä¼šé€ æˆé—®é¢˜ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç½‘ç»œæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å› ç´ ã€‚ä½†ç”±äºå®ƒç›¸å¯¹æ¥è¯´æ¯”è¾ƒåº•å±‚ï¼Œæ‰€ä»¥å¤§å¤šæ•°å¼€å‘å¯¹å…¶äº†è§£è¾ƒå°‘ã€‚åŠ ä¸Šç°åœ¨å„ç§äº‘åŸç”Ÿç»„ä»¶çš„æµè¡Œï¼Œæ¥è§¦è¿™äº›åº•å±‚è®¾æ–½çš„æœºä¼šå°±è¶Šæ¥è¶Šå°‘ã€‚ä½†å¦‚æœç³»ç»ŸçœŸçš„å‘ç”Ÿäº†é—®é¢˜ï¼Œåœ¨æ’é™¤æ‰å…¶ä»–æœ€å¯èƒ½å‡ºé—®é¢˜çš„ç»„ä»¶åï¼Œåƒä¸‡åˆ«å¿˜äº†--&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿˜æœ‰ç½‘ç»œè¿™ä¸€æ‘Šå­ç­‰ç€ä½ ã€‚&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;ä½œè€…ç®€ä»‹ï¼š&lt;strong&gt;å°å§å§å‘³é“&lt;/strong&gt; Â (xjjdog)ï¼Œä¸€ä¸ªä¸å…è®¸ç¨‹åºå‘˜èµ°å¼¯è·¯çš„å…¬ä¼—å·ã€‚èšç„¦åŸºç¡€æ¶æ„å’ŒLinuxã€‚åå¹´æ¶æ„ï¼Œæ—¥ç™¾äº¿æµé‡ï¼Œä¸ä½ æ¢è®¨é«˜å¹¶å‘ä¸–ç•Œï¼Œç»™ä½ ä¸ä¸€æ ·çš„å‘³é“ã€‚æˆ‘çš„ä¸ªäººå¾®ä¿¡xjjdog0ï¼Œæ¬¢è¿æ·»åŠ å¥½å‹ï¼Œè¿›ä¸€æ­¥äº¤æµã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>03fb19fb375df98ccc4c58eb045db125</guid>
<title>å·ç‹ä¹‹ç‹ã€‚</title>
<link>https://toutiao.io/k/hj0898g</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;weui-dialog&quot;&gt;
      &lt;p class=&quot;weui-dialog__hd&quot;&gt;&lt;strong class=&quot;weui-dialog__title&quot;&gt;&quot;Top Stories&quot; is disabled&lt;/strong&gt;&lt;/p&gt;
      &lt;p class=&quot;weui-dialog__bd&quot;&gt;
        Enable &quot;Top Stories&quot; in &quot;Settings&quot; &amp;gt; &quot;General&quot; &amp;gt; &quot;Manage Discover&quot;      &lt;/p&gt;
      
    &lt;/div&gt;
  &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>fa300ff38391a94dd17be3bc3be89ab1</guid>
<title>SpringBoot çƒ­éƒ¨ç½²ç¥å™¨å¿«é€Ÿé‡å¯çš„ç§˜å¯†ï¼</title>
<link>https://toutiao.io/k/8b5fv5e</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»Šå¤©å’±ä»¬æ¥èŠèŠè¿™ä¸ªçƒ­éƒ¨ç½²ç¥å™¨Â &lt;strong&gt;spring-boot-devtools&lt;/strong&gt;Â çš„è¿è¡ŒåŸç†ï¼Œçœ‹çœ‹å®ƒæ˜¯æ€ä¹ˆç”¨è¿™ä¸ª &lt;strong&gt;ClassLoader&lt;/strong&gt; Â æ¥å®ç°å¿«é€Ÿé‡å¯ï¼Œå¸®æˆ‘ä»¬èŠ‚çœæ—¶é—´çš„ï¼ğŸ˜&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;æ–‡ç« æ¦‚è¦&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ–‡ç« çš„ä¸»æ—‹å¾‹å¦‚ä¸‹ğŸ‘‡&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3611111111111111&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOIBho3dOxx0npRP8uWLm534FvCqjMTJHfLAQRcraEfmFThWgicicq27Cg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;576&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;spring.factories&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬ç›´æ¥æ‰“å¼€ &lt;strong&gt;spring-boot-devtools&lt;/strong&gt; æºç  ï¼Œæ‰¾åˆ° &lt;strong&gt;spring.factories&lt;/strong&gt; æ–‡ä»¶ï¼š&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.42812006319115326&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOSMo7WFNVggRgnvEqY9L6EOXPW0cughQRQqwW7hJAnmn9t6mcjMAeCA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1266&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬ä¸€èˆ¬éƒ½æœ¬åœ°å¼€å‘è°ƒè¯•çš„ï¼Œæ‰€ä»¥å°±ç›´æ¥çœ‹è¿™ä¸ª &lt;strong&gt;LocalDevToolsAutoConfiguration&lt;/strong&gt; ç±»å•¦ğŸ˜‹&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;LocalDevToolsAutoConfiguration&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥çœ‹åˆ°æ ¸å¿ƒç‚¹åœ¨ &lt;strong&gt;é‡å¯å’Œé‡è½½&lt;/strong&gt; ğŸ‘‡&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5916824196597353&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOMVkHCHRjPcOmjWMJygpJaTtOa6LmicReLcr3m9KOaSjrryAyWnEz19g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1058&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ä¸»è§’ğŸ‘‡&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5021037868162693&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOv9tLibOljS5CuRbXDEKGickNbPOZAz1tGibCuVs3980wib60Hzj3qibvCXw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;713&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ª &lt;strong&gt;é‡å¯&lt;/strong&gt; ä¸­æœ‰ä»€ä¹ˆå­ğŸ˜„&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;é‡å¯åŸç†ä»‹ç»&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¤§æ¦‚è¿™ä¹ˆä¸€ä¸ªæ€è·¯ğŸ‘‡ ä¸‹é¢å°±è·Ÿç€æºç åˆ†æå•¦ğŸ˜„ï¼ˆ&lt;strong&gt;æ–‡æœ«æœ‰æºç é‡å¯è¦ç‚¹æµç¨‹å›¾&lt;/strong&gt;ï¼‰&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6090686274509803&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOj0m7l3tJKV9Sdl9xan0H30VhicZJkuN8jy0ibaticIQtetYUemgMKTM4Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;816&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;RestartConfiguration&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ‰è¿™ä¹ˆäº›æ–¹æ³•ğŸ‘‡&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6709183673469388&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgODw7zwpMMgezyXDYMlLuVxNp86dMpGAv1sox3hJVmMpYIkRL5qK9pSw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;784&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä»åå­—ä¸Šåˆ†æï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åº”è¯¥æ˜¯é‡ç‚¹ï¼Œé€»è¾‘ä¸Šåº”è¯¥æ˜¯ æœ‰ä¸€ä¸ª &lt;strong&gt;watcher&lt;/strong&gt; åœ¨ç›¯ç€ &lt;strong&gt;classpath&lt;/strong&gt; ï¼Œå¦‚æœæœ‰å˜åŠ¨çš„è¯ï¼Œå°±è§¦å‘è¿™ä¸ª &lt;strong&gt;ClassPathChangedEvent&lt;/strong&gt; äº‹ä»¶ ğŸ˜&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‚£ä¹ˆçœ‹çœ‹è¿™ä¸ª &lt;strong&gt;watcher&lt;/strong&gt; å­ ğŸ˜„&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ClassPathFileSystemWatcher&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2476290832455216&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOHdfob8717g30kS4EeOlaZwPNMRPfqLB7dsIJdM2k5o9ZZj7T3YJhvA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;949&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥çœ‹åˆ°è¿™é‡Œå°±åˆ›å»ºäº†è¿™ä¸ª &lt;strong&gt;ClassPathFileSystemWatcher&lt;/strong&gt; ç±» ğŸ‘‡&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3411016949152542&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOwwGN4mvDTliazWY4UpTM7LJBZARqsPiauibJZcZZXKmmVNcOVxenjzMzQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;944&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œæˆ‘ä»¬æ³¨æ„åˆ°å®ƒå®ç°äº†ä¸‰ä¸ªæ¥å£ï¼Œç»è¿‡å‰é¢ &lt;strong&gt;Spring&lt;/strong&gt; æ–‡ç« çš„å­¦ä¹ ï¼Œå’±ä»¬çŸ¥é“ç¬¬ä¸€æ­¥å°±è¯¥çœ‹å•¥äº†ğŸ˜„&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ ¹æ®ç±»çš„åˆå§‹åŒ–ï¼Œå…ˆçœ‹çœ‹æœ‰ &lt;strong&gt;static&lt;/strong&gt; ç›¸å…³çš„ä»£ç æ²¡ï¼Œæ¥ç€çœ‹ &lt;strong&gt;æ„é€ å™¨&lt;/strong&gt; ï¼Œæœ€åå°±æ¥åˆ°è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³• &lt;strong&gt;afterPropertiesSet&lt;/strong&gt; å•¦ğŸ˜„&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œæ²¡æœ‰ &lt;strong&gt;static&lt;/strong&gt; æ–¹æ³•ï¼Œæ„é€ å™¨ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯è·å– &lt;strong&gt;FileSystemWatcherFactory&lt;/strong&gt; Â ï¼Œ&lt;strong&gt;ClassPathRestartStrategy&lt;/strong&gt; å’Œ ç›‘è§†çš„æ–‡ä»¶è·¯å¾„ï¼Œé‚£ä¹ˆå°±çœ‹çœ‹ &lt;strong&gt;afterPropertiesSet&lt;/strong&gt; å†™äº†ä»€ä¹ˆå­ ğŸ‘‡&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2799208704253215&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgO5xurUpTOBGmqncpYEK3QsN1MsPcjGicNN82sh1PFOL9ND23X46gM3lw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1011&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ClassPathFileChangeListener&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™ä¸ªä¹Ÿä¸å¤æ‚ï¼Œå°±ç›‘å¬åˆ°æ–‡ä»¶æ”¹å˜åï¼Œå‘å¸ƒäº‹ä»¶ &lt;strong&gt;ClassPathChangedEvent&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6427860696517413&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOHopJRkxUEfKVxkfJiblibzyH6dAHjncZbkaiaA7pFibtx0xianY8GMZPsuw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1005&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;FileSystemWatcher&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¥ç€å°±æ˜¯è¿™ä¸ª &lt;strong&gt;start&lt;/strong&gt; æ–¹æ³•å•¦ğŸ‘‡&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¾ˆæ˜æ˜¾å°±æ˜¯å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå’±ä»¬æ¥çœ‹çœ‹çº¿ç¨‹ä¸­åˆ°åº•åœ¨ &lt;strong&gt;run&lt;/strong&gt; ä»€ä¹ˆğŸ·&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5205078125&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOJYx3pKLVDzG9Vp6DBVkOpVsibRejza5adLvb3UygYaD4fYxp7DXQ7tw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1024&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ‰¾åˆ°è¿™ä¸ªä»»åŠ¡ç±» &lt;strong&gt;Watcher&lt;/strong&gt; ğŸ‘‡&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7388888888888889&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOcEOa4icGhMnFXxloaPTvvrnIDV7Yn31sBlPibyUdg8TlhlGbZiaBjzb3g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;900&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥å‘ç°å®ƒçš„ä»»åŠ¡å°±æ˜¯ä¸€ç›´ &lt;strong&gt;scan&lt;/strong&gt; ï¼Œ&lt;strong&gt;pollInterval&lt;/strong&gt; é»˜è®¤æ˜¯ &lt;strong&gt;1s&lt;/strong&gt; ï¼Œ&lt;strong&gt;quietPeriod&lt;/strong&gt; é»˜è®¤æ˜¯ &lt;strong&gt;0.4s&lt;/strong&gt;&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;æ„æ€æ˜¯æ¯æ¬¡è½®è¯¢çš„æ—¶é—´æ˜¯ &lt;strong&gt;1s&lt;/strong&gt; ï¼ŒåŒ…å«ä¸­é—´ä¼‘æ¯çš„ &lt;strong&gt;0.4s&lt;/strong&gt; ï¼Œä¼‘æ¯äº‹ä»¶æ˜¯æ¥ç¡®è®¤æ–‡ä»¶åœ¨è¿™ä¸ªæœŸé—´æ²¡æœ‰å†æ¬¡è¢«æ”¹åŠ¨ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ”¹åŠ¨äº†çš„è¯ä¼šå›è°ƒ &lt;strong&gt;FileChangeListener&lt;/strong&gt; çš„ &lt;strong&gt;onChange&lt;/strong&gt; ï¼Œå¯¹åº”æˆ‘ä»¬ä¸Šé¢çš„è¿™ä¸ª &lt;strong&gt;ClassPathFileChangeListener&lt;/strong&gt; ï¼Œä¼šå»å‘å¸ƒäº‹ä»¶ &lt;strong&gt;ClassPathChangedEvent&lt;/strong&gt; ğŸ˜‹&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ApplicationListener&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»•äº†ä¸€å¤§åœˆï¼Œç»ˆäºæè¿°å®Œäº†è¿™ä¸ªç›‘è§†å™¨ &lt;strong&gt;ClassPathFileSystemWatcher&lt;/strong&gt; ï¼ŒåŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¾—æŠŠç›®å…‰ç§»åˆ°è¿™ä¸ª&lt;strong&gt;RestartConfiguration&lt;/strong&gt; çš„ç¬¬äºŒä¸ªæ ¸å¿ƒ &lt;strong&gt;ç›‘å¬å™¨&lt;/strong&gt; ğŸ‘‡&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚å›¾æ‰€ç¤ºï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨å°±æ˜¯&lt;strong&gt;é‡å¯åº”ç”¨ restart&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.20310880829015543&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOW4vzVibdcLW5Slvs0poxcPJojUGQYkjnGpo0oFulK4Lk4I1wJTibSiaGg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;965&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;é‡å¯åº”ç”¨&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‡å¯çš„è¿‡ç¨‹ä¸­å‘¢ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€æ­¥ &lt;strong&gt;stop&lt;/strong&gt; ï¼Œç¬¬äºŒæ­¥ &lt;strong&gt;start&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;stop&lt;/strong&gt; éƒ¨åˆ†å°±æ˜¯æ¯ç­è¿™äº›ä¸œè¥¿äº†ï¼Œè¿™é‡Œä¹Ÿè—äº†å¾ˆå¤šç»†èŠ‚ï¼Œæœ‰å¾ˆå¤šå¹¶å‘ç›¸å…³çš„çŸ¥è¯†ç‚¹ ğŸ˜‹&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ¯”å¦‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸€. &lt;strong&gt;ReentrantLock&lt;/strong&gt; Â æ˜¯å†™åœ¨ &lt;strong&gt;try catch&lt;/strong&gt; çš„é‡Œé¢è¿˜æ˜¯å¤–é¢ï¼Ÿ&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;äºŒ. å¾ªç¯é‡Œçš„ &lt;strong&gt;rootContexts&lt;/strong&gt; å…¶å®æ˜¯ &lt;strong&gt;CopyOnWriteArrayList&lt;/strong&gt; ç±»å‹çš„&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸‰. é€šè¿‡å¼ºåˆ¶çš„ &lt;strong&gt;OOM&lt;/strong&gt; æ¥æ¸…é™¤æ‰€æœ‰çš„ &lt;strong&gt;è½¯/å¼±å¼•ç”¨&lt;/strong&gt; (ğŸ˜± è¿˜æœ‰è¿™ç§æ“ä½œçš„ï¼)&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.638676844783715&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOWgfLvzCOtXdjjoMCNN8a2SxHkBmRGTED10pFOvWe58w9VnODb9crNw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;786&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨ &lt;strong&gt;start&lt;/strong&gt; çš„è¿‡ç¨‹ä¸­ï¼Œæ˜¯é€šè¿‡åˆ›å»ºè¿™ä¸ª&lt;strong&gt;é‡å¯çº¿ç¨‹&lt;/strong&gt; &lt;strong&gt;RestartLauncher&lt;/strong&gt; æ¥å®ç°çš„ï¼Œå¯ä»¥å‘ç°è¯¥ç±»çš„ä»»åŠ¡å°±æ˜¯æ‰¾åˆ° &lt;strong&gt;mainclass&lt;/strong&gt; å¹¶è°ƒç”¨ &lt;strong&gt;main&lt;/strong&gt; æ–¹æ³•ï¼Œå®Œæˆé‡å¯ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.28982300884955753&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOs7XvSUnMUqNQwbIeSGoTmJkWgcG1dzoQjPtxp7nONF1D76qI6iceiccQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;904&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå°±æ¶‰åŠåˆ°è¿™ä¸ª &lt;strong&gt;classloader&lt;/strong&gt; å•¦ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ClassLoader&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç»†å¿ƒçš„å°ä¼™ä¼´å¯ä»¥å‘ç°ä¸Šé¢è¿™è¡Œä»£ç ä¸­ï¼Œè°ƒç”¨åˆ°äº†è¿™ä¸ª &lt;strong&gt;ClassLoader&lt;/strong&gt; ï¼Œè¿™ä¸ª &lt;strong&gt;getContextClassLoader()&lt;/strong&gt; æ˜¯å±äº &lt;strong&gt;Thread&lt;/strong&gt; ç±»çš„ï¼Œé€šè¿‡å®ƒå¯ä»¥è·å–åˆ°å½“å‰çº¿ç¨‹ä¸Šä¸‹æ–‡çš„ &lt;strong&gt;ClassLoader&lt;/strong&gt; ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;Class.forName(this.mainClassName,Â &lt;span&gt;false&lt;/span&gt;,Â getContextClassLoader());&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨åˆ›å»ºè¿™ä¸ª &lt;strong&gt;RestartLauncher&lt;/strong&gt; çº¿ç¨‹æ—¶ï¼Œå°±å·²ç»å°†å’±ä»¬è¿™ä¸ª &lt;strong&gt;RestartClassLoader&lt;/strong&gt; Â ç»™ä¼ è¿›æ¥äº†ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.2573454913880446&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOHSiaB6vyv9xKEH34MSiccUwPJr35odlEWA3At2IkTaXyXvjmbqviajLPw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;987&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.29514824797843664&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOHX9X6YPBKWIGOaWTqn65BrH2F2t6LqUTJ2hEgXa9WyR2Dffa0gQslw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;742&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‡å¯æ—¶ï¼Œå°±ç›´æ¥é€šè¿‡ &lt;strong&gt;RestartClassLoader&lt;/strong&gt; Â å»æ‰¾åˆ° &lt;strong&gt;main&lt;/strong&gt; æ–¹æ³•ï¼Œå®Œæˆé‡å¯ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5336225596529284&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgO35OAYbCnI57V4Xeial8MsGMhlCnslEgV5bFCEZPSLHxuSn5lUhic1w6Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;922&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;å¾ˆæ˜æ˜¾è¿™é‡Œ &lt;strong&gt;ç ´åäº†åŒäº²å§”æ´¾æœºåˆ¶ï¼Œå…ˆä»è‡ªèº«æŸ¥æ‰¾ï¼Œæ²¡æœ‰çš„è¯å†å»çˆ¶ç±»æŸ¥æ‰¾&lt;/strong&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿™é‡Œ &lt;strong&gt;ä¸šåŠ¡ä»£ç &lt;/strong&gt; éƒ½è¢« &lt;strong&gt;RestartClassLoader&lt;/strong&gt; åŠ è½½äº†ï¼Œè€Œæ¯æ¬¡é‡å¯éƒ½ä¼šé‡æ–°åˆ›å»ºè¿™ä¸ª &lt;strong&gt;RestartClassLoader&lt;/strong&gt; Â ï¼Œç„¶åå»åŠ è½½ä¸šåŠ¡ä»£ç  ğŸ– ï¼ˆé€šè¿‡ä¼ è¿›æ¥çš„ &lt;strong&gt;URL&lt;/strong&gt; Â å¯ä»¥å‘ç°ï¼‰&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é‚£ä¹ˆåˆ°æ­¤ï¼Œè¿™ä¸ª &lt;strong&gt;é‡å¯&lt;/strong&gt; çš„è¿‡ç¨‹å°±å®Œæˆäº†ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å·®ç‚¹å¿˜äº†ï¼Œè¿™é‡Œè¿˜æœ‰ä¸ªé»˜è®¤çš„ç›‘è§†èŒƒå›´ğŸ·&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;ç›‘è§†ç­–ç•¥&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¦‚ä¸‹å›¾ğŸ‘‡ é»˜è®¤ç­–ç•¥ä¸­ï¼Œè¿™äº›è·¯å¾„ä¸‹çš„æ–‡ä»¶å˜åŒ–&lt;strong&gt;ä¸è¢«æ£€æµ‹&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.3897216274089936&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOdShgfL1Lia3fHmpPTclgcYpTibnbCeQf77P1He9MJAwUlqoIsiau3ePJA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;934&quot;/&gt;&lt;figcaption&gt;image-20210920230435492&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯é€šè¿‡é…ç½®ä¿®æ”¹&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;Â spring.devtools.restart.exclude=static/**,public/**&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;æ€»ç»“&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é€šè¿‡é˜…è¯»æºç ï¼Œæˆ‘ä»¬çŸ¥é“äº† &lt;strong&gt;spring-boot-devtools&lt;/strong&gt; æ˜¯é€šè¿‡è‡ªå®šä¹‰ &lt;strong&gt;RestartClassLoader&lt;/strong&gt; Â æ¥åŠ è½½ä¸šåŠ¡ä»£ç ï¼Œå¹¶åœ¨é‡å¯æ—¶é”€æ¯å®ƒï¼Œå†é‡æ–°åˆ›å»ºï¼Œè¿›è€Œé‡æ–°è·å–ä»£ç ï¼Œå®ç°è¿™ä¸ªå¿«é€Ÿé‡å¯çš„ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è€Œå…¶ä»– &lt;strong&gt;jar&lt;/strong&gt; åŒ…ç­‰ç”±å¦å¤–çš„ &lt;strong&gt;ClassLoader&lt;/strong&gt; Â åŠ è½½ï¼Œä¸å—å½±å“ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŒæ—¶ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ° Spring äº‹ä»¶æœºåˆ¶ æ— å¤„ä¸åœ¨çš„èº«å½±ï¼Œè¿˜æœ‰å„ç§åˆå§‹åŒ–çš„æ“ä½œï¼Œä»¥åŠ&lt;strong&gt;çº¿ç¨‹ï¼Œå¹¶å‘ï¼Œé”&lt;/strong&gt;åœ¨é‡å¯è¿‡ç¨‹ä¸­çš„ä½¿ç”¨ï¼Œè¿™äº›å°±éœ€è¦å°ä¼™ä¼´ä»¬æ‰“å¼€æºç è‡ªèº«æ„Ÿå—äº†ï¼Œå¦‚ &lt;strong&gt;å®ˆæŠ¤çº¿ç¨‹&lt;/strong&gt;ï¼Œ&lt;strong&gt;ReentrantLock&lt;/strong&gt; ï¼Œ&lt;strong&gt;CopyOnWriteArrayList&lt;/strong&gt; ï¼Œ&lt;strong&gt;CountDownLatch&lt;/strong&gt; ï¼Œç”šè‡³ &lt;strong&gt;OOM&lt;/strong&gt; éƒ½èƒ½è¿™ä¹ˆç”¨ï¼&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¿˜æœ‰ &lt;strong&gt;é‡å¯&lt;/strong&gt; åŸæ¥å°±æ˜¯ &lt;strong&gt;åå°„è°ƒç”¨ main æ–¹æ³•&lt;/strong&gt; å‘€ğŸ·&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;é‡å¯è¿‡ç¨‹æºç è¦ç‚¹&lt;span/&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6621923937360179&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgOSprdN2BC7DwThL09t34S5g1qPqDCh42qzMibGlPaKETH5JpjyxGicIOA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;894&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6382289416846653&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/zIjiaGEEKdYFdHbCxgHsUmyeCc38jrTgORuc9Tt8ibWiaF5mragdDzwib6wicbpuiaznzGvZW0rfmHBN3x9BoBRbHB2A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;926&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>e8970c5f3344cca54af5485ce79b403b</guid>
<title>æ·±å…¥æµ…å‡ºSparkï¼šå­˜å‚¨ç³»ç»Ÿ</title>
<link>https://toutiao.io/k/s1aizd7</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section&gt;&lt;section&gt;&lt;span&gt;ä½œè€… | å´ç£Š&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ç­–åˆ’ | é™ˆæ€&lt;/span&gt;&lt;/section&gt;&lt;section&gt;
&lt;strong&gt;ä¸“é¢˜ä»‹ç»&lt;/strong&gt;:2009 å¹´ï¼ŒSpark è¯ç”ŸäºåŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„ AMP å®éªŒå®¤ï¼ˆthe Algorithms, Machines and People labï¼‰ï¼Œå¹¶äº 2010 å¹´å¼€æºã€‚2013 å¹´ï¼ŒSpark æçŒ®ç»™é˜¿å¸•å¥‡è½¯ä»¶åŸºé‡‘ä¼šï¼ˆApache Software Foundationï¼‰ï¼Œå¹¶äº 2014 å¹´æˆä¸º Apache é¡¶çº§é¡¹ç›®ã€‚å¦‚ä»Šï¼Œåå¹´å…‰æ™¯å·²è¿‡ï¼ŒSpark æˆä¸ºäº†å¤§å¤§å°å°ä¼ä¸šä¸ç ”ç©¶æœºæ„çš„å¸¸ç”¨å·¥å…·ä¹‹ä¸€ï¼Œä¾æ—§æ·±å—ä¸å°‘å¼€å‘äººå‘˜çš„å–œçˆ±ã€‚å¦‚æœä½ æ˜¯åˆå…¥æ±Ÿæ¹–ä¸”å¸Œæœ›äº†è§£ã€å­¦ä¹  Spark çš„â€œå°è™¾ç±³â€ï¼Œé‚£ä¹ˆ InfoQ ä¸ FreeWheel æŠ€æœ¯ä¸“å®¶å´ç£Šåˆä½œçš„ä¸“é¢˜ç³»åˆ—æ–‡ç« â€”â€”ã€Šæ·±å…¥æµ…å‡º Sparkï¼šåŸç†è¯¦è§£ä¸å¼€å‘å®è·µã€‹ä¸€å®šé€‚åˆä½ ï¼æœ¬æ–‡ç³»ä¸“é¢˜ç³»åˆ—ç¬¬å››ç¯‡ã€‚&lt;/section&gt;&lt;p&gt;é¦–å…ˆæ„Ÿè°¢å„ä½çœ‹å®˜åœ¨ç™¾å¿™ä¹‹ä¸­æ¥å¬æˆ‘è¯´ä¹¦ï¼ŒçœŸæ˜¯å¤ªç»™é¢å­å•¦ï¼åœ¨å‰æ–‡ä¹¦ã€ŠSpark è°ƒåº¦ç³»ç»Ÿä¹‹æƒåŠ›çš„æ¸¸æˆã€‹ä¸­å’±ä»¬æåˆ° SparkContext çš„åˆå§‹åŒ–å°±åƒæ˜¯æ‰“å¼€äº†æ½˜å¤šæ‹‰çš„ç›’å­ï¼Œå®›å¦‚ä¸‰åå…­å¤©ç½¡ä¸´å‡¡ã€ä¸ƒåäºŒåœ°ç…é™ä¸–ï¼Œç¨³åèšä¹‰å…å¤´ä¸‰æŠŠäº¤æ¤…çš„æ˜¯ Spark è°ƒåº¦ç³»ç»Ÿçš„ä¸‰ä½å¤§ä½¬ã€‚ä¸‰ä½å¤§ä½¬é€šåŠ›é…åˆæœ€ç»ˆå°†ä»»åŠ¡ï¼ˆä»£ç ï¼‰åˆ†å‘åˆ° Executorï¼ŒExecutor åˆ™å°†åˆ†å¸ƒå¼ä»»åŠ¡å°è£…ä¸º TaskRunner å¹¶äº¤ç”±çº¿ç¨‹æ± æ‰§è¡Œã€‚&lt;/p&gt;&lt;p&gt;ç¬¼ç»Ÿåœ°è¯´ï¼Œä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹é€šå¸¸æ˜¯å°†æ•°æ®ä»ä¸€ç§å½¢æ€è½¬æ¢ä¸ºå¦ä¸€ç§å½¢æ€ï¼Œå¯¹äºè®¡ç®—æˆæœ¬è¾ƒé«˜çš„æ•°æ®å½¢æ€ï¼ŒSpark é€šè¿‡ç¼“å­˜æœºåˆ¶æ¥ä¿è¯ä½œä¸šçš„é¡ºåˆ©å®Œæˆï¼Œä»Šå¤©å’±ä»¬å°±æ¥è¯´è¯´ Spark çš„å­˜å‚¨ç³»ç»Ÿï¼Œçœ‹çœ‹ Spark å­˜å‚¨ç³»ç»Ÿå¦‚ä½•ä¸ºä»»åŠ¡çš„æ‰§è¡Œæä¾›åŸºç¡€ä¿éšœã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.472397476340694&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMRqxr7R3V2mwgMCGM3d4zDibUF4PHDNK8kc1H21G7vBBuUfSV8lAzH3A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;2536&quot;/&gt;&lt;span&gt;SparkContext åˆå§‹åŒ–&lt;/span&gt;&lt;/p&gt;&lt;p&gt;ä»»ä½•ä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿè¦è§£å†³çš„å…³é”®é—®é¢˜æ— éæ˜¯æ•°æ®çš„å­˜ä¸å–ã€æ”¶ä¸å‘ï¼Œä¸è¿‡ï¼Œåœ¨å»æ¢è®¨ Spark å­˜å‚¨ç³»ç»Ÿå¦‚ä½•å·¥ä½œä¹‹å‰ï¼Œå’±ä»¬å…ˆæ¥ææ¸…æ¥š Spark å­˜å‚¨ç³»ç»Ÿä¸­â€œå­˜â€çš„ä¸»è¦æ˜¯ä»€ä¹ˆå†…å®¹ï¼Ÿæ€»çš„æ¥è¯´ï¼ŒSpark å­˜å‚¨ç³»ç»Ÿç”¨äºå­˜å‚¨ 3 ä¸ªæ–¹é¢çš„æ•°æ®ï¼š&lt;/p&gt;&lt;p&gt;åœ¨å’±ä»¬è¿™å¥—ä¹¦ã€Šæ·±å…¥æµ…å‡º Sparkï¼šåŸç†è¯¦è§£ä¸å¼€å‘å®è·µã€‹ä¸­ï¼Œè¿™ 3 ä¸ªæ¦‚å¿µè¿˜æ˜¯å¤´ä¸€æ¬¡å‡ºç°ã€‚RDD ç¼“å­˜æŒ‡çš„æ˜¯å°† DAG ä¸­æŸäº›è®¡ç®—æˆæœ¬è¾ƒé«˜ä¸”è®¿é—®é¢‘ç‡è¾ƒé«˜çš„æ•°æ®å½¢æ€ä»¥ç¼“å­˜çš„å½¢å¼ç‰©åŒ–åˆ°å†…å­˜æˆ–ç£ç›˜çš„è¿‡ç¨‹ã€‚å¯¹äºè¡€ç»Ÿè¾ƒé•¿çš„ DAG æ¥è¯´ï¼ŒRDD ç¼“å­˜ä¸€æ¥å¯ä»¥é€šè¿‡æˆªæ–­ DAG ä»è€Œé™ä½å¤±è´¥é‡è¯•çš„å¼€é”€ï¼ŒäºŒæ¥é€šè¿‡ç¼“å­˜åœ¨å†…å­˜æˆ–ç£ç›˜ä¸­çš„æ•°æ®æ¥ä»æ•´ä½“ä¸Šæå‡ä½œä¸šçš„ç«¯åˆ°ç«¯æ‰§è¡Œæ€§èƒ½ã€‚&lt;/p&gt;&lt;p&gt;Shuffle çš„æ¦‚å¿µå’±ä»¬åœ¨ç¬¬äºŒç¯‡ã€Šæ·±å…¥æµ…å‡º Sparkï¼ˆäºŒï¼‰ï¼šDAGã€‹æœ‰ç®€å•çš„æåŠï¼Œä¸å¾—ä¸è¯´ï¼ŒShuffle æ˜¯ä¸ªè¶…çº§å¤§çš„è¯é¢˜ï¼Œä½œä¸ºç»å¤§å¤šæ•° Spark åº”ç”¨çš„æ€§èƒ½ç“¶é¢ˆæ‹…å½“ï¼Œå’±ä»¬åœ¨åæ–‡ä¹¦è¿˜ä¼šç»†è¯´ Spark å¦‚ä½•æå®š Shuffleã€‚å¦‚æœéè¦ç”¨ä¸€ä¸¤å¥è¯æ¥æç‚¼ï¼Œé‚£ä¹ˆ Shuffle çš„è¿‡ç¨‹åº”è¯¥æ˜¯ï¼š&lt;/p&gt;&lt;p&gt;Map é˜¶æ®µäº§ç”Ÿçš„æ•°æ®åˆ†ç‰‡ï¼Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªåå­—ï¼Œèªæ˜çš„æ‚¨ä¸€å®šçŒœåˆ°äº† â€”â€” æ²¡é”™ï¼å°±æ˜¯â€œShuffle ä¸­é—´ç»“æœâ€ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™äº›ä¸­é—´ç»“æœé»˜è®¤éƒ½æ˜¯å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„ï¼Œä¸è¿‡è¦æ˜¯æ‚¨ä¸å·®é’±ã€å†…å­˜éšä¾¿ç”¨ï¼Œæƒ³æŠŠè¿™äº›ä¸­é—´ç»“æœæ€¼åˆ°å†…å­˜é‡Œå»ä»è€Œæå‡ I/O æ•ˆç‡ï¼Œä¹Ÿæ˜¯æœ‰åŠæ³•çš„ï¼Œè¿™æ˜¯åè¯ï¼Œå’±ä»¬å›å¤´å†è¯´ã€‚&lt;/p&gt;&lt;p&gt;æœ€åè¯´è¯´å¹¿æ’­å˜é‡ï¼Œå¹¿æ’­å˜é‡çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†è§£å†³ Spark è°ƒåº¦ç³»ç»Ÿä¸­ä»»åŠ¡è°ƒåº¦çš„å¼€é”€é—®é¢˜ã€‚åœ¨å‰æ–‡ä¹¦å’±ä»¬æåˆ°ï¼ŒTask åˆ†å‘åˆ° Executor åï¼ŒExecutor ä¸­çš„çº¿ç¨‹æ± ä¼šå¹¶å‘åœ°æ‰§è¡Œå¤šä¸ª Taskã€‚å¯¹äºå¦‚ä¸‹è¿™æ®µä»£ç ï¼š&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;properties&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;val dict = List(â€œsparkâ€, â€œscalaâ€)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;val words = sparkContext.textFile(â€œ~/words.csvâ€)&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;val keywords = words.filter(word =&amp;gt; dict.contains(word))&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;keywords.map((_, 1)).reduceByKey(_ + _).collect&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;åªæœ‰ç¬¬ä¸€è¡Œå®šä¹‰ dict åˆ—è¡¨çš„ä»£ç æ˜¯åœ¨ Driver ç«¯æ‰§è¡Œï¼Œå…¶ä½™ 3 è¡Œä»£ç éƒ½åœ¨ Executor ç«¯è¿è¡Œã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œåœ¨ç¬¬ä¸‰è¡Œä»£ç ä¸­ï¼Œæ¯ä¸ªåˆ†å‘åˆ° Executor çš„ Task éƒ½ä¼šæ¶ˆè´¹ç¬¬ä¸€è¡Œå®šä¹‰çš„ dict åˆ—è¡¨ï¼Œåœ¨æ²¡æœ‰å¹¿æ’­å˜é‡æœºåˆ¶çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†å‘çš„ Task éƒ½ä¼šæºå¸¦ä¸€ä»½è¿™ä¸ªåˆ—è¡¨çš„æ‹·è´ï¼Œå¯¹äºä¸€ä¸ªçº¿ç¨‹æ± å¤§å°ä¸º 20 çš„ Executor æ¥è¯´ï¼Œè¿™æ„å‘³ç€åœ¨ä»»æ„æ—¶åˆ»è¯¥ Executor ä¸­éƒ½æœ‰ 20 ä»½åŒæ ·çš„æ•°æ®æ‹·è´ï¼Œæ¯«æ— ç–‘é—®ï¼Œè¿™ç§åˆ†å‘æ–¹å¼å¼•å…¥å¤§é‡ä¸å¿…è¦çš„ç½‘ç»œå’Œå­˜å‚¨å¼€é”€ã€‚&lt;/p&gt;&lt;p&gt;æ˜æ™ºçš„åšæ³•è‡ªç„¶æ˜¯æŠŠéœ€è¦å…±åŒè®¿é—®çš„æ•°æ®ä¸ Tasks å‰¥ç¦»å¼€æ¥ï¼Œè®©æ‰€æœ‰ Tasks ä»¥å…±äº«çš„æ–¹å¼è®¿é—®åŒä¸€ä»½æ•°æ®ã€‚å¹¿æ’­å˜é‡å°±æ˜¯åœ¨è¿™æ ·çš„èƒŒæ™¯ä¸‹è¯ç”Ÿçš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä½¿ç”¨å¹¿æ’­å˜é‡çš„å‰åå¯¹æ¯”ï¼Œå³å¯ä¸€ç›®äº†ç„¶åœ°ç†è§£å¹¿æ’­å˜é‡æœºåˆ¶å¦‚ä½•å¸®åŠ©ä»»åŠ¡åˆ†å‘é™ä½ç½‘ç»œä¸å­˜å‚¨å¼€é”€ã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.3723958333333333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMZfweYA35qocDLbZYM99htMQyTrKoaTyqDe3Jibicp064KLdnm97EibJlg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;å¹¿æ’­å˜é‡æœºåˆ¶ç”Ÿæ•ˆå‰åçš„ä»»åŠ¡åˆ†å‘å¯¹æ¯”&lt;/span&gt;&lt;/p&gt;&lt;p&gt;åœ¨å¹¿æ’­å˜é‡æœºåˆ¶ä¸‹ï¼ŒDriver ä¸­çš„ dict åˆ—è¡¨åœ¨æ¯ä¸ª Executor ä¸­ä»…åˆ†å‘ã€å­˜å‚¨ä¸€æ¬¡ã€‚å…·ä½“æ¥è¯´ï¼Œdict åˆ—è¡¨ä»¥å¹¿æ’­å˜é‡çš„å½¢å¼åˆ†å‘å¹¶å­˜å‚¨åˆ° Executor çš„ BlockManager ä¸­ï¼ŒExecutor ä¸­çš„å¤šä¸ª Tasks ä¸å†æŒæœ‰ dict åˆ—è¡¨æ‹·è´ï¼Œåœ¨éœ€è¦è¯»å– dict æ•°æ®æ—¶ï¼Œé€šè¿‡ BlockManager ä¸­å­˜å‚¨çš„å¹¿æ’­å˜é‡è¿›è¡Œè®¿é—®ã€‚å¹¿æ’­å˜é‡çš„æ”¶ç›Šæ˜¾è€Œæ˜“è§ï¼Œä¸€åˆ™æå‡å­˜å‚¨æ•ˆç‡ï¼ŒäºŒåˆ™å¤§å¹…é™ä½ç½‘ç»œå¼€é”€ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬å°†æ€ç»´å‘æ•£å‡ºå»ï¼Œå¹¿æ’­å˜é‡æ˜¯ä¸æ˜¯ä¹Ÿé€‚åˆå…¶ä»–éœ€è¦è€ƒè™‘å­˜å‚¨æ•ˆç‡å’Œç½‘ç»œå¼€é”€çš„åœºæ™¯å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;ä»‹ç»å®Œ 3 ç§å­˜å‚¨å¯¹è±¡ï¼Œå’±ä»¬å†æ”¶å›æ¥è¯´è¯´ Spark å­˜å‚¨ç³»ç»Ÿçš„åŸºæœ¬æ„æˆã€‚è¿˜è®°å¾—æ–¯å·´å…‹å›½é™…å»ºç­‘é›†å›¢å…¬å¸çš„æƒåŠ›æ´¾ç³»å—ï¼Ÿé©»æ‰åœ¨æ€»å…¬å¸çš„ BlockManagerMaster ä½œä¸ºç©ºé™æ´¾ä¸»è¦æˆå‘˜ï¼Œéšæ—¶å‘è€å¤§æˆ´æ ¼æ±‡æŠ¥å»ºç­‘ææ–™æ˜ç»†ï¼Œå½“ç„¶è¿™é‡Œçš„å»ºææŒ‡çš„ä¸ä»…ä»…æ˜¯åŸå§‹å»ºç­‘ææ–™å¦‚é’¢ç­‹ã€æ°´æ³¥ã€ç ‚çŸ³æ–™ï¼Œè¿˜å¯ä»¥æ˜¯ä»»æ„åŠ å·¥è¿‡çš„åŠæˆå“å¦‚æ¥¼æ¿ã€æ‰¿é‡å¢™é¢ç­‰ç­‰ã€‚BlockManagerMaster æ‰€æŒæ¡çš„ä¸€æ‰‹ä¿¡æ¯å‡æ¥è‡ªåˆ†å…¬å¸çš„ä¸‹å± â€”â€” BlockManagerã€‚æœ¬ç¯‡è¦è®²è¿°çš„ï¼Œå°±æ˜¯å¸ƒåŠ³å…‹ï¼ˆBlockManagerï¼‰å’Œä»–çš„å°å¼Ÿä»¬ä¹‹é—´çš„æ•…äº‹ã€‚&lt;/p&gt;&lt;section&gt;&lt;img data-ratio=&quot;0.3453125&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMbycXDkzp6cRJyM3bmbVDvHhPT8GoBJQYMgEpEJfCaePKqD9ZyRTuvQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;Spark åˆ†å¸ƒå¼ç³»ç»Ÿæ–°è€æ´¾ç³»æ„æˆ â€”â€” æ–°è€æ´¾ç³»çš„æ•…äº‹è¯·å‚è€ƒã€ŠSpark è°ƒåº¦ç³»ç»Ÿä¹‹æƒåŠ›çš„æ¸¸æˆã€‹&lt;/span&gt;&lt;/section&gt;&lt;section&gt;
&lt;span&gt;å­˜å‚¨å»ºæçš„ä»“åº“&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;æ— è®ºæ˜¯åŸææ–™è¿˜æ˜¯ä¸­é—´åŠ å·¥çš„åŠæˆå“ï¼Œè¿™äº›å½¢å½¢è‰²è‰²çš„æ•°æ®å½¢æ€éƒ½éœ€è¦æœ‰ä¸ªåœ°æ–¹â€œå­˜â€æ‰è¡Œï¼ŒSpark å­˜å‚¨ç³»ç»Ÿæä¾›äº†ä¸¤ç§å­˜å‚¨å®ç°ï¼Œåˆ†åˆ«æ˜¯å†…å­˜å­˜å‚¨ MemoryStore å’Œç£ç›˜å­˜å‚¨ DiskStoreã€‚ä»åå­—æˆ‘ä»¬å°±èƒ½çœ‹å‡ºæ¥ï¼ŒMemoryStore ç”¨äºå­˜å‚¨å†…å­˜ä¸­çš„æ•°æ®å—ï¼Œè€Œ DiskStore åˆ™ç”¨æ¥å­˜å‚¨ç£ç›˜ä¸­çš„æ•°æ®å—ã€‚&lt;/p&gt;&lt;p&gt;æ›´å½¢è±¡åœ°ï¼Œåœ¨æ–¯å·´å…‹å»ºç­‘é›†å›¢çš„åˆ†å…¬å¸ï¼ŒMemoryStore ç›¸å½“äºæ˜¯å»ºç­‘å·¥åœ°ä¸Šçš„ä¸´æ—¶å‚¨ç‰©ä»“åº“ï¼Œæ— è®ºæ˜¯å¾€é‡Œå­˜ç‰©æ–™è¿˜æ˜¯å¾€å¤–å–å»ºæéƒ½å¾ˆæ–¹ä¾¿ï¼Œä¸è¿‡ç¼ºç‚¹æ˜¯ä¸´æ—¶ä»“åº“ç©ºé—´æœ‰é™ï¼Œèƒ½è£…çš„ä¸œè¥¿å°‘ï¼›DiskStore åˆ™ä¸åŒï¼ŒDiskStore æ˜¯èƒ½å¤Ÿå®¹çº³æ‰€æœ‰å»ºæçš„ä¸“ç”¨ä»“å‚¨åŸºåœ°ï¼Œè¿™é‡Œåœ°å¤§ç‰©åšï¼Œç©ºé—´å¤§ã€å„ç§å»ºæåº”æœ‰å°½æœ‰ï¼Œä¸è¿‡ç¼ºç‚¹æ˜¯è·ç¦»å·¥åœ°å¤ªè¿œï¼Œæ¥å›å¾€è¿”è¿è¾“å»ºææ¯”è¾ƒéº»çƒ¦ï¼Œå¾—éœ€è¦å¤šè¾†ä¸“ç”¨çš„å¤§å‹è´§è½¦æ‰èƒ½åŠæ—¶åœ°ä¾›åº”å»ºç­‘å·¥åœ°çš„ä½œä¸šéœ€è¦ã€‚&lt;/p&gt;&lt;p&gt;è¯´å®Œâ€œåœ¨å“ªå„¿â€ï¼ˆWhereï¼‰å­˜ï¼Œå’±ä»¬å†æ¥è¯´è¯´ä¸åŒçš„æ•°æ®å½¢æ€ä»¥æ€æ ·çš„å½¢å¼å­˜å‚¨äº MemoryStore å’Œ DiskStoreã€‚&lt;/p&gt;&lt;p&gt;Spark æ”¯æŒä¸¤ç§æ•°æ®å­˜å‚¨å½¢å¼ï¼Œå³å¯¹è±¡å€¼å’Œå­—èŠ‚æ•°ç»„ï¼Œä¸”ä¸¤è€…ä¹‹é—´å¯ä»¥ç›¸äº’è½¬åŒ–ã€‚å°†å¯¹è±¡å€¼å‹ç¼©ä¸ºå­—èŠ‚æ•°ç»„çš„è¿‡ç¨‹ï¼Œç§°ä¸ºåºåˆ—åŒ–ï¼›ç›¸åï¼Œå°†å­—èŠ‚æ•°ç»„è¿˜åŸä¸ºå¯¹è±¡å€¼ï¼Œç§°ä¹‹ä¸ºååºåˆ—åŒ–ã€‚åºåˆ—åŒ–çš„å­—èŠ‚æ•°ç»„å°±åƒæ˜¯ä»å®œå®¶å®¶å…·è¶…å¸‚è´­ä¹°çš„å¾…ç»„è£…æ¿æï¼ˆå¤–åŠ ç»„è£…è¯´æ˜ä¹¦ï¼‰ï¼Œè€Œå¯¹è±¡å€¼åˆ™æ˜¯å°†æ¿ææ‹†åŒ…ã€å¹¶æ ¹æ®è¯´æ˜ä¹¦ç»„è£…è€Œæˆçš„å„ç§æ¡Œæ¤…æ¿å‡³ã€‚å¯¹è±¡å€¼çš„ä¼˜ç‚¹æ˜¯â€œæ‹¿æ¥å³ç”¨â€ã€æ‰€è§å³æ‰€å¾—ï¼Œç¼ºç‚¹æ˜¯æ‰€éœ€çš„å­˜å‚¨ç©ºé—´å¤§ã€å åœ°å„¿ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåºåˆ—åŒ–çš„å­—èŠ‚æ•°ç»„çš„ç©ºé—´åˆ©ç”¨ç‡è¦é«˜å¾—å¤šï¼Œä¸è¿‡è¦æ˜¯æ€¥ç”¨æ¡Œæ¤…æ¿å‡³çš„è¯ï¼Œè¿˜å¾—æ ¹æ®è¯´æ˜ä¹¦ç°è£…ï¼Œç•¥éº»çƒ¦ã€‚&lt;/p&gt;&lt;p&gt;ç”±æ­¤å¯è§ï¼ŒäºŒè€…çš„å…³ç³»æ˜¯ä¸€ç§åšå¼ˆï¼Œæ‰€è°“çš„â€œä»¥ç©ºé—´æ¢æ—¶é—´â€å’Œâ€œä»¥æ—¶é—´æ¢ç©ºé—´â€ï¼Œå…·ä½“çš„å–èˆè¿˜è¦çœ‹ä½¿ç”¨åœºæ™¯ï¼Œæƒ³çœåœ°å„¿ï¼Œæ‚¨å°±ç”¨å­—èŠ‚æ•°ç»„ï¼Œæƒ³ä»¥æœ€å¿«çš„é€Ÿåº¦è®¿é—®å¯¹è±¡ï¼Œå¯¹è±¡å€¼çš„å­˜å‚¨æ–¹å¼è¿˜æ˜¯æ¥çš„æ›´ç›´æ¥ä¸€äº›ã€‚ä¸è¿‡åƒè¿™ç§é€‰æ‹©çš„çƒ¦æ¼åªå­˜åœ¨äº MemoryStore ä¹‹ä¸­ï¼ŒDiskStore åªèƒ½å­˜åºåˆ—åŒ–åçš„å­—èŠ‚æ•°ç»„ â€”â€” è¿™é‡Œå’±ä»¬å¤šè¯´ä¸¤å˜´ï¼Œå‡¡æ˜¯éœ€è¦èµ°ç½‘ç»œæˆ–è½ç›˜çš„æ•°æ®ï¼Œéƒ½æ˜¯éœ€è¦åºåˆ—åŒ–çš„ã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.571875&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMTfv58ZXrCjRciarSrpic9aeI7nkOAHFlNNUFibf4KsH1os1bZYicxSrnWw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;ä»“åº“ç±»æ¯”ä¹‹ MemoryStore ä¸ DiskStore&lt;/span&gt;&lt;/p&gt;&lt;p&gt;å¾—ç›Šäºä¸´æ—¶å‚¨ç‰©ä»“åº“ï¼ˆMemoryStoreï¼‰å’Œä¸“ç”¨ä»“å‚¨åŸºåœ°ï¼ˆDiskStoreï¼‰ï¼Œæ–¯å·´å…‹çš„å„ä¸ªåˆ†å…¬å¸æš‚æ—¶è§£å†³äº†ä¸œè¥¿å­˜åœ¨å“ªå„¿çš„é—®é¢˜ï¼Œä¸è¿‡ï¼Œå…‰æœ‰ä»“åº“ä¹Ÿä¸è¡Œå•Šï¼Œæ€»å¾—è¦æœ‰äººæ‰“ç†ã€ç®¡ç†è¿™äº›ä»“åº“ï¼Œä¸ç„¶æ¥æ‹‰å–å»ºæçš„äººè¿æƒ³è¦çš„ä¸œè¥¿å…·ä½“æ”¾åœ¨å“ªä¸ªè´§æ¶éƒ½ä¸æ¸…æ¥šï¼Œæ€»ä¸èƒ½æ¯æ¬¡æ¥éƒ½ä»å¤´åˆ°å°¾æŠŠä»“åº“é€›ä¸ªéå§ã€‚&lt;/p&gt;&lt;p&gt;è¯´åˆ°åˆ†å…¬å¸çš„ç»„ç»‡æ¶æ„ï¼Œå»ºæéƒ¨çš„éƒ¨é—¨ç»ç†å¸ƒåŠ³å…‹ï¼ˆBlockManagerï¼‰å¯¹ä¸å»ºæå’Œåº“ç®¡æœ‰å…³çš„æ‰€æœ‰äº‹é¡¹è´Ÿè´£ï¼Œæ¯”å¦‚å»ºæç¼–å·ã€å»ºæå­˜å‚¨ã€å»ºææ‹‰å–ã€å»ºæè¿è¾“ã€å»ºæçŠ¶æ€ç»´æŠ¤ã€ä»“åº“ç®¡ç†ã€ä»“åº“ç»´æŠ¤ç­‰ç­‰ã€‚&lt;/p&gt;&lt;p&gt;ä¸è¿‡ï¼Œä½œä¸ºéƒ¨é—¨ç»ç†ï¼Œå—é™äºæ—¶é—´å’Œç²¾åŠ›æœ‰é™ï¼Œå¸ƒåŠ³å…‹è‡ªç„¶ä¸èƒ½äº‹å¿…èº¬äº²ï¼Œæ›´ä½•å†µä»–è¿˜è¦å¯¹è‡ªå·±çš„è€æ¿ï¼ˆæ€»å…¬å¸çš„ BlockManagerMasterï¼‰è´Ÿè´£ â€”â€” éšæ—¶æ±‡æŠ¥åˆ†å…¬å¸å»ºæä¸ä»“å‚¨çš„ä¿¡æ¯ä¸çŠ¶æ€ã€‚å¥½åœ¨å¸ƒåŠ³å…‹è¿˜æœ‰ä¸€ä¼—å°å¼Ÿä»¬æ¥å¸®ä»–æ‰“ç†å„ç§å…·ä½“äº‹åŠ¡ï¼Œä»…åº“å­˜ç®¡ç†å°±æœ‰ä¸¤ä¸ªå°å¼Ÿæ¥åˆ†åˆ«è´Ÿè´£å·¥åœ°çš„ä¸´æ—¶å‚¨ç‰©ä»“åº“å’Œä¸“ç”¨ä»“å‚¨åŸºåœ°ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼šBlockInfoManager å’Œ DiskBlockManagerã€‚&lt;/p&gt;&lt;p&gt;å…ˆè¯´ DiskBlockManagerï¼ŒDiskBlockManager çš„ä¸»è¦èŒè´£æ˜¯è®°å½•é€»è¾‘æ•°æ®å— Block ä¸ç£ç›˜æ–‡ä»¶ç³»ç»Ÿä¸­ç‰©ç†æ–‡ä»¶çš„å¯¹åº”å…³ç³»ã€‚æ¯ä¸ª Block éƒ½å¯¹åº”ä¸€ä¸ªç£ç›˜æ–‡ä»¶ï¼ŒåŒç†ï¼Œæ¯ä¸ªç£ç›˜æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ Block IDï¼Œè¿™å°±å¥½æ¯”ä»“åº“ä¸­çš„æ¯ä¸€ä»¶è´§ç‰©éƒ½æœ‰å”¯ä¸€çš„ ID æ ‡è¯†ï¼Œæ˜¾è€Œæ˜“è§ï¼ŒDiskBlockManager å°±æ˜¯ä¸“ç”¨ä»“å‚¨åŸºåœ° DiskStore çš„â€œåº“ç®¡â€ã€‚&lt;/p&gt;&lt;p&gt;å¯¹äºä»“åº“çš„ç®¡ç†ï¼ŒDiskBlockManager é¦–å…ˆæ ¹æ®ç”¨æˆ·é…ç½®å¦‚ spark.local.dir åˆ›å»ºå‡ºç”¨äºå­˜å‚¨æ–‡ä»¶çš„æ ¹ç›®å½•ï¼Œè¿™ä¸€æ­¥ç›¸å½“äºæ˜¯åœ¨ä»“åº“ä¸­æŠŠæ‰€éœ€çš„è´§æ¶éƒ½æå‰å‡†å¤‡å¥½ï¼›ç„¶åï¼Œæ ¹æ®å­˜å‚¨å†…å®¹ï¼ˆå¦‚ RDD ç¼“å­˜æˆ– Shuffle ä¸­é—´ç»“æœï¼‰çš„ä¸åŒï¼Œåˆ›å»ºä¸åŒå‰ç¼€çš„æ–‡ä»¶ï¼šRDD ç¼“å­˜ä¸ºâ€˜rdd_â€™ï¼ŒShuffle ä¸­é—´ç»“æœä¸ºâ€˜shuffle_â€™ï¼Œå¹¿æ’­å˜é‡æ˜¯â€˜broadcast_â€™ï¼Œåœ¨åˆ›å»ºæ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼ŒDiskBlockManager åŒæ—¶ç»´æŠ¤ Block ä¸æ–‡ä»¶ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼›æœ€åï¼Œå½“ä¸åŒç±»å‹çš„ä»»åŠ¡æ ¹æ® Block ID å°è¯•è·å–ã€è®¿é—®è¿™äº›æ•°æ®å—æ—¶ï¼ŒDiskBlockManager æ ¹æ®å¯¹åº”å…³ç³»æŸ¥æ‰¾ä¸è¯¥ Block ID å¯¹åº”çš„ç‰©ç†æ–‡ä»¶åœ°å€ã€‚&lt;/p&gt;&lt;p&gt;ç›¸è¾ƒäº DiskBlockManagerï¼ŒMemoryStoreâ€œåº“ç®¡â€BlockInfoManager å°±æ˜¾å¾—æ²¡é‚£ä¹ˆâ€œç§°èŒâ€ï¼Œå¯¹äº MemoryStore ä¸­å­˜å‚¨çš„æ•°æ®ï¼ŒBlockInfoManager çš„èŒè´£ä»…åŒ…å«å¦‚ä¸‹å„é¡¹ï¼šè®°å½•æ•°æ®å—å¤§å°ã€ç»´æŠ¤åŠ æŒåœ¨ Block ä¸Šçš„è¯»é”ä¸å†™é”ã€ç»´æŠ¤ä»»åŠ¡çš„è¯»å†™æƒé™çŠ¶æ€ã€‚ç®€è¨€ä¹‹ï¼ŒBlockInfoManager ä¸»è¦ç”¨äºä¿æŒ MemoryStore ä¸­æ•°æ®çŠ¶æ€çš„ä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯ç”¨äºç»´æŠ¤é€»è¾‘å—ä¸ç‰©ç†å­˜å‚¨çš„å¯¹åº”å…³ç³»ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæƒ³è¦æ‹‰å– MemoryStore ä¸­â€œè´§ç‰©â€çš„å¡è½¦å¸æœºæ€ä¹ˆçŸ¥é“è´§ç‰©å­˜å‚¨åœ¨å“ªä¸ªè´§æ¶å‘¢ï¼Ÿ&lt;/p&gt;&lt;section&gt;
&lt;span&gt;å»ºæçš„å­˜ä¸å–&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå’±ä»¬è¿˜è¦è¯´å› MemoryStoreï¼Œå‰æ–‡ä¹¦å’±ä»¬è¯´åˆ° MemoryStore å¯ä»¥å­˜å‚¨ä¸¤ç§å½¢å¼çš„æ•°æ®ï¼Œå³å¯¹è±¡å€¼å’Œå­—èŠ‚æ•°ç»„ï¼Œå¯¹äºè¿™ä¸¤ç§æ•°æ®å½¢å¼ï¼ŒMemoryStore ç»Ÿä¸€é‡‡ç”¨ MemoryEntry æŠ½è±¡æ¥è¿›è¡Œå°è£…ã€‚&lt;/p&gt;&lt;p&gt;MemoryEntry å®ç°ä¸º Scala Traitï¼Œä¸»è¦æˆå‘˜ä¸ºæ•°æ®å—å¤§å°å’Œæ•°æ®ç±»å‹ï¼Œå®ƒçš„ä¸¤ä¸ªå®ç°ç±» DeserializedMemoryEntry å’Œ SerializedMemoryEntry åˆ†åˆ«ç”¨äºå°è£…å¯¹è±¡å€¼å’Œå­—èŠ‚æ•°ç»„ï¼Œå…¶ä¸­ DeserializedMemoryEntry åˆ©ç”¨ Array[T] æ¥å­˜å‚¨å¯¹è±¡å€¼åºåˆ—ï¼Œè€Œ SerializedMemoryEntry åˆ©ç”¨ ByteBuffer æ¥å­˜å‚¨åºåˆ—åŒ–åçš„å­—èŠ‚åºåˆ—ã€‚&lt;/p&gt;&lt;p&gt;MemoryStore é€šè¿‡ä¸€ç§é«˜æ•ˆçš„æ•°æ®ç»“æ„æ¥ç»Ÿä¸€æ•°æ®å—çš„å­˜å‚¨ä¸è®¿é—®ï¼šLinkedHashMap[BlockId, MemoryEntry]ï¼Œå³ Key ä¸º BlockIdã€Value æ˜¯ MemoryEntry çš„æ˜ å°„ã€‚æ˜¾ç„¶ï¼Œä¸€ä¸ª Block å¯¹åº”ä¸€ä¸ª MemoryEntryï¼ŒMemoryEntry æ—¢å¯ä»¥æ˜¯ DeserializedMemoryEntryã€ä¹Ÿå¯ä»¥æ˜¯ SerializedMemoryEntryã€‚æœ‰äº†è¿™ä¸ª LinkedHashMapï¼Œé€šè¿‡ BlockId å³å¯æ–¹ä¾¿åœ°å®šä½ MemoryEntryï¼Œä»è€Œå®ç°æ•°æ®å—çš„å¿«é€Ÿå­˜å–ã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.3411458333333333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMpibs5cEUs9K7KEobecV48ib1sXchWD5EyUCer1r1RcBUqsqCtict7uE1g/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;MemoryStore ä¸­çš„æ•°æ®å­˜å‚¨æµç¨‹&lt;/span&gt;&lt;/p&gt;&lt;p&gt;å…ˆæ¥çœ‹æ•°æ®å­˜å‚¨çš„æµç¨‹ï¼Œä¹Ÿå³å°† RDD ä¸­æ•°æ®åˆ†ç‰‡ï¼ˆPartitions/Blocksï¼‰çš„ Iterator ç‰©åŒ–ä¸ºæ•°æ®å­˜å‚¨çš„è¿‡ç¨‹ã€‚&lt;/p&gt;&lt;p&gt;é€»è¾‘ä¸Šï¼ŒRDD æ•°æ®åˆ†ç‰‡ï¼ˆä¹Ÿå³ Partitionï¼‰ä¸ Block æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œä¸è¿‡éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼ŒPartition çš„ç¼–å·è§„åˆ™ä¸ Block çš„ç¼–å·è§„åˆ™ä¸è§å¾—ä¿æŒä¸€è‡´ã€‚MemoryStore æä¾›äº† putIteratorAsValues å’Œ putIteratorAsBytes æ¥å°† RDD æ•°æ®åˆ†ç‰‡å¯¹åº”çš„è¿­ä»£å™¨åˆ†åˆ«ç‰©åŒ–ä¸ºå¯¹è±¡å€¼åºåˆ—å’Œå­—èŠ‚åºåˆ—ï¼Œå…·ä½“æµç¨‹å¦‚ä¸Šå›¾æ‰€ç¤ºã€‚&lt;/p&gt;&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å°†æ•°æ®å°è£…ä¸º MemoryEntry ä¹‹å‰ï¼ŒMemoryStore å…ˆåˆ©ç”¨ ValuesHolder å¯¹ Iterator è¿›è¡Œå±•å¼€ï¼ˆUnrollï¼‰ï¼Œå±•å¼€çš„è¿‡ç¨‹å®é™…ä¸Šå°±æ˜¯ç‰©åŒ–çš„è¿‡ç¨‹ï¼Œæ•°æ®å®å®åœ¨åœ¨åœ°å­˜å‚¨åˆ° ValuesHolder å°è£…çš„æ•°æ®ç»“æ„ï¼ˆVector æˆ– OutputStreamï¼‰ä¸­ï¼Œè¿™äº›ç‰©åŒ–çš„æ•°æ®åœ¨ä¹‹åå°è£…ä¸º MemoryEntry çš„è¿‡ç¨‹ä¸­ï¼Œä»…ä»…ï¼ˆé€šè¿‡ toArrayã€toByteBuffer ç­‰æ“ä½œï¼‰åœ¨æ•°æ®ç±»å‹ä¸Šåšäº†è½¬æ¢ï¼Œå¹¶æ²¡æœ‰å¸¦æ¥é¢å¤–çš„å†…å­˜æ¶ˆè€—ï¼ŒSpark æºç ä¸­å°†è¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºï¼šä» Unroll memory åˆ° Storage memory çš„â€œTransferï¼ˆè½¬ç§»ï¼‰â€ã€‚&lt;/p&gt;&lt;p&gt;ç†é¡ºäº†æ•°æ®å­˜å‚¨çš„æµç¨‹ï¼Œæ•°æ®çš„è¯»å–å’Œè®¿é—®åˆ™ä¸€ç›®äº†ç„¶ã€‚MemoryStore æä¾› getValues å’Œ getBytes æ–¹æ³•ï¼Œæ ¹æ® BlockId åˆ†åˆ«è®¿é—®å¯¹è±¡å€¼ä¸å­—èŠ‚åºåˆ—ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ä¸¤ç§æ–¹æ³•é¦–å…ˆé€šè¿‡ BlockId è·å–åˆ°å¯¹åº”çš„ DeserializedMemoryEntry æˆ– SerializedMemoryEntryï¼Œç„¶ååœ¨é€šè¿‡è®¿é—®å„è‡ªå°è£…çš„ Array[T] å’Œ ByteBuffer æ¥è¯»å–æ•°æ®å†…å®¹ã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.5317708333333333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMRTVygtJWqPt9OqwJibXukqSthBt1pRQjnqGwVaBic81291arvKH9wXxA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;MemoryStore ä¸­çš„æ•°æ®è®¿é—®&lt;/span&gt;&lt;/p&gt;&lt;p&gt;è¯´åˆ° MemoryStore ä¸­æ•°æ®çš„å­˜ä¸å–ï¼Œæœ‰å‡ ä¸ªé‡è¦çš„è§’è‰²ä¸å¾—ä¸æï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ï¼š&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;BlockInfoManagerï¼šå‰æ–‡ä¹¦å·²æœ‰äº¤ä»£ï¼Œå…¶ä¸»è¦èŒè´£æ˜¯é€šè¿‡é”æœºåˆ¶æ¥ä¿è¯å¤šä»»åŠ¡å¹¶å‘æƒ…å†µä¸‹æ•°æ®è®¿é—®çš„ä¸€è‡´æ€§ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;SerializerManangerï¼šé¡¾åæ€ä¹‰ï¼Œè‡ªç„¶æ˜¯è´Ÿè´£ MemoryStore ä¸­æ•°æ®çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;MemoryManagerï¼šSpark å†…å­˜ç®¡ç†å™¨ï¼Œè¿™å¯æ˜¯æ–¯å·´å…‹å›½é™…å»ºç­‘é›†å›¢åˆ†å…¬å¸ä¸¾è¶³è½»é‡çš„ä¸€ä½å¤§ä½¬ï¼Œæˆ‘ä»¬åœ¨ä¸‹ä¸€ç¯‡ã€ŠSpark å†…å­˜ç®¡ç†ã€‹ä¸­ä¼šæœ‰æ›´è¯¦ç»†çš„äº¤ä»£ã€‚&lt;/p&gt;&lt;p&gt;å¦‚æœéè¦ç”¨ä¸€å¥è¯æ¦‚æ‹¬ï¼ŒMemoryManager çš„ä¸»è¦èŒèƒ½æ˜¯ç»´æŒä¸åŒå†…å­˜åŒºåŸŸï¼ˆStorage memory, Shuffle memory, Runtime memory ç­‰ï¼‰ä¹‹é—´çš„å¹³è¡¡ã€ä»¥åŠç»´æŒå¤šä»»åŠ¡å¹¶å‘ä¸‹ä¸åŒçº¿ç¨‹ä¹‹é—´å†…å­˜æ¶ˆè€—çš„å¹³è¡¡ã€‚&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;BlockEvictionHandlerï¼šè¿™ä¸ªè§’è‰²æ¯”è¾ƒæœ‰æ„æ€ï¼Œä»–è´Ÿè´£æŠŠ MemoryStore ä¸­çš„æ•°æ®å—â€œé©±é€â€å‡ºå†…å­˜ â€”â€” é€šå¸¸æƒ…å†µä¸‹éƒ½ä¼šæŠŠè¿™äº›è¢«é©±é€çš„ Blockâ€œæ’µâ€åˆ° DiskStore ä¸­å»ï¼Œä¹Ÿå³æŠŠå†…å­˜ä¸­ç‰©åŒ–çš„æ•°æ®è½¬ç§»åˆ°ç£ç›˜å­˜å‚¨ä¸­ã€‚ä¸€ä¸ªå…¸å‹çš„åœºæ™¯æ˜¯å½“ RDD ç¼“å­˜é‡‡ç”¨ MEMORY_AND_DISK æ¨¡å¼ä¸”å†…å­˜ä¸è¶³ä»¥å®¹çº³æ•´ä¸ª RDD æ•°æ®é›†æ—¶ï¼Œæ ¹æ® LRU åŸåˆ™ï¼Œè®¿é—®é¢‘æ¬¡è¾ƒä½ä¸”è®¿é—®æ—¶é—´è¾ƒä¸ºä¹…è¿œçš„ Block å°±ä¼šè¢« BlockEvictionHandlerâ€œä¸‹æ”¾â€åˆ° DiskStore ä¸­å»ã€‚&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.6401041666666667&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczM3B9XibXI7fk7J0eHXDjPm7ECiawtKyibibrIbSBoYyuhiajbWp561KxVy8A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;DiskStore ä¸­æ•°æ®çš„å­˜ä¸å–&lt;/span&gt;&lt;/p&gt;&lt;p&gt;è¯´æ¥è¯´å»åˆè¯´å›äº† DiskStoreï¼ŒDiskStore ä¸­çš„æ•°æ®å­˜å–ç›¸å¯¹ç›´æˆªäº†å½“ä¸€äº›ï¼Œæœ‰ DiskBlockManager è¿™ä¸ªâ€œç®¡å®¶â€ååŠ©ç»´æŠ¤ Block ä¸ç£ç›˜æ–‡ä»¶çš„å¯¹åº”å…³ç³»ï¼ŒDiskStore å¹¶ä¸éœ€è¦è¿‡å¤šçš„æŠ½è±¡æ¥å°è£…è¯»å†™é€»è¾‘ã€‚å®é™…ä¸Šï¼Œåœ¨æ•°æ®å­˜å–çš„é—­ç¯ä¸­ï¼ŒDiskStore ä»…åœ¨æ•°æ®è®¿é—®çš„è¿‡ç¨‹ä¸­åˆ©ç”¨ BlockData æŠ½è±¡æ¥å°è£…å°†ç£ç›˜æ–‡ä»¶å†…å®¹è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„çš„æ“ä½œã€‚&lt;/p&gt;&lt;p&gt;BlockData çš„ä¸¤ä¸ªå®ç°ç±» DiskBlockData å’Œ EncryptedBlockData éƒ½æ˜¯é€šè¿‡ open å‡½æ•°è·å– Java NIO çš„ FileChannelï¼Œç„¶åå†é€šè¿‡ toByteBuffer å‡½æ•°åˆ©ç”¨ FileChannel å°†æ–‡ä»¶å†…å®¹è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨æ•°æ®è®¿é—®è¿‡ç¨‹ï¼ˆæ­¥éª¤ 4 è‡³ 7ï¼‰ä¸­ï¼ŒgetBytes é¦–å…ˆæ ¹æ® BlockId ä» DiskBlockManager è·å–å¯¹åº”ç£ç›˜æ–‡ä»¶ï¼Œç„¶åå°† FileChannel å°è£…ä¸º BlockDataï¼Œæœ€åé€šè¿‡ BlockData çš„ toByteBuffer æ–¹æ³•å¾—åˆ°æ‰€éœ€çš„å­—èŠ‚æ•°ç»„ã€‚æ•°æ®å†™å…¥çš„è¿‡ç¨‹ï¼ˆæ­¥éª¤ 1 è‡³ 3ï¼‰åˆ™æ›´ç®€å•ï¼Œé¦–å…ˆæ ¹æ® BlockId ä» DiskBlockManager è·å–æ–‡ä»¶åœ°å€ï¼Œç„¶åå†é€šè¿‡ FileChannel å°† ByteBuffer å†…å®¹è½åœ°åˆ°ç£ç›˜æ–‡ä»¶ã€‚&lt;/p&gt;&lt;section&gt;
&lt;span&gt;å»ºæçš„è¿è¾“ä¸ç‰©æµ&lt;/span&gt;
&lt;/section&gt;&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ•°æ®çš„å­˜ä¸å–éƒ½æ˜¯å‘ç”Ÿåœ¨æœ¬åœ°çš„ï¼Œä¹Ÿå³æ•°æ®å­˜å‚¨ä¸æ‹‰å–çš„è¯·æ±‚å’Œå¤„ç†éƒ½æ˜¯å‘ç”Ÿåœ¨åŒä¸€ä¸ªè®¡ç®—èŠ‚ç‚¹ã€‚å‰æ–‡ä¹¦å’±ä»¬è¯´åˆ°ï¼ŒSpark å­˜å‚¨ç³»ç»Ÿä¸»è¦æœåŠ¡äºä¸‰ç±»ä»»åŠ¡ï¼š&lt;/p&gt;&lt;p&gt;è¦å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œä»…æœ‰æœ¬åœ°åŒ–çš„æ•°æ®å­˜å–æ˜¯ä¸å¤Ÿçš„ï¼ŒSpark å­˜å‚¨ç³»ç»Ÿè¿˜éœ€è¦æä¾›è·¨èŠ‚ç‚¹å­˜å–æ•°æ®çš„èƒ½åŠ›ã€‚å…·ä½“æ¥è¯´ï¼Œä¸ºäº†æé«˜å¯ç”¨æ€§å’Œç¨³å®šæ€§ï¼ŒRDD Caching å¾€å¾€ä¼šåœ¨ MemoryStore å’Œ DiskStore ä¸­ç¼“å­˜å¤šä»½ RDD å‰¯æœ¬ï¼ŒèŠ‚ç‚¹é—´çš„å‰¯æœ¬æ‹·è´ä¸ä¸Šä¼ éœ€è¦è·¨èŠ‚ç‚¹ä¼ è¾“çš„èƒ½åŠ›ã€‚Shuffle ä»»åŠ¡åœ¨ Shuffle write é˜¶æ®µä¼šå°†å¯¹åº”äºå¤šä¸ª Reducer çš„æ•°æ®åˆ†ç‰‡å†™å…¥åˆ°æœ¬åœ°ç£ç›˜ï¼Œè¿™äº›æ•°æ®åˆ†ç‰‡ç§°ä¸º Shuffle ä¸­é—´æ–‡ä»¶ï¼ŒShuffle read é˜¶æ®µ Reducer é€šè¿‡ç½‘ç»œè®¿é—®æ‰€æœ‰èŠ‚ç‚¹ä»è€Œè¯»å–æ‰€æœ‰å±äºè‡ªå·±çš„æ•°æ®åˆ†ç‰‡ï¼Œè¿™ä¸ªè¿‡ç¨‹è‡ªç„¶éœ€è¦ç½‘ç»œ I/O çš„æ”¯æŒã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚ä½•æä¾›è¿™äº›èƒ½åŠ›ä»è€Œæ”¯æŒè·¨èŠ‚ç‚¹æ•°æ®å­˜å–çš„åŠŸèƒ½å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;åœ¨æœ¬ç¯‡çš„å¼€å§‹ï¼Œå’±ä»¬è¯´åˆ° SparkContext åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­ä¼šåˆ›å»ºä¸€ç³»åˆ—çš„å¯¹è±¡æ¥åˆ†åˆ«æœåŠ¡äºä¼—å¤šçš„ Spark å­ç³»ç»Ÿ â€”â€” å¦‚è°ƒåº¦ç³»ç»Ÿã€å­˜å‚¨ç³»ç»Ÿã€å†…å­˜ç®¡ç†ã€Shuffle ç®¡ç†ã€RPC ç³»ç»Ÿç­‰ï¼Œæˆ‘ä»¬æš‚ä¸”æŠŠè¿™äº›å¯¹è±¡ç§°ä¹‹ä¸ºâ€œä¸Šä¸‹æ–‡å¯¹è±¡â€ã€‚BlockManager ä½œä¸º Spark å­˜å‚¨ç³»ç»Ÿçš„å…¥å£ï¼Œä»¥ç»„åˆçš„è®¾è®¡æ¨¡å¼æŒæœ‰å¤šä¸ªâ€œä¸Šä¸‹æ–‡å¯¹è±¡â€çš„å¼•ç”¨ï¼Œå°è£…äº†ä¸æ•°æ®å­˜å–æœ‰å…³çš„æ‰€æœ‰æŠ½è±¡ã€‚BlockManager çš„ç»„åˆå¯¹è±¡æ˜Ÿç½—äº‘å¸ƒï¼Œåˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ¥è§¦è¿‡çš„æœ‰ï¼š&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p&gt;MemoryStoreã€DiskStoreã€BlockInfoManagerã€DiskBlockManager â€”â€” æœ¬åœ°æ•°æ®å­˜å–&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;MemoryManager â€”â€” ç»´æŠ¤ä¸åŒå†…å­˜åŒºåŸŸä¹‹é—´çš„å¹³è¡¡&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;SerializerManager â€”â€” åºåˆ—åŒ–ç®¡ç†å™¨&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ MapOutputTrackerã€ShuffleManagerã€BlockTransferService ç­‰ç­‰ã€‚MapOutputTracker å’±ä»¬åœ¨ä¸Šä¸€ç¯‡ã€ŠSpark è°ƒåº¦ç³»ç»Ÿä¹‹æƒåŠ›çš„æ¸¸æˆã€‹ç•¥æœ‰æåŠï¼›Shuffle æ˜¯ä¸ªå¤§è¯é¢˜ï¼ŒShuffleManager æˆ‘ä»¬ç•™åˆ°ä¹‹åã€ŠSpark Shuffle ç®¡ç†ã€‹å†è®²ï¼›æœ¬ç« èŠ‚çš„ä¸»è§’æ˜¯ BlockTransferService â€”â€” å›ç­”åˆšåˆšçš„é—®é¢˜ï¼ŒSpark å­˜å‚¨ç³»ç»Ÿæ­£æ˜¯ä»°ä»— BlockTransferService æ¥æä¾›è·¨èŠ‚ç‚¹çš„æ•°æ®å­˜å–ã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.34375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMledrUJUBUnDTvX4V5M1vAbByJaxze8zI77kRTZymMtAte29TwldRQQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;Spark å­˜å‚¨ç³»ç»Ÿå¯¹äºä¸åŒç±»å‹ä»»åŠ¡çš„æ”¯æŒ&lt;/span&gt;&lt;/p&gt;&lt;p&gt;BlockTransferService æŠ½è±¡ä¸»è¦æä¾›ä¸¤ç§æ–¹æ³•æ¥æ”¯æŒä¸åŒç±»å‹çš„è®¡ç®—ä»»åŠ¡ï¼Œå³å¦‚ä¸Šå›¾æ‰€ç¤ºçš„ fetchBlockSync æ–¹æ³•å’Œ uploadBlockSync æ–¹æ³•ã€‚&lt;/p&gt;&lt;p&gt;BlockTransferServiceï¼Œé¡¾åæ€ä¹‰ï¼Œæ—¢ç„¶æ˜¯ Serviceï¼Œè‡ªç„¶å°±ç»•ä¸å¼€ Server/Client çš„æ¦‚å¿µã€‚fetchBlockSync æ–¹æ³•å’Œ uploadBlockSync æ–¹æ³•éƒ½å±äºå®¢æˆ·ç«¯æ–¹æ³•ï¼Œç”¨äºå‘æœåŠ¡ç«¯æäº¤â€œä¸‹è½½æ•°æ®å—â€å’Œâ€œä¸Šä¼ æ•°æ®å—â€çš„è¯·æ±‚ã€‚&lt;/p&gt;&lt;p&gt;è¯´åˆ°è¿™é‡Œï¼Œå„ä½çœ‹å®˜ä¸ç¦è¦é—®ï¼šBlockTransferService å°±æ˜¯ä¸ªæŠ½è±¡è€Œå·²ï¼Œè€Œä¸”ä»…ä»…æä¾›äº†ä¸¤ä¸ªæ•°æ®æ”¶å‘çš„æ¥å£ï¼Œå®ƒä¾æ‰˜ä»€ä¹ˆæ¥æ„å»ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å‘¢ï¼Ÿ&lt;/p&gt;&lt;p&gt;è¦è¯´æ¸…æ¥šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ï¼Œå’±ä»¬å°±éœ€è¦æ·±å…¥åˆ° BlockTransferService æ¥å£çš„å”¯ä¸€å®ç°ç±» NettyBlockTransferService ä¸­å»ä¸€æ¢ç©¶ç«Ÿã€‚Netty æ˜¯åŸºäº NIOï¼ˆNonblocking I/Oï¼Œéé˜»å¡ I/Oï¼‰çš„ç½‘ç»œé€šä¿¡æ¡†æ¶ï¼Œéé˜»å¡ I/O èµ‹äºˆ Netty å¤©ç„¶çš„é«˜å¹¶å‘ç‰¹æ€§ï¼ŒNetty æä¾› Channel æŠ½è±¡å¯¹ JDK åŸç”Ÿçš„ SocketChannel è¿›è¡Œäº†å°è£…å’Œå¢å¼ºä»è€Œä½¿å¾—å¼€å‘è€…å¯ä»¥æ›´åŠ é«˜æ•ˆåœ°è¿›è¡Œç½‘ç»œå¼€å‘ã€‚NettyBlockTransferService æ­£æ˜¯ç«™åœ¨ Netty çš„â€œè‚©è†€â€ä¸Šåœ¨åˆå§‹åŒ–é˜¶æ®µåŒæ—¶åˆ›å»ºå®¢æˆ·ç«¯å·¥å‚å’ŒæœåŠ¡ç«¯ã€‚&lt;/p&gt;&lt;p&gt;&lt;img data-ratio=&quot;0.49375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/YriaiaJPb26VNiampMtJ87THWdBdAU1ciczMU76tkExIvDOFqcrVgo29J0ker5T0Nwn5y4Rw2LIvjOOTvKOUbfRpjQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1920&quot;/&gt;&lt;span&gt;NettyBlockTransferService åˆ›å»ºå»ºå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯&lt;/span&gt;&lt;/p&gt;&lt;p&gt;å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒNettyBlockTransferService åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­åˆ†åˆ«é€šè¿‡ createServer å’Œ createClientFactory æ¥åˆ›å»ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼ŒäºŒè€…çš„åˆ›å»ºè¿‡ç¨‹æå…¶ç±»ä¼¼ â€”â€” å…ˆå®ä¾‹åŒ– Netty Bootstrapã€ç„¶åç»‘å®š Channel å’Œå¼‚æ­¥å¤„ç†çº¿ç¨‹ NioEventLoopã€æœ€åç»‘å®šåœ°å€ä¸ç«¯å£ / è¿æ¥æœåŠ¡å™¨æ¥å¯åŠ¨æœåŠ¡ / å‘èµ·è¯·æ±‚ã€‚&lt;/p&gt;&lt;p&gt;é€šè¿‡å®¢æˆ·ç«¯ï¼ŒBlockManager å³å¯é€šè¿‡ fetchBlockSync æ–¹æ³•å’Œ uploadBlockSync æ–¹æ³•å‘å…¶ä»–è®¡ç®—èŠ‚ç‚¹å‘èµ·æ•°æ®å—ä¸‹è½½ / ä¸Šä¼ è¯·æ±‚ï¼›ç›¸åº”åœ°ï¼Œæ¯ä¸ª BlockManager é€šè¿‡æœåŠ¡ç«¯æ¥å“åº”å…¶ä»–èŠ‚ç‚¹å‘æ¥çš„æ•°æ®ä¼ è¾“è¯·æ±‚ã€‚è¿™ä¹ˆçœ‹æ¥ï¼Œå¯¹äºæ–¯å·´å…‹å›½é™…å»ºç­‘é›†å›¢å…¬å¸æ¥è¯´ï¼ŒBlockTransferService ç›¸å½“äºæ˜¯é›†å›¢ä¸ºåˆ†å…¬å¸ï¼ˆExecutorï¼‰é…å¤‡çš„ç‰©æµæœåŠ¡ï¼Œä¸“é—¨è´Ÿè´£ä¸åŒåˆ†å…¬å¸ä¹‹é—´å»ºæçš„ç‰©æµä¸åˆ†å‘ã€‚&lt;/p&gt;&lt;p&gt;åˆ°æ­¤ä¸ºæ­¢ï¼ŒSpark å­˜å‚¨ç³»ç»Ÿçš„å…¨è²Œå·²åˆéœ²ç«¯å€ªï¼Œå°½ç®¡ç›¸å…³ç¯èŠ‚ç»†èŠ‚è¿˜æœ‰å¾…æ·±å…¥ï¼Œä¸è¿‡ä»åŠŸèƒ½å’ŒåŠŸç”¨çš„è§’åº¦æ¥è¯´ï¼ŒSpark å­˜å‚¨ç³»ç»Ÿä½œä¸ºåº•å±‚åŸºç¡€è®¾æ–½ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¼„æ¸…äº†å®ƒå¦‚ä½•ä¸ºå…¶ä»–æ•°æ®æœåŠ¡ï¼ˆå¦‚ RDD ç¼“å­˜ã€Shuffleï¼‰æä¾›åŸºç¡€ä¿éšœã€‚è¿™äº›æ•°æ®æœåŠ¡åœ¨ Spark åˆ†å¸ƒå¼è®¡ç®—ä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ï¼Œè¿ç”¨å¾—å½“ï¼Œä»–ä»¬å¯ä»¥å¸®åŠ©åº”ç”¨ç¨‹åºå¤§å¹…æå‡æ‰§è¡Œæ€§èƒ½ï¼Œä¸è¿‡ï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨æ¥ä¸‹æ¥çš„ç¯‡ç« é‡Œï¼Œæˆ‘ä»¬å°†ä¸€ä¸€å¯¹å…¶å±•å¼€ã€æ¸è¿›å¼åœ°è§£é”æ€§èƒ½è°ƒä¼˜çš„æŠ€èƒ½ï¼Œæ•¬è¯·æœŸå¾…ã€‚&lt;/p&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;Postscript&lt;/span&gt;&lt;/strong&gt;&lt;span/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;æœ¬ç¯‡æ˜¯ã€ŠSpark åˆ†å¸ƒå¼è®¡ç®—ç§‘æ™®ä¸“æ ã€‹çš„ç¬¬å››ç¯‡ï¼Œç¬”è€…å­¦æµ…æ‰ç–ã€ç–æ¼éš¾å…ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•ç–‘é—®ï¼Œæˆ–æ˜¯è§‰å¾—æ–‡ç« ä¸­çš„æè¿°æœ‰æ‰€é—æ¼æˆ–ä¸å¦¥ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€è®¨è®ºã€‚æŒæ¡ä¸€é—¨æŠ€æœ¯ï¼Œä¹¦æœ¬ä¸­çš„çŸ¥è¯†å¾€å¾€åªå ä¸¤æˆï¼Œä¸‰æˆé è®¨è®ºï¼Œäº”æˆé å®è·µã€‚æ›´å¤šçš„è®¨è®ºèƒ½æ¿€å‘æ›´å¤šçš„è§‚ç‚¹ã€è§†è§’ä¸æ´å¯Ÿï¼Œä¹Ÿåªæœ‰è¿™æ ·ï¼Œå¯¹äºä¸€é—¨æŠ€æœ¯çš„è®¤çŸ¥ä¸ç†è§£æ‰èƒ½æ›´æ·±å…¥ã€ç‰¢å›ºã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;åœ¨æœ¬ç¯‡åšæ–‡ä¸­ï¼Œå…ˆä»åŠŸç”¨çš„è§’åº¦ä»‹ç»äº† Spark å­˜å‚¨ç³»ç»ŸæœåŠ¡çš„ä¸»è¦å¯¹è±¡ï¼ˆRDD ç¼“å­˜ã€Shuffleã€å¹¿æ’­ï¼‰ï¼›ç´§æ¥ç€ä»â€œå»ºæä»“å‚¨â€MemoryStore å’Œ DiskStore å…¥æ‰‹ï¼Œè¯´æ˜äº†æ•°æ®åœ¨ BlockManager ä¸­çš„å­˜å‚¨å½¢å¼å’Œå­˜å‚¨æ–¹å¼ï¼›ç„¶åé€šè¿‡ MemoryEntry å’Œ DiskBlockManager æ¥è®²è¿°æ•°æ®åœ¨å†…å­˜å’Œç£ç›˜ä¸­çš„å­˜å–è¿‡ç¨‹ï¼›æœ€åä»¥ BlockTransferService æ”¶å°¾ï¼ŒNettyBlockTransferService ä»¥æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„å½¢å¼ä¸ºè·¨èŠ‚ç‚¹æ•°æ®ä¼ è¾“æä¾›åŸºç¡€æœåŠ¡ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;å‡ºäºç§‘æ™®çš„åˆè¡·ï¼Œæœ¬ç¯‡éšå»äº† Spark å­˜å‚¨ç³»ç»Ÿä¸­çš„ä¸€äº›åˆ†æ”¯å’Œç»†èŠ‚ï¼Œå¦‚ä¸ ExternalShuffleServiceï¼ˆæä¾›é«˜å¯ç”¨çš„ Shuffle æœåŠ¡ï¼‰æœ‰å…³çš„å­˜å‚¨åŠŸèƒ½ã€ä¸ºæ”¯æŒå¼‚æ­¥æ•°æ®æ‹·è´ä¸ä¸Šä¼ è€Œæä¾›çš„ newCachedThreadPool çº¿ç¨‹æ± ï¼Œç­‰ç­‰ã€‚&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;ä»ä¸‹ä¸€ç¯‡å¼€å§‹ï¼Œå’±ä»¬å°†ä»¥æ€§èƒ½è°ƒä¼˜ä¸ºå¯¼å‘åˆ†æã€æ¢è®¨ Spark åˆ†å¸ƒå¼ç³»ç»Ÿçš„å…³é”®ç¯èŠ‚ï¼Œè€Œä¸åªæ˜¯å•çº¯åœ°è¿›è¡ŒåŸç†çš„è®²è§£ã€‚ä½œä¸ºä¸€æ¬¾å†…å­˜è®¡ç®—å¼•æ“ï¼Œå†…å­˜çš„æ¢ç´¢ä¸åˆ©ç”¨è‡ªç„¶å°¤ä¸ºé‡è¦ï¼Œæ¯•ç«Ÿä¸çŸ¥ MemoryManager å¦‚ä½•ä»¥ç»Ÿä¸€çš„æ–¹å¼æ‰“ç†å†…å­˜ï¼Œä¸”å¬ä¸‹å›åˆ†è§£ã€‚&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>131ae5b965b85e7bff95801197b068d3</guid>
<title>service workerè½»åº¦æ¢ç´¢ - è§£å†³è¿è¥æ´»åŠ¨éœ€æ±‚ä¸­çš„å›¾ç‰‡åŠ è½½é—®é¢˜?</title>
<link>https://toutiao.io/k/v1u5lan</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;p class=&quot;original_area_primary&quot;&gt;
                                                                                                &lt;/p&gt;

                    
                                            &lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    
                    
                    
                    &lt;section class=&quot;mp_profile_iframe_wrp&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzUxNzk1MjQ0Ng==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/YBFV3Da0Nwvv72YkFO0qPibDKicOCsfltiaE9070DOu4iahXnicYwRIHcxe9VBicAy45MkPqy8nZzLTVibugOtV0ORFcg/0?wx_fmt=png&quot; data-nickname=&quot;ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—&quot; data-alias=&quot;coder_growth&quot; data-signature=&quot;ä¸“æ³¨ Node.js æŠ€æœ¯æ ˆåˆ†äº«ï¼Œä» å‰ç«¯ åˆ° Node.js å†åˆ° åç«¯æ•°æ®åº“ï¼Œç¥æ‚¨æˆä¸ºä¼˜ç§€çš„é«˜çº§ Node.js å…¨æ ˆå·¥ç¨‹å¸ˆã€‚ä¸€ä¸ªæœ‰è¶£çš„ä¸”ä¹äºåˆ†äº«çš„äººã€‚åº§å³é“­ï¼šä»Šå¤©æœªå®Œæˆçš„ï¼Œæ˜å¤©æ›´ä¸ä¼šå®Œæˆã€‚&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;h1 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span&gt;å¤§å‚æŠ€æœ¯&lt;/span&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;é«˜çº§å‰ç«¯&lt;/span&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;span&gt;Nodeè¿›é˜¶&lt;/span&gt;&lt;br/&gt;&lt;/h1&gt;&lt;p&gt;&lt;span data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16021670869911=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16030289161394=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030289161394=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030289161394=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16030289161394=&quot;rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16030315732716=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030315732716=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030315732716=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16030315732716=&quot;rgb(136, 136, 136)&quot;&gt;ç‚¹å‡»ä¸Šæ–¹Â &lt;/span&gt;&lt;span data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16021670869911=&quot;rgb(0, 128, 255)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(0, 128, 255)&quot; data-darkmode-bgcolor-16030289161394=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030289161394=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030289161394=&quot;rgb(0, 128, 255)&quot; data-darkmode-original-color-16030289161394=&quot;rgb(0, 128, 255)&quot; data-darkmode-bgcolor-16030315732716=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030315732716=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030315732716=&quot;rgb(0, 128, 255)&quot; data-darkmode-original-color-16030315732716=&quot;rgb(0, 128, 255)&quot;&gt;ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—&lt;/span&gt;&lt;span data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16021670869911=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16030289161394=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030289161394=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030289161394=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16030289161394=&quot;rgb(136, 136, 136)&quot; data-darkmode-bgcolor-16030315732716=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030315732716=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030315732716=&quot;rgb(136, 136, 136)&quot; data-darkmode-original-color-16030315732716=&quot;rgb(136, 136, 136)&quot;&gt;ï¼Œå…³æ³¨å…¬ä¼—å·&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å›å¤&lt;/span&gt;&lt;span&gt;&lt;span&gt;1&lt;/span&gt;&lt;/span&gt;&lt;span&gt;ï¼ŒåŠ å…¥é«˜çº§Nodeäº¤æµç¾¤&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;å†™åœ¨å‰é¢&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;åšè¿‡è¿è¥æ´»åŠ¨éœ€æ±‚çš„åŒå­¦éƒ½çŸ¥é“ï¼Œä¸€èˆ¬ä¸€ä¸ªè¿è¥æ´»åŠ¨ä¸­ä¼šç”¨åˆ°å¾ˆå¤šçš„å›¾ç‰‡èµ„æºã€‚ç”¨æˆ·è®¿é—®é¦–é¡µæ—¶ï¼Œéƒ½ä¼šçœ‹åˆ°ä¸€ä¸ªloadingæ€ï¼Œè¡¨ç¤ºé¡µé¢æ­£åœ¨åŠ è½½æ‰€éœ€çš„æ‰€æœ‰å›¾ç‰‡èµ„æºã€‚åƒä¸‹é¢è¿™æ ·ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-copyright=&quot;0&quot; data-ratio=&quot;0.3380281690140845&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/R7oib8BJQz2hm4F7zsECx0tyjxibbo6XVOKjFcyLYnTfp35BIBqhljfzqqVq4X0Z2zJib7SiaLR93QibnHibLx0JlXkw/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;142&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;æ‰‹åŠ¨åŠ è½½ä¸€ä¸ªå›¾ç‰‡çš„ä»£ç ä¹Ÿå¾ˆç®€å•ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;var&lt;/span&gt; img = &lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; Image();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;img.onload = &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;/&gt;)&lt;/span&gt;{ ... }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;img.src = &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;å›¾ç‰‡åœ°å€&#x27;&lt;/span&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;span md-inline=&quot;plain&quot;&gt;ä¹‹æ‰€ä»¥è¦æå‰åŠ è½½æ‰€æœ‰çš„å›¾ç‰‡ï¼Œæ˜¯ä¸ºäº†åœ¨åç»­çš„é¡µé¢ä¸­ä½¿ç”¨å›¾ç‰‡æ—¶ï¼Œä¸ä¼šå› ä¸ºéœ€è¦åŠ è½½å›¾ç‰‡è€Œäº§ç”Ÿè€—æ—¶ï¼Œå¯¼è‡´ä½“éªŒé—®é¢˜ã€‚æœ¬æ–‡æ‰€è¦è®¨è®ºçš„åœºæ™¯å°±æ˜¯ï¼š&lt;/span&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;æ€ä¹ˆæ ·åšåˆ°åœ¨é¦–é¡µåŠ è½½å›¾ç‰‡åï¼Œç›´æ¥åœ¨åé¢çš„ä¸šåŠ¡é€»è¾‘ä¸­ç›´æ¥ä½¿ç”¨æå‰åŠ è½½å¥½çš„å›¾ç‰‡å‘¢&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span md-inline=&quot;plain&quot;&gt;ï¼Ÿç­”æ¡ˆå°±æ˜¯ï¼šæŠŠå›¾ç‰‡å­˜ä¸‹æ¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;ç¼“å­˜é¦–é¡µåŠ è½½çš„å›¾ç‰‡&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;æˆ‘èƒ½æƒ³åˆ°çš„è¿™ç§åœºæ™¯ä¸‹çš„ç¼“å­˜å›¾ç‰‡æ–¹æ³•æœ‰ä¸¤ç§ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-2&quot; start=&quot;&quot; cid=&quot;n9&quot; mdtype=&quot;list&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n11&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;ä½¿ç”¨æµè§ˆå™¨çš„ç¼“å­˜&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span md-inline=&quot;plain&quot;&gt;ã€‚å›¾ç‰‡åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚æˆåŠŸåï¼Œä¸€èˆ¬éƒ½ä¼šè®¾ç½®ç¼“å­˜ã€‚åœ¨é¡µé¢åç»­çš„ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œå¦‚æœè¯´æƒ³ä½¿ç”¨æŸå›¾ç‰‡ï¼Œç›´æ¥æ­£å¸¸å‘èµ·å›¾ç‰‡è¯·æ±‚å³å¯ï¼Œæµè§ˆå™¨ä¼šèµ°ç¼“å­˜ï¼Œç”šè‡³æ˜¯ä»å†…å­˜ä¸­ç›´æ¥è¿”å›è¿™ä¸ªå›¾ç‰‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;å°†åŠ è½½å¥½çš„Imageå¯¹è±¡ç›´æ¥ä¿å­˜åœ¨å†…å­˜ä¸­&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span md-inline=&quot;plain&quot;&gt;ã€‚è¿™ç§æ–¹æ³•å¾ˆé€‚ç”¨canvasä¸­ç”»å›¾çš„åœºæ™¯ï¼Œç›´æ¥æŠŠä¿å­˜ä¸‹æ¥çš„Imageå¯¹è±¡æ‰”åˆ°canvasçš„drawImageä¸­å³å¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;/&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;åšä¸šåŠ¡éœ€è¦ä¸æ–­çš„æ€»ç»“ï¼Œæ€è€ƒã€‚è¿˜èƒ½ç”¨ä»€ä¹ˆæ–¹æ³•æ¥å®ç°å›¾ç‰‡çš„ç¼“å­˜å‘¢ ? Â æˆ‘å°è¯•äº†ä¸€ä¸‹Service Workerï¼Œæœ¬æ–‡å°†ä»‹ç»ä¸€ä¸‹Service Workeråœ¨è¿™ç§ä¸šåŠ¡åœºæ™¯ä¸‹çš„åº”ç”¨ã€‚&lt;/span&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;&lt;span&gt;æœ¬æ–‡åªæ˜¯è½»åº¦å°è¯•äº†ä¸€ä¸‹Service Workerï¼Œå¹¶æœªåœ¨çº¿ä¸Šåº”ç”¨ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;br/&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;service worker&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;p cid=&quot;n18&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;Service Workeræ˜¯PWAçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå…¶åŒ…å«å®‰è£…ã€æ¿€æ´»ã€ç­‰å¾…ã€é”€æ¯ç­‰å››ä¸ªç”Ÿå‘½å‘¨æœŸã€‚ä¸»è¦æœ‰ä»¥ä¸‹çš„ç‰¹æ€§ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; cid=&quot;n19&quot; mdtype=&quot;list&quot; data-mark=&quot;-&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n21&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;ä¸€ä¸ªç‹¬ç«‹çš„ worker çº¿ç¨‹ï¼Œç‹¬ç«‹äºå½“å‰ç½‘é¡µè¿›ç¨‹ï¼Œæœ‰è‡ªå·±ç‹¬ç«‹çš„ worker contextã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n23&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;ä¸€æ—¦è¢« installï¼Œå°±æ°¸è¿œå­˜åœ¨ï¼Œé™¤éè¢«æ‰‹åŠ¨ unregister&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n25&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;ç”¨åˆ°çš„æ—¶å€™å¯ä»¥ç›´æ¥å”¤é†’ï¼Œä¸ç”¨çš„æ—¶å€™è‡ªåŠ¨ç¡çœ &lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n27&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;å¯ç¼–ç¨‹æ‹¦æˆªä»£ç†è¯·æ±‚å’Œè¿”å›ï¼Œç¼“å­˜æ–‡ä»¶ï¼Œç¼“å­˜çš„æ–‡ä»¶å¯ä»¥è¢«ç½‘é¡µè¿›ç¨‹å–åˆ°ï¼ˆåŒ…æ‹¬ç½‘ç»œç¦»çº¿çŠ¶æ€ï¼‰&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n29&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;ç¦»çº¿å†…å®¹å¼€å‘è€…å¯æ§&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n31&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;èƒ½å‘å®¢æˆ·ç«¯æ¨é€æ¶ˆæ¯&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n33&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;ä¸èƒ½ç›´æ¥æ“ä½œ DOM&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n35&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;å¿…é¡»åœ¨ HTTPS ç¯å¢ƒä¸‹æ‰èƒ½å·¥ä½œ( æˆ– &lt;/span&gt;&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;http://localhost&lt;/span&gt;&lt;span md-inline=&quot;plain&quot;&gt; )&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n37&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;å¼‚æ­¥å®ç°ï¼Œå†…éƒ¨å¤§éƒ½æ˜¯é€šè¿‡ Promise å®ç°&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p cid=&quot;n38&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;åœ¨æœ¬æ–‡æ‰€æè¿°çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œä¸»è¦æ˜¯åº”ç”¨service workerçš„æ‹¦æˆªä»£ç†è¯·æ±‚å’Œè¿”å›çš„åŠŸèƒ½ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n39&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;å…³äºservice workerçš„åŸºç¡€ï¼Œè°·æ­Œå¼€å‘è€…ç½‘ç«™ä¸Šæœ‰è¯¦ç»†çš„ä»‹ç»ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n40&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;åœ°å€åœ¨è¿™é‡Œï¼š&lt;/span&gt;&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://developers.google.com/web/fundamentals/primers/service-workers/?hl=zh-cn&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n41&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œservice workerä¸€å®šè¦è°¨æ…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå¤ªé‡è¦äº†ï¼Œä¸€æ—¦æ³¨å†Œï¼Œç«™ç‚¹çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«æ§åˆ¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;service workerçš„ç¤ºä¾‹&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;ç»“åˆæ–‡ç« å¼€å¤´æ‰€æè¿°çš„åœºæ™¯ï¼Œæˆ‘ä»¬å…ˆæ¥å†™ä¸€äº›å¿…è¦çš„ä¸šåŠ¡å‡½æ•°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;loadImage&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;imgUrl&lt;/span&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;code-snippet__function&quot;&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;resolve, reject&lt;/span&gt;)=&amp;gt;&lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;const&lt;/span&gt; img = &lt;span class=&quot;code-snippet__keyword&quot;&gt;new&lt;/span&gt; Image();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        img.onload = &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;/&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            resolve();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        };&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        img.src = imgUrl;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;loadImageList&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;imgList&lt;/span&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-snippet__built_in&quot;&gt;Promise&lt;/span&gt;.all(imgList.map(&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;code-snippet__params&quot;&gt;imgUrl&lt;/span&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; loadImage(imgUrl);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;span&gt;ä¸‹é¢æ˜¯service workerçš„ä»£ç ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;php&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;self&lt;/span&gt;.addEventListener(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;install&#x27;&lt;/span&gt;, &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(event)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    console.log(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;install&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;self&lt;/span&gt;.addEventListener(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;fetch&#x27;&lt;/span&gt;, &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(evt)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    evt.respondWith(&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        caches.match(evt.request).then(&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;(response)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (response) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; response;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;const&lt;/span&gt; request = evt.request.&lt;span class=&quot;code-snippet__keyword&quot;&gt;clone&lt;/span&gt;();&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; fetch(request).then(&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(response)&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (!response || response.status !== &lt;span class=&quot;code-snippet__number&quot;&gt;200&lt;/span&gt; || !response.headers.get(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;Content-type&#x27;&lt;/span&gt;).match(/image/)) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; response;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;const&lt;/span&gt; responseClone = response.&lt;span class=&quot;code-snippet__keyword&quot;&gt;clone&lt;/span&gt;(); &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                caches.open(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;test-cache&#x27;&lt;/span&gt;).then(&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;(cache)&lt;/span&gt; &lt;/span&gt;{ &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                    cache.put(evt.request, responseClone);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; response;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        })&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    )&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;self&lt;/span&gt;.addEventListener(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;activate&#x27;&lt;/span&gt;, &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    console.log(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;activate&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    clients.claim(); &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;span/&gt;&lt;/p&gt;&lt;p cid=&quot;n47&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;æ³¨å†Œå®Œservice workeråï¼Œæˆ‘ä»¬å°±åŠ«æŒäº†é¡µé¢çš„æ‰€æœ‰è¯·æ±‚ã€‚æ¯ä¸€æ¬¡è¯·æ±‚ç»è¿‡service workeræ—¶ï¼Œéƒ½ä¼šåˆ¤æ–­åˆšè¯·æ±‚æ˜¯å¦å·²æœ‰ç¼“å­˜ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼Œå°±ç›´æ¥è¿”å›ç»“æœã€‚æ²¡æœ‰ç¼“å­˜æ—¶ï¼Œæ‰ä¼šå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå¹¶ä¸”å°†å›¾ç‰‡è¯·æ±‚çš„ç»“æœç¼“å­˜èµ·æ¥ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n48&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ³¨å†Œå¹¶ä½¿ç”¨è¿™ä¸ªservice workerçš„ä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;const&lt;/span&gt;Â imgArrÂ =Â [&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;http://xxx.png&#x27;&lt;/span&gt;,Â &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;...&#x27;&lt;/span&gt;];&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;/&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;code-snippet__title&quot;&gt;registerServiceWorker&lt;/span&gt;(&lt;span class=&quot;code-snippet__params&quot;/&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;serviceWorker&#x27;&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;in&lt;/span&gt; navigator) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__keyword&quot;&gt;return&lt;/span&gt; navigator.serviceWorker.register(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;http://localhost:8080/service.js&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;br/&gt;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;registerServiceWorker().then(&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;registration&lt;/span&gt; =&amp;gt;&lt;/span&gt; { &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;let&lt;/span&gt; serviceWorker;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (registration.installing) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;registration.installing&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        serviceWorker = registration.installing;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (registration.waiting) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;registration.waiting&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        serviceWorker = registration.waiting;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    } &lt;span class=&quot;code-snippet__keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (registration.active) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        &lt;span class=&quot;code-snippet__built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;registration.active&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        serviceWorker = registration.active;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        loadImageList(imgArr);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (serviceWorker) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        serviceWorker.addEventListener(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;statechange&#x27;&lt;/span&gt;, &lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;code-snippet__params&quot;&gt;e&lt;/span&gt;) &lt;/span&gt;{&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            &lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt;(e.target.state === &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;activated&#x27;&lt;/span&gt;) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                &lt;span class=&quot;code-snippet__built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;é¦–æ¬¡æ³¨å†Œswæ—¶ï¼Œswæ¿€æ´»&#x27;&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;                loadImageList(imgArr);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;            }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    }&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}).catch(&lt;span class=&quot;code-snippet__function&quot;&gt;&lt;span class=&quot;code-snippet__params&quot;&gt;e&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__built_in&quot;&gt;console&lt;/span&gt;.log(e);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;});&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n50&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;æ³¨æ„äº‹é¡¹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-2&quot; start=&quot;&quot; cid=&quot;n51&quot; mdtype=&quot;list&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n53&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;æ­£å¸¸æƒ…å†µä¸‹ï¼Œservice workeråˆšæ³¨å†Œæ—¶ï¼Œæ˜¯ä¸ä¼šæ§åˆ¶é¡µé¢çš„ï¼Œå³æ— æ³•æ‹¦æˆªåˆ°é¡µé¢çš„è¯·æ±‚ã€‚éœ€è¦ç”¨æˆ·åˆ·æ–°é¡µé¢ï¼Œå†æ¬¡è®¿é—®æ—¶ï¼Œservice workeræ‰ä¼šæ‹¦æˆªé¡µé¢è¯·æ±‚ã€‚è¿™ä¸æˆ‘ä»¬çš„éœ€æ±‚åœºæ™¯ä¸ç¬¦åˆã€‚æˆ‘ä»¬çš„éœ€æ±‚æ˜¯ï¼šç”¨æˆ·é¦–æ¬¡è®¿é—®è¯·æ±‚å›¾ç‰‡èµ„æºæ—¶ï¼Œå°±éœ€è¦å¯¹è¿”å›çš„å›¾ç‰‡è¿›è¡Œç¼“å­˜ã€‚æ‰€ä»¥ï¼Œéœ€è¦åœ¨service workerè¿›å…¥activateçŠ¶æ€åï¼Œé€šè¿‡clients.claim()æ¥è·å¾—é¡µé¢çš„æ§åˆ¶æƒã€‚&lt;/span&gt;&lt;span md-inline=&quot;strong&quot;&gt;&lt;strong&gt;&lt;span md-inline=&quot;plain&quot;&gt;ä¸è¿‡ï¼Œè¿™ç§æ–¹å¼å¹¶ä¸è¢«æå€¡&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span md-inline=&quot;plain&quot;&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n55&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;service workeræ‹¦æˆªåˆ°è¯·æ±‚åï¼Œæˆ‘ä»¬éœ€è¦æ‹·è´è¿”å›çš„æ•°æ®æµï¼Œæ‰èƒ½å­˜å…¥ç¼“å­˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n57&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½éœ€è¦è°ƒç”¨navigator.serviceWorker.registeræ¥æ‹¿åˆ°ä¸€ä¸ªservice workerã€‚æµè§ˆå™¨ä¼šåˆ¤æ–­å½“å‰service workerçš„çŠ¶æ€ï¼Œè¿”å›å¯¹åº”çš„å¯¹è±¡ã€‚æˆ‘ä»¬éœ€è¦ä¿è¯åœ¨service workerå‡†å¤‡æ— è¯¯åï¼Œå†å‘èµ·å›¾ç‰‡çš„è¯·æ±‚ã€‚ç”±äºserver workerçš„è‡ªèº«é€»è¾‘éœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬å‘èµ·å›¾ç‰‡è¯·æ±‚çš„æ—¶é—´ä¼šè¢«å»¶åã€‚&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;ä½¿ç”¨service workeråçš„æ•ˆæœ&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;ä»¥æˆ‘åšçš„è¿è¥æ´»åŠ¨é¡¹ç›®ä¸ºä¾‹ï¼Œä½¿ç”¨service workerä¹‹å‰ï¼Œç½‘ç»œè¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;br/&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot; cid=&quot;n61&quot; mdtype=&quot;list&quot; data-mark=&quot;-&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n63&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;æ´»åŠ¨é¡µé¦–é¡µï¼Œé¦–æ¬¡é›†ä¸­è¯·æ±‚å›¾ç‰‡ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n63&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-copyright=&quot;0&quot; data-ratio=&quot;0.54140625&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/R7oib8BJQz2hm4F7zsECx0tyjxibbo6XVOaWF2r2Eiclg9FANadrMAISX6h2nWkQeic3RUEN7o4pw4f9yYS6xRjJNw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1280&quot;/&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p cid=&quot;n41&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;&lt;span&gt;æ´»åŠ¨é¡µåç»­é¡µé¢ä¸­ï¼Œä½¿ç”¨åŠ è½½å¥½çš„å›¾ç‰‡ï¼š&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4151898734177215&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/R7oib8BJQz2hm4F7zsECx0tyjxibbo6XVOVZrc22iaL2ibzHIibrpdmw03QxBHxyIInUPXsTIgKRThico8ibNNPyWwn4A/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1580&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n41&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;&lt;span&gt;ä½¿ç”¨service-workerä¹‹åï¼Œç½‘ç»œè¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;p cid=&quot;n41&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;&lt;span&gt;&lt;span&gt;æ´»åŠ¨é¡µé¦–é¡µï¼Œé¦–æ¬¡é›†ä¸­è¯·æ±‚å›¾ç‰‡ï¼š&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.45663265306122447&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/R7oib8BJQz2hm4F7zsECx0tyjxibbo6XVO1D5jybEBjeFsiaibsRsviaYNrmCZmwg5nepd7c50gr1MyqI42D35tT2ibQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1568&quot;/&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4740834386852086&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/R7oib8BJQz2hm4F7zsECx0tyjxibbo6XVOJl78vFEmX7BYAhLmTJ1rD8KZ9VAl9fDtSdPaBfyic6DMLK1ECXlVtcw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1582&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æˆåŠŸä½¿ç”¨service workeråŠ«æŒäº†é¡µé¢çš„è¯·æ±‚ï¼Œå¹¶ä¸”å°†å›¾ç‰‡ç¼“å­˜åˆ°äº†æµè§ˆå™¨çš„cache storageä¸­ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æµè§ˆå™¨çš„ç¼“å­˜ã€‚è¿™é‡Œçš„ç¼“å­˜éƒ½æ˜¯http responseï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4848851269649335&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/R7oib8BJQz2hm4F7zsECx0tyjxibbo6XVOZBpQXwRicVmQEqkrnNf4un6TFDzV2tSicib6OAq7LCHvRxpIGhp5UE9fw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1654&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt; å¦å¤–è¿™é‡Œå¤šè¯´ä¸€å¥ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼Œæ¥æŸ¥çœ‹å½“å‰ç½‘ç«™å¯ä»¥ä½¿ç”¨çš„æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ç©ºé—´&lt;/span&gt;&lt;span/&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;javascript&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;&lt;span class=&quot;code-snippet__keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;storage&#x27;&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;in&lt;/span&gt; navigator &amp;amp;&amp;amp; &lt;span class=&quot;code-snippet__string&quot;&gt;&#x27;estimate&#x27;&lt;/span&gt; &lt;span class=&quot;code-snippet__keyword&quot;&gt;in&lt;/span&gt; navigator.storage) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  navigator.storage.estimate().then(&lt;span class=&quot;code-snippet__function&quot;&gt;(&lt;span class=&quot;code-snippet__params&quot;&gt;{usage, quota}&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    &lt;span class=&quot;code-snippet__built_in&quot;&gt;console&lt;/span&gt;.log(&lt;span class=&quot;code-snippet__string&quot;&gt;`Using &lt;span class=&quot;code-snippet__subst&quot;&gt;${usage}&lt;/span&gt; out of &lt;span class=&quot;code-snippet__subst&quot;&gt;${quota}&lt;/span&gt; bytes.`&lt;/span&gt;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;  });&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p&gt;&lt;br/&gt;&lt;span/&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;ä¸€äº›æ€è€ƒ&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p cid=&quot;n82&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;åœ¨æœ¬æ–‡æåˆ°çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬åœ¨ç”¨æˆ·é¦–æ¬¡è®¿é—®é¡µé¢æ—¶ï¼Œå…ˆæ³¨å†Œäº†service workerï¼Œå¹¶ä¸”ä½¿service workerç«‹å³æ§åˆ¶é¡µé¢ï¼Œç„¶åå†å¼€å§‹è¯·æ±‚å›¾ç‰‡ã€‚è¿™ç§åšæ³•å»¶åäº†å›¾ç‰‡è¯·æ±‚çš„å‘èµ·æ—¶é—´ï¼Œå¹¶ä¸”ä»ä¸Šé¢çš„å›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡service workeråŠ è½½å›¾ç‰‡çš„è€—æ—¶æ¯”æ­£å¸¸ç›´æ¥è¯·æ±‚å›¾ç‰‡è€—æ—¶ç•¥é•¿ã€‚è¿™äº›å› ç´ å¯¼è‡´é¦–å±æ—¶é—´è¢«å»¶åäº†ã€‚å¦å¤–ï¼Œä½œä¸ºè¿è¥æ´»åŠ¨é¡µï¼ŒåŒä¸€ä¸ªç”¨æˆ·ä¹Ÿä¸ä¼šåœ¨å‡ å¤©å†…å¤šæ¬¡è®¿é—®ï¼Œå› æ­¤service workerçš„ã€ç»•è¿‡ç½‘ç»œï¼Œç«‹å³å“åº”è¯·æ±‚ã€‘çš„ç‰¹æ€§å¹¶ä¸èƒ½å¾ˆå¥½åœ°å‘æŒ¥å‡ºæ¥ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨æœ¬æ–‡çš„åœºæ™¯ä¸­ï¼Œä½¿ç”¨service workeræ¥åšç¼“å­˜å¹¶ä¸æ˜¯æœ€ä½³å®è·µã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n84&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;plain&quot;&gt;å…³äºservice workeråšç¼“å­˜çš„æœ€ä½³å®è·µä»¥åŠä½¿ç”¨åœºæ™¯ï¼Œå¯ä»¥æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n85&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://developers.google.com/web/fundamentals/primers/service-workers/high-performance-loading?hl=zh-cn&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span&gt;service workeræœ€é€‚åˆçš„åœºæ™¯è¿˜æ˜¯èµ„æºç¦»çº¿åŒ–ï¼Œç”¨æˆ·äºŒæ¬¡è¿›å…¥é¡µé¢æ—¶å¯ä»¥è¾¾åˆ°èµ„æºç§’åŠ è½½ï¼Œä¸ä¼šå—ç½‘ç»œçŠ¶å†µçš„å½±å“ã€‚&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;å†™åœ¨åé¢&lt;/strong&gt;&lt;/p&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;span/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;æœ¬æ–‡ä»ä¸šåŠ¡çš„è§’åº¦å‡ºå‘ï¼Œè½»åº¦æ¢ç´¢äº†service workeråœ¨æ–‡ç« å¼€å¤´ç»™å‡ºçš„ä¸šåŠ¡åœºæ™¯ä¸­çš„åº”ç”¨ï¼Œäº†è§£äº†service workerçš„ä½¿ç”¨æ–¹æ³•ã€‚åç»­ä¼šè€ƒè™‘åœ¨åˆé€‚çš„ä¸šåŠ¡åœºæ™¯ä¸­è¿›è¡Œåº”ç”¨ã€‚ç¬¦åˆé¢„æœŸã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.16071428571428573&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/Ljib4So7yuWjicACzgyxJniasy6ibkpInm3TcGNLCiaeicY5I6o9PKBOTiaibVUDnic11QLEp9CKmBpQggtMDhKaXEPbE4Q/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;560&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;span/&gt;&lt;/span&gt;&lt;/p&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzUxNzk1MjQ0Ng==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/YBFV3Da0Nwvv72YkFO0qPibDKicOCsfltiaE9070DOu4iahXnicYwRIHcxe9VBicAy45MkPqy8nZzLTVibugOtV0ORFcg/0?wx_fmt=png&quot; data-nickname=&quot;ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—&quot; data-alias=&quot;coder_growth&quot; data-signature=&quot;ä¸“æ³¨ Node.js æŠ€æœ¯æ ˆåˆ†äº«ï¼Œä» å‰ç«¯ åˆ° Node.js å†åˆ° åç«¯æ•°æ®åº“ï¼Œç¥æ‚¨æˆä¸ºä¼˜ç§€çš„é«˜çº§ Node.js å…¨æ ˆå·¥ç¨‹å¸ˆã€‚ä¸€ä¸ªæœ‰è¶£çš„ä¸”ä¹äºåˆ†äº«çš„äººã€‚åº§å³é“­ï¼šä»Šå¤©æœªå®Œæˆçš„ï¼Œæ˜å¤©æ›´ä¸ä¼šå®Œæˆã€‚&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;section label=&quot;Copyright Â© 2016 playhudong All Rights Reserved.&quot; donone=&quot;shifuMouseDownPayStyle(&#x27;shifu_t_042&#x27;)&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;span&gt;Node ç¤¾ç¾¤&lt;/span&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;89226&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;br mpa-from-tpl=&quot;t&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;æˆ‘ç»„å»ºäº†ä¸€ä¸ªæ°›å›´ç‰¹åˆ«å¥½çš„ Node.js ç¤¾ç¾¤ï¼Œé‡Œé¢æœ‰å¾ˆå¤š Node.jså°ä¼™ä¼´ï¼Œå¦‚æœä½ å¯¹Node.jså­¦ä¹ æ„Ÿå…´è¶£çš„è¯ï¼ˆåç»­æœ‰è®¡åˆ’ä¹Ÿå¯ä»¥ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è¿›è¡ŒNode.jsç›¸å…³çš„äº¤æµã€å­¦ä¹ ã€å…±å»ºã€‚ä¸‹æ–¹åŠ  è€ƒæ‹‰ å¥½å‹å›å¤ã€ŒNodeã€å³å¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-croporisrc=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/YBFV3Da0NwsF7OKB4iaaXAzQPbNstk2LybA0Zz5I1hiaiazE9W7WH2Ojt2dibDODWMVUmHqgfXCefVwt7z5ibNMWLvg/0?wx_fmt=jpeg&quot; data-cropx1=&quot;0&quot; data-cropx2=&quot;578.2649006622516&quot; data-cropy1=&quot;0&quot; data-cropy2=&quot;700.2119205298013&quot; data-fileid=&quot;100016913&quot; data-galleryid=&quot;&quot; data-ratio=&quot;1.2093425605536332&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/YBFV3Da0NwvFQgO67XibvUG5S2UMXwCghOuJvE8BFRzUXnCAfWXkU1qHld6Ly9xiarib3siaWicJWJ0U3lI8kSgD38w/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;Â Â &lt;/span&gt;&lt;strong&gt;&lt;span&gt;Â â€œåˆ†äº«ã€ç‚¹èµ&lt;/span&gt;&lt;span&gt;ã€&lt;/span&gt;&lt;span&gt;åœ¨çœ‹â€ æ”¯æŒä¸€æ³¢ğŸ‘&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>