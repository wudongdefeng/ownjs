<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>å¼€å‘è€…å¤´æ¡</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>0ae9e4b9eaa12632bc6ce7c2d309e392</guid>
<title>é™æ€åšå®¢å¦‚ä½•é«˜æ€§èƒ½æ’å…¥è¯„è®º</title>
<link>https://toutiao.io/k/ezkvu3s</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;content&quot;&gt;
            &lt;h2 id=&quot;-å‰è¨€&quot;&gt;ğŸŒ å‰è¨€&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œé™æ€åšå®¢ç”±äºä¸å¸¦æœ‰åŠ¨æ€åŠŸèƒ½ï¼Œæ‰€ä»¥é’ˆå¯¹è¯„è®ºè¿™ç§åŠ¨æ€éœ€æ±‚æ¯”è¾ƒå¤§ä¼—çš„åšæ³•å°±æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹è¯„è®ºç³»ç»Ÿã€‚ç¬¬ä¸‰æ–¹è¯„è®ºçš„æœ¬è´¨å…¶å®å°±æ˜¯ä½¿ç”¨ JS å»è°ƒå–ç¬¬ä¸‰æ–¹æœåŠ¡æ¥å£è·å–è¯„è®ºååŠ¨æ€æ¸²æŸ“åˆ°é¡µé¢ä¸­ã€‚è™½ç„¶å®ƒå¾ˆå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ç”±äºéœ€è¦è¯·æ±‚æ¥å£ï¼Œåœ¨ä½“éªŒä¸Šè¿œæ¯”åŠ¨æ€åšå®¢çš„ç›´å‡ºæ•ˆæœè¦å·®å¾ˆå¤šã€‚æ‰€ä»¥å½“æˆ‘æŠŠåšå®¢ä»åŠ¨æ€åšå®¢ Typecho è¿ç§»åˆ°é™æ€åšå®¢ Hugo ä¸Šæ¥æ—¶ï¼Œå°±ä¸€ç›´åœ¨æ€è€ƒè¿™ä¸ªé—®é¢˜ã€‚ç›´åˆ°æˆ‘çœ‹åˆ°äº† Hugo çš„ &lt;code&gt;getJSON&lt;/code&gt; æ–¹æ³•ï¼Œå‘ç°åŸæ¥é™æ€åšå®¢ä¹Ÿæ˜¯èƒ½å¤ŸåƒåŠ¨æ€åšå®¢ä¸€æ ·ç›´å‡ºè¯„è®ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;å¤§éƒ¨åˆ†çš„é™æ€åšå®¢çš„åŸç†æ˜¯è§£æå­˜å‚¨å†…å®¹çš„æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨ä¸€äº›æ¨¡æ¿è¯­è¨€éå†æ•°æ®ç”Ÿæˆä¸€å † HTML æ–‡ä»¶ã€‚è€Œ Hugo é™¤äº†è§£æ Markdown å†…å®¹ä¹‹å¤–ï¼Œè¿˜æ”¯æŒé¢å¤–çš„æ•°æ®è·å–æ–¹æ³• &lt;code&gt;getJSON&lt;/code&gt;ã€‚ç”±äºæœ‰äº† &lt;code&gt;getJSON&lt;/code&gt; æ–¹æ³•çš„å‡ºç°ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°åœ¨åšå®¢ç¼–è¯‘æ„å»ºè¿‡ç¨‹ä¸­åŠ¨æ€çš„å»è·å–è¯„è®ºæ¥å£æ•°æ®ï¼Œå°†å…¶æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼Œå®ç°è¯„è®ºæ•°æ®çš„ç›´å‡ºæ•ˆæœã€‚å…³äº &lt;code&gt;getJSON&lt;/code&gt; çš„æ›´å¤šä»‹ç»ï¼Œå¯ä»¥æŸ¥çœ‹ Hugo æ–‡æ¡£&lt;a href=&quot;https://gohugo.io/templates/data-templates/&quot;&gt;æ•°æ®æ¨¡æ¿&lt;/a&gt;ä¸€èŠ‚ã€‚&lt;/p&gt;
&lt;h2 id=&quot;-æ–¹æ¡ˆ&quot;&gt;ğŸƒ æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;é«˜æ€§èƒ½æ–¹æ¡ˆåŸºæœ¬æ€è·¯æ˜¯åœ¨éœ€è¦è¯„è®ºæ•°æ®çš„åœ°æ–¹é€šè¿‡ &lt;code&gt;getJSON&lt;/code&gt; æ–¹æ³•è°ƒç”¨æ¥å£è·å–è¯„è®ºæ•°æ®å¹¶è¿›è¡Œæ¨¡æ¿æ¸²æŸ“ã€‚å½“è¯„è®ºæ›´æ–°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è§¦å‘é‡æ–°æ„å»ºã€‚å®ç°è¿™ä¸ªæ–¹æ¡ˆä¾èµ–ä¸‰ä¸ªå…³é”®è¦ç´ ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ„å»ºè¿‡ç¨‹æ”¯æŒè°ƒå–æ¥å£è·å–æ•°æ®&lt;/li&gt;
&lt;li&gt;è¯„è®ºæœåŠ¡æä¾› HTTP æ¥å£è¿”å›æ•°æ®&lt;/li&gt;
&lt;li&gt;åšå®¢éƒ¨ç½²æœåŠ¡æ”¯æŒé’©å­è§¦å‘é‡æ–°æ„å»º&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆ‘çš„åšå®¢ä½¿ç”¨çš„æ˜¯ Hugo é™æ€åšå®¢ç³»ç»Ÿï¼Œå¦‚ä¸Šæ–‡æ‰€è¯´é€šè¿‡ &lt;code&gt;getJSON&lt;/code&gt; å³å¯è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚è€Œæˆ‘çš„è¯„è®ºæœåŠ¡ä½¿ç”¨çš„æ˜¯è‡ªç ”çš„ &lt;a href=&quot;https://waline.js.org&quot;&gt;Waline&lt;/a&gt; è¯„è®ºç³»ç»Ÿï¼Œå®ƒæä¾›äº†è¯„è®ºæ•°ã€è¯„è®ºåˆ—è¡¨ã€æœ€è¿‘è¯„è®ºç­‰åŸºç¡€æ¥å£æ»¡è¶³æˆ‘ä»¬çš„æ•°æ®è·å–éœ€æ±‚ã€‚å¹¶ä¸” Waline æä¾›äº†ä¸°å¯Œçš„&lt;a href=&quot;https://waline.js.org/server/basic.html#%E8%AF%84%E8%AE%BA-hooks&quot;&gt;é’©å­åŠŸèƒ½&lt;/a&gt;ï¼Œæ”¯æŒåœ¨è¯„è®ºå‘å¸ƒçš„æ—¶å€™è§¦å‘è‡ªç¬¬ä¸€æ–¹æ³•ã€‚æˆ‘çš„åšå®¢éƒ¨ç½²åœ¨ Vercel ä¸Šï¼Œå®ƒæä¾›äº† &lt;a href=&quot;https://vercel.com/docs/more/deploy-hooks&quot;&gt;Deploy Hooks&lt;/a&gt; åŠŸèƒ½ï¼Œé€šè¿‡ URL å³å¯è§¦å‘é‡æ–°æ„å»ºã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘åªè¦åœ¨ Waline è¯„è®ºå‘å¸ƒçš„é’©å­ä¸­è°ƒç”¨ Vercel çš„é’©å­ URL è§¦å‘é‡æ–°æ„å»ºå³å¯è§£å†³ç¬¬ä¸‰ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&quot;-å®ç°&quot;&gt;ğŸ¥ª å®ç°&lt;/h2&gt;
&lt;p&gt;æˆ‘çš„åšå®¢ä¸Šæœ‰ä¸‰å¤„åœ°æ–¹å’Œè¯„è®ºæœ‰å…³ï¼Œåˆ†åˆ«æ˜¯é¦–é¡µä¾§è¾¹æ çš„æœ€è¿‘è¯„è®ºï¼Œæ–‡ç« æ ‡é¢˜ä¸‹æ–¹çš„è¯„è®ºæ•°ï¼Œä»¥åŠæ–‡ç« è¯¦æƒ…é¡µåº•éƒ¨çš„è¯„è®ºåˆ—è¡¨å±•ç¤ºã€‚&lt;/p&gt;
&lt;h3 id=&quot;-æœ€è¿‘è¯„è®º&quot;&gt;ğŸ æœ€è¿‘è¯„è®º&lt;/h3&gt;
&lt;p&gt;Waline æœ€è¿‘è¯„è®ºæ¥å£ï¼š&lt;a href=&quot;https://waline.js.org/api.html#%E8%AF%84%E8%AE%BA%E6%8E%A5%E5%8F%A3&quot;&gt;æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-fallback&quot; data-lang=&quot;fallback&quot;&gt;{{ $walineURL := .Site.Params.comment.waline.serverURL }}
&amp;lt;h2 class=&quot;widget-title &quot;&amp;gt;æœ€è¿‘å›å¤&amp;lt;/h2&amp;gt;
&amp;lt;ul class=&quot;widget-list recentcomments&quot;&amp;gt;
  {{ $resp := getJSON $walineURL &quot;/comment?type=recent&quot; }}
  {{ range $resp }}
  &amp;lt;li class=&quot;recentcomments&quot;&amp;gt;
    &amp;lt;a href=&quot;{{.Site.BaseURL}}{{ .url }}&quot;&amp;gt;{{ .nick }}&amp;lt;/a&amp;gt;ï¼š{{ .comment | safeHTML | truncate 22 }}
  &amp;lt;/li&amp;gt;
  {{ end }}
&amp;lt;/ul&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&quot;-æ–‡ç« è¯„è®ºæ•°&quot;&gt;ğŸ§€ æ–‡ç« è¯„è®ºæ•°&lt;/h3&gt;
&lt;p&gt;Waline è·å–æ–‡ç« å¯¹åº”çš„è¯„è®ºæ•°æ¥å£ï¼š&lt;a href=&quot;https://waline.js.org/api.html#%E8%AF%84%E8%AE%BA%E6%95%B0&quot;&gt;æ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-fallback&quot; data-lang=&quot;fallback&quot;&gt;{{ $walineURL := .Site.Params.comment.waline.serverURL }}
{{ $count := getJSON $walineURL &quot;/comment?type=count&amp;amp;url=/&quot; .Slug &quot;.html&quot; }}
&amp;lt;a href=&quot;{{ .Permalink }}#comments&quot; title=&quot;{{ .Title }}&quot;&amp;gt;
  &amp;lt;i class=&quot;fas fa-comment mr-1&quot;&amp;gt;&amp;lt;/i&amp;gt;
  &amp;lt;span&amp;gt;{{- if gt $resp 0}}{{$resp}} æ¡è¯„è®º{{else}}æš‚æ— è¯„è®º{{end -}}&amp;lt;/span&amp;gt;
&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&quot;-è¯„è®ºåˆ—è¡¨&quot;&gt;ğŸ¯ è¯„è®ºåˆ—è¡¨&lt;/h3&gt;
&lt;p&gt;è¯„è®ºåˆ—è¡¨ç”±äºæœ‰åˆ†é¡µçš„å­˜åœ¨ï¼Œä¸åƒæœ€è¿‘è¯„è®ºå’Œè¯„è®ºæ•°ä¸€æ ·ç®€å•çš„è°ƒç”¨æ¥å£å³å¯ã€‚å…ˆè·å–è¯„è®ºæ•°ï¼Œå‘ç°æœ‰è¯„è®ºæ—¶å…ˆè·å–ç¬¬ä¸€é¡µçš„è¯„è®ºï¼Œä¸»è¦æ˜¯ç”¨æ¥è·å–æ€»å…±æœ‰å¤šå°‘é¡µè¯„è®ºã€‚ä¹‹åå†ä»ç¬¬äºŒé¡µå¼€å§‹å¾ªç¯è·å–è¯„è®ºæ•°æ®ã€‚æœ€ç»ˆå°†è·å–åˆ°çš„æ•°æ®å…¨éƒ¨å­˜åˆ° &lt;code&gt;{{$scratch.Get &quot;comments&quot;}}&lt;/code&gt; æ•°ç»„ä¸­ï¼Œä½¿ç”¨æ¨¡æ¿è¯­æ³•æ¸²æŸ“è¯¥æ•°ç»„æ•°æ®å³å¯ã€‚&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-fallback&quot; data-lang=&quot;fallback&quot;&gt;{{$baseUrl := .Site.Params.comment.waline.serverURL}}
{{$slug := .Slug}}
{{$count := getJSON $baseUrl &quot;/comment?type=count&amp;amp;url=/&quot; $slug &quot;.html&quot; }}
{{$scratch := newScratch}}
{{$scratch.Add &quot;comments&quot; slice}}

{{if gt $count 0}}
  {{$comments := getJSON $baseUrl &quot;/comment?path=/&quot; $slug &quot;.html&amp;amp;page=1&amp;amp;pageSize=100&quot;}}
  {{range $cmt := $comments.data}}
    {{$scratch.Add &quot;comments&quot; $cmt}}
  {{end}}

  {{$totalPages := $comments.totalPages}}
  {{if gt $totalPages 1}}
    {{range $page := seq 2 $totalPages}}
      {{$comments := getJSON $baseUrl &quot;/comment?path=/&quot; $slug &quot;.html&amp;amp;pageSize=100&amp;amp;page=&quot; $page}}
      {{range $cmt := $comments.data}}
        {{$scratch.Add &quot;comments&quot; $cmt}}
      {{end}}
    {{end}}
  {{end}}
{{end}}

&amp;lt;div class=&quot;vcards&quot;&amp;gt;
  {{range $cmt := $scratch.Get &quot;comments&quot;}}
  &amp;lt;div class=&quot;vcard&quot; id={{$cmt.objectId}}&amp;gt;
    &amp;lt;img class=&quot;vimg&quot; src=&quot;https://gravatar.loli.net/avatar/{{$cmt.mail}}?d=mp&quot;&amp;gt;
    &amp;lt;div class=&quot;vh&quot;&amp;gt;
      &amp;lt;div class=&quot;vhead&quot;&amp;gt;
        &amp;lt;a class=&quot;vnick&quot; rel=&quot;nofollow&quot; href=&quot;{{$cmt.link}}&quot; target=&quot;_blank&quot;&amp;gt;{{$cmt.nick}}&amp;lt;/a&amp;gt;
        &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.browser}}&amp;lt;/span&amp;gt;
        &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.os}}&amp;lt;/span&amp;gt;
      &amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vmeta&quot;&amp;gt;
        &amp;lt;span class=&quot;vtime&quot;&amp;gt;{{dateFormat $cmt.insertedAt &quot;2006-01-02 03:04:05&quot;}}&amp;lt;/span&amp;gt;
        &amp;lt;span class=&quot;vat&quot;&amp;gt;å›å¤&amp;lt;/span&amp;gt;
      &amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vcontent&quot; data-expand=&quot;æŸ¥çœ‹æ›´å¤š...&quot;&amp;gt;
        {{$cmt.comment | safeHTML}}
      &amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vreply-wrapper&quot;&amp;gt;&amp;lt;/div&amp;gt;
      &amp;lt;div class=&quot;vquote&quot;&amp;gt;
        {{range $cmt := $cmt.children}}
        &amp;lt;div class=&quot;vh&quot; id=&quot;{{$cmt.objectId}}&quot;&amp;gt;
          &amp;lt;div class=&quot;vhead&quot;&amp;gt;
            &amp;lt;a class=&quot;vnick&quot; rel=&quot;nofollow&quot; href=&quot;{{$cmt.link}}&quot; target=&quot;_blank&quot;&amp;gt;{{$cmt.nick}}&amp;lt;/a&amp;gt;
            &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.browser}}&amp;lt;/span&amp;gt;
            &amp;lt;span class=&quot;vsys&quot;&amp;gt;{{$cmt.os}}&amp;lt;/span&amp;gt;
          &amp;lt;/div&amp;gt;
          &amp;lt;div class=&quot;vmeta&quot;&amp;gt;
            &amp;lt;span class=&quot;vtime&quot;&amp;gt;{{dateFormat $cmt.insertedAt &quot;2006-01-02 03:04:05&quot;}}&amp;lt;/span&amp;gt;
            &amp;lt;span class=&quot;vat&quot;&amp;gt;å›å¤&amp;lt;/span&amp;gt;
          &amp;lt;/div&amp;gt;
          &amp;lt;div class=&quot;vcontent&quot; data-expand=&quot;æŸ¥çœ‹æ›´å¤š...&quot;&amp;gt;
            {{$cmt.comment | safeHTML}}
          &amp;lt;/div&amp;gt;
          &amp;lt;div class=&quot;vreply-wrapper&quot;&amp;gt;&amp;lt;/div&amp;gt;
        &amp;lt;/div&amp;gt;
        {{end}}
      &amp;lt;/div&amp;gt;
    &amp;lt;/div&amp;gt;
  &amp;lt;/div&amp;gt;
  {{end}}
&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&quot;-æ„å»ºè§¦å‘&quot;&gt;ğŸ³ æ„å»ºè§¦å‘&lt;/h3&gt;
&lt;p&gt;Waline åœ¨è¯„è®ºå‘å¸ƒã€æ›´æ–°å’Œåˆ é™¤é˜¶æ®µéƒ½æ”¯æŒè‡ªå®šä¹‰é’©å­ï¼Œåœ¨é’©å­ä¸­è§¦å‘ Vercel çš„æ„å»ºé’©å­å³å¯å®Œæˆå‘å¸ƒè¯„è®ºé‡æ–°æ„å»ºçš„æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§å¦‚ä¸‹å†…å®¹ä¿®æ”¹æœåŠ¡ç«¯éƒ¨ç½²çš„ &lt;code&gt;index.js&lt;/code&gt; æ–‡ä»¶ï¼Œ&lt;a href=&quot;https://waline.js.org/server/basic.html#%E8%AF%84%E8%AE%BA-hooks&quot;&gt;æŸ¥çœ‹æ–‡æ¡£&lt;/a&gt;äº†è§£å…¨éƒ¨çš„ Waline é’©å­ã€‚&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;chroma&quot;&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Waline&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;@waline/vercel&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;https&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kr&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&#x27;https://api.vercel.com/v1/integrations/deploy/xxxxx&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Waline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postSave&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;comment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&#x27;approved&#x27;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postUpdate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;kr&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;postDelete&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;buildTrigger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&quot;-åè®°&quot;&gt;ğŸ¾ åè®°&lt;/h2&gt;
&lt;p&gt;é€šè¿‡ä»¥ä¸Šæ“ä½œï¼Œå°±èƒ½åœ¨ä¸æŸå¤±ç”¨æˆ·ä½“éªŒçš„æƒ…å†µä¸‹å®ç°è¯„è®ºæ•°æ®çš„åŠ¨æ€æ”¯æŒäº†ã€‚æœ‰äº›äººå¯èƒ½ä¼šæ‹…å¿ƒæ˜¯å¦ä¼šåœ¨æ„å»ºé˜¶æ®µé€ æˆè¶…å¤šçš„æ¥å£è¯·æ±‚ã€‚è¿™é‡Œå¤§å¯ä¸ç”¨æ‹…å¿ƒï¼ŒHugo è‡ªå·±ä¼šåœ¨æ„å»ºçš„æ—¶å€™åšæ¥å£çš„ç¼“å­˜ï¼ŒåŒ URL çš„æ¥å£è°ƒç”¨ä¼šèµ°ç¼“å­˜æ•°æ®è€Œä¸ä¼šé‡æ–°è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†ç”¨æˆ·ä½“éªŒä¹‹å¤–ï¼Œç”±äºåªä¼šåœ¨æ„å»ºçš„æ—¶å€™è§¦å‘æ•°æ®çš„è·å–ï¼Œé’ˆå¯¹æœ‰è°ƒç”¨æ¬¡æ•°é…é¢çš„ç¬¬ä¸‰æ–¹è¯„è®ºæœåŠ¡ä¹Ÿèƒ½èŠ‚çœé¢åº¦ã€‚å½“ç„¶ï¼Œç†è®ºä¸Šæ„å»ºæ¬¡æ•°æ˜¯è¿œå°äºè®¿é—®æ¬¡æ•°çš„ï¼Œæ‰€ä»¥é¢åº¦èŠ‚çœçš„ç»“è®ºæ˜¯èƒ½æˆç«‹çš„ã€‚å¦‚æœè¯´ä½ çš„æ„å»ºæ¬¡æ•°è¦æ¯”è®¿é—®æ¬¡æ•°è¿˜è¦å¤§çš„è¯ï¼Œé‚£è¿™ç§æ–¹æ³•å°±æ— æ³•èŠ‚çœé¢åº¦äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶è¿™ç§æ–¹å¼ä¹Ÿä¼šæœ‰å¸¦æ¥äº›é—®é¢˜ï¼Œä¸»è¦æ˜¯è¯„è®ºçš„æ›´æ–°æ²¡é‚£ä¹ˆå¿«ã€‚å¥½åœ¨ Hugo çš„æ„å»ºé€Ÿåº¦éå¸¸å¿«ï¼Œä¸€ä¸¤åˆ†é’Ÿçš„æ—¶é—´ä¹Ÿèƒ½æ¥å—ã€‚è€Œé’ˆå¯¹ç”¨æˆ·è¯„è®ºçš„å‘å¸ƒï¼Œåˆ™å¯ä»¥é€šè¿‡è¯„è®ºå‘å¸ƒåå…ˆå‡æ’å…¥ç¼“è§£è¯¥é—®é¢˜ã€‚&lt;/p&gt;

        &lt;/div&gt;

        
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>b561f9bb140d08cce309d8cd9d2c7f38</guid>
<title>æ·±å…¥ç†è§£ Flutter çš„å›¾å½¢å›¾åƒç»˜åˆ¶åŸç†ï¼šå›¾å½¢åº“ skia å‰–æ</title>
<link>https://toutiao.io/k/v57wvqz</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;p cid=&quot;n2&quot; mdtype=&quot;paragraph&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;span&gt;Flutteræ˜¯ç›®å‰æµè¡Œçš„é«˜æ€§èƒ½è·¨å¹³å°UIæ¡†æ¶ï¼Œå›¾å½¢åº“skiaæ˜¯å…¶è·¨å¹³å°çš„åŸºçŸ³ã€‚æœ¬æ–‡å°†æ·±å…¥åˆ†æskiaçš„å›¾å½¢ã€å­—ä½“ã€å›¾ç‰‡çš„æ¸²æŸ“åŸç†ï¼Œå¦‚ä½•æŒ–æ˜ç¡¬ä»¶ç‰¹æ€§ï¼Œä¸ºUIæ€§èƒ½ä¼˜åŒ–æä¾›æ€è·¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n4&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;1. å¼•è¨€&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n5&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Flutteræ˜¯ç›®å‰éå¸¸æµè¡Œçš„è·¨å¹³å°UIå¼€å‘æ¡†æ¶ï¼Œä¸ä»…æ”¯æŒAndroidã€iOSï¼Œè¿˜æ”¯æŒWindowsã€Linuxç­‰æ“ä½œç³»ç»Ÿã€‚Flutterçš„æ€§èƒ½éå¸¸é«˜ï¼Œæ‹¥æœ‰120fpsçš„åˆ·æ–°ç‡ã€‚é‚£ä¹ˆflutteræ˜¯å¦‚ä½•å®ç°åœ¨ä¸åŒå¹³å°ä¸Šé«˜æ€§èƒ½ç»˜åˆ¶å›¾å½¢å›¾åƒçš„å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬åˆ†æä¸‹Flutter Appå’ŒåŸç”ŸAndroid Appã€åŸç”ŸiOS Appçš„UIç»˜åˆ¶åŸç†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.7388059701492538&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXX7oI8QhzlPCKOgib48S4NOgZqzGvj3tCnibmmD47KrFBL8aicrChwoo2g/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;670&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n7&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç§»åŠ¨Appçš„æ•´ä½“UIæ¡†æ¶å¤§è‡´åˆ†æˆä¸‹é¢4ä¸ªå±‚æ¬¡ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n8&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;1ï¼‰UIåº“&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n9&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;è·ŸAndroidã€iOSåŸç”Ÿå¼€å‘ç±»ä¼¼ï¼ŒFlutterç”¨dartè¯­è¨€å®ç°ä¸€æ•´å¥—UIæ§ä»¶ã€‚Flutterå…ˆå°†æ§ä»¶æ ‘è½¬æˆæ¸²æŸ“æ ‘ï¼Œç„¶åäº¤ç”±skiaåº“ç»˜åˆ¶ç•Œé¢ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n10&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;2ï¼‰å›¾å½¢åº“&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n11&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaå›¾å½¢åº“è·ŸiOSå¹³å°çš„CoreAnimationç­‰åº“åŠŸèƒ½ç±»ä¼¼ï¼Œä¸ä»…æä¾›äº†å›¾å½¢æ¸²æŸ“åŠŸèƒ½ï¼Œè¿˜æä¾›æ–‡å­—ç»˜åˆ¶å’Œå›¾ç‰‡æ˜¾ç¤ºåŠŸèƒ½ã€‚é«˜çº§å›¾å½¢å›¾åƒåº“å°†éœ€è¦ç»˜åˆ¶çš„å›¾å½¢è½¬æˆç‚¹ã€çº¿ã€ä¸‰è§’å½¢ç­‰å›¾å…ƒï¼Œå†è°ƒç”¨åº•å±‚å›¾å½¢æ¥å£å®ç°ç»˜åˆ¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n12&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;3ï¼‰ä½çº§å›¾å½¢æ¥å£&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n13&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;OpenGLæ˜¯ä½¿ç”¨æœ€å¹¿çš„ä½çº§å›¾å½¢æ¥å£ï¼Œå…¼å®¹æ€§æœ€å¥½ï¼ŒåŸºæœ¬ä¸Šæ”¯æŒå¸‚é¢ä¸Šçš„æ‰€æœ‰GPUã€‚Vulkanæ˜¯æœ€è¿‘å‡ å¹´æ–°æ¨å‡ºçš„å›¾å½¢APIï¼Œé™¤äº†iPhoneçš„GPUï¼Œå…¶ä»–å‚å®¶çš„GPUåŸºæœ¬éƒ½æ”¯æŒã€‚Metalæ˜¯è‹¹æœæ–°æ¨å‡ºçš„å›¾å½¢APIï¼Œåªæ”¯æŒè‡ªå®¶GPUã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n14&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;4ï¼‰ç¡¬ä»¶è®¾å¤‡å±‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n15&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç›®å‰çš„ç§»åŠ¨è®¾å¤‡å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œå¤§éƒ¨åˆ†å›¾å½¢éƒ½æ˜¯é€šè¿‡GPUæ¸²æŸ“ï¼Œå°‘æ•°æƒ…å†µä¹Ÿä¼šä½¿ç”¨CPUæ¸²æŸ“ï¼Œåæ–‡ä¼šä»‹ç»skiaä½¿ç”¨CPUå’ŒGPUæ¸²æŸ“çš„å…·ä½“åœºæ™¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n16&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;iPhone åœ¨A11èŠ¯ç‰‡ä»¥å‰ä½¿ç”¨power vrç³»åˆ—GPUï¼Œä¹‹åé‡‡ç”¨è‡ªç ”GPUã€‚å®‰å“æ‰‹æœºå¤§éƒ¨åˆ†é‡‡ç”¨é«˜é€šAdreno GPUæˆ–ARM mail GPUã€‚GPUæ¸²æŸ“å®Œä¸€å¸§å›¾åƒåé€FrameBufferï¼Œæœ€ååœ¨åˆé€‚çš„æ—¶æœºå±•ç¤ºåœ¨å±å¹•ä¸Šã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n17&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaåº”ç”¨å¹¿æ³›å¹¶ä¸”è·¨å¹³å°ï¼Œä¸ä»…ç”¨äºFlutterå’ŒAndroidæ“ä½œç³»ç»Ÿï¼Œè¿˜ç”¨äºGoogle Chromeæµè§ˆå™¨ï¼ŒåŒæ—¶æ”¯æŒwindowsã€Macã€iOSæ“ä½œç³»ç»Ÿã€‚Skiaç”±C++ç¼–å†™ï¼Œä»£ç å¼€æºï¼Œé€šè¿‡ç ”ç©¶skiaæœ‰åŠ©äºç†è§£å›¾å½¢å›¾åƒçš„ç»˜åˆ¶åŸç†ï¼Œä¸ºUIæ€§èƒ½ä¼˜åŒ–æä¾›æ€è·¯ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n18&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;2. skia æ¡†æ¶åˆ†æ&lt;/span&gt;&lt;/h2&gt;&lt;h3 cid=&quot;n19&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;2.1 Skiaå¤–éƒ¨ç»„ä»¶ä¾èµ–&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n20&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ä¼—å¤šï¼ŒåŒ…æ‹¬å­—ä½“è§£æåº“freeType,å›¾ç‰‡ç¼–è§£ç åº“libjpeg-turboã€libpngã€libgifocodeã€libwebpå’Œpdfæ–‡æ¡£å¤„ç†åº“fpdfembç­‰ã€‚Skiaæ”¯æŒå¤šç§è½¯ç¡¬ä»¶å¹³å°ï¼Œæ—¢æ”¯æŒARMå’Œx86æŒ‡ä»¤é›†ï¼Œä¹Ÿæ”¯æŒOpenGLã€Metalå’ŒVulkanä½çº§å›¾å½¢æ¥å£ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.5723350253807107&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXJge0keibrVLM2jfibOuDU7ETcWURnR7GlET4Un4hbOzvCoU4G61dAeDg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;788&quot;/&gt;&lt;/p&gt;&lt;h3 cid=&quot;n22&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;2.2 Skia å±‚æ¬¡åˆ†æ&lt;/span&gt;&lt;br/&gt;&lt;/h3&gt;&lt;p cid=&quot;n23&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaåœ¨ç»“æ„ä¸Šå¤§è‡´åˆ†æˆä¸‰å±‚ï¼šç”»å¸ƒå±‚ï¼Œæ¸²æŸ“è®¾å¤‡å±‚å’Œå°è£…é€‚é…å±‚ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.4991364421416235&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjX9an0NNZqFUW5YN4D7vHvKHY8vSv1b1yqaFqcQpk5VKlQvnjJriaJHpw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;579&quot;/&gt;&lt;/p&gt;&lt;h4 cid=&quot;n26&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;2.2.1 ç”»å¸ƒå±‚&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n27&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç”»å¸ƒå±‚å¯ä»¥ç†è§£æˆæä¾›ç»™å¼€å‘è€…åœ¨ä¸€ä¸ªè®¾å¤‡æ— å…³çš„ç”»å¸ƒï¼Œå¯ä»¥åœ¨ä¸Šé¢ç»˜åˆ¶å„ç§å›¾å½¢ï¼Œä¸”ä¸ç”¨å…³å¿ƒç¡¬ä»¶ç»†èŠ‚ï¼ŒåŠŸèƒ½å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;figure cid=&quot;n28&quot; mdtype=&quot;table&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr cid=&quot;n29&quot; mdtype=&quot;table_row&quot;&gt;&lt;th&gt;&lt;span&gt;ç±»åˆ«&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;å‡½æ•°å&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;å«ä¹‰&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr cid=&quot;n33&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawPoints&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»ç‚¹&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n37&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawRect&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»çŸ©å½¢&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n41&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawVertices&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»å¤šè¾¹å½¢&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n45&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawRoundRect&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»åœ†è§’çŸ©å½¢&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n49&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawArc&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»åœ†å¼§&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n53&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawOval&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»æ¤­åœ†&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n57&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç”»å›¾å½¢&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawPath&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç”»çŸ¢é‡å›¾&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n61&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç»˜åˆ¶æ–‡å­—&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawText&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ˜¾ç¤ºæ–‡å­—&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n65&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;æ˜¾ç¤ºå›¾ç‰‡&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;drawBitmap&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ˜¾ç¤ºä½å›¾&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h4 cid=&quot;n69&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;å·¦å³æ»‘åŠ¨æŸ¥çœ‹å®Œæ•´è¡¨æ ¼&lt;/span&gt;&lt;/h4&gt;&lt;h4 cid=&quot;n69&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;2.2.2 æ¸²æŸ“è®¾å¤‡å±‚&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n70&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;æ¸²æŸ“è®¾å¤‡å±‚è´Ÿè´£ç”»å¸ƒå±‚çš„ç¡¬ä»¶å®ç°ï¼Œskiaå°†è®¾å¤‡å°è£…æˆä¸‹é¢ä¸‰ä¸ªç±»ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n71&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;1ï¼‰SKBitmapDevice&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n72&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;CPUæ¸²æŸ“æ¨¡å¼ç»˜å›¾ï¼Œç”¨äºæ²¡æœ‰æ˜¾å¡æˆ–è€…æ˜¾å¡é©±åŠ¨çš„è®¾å¤‡ã€‚æ­¤æ¨¡å¼ä¸‹ï¼Œæœ€åä¼šå°†éœ€è¦ç»˜åˆ¶çš„å›¾å½¢è½¬æˆä½å›¾æ•°æ®ï¼ˆRGBï¼‰å†™å…¥æŒ‡å®šå†…å­˜ï¼Œæ•…ç§°ä¸ºBitmapDeviceã€‚å†™å†…å­˜æ“ä½œé€šè¿‡AVXæˆ–è€…NEONæŒ‡ä»¤é›†å®ç°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n73&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;2ï¼‰SKGPUDevice&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n74&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;GPUæ¸²æŸ“æ–¹å¼ç»˜å›¾ã€‚ç›®å‰å¤§éƒ¨åˆ†ç§»åŠ¨è®¾å¤‡å’Œä¸ªäººç”µè„‘éƒ½æœ‰GPUï¼ŒGPUæ¯”CPUçš„è¿ç®—å•å…ƒå¤šï¼Œå¹¶è¡Œè®¡ç®—èƒ½åŠ›å¼ºï¼Œé€šè¿‡GPUç»˜å›¾å¯é™ä½CPUå ç”¨ï¼Œæ€§èƒ½æ›´å¥½ã€‚Flutterã€æœ€æ–°ç‰ˆæœ¬çš„chromeå’Œandroidç³»ç»Ÿé»˜è®¤è®¾ç½®ä¸ºGPUæ¸²æŸ“æ¨¡å¼ã€‚Chromeä¸­çš„é…ç½®æˆªå›¾å¦‚ä¸‹ï¼Œå¯çœ‹åˆ°é»˜è®¤é‡‡ç”¨GPUæ¸²æŸ“ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.26987951807228916&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjX4qZ69a4uMNRE3hjGGpibwOL4mJ8EtUHpCoKicZBnMvAyArC1H6ibHsdjw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;415&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n76&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;3ï¼‰SKPDFDevice&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n77&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;é€‰ç”¨æ­¤è®¾å¤‡æ—¶ï¼Œæ¸²æŸ“ç»“æœä¸æ˜¯è¾“å‡ºåˆ°æ˜¾ç¤ºå™¨çš„ç”»é¢ï¼Œè€Œæ˜¯è¾“å‡ºä¸ºpdfæ–‡ä»¶ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n78&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;å¯ä»¥é€šè¿‡skiaå®˜ç½‘åœ¨çº¿ä½“éªŒä¸åŒè®¾å¤‡çš„æ¸²æŸ“ç»“æœï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://fiddle.skia.org/c/@shapes&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n79&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;2.2.3å°è£…é€‚é…å±‚&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n80&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaä¸ºäº†å±è”½ä¸åŒä¾èµ–åº“çš„æ¥å£å·®å¼‚ï¼Œå¯¹ä¾èµ–åº“è¿›è¡Œäº†å°è£…å’Œé€‚é…ã€‚ä¾‹å¦‚åŸºäºå›¾ç‰‡ç¼–è§£ç åº“libjpeg-turboã€libpngã€libwebp å°è£…äº†ç±»SKJpegCodecã€SKPngCodecã€SKWebpCodecã€‚åŸºäºåº•å±‚å›¾å½¢åº“OpenGLã€Metalã€Vulkanå°è£…äº†GrGLOpsRenderPassï¼Œ GrMTOpsRenderPass, GrVKOpsRenderPassä¸‰ä¸ªç±»ã€‚åŸºäºè‹¹æœå¹³å°CoreTextå­—ä½“åº“å’Œå¼€æºå­—ä½“FreeTypeå°è£…äº†ç±»SkScalerContext_Macå’ŒSkScalerContext_FreeTypeã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n81&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaçš„å¤–éƒ¨ä¾èµ–å’Œå±‚çº§ç»“æ„è®²è§£å®Œæ¯•ï¼Œä¸‹é¢é‡ç‚¹è®²è§£skiaçš„å›¾å½¢ã€æ–‡å­—å’Œå›¾ç‰‡çš„ç»˜åˆ¶åŸç†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n82&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;3. å›¾å½¢ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n83&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaæ”¯æŒç»˜åˆ¶çš„å›¾å½¢ä¼—å¤šï¼ŒåŒ…æ‹¬åœ†å½¢ã€æ¤­åœ†ã€çŸ©å½¢ã€è´å¡å°”æ›²çº¿ç­‰ã€‚ä¸‹æ–‡é‡ç‚¹åˆ†æå›¾å½¢çš„CPUå’ŒGPUä¸¤ç§æ¸²æŸ“æ¨¡å¼çš„åŸç†ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n84&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;3.1 å›¾å½¢CPUæ¸²æŸ“åŸç†&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n85&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;æ›²çº¿çš„ç»˜åˆ¶æ¶‰åŠçš„æ•°å­¦çŸ¥è¯†è¾ƒå¤šï¼Œæœ¬æ–‡ä¸å†å±•å¼€ï¼Œä¸‹é¢ä»¥ç»˜åˆ¶å®å¿ƒçŸ©å½¢ä¸ºä¾‹è¯´æ˜åŸç†è¿›è¡Œå‰–æã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.9265734265734266&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjX4icPT1AO3Wc9ibFfugWhXwtr4gXmKjje0ibUaiaKfNIG7Pib2ZlXicvau8VQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;572&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n87&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;1ï¼‰è°ƒç”¨ç”»å¸ƒçš„ç»˜å›¾API&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n88&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;åº”ç”¨å±‚è°ƒç”¨ç”»å¸ƒSKCanvasçš„drawRectå‡½æ•°ï¼Œä¼ å…¥å·¦ä¸Šè§’å’Œå³ä¸‹è§’é¡¶ç‚¹åæ ‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n89&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;2ï¼‰é€‰ç”¨å¯¹åº”çš„è®¾å¤‡çš„ç»˜å›¾API&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n90&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç”±äºé€‰æ‹©çš„æ˜¯CPUæ¸²æŸ“æ¨¡å¼ï¼Œæ•…è°ƒç”¨SKBitmapDeviceçš„çŸ©å½¢ç»˜å›¾å‡½æ•°drawRectå®ç°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n91&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;3ï¼‰å›¾å½¢è¡¨ç¤º&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n92&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;æ‰€æœ‰çš„å›¾å½¢å¯åˆ†è§£æˆä¸‹é¢å‡ ç§åŸºæœ¬çŸ¢é‡å›¾å½¢çš„ç»„åˆï¼ŒçŸ©å½¢å¯è¡¨ç¤ºæˆå››æ¡ç›´çº¿çš„ç»„åˆã€‚&lt;/span&gt;&lt;/p&gt;&lt;figure cid=&quot;n93&quot; mdtype=&quot;table&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr cid=&quot;n94&quot; mdtype=&quot;table_row&quot;&gt;&lt;th&gt;&lt;span&gt;æ›²çº¿ç±»å‹&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;å‚æ•°&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;ç”¨é€”&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr cid=&quot;n98&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ç›´çº¿ï¼ˆä¸€æ¬¡è´å¡å°”æ›²çº¿ï¼‰&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;èµ·ç‚¹åæ ‡ï¼Œç»ˆç‚¹åæ ‡&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;å¯è¡¨ç¤ºç»˜åˆ¶ä¸‰è§’å½¢ã€å››è¾¹å½¢ç­‰å¤šè¾¹å½¢&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n102&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;åœ†é”¥æ›²çº¿&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;èµ·ç‚¹åæ ‡ï¼Œç»ˆç‚¹åæ ‡ï¼Œæ¤­åœ†å‚æ•°&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;è¡¨ç¤ºæ¤­åœ†ã€åœ†å¼§ã€åœ†å½¢&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n106&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;äºŒæ¬¡è´å¡å°”æ›²çº¿&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ä¸‰ä¸ªæ§åˆ¶ç‚¹&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;è¡¨ç¤ºTrueTypeå­—ä½“ã€æŠ›ç‰©çº¿ç­‰æ›²çº¿&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n110&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;ä¸‰æ¬¡è´å¡å°”æ›²çº¿&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;å››ä¸ªæ§åˆ¶ç‚¹&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;è¡¨ç¤ºOpenTypeå­—ä½“å’Œå…¶ä»–æ›²çº¿&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h4 cid=&quot;n69&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;å·¦å³æ»‘åŠ¨æŸ¥çœ‹å®Œæ•´è¡¨æ ¼&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n114&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;4ï¼‰ç»˜åˆ¶ç®—æ³•å®ç°&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n115&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;çŸ¢é‡å›¾è½¬æˆä½å›¾çš„è¿‡ç¨‹ç§°ä¸ºå…‰æ …åŒ–ã€‚å¸¦å¡«å……çš„çŸ©å½¢å…‰æ …åŒ–è¿‡ç¨‹æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥åˆ†è§£æˆç»˜åˆ¶å¤šæ¡æ¨ªçº¿ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n116&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;5ï¼‰æ¨ªçº¿çº¿ç»˜åˆ¶ç®—æ³•&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n117&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;æ¯æ¡æ¨ªå‘çš„ç”»æ³•é€šè¿‡SKBlitter:: blitHå®ç°ã€‚æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n255&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;virtual void blitH(int x, int y, int width);&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n257&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;åŠŸèƒ½ï¼šä»åæ ‡x,yå¼€å§‹ï¼Œè¿ç»­å†™å…¥å®½åº¦ä¸ºwidthçš„RGBé¢œè‰²å€¼ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n118&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;6ï¼‰å†…å­˜ä¸­å†™é¢œè‰²æ•°æ®&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n119&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;é€šè¿‡è¿½è¸ªä»£ç ï¼Œå‘ç°ä¸Šæ–‡ä¸­çš„æ¨ªçº¿ç»˜åˆ¶å‡½æ•°è°ƒç”¨çš„æ˜¯memsetTå‡½æ•°ï¼ˆå†…å­˜èµ‹å€¼ï¼‰å®ç°ã€‚å‚æ•°å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n120&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;static void memsetT(T buffer[], T value, int count)&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n121&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç›®å‰x86å’ŒARMå¤„ç†å™¨æ˜¯32æˆ–è€…64ä½ï¼Œæ™®é€šçš„æŒ‡ä»¤ä¸€æ¬¡æœ€å¤šå†™å…¥32ä½ æˆ–è€…64ä½æ•°æ®ï¼Œä¸€ä¸ªå¸¦é€æ˜é€šé“çš„ç‚¹é€šå¸¸å 4ä¸ªå­—èŠ‚ï¼Œç›¸å½“äºä¸€æ¬¡åªèƒ½ç»˜åˆ¶1åˆ°2ä¸ªç‚¹ï¼Œæ•ˆç‡æ¯”è¾ƒä½ã€‚Skiaä»æ€§èƒ½è§’åº¦è€ƒè™‘ï¼Œé‡‡ç”¨çš„SIMDæŒ‡ä»¤é›†æ¥åŠ é€Ÿå†…å­˜æ“ä½œã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n122&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;åœ¨X86å¹³å°ï¼Œè°ƒç”¨SSEã€AVXã€AVX2ç­‰æŒ‡ä»¤é›†å®ç°å†…å­˜èµ‹å€¼ï¼ŒSSEæ”¯æŒä¸€æ¬¡æ“ä½œ128ä½æ“ä½œï¼ŒAVX/AVX2æ”¯æŒä¸€æ¬¡æ“ä½œ256ä½æ•°æ®ï¼ŒARMå¤„ç†å™¨çš„NEONæŒ‡ä»¤é›†æ”¯æŒä¸€æ¬¡æ“ä½œ128ä½æ•°æ®ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n123&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;3.2 å›¾å½¢GPUæ¸²æŸ“åŸç†&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n124&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;GPUçš„å¹¶è¡Œè¿ç®—èƒ½åŠ›å¼ºï¼Œç›®å‰å¤§éƒ¨åˆ†ç§»åŠ¨è®¾å¤‡éƒ½é‡‡ç”¨çš„æ˜¯GPUæ¸²æŸ“ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n260&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;skia GPUæ¸²æŸ“æµç¨‹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n125&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;1ï¼‰å‘èµ·ç»˜å›¾ï¼Œå…ˆè°ƒç”¨SKCanvasçš„ç»˜å›¾å‡½æ•°drawRectï¼Œä¼ å…¥å·¦ä¸Šè§’å’Œå³ä¸‹è§’é¡¶ç‚¹åæ ‡ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n126&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;2ï¼‰è°ƒç”¨GPUè®¾å¤‡çš„ç»˜å›¾å‡½æ•°SKGPUDevice::drawRectã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n127&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;3ï¼‰é‡‡ç”¨å‘½ä»¤æ¨¡å¼ï¼Œå°†GPUç»˜å›¾æ“ä½œå°è£…æˆç±»GrOpsTaskçš„å®ä¾‹ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n128&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;4ï¼‰æ ¹æ®è½¯ç¡¬ä»¶å¹³å°çš„ä¸åŒé€‰ç”¨ä¸åŒçš„åº•å±‚APIã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n129&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;OpenGLï¼ˆOpen Graphics Libraryâ€ï¼‰æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„è·¨å¹³å°å›¾å½¢å˜æˆæ¥å£ï¼Œè·¨å¹³å°ç‰¹æ€§å¥½ï¼Œå¤§éƒ¨åˆ†æ“ä½œç³»ç»Ÿå’ŒGPUã€‚Skiaåœ¨å¤§éƒ¨åˆ†å¹³å°é‡‡ç”¨OpenGLå®ç°GPUç»˜å›¾ï¼Œå°‘éƒ¨åˆ†å¹³å°è°ƒç”¨Metalå’Œvulkanã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n130&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Metalæ˜¯è‹¹æœå…¬å¸2014å¹´æ¨å‡ºçš„å’Œ OpenGLç±»ä¼¼çš„é¢å‘åº•å±‚çš„å›¾å½¢ç¼–ç¨‹æ¥å£ï¼Œåªæ”¯æŒiOSã€‚å¯¹è½¯ç¡¬ä»¶æœ‰è¦æ±‚ï¼Œè¦æ±‚ç¡¬ä»¶è‹¹æœA7åŠä»¥åï¼Œæ“ä½œç³»ç»ŸiOS 10åŠä»¥ä¸Šã€‚Metalç†è®ºä¸Šæ€§èƒ½æ¯”OpenGLæ€§èƒ½å¼ºï¼Œæ•…æ–°è®¾å¤‡ä¸­å¼€å¯Metalå¯æé«˜æ€§èƒ½ã€‚ä¾‹å¦‚Flutterä¸­å·²å¯ç”¨äº†metalæ”¯æŒï¼Œè¯¦æƒ…å‚è€ƒ&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://github.com/flutter/flutter/wiki/Metal-on-iOS-FAQ&lt;/span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n131&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Vulkanæ˜¯æ–°ä¸€ä»£è·¨å¹³å°çš„2Då’Œ3Dç»˜å›¾åº”ç”¨ç¨‹åºæ¥å£ï¼ˆAPIï¼‰,æ—¨åœ¨å–ä»£OpenGLï¼Œç†è®ºä¸Šæ€§èƒ½å¼ºäºOpenGLã€‚è‡ª Android 7.0 å¼€å‘è€…é¢„è§ˆç‰ˆå¼€å§‹ï¼ŒGoogleä¾¿åœ¨ç³»ç»Ÿå¹³å°ä¸­æ·»åŠ äº†å¯¹Vulkançš„APIæ”¯æŒã€‚ç›®å‰Skiaçš„GPUæ¸²æŸ“æ¨¡å¼å·²ç”¨vulkanå®ç°äº†ä¸€å¥—ï¼Œä½†å­˜åœ¨ä¸€äº›bugã€‚å…·ä½“å‚è€ƒ&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://skia.org/user/special/vulkan&lt;/span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n132&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaå¯¹ä¸Šè¿°ä¸‰ç§å›¾å½¢æ¥å£è¿›è¡Œäº†å°è£…ï¼Œå±è”½äº†ä¸åŒåº•å±‚å›¾å½¢APIæ¥å£çš„å·®å¼‚ã€‚OpenGLæ¥å£çš„å°ä¸ºGrGLOpsRenderPassï¼ŒMetalçš„å°è£…å±‚ä¸ºGrMTOpsRenderPass,Vuklançš„å°è£…å±‚ä¸º GrVKOpsRenderPassã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.7763157894736842&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXl8NeQgFa4t0s5qzs27KtV6pqKBI4u3FzqCr05ibmGTabIOALVmGE8gw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;608&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n136&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;5ï¼‰é€šè¿‡GPUå®Œæˆå‰©ä½™ç»˜å›¾æ“ä½œã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n266&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ä¸‹é¢ä»¥OpenGLä¸ºä¾‹è¯´æ˜ã€‚æ¥å£å°è£…å±‚è°ƒç”¨OpenGL glDrawArrayç»˜åˆ¶çŸ©å½¢ï¼Œä¹‹ååœ¨æ¸²æŸ“æµæ°´çº¿ä¸­å®Œæˆé¡¶ç‚¹å˜æ¢ã€å…‰æ …åŒ–å’Œç€è‰²ï¼Œæœ€åé€å¸§ç¼“å†²æ˜¾ç¤ºã€‚æ¸²æŸ“æµæ°´çº¿å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.6578947368421053&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXqNRTVXwkh9xobpLcLOEFVtouN63iciaHoahEa9YUE8A8UicVMhRBoLsoA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;304&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n138&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Metalã€vulkançš„æ¸²æŸ“æµæ°´çº¿è¿™é‡Œä¸å†å±•å¼€ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n139&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;4. å­—ä½“ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n140&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;å­—ä½“æ— æ³•ç›´æ¥æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œéœ€è¦è§£ææˆä½å›¾æˆ–è€…çŸ¢é‡å›¾æ‰èƒ½ç»˜åˆ¶ã€‚Skiaçš„å­—ä½“è§£æå®ç°è·Ÿè¿›å¹³å°å·®å¼‚æœ‰æ‰€ä¸åŒï¼Œmacå’ŒiOSå¹³å°è°ƒç”¨coreTextåº“,å®‰å“å¹³å°è°ƒç”¨å¼€æºåº“freeTypeã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n141&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;FreeTypeæ˜¯ä¸€ä¸ªç”¨Cè¯­è¨€å®ç°çš„ï¼Œå…è´¹çš„é«˜è´¨é‡å¯ç§»æ¤å­—ä½“å¼•æ“ï¼Œæ”¯æŒç‚¹é˜µå­—ä½“PCFã€BDFå’ŒçŸ¢é‡å­—ä½“TrueTypeã€freeTypeç­‰å­—ä½“ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n142&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;4.1 skiaç‚¹é˜µå­—ä½“ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n143&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaæ”¯æŒçš„ç‚¹é˜µå­—ä½“æœ‰PCFã€BDFæ ¼å¼ã€‚ç‚¹é˜µå­˜å‚¨çš„æ˜¯å¤šå¼ ä½å›¾ï¼Œå¸¸è§çš„æœ‰16&lt;em&gt;16ï¼Œ24&lt;/em&gt;24ï¼Œ32*32ç­‰å°ºå¯¸ï¼Œè§£ç å’Œæ˜¾ç¤ºç®€å•ï¼Œç¼ºç‚¹æ˜¯æ”¾å¤§åæœ‰é”¯é½¿ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p cid=&quot;n144&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;1) skiaç‚¹é˜µæ–‡å­—æ˜¾ç¤ºä»£ç ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;SkFont font;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;font.setEdging(SkFont::Edging::kAlias);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;font.setSize(40);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;const char text[] = &quot;Click this link!&quot;;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;size_t byteLength = strlen(static_cast&amp;lt;const char*&amp;gt;(text));&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;canvas-&amp;gt;drawSimpleText(text, byteLength, SkTextEncoding::kUTF8, x, y, font, SkPaint());&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n144&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;æ–‡å­—ç»˜åˆ¶æµç¨‹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.0201342281879195&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjX8JMjOdpsicDoruWFbBPiciakc1pmUSwhPY4W8b26Lu13WRMiaWqcmkhKtA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;447&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n283&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç‚¹é˜µå­—ä½“æœ€åè§£ææˆäº†ä½å›¾ï¼Œç„¶åæ ¹æ®å¹³å°ä¸åŒé€‰ç”¨CPUæˆ–è€…GPUæ¸²æŸ“å‡ºæ¥ã€‚Skiaä¸ºäº†æé«˜å­—ä½“æ˜¾ç¤ºé€Ÿåº¦ï¼Œå¯¹å­—ä½“çš„è§£æç»“æœåšäº†å†…å­˜ç¼“å­˜ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h3 cid=&quot;n154&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;4.2 çŸ¢é‡å­—ä½“ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n155&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;çŸ¢é‡å­—ä½“ä¸»è¦é€šè¿‡è´å¡å°”æ›²çº¿æè¿°å­—ä½“ï¼Œå­˜å‚¨ç©ºé—´å°ï¼Œä½†æ¸²æŸ“å¤æ‚ï¼Œè¿˜éœ€è¦å¯¼å…¥å­—ä½“åº“æ–‡ä»¶ã€‚Skiaæ”¯æŒçš„çŸ¢é‡å­—ä½“æœ‰tff(true type font)å’Œotf(open true type)æ ¼å¼ã€‚å‰è€…é‡‡ç”¨äºŒæ¬¡è´å¡å°”æ›²çº¿è¡¨ç¤ºï¼Œåè€…é‡‡ç”¨ä¸‰æ¬¡è´å¡å°”æ›²çº¿è¡¨ç¤ºã€‚Skiaä¸­çŸ¢é‡æ–‡å­—ç»˜åˆ¶ä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;SkPaint p;&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    p.setStyle(SkPaint::kStroke_Style);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    p.setStrokeWidth(10);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    p.setARGB(0xff, 0xbb, 0x00, 0x00);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;   sk_sp&amp;lt;SkTypeface&amp;gt; ttf = MakeResourceAsTypeface(&quot;fonts/Stroking.ttf&quot;);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;SkFont font(ttf, 100);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;if (ttf) {&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        SkFont font(ttf, 100);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;        canvas-&amp;gt;drawString(&quot;â—‹â—‰  â»â‚‹âºâ‚Š&quot;, 10, 100, font, p);&lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n155&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ç»˜åˆ¶æµç¨‹å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;1.025&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXNq83QcoZFdXefCHr36H6KHmC9ibfpIejRWQ8MuxxtkU73iaXic7rHzTHA/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;440&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n168&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;çŸ¢é‡å­—ä½“çš„ç»˜åˆ¶æµç¨‹è·Ÿç‚¹é˜µå­—ä½“å¤§éƒ¨åˆ†ä¸€æ ·ï¼Œä¸åŒä¹‹å¤„åœ¨äºè§£æç»“æœä¸ºè´å¡å°”æ›²çº¿ã€‚è´å¡å°”æ›²çº¿çš„æ¸²æŸ“ç®—æ³•ç¨å¾®å¤æ‚ï¼Œå‚è€ƒæ–‡ç« &lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://www3.cs.stonybrook.edu/~qin/courses/geometry/4.pdf&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n169&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;5. å›¾ç‰‡ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h2&gt;&lt;h3 cid=&quot;n170&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;5.1 Skiaä½å›¾ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n171&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;skiaæä¾›äº†showBitmapå‡½æ•°å¯ç›´æ¥æ˜¾ç¤ºä½å›¾ã€‚ä½å›¾æ¸²æŸ“æ¨¡å¼è·ŸçŸ¢é‡å›¾å½¢ç±»ä¼¼ï¼Œåˆ†ä¸ºCPUæ¸²æŸ“å’ŒGPUæ¸²æŸ“ã€‚ä½å›¾çš„CPUæ¸²æŸ“è·Ÿå®å¿ƒçŸ©å½¢çš„æ¸²æŸ“åŸç†ç±»ä¼¼ï¼Œé€šè¿‡SIMDæŒ‡ä»¤é›†å°†ä½å›¾å†…å­˜ä¸€è¡Œä¸€è¡Œæ‹·è´åˆ°æŒ‡å®šå†…å­˜ç¼“å­˜ä¸­ã€‚GPUæ¸²æŸ“æ¨¡å¼é€šè¿‡è°ƒç”¨OpenGLã€Metalã€vulkançš„çº¹ç†è´´å›¾å‡½æ•°å®ç°ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.5407503234152652&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXb9OD6vmJ1ksk7G5XFic8UW4Al6aUIeDJIoVkcIQUAJ8o7kibTxyFlHUQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;773&quot;/&gt;&lt;/p&gt;&lt;h3 cid=&quot;n292&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;5.2 Skiaå‹ç¼©æ ¼å¼å›¾ç‰‡ç»˜åˆ¶åŸç†&lt;/span&gt;&lt;/h3&gt;&lt;p cid=&quot;n174&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;ä½å›¾ç”±äºå ç”¨ç©ºé—´å¤§ï¼Œä½¿ç”¨é¢‘ç‡ä½ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½¿ç”¨å‹ç¼©æ ¼å¼å›¾ç‰‡ã€‚Skiaæ”¯æŒçš„å‹ç¼©æ ¼å¼å›¾ç‰‡å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;figure cid=&quot;n175&quot; mdtype=&quot;table&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr cid=&quot;n176&quot; mdtype=&quot;table_row&quot;&gt;&lt;th&gt;&lt;span&gt;æ ¼å¼&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;ä¼˜ç‚¹&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;ç¼ºç‚¹&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;åœºæ™¯&lt;/span&gt;&lt;/th&gt;&lt;th&gt;&lt;span&gt;ä¾èµ–è§£ç åº“&lt;/span&gt;&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr cid=&quot;n182&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;gif&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ–‡ä»¶å°ï¼Œæ”¯æŒåŠ¨ç”»ã€é€æ˜ï¼Œæ— å…¼å®¹æ€§é—®é¢˜&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;åªæ”¯æŒç§é¢œè‰²ï¼Œä¸”é€æ˜åº¦åªæœ‰1ä½ï¼Œæœ‰ç™½è¾¹å’Œé”¯é½¿&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ç®€å•çš„åŠ¨å›¾&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;libgifcodec&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n188&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;jpg&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ”¯æŒä½çœŸå½©è‰²ï¼Œå‹ç¼©ç‡é«˜&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æœ‰æŸå‹ç¼©ï¼Œä¸æ”¯æŒé€æ˜é€šé“&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;è‰²å½©ä¸°å¯Œçš„å›¾ç‰‡&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;libjpeg-turbo&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n194&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;png&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ— æŸå‹ç¼©ï¼Œæ”¯æŒé€æ˜ï¼Œç®€å•å›¾ç‰‡å°ºå¯¸å°&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;ä¸æ”¯æŒåŠ¨ç”»ï¼Œå‹ç¼©ç‡ä½&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;logo/icon/é€æ˜å›¾&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;libpng&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr cid=&quot;n200&quot; mdtype=&quot;table_row&quot;&gt;&lt;td&gt;&lt;span&gt;webp&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ¯”jpegå‹ç¼©ç‡æ›´é«˜ï¼Œæ”¯æŒæœ‰æŸå’Œæ— æŸå‹ç¼©ï¼Œæ”¯æŒåŠ¨ç”»ã€é€æ˜é€šé“&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;è°·æ­Œè‡ªç ”æ ¼å¼ï¼Œéƒ¨åˆ†å¹³å°ä¸æ”¯æŒã€‚&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;æ”¯æŒæœ‰æŸå’Œæ— æŸå‹ç¼©æ ¼å¼ï¼Œæ”¯æŒåŠ¨ç”»&lt;/span&gt;&lt;/td&gt;&lt;td&gt;&lt;span&gt;libwebp&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;&lt;h4 cid=&quot;n69&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;å·¦å³æ»‘åŠ¨æŸ¥çœ‹å®Œæ•´è¡¨æ ¼&lt;/span&gt;&lt;/h4&gt;&lt;p cid=&quot;n206&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;å‹ç¼©æ ¼å¼å›¾ç‰‡ä½¿ç”¨ä»£ç å¦‚ä¸‹ï¼š&lt;/span&gt;&lt;/p&gt;&lt;section class=&quot;code-snippet__fix code-snippet__js&quot;&gt;&lt;pre class=&quot;code-snippet__js&quot; data-lang=&quot;cpp&quot;&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;SkCanvas c(dst);  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    SkBitmap src;  &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    SkImageDecoder::DecodeFile(â€œtest.jpgâ€, &amp;amp;src);//  å›¾ç‰‡è§£ç &lt;/span&gt;&lt;/code&gt;&lt;code&gt;&lt;span class=&quot;code-snippet_outer&quot;&gt;    c.drawBitmap(src, 0, 0, NULL);  //å›¾ç‰‡æ˜¾ç¤º&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;p cid=&quot;n206&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;æ˜¾ç¤ºæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages js_insertlocalimg&quot; data-ratio=&quot;0.8160377358490566&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxg8MJWE7VFSOYEDMqHzahjXPvg5u1dxIicsTkWsVFq1y2M6XRQB2lNh4StHJCwRlvibyUlKmgBN5jEQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;424&quot;/&gt;&lt;/p&gt;&lt;p cid=&quot;n213&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;è¯»å–æ–‡ä»¶åï¼Œå…ˆé€šè¿‡æ–‡ä»¶å¤´åˆ¤æ–­å›¾ç‰‡ç±»å‹ï¼Œç„¶åé€ç›¸åº”çš„å›¾ç‰‡åº“è§£ç æˆä½å›¾å›¾åƒåï¼Œå†é€šè¿‡CPUæˆ–è€…GPUæ¸²æŸ“ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h2 cid=&quot;n214&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;6. skiaå°ç»“&lt;/span&gt;&lt;/h2&gt;&lt;p cid=&quot;n215&quot; mdtype=&quot;paragraph&quot;&gt;&lt;span&gt;Skiaæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„è·¨å¹³å°å›¾å½¢åº“ï¼Œèƒ½ç»˜åˆ¶çŸ©å½¢ã€åœ†å½¢ã€è´å¡å°”æ›²çº¿ç­‰çŸ¢é‡å›¾ï¼Œç»˜åˆ¶ç‚¹é˜µå­—ä½“å’ŒçŸ¢é‡å­—ä½“ï¼Œæ˜¾ç¤ºjpegã€pngã€gifã€webpç­‰å›¾ç‰‡ï¼ŒåŒæ—¶æ€§èƒ½å¥½ï¼Œä»ç®—æ³•å’Œç¡¬ä»¶ä¸¤ä¸ªå±‚é¢è¿›è¡Œäº†ä¼˜åŒ–ã€‚skiaæ”¯æŒå¤šç§è½¯ç¡¬ä»¶å¹³å°ï¼Œé™¤äº†Androidã€chromeã€Flutterç­‰äº§å“ç›´æ¥å°†å…¶ä½œä¸ºå›¾å½¢å¼•æ“ï¼Œä¹Ÿæ”¯æŒiOSã€windowsç­‰æ“ä½œç³»ç»Ÿã€‚SkiaåŠŸèƒ½è¾ƒå¤šï¼Œè¿˜æ”¯æŒlottieåŠ¨ç”»ï¼Œå›¾åƒç‰¹æ•ˆï¼Œè¿˜å¼•å…¥äº†ä¸­é—´è¯­è¨€SKGLï¼Œé™äºç¯‡å¹…ï¼Œè¿™é‡Œä¸å†å±•å¼€ã€‚&lt;/span&gt;&lt;/p&gt;&lt;h4 cid=&quot;n216&quot; mdtype=&quot;heading&quot;&gt;&lt;span&gt;å‚è€ƒæ–‡æ¡£ï¼š&lt;/span&gt;&lt;/h4&gt;&lt;p&gt;&lt;span&gt;1. iOSé«˜æ€§èƒ½ç»˜å›¾ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://medium.com/@almalehdev/high-performance-drawing-on-ios-part-1-f3a24a0dcb31&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;2. Core Animation ç¼–ç¨‹æŒ‡å—ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514-CH1-SW1&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;3. skiaç¼–è¯‘æ–¹æ³•ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://skia.org/user/build&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;4&lt;span&gt;. &lt;/span&gt;SkiaæŠ€æœ¯è·¯çº¿ï¼šhttps://docs.google.com/document/d/1C9w8qpPpdgNGThqmgNnTToLZ5UYK4TsUGl5X3B_q6oM/edit&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;5&lt;span&gt;. &lt;/span&gt;SKGLè¯´æ˜ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://github.com/google/skia/blob/master/src/sksl/README&lt;/span&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;6&lt;span&gt;. &lt;/span&gt;Skiaæºç ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://skia.googlesource.com/skia.git&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;7&lt;span&gt;. &lt;/span&gt;Skia ç™¾ç§‘ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://zh.wikipedia.org/zh-cn/Skia_Graphics_Library&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;8&lt;span&gt;. &lt;/span&gt;å­—ä½“ä»‹ç»ï¼šhttp://www.klayge.org/wiki/index.php/%E5%AD%97%E4%BD%93%E7%B3%BB%E7%BB%9F&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;9&lt;span&gt;. &lt;/span&gt;FreeTypeå®˜ç½‘ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://www.freetype.org/&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;10&lt;span&gt;. &lt;/span&gt;pngå‹ç¼©åŸç†ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://www.jianshu.com/p/5ad19825a3d0&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;11&lt;span&gt;. &lt;/span&gt;GPUæ¸²æŸ“æµæ°´çº¿ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://zhuanlan.zhihu.com/p/61949898&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;12&lt;span&gt;. &lt;/span&gt;Vukanä»‹ç»ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://www.khronos.org/assets/uploads/developers/library/overview/Vk_201602_Overview_Feb16.pdf&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;13&lt;span&gt;. &lt;/span&gt;ARM Mali GPUä»‹ç»ï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://developer.arm.com/solutions/graphics-and-gaming/apis/vulkan&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;14&lt;span&gt;. &lt;/span&gt;Vulkanå’ŒOpenGL ESæ¯”è¾ƒï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://community.arm.com/developer/tools-software/graphics/b/blog/posts/initial-comparison-of-vulkan-api-vs-opengl-es-api-on-arm&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;15&lt;span&gt;. &lt;/span&gt;Qualcommå®£å¸ƒAdreno 530 GPUæ”¯æŒvulkanï¼š&lt;span md-inline=&quot;url&quot; spellcheck=&quot;false&quot;&gt;https://www.qualcomm.cn/news/releases-2016-02-18-0&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;16&lt;span&gt;. &lt;/span&gt;https://www.adobe.com/content/dam/acom/en/devnet/font/pdfs/5005.BDF_Spec.pdf&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;â˜†Â &lt;/strong&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;END&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;strong mpa-from-tpl=&quot;t&quot;&gt;Â â˜†&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;æ‹›è˜ä¿¡æ¯&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section label=&quot;Copyright Reserved by PLAYHUDONG.&quot; donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section label=&quot;Copyright Reserved by PLAYHUDONG.&quot; donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section label=&quot;Copyright Reserved by PLAYHUDONG.&quot; donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot;&gt;&lt;p&gt;&lt;span&gt;OPPOäº’è”ç½‘åŸºç¡€æŠ€æœ¯å›¢é˜Ÿæ‹›è˜ä¸€å¤§æ³¢å²—ä½ï¼Œæ¶µç›–&lt;strong&gt;C++ã€Goã€OpenJDKã€Javaã€DevOpsã€Androidã€ElasticSearch&lt;/strong&gt;ç­‰å¤šä¸ªæ–¹å‘ï¼Œ&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg4MzE2MzY1OA==&amp;amp;mid=2247484254&amp;amp;idx=2&amp;amp;sn=bccee04adfd2c2e7d72b427c32f5891c&amp;amp;chksm=cf4ad43bf83d5d2d0d4ced10e8b047565e8fb765ab1ea62a5fb1c4d5b77a1ac8248a9afca96f&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;è¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯åŠJD&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;&lt;strong&gt;è¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯åŠJD&lt;/strong&gt;&lt;/a&gt;ã€‚&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;ä½ å¯èƒ½è¿˜å–œæ¬¢&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section label=&quot;Copyright Reserved by PLAYHUDONG.&quot; donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section label=&quot;Copyright Reserved by PLAYHUDONG.&quot; donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section powered-by=&quot;xiumi.us&quot;&gt;&lt;section label=&quot;Copyright Reserved by PLAYHUDONG.&quot; donone=&quot;shifuMouseDownCard(&#x27;shifu_c_008&#x27;)&quot;&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg4MzE2MzY1OA==&amp;amp;mid=2247485081&amp;amp;idx=1&amp;amp;sn=aaf43d2b82145a9c07c94ae6d024654e&amp;amp;chksm=cf4ad1fcf83d58ea7e77b359e2e4c19d52d8f18d80ad3c23c8f7f950f10efc1d326270e0279e&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;å‰ç«¯æ’ä»¶åŒ–æ¶æ„çš„æ¢ç´¢å’Œå®è·µ&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg4MzE2MzY1OA==&amp;amp;mid=2247484222&amp;amp;idx=1&amp;amp;sn=51f2c71fef5ffe6441a173e02bab9464&amp;amp;chksm=cf4ad45bf83d5d4d77f2b0e098067f2e00d54568f7a7ef7be89927c7d6de9afc1714310a0d71&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;JavaScript å¼‚æ­¥ä¹‹è·¯&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg4MzE2MzY1OA==&amp;amp;mid=2247484945&amp;amp;idx=1&amp;amp;sn=f3bbc20122db55510e03576e96da728a&amp;amp;chksm=cf4ad174f83d586279eddd4d30c077b3505467f7c50eb69f530fc7ca6edbff517d94fdb5c0b3&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;å¾®æœåŠ¡å…¨é“¾è·¯å¼‚æ­¥åŒ–å®è·µ&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg4MzE2MzY1OA==&amp;amp;mid=2247484902&amp;amp;idx=1&amp;amp;sn=34904f4f3af88bed24a7e052f3526044&amp;amp;chksm=cf4ad283f83d5b959ca17d2560c1ba4c360bda3595418708a7898b1ed27c1b0331f3e2a54b1c&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot; hasload=&quot;1&quot;&gt;Dubboåè®®è§£æä¸ESA RPCå®è·µ&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=Mzg4MzE2MzY1OA==&amp;amp;mid=2247485454&amp;amp;idx=1&amp;amp;sn=ccb0ff7f6230ea8049a5a842f71a6f40&amp;amp;chksm=cf4adf6bf83d567d84f35b0b6058c0b0afb8eded93e32ff5f71de7cfb8c7d08af5b3b2f3a8b8&amp;amp;scene=21#wechat_redirect&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;&lt;span&gt;qiankun å¾®å‰ç«¯åŸç†ä¸å®è·µ&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;æ›´å¤šæŠ€æœ¯å¹²è´§&lt;/span&gt;&lt;/p&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;æ‰«ç å…³æ³¨&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;p data-mid=&quot;&quot;&gt;&lt;span&gt;OPPOäº’è”ç½‘æŠ€æœ¯&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;img data-cropselx1=&quot;0&quot; data-cropselx2=&quot;120&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;120&quot; data-ratio=&quot;1&quot; data-type=&quot;jpeg&quot; data-w=&quot;258&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/ECThdibSVDxjYDM1fnDY1N9LLUp4gJV8ulKxP20jO66gHdE8q9DgFIB5hvxfBxEERyWeSxpc6nor8SPgiadWNVsQ/640?wx_fmt=jpeg&quot;/&gt;Â &lt;/section&gt;&lt;/section&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-mid=&quot;&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section data-tools=&quot;135ç¼–è¾‘å™¨&quot; data-id=&quot;95172&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section data-brushtype=&quot;text&quot; mpa-from-tpl=&quot;t&quot;&gt;&lt;span&gt;æˆ‘å°±çŸ¥é“ä½ â€œåœ¨çœ‹â€&lt;/span&gt;&lt;/section&gt;&lt;/section&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;section mpa-from-tpl=&quot;t&quot;&gt;&lt;img class=&quot;__bg_gif&quot; data-ratio=&quot;1.0377358490566038&quot; data-type=&quot;gif&quot; data-w=&quot;53&quot; data-width=&quot;100%&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/ECThdibSVDxjYDM1fnDY1N9LLUp4gJV8uk9kQ2Hw3Ucae5fnjEfVb2noBlx2NuTgMwzuiceEL19F9prbiaKnZZd3A/640?wx_fmt=gif&quot;/&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
                &lt;/div&gt;

                

                



                
                &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>9bff4502c7da68a617d26c9c185fe025</guid>
<title>é¸¿è’™å¼€å‘æ¿ HI3516 ç”¨å‘½ä»¤è¡Œè¿æ¥ wifi</title>
<link>https://toutiao.io/k/phkllhg</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;post-content&quot; id=&quot;post-content&quot; itemprop=&quot;postContent&quot;&gt;
            &lt;blockquote&gt;
&lt;p&gt;é¸¿è’™çš„HI3516ç¼–è¯‘é‡Œå·²ç»æœ‰wpa_supplicantç›¸å…³å·¥ç¨‹äº†ï¼Œä½†ç¼–è¯‘æ—¶æ²¡æœ‰åŒ…è¿›å», æ‰€ä»¥åªè¦ä¿®æ”¹é…ç½®æ–‡ä»¶åå°±èƒ½ç¼–è¯‘å‡ºæ¥äº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸»è¦ä¿®æ”¹æ–‡ä»¶: &lt;a href=&quot;https://gitee.com/openharmony/applications_sample_camera/blob/master/communication/BUILD.gn#L17-18&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;communication/BUILD.gn#L17-18&lt;/a&gt; è¡Œä¹‹é—´æ·»åŠ ï¼Œ ä»¥ä¸‹ç¬¬2è¡Œ&lt;br/&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;features = [&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;   &quot;wpa_supplicant:wpa_sample&quot;,&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;]&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;ç¼–è¯‘è¿‡ç¨‹&quot;&gt;&lt;a href=&quot;#ç¼–è¯‘è¿‡ç¨‹&quot; class=&quot;headerlink&quot; title=&quot;ç¼–è¯‘è¿‡ç¨‹&quot;/&gt;ç¼–è¯‘è¿‡ç¨‹&lt;/h3&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;docker run --rm -ti -e HARDWARE=ipcamera_hi3516dv300 -v ${PWD}/out:/OpenHarmony/out ystyle/open-harmony bash&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;sed -i &#x27;17a\ \ \ \ \ \ &quot;wpa_supplicant:wpa_sample&quot;,&#x27; applications/sample/camera/communication/BUILD.gn&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;python build.py ${HARDWARE} -b debug&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;ç„¶åwpa_supplicantåœ¨ç¼–è¯‘ç›®å½•&lt;code&gt;/out/ipcamera_hi3516dv300/bin/&lt;/code&gt;ï¼Œ æŠŠwpa_supplicantå¤åˆ¶å‡ºæ¥å°±å¯ä»¥ç›´æ¥ä½¿ç”¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;ä½¿ç”¨æ–¹æ³•&quot;&gt;&lt;a href=&quot;#ä½¿ç”¨æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;ä½¿ç”¨æ–¹æ³•&quot;/&gt;ä½¿ç”¨æ–¹æ³•&lt;/h3&gt;&lt;p&gt;å…ˆåˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œwpa_supplicant.conf&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;country=GB&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;ctrl_interface=udp&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;network={&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    #è¦è¿æ¥çš„SSID&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    ssid=&quot;example&quot;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    #å¦‚æœä¸éœ€è¦åŠ å¯†å°±å†™key_mgmt=NONE&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    #key_mgmt=NONE&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    #å¦‚æœéœ€è¦åŠ å¯†å°±å†™è¿™è¡Œå¯†ç &lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;    psk=&quot;AA123456&quot;&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;}&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;æŠŠwpa_supplicantå’Œé…ç½®æ–‡ä»¶å¤åˆ¶åˆ°hi3516ï¼Œ æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥wifi&lt;br/&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cd /nfs/wifi&lt;/span&gt;&lt;br/&gt;&lt;span class=&quot;line&quot;&gt;./wpa_supplicant -i wlan0 -c ./wpa_supplicant.conf&lt;/span&gt;&lt;br/&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;

        &lt;/div&gt;

        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>10cdab1c7ebf093c52f49186571e4cc9</guid>
<title>å¹¶å‘ç¼–ç¨‹ï¼šç”¨ SingleFlight åˆå¹¶é‡å¤è¯·æ±‚</title>
<link>https://toutiao.io/k/y2btneh</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¤§å®¶å¥½å•Šï¼Œä»Šå¤©ç½‘ç®¡æƒ³ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹&lt;code&gt;Go&lt;/code&gt;çš„&lt;code&gt;singleflight&lt;/code&gt;åŒ…ï¼Œå½“ç„¶å®ƒä¸æ˜¯ç›´è¯‘è¿‡æ¥çš„å•é£çš„æ„æ€~~ï¼&lt;code&gt;SingleFlight&lt;/code&gt;æ˜¯&lt;code&gt;Go&lt;/code&gt;è¯­è¨€&lt;code&gt;sync&lt;/code&gt;æ‰©å±•åº“æä¾›çš„å¦ä¸€ç§å¹¶å‘åŸè¯­ï¼Œé‚£ä¹ˆ&lt;code&gt;SingleFlight&lt;/code&gt;æ˜¯ç”¨äºè§£å†³ä»€ä¹ˆé—®é¢˜çš„å‘¢ï¼Ÿå®˜æ–¹æ–‡æ¡£é‡Œçš„è§£é‡Šæ˜¯ï¼š&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;Package singleflight provides a duplicate function call suppression mechanism.&lt;/p&gt;&lt;p&gt;ç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šsingleflightåŒ…æä¾›äº†ä¸€ç§æŠ‘åˆ¶é‡å¤å‡½æ•°è°ƒç”¨çš„æœºåˆ¶ã€‚&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å…·ä½“åˆ°&lt;code&gt;Go&lt;/code&gt;ç¨‹åºè¿è¡Œçš„å±‚é¢æ¥è¯´ï¼Œ&lt;code&gt;SingleFlight&lt;/code&gt;çš„ä½œç”¨æ˜¯åœ¨å¤„ç†å¤šä¸ª&lt;code&gt;goroutine&lt;/code&gt;åŒæ—¶è°ƒç”¨åŒä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œåªè®©ä¸€ä¸ª&lt;code&gt;goroutine&lt;/code&gt;å»å®é™…è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œç­‰åˆ°è¿™ä¸ª&lt;code&gt;goroutine&lt;/code&gt;è¿”å›ç»“æœçš„æ—¶å€™ï¼Œå†æŠŠç»“æœè¿”å›ç»™å…¶ä»–å‡ ä¸ªåŒæ—¶è°ƒç”¨äº†ç›¸åŒå‡½æ•°çš„&lt;code&gt;goroutine&lt;/code&gt;ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¹¶å‘è°ƒç”¨çš„æ•°é‡ã€‚åœ¨å®é™…åº”ç”¨ä¸­ä¹Ÿæ˜¯ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¸€ä¸ªæœåŠ¡ä¸­å‡å°‘å¯¹ä¸‹æ¸¸çš„å¹¶å‘é‡å¤è¯·æ±‚ã€‚è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ä½¿ç”¨åœºæ™¯æ˜¯ç”¨æ¥é˜²æ­¢ç¼“å­˜å‡»ç©¿ã€‚&lt;/p&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;Goæä¾›çš„SingleFlight&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;Go&lt;/code&gt;æ‰©å±•åº“é‡Œç”¨&lt;code&gt;singleflight.Group&lt;/code&gt;ç»“æ„ä½“ç±»å‹æä¾›äº†&lt;code&gt;SingleFlight&lt;/code&gt;å¹¶å‘åŸè¯­çš„åŠŸèƒ½ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;singleflight.Group&lt;/code&gt;ç±»å‹æä¾›äº†ä¸‰ä¸ªæ–¹æ³•ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;func&lt;/span&gt;Â &lt;span&gt;(gÂ *Group)&lt;/span&gt;Â &lt;span&gt;Do&lt;/span&gt;&lt;span&gt;(keyÂ &lt;span&gt;string&lt;/span&gt;,Â fnÂ &lt;span&gt;func&lt;/span&gt;()&lt;/span&gt;Â &lt;span&gt;(&lt;span&gt;interface&lt;/span&gt;{},Â error)&lt;/span&gt;)Â &lt;span&gt;(vÂ &lt;span&gt;interface&lt;/span&gt;{},Â errÂ error,Â sharedÂ &lt;span&gt;bool&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;func&lt;/span&gt;Â &lt;span&gt;(gÂ *Group)&lt;/span&gt;Â &lt;span&gt;DoChan&lt;/span&gt;&lt;span&gt;(keyÂ &lt;span&gt;string&lt;/span&gt;,Â fnÂ &lt;span&gt;func&lt;/span&gt;()&lt;/span&gt;Â &lt;span&gt;(&lt;span&gt;interface&lt;/span&gt;{},Â error)&lt;/span&gt;)Â &amp;lt;-&lt;span&gt;chan&lt;/span&gt;Â &lt;span&gt;Result&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&lt;span&gt;func&lt;/span&gt;Â &lt;span&gt;(gÂ *Group)&lt;/span&gt;Â &lt;span&gt;Forget&lt;/span&gt;&lt;span&gt;(keyÂ &lt;span&gt;string&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;Do&lt;/strong&gt;æ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²Keyå’Œä¸€ä¸ªå¾…è°ƒç”¨çš„å‡½æ•°ï¼Œä¼šè¿”å›è°ƒç”¨å‡½æ•°çš„ç»“æœå’Œé”™è¯¯ã€‚ä½¿ç”¨Doæ–¹æ³•çš„æ—¶å€™ï¼Œå®ƒä¼šæ ¹æ®æä¾›çš„Keyåˆ¤æ–­æ˜¯å¦å»çœŸæ­£è°ƒç”¨&lt;code&gt;fn&lt;/code&gt;å‡½æ•°ã€‚åŒä¸€ä¸ª keyï¼Œåœ¨åŒä¸€æ—¶é—´åªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨Doæ–¹æ³•æ—¶æ‰ä¼šå»æ‰§è¡Œ&lt;code&gt;fn&lt;/code&gt;å‡½æ•°ï¼Œå…¶ä»–å¹¶å‘çš„è¯·æ±‚ä¼šç­‰å¾…è°ƒç”¨çš„æ‰§è¡Œç»“æœã€‚&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;DoChan&lt;/strong&gt;æ–¹æ³•ï¼šç±»ä¼¼Doæ–¹æ³•ï¼Œåªä¸è¿‡æ˜¯ä¸€ä¸ªå¼‚æ­¥è°ƒç”¨ã€‚å®ƒä¼šè¿”å›ä¸€ä¸ªé€šé“ï¼Œç­‰&lt;code&gt;fn&lt;/code&gt;å‡½æ•°æ‰§è¡Œå®Œï¼Œäº§ç”Ÿäº†ç»“æœä»¥åï¼Œå°±èƒ½ä»è¿™ä¸ª chan ä¸­æ¥æ”¶è¿™ä¸ªç»“æœã€‚&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;strong&gt;Forget&lt;/strong&gt;æ–¹æ³•ï¼šåœ¨SingleFlightä¸­åˆ é™¤ä¸€ä¸ªKeyã€‚è¿™æ ·ä¸€æ¥ï¼Œä¹‹åè¿™ä¸ªKeyçš„Doæ–¹æ³•è°ƒç”¨ä¼šæ‰§è¡Œ&lt;code&gt;fn&lt;/code&gt;å‡½æ•°ï¼Œè€Œä¸æ˜¯ç­‰å¾…å‰ä¸€ä¸ªæœªå®Œæˆçš„&lt;code&gt;fn&lt;/code&gt; å‡½æ•°çš„ç»“æœã€‚&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;åº”ç”¨åœºæ™¯&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;äº†è§£äº†Goè¯­è¨€æä¾›çš„ SingleFlightå¹¶å‘åŸè¯­éƒ½æœ‰å“ªäº›æ–¹æ³•å¯ä»¥è°ƒç”¨å ï¼Œä¸‹é¢ä»‹ç»ä¸¤ä¸ªå®ƒçš„åº”ç”¨åœºæ™¯ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;æŸ¥è¯¢DNSè®°å½•&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;Go&lt;/code&gt;è¯­è¨€çš„&lt;code&gt;net&lt;/code&gt;æ ‡å‡†åº“é‡Œä½¿ç”¨çš„&lt;code&gt;lookupGroup&lt;/code&gt;ç»“æ„ï¼Œå°±æ˜¯Goæ‰©å±•åº“æä¾›çš„åŸè¯­&lt;code&gt;singleflight.Group&lt;/code&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;type&lt;/span&gt;Â ResolverÂ &lt;span&gt;struct&lt;/span&gt;Â {&lt;br/&gt;Â Â ......&lt;br/&gt;Â &lt;span&gt;//Â æºç åœ°å€Â https://github.com/golang/go/blob/master/src/net/lookup.go#L151&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;//Â lookupGroupÂ mergesÂ LookupIPAddrÂ callsÂ togetherÂ forÂ lookupsÂ forÂ theÂ same&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;//Â host.Â TheÂ lookupGroupÂ keyÂ isÂ theÂ LookupIPAddr.hostÂ argument.&lt;/span&gt;&lt;br/&gt;Â &lt;span&gt;//Â TheÂ returnÂ valuesÂ areÂ ([]IPAddr,Â error).&lt;/span&gt;&lt;br/&gt;Â lookupGroupÂ singleflight.Group&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å®ƒçš„ä½œç”¨æ˜¯å°†å¯¹ç›¸åŒåŸŸåçš„DNSè®°å½•æŸ¥è¯¢åˆå¹¶æˆä¸€ä¸ªæŸ¥è¯¢ï¼Œä¸‹é¢æ˜¯&lt;code&gt;net&lt;/code&gt;åº“æä¾›çš„DNSè®°å½•æŸ¥è¯¢æ–¹æ³•&lt;code&gt;LookupIp&lt;/code&gt;ä½¿ç”¨&lt;code&gt;lookupGroup&lt;/code&gt;è¿™ä¸ªSingleFlightè¿›è¡Œåˆå¹¶æŸ¥è¯¢çš„ç›¸å…³æºç ï¼Œå®ƒä½¿ç”¨çš„æ˜¯å¼‚æ­¥æŸ¥è¯¢çš„æ–¹æ³•&lt;code&gt;DoChan&lt;/code&gt;ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;funcÂ LookupIP(hostÂ string)Â ([]IP,Â error)Â {&lt;br/&gt;Â addrs,Â errÂ :=Â DefaultResolver.LookupIPAddr(context.Background(),Â host)&lt;br/&gt;Â Â ......&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;funcÂ (rÂ *Resolver)Â lookupIPAddr(ctxÂ context.Context,Â network,Â hostÂ string)Â ([]IPAddr,Â error)Â {&lt;br/&gt;Â Â ......&lt;br/&gt;Â Â //Â ä½¿ç”¨SingleFlightçš„DoChanåˆå¹¶å¤šä¸ªæŸ¥è¯¢è¯·æ±‚&lt;br/&gt;Â ch,Â calledÂ :=Â r.getLookupGroup().DoChan(lookupKey,Â func()Â (interface{},Â error)Â {&lt;br/&gt;Â Â deferÂ dnsWaitGroup.Done()&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â testHookLookupIP(lookupGroupCtx,Â resolverFunc,Â network,Â host)&lt;br/&gt;Â })&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â !calledÂ {&lt;br/&gt;Â Â dnsWaitGroup.Done()&lt;br/&gt;Â }&lt;br/&gt;Â &lt;br/&gt;Â selectÂ {&lt;br/&gt;Â &lt;span&gt;case&lt;/span&gt;Â &amp;lt;-ctx.Done():&lt;br/&gt;Â Â ......&lt;br/&gt;Â &lt;span&gt;case&lt;/span&gt;Â rÂ :=Â &amp;lt;-ch:&lt;br/&gt;Â Â lookupGroupCancel()&lt;br/&gt;Â Â &lt;span&gt;if&lt;/span&gt;Â traceÂ !=Â nilÂ &amp;amp;&amp;amp;Â trace.DNSDoneÂ !=Â nilÂ {&lt;br/&gt;Â Â Â addrs,Â _Â :=Â r.Val.([]IPAddr)&lt;br/&gt;Â Â Â trace.DNSDone(ipAddrsEface(addrs),Â r.Shared,Â r.Err)&lt;br/&gt;Â Â }&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â lookupIPReturn(r.Val,Â r.Err,Â r.Shared)&lt;br/&gt;Â }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸Šé¢çš„æºç åšäº†å¾ˆå¤šåˆ å‡ï¼Œåªç•™äº†&lt;code&gt;SingleFlight&lt;/code&gt;åˆå¹¶æŸ¥è¯¢çš„éƒ¨åˆ†ï¼Œå¦‚æœæœ‰å…´è¶£å¯ä»¥å»&lt;code&gt;GitHub&lt;/code&gt;ä¸Šçœ‹ä¸€ä¸‹å®Œæ•´çš„æºç ï¼Œè®¿é—®é“¾æ¥https://github.com/golang/go/blob/master/src/net/lookup.go#L261 ï¼Œå¯ç›´æ¥å®šä½åˆ°è¿™éƒ¨åˆ†çš„æºç ã€‚&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;ç½‘ç®¡æ˜¯ä¸æ˜¯å¾ˆè´´å¿ƒï¼Œè®°å¾—ä¸‰è¿å•Š~ï¼&lt;/p&gt;&lt;/blockquote&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;é˜²æ­¢ç¼“å­˜å‡»ç©¿&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åœ¨é¡¹ç›®é‡Œä½¿ç”¨ç¼“å­˜æ—¶ï¼Œä¸€ä¸ªå¸¸è§çš„ç”¨æ³•æ˜¯æŸ¥è¯¢ä¸€ä¸ªæ•°æ®å…ˆå»æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰å°±å»æ•°æ®åº“é‡ŒæŸ¥åˆ°æ•°æ®å¹¶ç¼“å­˜åˆ°&lt;code&gt;Redis&lt;/code&gt;é‡Œã€‚é‚£ä¹ˆç¼“å­˜å‡»ç©¿é—®é¢˜æ˜¯æŒ‡ï¼Œé«˜å¹¶å‘çš„ç³»ç»Ÿä¸­ï¼Œå¤§é‡çš„è¯·æ±‚åŒæ—¶æŸ¥è¯¢ä¸€ä¸ªç¼“å­˜Key æ—¶ï¼Œå¦‚æœè¿™ä¸ª Key æ­£å¥½è¿‡æœŸå¤±æ•ˆï¼Œå°±ä¼šå¯¼è‡´å¤§é‡çš„è¯·æ±‚éƒ½æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œè¿™å°±æ˜¯ç¼“å­˜å‡»ç©¿ã€‚ç”¨ &lt;code&gt;SingleFlight&lt;/code&gt; æ¥è§£å†³ç¼“å­˜å‡»ç©¿é—®é¢˜å†åˆé€‚ä¸è¿‡ï¼Œè¿™ä¸ªæ—¶å€™åªè¦è¿™äº›å¯¹åŒä¸€ä¸ª Key çš„å¹¶å‘è¯·æ±‚çš„å…¶ä¸­ä¸€ä¸ªåˆ°æ•°æ®åº“ä¸­æŸ¥è¯¢å°±å¯ä»¥äº†ï¼Œè¿™äº›å¹¶å‘çš„è¯·æ±‚å¯ä»¥å…±äº«åŒä¸€ä¸ªç»“æœã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.41058941058941056&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/z4pQ0O5h0f5ZOj4KGGfzLLQQ8PibN9fMThIN1E7mZQgxGubUt23yP3BuAYVM9lFzS7UQWdQK9pQwY9UYzIjAmfw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1001&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿç”¨&lt;code&gt;SingleFlight&lt;/code&gt;å¹¶å‘åŸè¯­åˆå¹¶æŸ¥è¯¢&lt;code&gt;Redis&lt;/code&gt;ç¼“å­˜çš„ç¨‹åºï¼Œä½ å¯ä»¥è‡ªå·±åŠ¨æ‰‹æµ‹è¯•ä¸€ä¸‹ï¼Œå¼€10ä¸ª&lt;code&gt;goroutine&lt;/code&gt;å»æŸ¥è¯¢ä¸€ä¸ªå›ºå®šçš„Keyï¼Œè§‚å¯Ÿä¸€ä¸‹è¿”å›ç»“æœå°±ä¼šå‘ç°æœ€ç»ˆåªæ‰§è¡Œäº†ä¸€æ¬¡&lt;code&gt;Redis&lt;/code&gt;æŸ¥è¯¢ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;//Â æ¨¡æ‹Ÿä¸€ä¸ªRediså®¢æˆ·ç«¯&lt;br/&gt;&lt;span&gt;type&lt;/span&gt;Â clientÂ structÂ {&lt;br/&gt;Â //Â ...Â å…¶ä»–çš„é…ç½®çœç•¥&lt;br/&gt;Â requestGroupÂ singleflight.Group&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;//Â æ™®é€šæŸ¥è¯¢&lt;br/&gt;funcÂ (cÂ *client)Â Get(keyÂ string)Â (interface{},Â error)Â {&lt;br/&gt;Â fmt.Println(&lt;span&gt;&quot;QueryingÂ Database&quot;&lt;/span&gt;)&lt;br/&gt;Â time.Sleep(time.Second)&lt;br/&gt;Â vÂ :=Â &lt;span&gt;&quot;ContentÂ ofÂ key&quot;&lt;/span&gt;Â +Â key&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â Â v,Â nil&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;//Â SingleFlightæŸ¥è¯¢&lt;br/&gt;funcÂ (cÂ *client)Â SingleFlightGet(keyÂ string)Â (interface{},Â error)Â {&lt;br/&gt;Â v,Â err,Â _Â :=Â c.requestGroup.Do(key,Â func()Â (interface{},Â error)Â {&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â c.Get(key)&lt;br/&gt;&lt;br/&gt;Â })&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â errÂ !=Â nilÂ {&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â nil,Â err&lt;br/&gt;Â }&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â v,Â err&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;å®Œæ•´çš„æµ‹è¯•æºç å¯ä»¥ç‚¹å‡»é˜…è¯»åŸæ–‡ï¼Œå»æˆ‘çš„GitHubä»“åº“ä¸‹è½½&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;å®ç°åŸç†&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æœ€åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹&lt;code&gt;singleflight.Group&lt;/code&gt;çš„å®ç°åŸç†ï¼Œé€šè¿‡å®ƒçš„æºç ä¹Ÿæ˜¯èƒ½å­¦åˆ°ä¸å°‘ç”¨&lt;code&gt;Go&lt;/code&gt;è¯­è¨€ç¼–ç¨‹çš„æŠ€å·§çš„ã€‚&lt;code&gt;singleflight.Group&lt;/code&gt;ç”±ä¸€ä¸ªäº’æ–¥é”&lt;code&gt;sync.Mutex&lt;/code&gt;å’Œä¸€ä¸ªæ˜ å°„è¡¨ç»„æˆï¼Œæ¯ä¸€ä¸ª &lt;code&gt;singleflight.call&lt;/code&gt;ç»“æ„ä½“éƒ½ä¿å­˜äº†å½“å‰è°ƒç”¨å¯¹åº”çš„ä¿¡æ¯ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;type&lt;/span&gt;Â GroupÂ &lt;span&gt;struct&lt;/span&gt;Â {&lt;br/&gt;Â muÂ sync.Mutex&lt;br/&gt;Â mÂ Â &lt;span&gt;map&lt;/span&gt;[&lt;span&gt;string&lt;/span&gt;]*call&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;type&lt;/span&gt;Â callÂ &lt;span&gt;struct&lt;/span&gt;Â {&lt;br/&gt;Â wgÂ sync.WaitGroup&lt;br/&gt;&lt;br/&gt;Â valÂ &lt;span&gt;interface&lt;/span&gt;{}&lt;br/&gt;Â errÂ error&lt;br/&gt;&lt;br/&gt;Â dupsÂ Â &lt;span&gt;int&lt;/span&gt;&lt;br/&gt;Â chansÂ []&lt;span&gt;chan&lt;/span&gt;&amp;lt;-Â Result&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ Do å’Œ DoChan æ–¹æ³•æ˜¯æ€ä¹ˆå®ç°çš„ã€‚&lt;/p&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;Doæ–¹æ³•&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;SingleFlight&lt;/code&gt; å®šä¹‰ä¸€ä¸ª&lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“ï¼Œæ¯ä¸ªç»“æ„ä½“éƒ½ä¿å­˜äº†&lt;code&gt;fn&lt;/code&gt;è°ƒç”¨å¯¹åº”çš„ä¿¡æ¯ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Doæ–¹æ³•çš„æ‰§è¡Œé€»è¾‘æ˜¯æ¯æ¬¡è°ƒç”¨Doæ–¹æ³•éƒ½ä¼šå…ˆå»è·å–äº’æ–¥é”ï¼Œéšååˆ¤æ–­åœ¨æ˜ å°„è¡¨é‡Œæ˜¯å¦å·²ç»æœ‰Keyå¯¹åº”çš„&lt;code&gt;fn&lt;/code&gt;å‡½æ•°è°ƒç”¨ä¿¡æ¯çš„&lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“ã€‚&lt;/p&gt;&lt;ul data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; class=&quot;list-paddingleft-2&quot;&gt;&lt;li&gt;&lt;section&gt;å½“ä¸å­˜åœ¨æ—¶ï¼Œè¯æ˜æ˜¯è¿™ä¸ªKeyçš„ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œé‚£ä¹ˆä¼šåˆå§‹åŒ–ä¸€ä¸ª&lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“æŒ‡é’ˆï¼Œå¢åŠ &lt;code&gt;SingleFlight&lt;/code&gt;å†…éƒ¨æŒæœ‰çš„&lt;code&gt;sync.WaitGroup&lt;/code&gt;è®¡æ•°å™¨åˆ°1ã€‚é‡Šæ”¾äº’æ–¥é”ï¼Œç„¶åé˜»å¡çš„ç­‰å¾…doCallæ–¹æ³•æ‰§è¡Œ&lt;code&gt;fn&lt;/code&gt;å‡½æ•°çš„è¿”å›ç»“æœ&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;å½“å­˜åœ¨æ—¶ï¼Œå¢åŠ &lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“å†…ä»£è¡¨&lt;code&gt;fn&lt;/code&gt;é‡å¤è°ƒç”¨æ¬¡æ•°çš„è®¡æ•°å™¨&lt;code&gt;dups&lt;/code&gt;ï¼Œé‡Šæ”¾äº’æ–¥é”ï¼Œç„¶åä½¿ç”¨&lt;code&gt;WaitGroup&lt;/code&gt;ç­‰å¾…&lt;code&gt;fn&lt;/code&gt;å‡½æ•°æ‰§è¡Œå®Œæˆã€‚&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“çš„&lt;code&gt;val&lt;/code&gt; å’Œ &lt;code&gt;err&lt;/code&gt; ä¸¤ä¸ªå­—æ®µåªä¼šåœ¨ &lt;code&gt;doCall&lt;/code&gt;æ–¹æ³•ä¸­æ‰§è¡Œ&lt;code&gt;fn&lt;/code&gt;æœ‰è¿”å›ç»“æœåæ‰èµ‹å€¼ï¼Œæ‰€ä»¥å½“ &lt;code&gt;doCall&lt;/code&gt;æ–¹æ³• å’Œ &lt;code&gt;WaitGroup.Wait&lt;/code&gt;è¿”å›æ—¶ï¼Œå‡½æ•°è°ƒç”¨çš„ç»“æœå’Œé”™è¯¯ä¼šè¿”å›ç»™Doæ–¹æ³•çš„æ‰€æœ‰è°ƒç”¨è€…ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;Â Â &lt;span&gt;&lt;span&gt;func&lt;/span&gt;Â &lt;span&gt;(gÂ *Group)&lt;/span&gt;Â &lt;span&gt;Do&lt;/span&gt;&lt;span&gt;(keyÂ &lt;span&gt;string&lt;/span&gt;,Â fnÂ &lt;span&gt;func&lt;/span&gt;()&lt;/span&gt;Â &lt;span&gt;(&lt;span&gt;interface&lt;/span&gt;{},Â error)&lt;/span&gt;)Â &lt;span&gt;(vÂ &lt;span&gt;interface&lt;/span&gt;{},Â errÂ error,Â sharedÂ &lt;span&gt;bool&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â g.mu.Lock()&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â g.mÂ ==Â &lt;span&gt;nil&lt;/span&gt;Â {&lt;br/&gt;Â Â Â Â Â Â g.mÂ =Â &lt;span&gt;make&lt;/span&gt;(&lt;span&gt;map&lt;/span&gt;[&lt;span&gt;string&lt;/span&gt;]*call)&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â c,Â okÂ :=Â g.m[key];Â okÂ {&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;//Â å­˜åœ¨ç›¸åŒçš„key,Â å¢åŠ è®¡æ•°&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â c.dups++&lt;br/&gt;Â Â Â Â Â Â g.mu.Unlock()&lt;br/&gt;Â Â Â Â Â Â c.wg.Wait()Â &lt;span&gt;//ç­‰å¾…è¿™ä¸ªkeyå¯¹åº”çš„fnè°ƒç”¨å®Œæˆ&lt;/span&gt;&lt;br/&gt;Â Â Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â c.val,Â c.err,Â &lt;span&gt;true&lt;/span&gt;Â &lt;span&gt;//Â è¿”å›fnè°ƒç”¨çš„ç»“æœ&lt;/span&gt;&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â cÂ :=Â &lt;span&gt;new&lt;/span&gt;(call)Â &lt;span&gt;//Â ä¸å­˜åœ¨key,Â æ˜¯ç¬¬ä¸€ä¸ªè¯·æ±‚,Â åˆ›å»ºä¸€ä¸ªcallç»“æ„ä½“&lt;/span&gt;&lt;br/&gt;Â Â Â Â c.wg.Add(&lt;span&gt;1&lt;/span&gt;)&lt;br/&gt;Â Â Â Â g.m[key]Â =Â cÂ &lt;span&gt;//åŠ å…¥åˆ°æ˜ å°„è¡¨ä¸­&lt;/span&gt;&lt;br/&gt;Â Â Â Â g.mu.Unlock()&lt;br/&gt;Â Â &lt;br/&gt;&lt;br/&gt;Â Â Â Â g.doCall(c,Â key,Â fn)Â &lt;span&gt;//Â è°ƒç”¨æ–¹æ³•&lt;/span&gt;&lt;br/&gt;Â Â Â Â &lt;span&gt;return&lt;/span&gt;Â c.val,Â c.err,Â c.dupsÂ &amp;gt;Â &lt;span&gt;0&lt;/span&gt;&lt;br/&gt;Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;doCall&lt;/code&gt;æ–¹æ³•ä¼šå»å®é™…è°ƒç”¨&lt;code&gt;fn&lt;/code&gt;å‡½æ•°ï¼Œå› ä¸º&lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“åˆå§‹åŒ–å&lt;code&gt;forgotten&lt;/code&gt;å­—æ®µçš„é»˜è®¤å€¼æ˜¯&lt;code&gt;false&lt;/code&gt;ï¼Œ&lt;code&gt;fn&lt;/code&gt;è°ƒç”¨æœ‰è¿”å›åï¼Œä¼šæŠŠå¯¹åº”çš„Keyåˆ æ‰ã€‚è¿™æ ·è¿™è½®è¯·æ±‚éƒ½è¿”å›åï¼Œä¸‹ä¸€è½®ä½¿ç”¨åŒä¸€çš„Keyçš„è¯·æ±‚ä¼šé‡æ–°è°ƒç”¨æ‰§è¡Œä¸€æ¬¡&lt;code&gt;fn&lt;/code&gt;å‡½æ•°ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;br/&gt;Â Â funcÂ (gÂ *Group)Â doCall(cÂ *call,Â keyÂ string,Â fnÂ func()Â (interface{},Â error))Â {&lt;br/&gt;Â Â Â Â c.val,Â c.errÂ =Â fn()&lt;br/&gt;Â Â Â Â c.wg.Done()&lt;br/&gt;Â Â &lt;br/&gt;&lt;br/&gt;Â Â Â Â g.mu.Lock()&lt;br/&gt;Â Â Â Â &lt;span&gt;if&lt;/span&gt;Â !c.forgottenÂ {Â //Â å·²è°ƒç”¨å®Œï¼Œåˆ é™¤è¿™ä¸ªkey&lt;br/&gt;Â Â Â Â Â Â delete(g.m,Â key)&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â &lt;span&gt;for&lt;/span&gt;Â _,Â chÂ :=Â rangeÂ c.chansÂ {&lt;br/&gt;Â Â Â Â Â Â chÂ &amp;lt;-Â Result{c.val,Â c.err,Â c.dupsÂ &amp;gt;Â 0}&lt;br/&gt;Â Â Â Â }&lt;br/&gt;Â Â Â Â g.mu.Unlock()&lt;br/&gt;Â Â }&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span/&gt;&lt;span&gt;DoChanæ–¹æ³•&lt;/span&gt;&lt;span/&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;code&gt;SingleFlight&lt;/code&gt;è¿˜æä¾›äº†å¼‚æ­¥è°ƒç”¨&lt;code&gt;DoChan&lt;/code&gt;æ–¹æ³•ï¼Œå®ƒçš„æ‰§è¡Œé€»è¾‘å’Œ&lt;code&gt;Do&lt;/code&gt;æ–¹æ³•ç±»ä¼¼ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯è°ƒç”¨è€…ä¸ç”¨é˜»å¡ç­‰å¾…è°ƒç”¨çš„è¿”å›ï¼Œ &lt;code&gt;DoChan&lt;/code&gt;æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ª&lt;code&gt;chan Result&lt;/code&gt;é€šé“è¿”å›ç»™è°ƒç”¨è€…ï¼Œè°ƒç”¨è€…é€šè¿‡è¿™ä¸ªé€šé“å°±èƒ½æ¥å—åˆ°&lt;code&gt;fn&lt;/code&gt;å‡½æ•°çš„ç»“æœã€‚è¿™ä¸ª&lt;code&gt;chan Result&lt;/code&gt;é€šé“ï¼Œåœ¨è¿”å›ç»™è°ƒç”¨è€…å‰ä¼šå…ˆæ”¾åˆ°&lt;code&gt;call&lt;/code&gt;ç»“æ„ä½“çš„ç»´æŠ¤çš„é€šçŸ¥é˜Ÿåˆ—é‡Œï¼Œå¾…&lt;code&gt;fn&lt;/code&gt;å‡½æ•°è¿”å›ç»“æœå&lt;code&gt;DoChan&lt;/code&gt;æ–¹æ³•ä¼šæŠŠç»“æœå‘é€ç»™é€šçŸ¥é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªé€šé“ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;func&lt;/span&gt;Â &lt;span&gt;(gÂ *Group)&lt;/span&gt;Â &lt;span&gt;DoChan&lt;/span&gt;&lt;span&gt;(keyÂ &lt;span&gt;string&lt;/span&gt;,Â fnÂ &lt;span&gt;func&lt;/span&gt;()&lt;/span&gt;Â &lt;span&gt;(&lt;span&gt;interface&lt;/span&gt;{},Â error)&lt;/span&gt;)Â &amp;lt;-&lt;span&gt;chan&lt;/span&gt;Â &lt;span&gt;Result&lt;/span&gt;&lt;/span&gt;Â {&lt;br/&gt;Â chÂ :=Â &lt;span&gt;make&lt;/span&gt;(&lt;span&gt;chan&lt;/span&gt;Â Result,Â &lt;span&gt;1&lt;/span&gt;)&lt;br/&gt;Â g.mu.Lock()&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â g.mÂ ==Â &lt;span&gt;nil&lt;/span&gt;Â {&lt;br/&gt;Â Â g.mÂ =Â &lt;span&gt;make&lt;/span&gt;(&lt;span&gt;map&lt;/span&gt;[&lt;span&gt;string&lt;/span&gt;]*call)&lt;br/&gt;Â }&lt;br/&gt;Â &lt;span&gt;if&lt;/span&gt;Â c,Â okÂ :=Â g.m[key];Â okÂ {&lt;br/&gt;Â Â c.dups++&lt;br/&gt;Â Â c.chansÂ =Â &lt;span&gt;append&lt;/span&gt;(c.chans,Â ch)&lt;br/&gt;Â Â g.mu.Unlock()&lt;br/&gt;Â Â &lt;span&gt;return&lt;/span&gt;Â ch&lt;br/&gt;Â }&lt;br/&gt;Â cÂ :=Â &amp;amp;call{chans:Â []&lt;span&gt;chan&lt;/span&gt;&amp;lt;-Â Result{ch}}&lt;br/&gt;Â c.wg.Add(&lt;span&gt;1&lt;/span&gt;)&lt;br/&gt;Â g.m[key]Â =Â c&lt;br/&gt;Â g.mu.Unlock()&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;go&lt;/span&gt;Â g.doCall(c,Â key,Â fn)&lt;br/&gt;&lt;br/&gt;Â &lt;span&gt;return&lt;/span&gt;Â ch&lt;br/&gt;}&lt;br/&gt;&lt;br/&gt;&lt;span&gt;type&lt;/span&gt;Â ResultÂ &lt;span&gt;struct&lt;/span&gt;Â {&lt;br/&gt;Â ValÂ Â Â Â &lt;span&gt;interface&lt;/span&gt;{}&lt;br/&gt;Â ErrÂ Â Â Â error&lt;br/&gt;Â SharedÂ &lt;span&gt;bool&lt;/span&gt;&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;span&gt;æ€»ç»“&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å­¦ä¼š&lt;code&gt;SingleFlight&lt;/code&gt;è¿™ä¸ªå¹¶å‘åŸè¯­åï¼Œä¸‹æ¬¡åœ¨é‡åˆ°ç±»ä¼¼åœ¨é«˜å¹¶å‘æƒ…å†µä¸‹æŸ¥è¯¢DNSè®°å½•ã€Redisç¼“å­˜è¿™æ ·çš„åœºæ™¯çš„æ—¶å€™å°±å¯ä»¥åº”ç”¨ä¸Šå•¦ã€‚æœ€åæˆ‘ç»™ä½ ç•™ä¸ªæ€è€ƒé¢˜å§ï¼Œä¸Šé¢ç”¨&lt;code&gt;SingleFlight&lt;/code&gt;æŸ¥è¯¢&lt;code&gt;Redis&lt;/code&gt;ç¼“å­˜çš„ä¾‹å­ä½¿ç”¨çš„æ˜¯åŒæ­¥é˜»å¡æ–¹æ³•&lt;code&gt;Do&lt;/code&gt;ï¼Œä½ èƒ½ä¸èƒ½æ”¹æˆä½¿ç”¨å¼‚æ­¥éé˜»å¡çš„&lt;code&gt;DoChan&lt;/code&gt;æ–¹æ³•å‘¢ï¼Ÿå¦å¤–èƒ½ä¸èƒ½ç»™&lt;code&gt;SingleFlightGet&lt;/code&gt;å¢åŠ ä¸€ä¸ªè¶…æ—¶è¿”å›é”™è¯¯çš„åŠŸèƒ½å‘¢ï¼Ÿ&lt;/p&gt;&lt;blockquote data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;p&gt;æç¤ºä¸€ä¸‹ï¼Œä½¿ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œè¿”å›çš„é”™è¯¯æ˜¯ctx.Err()&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;å¯ä»¥æŠŠåœ¨ç•™è¨€é‡Œå†™ä¸‹ä½ çš„è§£å†³æ–¹æ¡ˆï¼Œæœ€å¥½èƒ½é™„ä¸Šæºç é“¾æ¥ï¼Œæ¬¢è¿æŠŠæ–‡ç« åˆ†äº«ç»™ä½ æ›´å¤šçš„æœ‹å‹ï¼Œä¸€èµ·è®¨è®ºã€‚è¿˜æ²¡å…³æ³¨å…¬ä¼—å·ã€Œç½‘ç®¡å¨biå¨ã€çš„æŠ“ç´§å…³æ³¨å‘€ï¼Œæ¯å‘¨éƒ½ä¼šæœ‰å¹²è´§æŠ€æœ¯åˆ†äº«ã€‚&lt;/p&gt;&lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å…³æ³¨å…¬ä¼—å·ï¼Œè·å–æ›´å¤šç²¾é€‰æŠ€æœ¯åŸåˆ›æ–‡ç« &lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;1.0188679245283019&quot; data-s=&quot;300,640&quot; data-type=&quot;png&quot; data-w=&quot;318&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z4pQ0O5h0f4icJbGAQ8RjXUUVdUZsGADuMBVWePgn7tfrWjjHyc6b8kXTQ7Sdkp0QQFFK4mel5tniczqooMna1CA/640?wx_fmt=png&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>be16f0765aab6d3537e62aa94b4c6ed2</guid>
<title>æ‰“æ—¥å¿—è¿˜èƒ½æ‰“å‡ºä¸ªçº¿ä¸Š Bugï¼Œå¤ªéš¾äº†</title>
<link>https://toutiao.io/k/9p8zgng</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content &quot; id=&quot;js_content&quot;&gt;
                    

                    

                    
                    
                    &lt;section data-tool=&quot;mdniceç¼–è¾‘å™¨&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æŸæ—¥ä¸­åˆï¼Œæ”¶åˆ°å‘Šè­¦ï¼Œæœ‰ä¸€ç¬”è®¢å•ä¸‹å•å¤±è´¥äº†ã€‚èµ¶ç´§å» Cat çœ‹äº†ä¸‹é”™è¯¯ä¿¡æ¯ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.19803063457330417&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39xviap51u0HOlEibxddgwK2gmPqbTt7zNicicgLdznlOBrIwPiaErl1JZJxS05U3DJOZzh1s6Ee5HdLzTQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1828&quot;/&gt;&lt;figcaption&gt;å¼‚å¸¸ä¿¡æ¯&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;Web åº”ç”¨è°ƒç”¨è®¢å•æœåŠ¡çš„ RPC æ¥å£æŠ¥é”™äº†ï¼Œä¸€çœ‹é”™è¯¯å¾ˆè‡ªä¸»çš„è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„é—®é¢˜ã€‚åé¢æ’æŸ¥ä¸‹æ¥å‘ç°å‹æ ¹å°±ä¸æ˜¯ï¼Œè¿™ä¸ªé”™è¯¯æŠ¥çš„æœ‰ç‚¹ã€‚ã€‚ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æƒ³ç€æ˜¯ä¸æ˜¯å‚æ•°ä¸­æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ä¸œè¥¿ï¼Œç„¶åå‘ç°ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ã€‚è¿™ä¸ªé”™è¯¯æ˜¯æŸä¸ªå•†å“ä¸‹å•æ‰ä¼šå‡ºç°ï¼Œä¸æ˜¯æ‰€æœ‰çš„å•†å“éƒ½ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;ç„¶åå°è¯•åœ¨æœ¬åœ°å¤ç°ï¼Œæœ‰è¿™ä¹ˆä¸€è¡Œå…³é”®çš„ä»£ç ï¼Œè´´äº†ä¸€éƒ¨åˆ†ï¼Œå®Œæ•´çš„ä½œç”¨æ˜¯åŸ‹ç‚¹æ‰“æ—¥å¿—ã€‚&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;String.format(&quot;UnifiedOrderServiceImpl.makeOrderåˆ›å»ºè®¢å•, make order, request: MakeOrderRequest= &quot;+ request)&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è¯´å®è¯æˆ‘æ˜¯æ²¡çœ‹æ‡‚è¿™é‡Œç”¨ String.format çš„åŸå› åœ¨å“ªé‡Œï¼Œä¸å°±æ˜¯æƒ³æ‹¼æ¥ä¸ªå­—ç¬¦ä¸²ä¹ˆï¼Ÿè¿˜æä¸ª formatï¼Œæå°±æå˜›ï¼Œè¿˜æ²¡ç”¨å ä½ç¬¦ï¼Œéªšæ“ä½œã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;çœŸæ­£ Bug çš„åŸå› æ˜¯ request å¯¹è±¡ä¸­æœ‰ä¸ª String ç±»å‹çš„å­—æ®µï¼Œå­—æ®µé‡Œé¢çš„å†…å®¹æœ‰%\ï¼Œformat å†…éƒ¨å°±æŠ¥é”™äº†ï¼Œå¤§å®¶å¯ä»¥ç”¨ä¸‹é¢è¿™æ®µä»£ç å¤ç°é”™è¯¯ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;public static void main(String[] args) {&lt;br/&gt;   String.format(&quot;dsdsdsd&quot;+&quot;%\\sdsd&quot;);&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;é”™è¯¯ä¿¡æ¯ï¼š&lt;/p&gt;&lt;pre data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;span/&gt;&lt;code&gt;Exception in thread &quot;main&quot; java.util.UnknownFormatConversionException: Conversion = &#x27;\&#x27;&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;åŸå› æ˜¯åœ¨ format ä¸­ä¼šæ ¡éªŒå‚æ•°ï¼Œç„¶åè§¦å‘äº†å¼‚å¸¸ã€‚&lt;/p&gt;&lt;figure data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;img data-ratio=&quot;0.2554858934169279&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39xviap51u0HOlEibxddgwK2gmtuYmmicp2ao1Yj2gyoXzurQ1OZB23ic2iasFkxQ5QMIxsKrDwoWUWckWQ/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1276&quot;/&gt;&lt;figcaption&gt;åˆ¤æ–­æ–‡æœ¬å†…å®¹&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;è™½ç„¶æ˜¯å¾ˆå°çš„æ”¹åŠ¨ï¼Œå°±è®°å½•ä¸ªæ—¥å¿—è€Œå·²ï¼Œä½†ä¹Ÿä¸è¦è½»è§†ï¼Œå¾€å¾€å°±æ˜¯ä¸å¤Ÿä»”ç»†ï¼Œç„¶åæ‰ä¼šå‡ºè¿™ç§é—®é¢˜ã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æ€»ç»“ï¼š&lt;/p&gt;&lt;span&gt;- END -&lt;/span&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;pre&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;&lt;strong&gt;å…³äºä½œè€…&lt;/strong&gt;ï¼šå°¹å‰æ¬¢ï¼Œç®€å•çš„æŠ€æœ¯çˆ±å¥½è€…ï¼Œã€ŠSpring Cloud å¾®æœåŠ¡-å…¨æ ˆæŠ€æœ¯ä¸æ¡ˆä¾‹è§£æã€‹, ã€ŠSpring Cloud å¾®æœåŠ¡ å…¥é—¨ å®æˆ˜ä¸è¿›é˜¶ã€‹ä½œè€…, å…¬ä¼—å·&lt;strong&gt;çŒ¿å¤©åœ°&lt;/strong&gt;å‘èµ·äººã€‚&lt;/p&gt;&lt;p data-tool=&quot;mdniceç¼–è¾‘å™¨&quot;&gt;æˆ‘æ•´ç†äº†ä¸€ä»½å¾ˆå…¨çš„å­¦ä¹ èµ„æ–™ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å¾®ä¿¡æœç´¢ã€Œ&lt;strong&gt;çŒ¿å¤©åœ°&lt;/strong&gt;ã€ï¼Œå›å¤å…³é”®å­— ã€Œ&lt;strong&gt;å­¦ä¹ èµ„æ–™&lt;/strong&gt;ã€è·å–æˆ‘æ•´ç†å¥½äº†çš„ Spring Cloudï¼ŒSpring Cloud Alibabaï¼ŒSharding-JDBC åˆ†åº“åˆ†è¡¨ï¼Œä»»åŠ¡è°ƒåº¦æ¡†æ¶ XXL-JOBï¼ŒMongoDBï¼Œçˆ¬è™«ç­‰ç›¸å…³èµ„æ–™ã€‚&lt;/p&gt;&lt;p&gt;åå°å›å¤Â &lt;strong&gt;&lt;span&gt;å­¦ä¹ èµ„æ–™&lt;/span&gt;&lt;/strong&gt;&lt;strong&gt;Â &lt;/strong&gt;é¢†å–å­¦ä¹ è§†é¢‘&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages&quot; data-ratio=&quot;0.511002444987775&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/WRLYshvT39zWmaics1nAAwT4NCD77uDcf6vcXE1DAHybibTY0V3XDmf4YX1q9qYibIwz9xmRVTkEvTjP87gaKEZrQ/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;818&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;å¦‚æœ‰æ”¶è·ï¼Œç‚¹ä¸ªåœ¨çœ‹ï¼Œè¯šæŒšæ„Ÿè°¢&lt;/span&gt;&lt;/p&gt;&lt;/pre&gt;
                &lt;/div&gt;

                

                



                
                &lt;div class=&quot;reward_qrcode_area reward_area tc&quot; id=&quot;js_reward_qrcode&quot;&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;Long-press QR code to transfer me a reward&lt;/p&gt;
                                                                &lt;p class=&quot;reward_tips&quot;&gt;æˆ‘ä¸å·®é’±å•Š&lt;/p&gt;
                                &lt;span class=&quot;reward_qrcode_img_wrp&quot;&gt;&lt;img class=&quot;reward_qrcode_img&quot; id=&quot;js_reward_qrcode_img&quot;/&gt;&lt;/span&gt;
                                &lt;p class=&quot;tips_global&quot;&gt;As required by Apple&#x27;s new policy, the Reward feature has been disabled on Weixin for iOS. You can still reward an Official Account by transferring money via QR code.&lt;/p&gt;
                            &lt;/div&gt;
                                                                            
                              
            &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>