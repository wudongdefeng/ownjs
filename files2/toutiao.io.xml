<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
            <channel>
            <title>开发者头条</title>
            <link>http://toutiao.io/</link>
            <description></description>
<item>
<guid>e504d26a6491f1f67c83d6f6f3021076</guid>
<title>优质网站同好者周刊（第 075 期） | 倾城博客</title>
<link>https://toutiao.io/k/5ev52vr</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;content&quot;&gt;&lt;p&gt;&lt;a href=&quot;https://nicelinks.site/?utm_source=weekly&quot;&gt;倾城之链&lt;/a&gt;作为一个开放平台，旨在云集全球&lt;strong&gt;优秀网站&lt;/strong&gt;，探索互联网中更广阔的世界。此周刊，将汇聚过去一周&lt;a href=&quot;https://nicelinks.site/?utm_source=weekly&quot;&gt;倾城&lt;/a&gt;所收录的内容，以飨同好；欢迎推荐或自荐（仅限有独立域名的网站，可以是二级域名）。您如果要了解收录要求，请参见&lt;a href=&quot;https://nicelinks.site/about?utm_source=weekly&quot;&gt;关于倾城&lt;/a&gt;。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;备注&lt;/strong&gt;：本周刊&lt;strong&gt;每周五&lt;/strong&gt;生成，首发于个人微信公众号&lt;a href=&quot;https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MDIwMzM2Mg==&amp;amp;action=getalbum&amp;amp;album_id=1530765143352082433&amp;amp;scene=173&amp;amp;from_msgid=2650641087&amp;amp;from_itemidx=1&amp;amp;count=3#wechat_redirect&quot;&gt;晚晴幽草轩&lt;/a&gt;、博客&lt;a href=&quot;https://www.jeffjade.com&quot;&gt;晚晴幽草轩&lt;/a&gt;，以及&lt;a href=&quot;https://forum.lovejade.cn/&quot;&gt;悠然宜想亭&lt;/a&gt;社区；此一键生成脚本基于 &lt;a href=&quot;https://nicelinks.site/post/602d30aad099ff5688618591&quot;&gt;Deno&lt;/a&gt; 编写，并在 Github 开源：&lt;a href=&quot;https://github.com/nicejade/nicelinks-weekly&quot;&gt;nicejade/nicelinks-weekly&lt;/a&gt;。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;标签&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/tags/%E6%90%9C%E7%B4%A2&quot;&gt;&lt;code&gt;搜索&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/%E5%BC%95%E6%93%8E&quot;&gt;&lt;code&gt;引擎&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/%E7%A8%8B%E5%BA%8F%E5%91%98&quot;&gt;&lt;code&gt;程序员&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;You.com is an ad-free, private search engine that you control. Customize search results with 150 apps alongside web results. Access a zero-trace private mode.&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;https://oss.nicelinks.site/you.com.png?x-oss-process=style/png2jpg&quot; alt=&quot;倾城之链 - You.com | The search engine you control&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;推荐语&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/redirect?url=https://you.com/&quot;&gt;You.com&lt;/a&gt; 是一个无广告的私人搜索引擎，由你控制，免费使用；进入零跟踪的私人模式。它用 150+ 个应用程序和网页结果，一起定制搜索结果。在 &lt;a href=&quot;https://nicelinks.site/post/5f40d0bf15435e0906a0a26f&quot;&gt;Product Hunt&lt;/a&gt; 介绍到：You.com 的 YouCode 是为开发者提供的搜索引擎。可以基于她复制代码片段，用人工智能编写代码，验证 JSON，并以比传统搜索引擎快 10 倍的速度，找到文档、技巧、窍门和实用工具。&lt;/p&gt;&lt;p&gt;世界最大的问答网站 Stack Overflow，每年举办一次全世界程序员调查，2022 增加了一个问题：&quot;哪些因素会影响你的工作效率？它们频繁发生吗？会花费你多少时间？&quot;。68% 的程序员说，&lt;strong&gt;最影响工作效率的是找不到答案&lt;/strong&gt;。&lt;/p&gt;&lt;p&gt;遇到问题，要么没人可问，要么没有文档，工作就被迫卡在那里，无法进行下去。越是高级程序员，给出这个回答的百分比越高。也就是说，水平高的人更苦于找不到答案，因为遇到的都是非典型问题，很少有人提到过。程序员用来找答案的时间，每天平均 30 分钟，25% 的人更是超过一个小时。这对个人和公司，都是很大的损耗。如能很好解决此问题，将能带来巨大价值，并产生无法估量的利润。&lt;/p&gt;&lt;p&gt;对于程序员而言，Goolge、Stack Overflow 以及国内的 &lt;a href=&quot;https://nicelinks.site/post/59c8e9208f066a5dda100f4b&quot;&gt;SegmentFault&lt;/a&gt;，都是解决这一问题的工具。有用户评论 you.com 是真正挖掘领域优化搜索体验的想法——超越 StackOverflow 为开发人员提供搜索工具，是一个聪明而精明的角度。&lt;/p&gt;&lt;p&gt;作为不怎么记忆 API 的编程开发人员，初步体验 You.com，感觉这是值得使用的产品，它能快速根据我的「关键字」，快速且准确找到我想要的内容，而且对「中文」支持的相当好；此外还做了些特色优化，诸如在结果列表中，清晰的展示了页面地址、以及层级路径（譬如 &lt;a href=&quot;https://you.com/search?q=%E5%80%BE%E5%9F%8E%E4%B9%8B%E9%93%BE&quot;&gt;nicelinks.site &amp;gt; about&lt;/a&gt;）。除了 Web 应用，适用于 iOS 和 Android 的应用程序，以及 Chrome 扩展。如果您对 you.com 感兴趣，可以参见 &lt;a href=&quot;https://nicelinks.site/redirect?url=https://about.you.com/hc-category/getting-started/&quot;&gt;You.com 入门&lt;/a&gt;。&lt;/p&gt;&lt;p&gt;── 出自&lt;a href=&quot;https://nicelinks.site/post/62d947dd65fb1506218fa5e5&quot;&gt;倾城之链 - You.com | The search engine you control&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;标签&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/tags/JavaScript&quot;&gt;&lt;code&gt;JavaScript&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/%E6%95%99%E7%A8%8B&quot;&gt;&lt;code&gt;教程&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/Web%E5%BC%80%E5%8F%91&quot;&gt;&lt;code&gt;Web开发&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;A quick reference to best practices for writing JavaScript -- links to code patterns and tutorials from around the web .&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;https://oss.nicelinks.site/jstherightway.org.png?x-oss-process=style/png2jpg&quot; alt=&quot;倾城之链 - JS: The Right Way&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;推荐语&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/redirect?url=https://jstherightway.org/&quot;&gt;JS: The Right Way&lt;/a&gt; 编写J avaScript 最佳实践的参考指南；该指南旨在向新开发人员介绍 JavaScript，并帮助有经验的开发人员，更多地了解其最佳实践。当然，该指南并不一定意味着执行 JavaScript 的“唯一方法”，它只是收集来自顶级开发人员的所有文章、提示和技巧，并将其放在这里。由于它来自杰出的人，可以说这是“正确的方式”，或者说是最好的方式。&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://nicelinks.site/redirect?url=https://jstherightway.org/&quot;&gt;JS: The Right Way&lt;/a&gt; 所涉及的内容非常丰富，包含：JavaScript 入门，代码风格、特色功能、设计模式、各种框架、测试工具、游戏引擎，以及相关方面的推荐文章、新闻。如果您从事，或打算从事 Web 前端开发，相信 &lt;a href=&quot;https://nicelinks.site/redirect?url=https://jstherightway.org/&quot;&gt;JS: The Right Way&lt;/a&gt; 都能带来或多或少的帮助。&lt;/p&gt;&lt;p&gt;── 出自&lt;a href=&quot;https://nicelinks.site/post/62d7f92a65fb1506218fa5e3&quot;&gt;倾城之链 - JS: The Right Way&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;标签&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/tags/%E5%BC%80%E6%BA%90&quot;&gt;&lt;code&gt;开源&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/CMS&quot;&gt;&lt;code&gt;CMS&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/API&quot;&gt;&lt;code&gt;API&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Strapi is the next-gen headless CMS, open-source, javascript, enabling content-rich experiences to be created, managed and exposed to any digital device.&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;https://oss.nicelinks.site/strapi.io.png?x-oss-process=style/png2jpg&quot; alt=&quot;倾城之链 - Strapi - Open source Node.js Headless CMS 🚀&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;推荐语&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/redirect?url=https://strapi.io/&quot;&gt;Strapi&lt;/a&gt; 是一款免费的、领先的&lt;strong&gt;开源&lt;/strong&gt;无头（Headless） CMS，轻松构建可定制的 API，可在您需要的任何地方提供您的内容。它是 100% JavaScript，完全可定制和开发者优先。除此之外，它还具有以下功能特色：&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;strong&gt;控制您的数据&lt;/strong&gt;：使用 Strapi，您可以知道您的数据存储在哪里，并始终保持完全控制。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;自托管&lt;/strong&gt;：您可以按照自己的方式托管和扩展 Strapi 项目。您可以选择任何您想要的托管平台：AWS、Render、Netlify、Heroku、VPS 或专用服务器。您可以随着成长而扩展，100% 独立。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;数据库不可知论&lt;/strong&gt;：Strapi 适用于 SQL 数据库。您可以选择您喜欢的数据库：PostgreSQL、MySQL、MariaDB 和 SQLite。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;可定制&lt;/strong&gt;。您可以通过完全自定义 API、路由或插件来快速构建逻辑，以完美满足您的需求。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;速度极快：&lt;/strong&gt; Strapi 建立在 Node.js 之上，提供了惊人的性能。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;RESTful 或 GraphQL&lt;/strong&gt;：从任何客户端使用 API（React，Vue、Angular）、移动应用程序甚至物联网设备，使用 REST 或 GraphQL。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;默认安全&lt;/strong&gt;：可重用策略、CORS、CSP、P3P、Xframe、XSS 等。&lt;/li&gt;&lt;li&gt;&lt;strong&gt;现代管理面板&lt;/strong&gt;：优雅、完全可定制且完全可扩展的管理面板。&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;您可以使用如下&lt;strong&gt;快速启动&lt;/strong&gt;命令，安装 Strapi，并以立即创建一个 Strapi 项目：&lt;/p&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot;&gt;# yarn
yarn create strapi-app my-project --quickstart

# npx
npx create-strapi-app my-project --quickstart
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;此命令生成一个具有默认功能（身份验证、权限、内容管理、内容类型构建器和文件上传）的全新项目。&lt;strong&gt;Quickstart 命令使用&lt;/strong&gt; SQLite 数据库安装 Strapi，该数据库用于开发中的原型设计。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;strong&gt;Headless CMS 是什么&lt;/strong&gt;？Headless CMS 是一套内容管理系统，但它仅仅是管理内容的创造；好比写作，您只关注需要写什么就行，至于外观怎么去展示不用关心，系统将内容与展示外观分离（好比说 Markdown 之于内容）。对于有大量 WEB 内容的朋友来说，这些内容能够在不同的地方和渠道被重复使用。这个理念对于内容创作者来说意义非凡。具体体现在以下两个方面：&lt;/p&gt;&lt;p&gt;首先，Web 内容变得更加多样复杂，而且用户的期望在不断提高。 企业要在竞争中脱颖而出，需要构建出色、响应性高且具有互动性的内容，而且还要能够快速实施并发布。&lt;/p&gt;&lt;p&gt;第二，新的渠道和用户设备不断涌现。构建出色的内容并不足够，企业还需要确保尽可能高效地将其发布到任何位置。 Headless  CMS 意味着内容创作人员无需考虑Web界面设计而专注于构建出色的内容，而且它使企业的内容运营工作能够适应未来发展需求，将内容发布到任何渠道。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;长期以来，大多数网站内容通过浏览器（通常是网页）发布。 但是新的互联设备层出不穷。如今，受众通过具有不同形状系数的新设备界面（例如智能手机、可穿戴设备、支持 AI 的语音助理、乃至虚拟现实耳机）使用内容。Headless CMS 架构，对于应对这些新的内容挑战，具有基础性的作用。这意味着您可以轻松创建和管理更多内容，并将其发布到更多位置。&lt;a href=&quot;https://nicelinks.site/redirect?url=https://strapi.io/&quot;&gt;Strapi&lt;/a&gt; 让开发人员可以自由使用他们最喜欢的工具和框架，同时允许编辑人员轻松管理他们的内容，并将其分发到任何地方。&lt;/p&gt;&lt;p&gt;── 出自&lt;a href=&quot;https://nicelinks.site/post/62d6a53a65fb1506218fa5e1&quot;&gt;倾城之链 - Strapi - Open source Node.js Headless CMS 🚀&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;标签&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/tags/CSS&quot;&gt;&lt;code&gt;CSS&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/JavaScript&quot;&gt;&lt;code&gt;JavaScript&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/%E8%AE%BE%E8%AE%A1&quot;&gt;&lt;code&gt;设计&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;Articles all around CSS, JavaScript, front-end, UX and design. For designers and web developers.&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;https://oss.nicelinks.site/www.smashingmagazine.com.png?x-oss-process=style/png2jpg&quot; alt=&quot;倾城之链 - Smashing Magazine — For Web Designers And DevelopersClear SearchBack to top&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;推荐语&lt;/strong&gt;： &lt;a href=&quot;https://nicelinks.site/redirect?url=https://www.smashingmagazine.com/&quot;&gt;Smashing Magazine&lt;/a&gt; ，于 2006 年 9 月在德国成立，为网页设计师和 Web 开发人员提供可靠、有用但最重要的实用文章，围绕 CSS、JavaScript、前端、用户体验和设计等方面（内容十分丰富）。该团队小而精，他们真正在意自己的工作，热情而专注，诚实和尊重；他们不关心趋势，关心在实际项目中成功或失败的事情；10 多年以来，始终坚持&lt;strong&gt;高质量的内容&lt;/strong&gt;，致力于提高生产力、提高设计、开发技能以及&lt;strong&gt;平衡工作与生活&lt;/strong&gt;。通过互相学习，一起变得更好——这就是该团队多年来，一直奉行的精神（&lt;code&gt;赞&lt;/code&gt;）。事实上，他们做到了，在这里读到了蛮多精品内容分享，如果您从事前端开发，或网页设计相关工作，Smashing 是非常值得关注的网站。&lt;/p&gt;&lt;p&gt;── 出自&lt;a href=&quot;https://nicelinks.site/post/62d69eb465fb1506218fa5df&quot;&gt;倾城之链 - Smashing Magazine — For Web Designers And DevelopersClear SearchBack to top&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;标签&lt;/strong&gt;：&lt;a href=&quot;https://nicelinks.site/tags/%E5%85%8D%E8%B4%B9&quot;&gt;&lt;code&gt;免费&lt;/code&gt;&lt;/a&gt; · &lt;a href=&quot;https://nicelinks.site/tags/%E8%B5%84%E6%BA%90&quot;&gt;&lt;code&gt;资源&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;关键字&lt;/strong&gt;：免费主机, 免费PHP主机, 免费虚拟空间, 免费 MYSQL 数据库, 永久免费空间, 海外免备案主机, freehost&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;免费主机（&lt;a href=&quot;http://www.freehost.cc%EF%BC%89%E6%8F%90%E4%BE%9B%E6%B0%B8%E4%B9%85%E5%85%8D%E8%B4%B9%E3%80%81%E5%85%8D%E5%A4%87%E6%A1%88%E7%9A%84%E6%B5%B7%E5%A4%96%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E7%A9%BA%E9%97%B4%EF%BC%8C%E9%85%8D%E7%BD%AE&quot;&gt;www.freehost.cc）提供永久免费、免备案的海外虚拟主机空间，配置&lt;/a&gt; PHP + Apache + MYSQL，10G 存储空间、每月 100G 流量，支持绑定独立域名，搭配简单易用的 cPanel 建站面板，是初期建站学习的最佳选择。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;https://oss.nicelinks.site/www.freehost.cc.png?x-oss-process=style/png2jpg&quot; alt=&quot;倾城之链 - 免费主机（freehost.cc）提供永久免费、无广告的海外虚拟主机空间&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;推荐语&lt;/strong&gt;： &lt;a href=&quot;https://nicelinks.site/redirect?url=https://www.freehost.cc/&quot;&gt;freehost.cc&lt;/a&gt; 提供专业的免费主机服务，采用服务器集群技术，是互联网领先的免费云虚拟主机提供商。在这里注册的免费高速 PHP 主机和 MYSQL 数据库包含一个免费的二级域名，他提供一个强大的、且易于使用的控制面板来管理你的网站，这个控制面板包含几百个强大的功能，包含：一键建站工具、电子邮件、FTP 具，并且提供 SSH/HTTPS 来保护每一个域名。使用他们的免费主机服务您的个人网站，会更安全，以及更好的搜索引擎排名（以上内容，完全出自 freehost.cc 网站介绍，还未切实去体验，感兴趣的朋友，请自行判断）。&lt;/p&gt;&lt;p&gt;── 出自&lt;a href=&quot;https://nicelinks.site/post/62d5153f65fb1506218fa5dd&quot;&gt;倾城之链 - 免费主机（freehost.cc）提供永久免费、无广告的海外虚拟主机空间&lt;/a&gt;&lt;/p&gt;&lt;p&gt;对倾城之链感兴趣的朋友，可通过 Web，小程序，快应用等渠道进行访问(后续将支持更多，如 VsCode 插件，Chrome 扩展等)。您有任何问题，欢迎随时向我们反馈（您可以通过官网反馈渠道，或添加如下客服微信），🤲 。&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;https://image.nicelinks.site/%E5%80%BE%E5%9F%8E%E4%B9%8B%E9%93%BE-%E5%BE%AE%E4%BF%A1-mini.jpeg&quot; alt=&quot;倾城之链 - 客服微信&quot;/&gt;&lt;/p&gt;&lt;h2 id=&quot;本期文末寄语&quot;&gt;&lt;a href=&quot;#%E6%9C%AC%E6%9C%9F%E6%96%87%E6%9C%AB%E5%AF%84%E8%AF%AD&quot; aria-label=&quot;本期文末寄语 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; version=&quot;1.1&quot; viewbox=&quot;0 0 16 16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;本期文末寄语&lt;/h2&gt;&lt;p&gt;可怜白雪曲，未遇知音人。&lt;br/&gt;恓惶戎旅下，蹉跎淮海滨。&lt;br/&gt;涧树含朝雨，山鸟哢馀春。&lt;br/&gt;&lt;strong&gt;我有一瓢酒，可以慰风尘&lt;/strong&gt;。&lt;br/&gt;──唐代 · 韦应物《简卢陟》&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://nicelinks.site/?utm_source=weekly&quot;&gt;倾城之链&lt;/a&gt;作为一个开放平台，旨在云集全球&lt;strong&gt;优秀网站&lt;/strong&gt;，探索互联网中更广阔的世界；在这里，你可以轻松发现、学习、分享更多有用或有趣的事物。&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;img src=&quot;https://image.nicelinks.site/nicelinks-miniprogram-code.jpeg?imageView2/1/w/250/h/250/interlace/1/ignore-error/1&quot; alt=&quot;小程序码 - 倾城之链&quot;/&gt;&lt;/p&gt;&lt;h2 id=&quot;您可能感兴趣的文章&quot;&gt;&lt;a href=&quot;#%E6%82%A8%E5%8F%AF%E8%83%BD%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E6%96%87%E7%AB%A0&quot; aria-label=&quot;您可能感兴趣的文章 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; version=&quot;1.1&quot; viewbox=&quot;0 0 16 16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;/&gt;&lt;/svg&gt;&lt;/a&gt;您可能感兴趣的文章&lt;/h2&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>1414caa013115bf0f2d81ca289375600</guid>
<title>分布式接口幂等性、分布式限流：Guava 、nginx和lua限流</title>
<link>https://toutiao.io/k/xqm5e8k</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;br/&gt;&lt;/h3&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;一、接口幂等性&lt;/span&gt;&lt;/strong&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;接口幂等性就是用户对于同一操作发起的一次请求或者多次请求的结果是一致的，不会因为多次点击而产生了副作用。举个最简单的例子，那就是支付，用户购买商品后支付，支付扣款成功，但是返回结果的时候网络异常，此时钱已经扣了，用户再次点击按钮，此时会进行第二次扣款，返回结果成功，用户查询余额返发现多扣钱了，流水记录也变成了两条,这就没有保证接口的幂等性。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;幂等性的核心思想：通过唯一的业务单号保障幂等性，非并发的情况下，查询业务单号有没有操作过，没有则执行操作，并发情况下，这个操作过程需要加锁。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1、Update操作的幂等性&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）根据唯一业务号去更新数据&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;通过版本号的方式，来控制update的操作的幂等性，用户查询出要修改的数据，系统将数据返回给页面，将数据版本号放入隐藏域，用户修改数据，点击提交，将版本号一同提交给后台，后台使用版本号作为更新条件&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;update&lt;/span&gt; &lt;span&gt;set&lt;/span&gt; &lt;span&gt;version&lt;/span&gt; = &lt;span&gt;version&lt;/span&gt; +&lt;span&gt;1&lt;/span&gt; ,xxx=${xxx} &lt;span&gt;where&lt;/span&gt; &lt;span&gt;id&lt;/span&gt; =xxx &lt;span&gt;and&lt;/span&gt; &lt;span&gt;version&lt;/span&gt; = ${&lt;span&gt;version&lt;/span&gt;};  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2、使用Token机制，保证update、insert操作的幂等性&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）没有唯一业务号的update与insert操作&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;进入到注册页时，后台统一生成Token， 返回前台隐藏域中，用户在页面点击提交时，将Token一同传入后台，使用Token获取分布式锁，完成Insert操作，执行成功后，不释放锁，等待过期自动释放。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;span&gt;二、分布式限流&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1、分布式限流的几种维度&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;时间 限流基于某段时间范围或者某个时间点，也就是我们常说的“时间窗口”，比如对每分钟、每秒钟的时间窗口做限定 资源 基于可用资源的限制，比如设定最大访问次数，或最高可用连接数&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面两个维度结合起来看，限流就是在某个时间窗口对资源访问做限制，比如设定每秒最多100个访问请求。但在真正的场景里，我们不止设置一种限流规则，而是会设置多个限流规则共同作用，主要的几种限流规则如下：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1）QPS和连接数控制&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;针对上图中的连接数和QPS(query per second)限流来说，我们可以设定IP维度的限流，也可以设置基于单个服务器的限流。在真实环境中通常会设置多个维度的限流规则，比如设定同一个IP每秒访问频率小于10，连接数小于5，再设定每台机器QPS最高1000，连接数最大保持200。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;更进一步，我们可以把某个服务器组或整个机房的服务器当做一个整体，设置更high-level的限流规则，这些所有限流规则都会共同作用于流量控制。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2）传输速率&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于“传输速率”大家都不会陌生，比如资源的下载速度。有的网站在这方面的限流逻辑做的更细致，比如普通注册用户下载速度为100k/s，购买会员后是10M/s，这背后就是基于用户组或者用户标签的限流逻辑。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3）黑白名单&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;黑白名单是各个大型企业应用里很常见的限流和放行手段，而且黑白名单往往是动态变化的。举个例子，如果某个IP在一段时间的访问次数过于频繁，被系统识别为机器人用户或流量攻击，那么这个IP就会被加入到黑名单，从而限制其对系统资源的访问，这就是我们俗称的“封IP”。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我们平时见到的爬虫程序，比如说爬知乎上的美女图片，或者爬券商系统的股票分时信息，这类爬虫程序都必须实现更换IP的功能，以防被加入黑名单。有时我们还会发现公司的网络无法访问12306这类大型公共网站，这也是因为某些公司的出网IP是同一个地址，因此在访问量过高的情况下，这个IP地址就被对方系统识别，进而被添加到了黑名单。使用家庭宽带的同学们应该知道，大部分网络运营商都会将用户分配到不同出网IP段，或者时不时动态更换用户的IP地址。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;白名单就更好理解了，相当于御赐金牌在身，可以自由穿梭在各种限流规则里，畅行无阻。比如某些电商公司会将超大卖家的账号加入白名单，因为这类卖家往往有自己的一套运维系统，需要对接公司的IT系统做大量的商品发布、补货等等操作。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;4）分布式环境&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所谓的分布式限流，其实道理很简单，一句话就可以解释清楚。分布式区别于单机限流的场景，它把整个分布式环境中所有服务器当做一个整体来考量。比如说针对IP的限流，我们限制了1个IP每秒最多10个访问，不管来自这个IP的请求落在了哪台机器上，只要是访问了集群中的服务节点，那么都会受到限流规则的制约。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上面的例子不难看出，我们必须将限流信息保存在一个“中心化”的组件上，这样它就可以获取到集群中所有机器的访问状态，目前有两个比较主流的限流方案：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;网关层限流&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;中间件限流&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;将限流信息存储在分布式环境中某个中间件里（比如Redis缓存），每个组件都可以从这里获取到当前时刻的流量统计，从而决定是拒绝服务还是放行流量&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2、限流方案常用算法讲解&lt;span/&gt;&lt;/h4&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1）令牌桶算法&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Token Bucket令牌桶算法是目前应用最为广泛的限流算法，顾名思义，它有以下两个关键角色：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;令牌 获取到令牌的Request才会被处理，其他Requests要么排队要么被直接丢弃&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;p&gt;桶 用来装令牌的地方，所有Request都从这个桶里面获取令牌&lt;/p&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.4583333333333333&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8KKrHK5ic6XAm8H0a8AQx38EIe3lIEdywfDFGbCUpcygn8f4QoXugbuLnqSpAISDqnwtxMI7NQNHRs9Vk5nbx9A/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&amp;amp;random=0.11260475107794754&quot; data-w=&quot;1080&quot;/&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;令牌生成&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这个流程涉及到令牌生成器和令牌桶，前面我们提到过令牌桶是一个装令牌的地方，既然是个桶那么必然有一个容量，也就是说令牌桶所能容纳的令牌数量是一个固定的数值。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;对于令牌生成器来说，它会根据一个预定的速率向桶中添加令牌，比如我们可以配置让它以每秒100个请求的速率发放令牌，或者每分钟50个。注意这里的发放速度是匀速，也就是说这50个令牌并非是在每个时间窗口刚开始的时候一次性发放，而是会在这个时间窗口内匀速发放。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在令牌发放器就是一个水龙头，假如在下面接水的桶子满了，那么自然这个水（令牌）就流到了外面。在令牌发放过程中也一样，令牌桶的容量是有限的，如果当前已经放满了额定容量的令牌，那么新来的令牌就会被丢弃掉。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;令牌获取&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;每个访问请求到来后，必须获取到一个令牌才能执行后面的逻辑。假如令牌的数量少，而访问请求较多的情况下，一部分请求自然无法获取到令牌，那么这个时候我们可以设置一个“缓冲队列”来暂存这些多余的令牌。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;缓冲队列其实是一个可选的选项，并不是所有应用了令牌桶算法的程序都会实现队列。当有缓存队列存在的情况下，那些暂时没有获取到令牌的请求将被放到这个队列中排队，直到新的令牌产生后，再从队列头部拿出一个请求来匹配令牌。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当队列已满的情况下，这部分访问请求将被丢弃。在实际应用中我们还可以给这个队列加一系列的特效，比如设置队列中请求的存活时间，或者将队列改造为PriorityQueue，根据某种优先级排序，而不是先进先出。算法是死的，人是活的，先进的生产力来自于不断的创造，在技术领域尤其如此。&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2）漏桶算法&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Leaky Bucket&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5972222222222222&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/8KKrHK5ic6XAm8H0a8AQx38EIe3lIEdywV2z4moFZkz7II8aOylfO5DGl8WkfrPYO0pFOL55SEhStfj2iavXAa9w/640?wx_fmt=png&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&amp;amp;random=0.8151918815769568&quot; data-w=&quot;1080&quot;/&gt;&lt;figcaption&gt;&lt;br/&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;漏桶算法的前半段和令牌桶类似，但是操作的对象不同，令牌桶是将令牌放入桶里，而漏桶是将访问请求的数据包放到桶里。同样的是，如果桶满了，那么后面新来的数据包将被丢弃。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;漏桶算法的后半程是有鲜明特色的，它永远只会以一个恒定的速率将数据包从桶内流出。打个比方，如果我设置了漏桶可以存放100个数据包，然后流出速度是1s一个，那么不管数据包以什么速率流入桶里，也不管桶里有多少数据包，漏桶能保证这些数据包永远以1s一个的恒定速度被处理。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;漏桶 vs 令牌桶的区别&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;根据它们各自的特点不难看出来，这两种算法都有一个“恒定”的速率和“不定”的速率。令牌桶是以恒定速率创建令牌，但是访问请求获取令牌的速率“不定”，反正有多少令牌发多少，令牌没了就干等。而漏桶是以“恒定”的速率处理请求，但是这些请求流入桶的速率是“不定”的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从这两个特点来说，漏桶的天然特性决定了它不会发生突发流量，就算每秒1000个请求到来，那么它对后台服务输出的访问速率永远恒定。而令牌桶则不同，其特性可以“预存”一定量的令牌，因此在应对突发流量的时候可以在短时间消耗所有令牌，其突发流量处理效率会比漏桶高，但是导向后台系统的压力也会相应增多。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3、分布式限流的主流方案&lt;span/&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这里主要讲nginx和lua的限流，gateway和hystrix放在后面springcloud中讲&lt;/p&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;1）Guava RateLimiter客户端限流&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.引入maven&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.google.guava&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;guava&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;18.0&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2.编写Controller&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RestController&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;@Slf&lt;/span&gt;4j  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Controller&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;//每秒钟可以创建两个令牌  &lt;/span&gt;&lt;br/&gt;    RateLimiter limiter = RateLimiter.create(&lt;span&gt;2.0&lt;/span&gt;);  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;//非阻塞限流  &lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/tryAcquire&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;tryAcquire&lt;/span&gt;&lt;span&gt;(Integer count)&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        &lt;span&gt;//count 每次消耗的令牌  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt;(limiter.tryAcquire(count)){  &lt;br/&gt;            log.info(&lt;span&gt;&quot;成功，允许通过，速率为{}&quot;&lt;/span&gt;,limiter.getRate());  &lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;success&quot;&lt;/span&gt;;  &lt;br/&gt;        }&lt;span&gt;else&lt;/span&gt;{  &lt;br/&gt;            log.info(&lt;span&gt;&quot;错误，不允许通过，速率为{}&quot;&lt;/span&gt;,limiter.getRate());  &lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;fail&quot;&lt;/span&gt;;  &lt;br/&gt;        }  &lt;br/&gt;    }  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;//限定时间的非阻塞限流  &lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/tryAcquireWithTimeout&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;tryAcquireWithTimeout&lt;/span&gt;&lt;span&gt;(Integer count, Integer timeout)&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        &lt;span&gt;//count 每次消耗的令牌  timeout 超时等待的时间  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt;(limiter.tryAcquire(count,timeout,TimeUnit.SECONDS)){  &lt;br/&gt;            log.info(&lt;span&gt;&quot;成功，允许通过，速率为{}&quot;&lt;/span&gt;,limiter.getRate());  &lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;success&quot;&lt;/span&gt;;  &lt;br/&gt;        }&lt;span&gt;else&lt;/span&gt;{  &lt;br/&gt;            log.info(&lt;span&gt;&quot;错误，不允许通过，速率为{}&quot;&lt;/span&gt;,limiter.getRate());  &lt;br/&gt;            &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;fail&quot;&lt;/span&gt;;  &lt;br/&gt;        }  &lt;br/&gt;    }  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;//同步阻塞限流  &lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/acquire&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;acquire&lt;/span&gt;&lt;span&gt;(Integer count)&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        limiter.acquire(count);  &lt;br/&gt;        log.info(&lt;span&gt;&quot;成功，允许通过，速率为{}&quot;&lt;/span&gt;,limiter.getRate());  &lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;success&quot;&lt;/span&gt;;  &lt;br/&gt;    }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;2）基于Nginx的限流&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1.iP限流&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.编写Controller&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RestController&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;@Slf&lt;/span&gt;4j  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Controller&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;//nginx测试使用  &lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;/nginx&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;nginx&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        log.info(&lt;span&gt;&quot;Nginx success&quot;&lt;/span&gt;);  &lt;br/&gt;    }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2.修改host文件，添加一个网址域名&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;127.0.0.1   www.test.com  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3.修改nginx，将步骤2中的域名，添加到路由规则当中&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;打开nginx的配置文件&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;vim /usr/&lt;span&gt;local&lt;/span&gt;/nginx/conf/nginx.conf  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;添加一个服务&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;#根据IP地址限制速度  &lt;/span&gt;&lt;br/&gt;&lt;span&gt;#1）$binary_remote_addr   binary_目的是缩写内存占用，remote_addr表示通过IP地址来限流  &lt;/span&gt;&lt;br/&gt;&lt;span&gt;#2）zone=iplimit:20m   iplimit是一块内存区域（记录访问频率信息），20m是指这块内存区域的大小  &lt;/span&gt;&lt;br/&gt;&lt;span&gt;#3）rate=1r/s  每秒放行1个请求  &lt;/span&gt;&lt;br/&gt;limit_req_zone &lt;span&gt;$binary_remote_addr&lt;/span&gt; zone=iplimit:20m rate=1r/s;  &lt;br/&gt;  &lt;br/&gt;server{  &lt;br/&gt;    server_name www.test.com;  &lt;br/&gt;    location /access-limit/ {  &lt;br/&gt;        proxy_pass http://127.0.0.1:8080/;  &lt;br/&gt;          &lt;br/&gt;        &lt;span&gt;#基于ip地址的限制  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;#1）zone=iplimit 引用limit_rep_zone中的zone变量  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;#2）burst=2  设置一个大小为2的缓冲区域，当大量请求到来，请求数量超过限流频率时，将其放入缓冲区域  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;#3）nodelay   缓冲区满了以后，直接返回503异常  &lt;/span&gt;&lt;br/&gt;        limit_req zone=iplimit burst=2 nodelay;  &lt;br/&gt;    }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;4.访问地址，测试是否限流&lt;/p&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;www.test.com/access-limit/nginx&lt;/p&gt;&lt;/blockquote&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2.多维度限流&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.修改nginx配置&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;#根据IP地址限制速度  &lt;/span&gt;&lt;br/&gt;limit_req_zone &lt;span&gt;$binary_remote_addr&lt;/span&gt; zone=iplimit:20m rate=10r/s;  &lt;br/&gt;&lt;span&gt;#根据服务器级别做限流  &lt;/span&gt;&lt;br/&gt;limit_req_zone &lt;span&gt;$server_name&lt;/span&gt; zone=serverlimit:10m rate=1r/s;  &lt;br/&gt;&lt;span&gt;#根据ip地址的链接数量做限流  &lt;/span&gt;&lt;br/&gt;limit_conn_zone &lt;span&gt;$binary_remote_addr&lt;/span&gt; zone=perip:20m;  &lt;br/&gt;&lt;span&gt;#根据服务器的连接数做限流  &lt;/span&gt;&lt;br/&gt;limit_conn_zone &lt;span&gt;$server_name&lt;/span&gt; zone=perserver:20m;  &lt;br/&gt;  &lt;br/&gt;  &lt;br/&gt;server{  &lt;br/&gt;    server_name www.test.com;  &lt;br/&gt;    location /access-limit/ {  &lt;br/&gt;        proxy_pass http://127.0.0.1:8080/;  &lt;br/&gt;          &lt;br/&gt;        &lt;span&gt;#基于ip地址的限制  &lt;/span&gt;&lt;br/&gt;        limit_req zone=iplimit burst=2 nodelay;  &lt;br/&gt;        &lt;span&gt;#基于服务器级别做限流  &lt;/span&gt;&lt;br/&gt;        limit_req zone=serverlimit burst=2 nodelay;  &lt;br/&gt;        &lt;span&gt;#基于ip地址的链接数量做限流  最多保持100个链接  &lt;/span&gt;&lt;br/&gt;        limit_conn zone=perip 100;  &lt;br/&gt;        &lt;span&gt;#基于服务器的连接数做限流 最多保持100个链接  &lt;/span&gt;&lt;br/&gt;        limit_conn zone=perserver 1;  &lt;br/&gt;        &lt;span&gt;#配置request的异常返回504（默认为503）  &lt;/span&gt;&lt;br/&gt;        limit_req_status 504;  &lt;br/&gt;        limit_conn_status 504;  &lt;br/&gt;    }  &lt;br/&gt;      &lt;br/&gt;     location /download/ {  &lt;br/&gt;        &lt;span&gt;#前100m不限制速度  &lt;/span&gt;&lt;br/&gt;        limit_rate_affer 100m;  &lt;br/&gt;        &lt;span&gt;#限制速度为256k  &lt;/span&gt;&lt;br/&gt;        limit_rate 256k;  &lt;br/&gt;     }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h5 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;3）基于Redis+Lua的分布式限流&lt;span/&gt;&lt;/h5&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;1.Lua脚本&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Lua是一个很小巧精致的语言，它的诞生（1993年）甚至比JDK 1.0还要早。Lua是由标准的C语言编写的，它的源码部分不过2万多行C代码，甚至一个完整的Lua解释器也就200k的大小。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Lua往大了说是一个新的编程语言，往小了说就是一个脚本语言。对于有编程经验的同学，拿到一个Lua脚本大体上就能把业务逻辑猜的八九不离十了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;Redis内置了Lua解释器，执行过程保证原子性&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;2.Lua安装&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;安装Lua：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.参考&lt;code&gt;http://www.lua.org/ftp/&lt;/code&gt;教程，下载5.3.5_1版本，本地安装&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果你使用的是Mac，那建议用brew工具直接执行brew install lua就可以顺利安装，有关brew工具的安装可以参考&lt;code&gt;https://brew.sh/&lt;/code&gt;网站，使用brew安装后的目录在&lt;code&gt;/usr/local/Cellar/lua/5.3.5_1&lt;/code&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2.安装IDEA插件，在IDEA-&amp;gt;Preferences面板，Plugins，里面Browse repositories，在里面搜索lua，然后就选择同名插件lua。安装好后重启IDEA&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3.配置Lua SDK的位置：&lt;code&gt;IDEA-&amp;gt;File-&amp;gt;Project Structure&lt;/code&gt;,选择添加Lua，路径指向Lua SDK的bin文件夹&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;4.都配置好之后，在项目中右键创建Module，左侧栏选择lua，点下一步，选择lua的sdk，下一步，输入lua项目名，完成&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;3.编写hello lua&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;print&lt;/span&gt; &lt;span&gt;&#x27;Hello Lua&#x27;&lt;/span&gt;  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;4.编写模拟限流&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;-- 模拟限流  &lt;br/&gt;  &lt;br/&gt;-- 用作限流的key  &lt;br/&gt;&lt;span&gt;local&lt;/span&gt; key = &lt;span&gt;&#x27;my key&#x27;&lt;/span&gt;  &lt;br/&gt;  &lt;br/&gt;-- 限流的最大阈值  &lt;br/&gt;&lt;span&gt;local&lt;/span&gt; &lt;span&gt;limit&lt;/span&gt; = 2  &lt;br/&gt;  &lt;br/&gt;-- 当前限流大小  &lt;br/&gt;&lt;span&gt;local&lt;/span&gt; currentLimit = 2  &lt;br/&gt;  &lt;br/&gt;-- 是否超过限流标准  &lt;br/&gt;&lt;span&gt;if&lt;/span&gt; currentLimit + 1 &amp;gt; &lt;span&gt;limit&lt;/span&gt; &lt;span&gt;then&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;print&lt;/span&gt; &lt;span&gt;&#x27;reject&#x27;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;else&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;print&lt;/span&gt; &lt;span&gt;&#x27;accept&#x27;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;  &lt;br/&gt;end  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;5.限流组件封装&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.添加maven&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-data-redis&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.boot&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;spring-boot-starter-aop&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;com.google.guava&lt;span&gt;&amp;lt;/&lt;span&gt;groupId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;guava&lt;span&gt;&amp;lt;/&lt;span&gt;artifactId&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;&amp;lt;&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;18.0&lt;span&gt;&amp;lt;/&lt;span&gt;version&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;&amp;lt;/&lt;span&gt;dependency&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2.添加Spring配置&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;不是重要内容就随便写点，主要就是把reids配置一下&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;server.port=8080  &lt;br/&gt;  &lt;br/&gt;spring.redis.database=0  &lt;br/&gt;spring.redis.host=localhost  &lt;br/&gt;spring.redis.port=6376  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3.编写限流脚本&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;lua脚本放在resource目录下就可以了&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;-- 获取方法签名特征  &lt;br/&gt;&lt;span&gt;local&lt;/span&gt; methodKey = KEYS[1]  &lt;br/&gt;redis.log(redis.LOG_DEBUG,&lt;span&gt;&#x27;key is&#x27;&lt;/span&gt;,methodKey)  &lt;br/&gt;  &lt;br/&gt;-- 调用脚本传入的限流大小  &lt;br/&gt;&lt;span&gt;local&lt;/span&gt; &lt;span&gt;limit&lt;/span&gt; = tonumber(ARGV[1])  &lt;br/&gt;  &lt;br/&gt;-- 获取当前流量大小  &lt;br/&gt;&lt;span&gt;local&lt;/span&gt; count = tonumber(redis.call(&lt;span&gt;&#x27;get&#x27;&lt;/span&gt;,methodKey) or &lt;span&gt;&quot;0&quot;&lt;/span&gt;)  &lt;br/&gt;  &lt;br/&gt;--是否超出限流值  &lt;br/&gt;&lt;span&gt;if&lt;/span&gt; count + 1 &amp;gt;&lt;span&gt;limit&lt;/span&gt; &lt;span&gt;then&lt;/span&gt;  &lt;br/&gt;    -- 拒绝访问  &lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;false&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;else&lt;/span&gt;  &lt;br/&gt;    -- 没有超过阈值  &lt;br/&gt;    -- 设置当前访问数量+1  &lt;br/&gt;    redis.call(&lt;span&gt;&#x27;INCRBY&#x27;&lt;/span&gt;,methodKey,1)  &lt;br/&gt;    -- 设置过期时间  &lt;br/&gt;    redis.call(&lt;span&gt;&#x27;EXPIRE&#x27;&lt;/span&gt;,methodKey,1)  &lt;br/&gt;    -- 放行  &lt;br/&gt;    &lt;span&gt;return&lt;/span&gt; &lt;span&gt;true&lt;/span&gt;  &lt;br/&gt;end  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;4.使用&lt;code&gt;spring-data-redis&lt;/code&gt;组件集成Lua和Redis&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;创建限流类&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Service&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;@Slf&lt;/span&gt;4j  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;AccessLimiter&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;@Autowired&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; StringRedisTemplate stringRedisTemplate;  &lt;br/&gt;    &lt;span&gt;@Autowired&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; RedisScript&amp;lt;Boolean&amp;gt; rateLimitLua;  &lt;br/&gt;  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;limitAccess&lt;/span&gt;&lt;span&gt;(String key,Integer limit)&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        &lt;span&gt;boolean&lt;/span&gt; acquired = stringRedisTemplate.execute(  &lt;br/&gt;            rateLimitLua,&lt;span&gt;//lua脚本的真身  &lt;/span&gt;&lt;br/&gt;            Lists.newArrayList(key),&lt;span&gt;//lua脚本中的key列表  &lt;/span&gt;&lt;br/&gt;            limit.toString()&lt;span&gt;//lua脚本的value列表  &lt;/span&gt;&lt;br/&gt;        );  &lt;br/&gt;  &lt;br/&gt;        &lt;span&gt;if&lt;/span&gt;(!acquired){  &lt;br/&gt;            log.error(&lt;span&gt;&quot;Your access is blocked,key={}&quot;&lt;/span&gt;,key);  &lt;br/&gt;            &lt;span&gt;throw&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; RuntimeException(&lt;span&gt;&quot;Your access is blocked&quot;&lt;/span&gt;);  &lt;br/&gt;        }  &lt;br/&gt;    }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;创建配置类&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Configuration&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;RedisConfiguration&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; RedisTemplate&amp;lt;String,String&amp;gt; &lt;span&gt;redisTemplate&lt;/span&gt;&lt;span&gt;(RedisConnectionFactory factory)&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;new&lt;/span&gt; StringRedisTemplate(factory);  &lt;br/&gt;    }  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; DefaultRedisScript &lt;span&gt;loadRedisScript&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        DefaultRedisScript redisScript = &lt;span&gt;new&lt;/span&gt; DefaultRedisScript();  &lt;br/&gt;        redisScript.setLocation(&lt;span&gt;new&lt;/span&gt; ClassPathResource(&lt;span&gt;&quot;rateLimiter.lua&quot;&lt;/span&gt;));  &lt;br/&gt;        redisScript.setResultType(java.lang.Boolean&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;)&lt;/span&gt;;  &lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; redisScript;  &lt;br/&gt;    }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;5.在Controller中添加测试方法验证限流效果&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RestController&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;@Slf&lt;/span&gt;4j  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Controller&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;@Autowired&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; AccessLimiter accessLimiter;  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;test&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;test&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        accessLimiter.limitAccess(&lt;span&gt;&quot;ratelimiter-test&quot;&lt;/span&gt;,&lt;span&gt;1&lt;/span&gt;);  &lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;success&quot;&lt;/span&gt;;  &lt;br/&gt;    }  &lt;br/&gt;}   &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;6.编写限流注解&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;1.新增注解&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Target&lt;/span&gt;({ElementType.METHOD})  &lt;br/&gt;&lt;span&gt;@Retention&lt;/span&gt;(RetentionPolicy.RUNTIME)  &lt;br/&gt;&lt;span&gt;@Documented&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;@interface&lt;/span&gt; AccessLimiterAop{  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;int&lt;/span&gt; &lt;span&gt;limit&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;;  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;String &lt;span&gt;methodKey&lt;/span&gt;&lt;span&gt;()&lt;/span&gt; &lt;span&gt;default&lt;/span&gt; &quot;&quot;&lt;/span&gt;;  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;2.新增切面&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@Slf&lt;/span&gt;4j  &lt;br/&gt;&lt;span&gt;@Aspect&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;@Component&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;AccessLimiterAspect&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;@Autowired&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; AccessLimiter  accessLimiter;  &lt;br/&gt;  &lt;br/&gt;    &lt;span&gt;//根据注解的位置，自己修改  &lt;/span&gt;&lt;br/&gt;    &lt;span&gt;@Pointcut&lt;/span&gt;(&lt;span&gt;&quot;@annotation(com.gyx.demo.annotation.AccessLimiter)&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;cut&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        log.info(&lt;span&gt;&quot;cut&quot;&lt;/span&gt;);  &lt;br/&gt;    }  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;@Before&lt;/span&gt;(&lt;span&gt;&quot;cut()&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;void&lt;/span&gt; &lt;span&gt;before&lt;/span&gt;&lt;span&gt;(JoinPoint joinPoint)&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        &lt;span&gt;//获取方法签名，作为methodkey  &lt;/span&gt;&lt;br/&gt;        MethodSignature signature =(MethodSignature) joinPoint.getSignature();  &lt;br/&gt;        Method method = signature.getMethod();  &lt;br/&gt;        AccessLimiterAop annotation = method.getAnnotation(AccessLimiterAop&lt;span&gt;.&lt;span&gt;class&lt;/span&gt;)&lt;/span&gt;;  &lt;br/&gt;          &lt;br/&gt;        &lt;span&gt;if&lt;/span&gt;(annotation == &lt;span&gt;null&lt;/span&gt;){  &lt;br/&gt;            &lt;span&gt;return&lt;/span&gt;;  &lt;br/&gt;        }  &lt;br/&gt;        String key = annotation.methodKey();  &lt;br/&gt;        Integer limit = annotation.limit();  &lt;br/&gt;        &lt;span&gt;//如果没有设置methodKey，就自动添加一个  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt;(StringUtils.isEmpty(key)){  &lt;br/&gt;            Class[] type = method.getParameterType();  &lt;br/&gt;            key = method.getName();  &lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (type != &lt;span&gt;null&lt;/span&gt;){  &lt;br/&gt;                String paramTypes=Arrays.stream(type)  &lt;br/&gt;                    .map(Class::getName)  &lt;br/&gt;                    .collect(Collectors.joining(&lt;span&gt;&quot;,&quot;&lt;/span&gt;));  &lt;br/&gt;                    key += &lt;span&gt;&quot;#&quot;&lt;/span&gt;+paramTypes;  &lt;br/&gt;            }  &lt;br/&gt;        }  &lt;br/&gt;          &lt;br/&gt;        &lt;span&gt;//调用redis  &lt;/span&gt;&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; accessLimiter.limitAccess(key,limit);  &lt;br/&gt;    }  &lt;br/&gt;}  &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;3.在Controller中添加测试方法验证限流效果&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;@RestController&lt;/span&gt;  &lt;br/&gt;&lt;span&gt;@Slf&lt;/span&gt;4j  &lt;br/&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;Controller&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;    &lt;span&gt;@Autowired&lt;/span&gt;  &lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; AccessLimiter accessLimiter;  &lt;br/&gt;      &lt;br/&gt;    &lt;span&gt;@GetMapping&lt;/span&gt;(&lt;span&gt;&quot;test&quot;&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;@AccessLImiterAop&lt;/span&gt;(limit =&lt;span&gt;1&lt;/span&gt;)  &lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; String &lt;span&gt;test&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;/span&gt;{  &lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; &lt;span&gt;&quot;success&quot;&lt;/span&gt;;  &lt;br/&gt;    }  &lt;br/&gt;} &lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>b685e64e227dc2841f1a99ef345ca381</guid>
<title>Canvas 从入门到劝朋友放弃（图解版）</title>
<link>https://toutiao.io/k/z8mcoqf</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;本文简介&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;点赞 + 关注 + 收藏 = 学会了&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在前端领域，如果只是懂 &lt;code&gt;Vue&lt;/code&gt; 或者 &lt;code&gt;React&lt;/code&gt; ，未来在职场的竞争力可能会比较弱。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;根据我多年在家待业经验来看，前端未来在 &lt;code&gt;数据可视化&lt;/code&gt; 和 &lt;code&gt;AI&lt;/code&gt; 这两个领域会比较香，而 &lt;code&gt;Canvas&lt;/code&gt; 是数据可视化在前端方面的基础技术。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文就用光的速度将 &lt;code&gt;canvas&lt;/code&gt; 给入门了。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9130434782608695&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt959kxhgf5stYRlZMgxVWia3tIkYaf4tqQJPxLy8revgFPtibSdor60FQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;138&quot;/&gt;&lt;figcaption&gt;01.gif&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要入门一个技术，前期最重要是快！所以本文只讲入门内容，能应付简单项目。深入的知识点会在其他文章讲解。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Canvas 是什么？&lt;/span&gt;&lt;/h1&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Canvas&lt;/code&gt; 中文名叫 “画布”，是 &lt;code&gt;HTML5&lt;/code&gt; 新增的一个标签。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Canvas&lt;/code&gt; 允许开发者通过 &lt;code&gt;JS&lt;/code&gt;在这个标签上绘制各种图案。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Canvas&lt;/code&gt; 拥有多种绘制路径、矩形、圆形、字符以及图片的方法。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Canvas&lt;/code&gt; 在某些情况下可以 “代替” 图片。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;Canvas&lt;/code&gt; 可用于动画、游戏、数据可视化、图片编辑器、实时视频处理等领域。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;Canvas 和 SVG 的区别&lt;/span&gt;&lt;/h1&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;table&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Canvas&lt;/th&gt;&lt;th&gt;SVG&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td&gt;用JS动态生成元素（一个HTML元素）&lt;/td&gt;&lt;td&gt;用XML描述元素（类似HTML元素那样，可用多个元素来描述一个图形）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;位图（受屏幕分辨率影响）&lt;/td&gt;&lt;td&gt;矢量图（不受屏幕分辨率影响）&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;不支持事件&lt;/td&gt;&lt;td&gt;支持事件&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;数据发生变化需要重绘&lt;/td&gt;&lt;td&gt;不需要重绘&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;就上面的描述而言可能有点难懂，你可以打开 &lt;code&gt;AntV&lt;/code&gt; 旗下的图形编辑引擎做对比。&lt;span&gt;G6&lt;/span&gt;&lt;sup&gt;[1]&lt;/sup&gt; 是使用 &lt;code&gt;canvas&lt;/code&gt; 开发的，&lt;span&gt;X6&lt;/span&gt;&lt;sup&gt;[2]&lt;/sup&gt; 是使用 &lt;code&gt;svg&lt;/code&gt; 开发的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我的建议是：如果要展示的数据量比较大，比如一条数据就是一个元素节点，那使用 &lt;code&gt;canvas&lt;/code&gt; 会比较合适；如果用户操作的交互比较多，而且对清晰度有要求（矢量图），那么使用 &lt;code&gt;svg&lt;/code&gt; 会比较合适。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;起步&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;学习前端一定要动手敲代码，然后看效果展示。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;起步阶段会用几句代码说明 &lt;code&gt;canvas&lt;/code&gt; 如何使用，本例会画一条直线。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;画条直线&lt;/span&gt;&lt;/h2&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;在 &lt;code&gt;HTML&lt;/code&gt; 中创建 &lt;code&gt;canvas&lt;/code&gt; 元素&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;通过 &lt;code&gt;js&lt;/code&gt; 获取 &lt;code&gt;canvas&lt;/code&gt; 标签&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;从 &lt;code&gt;canvas&lt;/code&gt; 标签中获取到绘图工具&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;通过绘图工具，在 &lt;code&gt;canvas&lt;/code&gt; 标签上绘制图形&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6823899371069182&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAticibJGEuCfBn49I1S6T6Yh0fYXEqmExjLtw9cK3eDIHFIXibR5jsm8Ntg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;02.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;!-- 1、创建 canvas 元素 --&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;200&quot;&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&lt;br/&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;// 2、获取 canvas 对象&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 3、获取 canvas 上下文环境对象&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 4、绘制图形&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;100&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// 起点坐标 (x, y)&lt;/span&gt;&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// 终点坐标 (x, y)&lt;/span&gt;&lt;br/&gt;  cxt.stroke() &lt;span&gt;// 将起点和终点连接起来&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;moveTo&lt;/code&gt; 、 &lt;code&gt;lineTo&lt;/code&gt; 和 &lt;code&gt;stroke&lt;/code&gt; 方法暂时可以不用管，它们的作用是绘制图形，这些方法在后面会讲到~&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;注意点&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;1、默认宽高&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;canvas&lt;/code&gt; 有 &lt;strong&gt;默认的 宽度(300px) 和 高度(150px)&lt;/strong&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果不在 &lt;code&gt;canvas&lt;/code&gt; 上设置宽高，那 &lt;code&gt;canvas&lt;/code&gt; 元素的默认宽度是300px，默认高度是150px。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;2、设置 canvas 宽高&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;canvas&lt;/code&gt; 元素提供了 &lt;code&gt;width&lt;/code&gt; 和 &lt;code&gt;height&lt;/code&gt; 两个属性，可设置它的宽高。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;需要注意的是，这两个属性只需传入数值，不需要传入单位（比如 &lt;code&gt;px&lt;/code&gt; 等）。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;600&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;400&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;3、不能通过 CSS 设置画布的宽高&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;css&lt;/code&gt; 设置 &lt;code&gt;canvas&lt;/code&gt; 的宽高，会出现 &lt;strong&gt;内容被拉伸&lt;/strong&gt; 的后果！！！&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.0023866348448687&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtwscBqmOpDiad9gLsnbjPSmZQickZ6FKXZCQGQZgAULibqgicibCIVMzH7UQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;419&quot;/&gt;&lt;figcaption&gt;03.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;style&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;#c&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;width&lt;/span&gt;: &lt;span&gt;400px&lt;/span&gt;;&lt;br/&gt;    &lt;span&gt;height&lt;/span&gt;: &lt;span&gt;400px&lt;/span&gt;;&lt;br/&gt;    &lt;span&gt;border&lt;/span&gt;: &lt;span&gt;1px&lt;/span&gt; solid &lt;span&gt;#ccc&lt;/span&gt;;&lt;br/&gt;  }&lt;br/&gt;&amp;lt;/&lt;span&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;// 1、获取canvas对象&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 2、获取canvas上下文环境对象&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 3、绘制图形&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;100&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// 起点&lt;/span&gt;&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// 终点&lt;/span&gt;&lt;br/&gt;  cxt.stroke() &lt;span&gt;// 将起点和终点连接起来&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(cnv.width) &lt;span&gt;// 获取 canvas 的宽度，输出：300&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(cnv.height) &lt;span&gt;// 获取 canvas 的高度，输出：150&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;canvas&lt;/code&gt; 的默认宽度是300px，默认高度是150px。&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;如果使用 &lt;code&gt;css&lt;/code&gt; 修改 &lt;code&gt;canvas&lt;/code&gt; 的宽高（比如本例变成 400px * 400px），那宽度就由 300px 拉伸到 400px，高度由 150px 拉伸到 400px。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;使用 &lt;code&gt;js&lt;/code&gt; 获取 &lt;code&gt;canvas&lt;/code&gt; 的宽高，此时返回的是 &lt;code&gt;canvas&lt;/code&gt; 的默认值。&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最后出现的效果如上图所示。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;4、线条默认宽度和颜色&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;线条的默认宽度是 &lt;code&gt;1px&lt;/code&gt; ，默认颜色是黑色。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但由于默认情况下 &lt;code&gt;canvas&lt;/code&gt; 会将线条的中心点和像素的底部对齐，所以会导致显示效果是 &lt;code&gt;2px&lt;/code&gt; 和非纯黑色问题。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;5、IE兼容性高&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;暂时只有 &lt;code&gt;IE 9&lt;/code&gt; 以上才支持 &lt;code&gt;canvas&lt;/code&gt; 。但好消息是 &lt;code&gt;IE&lt;/code&gt; 已经有自己的墓碑了。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如需兼容 &lt;code&gt;IE 7 和 8&lt;/code&gt; ，可以使用 &lt;span&gt;ExplorerCanvas&lt;/span&gt;&lt;sup&gt;[3]&lt;/sup&gt; 。但即使是使用了 &lt;code&gt;ExplorerCanvas&lt;/code&gt; 仍然会有所限制，比如无法使用 &lt;code&gt;fillText()&lt;/code&gt; 方法等。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;基础图形&lt;/span&gt;&lt;/h1&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;坐标系&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在绘制基础图形之前，需要先搞清除 &lt;code&gt;Canvas&lt;/code&gt; 使用的坐标系。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Canvas&lt;/code&gt; 使用的是 &lt;strong&gt;W3C 坐标系&lt;/strong&gt; ，也就是遵循我们屏幕、报纸的阅读习惯，从上往下，从左往右。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.75&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAty7I3tpVp08RZLst20YGbe63OYfb7lG6Gze9A49P50TYxYyI3NO7oeA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1440&quot;/&gt;&lt;figcaption&gt;04.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;W3C 坐标系&lt;/strong&gt; 和 &lt;strong&gt;数学直角坐标系&lt;/strong&gt; 的 &lt;code&gt;X轴&lt;/code&gt; 是一样的，只是 &lt;code&gt;Y轴&lt;/code&gt; 的反向相反。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;W3C 坐标系&lt;/strong&gt; 的 &lt;code&gt;Y轴&lt;/code&gt; 正方向向下。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;直线&lt;/span&gt;&lt;/h2&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;一条直线&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;最简单的起步方式是画一条直线。这里所说的 “直线” 是几何学里的 “线段” 的意思。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;需要用到这3个方法：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;moveTo(x1, y1)&lt;/code&gt;：起点坐标 (x, y)&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;lineTo(x2, y2)&lt;/code&gt;：下一个点的坐标 (x, y)&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;stroke()&lt;/code&gt;：将所有坐标用一条线连起来&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;起步阶段可以先这样理解。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.534375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt2PhPIVJic8DFgXzYGhGt2TdXNJ9zUicNvMYyc2ls80ahRmw228qKfP0g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;320&quot;/&gt;&lt;figcaption&gt;05.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 绘制直线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// 起点坐标&lt;/span&gt;&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;) &lt;span&gt;// 下一个点的坐标&lt;/span&gt;&lt;br/&gt;  cxt.stroke() &lt;span&gt;// 将上面的坐标用一条线连接起来&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的代码所呈现的效果，可以看下图解释（手不太聪明，画得不是很标准，希望能看懂）&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5594771241830065&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtibelqAUMHPZnxRNhqq4oDO4kWUBFV9Lqu1iaiawT45p7niatCWDHdVBX3g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1530&quot;/&gt;&lt;figcaption&gt;06.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;多条直线&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如需画多条直线，可以用会上面那几个方法。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9937106918238994&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtu9iavIJb4AjGeUfBaGoFsUBmhfbboFUsFq9eCaZaNVyuW90R93yElUg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;07.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;仔细观察一下，为什么两条线的粗细不一样的？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;明明使用的方法都是一样的，只是第二条直线的 &lt;code&gt;Y轴&lt;/code&gt; 的值是有小数点。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;答：&lt;strong&gt;默认情况下 &lt;code&gt;canvas&lt;/code&gt; 会将线条的中心点和像素的底部对齐，所以会导致显示效果是 &lt;code&gt;2px&lt;/code&gt; 和非纯黑色问题。&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.75&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtcpNiabian3ibEJiaTKpnoTeQ3vG2qcricZnWU6cRN8W9AhMos1c9TIyzkXA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1440&quot;/&gt;&lt;figcaption&gt;08.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上图每个格子代表 &lt;code&gt;1px&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;线的中心点会和画布像素点的底部对齐&lt;/strong&gt;，所以会线中间是黑色的，但由于一个像素就不能再切割了，所以会有半个像素被染色，就变成了浅灰色。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;所以如果你设置的 &lt;code&gt;Y轴&lt;/code&gt; 值是一个整数，就会出现上面那种情况。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;设置样式&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;lineWidth&lt;/code&gt;：线的粗细&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;strokeStyle&lt;/code&gt;：线的颜色&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;lineCap&lt;/code&gt;：线帽：默认: &lt;code&gt;butt&lt;/code&gt;; 圆形: &lt;code&gt;round&lt;/code&gt;; 方形: &lt;code&gt;square&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5235109717868338&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtpf76Oe6kbQibnicVoVFXWibqoVIQzcYpa36ibjoJhfQU63Xem0D3WtX6nQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;09.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 绘制直线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 修改直线的宽度&lt;/span&gt;&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;20&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 修改直线的颜色&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 修改直线两端样式&lt;/span&gt;&lt;br/&gt;  cxt.lineCap = &lt;span&gt;&#x27;round&#x27;&lt;/span&gt; &lt;span&gt;// 默认: butt; 圆形: round; 方形: square&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;新开路径&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;开辟新路径的方法：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在绘制多条线段的同时，还要设置线段样式，通常需要开辟新路径。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要不然样式之间会相互污染。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;比如这样&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtHxqgHFbOBUsiaYkmfHJsONkiaLrHNlm6eOmYMd9duIuDcrqEkTjcAX5Q/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;10.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第一条线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;10&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第二条线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果不想相互污染，需要做2件事：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;使用 &lt;code&gt;beginPath()&lt;/code&gt; 方法，重新开一个路径&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;设置新线段的样式（必须项）&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果上面2步却了其中1步都会有影响。&lt;/p&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;只使用 &lt;code&gt;beginPath()&lt;/code&gt;&lt;/span&gt;&lt;/h4&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.0031446540880504&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtpUE3A2LyFr9j4TCSvAIHXfEPVVqtFzOT5KFLf3xpdlicUicxtHbic1FRQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;11.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第一条线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;10&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第二条线&lt;/span&gt;&lt;br/&gt;  cxt.beginPath() &lt;span&gt;// 重新开启一个路径&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;第一条线的样式会影响之后的线。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但如果使用了 &lt;code&gt;beginPath()&lt;/code&gt; ，后面的线段不会影响前面的线段。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.0063091482649842&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt85R0y2gmFFAcghslOxMhKiasTnCCMq3zibd2iaCq7M89EAKgUlYWEAbyQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;317&quot;/&gt;&lt;figcaption&gt;12.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第一条线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第二条线&lt;/span&gt;&lt;br/&gt;  cxt.beginPath() &lt;span&gt;// 重新开启一个路径&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;4&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;设置新线段的样式，没使用 &lt;code&gt;beginPath()&lt;/code&gt; 的情况&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这个情况会反过来，后面的线能影响前面的线。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtk9orwIdJmeaQ7LhEsoianYL4qXzUccedm64DK4ycqOzAcn6tLqNhpPg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;13.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第一条线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;10&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 第二条线&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;4&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h4 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;正确的做法&lt;/span&gt;&lt;/h4&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在设置 &lt;code&gt;beginPath()&lt;/code&gt; 的同时，也各自设置样式。这样就能做到相互不影响了。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.0063291139240507&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtuzzt2qnuPmpibicFr2mGxa5VjPOQqlllfwsZTMc94wLFqKB7JSDuZftA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;316&quot;/&gt;&lt;figcaption&gt;14.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;10&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  cxt.beginPath() &lt;span&gt;// 重新开启一个路径&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;20&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120.5&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;4&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;折线&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;和 &lt;strong&gt;直线&lt;/strong&gt; 差不多，都是使用 &lt;code&gt;moveTo()&lt;/code&gt; 、&lt;code&gt;lineTo()&lt;/code&gt; 和 &lt;code&gt;stroke()&lt;/code&gt; 方法可以绘制折线。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtE0hMB5Wn2KbCFjRlQkfRNnCE4BwObf7CB0huct3EMRppo8uJfcU94g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;15.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;100&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;画这种折线，最好在草稿纸上画一个坐标系，自己计算并描绘一下每个点大概在什么什么位置，最后在 &lt;code&gt;canvas&lt;/code&gt; 中看看效果。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;矩形&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;根据前面的基础，我们可以 &lt;strong&gt;使用线段来描绘矩形&lt;/strong&gt;，但 &lt;code&gt;canvas&lt;/code&gt; 也提供了 &lt;code&gt;rect()&lt;/code&gt; 等方法可以直接生成矩形。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;使用线段描绘矩形&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以使用前面画线段的方法来绘制矩形&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;1.0031446540880504&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt2eo3ov4ZgCfOZ7TUOdfGNkUKWqdPlLvMpdJibbx04VoY02PAjA0ciciaQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;16.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;canvas id=&quot;c&quot; width=&quot;300&quot; height=&quot;300&quot; style=&quot;border: 1px solid #ccc;&quot;&amp;gt;&lt;span&gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt; &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt; &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt; &lt;span&gt;// 绘制矩形&lt;/span&gt;&lt;br/&gt; cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt; cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt; cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;120&lt;/span&gt;)&lt;br/&gt; cxt.lineTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;120&lt;/span&gt;)&lt;br/&gt; cxt.lineTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;) &lt;span&gt;// 需要闭合，又或者使用 closePath() 方法进行闭合，推荐使用 closePath()&lt;/span&gt;&lt;br/&gt;&lt;br/&gt; cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的代码几个点分别对应下图。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6402664692820134&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtOGicFX9wwib8L6D5IjB0f8ltExmHtgCkt6TY7kbK8Dgtd93VSuCSticZQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1351&quot;/&gt;&lt;figcaption&gt;17.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;使用 &lt;code&gt;strokeRect()&lt;/code&gt; 描边矩形&lt;/span&gt;&lt;/h3&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;strokeStyle&lt;/code&gt;：设置描边的属性（颜色、渐变、图案）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;strokeRect(x, y, width, height)&lt;/code&gt;：描边矩形（x和y是矩形左上角起点；width 和 height 是矩形的宽高）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;strokeStyle&lt;/code&gt; 必须写在 &lt;code&gt;strokeRect()&lt;/code&gt; 前面，不然样式不生效。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9937304075235109&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtMvJZhbUczNEsWc6Bzxiaa3UAppJbOSWokXlhsZlZndyP1BaHkdAnqicQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;18.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// strokeStyle 属性&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;// strokeRect(x, y, width, height) 方法&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.strokeRect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的代码可以这样理解&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.6402664692820134&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtW0ADkCichibQ3jOJXvDOlGCrQm3HRIad18ZiahKYGlxoyNPqLLjxyBYdA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1351&quot;/&gt;&lt;figcaption&gt;19.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;使用 &lt;code&gt;fillRect()&lt;/code&gt; 填充矩形&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;fillRect()&lt;/code&gt; 和 &lt;code&gt;strokeRect()&lt;/code&gt; 方法差不多，但 &lt;code&gt;fillRect()&lt;/code&gt; 的作用是填充。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;需要注意的是，&lt;code&gt;fillStyle&lt;/code&gt; 必须写在 &lt;code&gt;fillRect()&lt;/code&gt; 之前，不然样式不生效。&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt7iaiaqDLK3aSm0WRcOibcJedd388QNYTUGZp09kg9QryibjwoWRZ6ibxdSQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;20.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// fillStyle 属性&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;// fillRect(x, y, width, height) 方法&lt;/span&gt;&lt;br/&gt;  cxt.fillStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillRect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// fillRect(x, y, width, height)&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;同时使用 &lt;code&gt;strokeRect()&lt;/code&gt; 和 &lt;code&gt;fillRect()&lt;/code&gt;&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;同时使用 &lt;code&gt;strokeRect()&lt;/code&gt; 和 &lt;code&gt;fillRect()&lt;/code&gt; 会产生描边和填充的效果&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.003154574132492&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtBN4nXC2JaVNUicHnOVJe3RgELFleib823DAVDsicKjETGgmtXHywrQPKA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;317&quot;/&gt;&lt;figcaption&gt;21.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.strokeRect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// strokeRect(x, y, width, height)&lt;/span&gt;&lt;br/&gt;  cxt.fillStyle = &lt;span&gt;&#x27;yellow&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillRect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// fillRect(x, y, width, height)&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;使用 &lt;code&gt;rect()&lt;/code&gt; 生成矩形&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;rect()&lt;/code&gt; 和 &lt;code&gt;fillRect() 、strokeRect()&lt;/code&gt; 的用法差不多，唯一的区别是：&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;code&gt;strokeRect()&lt;/code&gt; 和 &lt;code&gt;fillRect()&lt;/code&gt; 这两个方法调用后会立即绘制；&lt;code&gt;rect()&lt;/code&gt; 方法被调用后，不会立刻绘制矩形，而是需要调用 &lt;code&gt;stroke()&lt;/code&gt; 或 &lt;code&gt;fill()&lt;/code&gt; 辅助渲染。&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9937694704049844&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt5Vb9C6lz4ncg337ib4JGj74ZN05vOwDf1Dkck565s5SA87tdd6UMecA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;22.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.rect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;) &lt;span&gt;// rect(x, y, width, height)&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;  cxt.fill()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;等价公式：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;,&lt;br/&gt;cxt.rect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;cxt.stroke()&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// 等价于&lt;/span&gt;&lt;br/&gt;cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;cxt.strokerect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// -----------------------------&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;cxt.fillStyle = &lt;span&gt;&#x27;hotpink&#x27;&lt;/span&gt;&lt;br/&gt;cxt.rect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;cxt.fill()&lt;br/&gt;&lt;br/&gt;&lt;span&gt;// 等价于&lt;/span&gt;&lt;br/&gt;cxt.fillStyle = &lt;span&gt;&#x27;yellowgreen&#x27;&lt;/span&gt;&lt;br/&gt;cxt.fillRect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;使用 &lt;code&gt;clearRect()&lt;/code&gt; 清空矩形&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;clearRect()&lt;/code&gt; 方法可以清空指定区域。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;clearRect(x, y, width, height)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其语法和创建 &lt;code&gt;cxt.rect()&lt;/code&gt; 差不多。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.006269592476489&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt0dlf3rV1AA4jXrYM1NYzujnKNP63ibNZR4KGTIblW5EXn2CwbE3rdmw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;23.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.fillStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt; &lt;span&gt;// 设置填充颜色&lt;/span&gt;&lt;br/&gt;  cxt.fillRect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;) &lt;span&gt;// 填充矩形&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.clearRect(&lt;span&gt;60&lt;/span&gt;, &lt;span&gt;60&lt;/span&gt;, &lt;span&gt;180&lt;/span&gt;, &lt;span&gt;90&lt;/span&gt;) &lt;span&gt;// 清空矩形&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;清空画布&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;canvas&lt;/code&gt; 画布元素是矩形，所以可以通过下面的代码把整个画布清空掉。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;// 省略部分代码&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;cxt.clearRect(&lt;span&gt;0&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;, cnv.width, cnv.height)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要清空的区域：从画布左上角开始，直到画布的宽和画布的高为止。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;多边形&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Canvas&lt;/code&gt; 要画多边形，需要使用 &lt;code&gt;moveTo()&lt;/code&gt; 、 &lt;code&gt;lineTo()&lt;/code&gt; 和 &lt;code&gt;closePath()&lt;/code&gt; 。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;三角形&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;虽然三角形是常见图形，但 &lt;code&gt;canvas&lt;/code&gt; 并没有提供类似 &lt;code&gt;rect()&lt;/code&gt; 的方法来绘制三角形。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;需要确定三角形3个点的坐标位置，然后使用 &lt;code&gt;stroke()&lt;/code&gt; 或者 &lt;code&gt;fill()&lt;/code&gt; 方法生成三角形。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtNc6ibmMr0yIEF3ribt9ocVCibxafsmAr7pPy0bZaEeiaVhzHgMRnFyR2Og/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;24.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 注意点：如果使用 lineTo 闭合图形，是不能很好闭合拐角位的。&lt;/span&gt;&lt;br/&gt;  cxt.lineTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;) &lt;span&gt;// 闭合&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;注意，默认情况下不会自动从最后一个点连接到起点。最后一步需要设置一下 &lt;code&gt;cxt.lineTo(50, 50)&lt;/code&gt; ，让它与 &lt;code&gt;cxt.moveTo(50, 50)&lt;/code&gt; 一样。这样可以让路径回到起点，形成一个闭合效果。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;但这样做其实是有点问题的，而且也比较麻烦，要记住起始点坐标。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的闭合操作，如果遇到设置了 &lt;code&gt;lineWidth&lt;/code&gt; 或者 &lt;code&gt;lineJoin&lt;/code&gt; 就会有问题，比如：&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.00625&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtuyMFNn6eeBFia3oLW8vr2caw6mlIEN0yKeydVT3Wz4nkSvxfAed0jTg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;320&quot;/&gt;&lt;figcaption&gt;25.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;// 省略部分代码&lt;/span&gt;&lt;br/&gt;cxt.lineWidth = &lt;span&gt;20&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当线段变粗后，起始点和结束点的链接处，拐角就出现“不正常”现象。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果需要真正闭合，可以使用 &lt;code&gt;closePath()&lt;/code&gt; 方法。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9755351681957186&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAttzqVg4QqAEVfZC2wFaOJj8iaVYqK7ibcWu4ia6oCvOm5dXg7VqjcGXH3Q/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;327&quot;/&gt;&lt;figcaption&gt;26.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;// 手动闭合&lt;/span&gt;&lt;br/&gt;  cxt.closePath()&lt;br/&gt;&lt;br/&gt;  cxt.lineJoin = &lt;span&gt;&#x27;miter&#x27;&lt;/span&gt; &lt;span&gt;// 线条连接的样式。miter: 默认; bevel: 斜面; round: 圆角&lt;/span&gt;&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;20&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;cxt.closePath()&lt;/code&gt; 可以自动将终点和起始点连接起来，此时看上去就正常多了。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;菱形&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;有一组邻边相等的平行四边形是菱形&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.9968553459119497&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt7dXY13BuOrp5Pic9b6LEzVMMBUqtYhDP2s98Rb4fNVDMwRrv47Oht6w/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;318&quot;/&gt;&lt;figcaption&gt;27.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;150&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;150&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.closePath()&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;要绘制直线类型的图形，在草稿纸上标记出起始点和每个拐角的点，然后再连线即可。相对曲线图形来说，直线图形是比较容易的。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;圆形&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;绘制圆形的方法是 &lt;code&gt;arc()&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;arc(x, y, r, sAngle, eAngle，counterclockwise)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;x&lt;/code&gt; 和 &lt;code&gt;y&lt;/code&gt;: 圆心坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;r&lt;/code&gt;: 半径&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;sAngle&lt;/code&gt;: 开始角度&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;eAngle&lt;/code&gt;: 结束角度&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;counterclockwise&lt;/code&gt;: 绘制方向（true: 逆时针; false: 顺时针），默认 false&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.0417052826691382&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtTEKricz6ec6HqfqMXhdiboB0cvQhLKSBahWicuhMAWJrIOnpGdpSibnibjA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1079&quot;/&gt;&lt;figcaption&gt;28.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;开始角度和结束角度，都是以&lt;strong&gt;弧度&lt;/strong&gt;为单位。例如 180°就写成 &lt;code&gt;Math.PI&lt;/code&gt; ，360°写成 &lt;code&gt;Math.PI * 2&lt;/code&gt; ，以此类推。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在实际开发中，为了让自己或者别的开发者更容易看懂&lt;strong&gt;弧度的数值&lt;/strong&gt;，1°应该写成 &lt;code&gt;Math.PI / 180&lt;/code&gt;。&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;100°: &lt;code&gt;100 * Math.PI / 180&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;110°: &lt;code&gt;110 * Math.PI / 180&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;241°: &lt;code&gt;241 * Math.PI / 180&lt;/code&gt;&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;注意：绘制圆形之前，必须先调用 &lt;code&gt;beginPath()&lt;/code&gt; 方法！！！在绘制完成之后，还需要调用 &lt;code&gt;closePath()&lt;/code&gt; 方法！！！&lt;/strong&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtY3lY922XktpuSKJo1bicYB9PJDwb53EO7I2cCiaAQtcYHnNJ1efFNIhA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;320&quot;/&gt;&lt;figcaption&gt;29.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.arc(&lt;span&gt;150&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;, &lt;span&gt;80&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;, &lt;span&gt;360&lt;/span&gt; * &lt;span&gt;Math&lt;/span&gt;.PI / &lt;span&gt;180&lt;/span&gt;)&lt;br/&gt;  cxt.closePath()&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;半圆&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果使用 &lt;code&gt;arc()&lt;/code&gt; 方法画圆时，没做到刚好绕完一周（360°）就直接闭合路径，就会出现半圆的状态。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.006269592476489&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtAlxibzAwEfZESzhUa8KFNILPtibA4Wjer2iaxIDyyxI0pLrYpEgLoU6ibw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;30.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.arc(&lt;span&gt;150&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;, &lt;span&gt;180&lt;/span&gt; * &lt;span&gt;Math&lt;/span&gt;.PI / &lt;span&gt;180&lt;/span&gt;) &lt;span&gt;// 顺时针&lt;/span&gt;&lt;br/&gt;  cxt.closePath()&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;上面的代码中，&lt;code&gt;cxt.arc&lt;/code&gt; 最后一个参数没传，默认是 &lt;code&gt;false&lt;/code&gt; ，所以是顺时针绘制。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9880952380952381&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtLBzAyoRDGoXVzkntfNIqPy3RiatbmkSdiaTJL5PmNQZPXSXQbxFqHzMw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1092&quot;/&gt;&lt;figcaption&gt;31.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果希望半圆的弧面在上方，可以将 &lt;code&gt;cxt.arc&lt;/code&gt; 最后一个参数设置成 &lt;code&gt;true&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtOd74O4fr2wCUdZRPufA9mLny1Jc3GUdteooxDZHPHpbUEMjugdBiawA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;323&quot;/&gt;&lt;figcaption&gt;32.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.arc(&lt;span&gt;150&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;, &lt;span&gt;180&lt;/span&gt; * &lt;span&gt;Math&lt;/span&gt;.PI / &lt;span&gt;180&lt;/span&gt;, &lt;span&gt;true&lt;/span&gt;)&lt;br/&gt;  cxt.closePath()&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;弧线&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;arc()&lt;/code&gt; 方法画半圆时，如果最后不调用 &lt;code&gt;closePath()&lt;/code&gt; 方法，就不会出现闭合路径。也就是说，那是一条弧线。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在 &lt;code&gt;canvas&lt;/code&gt; 中，画弧线有2中方法：&lt;code&gt;arc()&lt;/code&gt; 和 &lt;code&gt;arcTo()&lt;/code&gt; 。&lt;/p&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;arc() 画弧线&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果想画一条 &lt;code&gt;0° ~ 30°&lt;/code&gt; 的弧线，可以这样写&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9937888198757764&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt8lH5P4yluwtpDg9MAubRDu2Jic8E5kc8r6oBTDibq6MOzbq8OfJl6STg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;322&quot;/&gt;&lt;figcaption&gt;33.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.arc(&lt;span&gt;150&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt; * &lt;span&gt;Math&lt;/span&gt;.PI / &lt;span&gt;180&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;原理如下图所示，红线代表画出来的那条弧线。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9880952380952381&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtiavQpiaM57H6jYeFocy3AKfAuKWVEFlgqIltbhia9T1lE5ic6YMiczKwQqg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1092&quot;/&gt;&lt;figcaption&gt;34.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;arcTo() 画弧线&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;arcTo()&lt;/code&gt; 的使用方法会更加复杂，如果初学看不太懂的话可以先跳过，看完后面的再回来补补。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;arcTo(cx, cy, x2, y2, radius)&lt;br/&gt;复制代码&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;cx&lt;/code&gt;: 两切线交点的横坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;cy&lt;/code&gt;: 两切线交点的纵坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;x2&lt;/code&gt;: 结束点的横坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;y2&lt;/code&gt;: 结束点的纵坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;radius&lt;/code&gt;: 半径&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;其中，&lt;code&gt;(cx, cy)&lt;/code&gt; 也叫控制点，&lt;code&gt;(x2, y2)&lt;/code&gt; 也叫结束点。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;是不是有点奇怪，为什么没有 &lt;code&gt;x1&lt;/code&gt; 和 &lt;code&gt;y1&lt;/code&gt; ？&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;(x1, y1)&lt;/code&gt; 是开始点，通常是由 &lt;code&gt;moveTo()&lt;/code&gt; 或者 &lt;code&gt;lineTo()&lt;/code&gt; 提供。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;arcTo()&lt;/code&gt; 方法利用 &lt;strong&gt;开始点、控制点和结束点形成的夹角，绘制一段与夹角的两边相切并且半径为 &lt;code&gt;radius&lt;/code&gt; 的圆弧&lt;/strong&gt;。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9490333919156415&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtfuc2VX9YyTaPUTVR8pSpnAz3zFvRUlhC2wMGsbS7mNU8lXEJPGZv2g/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1138&quot;/&gt;&lt;figcaption&gt;35.jpg&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;举个例子&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9907120743034056&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtg7icY6ebcXASsPcj9m11gqlwU4Lgb2iayb8GDFAxZwvRhlu6VdCmJ62w/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;323&quot;/&gt;&lt;figcaption&gt;36.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;40&lt;/span&gt;, &lt;span&gt;40&lt;/span&gt;)&lt;br/&gt;  cxt.arcTo(&lt;span&gt;120&lt;/span&gt;, &lt;span&gt;40&lt;/span&gt;, &lt;span&gt;120&lt;/span&gt;, &lt;span&gt;120&lt;/span&gt;, &lt;span&gt;80&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;基础样式&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前面学完基础图形，接下来可以开始了解一下如何设置元素的基础样式。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;描边 stroke()&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前面的案例中，其实已经知道使用 &lt;code&gt;stroke()&lt;/code&gt; 方法进行描边了。这里就不再多讲这个方法。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;线条宽度 lineWidth&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;lineWidth&lt;/code&gt; 默认值是 &lt;code&gt;1&lt;/code&gt; ，默认单位是 &lt;code&gt;px&lt;/code&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;lineWidth = 线宽&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9815950920245399&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtBicLAciadCm9Cia5qVx6BxicukyHqglQiaxNkRibl0wHxKVe7MRibm6ibPlGww/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;326&quot;/&gt;&lt;figcaption&gt;37.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 线宽 10&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;10&lt;/span&gt; &lt;span&gt;// 设置线宽&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 线宽 20&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;20&lt;/span&gt; &lt;span&gt;// 设置线宽&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 线宽 30&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;250&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;250&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;30&lt;/span&gt; &lt;span&gt;// 设置线宽&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;线条颜色 strokeStyle&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;strokeStyle&lt;/code&gt; 可以设置线条颜色&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法:&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;strokeStyle = 颜色值&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9937694704049844&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtkAQF4rghwWc1Qly9cXZobETmD6FHbqvmulksYo2h3w3uZjibHSNMWPQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;38.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;20&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt; &lt;span&gt;// 设置颜色&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了展示方便，我将 &lt;code&gt;lineWidth&lt;/code&gt; 设为 20。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;线帽 lineCap&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;线帽指的是线段的开始和结尾处的样式，使用 &lt;code&gt;lineCap&lt;/code&gt; 可以设置&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;lineCap = &lt;span&gt;&#x27;属性值&#x27;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;属性值包括：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;butt&lt;/code&gt;: 默认值，无线帽&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;square&lt;/code&gt;: 方形线帽&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;round&lt;/code&gt;: 圆形线帽&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.003125&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtMAfrticHx2Tsu1wRnU6K4icjKu06KJhYbTgXP8fCNtdPCzWspOwZjfgQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;320&quot;/&gt;&lt;figcaption&gt;39.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 设置线宽，方便演示&lt;/span&gt;&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;16&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认线帽 butt&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;60&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;60&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 方形线帽 square&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.lineCap = &lt;span&gt;&#x27;square&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 圆形线帽 round&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.lineCap = &lt;span&gt;&#x27;round&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;250&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;250&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;square&lt;/code&gt; 和 &lt;code&gt;round&lt;/code&gt; 的话，会使线条变得稍微长一点点，这是给线条增加线帽的部分，这个长度在日常开发中需要注意。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;线帽只对线条的开始和结尾处产生作用，对拐角不会产生任何作用。&lt;/strong&gt;&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;拐角样式 lineJoin&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果需要设置拐角样式，可以使用 &lt;code&gt;lineJoin&lt;/code&gt; 。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;lineJoin = &lt;span&gt;&#x27;属性值&#x27;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;属性值包括：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;miter&lt;/code&gt;: 默认值，尖角&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;round&lt;/code&gt;: 圆角&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;bevel&lt;/code&gt;: 斜角&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9906542056074766&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtiavqfEpz3GkI3labMKxLn1uJrrsbKyt6xfENWzzuwpKcqeoVVgsRiagw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;40.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;br/&gt;  cxt.lineWidth = &lt;span&gt;20&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认，尖角&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;40&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;40&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;90&lt;/span&gt;)&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 斜角 bevel&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;140&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;140&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;190&lt;/span&gt;)&lt;br/&gt;  cxt.lineJoin = &lt;span&gt;&#x27;bevel&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 圆角 round&lt;/span&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;240&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;240&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;290&lt;/span&gt;)&lt;br/&gt;  cxt.lineJoin = &lt;span&gt;&#x27;round&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;虚线 setLineDash()&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;setLineDash()&lt;/code&gt; 方法可以将描边设置成虚线。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;setLineDash([])&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;需要传入一个数组，且元素是数值型。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;虚线分3种情况&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;只传1个值&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;有2个值&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;有3个以上的值&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt80DpiclO7NxfGmazt3jd6jKd1H8iao4wTLC0G0wc4dGZickqkZOVSjgMw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;41.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.lineWidth = &lt;span&gt;20&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.setLineDash([&lt;span&gt;10&lt;/span&gt;]) &lt;span&gt;// 只传1个参数，实线与空白都是 10px&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.setLineDash([&lt;span&gt;10&lt;/span&gt;, &lt;span&gt;20&lt;/span&gt;]) &lt;span&gt;// 2个参数，此时，实线是 10px, 空白 20px&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;  cxt.beginPath()&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.setLineDash([&lt;span&gt;10&lt;/span&gt;, &lt;span&gt;20&lt;/span&gt;, &lt;span&gt;5&lt;/span&gt;]) &lt;span&gt;// 传3个以上的参数，此例：10px实线，20px空白，5px实线，10px空白，20px实线，5px空白 ……&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;此外，还可以始终 &lt;code&gt;cxt.getLineDash()&lt;/code&gt; 获取虚线不重复的距离；&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用 &lt;code&gt;cxt.lineDashOffset&lt;/code&gt; 设置虚线的偏移位。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;填充&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;fill()&lt;/code&gt; 可以填充图形，根据前面的例子应该掌握了如何使用 &lt;code&gt;fill()&lt;/code&gt;&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.009375&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtB0iav4SCExRWlwGxDbfH9HdENLMv6n2dnIXqkSew9R1WicThQWRLXaMA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;320&quot;/&gt;&lt;figcaption&gt;42.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.fillStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  cxt.rect(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.fill()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;可以使用 &lt;code&gt;fillStyle&lt;/code&gt; 设置填充颜色，默认是黑色。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;非零环绕填充&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在使用 &lt;code&gt;fill()&lt;/code&gt; 方法填充时，需要注意一个规则：&lt;strong&gt;非零环绕填充&lt;/strong&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在使用 &lt;code&gt;moveTo&lt;/code&gt; 和 &lt;code&gt;lineTo&lt;/code&gt; 描述图形时，如果是按顺时针绘制，计数器会加1；如果是逆时针，计数器会减1。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;当图形所处的位置，计数器的结果为0时，它就不会被填充。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;这样说有点复杂，先看看例子&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtw0RfOnic51CdPVuJqaRGxJicNl2PEKgthaCILT1icejKQzeL0qKlZntOQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;322&quot;/&gt;&lt;figcaption&gt;43.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 外层矩形&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;50&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;250&lt;/span&gt;, &lt;span&gt;250&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;50&lt;/span&gt;, &lt;span&gt;250&lt;/span&gt;)&lt;br/&gt;  cxt.closePath()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 内层矩形&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;100&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;100&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;  cxt.closePath()&lt;br/&gt;  cxt.fill()&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;请看看上面的代码，我画了2个矩形，它们都没有用 &lt;code&gt;beginPath()&lt;/code&gt; 方法开辟新路径。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.7575250836120402&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtu4s65vmHfGRSh4peQ1PGLR2LaN9Yzufw561ku0qAYHgEnjRrdWV04A/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;1196&quot;/&gt;&lt;figcaption&gt;44.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;内层矩形是逆时针绘制的，所以内层的值是 &lt;code&gt;-1&lt;/code&gt; ，它又经过外层矩形，而外层矩形是顺时针绘制，所以经过外层时值 &lt;code&gt;+1&lt;/code&gt;，最终内层的值为 &lt;code&gt;0&lt;/code&gt; ，所以不会被填充。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;文本&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;Canvas&lt;/code&gt; 提供了一些操作文本的方法。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;为了方便演示，我们先了解一下在 &lt;code&gt;Canvas&lt;/code&gt; 中如何给本文设置样式。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;样式 font&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;和 &lt;code&gt;CSS&lt;/code&gt; 设置 &lt;code&gt;font&lt;/code&gt; 差不多，&lt;code&gt;Canvas&lt;/code&gt; 也可以通过 &lt;code&gt;font&lt;/code&gt; 设置样式。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cxt.font = &lt;span&gt;&#x27;font-style font-variant font-weight font-size/line-height font-family&#x27;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果需要设置字号 &lt;code&gt;font-size&lt;/code&gt;，需要同事设置 &lt;code&gt;font-family&lt;/code&gt;。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;cxt.font = &lt;span&gt;&#x27;30px 宋体&#x27;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;描边 strokeText()&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;strokeText()&lt;/code&gt; 方法进行文本描边&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;strokeText(text, x, y, maxWidth)&lt;br/&gt;复制代码&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;text&lt;/code&gt;: 字符串，要绘制的内容&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;x&lt;/code&gt;: 横坐标，文本&lt;strong&gt;左边&lt;/strong&gt;要对齐的坐标（默认左对齐）&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;y&lt;/code&gt;: 纵坐标，文本&lt;strong&gt;底边&lt;/strong&gt;要对齐的坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;maxWidth&lt;/code&gt;: 可选参数，表示文本渲染的最大宽度（px），如果文本超出 &lt;code&gt;maxWidth&lt;/code&gt; 设置的值，文本会被压缩。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9968847352024922&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAttRa8mgJFIicUa4Bq8WkrRKu9icRWFGYqUicP1MUw9RE8dLWmRfOmcPESw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;45.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;60px Arial&#x27;&lt;/span&gt; &lt;span&gt;// 将字号设置成 60px，方便观察&lt;/span&gt;&lt;br/&gt;  cxt.strokeText(&lt;span&gt;&#x27;雷猴&#x27;&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;90&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;设置描边颜色 strokeStyle&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;strokeStyle&lt;/code&gt; 设置描边颜色。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtiaqw0rlmkRxkia5wyFKkAzib649qMBdYYqeW23FUPF6EhFhgYc0IMtADw/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;319&quot;/&gt;&lt;figcaption&gt;46.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;60px Arial&#x27;&lt;/span&gt; &lt;span&gt;// 将字号设置成 60px，方便观察&lt;/span&gt;&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt; &lt;span&gt;// 设置文本描边颜色&lt;/span&gt;&lt;br/&gt;  cxt.strokeText(&lt;span&gt;&#x27;雷猴&#x27;&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;90&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;填充 fillText&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;fillText()&lt;/code&gt; 可填充文本。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;语法和 &lt;code&gt;strokeText()&lt;/code&gt; 一样。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;fillText(text, x, y, maxWidth)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9906542056074766&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtvUxd69xA1Jg5nNs63dkdXWXOtV6k4FOMtPa46L7DCGVH6LJW4xO5gA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;321&quot;/&gt;&lt;figcaption&gt;47.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;60px Arial&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴&#x27;&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;90&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;设置填充颜色 fillStyle&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;fillStyle&lt;/code&gt; 可以设置文本填充颜色。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtFrtpLqxic9Rp8Q2Lm2QFysTibiccD1UoehEbj7j4nrutibyV1F1GLT5vpg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;320&quot;/&gt;&lt;figcaption&gt;48.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;60px Arial&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillStyle = &lt;span&gt;&#x27;pink&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴&#x27;&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;90&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;获取文本长度 measureText()&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;measureText().width&lt;/code&gt; 方法可以获取文本的长度，单位是 &lt;code&gt;px&lt;/code&gt; 。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;let&lt;/span&gt; text = &lt;span&gt;&#x27;雷猴&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;bold 40px Arial&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(text, &lt;span&gt;40&lt;/span&gt;, &lt;span&gt;80&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;console&lt;/span&gt;.log(cxt.measureText(text).width) &lt;span&gt;// 80&lt;/span&gt;&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;水平对齐方式 textAlign&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;textAlign&lt;/code&gt; 属性可以设置文字的水平对齐方式，一共有5个值可选&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;start&lt;/code&gt;: 默认。在指定位置的横坐标开始。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;end&lt;/code&gt;: 在指定坐标的横坐标结束。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;left&lt;/code&gt;: 左对齐。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;right&lt;/code&gt;: 右对齐。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;center&lt;/code&gt;: 居中对齐。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.004750593824228&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt0VbNA4twbuRIvDWicjC8Qov5Uz8xDAsKRkl6rhAibpTBjd8gemmj8GPQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;421&quot;/&gt;&lt;figcaption&gt;49.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;红线是辅助参考线。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;400&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;400&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 竖向的辅助线（参考线，在画布中间）&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;200&lt;/span&gt;, &lt;span&gt;400&lt;/span&gt;)&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;30px Arial&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 横坐标开始位对齐&lt;/span&gt;&lt;br/&gt;  cxt.textAlign = &lt;span&gt;&#x27;start&#x27;&lt;/span&gt; &lt;span&gt;// 默认值,&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 start&#x27;&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;40&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 横坐标结束位对齐&lt;/span&gt;&lt;br/&gt;  cxt.textAlign = &lt;span&gt;&#x27;end&#x27;&lt;/span&gt; &lt;span&gt;// 结束对齐&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 end&#x27;&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 左对齐&lt;/span&gt;&lt;br/&gt;  cxt.textAlign = &lt;span&gt;&#x27;left&#x27;&lt;/span&gt; &lt;span&gt;// 左对齐&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 left&#x27;&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;160&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 右对齐&lt;/span&gt;&lt;br/&gt;  cxt.textAlign = &lt;span&gt;&#x27;right&#x27;&lt;/span&gt; &lt;span&gt;// 右对齐&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 right&#x27;&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;220&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 居中对齐&lt;/span&gt;&lt;br/&gt;  cxt.textAlign = &lt;span&gt;&#x27;center&#x27;&lt;/span&gt; &lt;span&gt;// 右对齐&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 center&#x27;&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;280&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;从上面的例子看，&lt;code&gt;start&lt;/code&gt; 和 &lt;code&gt;left&lt;/code&gt; 的效果好像是一样的，&lt;code&gt;end&lt;/code&gt; 和 &lt;code&gt;right&lt;/code&gt; 也好像是一样的。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在大多数情况下，它们的确一样。但在某些国家或者某些场合，阅读文字的习惯是 &lt;strong&gt;从右往左&lt;/strong&gt; 时，&lt;code&gt;start&lt;/code&gt; 就和 &lt;code&gt;right&lt;/code&gt; 一样了，&lt;code&gt;end&lt;/code&gt; 和 &lt;code&gt;left&lt;/code&gt; 也一样。这是需要注意的地方。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;垂直对齐方式 textBaseline&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;使用 &lt;code&gt;textBaseline&lt;/code&gt; 属性可以设置文字的垂直对齐方式。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在使用 &lt;code&gt;textBaseline&lt;/code&gt; 前，需要自行了解 &lt;code&gt;css&lt;/code&gt; 的文本基线。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img data-ratio=&quot;0.20638820638820637&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtWrialtpUSqM0P3icg3norF68KwacE95wiaCzjZzsybtV51EqSibia8fUrww/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;407&quot;/&gt;&lt;figcaption&gt;50.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;用一张网图解释一下基线&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;&lt;code&gt;textBaseline&lt;/code&gt; 可选属性：&lt;/strong&gt;&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;alphabetic&lt;/code&gt;: 默认。文本基线是普通的字母基线。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;top&lt;/code&gt;: 文本基线是 &lt;code&gt;em&lt;/code&gt; 方框的顶端。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;bottom&lt;/code&gt;: 文本基线是 &lt;code&gt;em&lt;/code&gt; 方框的底端。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;middle&lt;/code&gt;: 文本基线是 &lt;code&gt;em&lt;/code&gt; 方框的正中。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;hanging&lt;/code&gt;: 文本基线是悬挂基线。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.39416058394160586&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtJo5EuicgFIqm1yuWfm6qT1kFQv1k8ngruibxY1GG1hjvY8ThVJKz50ZA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;822&quot;/&gt;&lt;figcaption&gt;51.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;红线是辅助参考线。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;800&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;300&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 横向的辅助线（参考线，在画布中间）&lt;/span&gt;&lt;br/&gt;  cxt.moveTo(&lt;span&gt;0&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.lineTo(&lt;span&gt;800&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;  cxt.strokeStyle = &lt;span&gt;&#x27;red&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.stroke()&lt;br/&gt;&lt;br/&gt;  cxt.font = &lt;span&gt;&#x27;20px Arial&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认 alphabetic&lt;/span&gt;&lt;br/&gt;  cxt.textBaseline = &lt;span&gt;&#x27;alphabetic&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 alphabetic&#x27;&lt;/span&gt;, &lt;span&gt;10&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认 top&lt;/span&gt;&lt;br/&gt;  cxt.textBaseline = &lt;span&gt;&#x27;top&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 top&#x27;&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认 bottom&lt;/span&gt;&lt;br/&gt;  cxt.textBaseline = &lt;span&gt;&#x27;bottom&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 bottom&#x27;&lt;/span&gt;, &lt;span&gt;320&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认 middle&lt;/span&gt;&lt;br/&gt;  cxt.textBaseline = &lt;span&gt;&#x27;middle&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 middle&#x27;&lt;/span&gt;, &lt;span&gt;480&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 默认 hanging&lt;/span&gt;&lt;br/&gt;  cxt.textBaseline = &lt;span&gt;&#x27;hanging&#x27;&lt;/span&gt;&lt;br/&gt;  cxt.fillText(&lt;span&gt;&#x27;雷猴 hanging&#x27;&lt;/span&gt;, &lt;span&gt;640&lt;/span&gt;, &lt;span&gt;150&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;注意：在绘制文字的时候，默认是以文字的左下角作为参考点进行绘制&lt;/strong&gt;&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;图片&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在 &lt;code&gt;Canvas&lt;/code&gt; 中可以使用 &lt;code&gt;drawImage()&lt;/code&gt; 方法绘制图片。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;渲染图片&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;渲染图片的方式有2中，一种是&lt;strong&gt;在JS里加载图片再渲染&lt;/strong&gt;，另一种是&lt;strong&gt;把DOM里的图片拿到 &lt;code&gt;canvas&lt;/code&gt; 里渲染&lt;/strong&gt;。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;渲染的语法：&lt;/strong&gt;&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;drawImage(image, dx, dy)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;image&lt;/code&gt;: 要渲染的图片对象。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;dx&lt;/code&gt;: 图片左上角的横坐标位置。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;dy&lt;/code&gt;: 图片左上角的纵坐标位置。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;JS版&lt;/span&gt;&lt;/h3&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;在 &lt;code&gt;JS&lt;/code&gt; 里加载图片并渲染，有以下几个步骤：&lt;/p&gt;&lt;ol data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;创建 &lt;code&gt;Image&lt;/code&gt; 对象&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;引入图片&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;等待图片加载完成&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;使用 &lt;code&gt;drawImage()&lt;/code&gt; 方法渲染图片&lt;/section&gt;&lt;/li&gt;&lt;/ol&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9980879541108987&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtWBuwBQwc3MHrnbJuncpbeic5z4nic8InEia9HX8nxWnRe0WQSHed8Qiang/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;523&quot;/&gt;&lt;figcaption&gt;52.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 1 创建 Image 对象&lt;/span&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; image = &lt;span&gt;new&lt;/span&gt; Image()&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 2 引入图片&lt;/span&gt;&lt;br/&gt;  image.src = &lt;span&gt;&#x27;./images/dog.jpg&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;// 3 等待图片加载完成&lt;/span&gt;&lt;br/&gt;  image.onload = &lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;// 4 使用 drawImage() 方法渲染图片&lt;/span&gt;&lt;br/&gt;    cxt.drawImage(image, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;)&lt;br/&gt;  }&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h3 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;DOM版&lt;/span&gt;&lt;/h3&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9980769230769231&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt5uOMYEnibdcl3A6153H3NYhkwms5JPmvk5nebpWCYhgBuzILyNw5Vrg/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;520&quot;/&gt;&lt;figcaption&gt;53.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;style&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;#dogImg&lt;/span&gt; {&lt;br/&gt;    &lt;span&gt;display&lt;/span&gt;: none;&lt;br/&gt;  }&lt;br/&gt;&amp;lt;/&lt;span&gt;style&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;img&lt;/span&gt; &lt;span&gt;src&lt;/span&gt;=&lt;span&gt;&quot;./images/dog.jpg&quot;&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;dogImg&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; image = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;dogImg&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  cxt.drawImage(image, &lt;span&gt;70&lt;/span&gt;, &lt;span&gt;70&lt;/span&gt;)&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;因为图片是从 &lt;code&gt;DOM&lt;/code&gt; 里获取到的，所以一般来说，只要在 &lt;code&gt;window.onload&lt;/code&gt; 这个生命周期内使用 &lt;code&gt;drawImage&lt;/code&gt; 都可以正常渲染图片。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本例使用了 &lt;code&gt;css&lt;/code&gt; 的方式，把图片的 &lt;code&gt;display&lt;/code&gt; 设置成 &lt;code&gt;none&lt;/code&gt; 。因为我不想被 &lt;code&gt;&amp;lt;img&amp;gt;&lt;/code&gt; 影响到本例讲解。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;实际开发过程中按照实际情况设置即可。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;设置图片宽高&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;前面的例子都是直接加载图片，图片默认的宽高是多少就加载多少。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;如果需要指定图片宽高，可以在前面的基础上再添加两个参数：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;drawImage(image, dx, dy, dw, dh)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;image、 dx、 dy&lt;/code&gt; 的用法和前面一样。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;dw&lt;/code&gt; 用来定义图片的宽度，&lt;code&gt;dh&lt;/code&gt; 定义图片的高度。&lt;/p&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9961538461538462&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAtxIAmb44PpqYia0BCOLc3D343YVcAB1JkmCSSGf9RQD2hwfUFicvzvfIA/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;520&quot;/&gt;&lt;figcaption&gt;54.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; image = &lt;span&gt;new&lt;/span&gt; Image()&lt;br/&gt;  image.src = &lt;span&gt;&#x27;./images/dog.jpg&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  image.onload = &lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    cxt.drawImage(image, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;)&lt;br/&gt;  }&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;我把图片的尺寸设为 100px * 100px，图片看上去比之前就小了很多。&lt;/p&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;截取图片&lt;/span&gt;&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;截图图片同样使用&lt;code&gt;drawImage()&lt;/code&gt; 方法，只不过传入的参数数量比之前都多，而且顺序也有点不一样了。&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;drawImage(image, sx, sy, sw, sh, dx, dy, dw, dh)&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;以上参数缺一不可&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;image&lt;/code&gt;: 图片对象&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;sx&lt;/code&gt;: 开始截取的横坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;sy&lt;/code&gt;: 开始截取的纵坐标&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;sw&lt;/code&gt;: 截取的宽度&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;sh&lt;/code&gt;: 截取的高度&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;dx&lt;/code&gt;: 图片左上角的横坐标位置&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;dy&lt;/code&gt;: 图片左上角的纵坐标位置&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;dw&lt;/code&gt;: 图片宽度&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;dh&lt;/code&gt;: 图片高度&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;figure data-tool=&quot;mdnice编辑器&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.9961612284069098&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz/bwG40XYiaOKlxDHCn21fyEeiaE8icHzbcAt8QQ2qibicKelobnJ8soB4FwW3OtQY9RoSqfGriaHjMnhmyoVAUicGHOxAQ/640?wx_fmt=other&quot; data-type=&quot;other&quot; data-w=&quot;521&quot;/&gt;&lt;figcaption&gt;55.png&lt;/figcaption&gt;&lt;/figure&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;&lt;span&gt;canvas&lt;/span&gt; &lt;span&gt;id&lt;/span&gt;=&lt;span&gt;&quot;c&quot;&lt;/span&gt; &lt;span&gt;width&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;height&lt;/span&gt;=&lt;span&gt;&quot;500&quot;&lt;/span&gt; &lt;span&gt;style&lt;/span&gt;=&lt;span&gt;&quot;border: 1px solid #ccc;&quot;&lt;/span&gt;&amp;gt;&amp;lt;/&lt;span&gt;canvas&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;&lt;span&gt;&amp;lt;&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cnv = &lt;span&gt;document&lt;/span&gt;.getElementById(&lt;span&gt;&#x27;c&#x27;&lt;/span&gt;)&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; cxt = cnv.getContext(&lt;span&gt;&#x27;2d&#x27;&lt;/span&gt;)&lt;br/&gt;&lt;br/&gt;  &lt;span&gt;const&lt;/span&gt; image = &lt;span&gt;new&lt;/span&gt; Image()&lt;br/&gt;  image.src = &lt;span&gt;&#x27;./images/dog.jpg&#x27;&lt;/span&gt;&lt;br/&gt;&lt;br/&gt;  image.onload = &lt;span&gt;&lt;span&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {&lt;br/&gt;    cxt.drawImage(image, &lt;span&gt;0&lt;/span&gt;, &lt;span&gt;0&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;, &lt;span&gt;100&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;30&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;, &lt;span&gt;200&lt;/span&gt;)&lt;br/&gt;  }&lt;br/&gt;&amp;lt;/&lt;span&gt;script&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br/&gt;复制代码&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;总结&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本文主要讲解了在 &lt;code&gt;Canvas&lt;/code&gt; 中绘制一些基础图形，还有一些基础样式设置。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;还有更多高级的玩法会在之后的文章中讲到，比如渐变、投影、滤镜等等。&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;代码仓库&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;⭐&lt;span&gt;雷猴 Canvas&lt;/span&gt;&lt;sup&gt;[4]&lt;/sup&gt;&lt;/p&gt;&lt;h1 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;推荐阅读&lt;/span&gt;&lt;/h1&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;👍&lt;span&gt;《Fabric.js 从入门到膨胀》&lt;/span&gt;&lt;sup&gt;[5]&lt;/sup&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;👍&lt;span&gt;《『Three.js』起飞！》&lt;/span&gt;&lt;sup&gt;[6]&lt;/sup&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;👍&lt;span&gt;《console.log也能插图！！！》&lt;/span&gt;&lt;sup&gt;[7]&lt;/sup&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;👍&lt;span&gt;《纯css实现117个Loading效果》&lt;/span&gt;&lt;sup&gt;[8]&lt;/sup&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;👍&lt;span&gt;《视差特效的原理和实现方法》&lt;/span&gt;&lt;sup&gt;[9]&lt;/sup&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;👍&lt;span&gt;《这18个网站能让你的页面背景炫酷起来》&lt;/span&gt;&lt;sup&gt;[10]&lt;/sup&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;&lt;strong&gt;点赞 + 关注 + 收藏 = 学会了&lt;/strong&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span&gt;&lt;p&gt;&lt;em/&gt;&lt;/p&gt;&lt;/span&gt;&lt;span&gt;关于本文&lt;/span&gt;&lt;/section&gt;&lt;h1 data-v-233fc3fe=&quot;&quot;&gt;&lt;span&gt;作者：德育处主任&lt;/span&gt;&lt;/h1&gt;&lt;p&gt;&lt;span&gt;https://juejin.cn/post/7116784455561248775&lt;/span&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-mpa-powered-by=&quot;yiban.io&quot;&gt;&lt;p data-darkmode-color-16057140139831=&quot;rgb(162, 162, 162)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(68, 68, 68)&quot; data-style=&quot;padding-top: 7px; padding-bottom: 7px; color: rgb(68, 68, 68); font-size: 14px; line-height: 1.8; font-family: &amp;quot;Helvetica Neue&amp;quot;, Helvetica, &amp;quot;Lucida Grande&amp;quot;, Arial, &amp;quot;Hiragino Sans GB&amp;quot;, 微软雅黑, &amp;quot;WenQuanYi Micro Hei&amp;quot;, STHeiti, SimSun, sans-serif; text-align: center;&quot;&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(63, 63, 63)&quot; data-style=&quot;color: rgb(63, 63, 63); font-family: monospace; font-size: 20px; letter-spacing: 0.544px; white-space: pre-wrap; widows: 1; caret-color: rgb(51, 51, 51);&quot;&gt;The End&lt;/span&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;如果你觉得这篇内容对你挺有启发，我想请你帮我三个小忙：&lt;/span&gt;&lt;/section&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(0,0,0)&quot; data-style=&quot;padding-right: 10px; padding-left: 10px; font-size: 16px; color: black; line-height: 1.6; letter-spacing: 0px; word-break: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif;&quot;&gt;&lt;section&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;1、点个 &lt;span data-darkmode-color-16057140139831=&quot;rgb(71, 193, 168)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(71, 193, 168)&quot;&gt;「在看」&lt;/span&gt;，让更多的人也能看到这篇内容&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;2、关注官网 &lt;span data-darkmode-color-16057140139831=&quot;rgb(71, 193, 168)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(71, 193, 168)&quot;&gt;https://muyiy.cn&lt;/span&gt;，让我们成为长期关系&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;3、关注公众号「高级前端进阶」，公众号后台回复 &lt;span data-darkmode-color-16057140139831=&quot;rgb(71, 193, 168)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(71, 193, 168)&quot;&gt;「加群」&lt;/span&gt; ，加入我们一起学习并送你精心整理的高级前端面试题。&lt;/span&gt;&lt;/section&gt;&lt;section class=&quot;mp_profile_iframe_wrp&quot;&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzA4Nzg0MDM5Nw==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/sz_mmbiz_png/H8M5QJDxMHpg1ClH18gOQIicISIoSybyDNK203zFMpSM7jHdovb4elgdqNoy6Bylk7XicC6Rpj5QrCv3FkOpR6tw/0?wx_fmt=png&quot; data-nickname=&quot;高级前端进阶&quot; data-alias=&quot;FrontendGaoji&quot; data-signature=&quot;网易 &amp;amp; 蚂蚁前端，专注前端进阶领域，已帮助无数前端跳槽涨薪。每日一题「Daily-Interview-Question」 Github 收获近 25000 颗小星星，各公司面试官都在使用。接下来带你走进高级前端的世界，在进阶的路上，共勉！&quot; data-from=&quot;2&quot; has-insert-preloading=&quot;1&quot; wah-hotarea=&quot;click&quot;/&gt;&lt;/section&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;a class=&quot;weapp_text_link&quot; data-miniprogram-appid=&quot;wx27c980b913cbfb08&quot; data-miniprogram-path=&quot;pages/index/index?_um_campaign=5ec14536978eea0825f4eb6f&amp;amp;_um_channel=5ec14536978eea0825f4eb70&quot; data-miniprogram-nickname=&quot;高级前端面试&quot; data-miniprogram-type=&quot;text&quot; data-miniprogram-servicetype=&quot;0&quot; data-darkmode-bgcolor-15950741730771=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-15950741730771=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-15950741730771=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15950741730771=&quot;rgb(0,0,0)&quot; data-darkmode-color-15963792901125=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15963792901125=&quot;rgb(0,0,0)&quot; data-darkmode-bgcolor-16018219266315=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16018219266315=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16018219266315=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16018219266315=&quot;rgb(58, 58, 58)&quot; data-darkmode-bgcolor-16020008769986=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16020008769986=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16020008769986=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16020008769986=&quot;rgb(58, 58, 58)&quot; data-darkmode-color-16021670869911=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(58, 58, 58)&quot; data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-bgcolor-16030305897056=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16030305897056=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030305897056=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(58, 58, 58)&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(58, 58, 58)&quot; wah-hotarea=&quot;click&quot; href=&quot;&quot;&gt;》》面试官都在用的题库，快来看看《&lt;/a&gt;《&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;/p&gt;&lt;/section&gt;&lt;section data-darkmode-color-16030305897056=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(63, 63, 63)&quot; data-style=&quot;color: rgb(63, 63, 63); font-size: 16px; font-family: Avenir, -apple-system-font, 微软雅黑, sans-serif;&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(63, 63, 63)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-right: 10px; padding-left: 10px; line-height: 1.6; word-break: break-word; text-align: left; font-family: Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, &amp;quot;PingFang SC&amp;quot;, Cambria, Cochin, Georgia, Times, &amp;quot;Times New Roman&amp;quot;, serif; font-size: 15px; letter-spacing: 0.05em; color: rgb(89, 89, 89);&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;pre data-darkmode-bgcolor-15987645674728=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-15987645674728=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-15987645674728=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15987645674728=&quot;rgb(0, 0, 0)&quot; data-style=&quot;color: rgb(0, 0, 0); text-align: left; letter-spacing: 0.544px; word-spacing: 2px; font-size: 20px; font-weight: 700; background-color: rgb(255, 255, 255);&quot; data-original-code=&quot;&amp;lt;br&amp;gt;扩展阅读1、一篇文章上手Vue3中新增的API&amp;lt;br&amp;gt;2、Vue源码解析——异步组件是如何使用的&amp;lt;br&amp;gt;3、写好JavaScript条件语句的5条守则&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;The End如果你觉得这篇内容对你挺有启发，我想请你帮我三个小忙：点个「在看」，让更多的人也能看到这篇内容&amp;lt;br&amp;gt;关注官网 https://muyiy.cn，让我们成为长期关系&amp;lt;br&amp;gt;关注公众号「高级前端进阶」，公众号后台回复「加群」 加入我们一起学习并送你精心整理的高级前端面试题。&amp;lt;br&amp;gt;》》面试官都在用的题库，快来看看《《                        高级前端进阶 发起了一个读者讨论         写留言                                        &amp;lt;br&amp;gt;“在看”吗？在看就点一下吧&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&quot; data-snippet-id=&quot;ext.dfdc660f8db84bdd3e9d3d519ceaec46&quot; data-snippet-saved=&quot;false&quot; data-codota-status=&quot;done&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-darkmode-bgcolor-15987645674728=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-15987645674728=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-15987645674728=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-15987645674728=&quot;rgb(62, 62, 62)&quot; data-style=&quot;letter-spacing: 0px; white-space: normal; font-size: 16px; color: rgb(62, 62, 62); font-family: &#x27;Helvetica Neue&#x27;, Helvetica, &#x27;Hiragino Sans GB&#x27;, &#x27;Microsoft YaHei&#x27;, Arial, sans-serif; widows: 1; line-height: 1.6;&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-bgcolor-15987645674728=&quot;rgba(112, 0, 0, 0.018750000000000003)&quot; data-darkmode-original-bgcolor-15987645674728=&quot;rgba(20, 0, 0, 0.018750000000000003)&quot; data-darkmode-color-15987645674728=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-15987645674728=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding: 10px; word-break: break-word; line-height: 1.75; color: rgb(89, 89, 89); font-family: Optima-Regular, Optima, PingFangTC-Light, PingFangSC-light, PingFangTC-light; letter-spacing: 2px; background-image: linear-gradient(90deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%), linear-gradient(360deg, rgba(50, 0, 0, 0.05) 3%, rgba(0, 0, 0, 0) 3%); background-size: 20px 20px; background-position: center center;&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;pre data-original-code=&quot;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;The End如果你觉得这篇内容对你挺有启发，我想请你帮我三个小忙：点个「在看」，让更多的人也能看到这篇内容&amp;lt;br&amp;gt;关注官网 https://muyiy.cn，让我们成为长期关系&amp;lt;br&amp;gt;关注公众号「高级前端进阶」，公众号后台回复「加群」 加入我们一起学习并送你精心整理的高级前端面试题。&amp;lt;br&amp;gt;》》面试官都在用的题库，快来看看《《                        高级前端进阶 发起了一个读者讨论         参与讨论                                        &amp;lt;br&amp;gt;“在看”吗？在看就点一下吧&amp;lt;br&amp;gt;&quot; data-snippet-id=&quot;ext.89a96a6ef2d46757b2677de8206703d5&quot; data-snippet-saved=&quot;false&quot; data-codota-status=&quot;done&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot; data-darkmode-bgcolor-16018219266315=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16018219266315=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16018219266315=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16018219266315=&quot;rgb(0,0,0)&quot; data-style=&quot;padding-right: 10px; padding-left: 10px; letter-spacing: 0px; background-color: rgb(255, 255, 255); line-height: 1.6; word-break: break-word;&quot; data-darkmode-bgcolor-16020008769986=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16020008769986=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16020008769986=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16020008769986=&quot;rgb(0,0,0)&quot; data-darkmode-color-16021670869911=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16021670869911=&quot;rgb(0,0,0)&quot; data-darkmode-bgcolor-16021670869911=&quot;rgb(25, 25, 25)&quot; data-darkmode-original-bgcolor-16021670869911=&quot;rgb(255, 255, 255)&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-tools=&quot;新媒体排版&quot; data-id=&quot;13777&quot; data-style-type=&quot;关注&quot; data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-darkmode-color-16030305897056=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(89, 89, 89)&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot;&gt;&lt;section data-darkmode-color-16030305897056=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16030305897056=&quot;rgb(0, 0, 0)&quot; data-style=&quot;font-family: &amp;quot;PingFang SC&amp;quot;, 微软雅黑, mp-quote, -apple-system-font, BlinkMacSystemFont, &amp;quot;Helvetica Neue&amp;quot;, &amp;quot;PingFang SC&amp;quot;, &amp;quot;Hiragino Sans GB&amp;quot;, &amp;quot;Microsoft YaHei UI&amp;quot;, &amp;quot;Microsoft YaHei&amp;quot;, Arial, sans-serif; font-size: 14px; color: rgb(0, 0, 0); letter-spacing: 1.56px; font-weight: 600; line-height: 20px;&quot; data-darkmode-color-16057140139831=&quot;rgb(163, 163, 163)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(0, 0, 0)&quot;&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;span&gt;最后不要忘了点赞呦！&lt;span&gt;&lt;img data-ratio=&quot;1.0076923076923077&quot; data-type=&quot;gif&quot; data-w=&quot;260&quot; data-fileid=&quot;100022933&quot; data-src=&quot;https://mmbiz.qpic.cn/sz_mmbiz_gif/H8M5QJDxMHo0BmF9r9Z5jmnjiaRjia63KdItrdfQPpQLTn685ib4pQK1j8wNibqXIQb5m7oLf2v7pke7SMTzCFVs3w/640?wx_fmt=gif&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot; data-darkmode-color-16057140139831=&quot;rgb(141, 141, 141)&quot; data-darkmode-original-color-16057140139831=&quot;rgb(89, 89, 89)&quot; data-style=&quot;padding-top: 8px; padding-bottom: 8px; line-height: 26px; color: rgb(89, 89, 89);&quot;&gt;&lt;span&gt;祝 2022 年暴富！暴美！暴瘦！&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;/pre&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;
          &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>bbea4576176b51ffe5f545b39418434f</guid>
<title>【萌新解题】数据流中的第 K 大元素</title>
<link>https://toutiao.io/k/1w5anuj</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;
            &lt;section data-tool=&quot;mdnice编辑器&quot; data-website=&quot;https://www.mdnice.com&quot;&gt;&lt;blockquote data-tool=&quot;mdnice编辑器&quot;&gt;&lt;p&gt;关于我：微信公众号：&lt;strong&gt;面试官问&lt;/strong&gt;，原创高质量面试题，始于面试题，但不止于面试题。【萌新解题】系列文章试图&lt;strong&gt;从新人的角度&lt;/strong&gt;去看待和解决力扣题目，本题是力扣第 703 题 数据流中的第 K 大元素：https://leetcode.cn/problems/kth-largest-element-in-a-stream/。&lt;/p&gt;&lt;/blockquote&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;题目描述&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;设计一个找到数据流中第 k 大元素的类（class）。注意是排序后的第 k 大元素，不是第 k 个不同的元素。请实现 &lt;code&gt;KthLargest&lt;/code&gt; 类：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;KthLargest(int k, int[] nums)&lt;/code&gt; 使用整数 k 和整数流 nums 初始化对象。&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;&lt;code&gt;int add(int val)&lt;/code&gt; 将 val 插入数据流 nums 后，返回当前数据流中第 k 大的元素。&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;前置知识点&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;如果面试题中要求求出一个动态数据集中的最大值或者最小值，那么一般可以考虑使用优先队列（堆）来解决问题&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;Java 中优先队列（堆） &lt;code&gt;PriorityQueue&lt;/code&gt; 的默认情况下是一个最小堆，如果要使用最大堆，那么在调用构造函数时就需要传入 &lt;code&gt;Comparator&lt;/code&gt; 的实现类自定义比较排序的规则。&lt;code&gt;PriorityQueue&lt;/code&gt; 实现了接口 &lt;code&gt;Queue&lt;/code&gt;，常用函数有：&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;offer(e)：将元素 e 放入堆中&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;poll()：删除堆顶元素&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;peek()：返回位于堆顶的元素，但该元素并不出堆，还在堆中&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;解题说明&lt;/h2&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;本题要求出数据流中已经读取的数字中第 k 大的数字，因此，我们可以维护一个数据结构，来保存动态数据流中前 k 大个数字，并返回第 k 大的那个数字，也就是返回这 k 个数字中最小的，很明显，可以使用堆这个数据结构来解决这个问题，而且是最小堆，也就是堆顶的元素就是第 k 大的数字。&lt;/p&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;核心原理如下：&lt;/p&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;初始化一个大小为 k 的最小堆&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;往堆中添加元素时，有两种情况&lt;/section&gt;&lt;/li&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;堆还没有满，那么直接把元素添加进去即可&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;堆满了，那么要判断当前元素和堆顶元素的大小，如果当前元素大于堆顶元素，那么堆顶元素应该删除，并将当前元素添加到堆中；如果当前元素小于堆顶元素，则不处理&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;p data-tool=&quot;mdnice编辑器&quot;&gt;相信理解核心原理后，大家可以很快写出如下代码：&lt;/p&gt;&lt;pre data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;class&lt;/span&gt; &lt;span&gt;KthLargest&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;// 使用最小堆来保存数组中最大的k个元素，位于堆顶的是第k大的元素&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; PriorityQueue&amp;lt;Integer&amp;gt; minHeap;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;// 堆的大小&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;private&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; heapSize;&lt;br/&gt;&lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 构造函数&lt;br/&gt;     * &lt;br/&gt;     * k：堆大小&lt;br/&gt;     * nums：初始数组&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;KthLargest&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; k, &lt;span&gt;int&lt;/span&gt;[] nums)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;this&lt;/span&gt;.heapSize = k;&lt;br/&gt;        &lt;span&gt;this&lt;/span&gt;.minHeap = &lt;span&gt;new&lt;/span&gt; PriorityQueue&amp;lt;&amp;gt;();&lt;br/&gt;        &lt;span&gt;for&lt;/span&gt; (&lt;span&gt;int&lt;/span&gt; num : nums) {&lt;br/&gt;            add(num);&lt;br/&gt;        }&lt;br/&gt;    }&lt;br/&gt;    &lt;br/&gt;    &lt;span&gt;/**&lt;br/&gt;     * 往堆中添加一个元素&lt;br/&gt;     * val：元素值&lt;br/&gt;     */&lt;/span&gt;&lt;br/&gt;    &lt;span&gt;&lt;span&gt;public&lt;/span&gt; &lt;span&gt;int&lt;/span&gt; &lt;span&gt;add&lt;/span&gt;&lt;span&gt;(&lt;span&gt;int&lt;/span&gt; val)&lt;/span&gt; &lt;/span&gt;{&lt;br/&gt;        &lt;span&gt;if&lt;/span&gt; (minHeap.size() &amp;lt; heapSize) {&lt;br/&gt;            &lt;span&gt;// 堆还没有满，那么直接把元素添加进去即可&lt;/span&gt;&lt;br/&gt;            minHeap.offer(val);&lt;br/&gt;        } &lt;span&gt;else&lt;/span&gt; {&lt;br/&gt;            &lt;span&gt;// 堆满了，那么要判断当前元素和堆顶元素的大小&lt;/span&gt;&lt;br/&gt;            &lt;span&gt;if&lt;/span&gt; (minHeap.peek() &amp;lt; val) {&lt;br/&gt;                minHeap.poll();&lt;br/&gt;                minHeap.offer(val);&lt;br/&gt;            }&lt;br/&gt;        }&lt;br/&gt;&lt;br/&gt;        &lt;span&gt;// 返回堆顶元素，即是第 k 大数字&lt;/span&gt;&lt;br/&gt;        &lt;span&gt;return&lt;/span&gt; minHeap.peek();&lt;br/&gt;    }&lt;br/&gt;}&lt;br/&gt;&lt;/code&gt;&lt;/pre&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;复杂度分析&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;时间复杂度：O(logk)，主要是在 add 函数中，把元素添加到堆中的操作&lt;/section&gt;&lt;/li&gt;&lt;li&gt;&lt;section&gt;空间复杂度：O(k)，使用额外的大小为 k 堆来存放元素&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2 data-tool=&quot;mdnice编辑器&quot;&gt;&lt;span/&gt;参考资料&lt;/h2&gt;&lt;ul data-tool=&quot;mdnice编辑器&quot; class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;section&gt;《剑指 Offer（专项突破版）：数据结构与算法名企面试题精讲》&lt;/section&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
<item>
<guid>28a1a09d3a0739a27b975da696cfd2d4</guid>
<title>​详解维度建模之事实表</title>
<link>https://toutiao.io/k/awkwqm6</link>
<content:encoded>&lt;div&gt;&lt;div&gt;&lt;div class=&quot;rich_media_content                                       &quot; id=&quot;js_content&quot;&gt;
            &lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-croporisrc=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/z2DApiaibzMic9VQP5dl39PTFIPPptNeOOfKqQruNalBbHvOKCHzawJ0MtLmibE7D890dia2mB5sG0tdC5EnVPbLibdQ/0?wx_fmt=jpeg&quot; data-cropx1=&quot;0&quot; data-cropx2=&quot;1070.6574394463669&quot; data-cropy1=&quot;121.45328719723182&quot; data-cropy2=&quot;719.3771626297577&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.5598130841121496&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/z2DApiaibzMic9VQP5dl39PTFIPPptNeOOf7lickIWF5XCe7Tup5Sv0j0XysmlhZvvdgPDpX1KxtQUQsfCo8GH85rw/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;1070&quot;/&gt;&lt;/p&gt;&lt;section&gt;&lt;span&gt;来源：数据工匠记    编辑：数据一哥&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;全文共&lt;/span&gt;&lt;span&gt; 5200&lt;/span&gt;&lt;span&gt;个字，建议阅读 &lt;/span&gt;&lt;span&gt;10&lt;/span&gt;&lt;span&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/span&gt;&lt;span&gt;分钟&lt;/span&gt;&lt;/section&gt;&lt;h1&gt;&lt;span&gt;每个数据仓库都包含一个或者多个事实数据表。其中可能包含业务销售数据，如现金登记事务所产生的数据，通常包含大量的行。事实数据表的主要特点是包含数字数据（事实），并且这些数字信息可以汇总，以提供有关单位作为历史的数据，每个事实数据表包含一个由多个部分组成的索引，该索引包含作为外键的相关性维度表的主键，而维度表包含事实记录的特性。有很多规范大家可以参考：&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI4MzE4MjQxOQ==&amp;amp;mid=2649362453&amp;amp;idx=1&amp;amp;sn=5b6e0d63ba20c6c2df7960f09cc76625&amp;amp;chksm=f3902429c4e7ad3fa35e1b38b9656d3fcb834a8d7f8799adf2285db090528e4826920c560851&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;数据仓库建设规范（文档版）&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;数据仓库建设规范（文档版）&lt;/a&gt;，&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI4MzE4MjQxOQ==&amp;amp;mid=2649360114&amp;amp;idx=1&amp;amp;sn=4ecadcd19e933600a7bea17fff591497&amp;amp;chksm=f39032cec4e7bbd8068e52dfcba6216d519206c5b0088a9c786cfc4f3703db219edf0610ecbf&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;严选-数仓规范和评价体系&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;11&quot; tab=&quot;innerlink&quot; data-linktype=&quot;2&quot;&gt;严选-数仓规范和评价体系&lt;/a&gt;&lt;/span&gt;&lt;/h1&gt;&lt;section data-class=&quot;_mbEditor&quot;&gt;&lt;section label=&quot;Powered by 135editor.com&quot;&gt;&lt;section data-id=&quot;86134&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;01&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;20%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;事实表基础&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;h3&gt;&lt;span&gt;事实表特征&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;事实表作为数仓维度建模的核心，紧紧围绕着&lt;span&gt;&lt;strong&gt;业务过程&lt;/strong&gt;&lt;/span&gt;来设计，通过获取描述业务过程的度量来表达业务过程，包含了引用的维度和业务过程有关的度量。事实表中一条记录所表达的业务细节程度被称为&lt;span&gt;&lt;strong&gt;粒度&lt;/strong&gt;&lt;/span&gt;(业务中的细节程度)。通常粒度可以通过两种方式来表达：一种是维度属性组合所表示的细节程度，另一种是所表示的具体业务含义。&lt;/p&gt;&lt;p&gt;作为&lt;span&gt;&lt;strong&gt;度量业务过程&lt;/strong&gt;&lt;/span&gt;的事实（事实表属性），一般为整型或浮点型的十进制数值，有可加性、半可加性和不可加性三种类型：&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;可加性事实&lt;/strong&gt;&lt;/span&gt;&lt;span&gt; &lt;/span&gt;是指可以按照与事实表关联的任意维度进行汇总。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;半可加性事实&lt;/strong&gt;&lt;/span&gt; 只能按照特定维度汇总，不能对所有维度汇总，比如库存可以按照地点和商品进行汇总，而按时第门章事实表设计丁一间维度把一年中每个月的库存累 加起来则毫无意义。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;不可加事实&lt;/strong&gt;&lt;/span&gt; 不具备可加性，比如比率型事实。对于不可加性事实可分解为可加的组件来实现聚集。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;有事实的事实表&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;有事实表分为三种类型 ： &lt;span&gt;&lt;strong&gt;事务事实表&lt;/strong&gt;、&lt;strong&gt;周期快照事实表&lt;/strong&gt;&lt;/span&gt;和&lt;span&gt;&lt;strong&gt;累积快照事实表&lt;/strong&gt;&lt;/span&gt;。&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI4MzE4MjQxOQ==&amp;amp;mid=2649362053&amp;amp;idx=1&amp;amp;sn=8d97b96053505b8535e717386d7e2fa7&amp;amp;chksm=f3903ab9c4e7b3afab0f07a93d18a23c65951661f42400113ce40ac2150df3d0786e221f103c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;1.087837837837838&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z2DApiaibzMic9VQP5dl39PTFIPPptNeOOfefVCPnGXJUssl4RX2iatnRb0lJGlGeBDcZ0GlvvfvBJaIyOJ2Tso8aw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;888&quot; title=&quot;&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;无事实的事实表&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;无事实的事实表可以用来跟踪事件的发生。例如，在给定的某一天中发生的学生参加课程的事件，可能没有可记录的数字化事实，但该事实行带有一个包含日期、学生、教师、地点、课程等定义良好的外键。利用无事实的事实表可以按各种维度计数上课这个事件。&lt;/p&gt;&lt;p&gt;&lt;a target=&quot;_blank&quot; href=&quot;http://mp.weixin.qq.com/s?__biz=MzI4MzE4MjQxOQ==&amp;amp;mid=2649387910&amp;amp;idx=1&amp;amp;sn=a9246ece4013e2be0459597338beaf6f&amp;amp;chksm=f39047bac4e7ceac4042638d231618ec685177fb2bca8b5c30bba5ebbc32eac7a468492b0b8c&amp;amp;scene=21#wechat_redirect&quot; textvalue=&quot;你已选中了添加链接的内容&quot; linktype=&quot;text&quot; imgurl=&quot;&quot; imgdata=&quot;null&quot; data-itemshowtype=&quot;0&quot; tab=&quot;innerlink&quot; data-linktype=&quot;1&quot;&gt;&lt;span class=&quot;js_jump_icon h5_image_link&quot; data-positionback=&quot;static&quot;&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.49733570159857904&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z2DApiaibzMic9VQP5dl39PTFIPPptNeOOfUS5OqCvTYym6j9y7MbTlFNxLMSy23F8yBfOedlBIz2viaqrQG6NLHNw/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1126&quot; title=&quot;&quot;/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/p&gt;&lt;section data-class=&quot;_mbEditor&quot;&gt;&lt;section label=&quot;Powered by 135editor.com&quot;&gt;&lt;section data-id=&quot;86134&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;02&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;20%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;事实表设计规则&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;/p&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;尽可能包含所有与业务过程相关的事实；&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;只选择与业务过程相关的事实；&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;分解不可加性事实为可加的组件；&lt;/strong&gt;&lt;/span&gt;比如订单的优惠率，应该分解为订单原价金额与订单优惠金额&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;在选择维度和事实之前必须先声明粒度；&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;在同一个事实表中不能有多种不同粒度的事实；&lt;/strong&gt;&lt;/span&gt;粒度的声明是事实表设计中不可忽视的重要一步，粒度用于确定事实表中一行所表示业务的细节层次，决定了维度模型的扩展性，在选择维度和事实之前必须先声明粒度，且每个维度和事实必须与所定义的粒度保持一致&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;在同一个事实表中不能有多种不同粒度的事实；&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;事实的单位要保持一致；&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;对事实的 null 值要处理；&lt;/strong&gt;&lt;/span&gt;在数据库中null值对常用的大于或小于等SQL不生效，建议使用零值填充&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;使用退化维度提高事实表的易用性；&lt;/strong&gt;&lt;/span&gt;目的主要是为了减少下游用户使用时关联多个表的操作。直接通过退化维度实现对事实表的过滤查询、控制聚合层次、排序数据以及定义主从关系等&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;section data-class=&quot;_mbEditor&quot;&gt;&lt;section label=&quot;Powered by 135editor.com&quot;&gt;&lt;section data-id=&quot;86134&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;03&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;20%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;事实表设计方法&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;Kimball的四步维度建模方法：&lt;strong&gt;&lt;span&gt;选择业务过程、声明粒度、确定维度、确定事实&lt;/span&gt;&lt;/strong&gt;。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Step 1:选择业务过程及确定事实表类型。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;在明确了业务需求以后，接下来需要进行详细的需求分析，对业务的整个生命周期进行分析，明确关键的业务步骤，从而选择与需求有关的&lt;strong&gt;业务过程&lt;/strong&gt;。(业务过程通常使用行为动词表示业务执行的活动)&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Step 2:声明粒度 。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;粒度的声明是事实表建模非常重要的一步，意味着精确定义事实表的每一行所表示的业务含义，粒度传递的是与事实表度量有关的细节层次。明确的粒度能确保对事实表中行的意思的理解不会产生混淆，保证所有的事实按照同样的细节层次记录。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Step 3 :确定维度 。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;完成粒度声明以后，也就意味着确定了主键，对应的维度组合以及相关的维度字段就可以确定了，应该选择能够描述清楚业务过程所处的环境的维度信息。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;Step 4 : 确定事实 。&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;事实可以通过回答“过程的度量是什么”来确定。应该选择与业务过程有关的所有事实，且事实的粒度要与所声明的事实表的粒度一致。事实有可加性、半可加性、非可加性三种类型 ， 需要将不可加性事实分解为可加的组件。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Step 5:冗余维度 。&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;冗余维度是在kimball维度建模方法基础上新增的步骤。主要是因为在大数据的事实表模型设计中，需要考虑更多的是提高下游用户的使用效率，降低数据获取的复杂性，减少关联的表数量。所以通常事实表中会冗余方便下游用户使用的常用维度，以实现对事实表的过滤查询、控制聚合层次、排序数据以及定义主从关系等操作。&lt;/p&gt;&lt;section data-class=&quot;_mbEditor&quot;&gt;&lt;section label=&quot;Powered by 135editor.com&quot;&gt;&lt;section data-id=&quot;86134&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;04&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;20%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;有事实的事实表&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;有事实表分为三种类型 ：&lt;span&gt; &lt;strong&gt;事务事实表&lt;/strong&gt;、&lt;strong&gt;周期快照事实表&lt;/strong&gt;&lt;/span&gt;和&lt;span&gt;&lt;strong&gt;累积快照事实表&lt;/strong&gt;&lt;/span&gt;。&lt;/p&gt;&lt;h3&gt;&lt;span&gt;事务事实表&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;单事务事实表&lt;/strong&gt;，&lt;/span&gt;针对于&lt;span&gt;每个业务过程&lt;/span&gt;设计一个事实表，方便每个业务过程进行独立分析研究。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;优点：&lt;/strong&gt;&lt;/span&gt;更方便跟踪业务流程细节数据，针对特殊的业务分析场景比较方便和灵活，数据处理上也更加灵活;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;弊端：&lt;/strong&gt;&lt;/span&gt;数仓中需要管理太多的事实表，同时跟踪业务流转不够直观&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;多事务事实表&lt;/strong&gt;&lt;/span&gt;，将&lt;span&gt;不同的事实放到同一个事实表&lt;/span&gt;中，即同一个事实表包含不同的业务过程。多事务事实表在设计时有两种方法进行事实的处理：&lt;/p&gt;&lt;p&gt;一是不同业务过程的事实使用不同的事实字段进行存放：&lt;/p&gt;&lt;p&gt;二是不同业务过程的事实使用同一个事实字段进行存放，但增加一个业务过程标签。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;优点：&lt;/strong&gt;&lt;/span&gt;能够更直观的跟踪业务流转和当前状态，流程事实集中，方便大部分的通用分析应用场景，由于和业务侧的数据模型设计思路一致，也是目前最常用的事实表设计;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;弊端：&lt;/strong&gt;&lt;/span&gt;细节数据跟踪不到位，特殊场景的分析不够灵活;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.5096525096525096&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z2DApiaibzMic9VQP5dl39PTFIPPptNeOOfq3pOYrTADhjicqTy3GEqg9MesvevialFF2M8jO36ltHib9pNLO5ZJDMBg/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;1295&quot; title=&quot;&quot;/&gt;&lt;/p&gt;&lt;p&gt;两种表的设计区别在于对业务流程的拆分思路不同，具体选择事实表的构建思路，需要根据实际的业务确定，一般建议两者结合。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;父子事实的处理方式，&lt;/strong&gt;&lt;/span&gt;通过分摊父订单的金额将所有业务过程的度量全部带进淘宝交易事务事实表中，包括下单数量、商品价格、子订单折扣、下单分摊比例、父订单支付金额、父订单支付邮费、父订单折扣、子订单下单金额、子订单下单有效金额、支付分摊比例、子订单支付金额等，将父子事实同时冗余到事务表中。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;设计准则&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;事实完整性&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;事实表包含与其描述的过程有关的所有事实，即尽可能多地获取所有的度量。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;事实一致性&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;在确定事务事实表的事实时，明确存储每一个事实以确保度量的一致性。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;事实可加性&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;事实表确定事实时，往往会遇到非可加性度量，比如分摊比例、利润率等，虽然它们也是下游分析的关键点，但往往在事务事实表中关注更多的是可加性事实，下游用户在聚合统计时更加方便。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;周期快照事实表&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;快照事实表在确定的问隔内对实体的度量进行抽样，这样可以很容易地研究实体的度量值，而不需要聚集长期 的事务历史。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;特征&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;用快照采样状态&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;快照事实表以预定的间隔采样状态度量。这种间隔联合一个或多个维度，将被用来定义快照事实表的粒度，每行都将包含记录所涉及状态的事实。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;快照粒度&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;事务事实表的粒度可以通过业务过程中所涉及的细节程度来描述，但快照事实表的粒度通常总是被多维声明，可以简单地理解为快照需要采样的周期以及什么将被采样。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;密度与稀疏性&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;快照事实表和事务事实表的一个关键区别在密度上。事务事实表是稀疏的，只有当天发生的业务过程，事实表才会记录该业务过程的事实，如下单、支付等；而快照事实表是稠密的，无论当天是否有业务过程发生，都会记录一行，比如针对卖家的历史至今的下单和支付金额，无论当天卖家是否有下单支付事实，都会给该卖家记录一行。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;半可加性&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;在快照事实表中收集到的状态度量都是半可加的。与事务事实表的可加性事实不同，半可加性事实不能根据时间维度获得有意义的汇总结果。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;设计实例&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;单维度的每天快照事实表&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;确定粒度、确定维度&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;混合维度的每天快照事实表&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;确定粒度、确定维度、确定状态度量&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;全量快照事实表&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;相比单维度的快照事实表，多了一些冗余维度。例如，商品评价表，多了子订单维度、商品维度、评论者维度。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;累计快照事实表&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;对于类似于研究事件之间时间间隔的需求，采用累计快照事实表可以很好地解决。&lt;/p&gt;&lt;p&gt;如在统计买家下单到支付的时长、买家支付到卖家发货的时长等，事务事实表很难满足，需要用到累计快照事实表。&lt;/p&gt;&lt;section&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzkzMDE3OTE5NA==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/h7RlmqicdZGnP7FHOJTvlUsRGIzVEsL7IA11gowkeRbLuFQ5hX906hOQTzm9sia1675RZGjPzd34o3I1fOR4FGkA/0?wx_fmt=png&quot; data-nickname=&quot;大数据技术指南&quot; data-alias=&quot;&quot; data-signature=&quot;回复「面试」下载大数据面试真题&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;特征&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;数据不断更新&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;针对于实体中的某一实例定期更新。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;多业务过程日期&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;累积快照事实表适用于具有较明确起止时间的短生命周期的实体，比如交易订单、物流订单等，对于实体的每一个实例，都会经历从诞生到消亡等一系列步骤。对于商品、用户等具有长生命周期的实体，一般采用周期快照事实表更合适。&lt;span&gt;&lt;strong&gt;累积快照事实表的典型特征是多业务过程日期，用于计算业务过程之间的时间间隔。&lt;/strong&gt;&lt;/span&gt;但结合阿里巴巴数据仓库模型建设的经验，对于累积快照事实表，还有一个重要作用是保存全量数据。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;特殊处理&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;非线性过程&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;淘宝一般流程是：下单、支付、发货、确认收货。但并不是所有的交易都会走此流程，比如买家下单之后不支付或关闭订单。针对这种非线性过程，处理情况主要有以下几种：(1）业务过程的统一&lt;/p&gt;&lt;p&gt;我们以流程结束标志为依据，关闭订单也是结束标志，统一起来。&lt;/p&gt;&lt;p&gt;(2）针对业务关键里程碑构建全面的流程&lt;/p&gt;&lt;p&gt;对于没有支付或没有发货的交易订单也将其纳入流程来，相关的业务字段置孔。&lt;/p&gt;&lt;p&gt;(3）循环流程的处理&lt;/p&gt;&lt;p&gt;主要解决问题是一个业务过程有多个日期。使用业务过程的第一次发生日期还是最近发生日期，根据用户决定。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;多源过程&lt;/strong&gt; &lt;/span&gt;针对多源业务建模，主要考虑事实表的粒度问题。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;业务过程取舍&lt;/strong&gt;&lt;/span&gt; 当拥有大量的业务过程时，模型的实现复杂度会增加，特别是对于多源业务过程，模型的精合度过高，此时需要根据商业用户需求，选取关键的里程碑。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;物理实现&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;逻辑模型和物理模型密不可分，针对累积快照事实表模型设计，其有不同的实现方式。&lt;strong&gt;&lt;span&gt;第一种：&lt;strong&gt;增量存储&lt;/strong&gt; &lt;/span&gt;&lt;/strong&gt;以业务实体的结束时间分区。即每周期仅处理增量部分的数据，针对状态无变化的数据比较适合 ；&lt;strong&gt;&lt;span&gt;第二种：&lt;strong&gt;全量快照&lt;/strong&gt; &lt;/span&gt;&lt;/strong&gt;状态有变化，每天的分区存储昨天的全量数据和当天的增量数据合并的结果，对于数据量在可控范围内的情况可以采用如下 保存策略: 如果存储空间和成本可接受，完整存储，确保能够追溯到历史每天数据状态 存储空间有限，考虑移动历史快照数据到冷盘，需要使用的时候可恢复 数据历史状态数据无太大价值，可以考虑部分删除，比如近保留每月最后一天的快照数据 ；&lt;strong&gt;&lt;span&gt;第三种：&lt;strong&gt;拉链&lt;/strong&gt;&lt;/span&gt;&lt;/strong&gt; 针对于全量表的变化形式，数据量大、但缓慢变化、需要跟踪历史状态，和缓慢渐变维类似。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;设计准则&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;同事务事实表设计一样。&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-ratio=&quot;0.48668639053254437&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_png/z2DApiaibzMic9VQP5dl39PTFIPPptNeOOfHjSbmTfib9jTTTaXl9ljfvibZUms8Sia0oSlNKqqbwekvshSvlQw5KzuA/640?wx_fmt=png&quot; data-type=&quot;png&quot; data-w=&quot;676&quot; title=&quot;&quot;/&gt;&lt;/p&gt;&lt;section data-class=&quot;_mbEditor&quot;&gt;&lt;section label=&quot;Powered by 135editor.com&quot;&gt;&lt;section data-id=&quot;86134&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;05&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;20%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;无事实的事实表&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;在维度模型中，事实表用事实来度量业务过程，不包含事实或度量的事实表称为&lt;span&gt;&lt;strong&gt;无事实的事实表&lt;/strong&gt;。&lt;/span&gt;虽然没有明确的事实，但可以用来支持业务过程的度量。常见的无事实的事实表主要有如下两种：&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;strong&gt;&lt;span&gt;第一种是&lt;strong&gt;事件类&lt;/strong&gt;的，记录事件的发生。&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;如阿里巴巴数据仓库中，最常见的是日志类事实表。&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;第二种是&lt;strong&gt;条件、范围或资格类&lt;/strong&gt;的，记录维度与维度多对多之 间的关系。&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;如客户和销售人员的分配情况、产品的促销范围等。&lt;/p&gt;&lt;section data-class=&quot;_mbEditor&quot;&gt;&lt;section label=&quot;Powered by 135editor.com&quot;&gt;&lt;section data-id=&quot;86134&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;span&gt;&lt;strong&gt;06&lt;/strong&gt;&lt;/span&gt;&lt;/section&gt;&lt;section&gt;&lt;br/&gt;&lt;/section&gt;&lt;section&gt;&lt;section data-width=&quot;20%&quot;&gt;&lt;br/&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;聚集型事实表&lt;br/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;p&gt;数据仓库的性能是数据仓库建设是否成功的重要标准之一。聚集主要是通过汇总明细粒度数据来获得改进查询性能的效果。通过访问聚集数据，可以减少数据库在响应查询时必须执行的工作量，能够快速响应用户的查询，同时有利于减少不同用户访问明细数据带来的结果不一致问题。如阿里巴巴将使用频繁的公用数据，通过聚集进行沉淀，比如卖家最近 l 天的交易汇总表、卖家最近 N 天的交易汇总表、卖家自然年交易汇总表等。这类聚集汇总数据，被叫作&lt;span&gt;&lt;strong&gt;公共汇总层&lt;/strong&gt;。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;相对于明细事实表，聚合事实表通常是在明细事实表的基础上，按照一定的粒度粗细进行的汇总、聚合操作，它的粒度较明细数据粒度粗，同时伴随着细节信息的丢失;在数仓层次结构中，通常位于dws层，一般作为通用汇总数据存在，也可以是更高粒度的指标数据。&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;基本原则&lt;/span&gt;&lt;/h3&gt;&lt;ul class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;一致性&lt;/strong&gt; &lt;/span&gt;聚集表必须提供与查询明细粒度数据一致的查询结果。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;避免单一表设计&lt;/strong&gt;&lt;/span&gt; 不要在同一个表中存储不同层次的聚集数据；否则将会导致双重计算或出现更糟糕的事情。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;聚集粒度可不同&lt;/strong&gt;&lt;/span&gt; 聚集并不需要保持与原始明细粒度数据一样的粒度，聚集只关心所需要查询的维度。&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;基本步骤&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Step 1：确定聚集维度。&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Step 2：确定一致性上钻。&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;strong&gt;&lt;span&gt;Step 3：确定聚集事实。&lt;/span&gt;&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;常见聚集型事实表&lt;/span&gt;&lt;/h3&gt;&lt;p&gt;数据仓库中，按照日期范围的不同，通常包括以下类别的聚集事实表&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;公共维度层-通用汇总&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;应对大部分可预期的、常规的数据需求，通常针对模式相对稳定的分析、BI指标计算、特征提取等场景，封装部分业务处理、计算逻辑，尽量避免用户直接使用底层明细数据，该层用到的数据范围比较广泛。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;日粒度&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;主要应对模式稳定的分析、BI日报、特征提取场景，同时日粒度也为后续累积计算提供粗粒度的底层，数据范围一般为上一日的数据 。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;周期性累积&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;主要应对明确的周期性分析、BI周期性报表，数据范围一般在某周期内的。&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;历史累积&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;顾名思义，历史以来某一特定数据的累积，通常在用户画像、经营分析、特征提取方面场景较多，设计数据范围比较广泛，通常是计算耗时较长的一部分，比如某门店累积营业额、某用户累积利润贡献、用户首次下单时间(非可度量、描述性)。&lt;span/&gt;&lt;/p&gt;&lt;h3&gt;&lt;span&gt;聚集补充说明&lt;/span&gt;&lt;/h3&gt;&lt;ol class=&quot;list-paddingleft-1&quot;&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;聚集是不跨越事实的&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;聚集是针对原始星形模型进行的汇总，为了获取和查询与原始模型一致的结果，聚集的维度和度量必须与原始模型保持一致，因 此聚集是不跨越事实的。&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;聚集带来的问题&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;聚集会带来查询性能的提升，但聚集也会增加 ETL 维护的难度。当子类目对应的一级类目发生变更时，先前存在的、已经被汇总到聚集表中的数据需要被重新调整。这一额外工作随着业务复杂性的增加，会导致多数 ETL 人员选择简单强力的方法，删除并重新聚集数据。&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;&lt;section&gt;&lt;strong&gt;&lt;span&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-copyright=&quot;0&quot; data-ratio=&quot;0.03872053872053872&quot; data-s=&quot;300,640&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/UyS5e1qV2Qz4Qmb0lR3LcV6vPRnCmR3qPOrTxZb7IaoL6XZkfOqiaFDJQ2OPDfkzmy3LhdOAXDNvvLqXZviaqOFA/640?wx_fmt=jpeg&amp;amp;wxfrom=5&amp;amp;wx_lazy=1&amp;amp;wx_co=1&quot; data-type=&quot;jpeg&quot; data-w=&quot;1188&quot;/&gt;&lt;/span&gt;&lt;/strong&gt;&lt;/section&gt;&lt;section data-class=&quot;_mbEditor&quot; data-id=&quot;488773&quot;&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;section&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-cropselx1=&quot;0&quot; data-cropselx2=&quot;97&quot; data-cropsely1=&quot;0&quot; data-cropsely2=&quot;97&quot; data-ratio=&quot;1.1078320090805902&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_jpg/z2DApiaibzMicicB06SeBS1EpdcVwH89ibRqv8kccFH3oMhZZj4xW8MAkx0Y82kzP6gMkTU0oaNbv0PYFbpp3PuiafTg/640?wx_fmt=jpeg&quot; data-type=&quot;jpeg&quot; data-w=&quot;881&quot;/&gt;&lt;section&gt;&lt;section&gt;&lt;strong&gt;添加我的微信，获取本文完整PDF &lt;/strong&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;/section&gt;&lt;section&gt;&lt;mpprofile class=&quot;js_uneditable custom_select_card mp_profile_iframe&quot; data-pluginname=&quot;mpprofile&quot; data-id=&quot;MzI4MzE4MjQxOQ==&quot; data-headimg=&quot;http://mmbiz.qpic.cn/mmbiz_png/z2DApiaibzMicibStrZbEKicUIkEia0iaUrqcr4dq64JSoTr0gAkQE7QESQcYrsNqGvdQWrNUZKUz9zjO2WxEAKD5J5GQ/0?wx_fmt=png&quot; data-nickname=&quot;数据社&quot; data-alias=&quot;DataClub&quot; data-signature=&quot;头部企业大数据分析负责人，中国DBA联盟成员，个人专注数据仓库架构，数据分析，MPP数据库研究、流处理计算等&quot; data-from=&quot;0&quot;/&gt;&lt;/section&gt;&lt;p&gt;&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;span&gt;‍&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;公众号推送规则变了&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;点击上方公众号名片，&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;收藏公众号&lt;/strong&gt;&lt;/span&gt;&lt;span&gt;&lt;strong&gt;&lt;span&gt;，不错过精彩内容推送！&lt;/span&gt;&lt;/strong&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;img class=&quot;rich_pages wxw-img&quot; data-galleryid=&quot;&quot; data-ratio=&quot;0.428&quot; data-src=&quot;https://mmbiz.qpic.cn/mmbiz_gif/z2DApiaibzMicicVu89OQvdamdpW8lLUicFNnw3RiaNIEeKGVTYiaqdW9dk33euSNmSsyekJl0tfFK1MIb37QTrf4AQHQ/640?wx_fmt=gif&quot; data-type=&quot;gif&quot; data-w=&quot;500&quot;/&gt;&lt;/p&gt;&lt;p&gt;&lt;/p&gt;
          &lt;/div&gt;

          

          



           
                                
                    
        &lt;/div&gt;&lt;/div&gt;</content:encoded>
</item>
</channel></rss>